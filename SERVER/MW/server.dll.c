#include "server.dll.h"



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void StopServer(void)

{
  float10 fVar1;
  DWORD local_c;
  __time32_t local_8;
  __time32_t local_4;
  
                    // 0x1000  3  StopServer
  if (DAT_10058368 != (HANDLE)0x0) {
    DAT_10058378 = 1;
    local_c = 0;
    local_4 = 0;
    local_8 = 0;
    FID_conflict___time32(&local_8);
    do {
      FID_conflict___time32(&local_4);
      GetExitCodeThread(DAT_10058368,&local_c);
      if (local_c != 0x103) goto LAB_1000109a;
      fVar1 = FUN_1003f5a2(local_4,local_8);
    } while (fVar1 < (float10)10.0 != (NAN(fVar1) || NAN((float10)10.0)));
    if (local_c == 0x103) {
      TerminateThread(DAT_10058368,0);
    }
LAB_1000109a:
    DAT_10058368 = (HANDLE)0x0;
    _DAT_1005836c = 0;
  }
  return;
}



bool IsServerRunning(void)

{
                    // 0x10b0  1  IsServerRunning
  return DAT_10058368 != 0;
}



void FUN_100010c0(void)

{
  HANDLE hFile;
  int *piVar1;
  int iVar2;
  byte *pbVar3;
  DWORD DVar4;
  int iVar5;
  uint uVar6;
  undefined4 *puVar7;
  ulonglong uVar8;
  _FILETIME local_1b4;
  _FILETIME local_1ac;
  _SYSTEMTIME local_1a4;
  undefined4 local_194;
  DWORD local_190;
  undefined4 local_18c;
  byte *local_188;
  int local_184;
  int *local_180;
  int local_17c;
  CHAR local_178 [256];
  byte local_78;
  undefined4 local_77;
  char local_38;
  undefined4 local_37;
  undefined4 local_33;
  undefined4 local_2f;
  undefined2 local_2b;
  undefined1 local_29;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined1 *local_14;
  void *pvStack_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_1004ce30;
  pvStack_10 = ExceptionList;
  local_14 = &stack0xfffffe40;
  local_18 = DAT_10057438;
  local_28 = 0x4d53464e;
  local_20 = 0;
  local_24 = 0x414e57;
  local_1c = 0;
  ExceptionList = &pvStack_10;
  GetModuleFileNameA((HMODULE)0x0,local_178,0x100);
  hFile = CreateFileA(local_178,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  GetFileTime(hFile,(LPFILETIME)0x0,(LPFILETIME)0x0,&local_1ac);
  FileTimeToLocalFileTime(&local_1ac,&local_1b4);
  FileTimeToSystemTime(&local_1b4,&local_1a4);
  CloseHandle(hFile);
  local_78 = 0;
  puVar7 = &local_77;
  for (iVar5 = 0xf; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar7 = 0;
    puVar7 = puVar7 + 1;
  }
  *(undefined2 *)puVar7 = 0;
  *(undefined1 *)((int)puVar7 + 2) = 0;
  _sprintf((char *)&local_78,"(%s) %04d/%02d/%02d %d:%02d",&DAT_1004d28c,(uint)local_1a4.wYear,
           (uint)local_1a4.wMonth,(uint)local_1a4.wDay,(uint)local_1a4.wHour,(uint)local_1a4.wMinute
          );
  local_180 = (int *)0x0;
  local_8 = 0;
  piVar1 = FUN_10014b50(&local_78,(byte *)0x0);
  DAT_10058360 = piVar1;
  if (piVar1 == (int *)0x0) {
    local_194 = 0xffffffff;
    piVar1 = (int *)__CxxThrowException_8(&local_194,&DAT_10055d80);
  }
  for (iVar5 = 0; (&PTR_FUN_10057040)[iVar5] != (undefined *)0x0; iVar5 = iVar5 + 1) {
    iVar2 = FUN_10013e70((int)piVar1);
    (*(code *)(&PTR_FUN_10057040)[iVar5])(iVar2);
    piVar1 = DAT_10058360;
  }
  FUN_10014c10(piVar1,"server.cfg","");
  pbVar3 = FUN_10014600((int)DAT_10058360,(byte *)0x0);
  local_188 = pbVar3;
  FUN_10001710();
  piVar1 = FUN_10001aa0();
  local_180 = piVar1;
  if (piVar1 == (int *)0x0) {
    local_18c = 0xffffffff;
    __CxxThrowException_8(&local_18c,&DAT_10055d80);
  }
  local_8 = 0xffffffff;
  if (DAT_1005837c != 0) {
    local_28 = 0x4d53464e;
    local_24 = CONCAT22(local_24._2_2_,0x57);
  }
  iVar5 = 10;
  pbVar3 = FUN_100020f0(pbVar3,(byte *)0x1004d24c);
  local_17c = FUN_10002480((char *)pbVar3,iVar5);
  if (local_17c < 1) {
    local_17c = 1;
  }
  else if (1000 < local_17c) {
    local_17c = 1000;
  }
  uVar8 = FUN_1003fc08();
  local_184 = (int)uVar8;
  local_17c = 0;
  local_180 = (int *)GetTickCount();
  FUN_100152c0(DAT_10058360,'\x01');
  while (DAT_10058378 == '\0') {
    local_190 = GetTickCount();
    FUN_10001b30();
    if (DAT_10068a54 == 0) {
      iVar5 = 0;
    }
    else {
      iVar5 = *(int *)(DAT_10068a54 + 0x1274e88) + *(int *)(DAT_10068a54 + 0x1274e80) +
              *(int *)(DAT_10068a54 + 0x1274e84) + *(int *)(DAT_10068a54 + 0x1274e78);
    }
    if ((local_17c != iVar5) ||
       (DVar4 = GetTickCount(), uVar6 = (int)(DVar4 - (int)local_180) >> 0x1f,
       3000 < (int)((DVar4 - (int)local_180 ^ uVar6) - uVar6))) {
      local_17c = iVar5;
      local_180 = (int *)GetTickCount();
      iVar2 = 0x26ac;
      pbVar3 = FUN_100020f0(local_188,&DAT_1004d240);
      uVar6 = FUN_10002480((char *)pbVar3,iVar2);
      local_37 = 0;
      local_33 = 0;
      local_2f = 0;
      local_2b = 0;
      local_38 = '\0';
      local_29 = 0;
      _sprintf(&local_38,"%d|%d",uVar6 & 0xffff,iVar5);
      FUN_10001910((int)piVar1,0x61647666,3);
      FUN_10001980(piVar1,(char *)&local_28,s_Testing_10057054,&local_38);
    }
    FUN_10014640(DAT_10058360);
    DVar4 = GetTickCount();
    uVar6 = (int)(DVar4 - local_190) >> 0x1f;
    iVar5 = (DVar4 - local_190 ^ uVar6) - uVar6;
    if (iVar5 < local_184) {
      Sleep(local_184 - iVar5);
    }
  }
  FUN_10001a80((int)piVar1,(int)&local_28,0x10057054);
  FUN_10001ae0(piVar1);
  FUN_10001880();
  FUN_10013ec0(DAT_10058360);
  DAT_10058360 = (int *)0x0;
  if (DAT_10058378 != '\0') {
                    // WARNING: Subroutine does not return
    ExitThread(0);
  }
  if (DAT_10058370 != (code *)0x0) {
    (*DAT_10058370)(0xffffffff);
  }
                    // WARNING: Subroutine does not return
  ExitThread(1);
}



void Catch_100014af(void)

{
  LPVOID pvVar1;
  int unaff_EBP;
  
  pvVar1 = *(LPVOID *)(unaff_EBP + -0x17c);
  if (pvVar1 != (LPVOID)0x0) {
    FUN_10001a80((int)pvVar1,unaff_EBP + -0x24,0x10057054);
    FUN_10001ae0(pvVar1);
    FUN_10001880();
  }
  if (DAT_10058360 != (int *)0x0) {
    FUN_10013ec0(DAT_10058360);
    DAT_10058360 = (int *)0x0;
  }
  if (DAT_10058370 != (code *)0x0) {
    (*DAT_10058370)(*(undefined4 *)(unaff_EBP + -0x180),DAT_10058374);
  }
                    // WARNING: Subroutine does not return
  ExitThread(1);
}



void __cdecl FUN_10001520(SIZE_T param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  
  dwFlags = 0;
  hHeap = GetProcessHeap();
  HeapAlloc(hHeap,dwFlags,param_1);
  return;
}



void __cdecl FUN_10001540(LPVOID param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  
  dwFlags = 0;
  hHeap = GetProcessHeap();
  HeapFree(hHeap,dwFlags,param_1);
  return;
}



undefined4 FUN_10001560(undefined4 param_1,int param_2)

{
  if (param_2 == 0) {
    InterlockedDecrement(&DAT_10058364);
    if (DAT_10058364 == 0) {
      StopServer();
    }
    return 1;
  }
  if (param_2 != 1) {
    return 0;
  }
  InterlockedIncrement(&DAT_10058364);
  return 1;
}



uint __cdecl StartServer(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  
                    // 0x15b0  2  StartServer
  if (DAT_10058368 == (HANDLE)0x0) {
    DAT_1005837c = param_2;
    DAT_10058370 = param_3;
    DAT_10058374 = param_4;
    if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
      _strncpy(s_Testing_10057054,param_1,0x1f);
    }
    DAT_10058378 = 0;
    DAT_10058368 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_100010c0,(LPVOID)0x0,0,
                                (LPDWORD)&DAT_1005836c);
    if (DAT_10058368 == (HANDLE)0x0) {
      uVar1 = FUN_10013ec0(DAT_10058360);
      DAT_10058360 = (int *)0x0;
      return uVar1 & 0xffffff00;
    }
  }
  return CONCAT31((int3)((uint)DAT_10058368 >> 8),1);
}



void __cdecl FUN_10001640(PUCHAR param_1)

{
  _NCB *p_Var1;
  UCHAR UVar2;
  int iVar3;
  undefined4 *puVar4;
  _NCB local_44;
  int local_4;
  
  puVar4 = (undefined4 *)&stack0xffffffb8;
  local_4 = DAT_10057438;
  p_Var1 = &local_44;
  for (iVar3 = 0x10; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined4 *)p_Var1 = 0;
    p_Var1 = (_NCB *)((int)p_Var1 + 4);
  }
  local_44.ncb_command = '2';
  local_44.ncb_lana_num = 0;
  do {
    UVar2 = Netbios(&local_44);
    if (UVar2 == '\0') {
      if (local_44.ncb_lana_num < 10) {
        for (iVar3 = 0x10; puVar4 = puVar4 + 1, iVar3 != 0; iVar3 = iVar3 + -1) {
          *puVar4 = 0;
        }
        builtin_memcpy(local_44.ncb_callname,"*           ",0xc);
        builtin_memcpy(local_44.ncb_callname + 0xc,"    ",4);
        local_44.ncb_command = '3';
        local_44.ncb_name[0] = '\0';
        local_44.ncb_buffer = param_1;
        local_44.ncb_length = 0xf0;
        UVar2 = Netbios(&local_44);
        if (UVar2 == '\0') {
          FUN_1003fb09(local_4);
          return;
        }
      }
      break;
    }
    local_44.ncb_lana_num = local_44.ncb_lana_num + 1;
  } while (local_44.ncb_lana_num < 10);
  FUN_1003fb09(local_4);
  return;
}



undefined4 FUN_10001710(void)

{
  if (DAT_10058380 != 0) {
    return 0xffffffff;
  }
  FUN_10004540(2);
  DAT_10058380 = 1;
  DAT_10058384 = 0;
  DAT_10058388 = 0;
  return 0;
}



void __cdecl FUN_10001750(int param_1,undefined4 *param_2)

{
  undefined4 local_f4;
  undefined2 local_f0;
  int local_4;
  
  local_4 = DAT_10057438;
  if (param_1 == 0x6f70656e) {
    FUN_1003fb09(DAT_10057438);
    return;
  }
  if (DAT_10058380 != 1) {
    FUN_1003fb09(DAT_10057438);
    return;
  }
  if (param_1 == 0x61646472) {
    FUN_10004c80();
    FUN_1003fb09(local_4);
    return;
  }
  if (param_1 != 0x62626e64) {
    if (param_1 == 0x636f6e6e) {
      FUN_1003fb09(DAT_10057438);
      return;
    }
    if (param_1 != 0x6d616378) {
      if (param_1 == 0x6f6e6c6e) {
        FUN_1003fb09(DAT_10057438);
        return;
      }
      FUN_1003fb09(DAT_10057438);
      return;
    }
    FUN_10001640((PUCHAR)&local_f4);
    *param_2 = local_f4;
    *(undefined2 *)(param_2 + 1) = local_f0;
  }
  FUN_1003fb09(local_4);
  return;
}



undefined4 FUN_10001880(void)

{
  FUN_10001b70();
  FUN_10004bd0();
  DAT_10058380 = 0;
  return 0;
}



void __cdecl FUN_100018a0(int param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  
  piVar3 = (int *)(param_1 + 0xd8);
  iVar2 = 4;
  do {
    iVar1 = *piVar3;
    if (iVar1 != 0) {
      (**(code **)(iVar1 + 4))(iVar1);
    }
    *piVar3 = 0;
    piVar3 = piVar3 + 3;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  if (*(DWORD **)(param_1 + 0xa8) != (DWORD *)0x0) {
    FUN_10005650(*(DWORD **)(param_1 + 0xa8));
    *(undefined4 *)(param_1 + 0xa8) = 0;
  }
  if (*(DWORD **)(param_1 + 0xa4) != (DWORD *)0x0) {
    FUN_10005650(*(DWORD **)(param_1 + 0xa4));
    *(undefined4 *)(param_1 + 0xa4) = 0;
  }
  *(undefined4 *)(param_1 + 0xc4) = 0;
  return;
}



void __cdecl FUN_10001910(int param_1,int param_2,int param_3)

{
  if (param_2 == 0x6d776964) {
    if (param_3 < 0x201) {
      *(int *)(param_1 + 200) = param_3 + 0xe;
      return;
    }
  }
  else {
    if (param_2 == 0x6d696e70) {
      *(int *)(param_1 + 0xd0) = param_3;
      return;
    }
    if (param_2 == 0x6d6f7574) {
      *(int *)(param_1 + 0xcc) = param_3;
      return;
    }
    if (param_2 == 0x61647666) {
      *(int *)(param_1 + 0xd4) = param_3;
    }
  }
  return;
}



void __cdecl FUN_10001980(int *param_1,char *param_2,char *param_3,char *param_4)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  char local_104 [256];
  int local_4;
  
  local_4 = DAT_10057438;
  if (param_1[0x29] == 0) {
    iVar2 = FUN_100054c0(0x10);
    param_1[0x29] = iVar2;
  }
  if ((param_3 == (char *)0x0) || (*param_3 == '\0')) {
    _sprintf(local_104,"Default Name");
    pcVar3 = (char *)*param_1;
    if ((char *)*param_1 == (char *)0x0) {
      pcVar3 = PTR_s_00_e0_98_8f_f8_e4_Greg_s_PC_00_e_10057080;
    }
    pcVar3 = _strstr(pcVar3,local_104);
    if (pcVar3 != (char *)0x0) {
      pcVar4 = _strchr(pcVar3,0x3a);
      cVar1 = pcVar4[1];
      pcVar3 = local_104;
      if ('\x1f' < cVar1) {
        do {
          *pcVar3 = cVar1;
          cVar1 = pcVar3[(int)(pcVar4 + 1 + (1 - (int)local_104))];
          pcVar3 = pcVar3 + 1;
        } while ('\x1f' < cVar1);
      }
      *pcVar3 = '\0';
    }
    param_3 = local_104;
  }
  pcVar3 = param_2;
  do {
    cVar1 = *pcVar3;
    pcVar3[(int)param_1 + (4 - (int)param_2)] = cVar1;
    pcVar3 = pcVar3 + 1;
  } while (cVar1 != '\0');
  FUN_100051d0((void *)param_1[0x29],(DWORD *)param_1[0x29],param_2,param_3,param_4,
               "TCP:~1:1024\tUDP:~1:1024",param_1[0x35]);
  FUN_1003fb09(local_4);
  return;
}



void __cdecl FUN_10001a80(int param_1,int param_2,int param_3)

{
  if (*(DWORD **)(param_1 + 0xa4) != (DWORD *)0x0) {
    FUN_10005450(*(DWORD **)(param_1 + 0xa4),param_2,param_3);
    return;
  }
  return;
}



undefined4 * FUN_10001aa0(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)FUN_10001520(0x108);
  if (puVar1 != (undefined4 *)0x0) {
    puVar3 = puVar1;
    for (iVar2 = 0x42; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
  }
  puVar1[0x34] = 0x20;
  puVar1[0x33] = 0x20;
  puVar1[0x32] = 0xfe;
  return puVar1;
}



void __cdecl FUN_10001ae0(LPVOID param_1)

{
  FUN_100018a0((int)param_1);
  FUN_10001540(param_1);
  return;
}



void FUN_10001b00(void)

{
  DWORD DVar1;
  int *piVar2;
  
  piVar2 = &DAT_10058390;
  do {
    if (*piVar2 != 0) {
      DVar1 = GetTickCount();
      (*(code *)*piVar2)(piVar2[1],DVar1);
    }
    piVar2 = piVar2 + 2;
  } while ((int)piVar2 < 0x10058410);
  return;
}



void FUN_10001b30(void)

{
  int iVar1;
  DWORD DVar2;
  
  iVar1 = FUN_10001750(0x6f70656e,(undefined4 *)0x0);
  if (iVar1 != 0) {
    DVar2 = GetTickCount();
    if (DVar2 < DAT_10058420) {
      return;
    }
    DVar2 = GetTickCount();
    DAT_10058420 = DVar2 + 5;
  }
  FUN_10001b00();
  return;
}



void FUN_10001b70(void)

{
  int *piVar1;
  
  piVar1 = &DAT_10058390;
  do {
    if (*piVar1 != 0) {
      *piVar1 = 0;
      piVar1[1] = 0;
    }
    piVar1 = piVar1 + 2;
  } while ((int)piVar1 < 0x10058410);
  DAT_10058420 = 0;
  return;
}



void __fastcall FUN_10001ba0(int param_1)

{
  byte bVar1;
  byte *in_EAX;
  int *unaff_ESI;
  
  if (param_1 < 1) {
    param_1 = 0x100;
  }
  *unaff_ESI = 0;
  bVar1 = *in_EAX;
  for (; (('/' < (char)bVar1 && ((char)bVar1 < ':')) && (0 < param_1)); param_1 = param_1 + -1) {
    in_EAX = in_EAX + 1;
    *unaff_ESI = (bVar1 & 0xf) + *unaff_ESI * 10;
    bVar1 = *in_EAX;
  }
  return;
}



undefined4 * __cdecl FUN_10001bf0(undefined4 *param_1)

{
  int iVar1;
  ulonglong uVar2;
  uint in_EAX;
  uint uVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  uint uVar7;
  
  uVar3 = in_EAX / 0x15180;
  uVar2 = ((ulonglong)in_EAX % 0x15180) / 0x3c;
  *param_1 = (int)(((ulonglong)in_EAX % 0x15180) % 0x3c);
  param_1[1] = (int)(uVar2 % 0x3c);
  param_1[2] = (int)(uVar2 / 0x3c);
  uVar7 = 0x7b2;
  while( true ) {
    if (((uVar7 & 3) == 0) && (((int)uVar7 % 100 != 0 || ((int)uVar7 % 400 == 0)))) {
      uVar4 = 0x16e;
    }
    else {
      uVar4 = 0x16d;
    }
    if ((int)uVar3 < (int)uVar4) break;
    uVar4 = (int)uVar3 / 0x16e + uVar7;
    if (uVar4 == uVar7) {
      uVar4 = uVar4 + 1;
    }
    iVar6 = uVar7 - 1;
    iVar1 = uVar4 - 1;
    uVar3 = uVar3 + ((((((uVar7 - uVar4) * 0x16d + iVar6 / 400) - iVar1 / 400) - iVar6 / 100) +
                      iVar1 / 100 + ((int)(iVar6 + (iVar6 >> 0x1f & 3U)) >> 2)) -
                    ((int)(iVar1 + (iVar1 >> 0x1f & 3U)) >> 2));
    uVar7 = uVar4;
  }
  piVar5 = &DAT_1004d770 + (uVar4 & 1) * 0xc;
  param_1[5] = uVar7 - 0x76c;
  param_1[7] = uVar3;
  param_1[4] = 0;
  iVar6 = *piVar5;
  if (iVar6 <= (int)uVar3) {
    do {
      uVar3 = uVar3 - iVar6;
      piVar5 = piVar5 + 1;
      param_1[4] = param_1[4] + 1;
      iVar6 = *piVar5;
    } while (iVar6 <= (int)uVar3);
  }
  param_1[8] = 0;
  param_1[3] = uVar3 + 1;
  return param_1;
}



uint __cdecl FUN_10001d40(int *param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  int local_14;
  int local_10;
  
  uVar4 = 0;
  uVar2 = 0xffffffff;
  do {
    uVar3 = (uVar2 & uVar4 & 1) + (uVar2 >> 1) + (uVar4 >> 1);
    FUN_10001bf0(&local_24);
    iVar1 = local_10 - param_1[5];
    if (((((iVar1 == 0) && (iVar1 = local_14 - param_1[4], iVar1 == 0)) &&
         (iVar1 = local_18 - param_1[3], iVar1 == 0)) &&
        (((iVar1 = local_1c - param_1[2], iVar1 == 0 && (iVar1 = local_20 - param_1[1], iVar1 == 0))
         && (iVar1 = local_24 - *param_1, iVar1 == 0)))) || (uVar4 == uVar2)) break;
    if (iVar1 < 1) {
      uVar4 = uVar3 + 1;
    }
    else {
      uVar2 = uVar3 - 1;
    }
  } while (uVar4 <= uVar2);
  return (iVar1 != 0) - 1 & uVar3;
}



byte * __cdecl FUN_10001de0(byte *param_1,int param_2,byte *param_3,int param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte bVar6;
  int iVar7;
  byte *pbVar8;
  bool bVar9;
  
  iVar7 = 0;
  if ((param_1 == (byte *)0x0) || (*param_1 == 0x3d)) {
    return (byte *)0x0;
  }
  bVar9 = param_3 == (byte *)0x0;
  if (bVar9) {
    *param_1 = 0;
    param_3 = &DAT_1004d26f;
  }
  bVar6 = *param_3;
  pbVar2 = param_1;
  while (bVar6 != 0) {
    if (*pbVar2 != 0) {
      pbVar2 = pbVar2 + 1;
    }
    iVar4 = iVar7 + 1;
    iVar7 = iVar7 + 1;
    bVar6 = param_3[iVar4];
  }
  bVar6 = *pbVar2;
  if (bVar6 != 0) {
    pbVar3 = pbVar2 + -iVar7;
    iVar4 = (int)pbVar3 - (int)param_3;
    do {
      if (bVar6 == 0x3d) {
        if (pbVar3[iVar7 + -1] < 0x21) {
          return (byte *)0x0;
        }
        if ((pbVar3 == param_1) || (param_3[iVar4 + -1] < 0x21)) {
          pbVar5 = param_3;
          if ((&DAT_1004d548)[*pbVar3] == (&DAT_1004d548)[*param_3]) {
            do {
              pbVar1 = pbVar5 + iVar4 + 1;
              pbVar8 = pbVar5 + 1;
              pbVar5 = pbVar5 + 1;
            } while ((&DAT_1004d548)[*pbVar1] == (&DAT_1004d548)[*pbVar8]);
          }
          if (*pbVar5 == 0) {
            if (*pbVar2 != 0) {
              bVar6 = *pbVar2;
              pbVar3 = pbVar2;
              pbVar5 = pbVar2;
              pbVar8 = (byte *)0x0;
              if (0x1f < bVar6) goto LAB_10001ed7;
              goto LAB_10001ef3;
            }
            break;
          }
        }
      }
      bVar6 = pbVar2[1];
      pbVar2 = pbVar2 + 1;
      pbVar3 = pbVar3 + 1;
      iVar4 = iVar4 + 1;
    } while (bVar6 != 0);
  }
  goto LAB_10001f33;
LAB_10001ef3:
  if (*pbVar3 < 0x20) goto LAB_10001ef8;
  goto LAB_10001f0d;
  while( true ) {
    bVar6 = pbVar5[1];
    pbVar5 = pbVar5 + 1;
    pbVar3 = pbVar5;
    if (bVar6 < 0x20) break;
LAB_10001ed7:
    pbVar3 = pbVar8;
    pbVar8 = pbVar5;
    if (((bVar6 != 0x20) && (pbVar8 = pbVar3, bVar6 == 0x3d)) && (pbVar3 != (byte *)0x0))
    goto LAB_10001ef3;
  }
LAB_10001ef8:
  bVar6 = *pbVar3;
  do {
    if (bVar6 == 0) break;
    bVar6 = pbVar3[1];
    pbVar3 = pbVar3 + 1;
  } while (bVar6 < 0x20);
LAB_10001f0d:
  bVar6 = *pbVar3;
  pbVar2 = pbVar2 + -iVar7;
  *pbVar2 = bVar6;
  while (bVar6 != 0) {
    bVar6 = pbVar3[1];
    pbVar3 = pbVar3 + 1;
    pbVar2 = pbVar2 + 1;
    *pbVar2 = bVar6;
  }
LAB_10001f33:
  if (((pbVar2 == param_1) || (pbVar2[-1] < 0x20)) || ((uint)pbVar2[-1] == (int)(char)DAT_10057084))
  {
    iVar4 = 0;
  }
  else {
    iVar4 = 1;
  }
  if ((int)(param_1 + (param_2 - (int)pbVar2)) < DAT_10057088 + iVar4 + iVar7 + 2 + param_4) {
    return (byte *)0x0;
  }
  if (iVar4 != 0) {
    *pbVar2 = DAT_10057084;
    pbVar2 = pbVar2 + 1;
  }
  bVar6 = *param_3;
  while (bVar6 != 0) {
    *pbVar2 = bVar6;
    pbVar3 = param_3 + 1;
    pbVar2 = pbVar2 + 1;
    param_3 = param_3 + 1;
    bVar6 = *pbVar3;
  }
  if (!bVar9) {
    *pbVar2 = 0x3d;
    pbVar2 = pbVar2 + 1;
  }
  *pbVar2 = 0;
  return pbVar2;
}



undefined4 __fastcall FUN_10001fb0(char *param_1)

{
  char *in_EAX;
  char *pcVar1;
  
  pcVar1 = in_EAX;
  if (in_EAX != param_1) {
    do {
      in_EAX = pcVar1 + -1;
      if ((byte)pcVar1[-1] < 0x20) {
        if (*in_EAX == '\n') {
          *pcVar1 = '\0';
          return 0xffffffff;
        }
        break;
      }
      pcVar1 = in_EAX;
    } while (in_EAX != param_1);
  }
  *in_EAX = '\0';
  return 0xffffffff;
}



undefined1 __cdecl FUN_10001fe0(char param_1)

{
  undefined1 uVar1;
  
  uVar1 = DAT_10057084;
  DAT_10057084 = param_1;
  DAT_10057088 = (uint)(param_1 == '\n');
  return uVar1;
}



void __cdecl FUN_10002000(byte *param_1,byte param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte bVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  pbVar2 = param_1;
  pbVar5 = param_1;
  if (*param_1 != 0) {
    do {
      pbVar4 = pbVar5;
      if (*pbVar2 < 0x20) {
        *pbVar4 = param_2;
        do {
          pbVar5 = pbVar2;
          pbVar2 = pbVar5 + 1;
          if (pbVar5[1] == 0) break;
        } while (pbVar5[1] < 0x20);
        if ((*pbVar2 == 0x3d) && (pbVar5[2] < 0x20)) break;
      }
      else {
        *pbVar4 = *pbVar2;
        pbVar2 = pbVar2 + 1;
      }
      pbVar5 = pbVar4 + 1;
    } while (*pbVar2 != 0);
    pbVar5 = pbVar4 + 1;
    if ((pbVar5 != param_1) && (*pbVar4 == param_2)) {
      if ((param_2 == 10) || (*pbVar2 != 0)) {
        bVar3 = 10;
      }
      else {
        bVar3 = 0;
      }
      *pbVar4 = bVar3;
    }
  }
  bVar3 = *pbVar2;
  while (bVar3 != 0) {
    if (bVar3 < 0x20) {
      *pbVar5 = 10;
      bVar3 = *pbVar2;
      bVar1 = pbVar2[1];
      while (((pbVar2 = pbVar2 + 1, bVar1 != 0 && (bVar1 < 0x20)) && (bVar1 != bVar3))) {
        bVar1 = pbVar2[1];
      }
    }
    else {
      *pbVar5 = bVar3;
      pbVar2 = pbVar2 + 1;
    }
    pbVar5 = pbVar5 + 1;
    bVar3 = *pbVar2;
  }
  *pbVar5 = 0;
  return;
}



int __cdecl FUN_100020b0(char *param_1,int param_2,char *param_3)

{
  int iVar1;
  char *pcVar2;
  
  iVar1 = param_2;
  pcVar2 = param_1;
  if (1 < param_2) {
    do {
      pcVar2 = param_1;
      if (*param_3 == '\0') break;
      pcVar2 = param_1 + 1;
      *param_1 = *param_3;
      param_3 = param_3 + 1;
      iVar1 = iVar1 + -1;
      param_1 = pcVar2;
    } while (1 < iVar1);
  }
  if (0 < iVar1) {
    *pcVar2 = '\0';
  }
  return param_2 - iVar1;
}



byte * __cdecl FUN_100020f0(byte *param_1,byte *param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte bVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte *pbVar8;
  
  pbVar7 = param_1;
  bVar5 = 0;
  if (((param_1 == (byte *)0x0) || (param_2 == (byte *)0x0)) ||
     (param_1 = (byte *)(uint)*param_2, pbVar3 = param_2, *param_2 == 0)) {
    return (byte *)0x0;
  }
  do {
    pbVar8 = pbVar7;
    if (*pbVar8 == 0) {
      return (byte *)0x0;
    }
    pbVar6 = pbVar3 + 1;
    bVar5 = bVar5 | (&DAT_1004d548)[*pbVar3] ^ (&DAT_1004d548)[*pbVar8];
    pbVar7 = pbVar8 + 1;
    pbVar3 = pbVar3 + 1;
  } while (*pbVar6 != 0);
  iVar4 = (int)pbVar3 - (int)param_2;
  if ((bVar5 == 0) && (*pbVar7 == 0x3d)) {
LAB_100021d7:
    return pbVar7 + 1;
  }
  if (*pbVar7 != 0) {
    bVar5 = pbVar8[2];
    pbVar7 = pbVar8 + 2;
    if (bVar5 != 0) {
      pbVar3 = pbVar7 + -iVar4;
      pbVar8 = param_2 + (iVar4 - (int)pbVar7);
      do {
        if (bVar5 == 0x3d) {
          if (pbVar3[iVar4 + -1] < 0x21) {
            return (byte *)0x0;
          }
          if (pbVar3[-1] < 0x21) {
            pbVar6 = pbVar3;
            if ((&DAT_1004d548)[*pbVar3] == param_1[0x1004d548]) {
              do {
                pbVar1 = pbVar6 + 1;
                pbVar2 = pbVar8 + 1 + (int)pbVar6;
                pbVar6 = pbVar6 + 1;
              } while ((&DAT_1004d548)[*pbVar1] == (&DAT_1004d548)[*pbVar2]);
            }
            if (pbVar6 == pbVar7) goto LAB_100021d7;
          }
        }
        bVar5 = pbVar7[1];
        pbVar7 = pbVar7 + 1;
        pbVar8 = pbVar8 + -1;
        pbVar3 = pbVar3 + 1;
      } while (bVar5 != 0);
    }
  }
  return (byte *)0x0;
}



void __cdecl FUN_100021f0(byte *param_1,byte *param_2,byte *param_3)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  byte *pbVar4;
  uint uVar5;
  uint uVar6;
  byte local_104 [256];
  int local_4;
  
  local_4 = DAT_10057438;
  if (param_2 == (byte *)0x0) {
    FUN_100020f0(param_1,param_3);
    FUN_1003fb09(local_4);
    return;
  }
  if (param_3 != (byte *)0x0) {
    iVar3 = -(int)param_2;
    do {
      bVar2 = *param_2;
      param_2[(int)(local_104 + iVar3)] = bVar2;
      param_2 = param_2 + 1;
      pbVar4 = param_3;
    } while (bVar2 != 0);
    do {
      bVar2 = *pbVar4;
      pbVar4 = pbVar4 + 1;
    } while (bVar2 != 0);
    uVar5 = (int)pbVar4 - (int)param_3;
    pbVar4 = &stack0xfffffefb;
    do {
      pbVar1 = pbVar4 + 1;
      pbVar4 = pbVar4 + 1;
    } while (*pbVar1 != 0);
    for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)pbVar4 = *(undefined4 *)param_3;
      param_3 = param_3 + 4;
      pbVar4 = pbVar4 + 4;
    }
    for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
      *pbVar4 = *param_3;
      param_3 = param_3 + 1;
      pbVar4 = pbVar4 + 1;
    }
    FUN_100020f0(param_1,local_104);
    FUN_1003fb09(local_4);
    return;
  }
  FUN_100020f0(param_1,param_2);
  FUN_1003fb09(local_4);
  return;
}



void __cdecl FUN_100022d0(byte *param_1,undefined4 param_2,undefined4 param_3)

{
  byte local_104 [256];
  int local_4;
  
  local_4 = DAT_10057438;
  _sprintf((char *)local_104,"%s%d",param_2,param_3);
  FUN_100020f0(param_1,local_104);
  FUN_1003fb09(local_4);
  return;
}



char * __cdecl FUN_10002330(char *param_1)

{
  char cVar1;
  char *pcVar2;
  byte bVar3;
  
  cVar1 = *param_1;
  pcVar2 = param_1;
  while( true ) {
    if (cVar1 == '\0') {
      return (char *)0x0;
    }
    if ((cVar1 == '=') && ((pcVar2 == param_1 || ((byte)pcVar2[-1] < 0x21)))) break;
    cVar1 = pcVar2[1];
    pcVar2 = pcVar2 + 1;
  }
  bVar3 = pcVar2[1];
  pcVar2 = pcVar2 + 1;
  if (bVar3 == 0) {
    return pcVar2;
  }
  do {
    if (0x20 < bVar3) {
      return pcVar2;
    }
    bVar3 = pcVar2[1];
    pcVar2 = pcVar2 + 1;
  } while (bVar3 != 0);
  return pcVar2;
}



void __cdecl FUN_10002370(byte *param_1,int param_2,byte *param_3,uint param_4)

{
  byte *pbVar1;
  byte bVar2;
  ulonglong uVar3;
  int iVar4;
  uint uVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte local_7 [3];
  int local_4;
  
  local_4 = DAT_10057438;
  uVar5 = param_4;
  if ((int)param_4 < 10) {
    if (-1 < (int)param_4) {
      pbVar7 = FUN_10001de0(param_1,param_2,param_3,1);
      iVar4 = DAT_10057088;
      if (pbVar7 != (byte *)0x0) {
        *pbVar7 = (char)param_4 + 0x30;
        pbVar6 = pbVar7 + 1;
        if ((iVar4 != 0) && (param_3 != (byte *)0x0)) {
          *pbVar6 = DAT_10057084;
          pbVar6 = pbVar7 + 2;
        }
        *pbVar6 = 0;
        FUN_1003fb09(local_4);
        return;
      }
      goto LAB_100023dd;
    }
    uVar5 = -param_4;
  }
  local_7[2] = 0;
  pbVar7 = local_7 + 2;
  do {
    pbVar6 = pbVar7;
    uVar3 = (ulonglong)uVar5;
    uVar5 = uVar5 / 10;
    pbVar7 = pbVar6 + -1;
    *pbVar7 = (char)(uVar3 % 10) + 0x30;
  } while (uVar5 != 0);
  if ((int)param_4 < 0) {
    pbVar7 = pbVar6 + -2;
    *pbVar7 = 0x2d;
  }
  pbVar6 = FUN_10001de0(param_1,param_2,param_3,(int)(local_7 + (2 - (int)pbVar7)));
  if (pbVar6 != (byte *)0x0) {
    bVar2 = *pbVar7;
    while (bVar2 != 0) {
      *pbVar6 = bVar2;
      pbVar1 = pbVar7 + 1;
      pbVar6 = pbVar6 + 1;
      pbVar7 = pbVar7 + 1;
      bVar2 = *pbVar1;
    }
    if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
      *pbVar6 = DAT_10057084;
      pbVar6 = pbVar6 + 1;
    }
    *pbVar6 = 0;
    FUN_1003fb09(local_4);
    return;
  }
LAB_100023dd:
  FUN_1003fb09(local_4);
  return;
}



int __cdecl FUN_10002480(char *param_1,int param_2)

{
  char *pcVar1;
  char cVar2;
  byte bVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  
  iVar6 = 1;
  uVar5 = 10;
  if (param_1 == (char *)0x0) {
    return param_2;
  }
  cVar2 = *param_1;
  if (cVar2 == '-') {
    param_1 = param_1 + 1;
    iVar6 = -1;
  }
  else {
    if (cVar2 == '$') {
      uVar5 = 0x10;
    }
    else if (cVar2 != '+') goto LAB_100024b7;
    param_1 = param_1 + 1;
  }
LAB_100024b7:
  iVar4 = 0;
  bVar3 = (&DAT_1004d448)[*param_1];
  while (bVar3 < uVar5) {
    iVar4 = iVar4 * uVar5 + (uint)bVar3;
    pcVar1 = param_1 + 1;
    param_1 = param_1 + 1;
    bVar3 = (&DAT_1004d448)[*pcVar1];
  }
  return iVar4 * iVar6;
}



int __cdecl FUN_100024f0(byte *param_1,int param_2,byte *param_3,uint param_4)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  char *pcVar5;
  
  iVar2 = DAT_10057088;
  iVar1 = -1 - DAT_10057088;
  pbVar3 = FUN_10001de0(param_1,param_2,param_3,0);
  if (pbVar3 == (byte *)0x0) {
    return -1;
  }
  pcVar5 = "@ABCDEFGHIJKLMNOPQRSTUVWXYZ0123-";
  if (param_4 != 0) {
    do {
      if (*pcVar5 == 0) break;
      if ((param_4 & 1) != 0) {
        if (param_1 + param_2 + iVar1 <= pbVar3) {
          pbVar4 = pbVar3;
          if (pbVar3 != param_1) {
            while (pbVar3 = pbVar4 + -1, 0x1f < pbVar4[-1]) {
              pbVar4 = pbVar3;
              if (pbVar3 == param_1) {
                *pbVar3 = 0;
                return -1;
              }
            }
            if (*pbVar3 == 10) {
              pbVar3 = pbVar4;
            }
          }
          *pbVar3 = 0;
          return -1;
        }
        *pbVar3 = *pcVar5;
        pbVar3 = pbVar3 + 1;
      }
      param_4 = (int)param_4 >> 1;
      pcVar5 = (char *)((byte *)pcVar5 + 1);
    } while (param_4 != 0);
  }
  if ((iVar2 != 0) && (param_3 != (byte *)0x0)) {
    *pbVar3 = DAT_10057084;
    pbVar3 = pbVar3 + 1;
  }
  *pbVar3 = 0;
  return (int)pbVar3 - (int)param_1;
}



uint __cdecl FUN_100025a0(char *param_1,uint param_2)

{
  char *pcVar1;
  byte bVar2;
  uint uVar3;
  
  if (param_1 == (char *)0x0) {
    return param_2;
  }
  uVar3 = 0;
  bVar2 = (&DAT_1004d670)[*param_1];
  while (-1 < (char)bVar2) {
    pcVar1 = param_1 + 1;
    uVar3 = uVar3 | 1 << (bVar2 & 0x1f);
    param_1 = param_1 + 1;
    bVar2 = (&DAT_1004d670)[*pcVar1];
  }
  return uVar3;
}



void __cdecl FUN_100025e0(byte *param_1,int param_2,byte *param_3,uint param_4)

{
  byte *pbVar1;
  ulonglong uVar2;
  byte bVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  byte bVar8;
  byte bVar9;
  uint uVar10;
  byte local_14 [16];
  int local_4;
  
  bVar8 = (byte)param_4;
  bVar9 = (byte)(param_4 >> 8);
  uVar10 = param_4 >> 0x10;
  bVar7 = (byte)(param_4 >> 0x10);
  local_4 = DAT_10057438;
  uVar4 = param_4 >> 0x18;
  bVar3 = (byte)(param_4 >> 0x18);
  pbVar5 = local_14;
  if (9 < bVar3) {
    if (99 < bVar3) {
      uVar2 = (ulonglong)uVar4;
      uVar4 = uVar4 % 100;
      pbVar5 = local_14 + 1;
      local_14[0] = (char)(uVar2 / 100) + 0x30;
    }
    *pbVar5 = (char)((ulonglong)uVar4 / 10) + 0x30;
    pbVar5 = pbVar5 + 1;
    bVar3 = (byte)(uVar4 % 10);
  }
  *pbVar5 = bVar3 + 0x30;
  pbVar5[1] = 0x2e;
  pbVar6 = pbVar5 + 2;
  if (9 < bVar7) {
    if (99 < bVar7) {
      *pbVar6 = (char)((ulonglong)(uVar10 & 0xff) / 100) + 0x30;
      pbVar6 = pbVar5 + 3;
      uVar10 = (uint)(byte)((ulonglong)(uVar10 & 0xff) % 100);
    }
    *pbVar6 = (char)((ulonglong)(uVar10 & 0xff) / 10) + 0x30;
    bVar7 = (byte)((ulonglong)(uVar10 & 0xff) % 10);
    pbVar6 = pbVar6 + 1;
  }
  *pbVar6 = bVar7 + 0x30;
  pbVar6[1] = 0x2e;
  pbVar5 = pbVar6 + 2;
  uVar4 = (uint)bVar9;
  if (9 < bVar9) {
    if (99 < bVar9) {
      uVar4 = (uint)bVar9 % 100;
      *pbVar5 = (char)((ulonglong)(uint)bVar9 / 100) + 0x30;
      pbVar5 = pbVar6 + 3;
    }
    *pbVar5 = (char)((ulonglong)uVar4 / 10) + 0x30;
    pbVar5 = pbVar5 + 1;
    bVar9 = (byte)(uVar4 % 10);
  }
  *pbVar5 = bVar9 + 0x30;
  pbVar5[1] = 0x2e;
  pbVar6 = pbVar5 + 2;
  if (9 < bVar8) {
    if (99 < bVar8) {
      bVar3 = bVar8 / 100;
      bVar8 = bVar8 % 100;
      *pbVar6 = bVar3 + 0x30;
      pbVar6 = pbVar5 + 3;
    }
    bVar3 = bVar8 / 10;
    bVar8 = bVar8 % 10;
    *pbVar6 = bVar3 + 0x30;
    pbVar6 = pbVar6 + 1;
  }
  *pbVar6 = bVar8 + 0x30;
  pbVar6[1] = 0;
  pbVar5 = FUN_10001de0(param_1,param_2,param_3,(int)(pbVar6 + 1) - (int)local_14);
  if (pbVar5 == (byte *)0x0) {
    FUN_1003fb09(local_4);
    return;
  }
  pbVar6 = local_14;
  bVar3 = local_14[0];
  while (bVar3 != 0) {
    *pbVar5 = bVar3;
    pbVar1 = pbVar6 + 1;
    pbVar5 = pbVar5 + 1;
    pbVar6 = pbVar6 + 1;
    bVar3 = *pbVar1;
  }
  if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
    *pbVar5 = DAT_10057084;
    pbVar5 = pbVar5 + 1;
  }
  *pbVar5 = 0;
  FUN_1003fb09(local_4);
  return;
}



uint __cdecl FUN_10002780(byte *param_1,uint param_2)

{
  byte bVar1;
  uint uVar2;
  
  uVar2 = 0;
  if (param_1 != (byte *)0x0) {
    while( true ) {
      while( true ) {
        bVar1 = *param_1;
        if (((char)bVar1 < '0') || ('9' < (char)bVar1)) break;
        uVar2 = uVar2 & 0xffffff00 | (bVar1 & 0xf) + (uVar2 & 0xff) * 10;
        param_1 = param_1 + 1;
      }
      param_2 = uVar2;
      if (bVar1 != 0x2e) break;
      uVar2 = uVar2 << 8;
      param_1 = param_1 + 1;
    }
  }
  return param_2;
}



void __cdecl FUN_100027d0(byte *param_1,int param_2,byte *param_3,uint param_4)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte local_11 [11];
  byte local_6 [2];
  int local_4;
  
  local_4 = DAT_10057438;
  local_6[1] = 0;
  if (((&DAT_1004d338)[param_4 & 0xff] & 2) == 0) {
    pbVar5 = local_6;
    uVar3 = param_4;
  }
  else {
    local_11[10] = (&DAT_1004d438)[(param_4 & 0xff) >> 4];
    pbVar5 = local_11 + 9;
    local_11[9] = 0x25;
    uVar3 = (uint)(byte)(&DAT_1004d438)[param_4 & 0xf];
  }
  local_6[0] = (byte)uVar3;
  uVar3 = param_4 >> 8 & 0xff;
  pbVar4 = pbVar5 + -1;
  if (((&DAT_1004d338)[uVar3] & 2) == 0) {
    *pbVar4 = (byte)(param_4 >> 8);
  }
  else {
    *pbVar4 = (&DAT_1004d438)[param_4 >> 8 & 0xf];
    pbVar5[-2] = (&DAT_1004d438)[uVar3 >> 4];
    pbVar4 = pbVar5 + -3;
    *pbVar4 = 0x25;
  }
  bVar2 = (byte)(param_4 >> 0x10);
  pbVar5 = pbVar4 + -1;
  if (((&DAT_1004d338)[bVar2] & 2) == 0) {
    *pbVar5 = bVar2;
  }
  else {
    *pbVar5 = (&DAT_1004d438)[bVar2 & 0xf];
    pbVar4[-2] = (&DAT_1004d438)[bVar2 >> 4];
    pbVar5 = pbVar4 + -3;
    *pbVar5 = 0x25;
  }
  pbVar4 = pbVar5 + -1;
  if (((&DAT_1004d338)[param_4 >> 0x18] & 2) == 0) {
    *pbVar4 = (byte)(param_4 >> 0x18);
  }
  else {
    *pbVar4 = (&DAT_1004d438)[param_4 >> 0x18 & 0xf];
    pbVar5[-2] = (&DAT_1004d438)[param_4 >> 0x1c];
    pbVar4 = pbVar5 + -3;
    *pbVar4 = 0x25;
  }
  pbVar5 = FUN_10001de0(param_1,param_2,param_3,(int)(local_6 + (1 - (int)pbVar4)));
  if (pbVar5 != (byte *)0x0) {
    bVar2 = *pbVar4;
    while (bVar2 != 0) {
      *pbVar5 = bVar2;
      pbVar1 = pbVar4 + 1;
      pbVar5 = pbVar5 + 1;
      pbVar4 = pbVar4 + 1;
      bVar2 = *pbVar1;
    }
    if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
      *pbVar5 = DAT_10057084;
      pbVar5 = pbVar5 + 1;
    }
    *pbVar5 = 0;
    FUN_1003fb09(local_4);
    return;
  }
  FUN_1003fb09(local_4);
  return;
}



uint __cdecl FUN_10002930(byte *param_1,uint param_2)

{
  uint3 uVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte bVar4;
  byte bVar5;
  byte bVar6;
  
  if ((param_1 == (byte *)0x0) || (bVar6 = *param_1, bVar6 < 0x21)) {
    return param_2;
  }
  pbVar2 = param_1 + 1;
  if (bVar6 < 0x20) {
    bVar6 = 0x20;
    pbVar2 = param_1;
  }
  else if (bVar6 == 0x25) {
    bVar6 = (&DAT_1004d448)[*pbVar2] << 4 | (&DAT_1004d448)[param_1[2]];
    pbVar2 = param_1 + 3;
  }
  bVar4 = *pbVar2;
  pbVar3 = pbVar2 + 1;
  if (bVar4 < 0x20) {
    bVar4 = 0x20;
    pbVar3 = pbVar2;
  }
  else if (bVar4 == 0x25) {
    bVar4 = (&DAT_1004d448)[*pbVar3] << 4 | (&DAT_1004d448)[pbVar2[2]];
    pbVar3 = pbVar2 + 3;
  }
  bVar5 = *pbVar3;
  pbVar2 = pbVar3 + 1;
  if (bVar5 < 0x20) {
    bVar5 = 0x20;
    pbVar2 = pbVar3;
  }
  else if (bVar5 == 0x25) {
    bVar5 = (&DAT_1004d448)[*pbVar2] << 4 | (&DAT_1004d448)[pbVar3[2]];
    pbVar2 = pbVar3 + 3;
  }
  uVar1 = CONCAT21(CONCAT11(bVar6,bVar4),bVar5);
  bVar6 = *pbVar2;
  if (bVar6 < 0x20) {
    return (uint)uVar1 << 8 | 0x20;
  }
  if (bVar6 == 0x25) {
    bVar6 = (&DAT_1004d448)[pbVar2[1]] << 4 | (&DAT_1004d448)[pbVar2[2]];
  }
  return CONCAT31(uVar1,bVar6);
}



int __cdecl FUN_10002a30(byte *param_1,byte *param_2,int param_3,byte *param_4)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  byte bVar4;
  byte *pbVar5;
  
  pbVar5 = param_1;
  if (param_1 != (byte *)0x0) {
    if (*param_1 == 0x22) {
      param_1._0_1_ = 0x22;
      pbVar5 = pbVar5 + 1;
      bVar4 = 0x22;
    }
    else {
      param_1._0_1_ = 0x20;
      bVar2 = (byte)param_1;
      param_1._0_1_ = 0x20;
      bVar4 = (byte)param_1;
      param_1._0_1_ = bVar2;
    }
    if (param_2 == (byte *)0x0) {
      iVar3 = 0;
      if (*pbVar5 != bVar4) {
        while (0x1f < *pbVar5) {
          if (((*pbVar5 == 0x25) && (0x1f < pbVar5[1])) && (0x1f < pbVar5[2])) {
            pbVar5 = pbVar5 + 2;
          }
          pbVar1 = pbVar5 + 1;
          iVar3 = iVar3 + 1;
          pbVar5 = pbVar5 + 1;
          if (*pbVar1 == bVar4) {
            return iVar3;
          }
        }
      }
    }
    else {
      if (param_3 < 1) {
        return -1;
      }
      iVar3 = 1;
      if (1 < param_3) {
        iVar3 = 1;
        do {
          bVar2 = *pbVar5;
          if ((bVar2 == (byte)param_1) || (bVar2 < 0x20)) break;
          if (bVar2 == 0x25) {
            bVar4 = pbVar5[1];
            if (bVar4 == 0x25) {
              *param_2 = 0x25;
              pbVar5 = pbVar5 + 2;
            }
            else {
              if ((bVar4 < 0x20) || (pbVar5[2] < 0x20)) goto LAB_10002b4d;
              *param_2 = (&DAT_1004d448)[bVar4] << 4 | (&DAT_1004d448)[pbVar5[2]];
              pbVar5 = pbVar5 + 3;
            }
          }
          else {
LAB_10002b4d:
            *param_2 = bVar2;
            pbVar5 = pbVar5 + 1;
          }
          param_2 = param_2 + 1;
          iVar3 = iVar3 + 1;
        } while (iVar3 < param_3);
      }
      *param_2 = 0;
      iVar3 = iVar3 + -1;
    }
    return iVar3;
  }
  if (param_4 == (byte *)0x0) {
    return -1;
  }
  if (param_2 == (byte *)0x0) {
    pbVar5 = param_4 + 1;
    do {
      bVar2 = *param_4;
      param_4 = param_4 + 1;
    } while (bVar2 != 0);
    return (int)param_4 - (int)pbVar5;
  }
  iVar3 = 1;
  pbVar5 = param_2;
  if (1 < param_3) {
    do {
      pbVar5 = param_2;
      if (*param_4 == 0) break;
      pbVar5 = param_2 + 1;
      *param_2 = *param_4;
      param_4 = param_4 + 1;
      iVar3 = iVar3 + 1;
      param_2 = pbVar5;
    } while (iVar3 < param_3);
  }
  *pbVar5 = 0;
  return iVar3 + -1;
}



int __cdecl FUN_10002b70(byte *param_1,int param_2,byte *param_3,byte *param_4,int param_5)

{
  byte *pbVar1;
  
  if (param_5 < 0) {
    return -1;
  }
  pbVar1 = FUN_10001de0(param_1,param_2,param_3,param_5 * 2 + 1);
  if (pbVar1 != (byte *)0x0) {
    *pbVar1 = 0x24;
    pbVar1 = pbVar1 + 1;
    if (0 < param_5) {
      do {
        *pbVar1 = (&DAT_1004d438)[*param_4 >> 4];
        pbVar1[1] = (&DAT_1004d438)[*param_4 & 0xf];
        pbVar1 = pbVar1 + 2;
        param_4 = param_4 + 1;
        param_5 = param_5 + -1;
      } while (param_5 != 0);
    }
    if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
      *pbVar1 = DAT_10057084;
      pbVar1 = pbVar1 + 1;
    }
    *pbVar1 = 0;
    return (int)pbVar1 - (int)param_1;
  }
  return -1;
}



byte * __cdecl FUN_10002c10(char *param_1,byte *param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  char cVar3;
  int iVar4;
  char *pcVar5;
  uint uVar6;
  byte bVar7;
  int iVar8;
  byte *pbVar9;
  
  pbVar2 = param_2 + param_3;
  if ((param_1 != (char *)0x0) && ((cVar3 = *param_1, cVar3 == '$' || (cVar3 == '^')))) {
    if (param_2 == (byte *)0x0) {
      bVar7 = param_1[1];
      pcVar5 = param_1 + 1;
      if (cVar3 != '$') {
        while (0x7f < bVar7) {
          pbVar2 = (byte *)(pcVar5 + 1);
          pcVar5 = pcVar5 + 1;
          bVar7 = *pbVar2;
        }
        return (byte *)((int)((int)(pcVar5 + (-1 - (int)param_1)) * 7 +
                             ((int)(pcVar5 + (-1 - (int)param_1)) * 7 >> 0x1f & 7U)) >> 3);
      }
      for (; (0x2f < bVar7 && (0x2f < (byte)pcVar5[1])); pcVar5 = pcVar5 + 2) {
        bVar7 = pcVar5[2];
      }
      return (byte *)((int)(pcVar5 + (-1 - (int)param_1)) / 2);
    }
    if (0 < param_3) {
      if (cVar3 == '$') {
        bVar7 = param_1[1];
        pbVar9 = (byte *)(param_1 + 1);
        if (0x2f < bVar7) {
          while ((pbVar1 = pbVar9 + 1, 0x2f < *pbVar1 && (param_2 < pbVar2))) {
            pbVar9 = pbVar9 + 2;
            *param_2 = (&DAT_1004d448)[bVar7] << 4 | (&DAT_1004d448)[*pbVar1];
            bVar7 = *pbVar9;
            param_2 = param_2 + 1;
            if (bVar7 < 0x30) {
              return param_2 + (param_3 - (int)pbVar2);
            }
          }
        }
      }
      else {
        pbVar9 = (byte *)(param_1 + 1);
        bVar7 = *pbVar9;
        uVar6 = 0;
        iVar4 = 0;
        while ((0x7f < bVar7 && (param_2 < pbVar2))) {
          iVar8 = iVar4 + 7;
          uVar6 = uVar6 | (bVar7 & 0x7f) << ((byte)iVar4 & 0x1f);
          if (7 < iVar8) {
            *param_2 = (byte)uVar6;
            param_2 = param_2 + 1;
            uVar6 = uVar6 >> 8;
            iVar8 = iVar4 + -1;
          }
          bVar7 = pbVar9[1];
          pbVar9 = pbVar9 + 1;
          iVar4 = iVar8;
        }
      }
      return param_2 + (param_3 - (int)pbVar2);
    }
  }
  return (byte *)0xffffffff;
}



int __cdecl
FUN_10002d30(byte *param_1,int param_2,byte *param_3,uint *param_4,int param_5,byte *param_6)

{
  byte *pbVar1;
  uint *puVar2;
  byte *pbVar3;
  byte *pbVar4;
  int iVar5;
  byte bVar6;
  byte *pbVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  uint local_4;
  
  local_4 = 0;
  if (param_5 < 0) {
    puVar2 = param_4 + 0x4000;
  }
  else {
    puVar2 = (uint *)((int)param_4 + param_5);
  }
  pbVar1 = param_1 + param_2 + -2;
  pbVar3 = FUN_10001de0(param_1,param_2,param_3,0);
  if (pbVar3 == (byte *)0x0) {
    return -1;
  }
  bVar6 = *param_6;
  pbVar8 = param_6;
joined_r0x10002d8b:
  if ((bVar6 == 0) || (puVar2 <= param_4)) {
    bVar6 = pbVar3[-1];
    while (bVar6 == 0x2c) {
      pbVar1 = pbVar3 + -2;
      pbVar3 = pbVar3 + -1;
      bVar6 = *pbVar1;
    }
    if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
      *pbVar3 = DAT_10057084;
      pbVar3 = pbVar3 + 1;
    }
    *pbVar3 = 0;
    return (int)pbVar3 - (int)param_1;
  }
  if (bVar6 == 0x23) {
    pbVar8 = pbVar8 + 1;
    do {
      bVar6 = *pbVar8;
      param_6 = pbVar8;
      if (bVar6 == 0) break;
      pbVar8 = pbVar8 + 1;
      param_6 = pbVar8;
    } while (bVar6 != 0x3d);
  }
  iVar10 = 0;
  bVar6 = *pbVar8;
  while (('/' < (char)bVar6 && (param_6 = pbVar8, (char)bVar6 < ':'))) {
    pbVar8 = pbVar8 + 1;
    iVar10 = (bVar6 & 0xf) + iVar10 * 10;
    param_6 = pbVar8;
    bVar6 = *pbVar8;
  }
  bVar6 = *pbVar8;
  if (bVar6 == 0x61) {
    iVar5 = iVar10;
    if (iVar10 == 0) {
      iVar5 = 1;
    }
    param_4 = (uint *)((int)param_4 + iVar5);
  }
  iVar5 = 0;
  if (bVar6 == 0x62) {
    local_4 = (uint)(byte)*param_4;
    param_4 = (uint *)((int)param_4 + 1);
    iVar5 = 2;
  }
  if (bVar6 == 0x77) {
    local_4 = (uint)(ushort)*param_4;
    param_4 = (uint *)((int)param_4 + 2);
    iVar5 = 4;
  }
  if (bVar6 != 0x6c) {
    if (iVar5 != 0) goto LAB_10002e2f;
    goto LAB_10002ea3;
  }
  local_4 = *param_4;
  param_4 = param_4 + 1;
  iVar5 = 8;
LAB_10002e2f:
  if (pbVar3 + iVar5 <= pbVar1) {
    pbVar4 = pbVar3;
    if (0xffff0000 < local_4) {
      local_4 = -local_4;
      *pbVar3 = 0x2d;
      pbVar4 = pbVar3 + 1;
    }
    iVar9 = 0x1c;
    do {
      if ((local_4 >> ((byte)iVar9 & 0x1f) & 0xf) != 0) goto joined_r0x10002e76;
      iVar9 = iVar9 + -4;
    } while (-1 < iVar9);
    goto LAB_10002e91;
  }
  if (pbVar3 == param_1) goto LAB_10002f8f;
  while (pbVar1 = pbVar3 + -1, pbVar3 = pbVar3 + -1, 0x1f < *pbVar1) {
    if (pbVar3 == param_1) {
      *pbVar3 = 0;
      return -1;
    }
  }
LAB_10002f89:
  if (*pbVar3 == 10) {
    pbVar3 = pbVar3 + 1;
  }
LAB_10002f8f:
  *pbVar3 = 0;
  return -1;
joined_r0x10002e76:
  for (; -1 < iVar9; iVar9 = iVar9 + -4) {
    *pbVar4 = (&DAT_1004d438)[local_4 >> ((byte)iVar9 & 0x1f) & 0xf];
    pbVar4 = pbVar4 + 1;
  }
LAB_10002e91:
  pbVar7 = pbVar3 + iVar5;
  pbVar3 = pbVar4;
  pbVar8 = param_6;
  if (pbVar4 < pbVar7) {
    *pbVar4 = 0x2c;
    pbVar3 = pbVar4 + 1;
  }
LAB_10002ea3:
  pbVar4 = pbVar3;
  if ((*pbVar8 != 0x73) || (iVar10 < 1)) {
LAB_10002f1a:
    if (pbVar8[1] != 0x2a) {
      pbVar8 = pbVar8 + 1;
      param_6 = pbVar8;
    }
    bVar6 = *pbVar8;
    pbVar3 = pbVar4;
    goto joined_r0x10002d8b;
  }
  iVar5 = 0;
  if (iVar10 < 1) {
LAB_10002efe:
    pbVar4 = pbVar3 + 1;
    param_4 = (uint *)((int)param_4 + (iVar10 - iVar5));
    if (pbVar4 <= pbVar1) {
      *pbVar3 = 0x2c;
      pbVar8 = param_6;
      goto LAB_10002f1a;
    }
    if (pbVar3 == param_1) goto LAB_10002f8f;
    while (pbVar1 = pbVar3 + -1, pbVar3 = pbVar3 + -1, 0x1f < *pbVar1) {
      if (pbVar3 == param_1) {
        *pbVar3 = 0;
        return -1;
      }
    }
  }
  else {
    pbVar8 = pbVar3 + 3;
    while( true ) {
      bVar6 = (byte)*param_4;
      if (bVar6 == 0) goto LAB_10002efe;
      if (pbVar1 < pbVar8) break;
      pbVar4 = pbVar3;
      if (((&DAT_1004d338)[bVar6] & 4) != 0) {
        *pbVar3 = 0x25;
        pbVar3[1] = (&DAT_1004d438)[(byte)((byte)*param_4 >> 4)];
        pbVar4 = pbVar3 + 2;
        pbVar8 = pbVar8 + 2;
        bVar6 = (&DAT_1004d438)[(byte)*param_4 & 0xf];
      }
      pbVar3 = pbVar4 + 1;
      *pbVar4 = bVar6;
      pbVar8 = pbVar8 + 1;
      iVar5 = iVar5 + 1;
      param_4 = (uint *)((int)param_4 + 1);
      if (iVar10 <= iVar5) goto LAB_10002efe;
    }
    if (pbVar3 == param_1) goto LAB_10002f8f;
    while (pbVar1 = pbVar3 + -1, pbVar3 = pbVar3 + -1, 0x1f < *pbVar1) {
      if (pbVar3 == param_1) {
        *pbVar3 = 0;
        return -1;
      }
    }
  }
  goto LAB_10002f89;
}



void __cdecl FUN_10002fe0(byte *param_1,uint *param_2,int param_3,byte *param_4)

{
  byte *pbVar1;
  byte bVar2;
  byte bVar3;
  uint *puVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  byte *pbVar8;
  int iVar9;
  byte *pbVar10;
  uint *puVar11;
  uint *local_410;
  uint *local_408;
  uint local_404 [256];
  int local_4;
  
  local_410 = param_2;
  if (param_3 < 0) {
    local_408 = (uint *)((int)param_2 + 0xffff);
  }
  else {
    local_408 = (uint *)((int)param_2 + param_3);
  }
  if (param_1 == (byte *)0x0) {
    param_1 = &DAT_1004d26f;
  }
  if (param_2 == (uint *)0x0) {
    local_410 = local_404;
  }
  puVar4 = local_410;
  bVar2 = *param_4;
  local_4 = DAT_10057438;
  puVar11 = local_410;
  while ((bVar2 != 0 && (bVar3 = *param_1, 0x20 < bVar3))) {
    iVar6 = 0;
    pbVar8 = param_4;
    while (('/' < (char)bVar2 && ((char)bVar2 < ':'))) {
      pbVar8 = pbVar8 + 1;
      iVar6 = (bVar2 & 0xf) + iVar6 * 10;
      bVar2 = *pbVar8;
    }
    bVar2 = *pbVar8;
    if (bVar2 == 0x6c) {
      iVar6 = 8;
LAB_1000309d:
      if (bVar3 == 0x2d) {
        param_1 = param_1 + 1;
      }
      uVar5 = 0;
      do {
        if (0xf < (byte)(&DAT_1004d448)[*param_1]) {
          if ((0 < iVar6) && (*param_1 == 0x2c)) {
            param_1 = param_1 + 1;
          }
          break;
        }
        uVar5 = uVar5 << 4 | (uint)(byte)(&DAT_1004d448)[*param_1];
        iVar6 = iVar6 + -1;
        param_1 = param_1 + 1;
      } while (0 < iVar6);
      if (bVar3 == 0x2d) {
        uVar5 = -uVar5;
      }
      if (bVar2 == 0x6c) {
        *puVar11 = uVar5;
        puVar11 = puVar11 + 1;
        local_410 = puVar11;
      }
      else if (bVar2 == 0x62) {
        *(byte *)puVar11 = (byte)uVar5;
        puVar11 = (uint *)((int)puVar11 + 1);
        local_410 = puVar11;
      }
      else if (bVar2 == 0x77) {
        *(short *)puVar11 = (short)uVar5;
        puVar11 = (uint *)((int)puVar11 + 2);
        local_410 = puVar11;
      }
    }
    else {
      if (bVar2 == 0x62) {
        iVar6 = 2;
        goto LAB_1000309d;
      }
      if (bVar2 == 0x77) {
        iVar6 = 4;
        goto LAB_1000309d;
      }
      if ((bVar2 == 0x73) && (0 < iVar6)) {
        iVar9 = 0;
        puVar11 = local_410;
        while (((bVar2 = *param_1, 0x2f < bVar2 || (bVar2 == 0x25)) &&
               ((int)((1 - (int)local_410) + (int)puVar11) < iVar6))) {
          if (bVar2 == 0x25) {
            pbVar10 = param_1 + 1;
            pbVar1 = param_1 + 2;
            param_1 = param_1 + 3;
            *(undefined *)puVar11 = (&DAT_1004d448)[*pbVar10] << 4 | (&DAT_1004d448)[*pbVar1];
            iVar9 = iVar9 + 1;
            puVar11 = (uint *)((int)puVar11 + 1);
          }
          else {
            param_1 = param_1 + 1;
            *(byte *)puVar11 = bVar2;
            iVar9 = iVar9 + 1;
            puVar11 = (uint *)((int)puVar11 + 1);
          }
        }
        if (iVar9 < iVar6) {
          uVar5 = iVar6 - iVar9;
          pbVar10 = (byte *)(iVar9 + (int)local_410);
          for (uVar7 = uVar5 >> 2; uVar7 != 0; uVar7 = uVar7 - 1) {
            pbVar10[0] = 0;
            pbVar10[1] = 0;
            pbVar10[2] = 0;
            pbVar10[3] = 0;
            pbVar10 = pbVar10 + 4;
          }
          for (uVar7 = uVar5 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
            *pbVar10 = 0;
            pbVar10 = pbVar10 + 1;
          }
          iVar9 = iVar9 + uVar5;
        }
        puVar11 = (uint *)((int)local_410 + iVar9);
        local_410 = puVar11;
        if (*param_1 == 0x2c) {
          param_1 = param_1 + 1;
        }
      }
      else if (bVar2 == 0x61) {
        if (iVar6 == 0) {
          iVar6 = 1;
        }
        puVar11 = (uint *)((int)puVar11 + iVar6);
        local_410 = puVar11;
      }
    }
    if (local_408 <= puVar11) break;
    param_4 = pbVar8 + 1;
    if (pbVar8[1] == 0x2a) {
      param_4 = pbVar8;
    }
    bVar2 = *param_4;
  }
  if ((int)puVar11 - (int)puVar4 < param_3) {
    uVar7 = param_3 - ((int)puVar11 - (int)puVar4);
    for (uVar5 = uVar7 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
      *(byte *)puVar11 = 0;
      puVar11 = (uint *)((int)puVar11 + 1);
    }
  }
  FUN_1003fb09(local_4);
  return;
}



void __cdecl FUN_10003240(byte *param_1,int param_2,byte *param_3,int param_4)

{
  char cVar1;
  undefined4 *puVar2;
  int iVar3;
  byte *pbVar4;
  char *pcVar5;
  int iVar6;
  undefined4 local_3c [9];
  char local_18 [20];
  int local_4;
  
  local_4 = DAT_10057438;
  if (param_4 == 0) {
    FUN_10005b50();
  }
  puVar2 = FUN_10001bf0(local_3c);
  if (puVar2 == (undefined4 *)0x0) {
    FUN_1003fb09(local_4);
    return;
  }
  iVar3 = _sprintf(local_18,"%d.%d.%d-%d:%02d:%02d",puVar2[5] + 0x76c,puVar2[4] + 1,puVar2[3],
                   puVar2[2],puVar2[1],*puVar2);
  pbVar4 = FUN_10001de0(param_1,param_2,param_3,iVar3);
  if (pbVar4 == (byte *)0x0) {
    FUN_1003fb09(local_4);
    return;
  }
  pcVar5 = local_18;
  iVar6 = (int)pbVar4 - (int)pcVar5;
  do {
    cVar1 = *pcVar5;
    pcVar5[iVar6] = cVar1;
    pcVar5 = pcVar5 + 1;
  } while (cVar1 != '\0');
  pbVar4 = pbVar4 + iVar3;
  if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
    *pbVar4 = DAT_10057084;
    pbVar4 = pbVar4 + 1;
  }
  *pbVar4 = 0;
  FUN_1003fb09(local_4);
  return;
}



void __cdecl FUN_10003320(char *param_1,int param_2)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  int iVar4;
  byte bVar5;
  uint uVar6;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  int local_14;
  int local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  if (param_1 == (char *)0x0) goto LAB_100034f6;
  cVar1 = *param_1;
  if (cVar1 == '$') {
    bVar5 = (&DAT_1004d448)[param_1[1]];
    pcVar2 = (char *)0x0;
    pcVar3 = param_1;
    if (0xf < bVar5) goto LAB_100034f6;
    do {
      uVar6 = (uint)bVar5;
      bVar5 = (&DAT_1004d448)[pcVar3[2]];
      param_1 = (char *)((int)pcVar2 << 4 | uVar6);
      pcVar2 = param_1;
      pcVar3 = pcVar3 + 1;
    } while (bVar5 < 0x10);
  }
  else {
    if ((cVar1 < '0') || ('9' < cVar1)) goto LAB_100034f6;
    pcVar3 = (char *)FUN_10001ba0(0);
    if (' ' < *pcVar3) {
      if ('9' < cVar1) goto LAB_100034f6;
      local_24 = 0;
      local_20 = 0;
      local_1c = 0;
      local_18 = 0;
      local_14 = 0;
      local_10 = 0;
      local_c = 0;
      local_8 = 0;
      local_4 = 0xffffffff;
      FUN_10001ba0(4);
      FUN_10001ba0(2);
      FUN_10001ba0(2);
      FUN_10001ba0(2);
      FUN_10001ba0(2);
      FUN_10001ba0(2);
      if ((((local_10 < 0x7b2) || (0x83b < local_10)) || (local_14 < 1)) ||
         (((0xc < local_14 || (local_18 < 1)) || (iVar4 = local_10, 0x1f < local_18)))) {
        iVar4 = 0;
      }
      if (((local_1c < 0) || (0x17 < local_1c)) ||
         (((local_20 < 0 || (((0x3b < local_20 || (local_24 < 0)) || (0x3d < local_24)))) ||
          (iVar4 == 0)))) goto LAB_100034f6;
      local_10 = iVar4 + -0x76c;
      local_14 = local_14 + -1;
      param_1 = (char *)FUN_10001d40(&local_24);
    }
  }
  if (param_1 != (char *)0x0) {
    return;
  }
LAB_100034f6:
  if (param_2 == 0) {
    FUN_10005b50();
  }
  return;
}



undefined4 __cdecl
FUN_10003510(char *param_1,int *param_2,int *param_3,undefined4 *param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 *param_7)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 local_24 [9];
  
  uVar1 = FUN_10003320(param_1,1);
  if (1 < uVar1) {
    puVar2 = FUN_10001bf0(local_24);
    if (puVar2 != (undefined4 *)0x0) {
      if (param_2 != (int *)0x0) {
        *param_2 = puVar2[5] + 0x76c;
      }
      if (param_3 != (int *)0x0) {
        *param_3 = puVar2[4] + 1;
      }
      if (param_4 != (undefined4 *)0x0) {
        *param_4 = puVar2[3];
      }
      if (param_5 != (undefined4 *)0x0) {
        *param_5 = puVar2[2];
      }
      if (param_6 != (undefined4 *)0x0) {
        *param_6 = puVar2[1];
      }
      if (param_7 != (undefined4 *)0x0) {
        *param_7 = *puVar2;
      }
      return 0;
    }
  }
  return 0xffffffff;
}



float10 __cdecl FUN_100035a0(byte *param_1,float param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  float10 fVar4;
  int local_c;
  int local_8;
  
  fVar4 = (float10)1.0;
  iVar3 = 0;
  local_c = 0;
  local_8 = 1;
  if (param_1 == (byte *)0x0) {
    return (float10)param_2;
  }
  if (*param_1 != 0x2b) {
    if (*param_1 != 0x2d) goto LAB_100035e9;
    fVar4 = (float10)-1.0;
  }
  param_1 = param_1 + 1;
LAB_100035e9:
  bVar1 = *param_1;
  while (('/' < (char)bVar1 && ((char)bVar1 < ':'))) {
    param_1 = param_1 + 1;
    iVar3 = (bVar1 & 0xf) + iVar3 * 10;
    bVar1 = *param_1;
  }
  if (*param_1 == 0x2e) {
    pbVar2 = param_1 + 1;
    bVar1 = *pbVar2;
    local_c = 0;
    local_8 = 1;
    while (('/' < (char)bVar1 && ((char)bVar1 < ':'))) {
      pbVar2 = pbVar2 + 1;
      local_c = (bVar1 & 0xf) + local_c * 10;
      local_8 = local_8 * 10;
      bVar1 = *pbVar2;
    }
  }
  return ((float10)iVar3 + (float10)local_c / (float10)local_8) * fVar4;
}



char * __cdecl FUN_10003660(char *param_1)

{
  char *pcVar1;
  char *in_stack_00000014;
  
  pcVar1 = FUN_10002330(param_1);
  if (pcVar1 == (char *)0x0) {
    pcVar1 = in_stack_00000014;
  }
  return pcVar1;
}



int __cdecl
FUN_10003680(byte *param_1,byte *param_2,int param_3,byte *param_4,int param_5,int param_6)

{
  byte bVar1;
  int iVar2;
  byte bVar3;
  byte bVar4;
  byte *pbVar5;
  
  if (param_1 != (byte *)0x0) {
    pbVar5 = param_1;
    if (0 < param_5) {
      do {
        if (*param_1 == 0x22) {
          bVar4 = 0x20;
          param_1 = param_1 + 1;
          bVar3 = 0x22;
        }
        else {
          bVar4 = 0x21;
          bVar3 = (byte)param_6;
        }
        for (; (*param_1 != bVar3 && (bVar4 <= *param_1)); param_1 = param_1 + 1) {
        }
        if ((*param_1 == 0x22) && (bVar3 == 0x22)) {
          param_1 = param_1 + 1;
        }
        if ((char)*param_1 != param_6) goto LAB_100036d1;
        param_1 = param_1 + 1;
        param_5 = param_5 + -1;
        pbVar5 = param_1;
      } while (0 < param_5);
    }
    if (pbVar5 != (byte *)0x0) {
      if (*pbVar5 == 0x22) {
        bVar3 = 0x20;
        param_1._0_1_ = 0x22;
        pbVar5 = pbVar5 + 1;
      }
      else {
        bVar3 = 0x21;
        param_1._0_1_ = (byte)param_6;
      }
      if (param_2 == (byte *)0x0) {
        bVar4 = *pbVar5;
        iVar2 = 0;
        for (; (bVar4 != (byte)param_1 && (bVar3 <= *pbVar5)); pbVar5 = pbVar5 + 1) {
          if ((*pbVar5 == 0x25) && ((0x1f < pbVar5[1] && (0x1f < pbVar5[2])))) {
            pbVar5 = pbVar5 + 2;
          }
          bVar4 = pbVar5[1];
          iVar2 = iVar2 + 1;
        }
        return iVar2;
      }
      if (param_3 < 1) {
        return -1;
      }
      iVar2 = 1;
      if (1 < param_3) {
        do {
          bVar4 = *pbVar5;
          if ((bVar4 == (byte)param_1) || (bVar4 < bVar3)) break;
          if (bVar4 == 0x25) {
            bVar1 = pbVar5[1];
            if (bVar1 == 0x25) {
              *param_2 = 0x25;
              pbVar5 = pbVar5 + 2;
            }
            else {
              if ((bVar1 < 0x20) || (pbVar5[2] < 0x20)) goto LAB_100037f3;
              *param_2 = (&DAT_1004d448)[bVar1] << 4 | (&DAT_1004d448)[pbVar5[2]];
              pbVar5 = pbVar5 + 3;
            }
          }
          else {
LAB_100037f3:
            *param_2 = bVar4;
            pbVar5 = pbVar5 + 1;
          }
          param_2 = param_2 + 1;
          iVar2 = iVar2 + 1;
        } while (iVar2 < param_3);
      }
      *param_2 = 0;
      return iVar2 + -1;
    }
  }
LAB_100036d1:
  if (param_4 == (byte *)0x0) {
    return -1;
  }
  if (param_2 == (byte *)0x0) {
    pbVar5 = param_4 + 1;
    do {
      bVar3 = *param_4;
      param_4 = param_4 + 1;
    } while (bVar3 != 0);
    return (int)param_4 - (int)pbVar5;
  }
  iVar2 = 1;
  pbVar5 = param_2;
  if (1 < param_3) {
    do {
      pbVar5 = param_2;
      if (*param_4 == 0) break;
      pbVar5 = param_2 + 1;
      *param_2 = *param_4;
      param_4 = param_4 + 1;
      iVar2 = iVar2 + 1;
      param_2 = pbVar5;
    } while (iVar2 < param_3);
  }
  *pbVar5 = 0;
  return iVar2 + -1;
}



int __cdecl FUN_10003810(char *param_1,char *param_2,int param_3)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  int iVar4;
  char *pcVar5;
  
  iVar4 = 0;
  if (0 < param_3) {
    *param_2 = '\0';
  }
  if ((param_1 == (char *)0x0) || (cVar1 = *param_1, pcVar5 = param_1, cVar1 == '\0')) {
    return 0;
  }
  while (cVar1 != '=') {
    cVar1 = pcVar5[1];
    pcVar5 = pcVar5 + 1;
    if (cVar1 == '\0') {
      return 0;
    }
  }
  if ((0x1f < (byte)pcVar5[1]) || (0x20 < (byte)pcVar5[-1])) {
    pcVar2 = pcVar5;
    if (pcVar5 != param_1) {
      do {
        if ((byte)pcVar2[-1] < 0x21) break;
        pcVar2 = pcVar2 + -1;
      } while (pcVar2 != param_1);
      if (pcVar2 != pcVar5) {
        pcVar3 = param_2;
        do {
          if (param_3 <= (int)(pcVar3 + (1 - (int)param_2))) break;
          iVar4 = iVar4 + 1;
          *pcVar3 = *pcVar2;
          pcVar3 = pcVar3 + 1;
          pcVar2 = pcVar2 + 1;
        } while (pcVar2 != pcVar5);
      }
    }
    param_2[iVar4] = '\0';
  }
  return iVar4;
}



byte * __cdecl FUN_100038b0(byte *param_1,byte *param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte bVar3;
  
  if ((param_1 != (byte *)0x0) && (*param_1 != 0)) {
    pbVar1 = param_1;
    if (*param_1 == 0x22) {
      bVar3 = param_1[1];
      pbVar2 = param_1;
      while (bVar3 != 0) {
        pbVar1 = pbVar2 + 1;
        if (bVar3 == 0x22) goto LAB_100038e0;
        bVar3 = pbVar2[2];
        pbVar2 = pbVar1;
      }
    }
    else {
LAB_100038e0:
      bVar3 = *pbVar1;
      if (bVar3 != 0) {
        while (bVar3 != 0x3d) {
          bVar3 = pbVar1[1];
          pbVar1 = pbVar1 + 1;
          if (bVar3 == 0) {
            return (byte *)0x0;
          }
        }
        pbVar2 = pbVar1;
        if (*pbVar1 != 0) {
          for (; pbVar2 != param_1; pbVar2 = pbVar2 + -1) {
            if (*pbVar2 < 0x21) goto LAB_10003912;
          }
          if (*pbVar2 < 0x21) {
LAB_10003912:
            pbVar2 = pbVar2 + 1;
          }
          for (; (pbVar2 < pbVar1 && (0 < param_3)); param_3 = param_3 + -1) {
            *param_2 = *pbVar2;
            pbVar2 = pbVar2 + 1;
            param_2 = param_2 + 1;
          }
          *param_2 = 0;
          return pbVar1 + 1;
        }
      }
    }
  }
  return (byte *)0x0;
}



void __cdecl FUN_10003940(byte *param_1,int param_2,int param_3)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  int iVar5;
  
  bVar1 = *param_1;
  iVar2 = 0;
  iVar5 = 0;
  do {
    if ((bVar1 == 0) || (param_3 <= iVar2)) {
      return;
    }
    iVar3 = 0;
    while (('/' < (char)bVar1 && ((char)bVar1 < ':'))) {
      param_1 = param_1 + 1;
      iVar3 = (bVar1 & 0xf) + iVar3 * 10;
      bVar1 = *param_1;
    }
    bVar1 = *param_1;
    if (bVar1 == 0x6c) {
      *(int *)(param_2 + 4 + iVar2 * 8) = iVar5;
      *(undefined4 *)(param_2 + iVar2 * 8) = 0x6c;
      iVar5 = iVar5 + 4;
LAB_100039f8:
      iVar2 = iVar2 + 1;
    }
    else {
      if (bVar1 == 0x62) {
        *(int *)(param_2 + 4 + iVar2 * 8) = iVar5;
        *(undefined4 *)(param_2 + iVar2 * 8) = 0x62;
        iVar5 = iVar5 + 1;
        goto LAB_100039f8;
      }
      if (bVar1 == 0x77) {
        *(int *)(param_2 + 4 + iVar2 * 8) = iVar5;
        *(undefined4 *)(param_2 + iVar2 * 8) = 0x77;
        iVar5 = iVar5 + 2;
        goto LAB_100039f8;
      }
      if ((bVar1 == 0x73) && (0 < iVar3)) {
        *(undefined4 *)(param_2 + iVar2 * 8) = 0x73;
        *(int *)(param_2 + 4 + iVar2 * 8) = iVar5;
LAB_100039f6:
        iVar5 = iVar5 + iVar3;
        goto LAB_100039f8;
      }
      if (bVar1 == 0x61) {
        *(undefined4 *)(param_2 + iVar2 * 8) = 0x61;
        *(int *)(param_2 + 4 + iVar2 * 8) = iVar5;
        if (iVar3 == 0) {
          iVar3 = 1;
        }
        goto LAB_100039f6;
      }
    }
    pbVar4 = param_1 + 1;
    if (param_1[1] == 0x2a) {
      pbVar4 = param_1;
    }
    bVar1 = *pbVar4;
    param_1 = pbVar4;
  } while( true );
}



undefined4 __cdecl FUN_10003a20(byte *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  pbVar3 = FUN_100020f0(param_1,param_2);
  pbVar5 = pbVar3;
  if (pbVar3 == (byte *)0x0) {
    return 0xffffffff;
  }
  for (; (pbVar5 != param_1 && (0x20 < pbVar5[-1])); pbVar5 = pbVar5 + -1) {
  }
  bVar2 = *pbVar3;
  pbVar4 = pbVar3;
  while (0x1f < bVar2) {
    if (bVar2 == 0x3d) goto LAB_10003a7c;
    if (bVar2 == 0x20) {
      pbVar4 = pbVar3;
    }
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  if (*pbVar3 != 0x3d) {
    pbVar4 = pbVar3;
  }
LAB_10003a7c:
  bVar2 = *pbVar4;
  while ((bVar2 != 0 && (bVar2 < 0x21))) {
    pbVar3 = pbVar4 + 1;
    pbVar4 = pbVar4 + 1;
    bVar2 = *pbVar3;
  }
  bVar2 = *pbVar4;
  while (bVar2 != 0) {
    *pbVar5 = bVar2;
    pbVar3 = pbVar4 + 1;
    pbVar5 = pbVar5 + 1;
    pbVar4 = pbVar4 + 1;
    bVar2 = *pbVar3;
  }
  for (; (pbVar5 != param_1 && (pbVar5[-1] < 0x21)); pbVar5 = pbVar5 + -1) {
  }
  *pbVar5 = 0;
  return 0;
}



undefined4 __cdecl FUN_10003ac0(byte *param_1,int param_2,byte *param_3)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  
  pbVar3 = param_1 + param_2;
  if ((param_3 == (byte *)0x0) || (*param_3 == 0)) {
    return 0;
  }
  pbVar4 = param_1;
  pbVar5 = param_1;
  pbVar6 = param_1;
  if (*param_1 != 0) {
    do {
      bVar1 = *pbVar5;
      if (bVar1 < 0x21) {
        *pbVar6 = bVar1;
        pbVar6 = pbVar6 + 1;
        pbVar4 = pbVar5 + 1;
        pbVar5 = pbVar4;
      }
      else if (bVar1 == 0x3d) {
        if (pbVar5 == pbVar4) {
          *pbVar6 = 0;
          break;
        }
        *pbVar5 = 0;
        pbVar2 = FUN_100020f0(param_3,pbVar4);
        if (pbVar2 == (byte *)0x0) {
          *pbVar5 = 0x3d;
          *pbVar6 = 0x3d;
          pbVar6 = pbVar6 + 1;
          pbVar5 = pbVar5 + 1;
        }
        else {
          pbVar6 = pbVar6 + ((int)pbVar4 - (int)pbVar5);
          bVar1 = pbVar5[1];
          pbVar4 = pbVar5;
          while (pbVar4 = pbVar4 + 1, pbVar5 = pbVar4, bVar1 != 0) {
            if (bVar1 == 0x3d) {
              if (*pbVar4 != 0) {
                bVar1 = pbVar4[-1];
                while (pbVar5 = pbVar4, 0x20 < bVar1) {
                  pbVar5 = pbVar4 + -2;
                  pbVar4 = pbVar4 + -1;
                  bVar1 = *pbVar5;
                }
              }
              break;
            }
            bVar1 = pbVar4[1];
          }
        }
      }
      else {
        *pbVar6 = bVar1;
        pbVar6 = pbVar6 + 1;
        pbVar5 = pbVar5 + 1;
      }
    } while (*pbVar5 != 0);
    for (; (pbVar6 != param_1 && (pbVar6[-1] < 0x21)); pbVar6 = pbVar6 + -1) {
    }
  }
  if (pbVar3 + -2 <= pbVar6) {
    *pbVar6 = 0;
    if (pbVar6 + 1 < pbVar3) {
      if (DAT_10057088 != 0) {
        *pbVar6 = DAT_10057084;
        pbVar6 = pbVar6 + 1;
      }
      *pbVar6 = 0;
    }
    return 0xffffffff;
  }
  if (pbVar6 != param_1) {
    *pbVar6 = DAT_10057084;
    pbVar6 = pbVar6 + 1;
  }
  if (*param_3 == 0) {
LAB_10003c0e:
    if (*param_3 != 0) {
      pbVar3 = pbVar6;
      if (pbVar6 != param_1) {
        while (pbVar3 = pbVar6 + -1, 0x1f < pbVar6[-1]) {
          pbVar6 = pbVar3;
          if (pbVar3 == param_1) {
            *pbVar3 = 0;
            return 0xffffffff;
          }
        }
        if (*pbVar3 == 10) {
          pbVar3 = pbVar6;
        }
      }
      *pbVar3 = 0;
      return 0xffffffff;
    }
  }
  else {
    do {
      if (pbVar3 + -1 <= pbVar6) goto LAB_10003c0e;
      *pbVar6 = *param_3;
      pbVar4 = param_3 + 1;
      pbVar6 = pbVar6 + 1;
      param_3 = param_3 + 1;
    } while (*pbVar4 != 0);
  }
  *pbVar6 = 0;
  return 1;
}



int __cdecl FUN_10003c50(byte *param_1,int param_2,byte *param_3,byte *param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  byte bVar4;
  
  if (param_4 == (byte *)0x0) {
    FUN_10003a20(param_1,param_3);
    return 0;
  }
  pbVar2 = FUN_10001de0(param_1,param_2,param_3,0);
  if (pbVar2 == (byte *)0x0) {
    return -1;
  }
  bVar4 = 0x21;
  if (0x20 < *param_4) {
    do {
      if (param_1 + param_2 + -2 <= pbVar2) {
        iVar3 = FUN_10001fb0((char *)param_1);
        return iVar3;
      }
      bVar4 = bVar4 ^ *param_4 == 0x22;
      *pbVar2 = *param_4;
      pbVar1 = param_4 + 1;
      pbVar2 = pbVar2 + 1;
      param_4 = param_4 + 1;
    } while (bVar4 <= *pbVar1);
  }
  if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
    *pbVar2 = DAT_10057084;
    pbVar2 = pbVar2 + 1;
  }
  *pbVar2 = 0;
  return (int)pbVar2 - (int)param_1;
}



int __cdecl FUN_10003cf0(byte *param_1,int param_2,byte *param_3,byte *param_4)

{
  int iVar1;
  byte *pbVar2;
  byte bVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  if (param_4 == (byte *)0x0) {
    FUN_10003a20(param_1,param_3);
    return 0;
  }
  pbVar2 = FUN_10001de0(param_1,param_2,param_3,2);
  if (pbVar2 != (byte *)0x0) {
    pbVar4 = param_1 + param_2 + (-1 - (int)pbVar2);
    bVar3 = *param_4;
    pbVar5 = param_4;
    if (bVar3 != 0) {
      do {
        if ((bVar3 == 0x20) || (bVar3 == 0x2c)) {
          *pbVar2 = 0x22;
          pbVar2 = pbVar2 + 1;
          pbVar4 = pbVar4 + -2;
          break;
        }
        bVar3 = pbVar5[1];
        pbVar5 = pbVar5 + 1;
      } while (bVar3 != 0);
      bVar3 = *param_4;
      for (; (bVar3 != 0 && (0 < (int)pbVar4)); pbVar4 = pbVar4 + iVar1) {
        if (((&DAT_1004d338)[*param_4] & 1) == 0) {
          *pbVar2 = *param_4;
          pbVar2 = pbVar2 + 1;
          iVar1 = -1;
        }
        else {
          if (2 < (int)pbVar4) {
            *pbVar2 = 0x25;
            pbVar2[1] = (&DAT_1004d438)[*param_4 >> 4];
            pbVar2[2] = (&DAT_1004d438)[*param_4 & 0xf];
            pbVar2 = pbVar2 + 3;
          }
          iVar1 = -3;
        }
        bVar3 = param_4[1];
        param_4 = param_4 + 1;
      }
    }
    if ((*pbVar5 == 0x20) || (*pbVar5 == 0x2c)) {
      *pbVar2 = 0x22;
      pbVar2 = pbVar2 + 1;
    }
    if (DAT_10057088 <= (int)pbVar4) {
      if ((DAT_10057088 != 0) && (param_3 != (byte *)0x0)) {
        *pbVar2 = DAT_10057084;
        pbVar2 = pbVar2 + 1;
      }
      *pbVar2 = 0;
      return (int)pbVar2 - (int)param_1;
    }
    pbVar4 = pbVar2;
    if (pbVar2 != param_1) {
      while (pbVar2 = pbVar4 + -1, 0x1f < pbVar4[-1]) {
        pbVar4 = pbVar2;
        if (pbVar2 == param_1) {
          *pbVar2 = 0;
          return -1;
        }
      }
      if (*pbVar2 == 10) {
        pbVar2 = pbVar4;
      }
    }
    *pbVar2 = 0;
  }
  return -1;
}



int __cdecl FUN_10003e20(byte *param_1,size_t param_2,byte *param_3)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte **ppbVar5;
  size_t sVar6;
  byte *local_4;
  
  local_4 = &DAT_1004d26f;
  sVar6 = param_2;
  if (*param_3 == 0x7e) {
    param_3 = param_3 + 1;
    bVar1 = *param_1;
    while (bVar1 != 0) {
      if ((int)sVar6 < 2) goto LAB_10003eac;
      pbVar4 = param_1 + 1;
      param_1 = param_1 + 1;
      sVar6 = sVar6 - 1;
      bVar1 = *pbVar4;
    }
    if (((1 < (int)sVar6) && ((int)sVar6 < (int)param_2)) && ('\x1f' < (char)param_1[-1])) {
      *param_1 = DAT_10057084;
      param_1 = param_1 + 1;
      sVar6 = sVar6 - 1;
    }
  }
  else if ((*param_3 == 0x2c) && (*param_1 != 0)) {
    do {
      if ((int)sVar6 < 2) break;
      pbVar4 = param_1 + 1;
      param_1 = param_1 + 1;
      sVar6 = sVar6 - 1;
    } while (*pbVar4 != 0);
    do {
      if ((int)param_2 <= (int)sVar6) break;
      if (' ' < (char)param_1[-1]) {
        if (((int)sVar6 < (int)param_2) && (param_1[-1] == 0x3d)) {
          param_3 = param_3 + 1;
        }
        break;
      }
      param_1 = param_1 + -1;
      sVar6 = sVar6 + 1;
    } while( true );
  }
LAB_10003eac:
  bVar1 = *param_3;
  if (bVar1 != 0) {
    ppbVar5 = &param_3;
    do {
      pbVar4 = param_3 + 1;
      if ((int)sVar6 < 2) break;
      if (bVar1 < 0x21) {
        *param_1 = DAT_10057084;
        param_1 = param_1 + 1;
        sVar6 = sVar6 - 1;
        bVar1 = *pbVar4;
        while ((bVar1 != 0 && ((char)bVar1 < '!'))) {
          pbVar3 = pbVar4 + 1;
          pbVar4 = pbVar4 + 1;
          bVar1 = *pbVar3;
        }
      }
      else if (bVar1 == 0x23) {
        param_3 = pbVar4;
        iVar2 = __snprintf((char *)param_1,sVar6,"%d",ppbVar5[1]);
LAB_10003f3f:
        param_1 = param_1 + iVar2;
        sVar6 = sVar6 - iVar2;
LAB_10003f43:
        ppbVar5 = ppbVar5 + 1;
      }
      else if (bVar1 == 0x25) {
        bVar1 = *pbVar4;
        if (bVar1 != 0) {
          pbVar4 = param_3 + 2;
          *param_1 = 0;
          param_3 = pbVar4;
          if (bVar1 == 0x73) {
            iVar2 = FUN_10003cf0(param_1,sVar6,(byte *)0x0,ppbVar5[1]);
          }
          else if (bVar1 == 100) {
            iVar2 = FUN_10002370(param_1,sVar6,(byte *)0x0,(uint)ppbVar5[1]);
          }
          else if (bVar1 == 0x74) {
            iVar2 = FUN_100027d0(param_1,sVar6,(byte *)0x0,(uint)ppbVar5[1]);
          }
          else if (bVar1 == 0x61) {
            iVar2 = FUN_100025e0(param_1,sVar6,(byte *)0x0,(uint)ppbVar5[1]);
          }
          else if (bVar1 == 0x66) {
            iVar2 = FUN_100024f0(param_1,sVar6,(byte *)0x0,(uint)ppbVar5[1]);
          }
          else {
            if (bVar1 != 0x65) {
              if (bVar1 == 0x69) {
                local_4 = ppbVar5[1];
                ppbVar5 = ppbVar5 + 1;
              }
              else {
                if (bVar1 == 0x78) {
                  pbVar3 = FUN_100020f0(local_4,ppbVar5[1]);
                  iVar2 = FUN_10003c50(param_1,sVar6,(byte *)0x0,pbVar3);
                  goto LAB_10003f3b;
                }
                if (bVar1 == 0x72) {
                  pbVar3 = ppbVar5[1];
                  bVar1 = *pbVar3;
                  ppbVar5 = ppbVar5 + 1;
                  for (; (bVar1 != 0 && (0 < (int)sVar6)); sVar6 = sVar6 - 1) {
                    *param_1 = bVar1;
                    bVar1 = pbVar3[1];
                    param_1 = param_1 + 1;
                    pbVar3 = pbVar3 + 1;
                  }
                }
              }
              goto LAB_10003f47;
            }
            iVar2 = FUN_10003240(param_1,sVar6,(byte *)0x0,(int)ppbVar5[1]);
          }
LAB_10003f3b:
          if (0 < iVar2) goto LAB_10003f3f;
          goto LAB_10003f43;
        }
      }
      else {
        *param_1 = bVar1;
        param_1 = param_1 + 1;
        sVar6 = sVar6 - 1;
      }
LAB_10003f47:
      bVar1 = *pbVar4;
      param_3 = pbVar4;
    } while (bVar1 != 0);
  }
  if (((DAT_10057084 == 10) && (param_2 != sVar6)) && (1 < (int)sVar6)) {
    *param_1 = 10;
    param_1 = param_1 + 1;
    sVar6 = sVar6 - 1;
  }
  if (0 < (int)sVar6) {
    *param_1 = 0;
  }
  return param_2 - sVar6;
}



void FUN_10004060(void)

{
  uint *puVar1;
  uint uVar2;
  undefined4 *in_EAX;
  uint *puVar3;
  undefined4 *unaff_ESI;
  
  if ((DAT_10058440 != (uint *)0x0) && (puVar3 = DAT_10058440, DAT_10058440[2] != 0)) {
    while (*puVar3 !=
           (puVar3[1] &
           CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(in_EAX + 1),*(undefined1 *)((int)in_EAX + 5)),
                             *(undefined1 *)((int)in_EAX + 6)),*(undefined1 *)((int)in_EAX + 7)))) {
      puVar1 = puVar3 + 5;
      puVar3 = puVar3 + 3;
      if (*puVar1 == 0) {
        return;
      }
    }
    *unaff_ESI = *in_EAX;
    unaff_ESI[1] = in_EAX[1];
    unaff_ESI[2] = in_EAX[2];
    unaff_ESI[3] = in_EAX[3];
    uVar2 = puVar3[2];
    *(char *)((int)unaff_ESI + 7) = (char)uVar2;
    *(char *)((int)unaff_ESI + 6) = (char)(uVar2 >> 8);
    *(char *)((int)unaff_ESI + 5) = (char)(uVar2 >> 0x10);
    *(char *)(unaff_ESI + 1) = (char)(uVar2 >> 0x18);
  }
  return;
}



int __fastcall FUN_100040e0(int param_1)

{
  int in_EAX;
  
  if (in_EAX < 0) {
    if (((param_1 != 0x2733) && (param_1 != 0x2746)) && (param_1 != 0x3e5)) {
      if ((param_1 == 0x2743) || (param_1 == 0x2751)) {
        return -5;
      }
      if (param_1 == 0x2749) {
        return -2;
      }
      if (param_1 == 0x274d) {
        return -6;
      }
      return (uint)(param_1 != 0x2726) * 4 + -0xb;
    }
    in_EAX = 0;
  }
  return in_EAX;
}



undefined4 FUN_10004150(void)

{
  int *piVar1;
  int iVar2;
  bool bVar3;
  int *piVar4;
  int *unaff_ESI;
  
  bVar3 = false;
  FUN_100057a0((DWORD *)0x0);
  piVar4 = &DAT_10058438;
  iVar2 = DAT_10058438;
  do {
    if (iVar2 == 0) {
LAB_10004185:
      FUN_10005830((undefined4 *)0x0);
      if (!bVar3) {
        return 0xffffffff;
      }
      FUN_100058f0();
      FUN_10005730(unaff_ESI + 0x19);
      WSACloseEvent(unaff_ESI[0x18]);
      unaff_ESI[0x18] = 0;
      unaff_ESI[6] = -1;
      *(undefined1 *)(unaff_ESI + 5) = 0;
      FUN_100057a0((DWORD *)0x0);
      unaff_ESI[1] = (int)DAT_1005843c;
      DAT_1005843c = unaff_ESI;
      FUN_10005830((undefined4 *)0x0);
      return 0;
    }
    piVar1 = (int *)*piVar4;
    if (piVar1 == unaff_ESI) {
      *piVar4 = *unaff_ESI;
      bVar3 = true;
      goto LAB_10004185;
    }
    iVar2 = *piVar1;
    piVar4 = piVar1;
  } while( true );
}



void FUN_100041f0(undefined4 *param_1)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  DWORD DVar3;
  
  DVar3 = GetTickCount();
  FUN_100057a0((DWORD *)0x0);
  for (puVar1 = (undefined4 *)*param_1; pvVar2 = DAT_1005843c, puVar1 != (undefined4 *)0x0;
      puVar1 = (undefined4 *)*puVar1) {
    if ((((puVar1[0x11] != 0) && ((code *)puVar1[0x13] != (code *)0x0)) && (puVar1[0x10] != -1)) &&
       ((uint)puVar1[0x11] < DVar3 - puVar1[0x10])) {
      puVar1[0x10] = 0xffffffff;
      (*(code *)puVar1[0x13])(puVar1,0,puVar1[0x12]);
      DVar3 = GetTickCount();
      puVar1[0x10] = DVar3;
    }
  }
  while (pvVar2 != (LPVOID)0x0) {
    DAT_1005843c = *(LPVOID *)((int)pvVar2 + 4);
    FUN_10001540(pvVar2);
    pvVar2 = DAT_1005843c;
  }
  DAT_1005843c = pvVar2;
  FUN_10005830((undefined4 *)0x0);
  return;
}



void FUN_10004290(void)

{
  DWORD DVar1;
  int unaff_ESI;
  
  if (*(int *)(unaff_ESI + 0xc) != 1) {
    DVar1 = GetTickCount();
    *(char *)(unaff_ESI + 0x93) = (char)DVar1;
    *(char *)(unaff_ESI + 0x92) = (char)(DVar1 >> 8);
    *(char *)(unaff_ESI + 0x91) = (char)(DVar1 >> 0x10);
    *(char *)(unaff_ESI + 0x90) = (char)(DVar1 >> 0x18);
  }
  if (((*(int *)(unaff_ESI + 0x40) != -1) && (*(code **)(unaff_ESI + 0x4c) != (code *)0x0)) &&
     ((*(byte *)(unaff_ESI + 0x3c) & 2) != 0)) {
    *(undefined4 *)(unaff_ESI + 0x40) = 0xffffffff;
    (**(code **)(unaff_ESI + 0x4c))();
    DVar1 = GetTickCount();
    *(DWORD *)(unaff_ESI + 0x40) = DVar1;
  }
  return;
}



void FUN_100042f0(void)

{
  int *piVar1;
  undefined4 *puVar2;
  int in_EAX;
  int iVar3;
  undefined4 local_8;
  int local_4;
  
  piVar1 = (int *)(in_EAX + 0x98);
  if ((*(int *)(in_EAX + 0x98) == 0) && (*(char *)(in_EAX + 0xa8) != '\x01')) {
    local_4 = in_EAX + 0xa9;
    puVar2 = (undefined4 *)(in_EAX + 0xa4);
    local_8 = 0x240;
    *puVar2 = 0;
    if (*(int *)(in_EAX + 0xc) == 2) {
      *(undefined4 *)(in_EAX + 0xa0) = 0x10;
      iVar3 = WSARecvFrom(*(undefined4 *)(in_EAX + 0x18),&local_8,1,piVar1,puVar2,in_EAX + 0x88,
                          (undefined4 *)(in_EAX + 0xa0),in_EAX + 0x50,0);
    }
    else {
      iVar3 = WSARecv(*(undefined4 *)(in_EAX + 0x18),&local_8,1,piVar1,puVar2,in_EAX + 0x50,0);
    }
    if (iVar3 == 0) {
      if (0 < *piVar1) {
        FUN_10004290();
      }
    }
    else {
      *piVar1 = iVar3;
      iVar3 = WSAGetLastError();
      *(int *)(in_EAX + 0x9c) = iVar3;
      if (iVar3 == 0x3e5) {
        *(undefined1 *)(in_EAX + 0xa8) = 1;
        return;
      }
    }
  }
  return;
}



void FUN_100043c0(void)

{
  bool bVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  int *piVar5;
  int local_108 [65];
  
  piVar5 = local_108;
  for (iVar4 = 0x40; iVar4 != 0; iVar4 = iVar4 + -1) {
    *piVar5 = 0;
    piVar5 = piVar5 + 1;
  }
  DAT_1005708c = 1;
  if (DAT_10058448 != 0) {
    do {
      FUN_100057a0((DWORD *)0x0);
      iVar4 = 1;
      local_108[0] = DAT_1005844c;
      puVar3 = DAT_10058438;
      while ((puVar3 != (undefined4 *)0x0 && (iVar4 < 0x40))) {
        if ((puVar3[3] == 2) || (puVar3[3] == 3)) {
          FUN_100057a0(puVar3 + 0x19);
          if ((int)puVar3[0x26] < 1) {
            local_108[iVar4] = puVar3[0x18];
            iVar4 = iVar4 + 1;
            if (*(char *)(puVar3 + 0x2a) == '\x01') {
              iVar2 = WSAGetOverlappedResult(puVar3[6],puVar3 + 0x14,puVar3 + 0x26,0,puVar3 + 0x29);
              if (iVar2 == 1) {
                *(undefined1 *)(puVar3 + 0x2a) = 0;
                FUN_10004290();
              }
              else {
                iVar2 = WSAGetLastError();
                if (iVar2 != 0x3e4) {
                  *(undefined1 *)(puVar3 + 0x2a) = 0;
                }
              }
            }
            FUN_100042f0();
          }
          FUN_10005830(puVar3 + 0x19);
        }
        puVar3 = (undefined4 *)*puVar3;
      }
      FUN_10005830((undefined4 *)0x0);
      iVar2 = WSAWaitForMultipleEvents(iVar4,local_108,0,0xffffffff,0);
      if ((-1 < iVar2) && (iVar2 < iVar4)) {
        FUN_100057a0((DWORD *)0x0);
        bVar1 = false;
        if (DAT_10058438 != (undefined4 *)0x0) {
          puVar3 = DAT_10058438;
          do {
            if (puVar3[0x18] == local_108[iVar2]) {
              bVar1 = true;
              break;
            }
            puVar3 = (undefined4 *)*puVar3;
          } while (puVar3 != (undefined4 *)0x0);
        }
        if ((iVar2 == 0) || (bVar1)) {
          WSAResetEvent(local_108[iVar2]);
        }
        FUN_10005830((undefined4 *)0x0);
      }
    } while (DAT_10058448 != 0);
  }
  DAT_1005708c = 0;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __cdecl FUN_10004540(int param_1)

{
  int iVar1;
  WSADATA *pWVar2;
  DWORD DStack_1a4;
  WSADATA local_1a0;
  int local_c;
  
  local_c = DAT_10057438;
  FUN_10005a50(param_1);
  FUN_10005860(0x100041f0,0x10058438);
  pWVar2 = &local_1a0;
  for (iVar1 = 100; iVar1 != 0; iVar1 = iVar1 + -1) {
    pWVar2->wVersion = 0;
    pWVar2->wHighVersion = 0;
    pWVar2 = (WSADATA *)pWVar2->szDescription;
  }
  DAT_10058440 = 0;
  _DAT_10058444 = 0;
  WSAStartup(2,&local_1a0);
  DAT_10058434 = (uint)CONCAT11((char)local_1a0.wVersion,(char)(local_1a0.wVersion >> 8));
  DAT_1005844c = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
  DAT_10058448 = (HANDLE)0x1;
  DAT_10058448 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_100043c0,(LPVOID)0x0,0,&DStack_1a4);
  if (DAT_10058448 != (HANDLE)0x0) {
    SetThreadPriority(DAT_10058448,param_1);
    CloseHandle(DAT_10058448);
  }
  FUN_1003fb09(local_c);
  return;
}



undefined4 * __cdecl FUN_10004620(int param_1,int param_2,int param_3)

{
  SOCKET s;
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  undefined4 *puVar4;
  u_long local_4;
  
  local_4 = 1;
  s = socket(param_1,param_2,param_3);
  if (s == 0xffffffff) {
    return (undefined4 *)0x0;
  }
  puVar1 = (undefined4 *)FUN_10001520(0x2ec);
  puVar4 = puVar1;
  for (iVar3 = 0xbb; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  puVar1[6] = s;
  ioctlsocket(s,-0x7ffb9982,&local_4);
  if (param_2 == 2) {
    setsockopt(s,0xffff,0x20,(char *)&local_4,4);
  }
  puVar1[2] = param_1;
  puVar1[3] = param_2;
  puVar1[4] = param_3;
  puVar1[0x14] = 0;
  puVar1[0x15] = 0;
  puVar1[0x16] = 0;
  puVar1[0x17] = 0;
  puVar1[0x18] = 0;
  uVar2 = WSACreateEvent();
  puVar1[0x18] = uVar2;
  FUN_10005700(puVar1 + 0x19);
  FUN_100057a0((DWORD *)0x0);
  *puVar1 = DAT_10058438;
  DAT_10058438 = puVar1;
  FUN_10005830((undefined4 *)0x0);
  return puVar1;
}



undefined4 __cdecl FUN_100046f0(int param_1)

{
  SOCKET s;
  int iVar1;
  
  s = *(SOCKET *)(param_1 + 0x18);
  iVar1 = FUN_10004150();
  if (iVar1 < 0) {
    return 0xffffffff;
  }
  shutdown(s,2);
  closesocket(s);
  return 0;
}



int __cdecl FUN_10004720(int param_1,sockaddr *param_2,int param_3)

{
  int iVar1;
  
  bind(*(SOCKET *)(param_1 + 0x18),param_2,param_3);
  iVar1 = WSAGetLastError();
  iVar1 = FUN_100040e0(iVar1);
  if ((iVar1 == 0) && ((*(int *)(param_1 + 0xc) == 2 || (*(int *)(param_1 + 0xc) == 3)))) {
    WSASetEvent(DAT_1005844c);
  }
  return iVar1;
}



void __cdecl
FUN_10004770(DWORD *param_1,byte *param_2,int param_3,undefined4 param_4,int param_5,int param_6)

{
  SOCKET *pSVar1;
  int iVar2;
  DWORD *pDVar3;
  uint uVar4;
  sockaddr *to;
  int iVar5;
  DWORD *pDVar6;
  byte *pbVar7;
  int tolen;
  
  pbVar7 = param_2;
  pDVar3 = param_1;
  iVar2 = DAT_10057438;
  iVar5 = param_3;
  if (param_1[3] == 3) {
    pSVar1 = param_1 + 6;
    param_1 = (DWORD *)(uint)param_2[8];
    setsockopt(*pSVar1,0,4,(char *)&param_1,4);
    uVar4 = *pbVar7 & 0xf;
    iVar5 = param_3 + uVar4 * -4;
    pbVar7 = pbVar7 + uVar4 * 4;
    if (iVar5 < 0) {
      iVar5 = 0;
    }
  }
  pDVar6 = pDVar3 + 0x19;
  param_1 = pDVar6;
  FUN_100057a0(pDVar6);
  if (param_5 == 0) {
    send(pDVar3[6],(char *)pbVar7,iVar5,0);
  }
  else {
    tolen = param_6;
    to = (sockaddr *)FUN_10004060();
    sendto(pDVar3[6],(char *)pbVar7,iVar5,0,to,tolen);
    pDVar6 = param_1;
  }
  FUN_10005830(pDVar6);
  iVar5 = WSAGetLastError();
  FUN_100040e0(iVar5);
  FUN_1003fb09(iVar2);
  return;
}



int __cdecl
FUN_10004840(int param_1,char *param_2,uint param_3,undefined4 param_4,sockaddr *param_5,
            int *param_6)

{
  undefined4 uVar1;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  char *pcVar6;
  
  uVar5 = 0;
  if ((*(int *)(param_1 + 0xc) == 2) || (*(int *)(param_1 + 0xc) == 3)) {
    FUN_100057a0((DWORD *)(param_1 + 100));
    if (*(char *)(param_1 + 0xa8) == '\0') {
      uVar5 = *(uint *)(param_1 + 0x98);
      if ((uVar5 != 0) && (0 < (int)param_3)) {
        if (param_5 != (sockaddr *)0x0) {
          uVar1 = *(undefined4 *)(param_1 + 0x88);
          param_5->sa_family = (short)uVar1;
          param_5->sa_data[0] = (char)((uint)uVar1 >> 0x10);
          param_5->sa_data[1] = (char)((uint)uVar1 >> 0x18);
          *(undefined4 *)(param_5->sa_data + 2) = *(undefined4 *)(param_1 + 0x8c);
          *(undefined4 *)(param_5->sa_data + 6) = *(undefined4 *)(param_1 + 0x90);
          *(undefined4 *)(param_5->sa_data + 10) = *(undefined4 *)(param_1 + 0x94);
          *param_6 = 0x10;
        }
        if (0 < (int)uVar5) {
          if ((int)param_3 < (int)uVar5) {
            uVar5 = param_3;
          }
          pcVar6 = (char *)(param_1 + 0xa9);
          for (uVar4 = uVar5 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
            *(undefined4 *)param_2 = *(undefined4 *)pcVar6;
            pcVar6 = pcVar6 + 4;
            param_2 = param_2 + 4;
          }
          for (uVar4 = uVar5 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
            *param_2 = *pcVar6;
            pcVar6 = pcVar6 + 1;
            param_2 = param_2 + 1;
          }
          *(undefined4 *)(param_1 + 0x9c) = 0;
        }
        *(undefined4 *)(param_1 + 0x98) = 0;
      }
      uVar1 = DAT_1005844c;
      if (*(int *)(param_1 + 0x9c) != 0x3e5) {
        *(undefined4 *)(param_1 + 0x9c) = 0;
        WSASetEvent(uVar1);
      }
    }
    iVar3 = *(int *)(param_1 + 0x9c);
    FUN_10005830((DWORD *)(param_1 + 100));
  }
  else {
    if (param_5 == (sockaddr *)0x0) {
      uVar5 = recv(*(SOCKET *)(param_1 + 0x18),param_2,param_3,0);
    }
    else {
      uVar5 = recvfrom(*(SOCKET *)(param_1 + 0x18),param_2,param_3,0,param_5,param_6);
      if (0 < (int)uVar5) {
        DVar2 = GetTickCount();
        param_5->sa_data[9] = (char)DVar2;
        param_5->sa_data[8] = (char)(DVar2 >> 8);
        param_5->sa_data[7] = (char)(DVar2 >> 0x10);
        param_5->sa_data[6] = (char)(DVar2 >> 0x18);
        iVar3 = WSAGetLastError();
        goto LAB_1000498b;
      }
    }
    iVar3 = WSAGetLastError();
  }
LAB_1000498b:
  if (uVar5 == 0) {
    return -1;
  }
  iVar3 = FUN_100040e0(iVar3);
  return iVar3;
}



undefined4 __cdecl
FUN_100049b0(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            )

{
  *(undefined4 *)(param_1 + 0x44) = param_3;
  *(undefined4 *)(param_1 + 0x3c) = param_2;
  *(undefined4 *)(param_1 + 0x48) = param_4;
  *(undefined4 *)(param_1 + 0x4c) = param_5;
  return 0;
}



void __cdecl FUN_100049e0(undefined4 *param_1,uint param_2,sockaddr *param_3,uint param_4)

{
  sockaddr *name;
  SOCKET s;
  int iVar1;
  hostent *phVar2;
  uint uVar3;
  sockaddr *psVar4;
  undefined4 *puVar5;
  sockaddr local_114;
  char local_104 [256];
  int local_4;
  
  name = param_3;
  iVar1 = DAT_10057438;
  local_4 = DAT_10057438;
  if (param_2 != param_4) {
    FUN_1003fb09(DAT_10057438);
    return;
  }
  if (param_3->sa_family == 2) {
    psVar4 = param_3;
    puVar5 = param_1;
    for (uVar3 = param_2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
      *puVar5 = *(undefined4 *)psVar4;
      psVar4 = (sockaddr *)(psVar4->sa_data + 2);
      puVar5 = puVar5 + 1;
    }
    for (uVar3 = param_2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
      *(char *)puVar5 = (char)psVar4->sa_family;
      psVar4 = (sockaddr *)((int)&psVar4->sa_family + 1);
      puVar5 = (undefined4 *)((int)puVar5 + 1);
    }
    *(undefined1 *)((int)param_1 + 7) = 0;
    *(undefined1 *)((int)param_1 + 6) = 0;
    *(undefined1 *)((int)param_1 + 5) = 0;
    *(undefined1 *)(param_1 + 1) = 0;
    s = socket(2,2,0);
    if (s != 0xffffffff) {
      if (0x1ff < DAT_10058434) {
        local_114.sa_family = 0;
        local_114.sa_data[0] = '\0';
        local_114.sa_data[1] = '\0';
        local_114.sa_data[2] = '\0';
        local_114.sa_data[3] = '\0';
        local_114.sa_data[4] = '\0';
        local_114.sa_data[5] = '\0';
        local_114.sa_data[6] = '\0';
        local_114.sa_data[7] = '\0';
        local_114.sa_data[8] = '\0';
        local_114.sa_data[9] = '\0';
        local_114.sa_data[10] = '\0';
        local_114.sa_data[0xb] = '\0';
        local_114.sa_data[0xc] = '\0';
        local_114.sa_data[0xd] = '\0';
        iVar1 = WSAIoctl(s,0xc8000014,name,param_4,&local_114,0x10,&param_2,0,0);
        if (iVar1 < 0) {
          WSAGetLastError();
        }
        else {
          param_1[1] = local_114.sa_data._2_4_;
        }
        if (CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 1),
                                       *(undefined1 *)((int)param_1 + 5)),
                              *(undefined1 *)((int)param_1 + 6)),*(undefined1 *)((int)param_1 + 7))
            == 0x7f000001) {
          param_1[1] = *(undefined4 *)(name->sa_data + 2);
        }
      }
      if (CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 1),*(undefined1 *)((int)param_1 + 5)),
                   *(undefined1 *)((int)param_1 + 6)) == 0 && *(char *)((int)param_1 + 7) == '\0') {
        iVar1 = connect(s,name,param_4);
        if (iVar1 == 0) {
          iVar1 = getsockname(s,&local_114,(int *)&param_2);
          if (iVar1 == 0) {
            param_1[1] = local_114.sa_data._2_4_;
          }
        }
      }
      if (CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 1),*(undefined1 *)((int)param_1 + 5)),
                   *(undefined1 *)((int)param_1 + 6)) == 0 && *(char *)((int)param_1 + 7) == '\0') {
        gethostname(local_104,0x100);
        phVar2 = gethostbyname(local_104);
        if (phVar2 != (hostent *)0x0) {
          param_1[1] = *(undefined4 *)*phVar2->h_addr_list;
        }
      }
      closesocket(s);
    }
    FUN_1003fb09(local_4);
    return;
  }
  for (uVar3 = param_2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *param_1 = 0;
    param_1 = param_1 + 1;
  }
  for (uVar3 = param_2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined1 *)param_1 = 0;
    param_1 = (undefined4 *)((int)param_1 + 1);
  }
  FUN_1003fb09(iVar1);
  return;
}



void FUN_10004bd0(void)

{
  SOCKET s;
  int iVar1;
  
  FUN_10005890(0x100041f0,0x10058438);
  FUN_100058f0();
  DAT_10058448 = 0;
  WSASetEvent(DAT_1005844c);
  while (0 < DAT_1005708c) {
    Sleep(1);
  }
  CloseHandle(DAT_1005844c);
  DAT_1005844c = (HANDLE)0x0;
  while (DAT_10058438 != 0) {
    s = *(SOCKET *)(DAT_10058438 + 0x18);
    iVar1 = FUN_10004150();
    if (-1 < iVar1) {
      shutdown(s,2);
      closesocket(s);
    }
  }
  FUN_100041f0(&DAT_10058438);
  FUN_10005af0();
  WSACleanup();
  return;
}



void FUN_10004c80(void)

{
  sockaddr local_24;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  int local_4;
  
  local_4 = DAT_10057438;
  local_24.sa_data[6] = '\0';
  local_24.sa_data[7] = '\0';
  local_24.sa_data[8] = '\0';
  local_24.sa_data[9] = '\0';
  local_24.sa_data[10] = '\0';
  local_24.sa_data[0xb] = '\0';
  local_24.sa_data[0xc] = '\0';
  local_24.sa_data[0xd] = '\0';
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_24.sa_family = 2;
  local_24.sa_data[0] = '\0';
  local_24.sa_data[1] = 'O';
  local_24.sa_data[2] = -0x40;
  local_24.sa_data[3] = -0x58;
  local_24.sa_data[4] = '\x01';
  local_24.sa_data[5] = '\x01';
  local_8 = 0;
  FUN_100049e0(&local_14,0x10,&local_24,0x10);
  FUN_1003fb09(local_4);
  return;
}



void __fastcall FUN_10004d20(undefined4 param_1,byte *param_2)

{
  byte bVar1;
  byte *in_EAX;
  byte bVar2;
  
  do {
    bVar2 = *in_EAX;
    in_EAX = in_EAX + 1;
    if (('@' < (char)bVar2) && ((char)bVar2 < '[')) {
      bVar2 = bVar2 ^ 0x20;
    }
    bVar1 = *param_2;
    param_2 = param_2 + 1;
    if (('@' < (char)bVar1) && ((char)bVar1 < '[')) {
      bVar1 = bVar1 ^ 0x20;
    }
  } while ((bVar2 != 0) && (bVar2 == bVar1));
  return;
}



void __fastcall FUN_10004d60(undefined4 param_1,int param_2)

{
  int iVar1;
  byte *pbVar2;
  byte local_190 [8];
  undefined1 local_188;
  int local_c;
  
  local_c = DAT_10057438;
  pbVar2 = local_190;
  for (iVar1 = 0x60; iVar1 != 0; iVar1 = iVar1 + -1) {
    pbVar2[0] = 0;
    pbVar2[1] = 0;
    pbVar2[2] = 0;
    pbVar2[3] = 0;
    pbVar2 = pbVar2 + 4;
  }
  local_190[0] = 0x67;
  local_190[1] = 0x45;
  local_190[2] = 0x41;
  local_188 = 0x3f;
  FUN_10004770(*(DWORD **)(param_2 + 0x38),local_190,0x180,0,param_2 + 0x3c,0x10);
  FUN_1003fb09(local_c);
  return;
}



void __cdecl FUN_10004dd0(undefined4 param_1,undefined4 param_2,DWORD *param_3)

{
  DWORD *pDVar1;
  char cVar2;
  undefined4 *puVar3;
  byte *pbVar4;
  int iVar5;
  DWORD DVar6;
  char *pcVar7;
  DWORD DVar8;
  char *extraout_ECX;
  char *extraout_ECX_00;
  char *pcVar9;
  char *extraout_ECX_01;
  char *extraout_ECX_02;
  char *extraout_ECX_03;
  undefined4 *puVar10;
  undefined4 *puVar11;
  short *psVar12;
  DWORD *pDVar13;
  bool bVar14;
  uint local_1ac;
  int local_1a8;
  sockaddr local_1a4;
  u_short local_194;
  short local_192;
  undefined1 local_190;
  undefined1 local_18f;
  undefined1 local_18e;
  undefined1 local_18d;
  char local_184;
  char local_183;
  char local_182;
  byte local_181;
  char *local_180;
  char local_17c [32];
  char local_15c [32];
  char local_13c [192];
  char local_7c [120];
  int local_4;
  
  local_4 = DAT_10057438;
  iVar5 = FUN_10005750(param_3);
  if (iVar5 != 0) {
    DVar6 = param_3[0xe];
    pcVar9 = extraout_ECX;
    while (DVar6 != 0) {
      if (0 < (int)param_3[0xc]) {
        param_3[0xc] = 0;
        FUN_10004d60(pcVar9,(int)param_3);
      }
      local_17c[0] = '\0';
      local_1a8 = 0x10;
      iVar5 = FUN_10004840(param_3[0xe],&local_184,0x180,0,&local_1a4,&local_1a8);
      if ((iVar5 < 1) || (local_17c[0] == '\0')) break;
      FUN_100049e0((undefined4 *)&local_194,0x10,&local_1a4,0x10);
      local_1ac = 0;
      pcVar9 = extraout_ECX_00;
      if ((local_194 == local_1a4.sa_family) && (local_1a4.sa_family == 2)) {
        bVar14 = true;
        pcVar9 = (char *)0x3;
        pcVar7 = local_1a4.sa_data;
        psVar12 = &local_192;
        do {
          if (pcVar9 == (char *)0x0) break;
          pcVar9 = pcVar9 + -1;
          bVar14 = *(short *)pcVar7 == *psVar12;
          pcVar7 = pcVar7 + 2;
          psVar12 = psVar12 + 1;
        } while (bVar14);
        local_1ac = (uint)bVar14;
      }
      if (((local_184 == 'g') && (local_183 == 'E')) && (local_182 == 'A')) {
        if ((local_17c[0] == '?') && (local_17c[1] == '\0')) {
          DVar6 = GetTickCount();
          pcVar9 = (char *)param_3[9];
          if (pcVar9 != (char *)0x0) {
            do {
              if (DVar6 + 1000 < *(uint *)(pcVar9 + 0x180)) {
                *(DWORD *)(pcVar9 + 0x180) = DVar6 + 1000;
              }
              pcVar9 = *(char **)(pcVar9 + 0x1a0);
            } while (pcVar9 != (char *)0x0);
            pcVar9 = (char *)0x0;
          }
        }
        else if (local_15c[0] != '\0') {
          puVar11 = (undefined4 *)param_3[10];
          puVar3 = (undefined4 *)param_3[0xb];
          puVar10 = (undefined4 *)0x0;
          if (puVar11 == puVar3) {
LAB_10004f6e:
            if (puVar10 != (undefined4 *)0x0) {
              puVar11 = puVar10;
              for (iVar5 = 0x69; iVar5 != 0; iVar5 = iVar5 + -1) {
                *puVar11 = 0;
                puVar11 = puVar11 + 1;
              }
              puVar10[1] = local_180;
              pcVar9 = local_17c;
              iVar5 = 8 - (int)pcVar9;
              do {
                cVar2 = *pcVar9;
                pcVar9[(int)puVar10 + iVar5] = cVar2;
                pcVar9 = pcVar9 + 1;
              } while (cVar2 != '\0');
              pcVar9 = local_15c;
              iVar5 = 0x28 - (int)pcVar9;
              do {
                cVar2 = *pcVar9;
                pcVar9[(int)puVar10 + iVar5] = cVar2;
                pcVar9 = pcVar9 + 1;
              } while (cVar2 != '\0');
              pcVar7 = local_13c;
              iVar5 = 0x48 - (int)pcVar7;
              pcVar9 = pcVar7;
              do {
                cVar2 = *pcVar7;
                pcVar9 = (char *)CONCAT31((int3)((uint)pcVar9 >> 8),cVar2);
                pcVar7[(int)puVar10 + iVar5] = cVar2;
                pcVar7 = pcVar7 + 1;
              } while (cVar2 != '\0');
              param_3[0x13] = param_3[0x13] + 1;
              puVar11 = puVar10;
            }
          }
          else {
            do {
              if ((puVar10 == (undefined4 *)0x0) && (*(char *)(puVar11 + 10) == '\0')) {
                puVar10 = puVar11;
              }
              iVar5 = FUN_10004d20(pcVar9,(byte *)(puVar11 + 2));
              pcVar9 = extraout_ECX_01;
            } while ((((iVar5 != 0) ||
                      (iVar5 = FUN_10004d20(extraout_ECX_01,(byte *)(puVar11 + 10)),
                      pcVar9 = extraout_ECX_02, iVar5 != 0)) ||
                     (pcVar9 = local_180, local_180 != (char *)puVar11[1])) &&
                    (puVar11 = puVar11 + 0x69, puVar11 != (undefined4 *)param_3[0xb]));
            if (puVar11 == puVar3) goto LAB_10004f6e;
          }
          if (puVar11 != (undefined4 *)param_3[0xb]) {
            pcVar9 = local_7c;
            iVar5 = 0x108 - (int)pcVar9;
            do {
              cVar2 = *pcVar9;
              pcVar9[(int)puVar11 + iVar5] = cVar2;
              pcVar9 = pcVar9 + 1;
            } while (cVar2 != '\0');
            pcVar9 = local_13c;
            iVar5 = 0x48 - (int)pcVar9;
            do {
              cVar2 = *pcVar9;
              pcVar9[(int)puVar11 + iVar5] = cVar2;
              pcVar9 = pcVar9 + 1;
            } while (cVar2 != '\0');
            DVar6 = GetTickCount();
            puVar11[0x67] = local_1ac;
            puVar11[0x60] = DVar6 + 1000 + (uint)local_181 * 2000;
            puVar11[0x65] =
                 CONCAT31(CONCAT21(CONCAT11(local_1a4.sa_data[2],local_1a4.sa_data[3]),
                                   local_1a4.sa_data[4]),local_1a4.sa_data[5]);
            puVar11[0x66] = CONCAT31(CONCAT21(CONCAT11(local_190,local_18f),local_18e),local_18d);
            FUN_10005b60((int)&local_1a4,(char *)(puVar11 + 0x61),0x10);
            param_3[0x13] = param_3[0x13] + 1;
            pcVar9 = extraout_ECX_03;
          }
        }
      }
      DVar6 = param_3[0xe];
    }
    DVar8 = GetTickCount();
    DVar6 = param_3[10];
    if (DVar6 != param_3[0xb]) {
      do {
        if ((*(char *)(DVar6 + 0x28) != '\0') &&
           (((*(char *)(DVar6 + 0x108) == '\0' || (*(uint *)(DVar6 + 0x180) == 0)) ||
            (*(uint *)(DVar6 + 0x180) < DVar8)))) {
          *(undefined1 *)(DVar6 + 0x28) = 0;
          *(undefined1 *)(DVar6 + 8) = 0;
          param_3[0x13] = param_3[0x13] + 1;
        }
        DVar6 = DVar6 + 0x1a4;
      } while (DVar6 != param_3[0xb]);
    }
    pDVar1 = param_3 + 9;
    DVar6 = *pDVar1;
    pDVar13 = pDVar1;
    while (DVar6 != 0) {
      pbVar4 = (byte *)*pDVar13;
      if (*(int *)(pbVar4 + 0x180) == 0) {
        *pDVar13 = *(DWORD *)(pbVar4 + 0x1a0);
        pbVar4[0x108] = 0;
        FUN_10004770((DWORD *)param_3[0xe],pbVar4,0x180,0,(int)(param_3 + 0xf),0x10);
        FUN_10001540(pbVar4);
      }
      else {
        pDVar13 = (DWORD *)(pbVar4 + 0x1a0);
      }
      DVar6 = *pDVar13;
    }
    DVar6 = GetTickCount();
    for (pbVar4 = (byte *)*pDVar1; pbVar4 != (byte *)0x0; pbVar4 = *(byte **)(pbVar4 + 0x1a0)) {
      if (*(uint *)(pbVar4 + 0x180) < DVar6) {
        FUN_10004770((DWORD *)param_3[0xe],pbVar4,0x180,0,(int)(param_3 + 0xf),0x10);
        *(uint *)(pbVar4 + 0x180) = (uint)pbVar4[3] * 1000 + DVar6;
      }
    }
    FUN_10005830(param_3);
  }
  FUN_1003fb09(local_4);
  return;
}



undefined4 __thiscall
FUN_100051d0(void *this,DWORD *param_1,char *param_2,char *param_3,char *param_4,char *param_5,
            int param_6)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  byte *pbVar4;
  DWORD DVar5;
  DWORD DVar6;
  void *extraout_ECX;
  void *extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 extraout_ECX_02;
  undefined4 uVar7;
  
  if (param_6 == 0) {
    param_6 = 0x1e;
  }
  else if (param_6 < 2) {
    param_6 = 2;
  }
  else if (0xfa < param_6) {
    param_6 = 0xfa;
  }
  if ((param_2 != (char *)0x0) && (*param_2 != '\0')) {
    pcVar2 = param_2;
    do {
      cVar1 = *pcVar2;
      this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    if ((uint)((int)pcVar2 - (int)(param_2 + 1)) < 0x20) {
      if ((param_3 != (char *)0x0) && (*param_3 != '\0')) {
        pcVar2 = param_3;
        do {
          cVar1 = *pcVar2;
          this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
          pcVar2 = pcVar2 + 1;
        } while (cVar1 != '\0');
        if ((uint)((int)pcVar2 - (int)(param_3 + 1)) < 0x20) {
          if (param_4 != (char *)0x0) {
            pcVar2 = param_4;
            do {
              cVar1 = *pcVar2;
              this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
              pcVar2 = pcVar2 + 1;
            } while (cVar1 != '\0');
            if ((uint)((int)pcVar2 - (int)(param_4 + 1)) < 0xc0) {
              if (param_5 != (char *)0x0) {
                pcVar2 = param_5;
                do {
                  cVar1 = *pcVar2;
                  this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
                  pcVar2 = pcVar2 + 1;
                } while (cVar1 != '\0');
                if ((uint)((int)pcVar2 - (int)(param_5 + 1)) < 0x78) {
                  DVar5 = param_1[9];
                  while( true ) {
                    if (DVar5 == 0) {
                      pbVar4 = (byte *)FUN_10001520(0x1a4);
                      DVar5 = GetTickCount();
                      *(DWORD *)(pbVar4 + 0x180) = DVar5;
                      pbVar4[3] = (byte)param_6;
                      pbVar4[4] = (byte)(DVar5 >> 0x18);
                      pbVar4[7] = pbVar4[0x180];
                      pbVar4[6] = (byte)(DVar5 >> 8);
                      *pbVar4 = 0x67;
                      pbVar4[1] = 0x45;
                      pbVar4[2] = 0x41;
                      pbVar4[5] = (byte)(DVar5 >> 0x10);
                      iVar3 = 8 - (int)param_2;
                      do {
                        cVar1 = *param_2;
                        param_2[(int)(pbVar4 + iVar3)] = cVar1;
                        param_2 = param_2 + 1;
                      } while (cVar1 != '\0');
                      iVar3 = 0x28 - (int)param_3;
                      do {
                        cVar1 = *param_3;
                        param_3[(int)(pbVar4 + iVar3)] = cVar1;
                        param_3 = param_3 + 1;
                      } while (cVar1 != '\0');
                      iVar3 = 0x108 - (int)param_5;
                      do {
                        cVar1 = *param_5;
                        param_5[(int)(pbVar4 + iVar3)] = cVar1;
                        param_5 = param_5 + 1;
                      } while (cVar1 != '\0');
                      iVar3 = 0x48 - (int)param_4;
                      do {
                        cVar1 = *param_4;
                        param_4[(int)(pbVar4 + iVar3)] = cVar1;
                        param_4 = param_4 + 1;
                      } while (cVar1 != '\0');
                      FUN_10004770((DWORD *)param_1[0xe],pbVar4,0x180,0,(int)(param_1 + 0xf),0x10);
                      DVar5 = GetTickCount();
                      *(DWORD *)(pbVar4 + 0x180) = DVar5 + 0xfa;
                      FUN_100057a0(param_1);
                      *(DWORD *)(pbVar4 + 0x1a0) = param_1[9];
                      param_1[9] = (DWORD)pbVar4;
                      FUN_10005830(param_1);
                      return 0;
                    }
                    iVar3 = FUN_10004d20(this,(byte *)(DVar5 + 8));
                    this = extraout_ECX;
                    if ((iVar3 == 0) &&
                       (iVar3 = FUN_10004d20(extraout_ECX,(byte *)(DVar5 + 0x28)),
                       this = extraout_ECX_00, iVar3 == 0)) break;
                    DVar5 = *(DWORD *)(DVar5 + 0x1a0);
                  }
                  iVar3 = FUN_10004d20(extraout_ECX_00,(byte *)(DVar5 + 0x108));
                  uVar7 = extraout_ECX_01;
                  if (iVar3 != 0) {
                    iVar3 = (int)(DVar5 + 0x108) - (int)param_5;
                    do {
                      cVar1 = *param_5;
                      param_5[iVar3] = cVar1;
                      param_5 = param_5 + 1;
                    } while (cVar1 != '\0');
                    DVar6 = GetTickCount();
                    *(DWORD *)(DVar5 + 0x180) = DVar6 - 1;
                    uVar7 = extraout_ECX_02;
                  }
                  iVar3 = FUN_10004d20(uVar7,(byte *)(DVar5 + 0x48));
                  if (iVar3 == 0) {
                    return 0;
                  }
                  iVar3 = (int)(DVar5 + 0x48) - (int)param_4;
                  do {
                    cVar1 = *param_4;
                    param_4[iVar3] = cVar1;
                    param_4 = param_4 + 1;
                  } while (cVar1 != '\0');
                  DVar6 = GetTickCount();
                  *(DWORD *)(DVar5 + 0x180) = DVar6 - 1;
                  return 0;
                }
              }
              return 0xfffffffc;
            }
          }
          return 0xfffffffd;
        }
      }
      return 0xfffffffe;
    }
  }
  return 0xffffffff;
}



int __cdecl FUN_10005450(DWORD *param_1,int param_2,int param_3)

{
  DWORD DVar1;
  int iVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar3;
  
  FUN_100057a0(param_1);
  DVar1 = param_1[9];
  uVar3 = extraout_ECX;
  do {
    if (DVar1 == 0) {
LAB_100054ac:
      FUN_10005830(param_1);
      return (DVar1 != 0) - 1;
    }
    if (((param_2 == 0) ||
        (iVar2 = FUN_10004d20(uVar3,(byte *)(DVar1 + 8)), uVar3 = extraout_ECX_00, iVar2 == 0)) &&
       ((param_3 == 0 ||
        (iVar2 = FUN_10004d20(uVar3,(byte *)(DVar1 + 0x28)), uVar3 = extraout_ECX_01, iVar2 == 0))))
    {
      *(undefined4 *)(DVar1 + 0x180) = 0;
      goto LAB_100054ac;
    }
    DVar1 = *(DWORD *)(DVar1 + 0x1a0);
  } while( true );
}



void __cdecl FUN_100054c0(int param_1)

{
  DWORD *pDVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  undefined4 extraout_ECX;
  DWORD *pDVar6;
  sockaddr local_14;
  int local_4;
  
  local_4 = DAT_10057438;
  if (DAT_10058454 != (DWORD *)0x0) {
    DAT_10058450 = DAT_10058450 + 1;
    FUN_1003fb09(DAT_10057438);
    return;
  }
  pDVar1 = (DWORD *)FUN_10001520(0x50);
  if (pDVar1 == (DWORD *)0x0) {
LAB_10005638:
    FUN_1003fb09(local_4);
    return;
  }
  pDVar6 = pDVar1;
  for (iVar3 = 0x14; iVar3 != 0; iVar3 = iVar3 + -1) {
    *pDVar6 = 0;
    pDVar6 = pDVar6 + 1;
  }
  if (param_1 < 4) {
    param_1 = 4;
  }
  puVar2 = (undefined4 *)FUN_10001520(param_1 * 0x1a4);
  pDVar1[10] = (DWORD)puVar2;
  if (puVar2 != (undefined4 *)0x0) {
    pDVar1[0xb] = (DWORD)(puVar2 + param_1 * 0x69);
    uVar4 = (int)(puVar2 + param_1 * 0x69) - (int)puVar2;
    for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
      *(undefined1 *)puVar2 = 0;
      puVar2 = (undefined4 *)((int)puVar2 + 1);
    }
    pDVar1[0x13] = 1;
    puVar2 = FUN_10004620(2,2,0);
    if (puVar2 != (undefined4 *)0x0) {
      DAT_10058450 = 1;
      DAT_10058454 = pDVar1;
      FUN_10005700(pDVar1);
      FUN_100057a0(pDVar1);
      local_14.sa_family = 2;
      local_14.sa_data[2] = '\0';
      local_14.sa_data[3] = '\0';
      local_14.sa_data[4] = '\0';
      local_14.sa_data[5] = '\0';
      local_14.sa_data[6] = '\0';
      local_14.sa_data[7] = '\0';
      local_14.sa_data[8] = '\0';
      local_14.sa_data[9] = '\0';
      local_14.sa_data[10] = '\0';
      local_14.sa_data[0xb] = '\0';
      local_14.sa_data[0xc] = '\0';
      local_14.sa_data[0xd] = '\0';
      local_14.sa_data[0] = '\'';
      local_14.sa_data[1] = '\x0f';
      FUN_10004720((int)puVar2,&local_14,0x10);
      pDVar1[0xf] = 0xf270002;
      pDVar1[0x10] = 0xffffffff;
      pDVar1[0x11] = 0;
      pDVar1[0x12] = 0;
      pDVar1[0xc] = 1;
      pDVar1[0xe] = (DWORD)puVar2;
      FUN_100049b0((int)puVar2,2,100,pDVar1,FUN_10004dd0);
      FUN_10005830(pDVar1);
      FUN_10004d60(extraout_ECX,(int)pDVar1);
      goto LAB_10005638;
    }
  }
  FUN_10001540(pDVar1);
  FUN_1003fb09(local_4);
  return;
}



void __cdecl FUN_10005650(DWORD *param_1)

{
  DWORD DVar1;
  
  if (param_1 != (DWORD *)0x0) {
    if (1 < DAT_10058450) {
      DAT_10058450 = DAT_10058450 + -1;
      return;
    }
    DVar1 = param_1[9];
    DAT_10058454 = 0;
    DAT_10058450 = 0;
    while (DVar1 != 0) {
      FUN_10005450(param_1,param_1[9] + 8,param_1[9] + 0x28);
      FUN_10004dd0(param_1[0xe],0,param_1);
      DVar1 = param_1[9];
    }
    FUN_100057a0(param_1);
    DVar1 = param_1[0xe];
    param_1[0xe] = 0;
    FUN_10005830(param_1);
    FUN_100046f0(DVar1);
    FUN_10005730(param_1);
    FUN_10001540((LPVOID)param_1[10]);
    FUN_10001540(param_1);
  }
  return;
}



DWORD GetTickCount(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x100056f0. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetTickCount();
  return DVar1;
}



void __cdecl FUN_10005700(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    param_1 = &DAT_100588d8;
  }
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return;
}



void __cdecl FUN_10005730(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    param_1 = &DAT_100588d8;
  }
  param_1[2] = 0;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return;
}



undefined4 __cdecl FUN_10005750(DWORD *param_1)

{
  DWORD DVar1;
  LONG LVar2;
  
  if (param_1 == (DWORD *)0x0) {
    param_1 = &DAT_100588d8;
  }
  DVar1 = GetCurrentThreadId();
  if (*param_1 != DVar1) {
    LVar2 = InterlockedExchange((LONG *)(param_1 + 2),1);
    if (LVar2 != 0) {
      return 0;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
    DVar1 = GetCurrentThreadId();
    *param_1 = DVar1;
  }
  param_1[1] = param_1[1] + 1;
  return 1;
}



void __cdecl FUN_100057a0(DWORD *param_1)

{
  DWORD DVar1;
  LONG LVar2;
  DWORD *pDVar3;
  DWORD *pDVar4;
  
  pDVar4 = param_1;
  if (param_1 == (DWORD *)0x0) {
    pDVar4 = &DAT_100588d8;
  }
  while( true ) {
    pDVar3 = param_1;
    if (param_1 == (DWORD *)0x0) {
      pDVar3 = &DAT_100588d8;
    }
    DVar1 = GetCurrentThreadId();
    if (*pDVar3 == DVar1) break;
    LVar2 = InterlockedExchange((LONG *)(pDVar3 + 2),1);
    if (LVar2 == 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(pDVar3 + 3));
      DVar1 = GetCurrentThreadId();
      *pDVar3 = DVar1;
      break;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(pDVar4 + 3));
    LVar2 = InterlockedExchange((LONG *)(pDVar4 + 2),1);
    if (LVar2 == 0) {
      DVar1 = GetCurrentThreadId();
      *pDVar4 = DVar1;
      pDVar4[1] = pDVar4[1] + 1;
      return;
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)(pDVar4 + 3));
    Sleep(1);
  }
  pDVar3[1] = pDVar3[1] + 1;
  return;
}



void __cdecl FUN_10005830(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    param_1 = &DAT_100588d8;
  }
  if (1 < (uint)param_1[1]) {
    param_1[1] = param_1[1] - 1;
    return;
  }
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return;
}



void __cdecl FUN_10005860(int param_1,int param_2)

{
  if ((param_1 != 0) && (param_2 != 0)) {
    (&DAT_10058900)[DAT_10058a24 * 2] = param_1;
    (&DAT_10058904)[DAT_10058a24 * 2] = param_2;
    DAT_10058a24 = DAT_10058a24 + 1;
  }
  return;
}



void __cdecl FUN_10005890(int param_1,int param_2)

{
  int iVar1;
  
  if (((param_1 != 0) && (param_2 != 0)) && (iVar1 = 0, 0 < DAT_10058a24)) {
    while (((&DAT_10058900)[iVar1 * 2] != param_1 || ((&DAT_10058904)[iVar1 * 2] != param_2))) {
      iVar1 = iVar1 + 1;
      if (DAT_10058a24 <= iVar1) {
        return;
      }
    }
    (&DAT_10058900)[iVar1 * 2] = 0;
    (&DAT_10058904)[iVar1 * 2] = 0;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_100058f0(void)

{
  FUN_100057a0(&DAT_10058a00);
  if (1 < DAT_10058a04) {
    DAT_10058a04 = DAT_10058a04 - 1;
    return;
  }
  DAT_10058a00 = 0;
  DAT_10058a04 = 0;
  _DAT_10058a08 = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_10058a0c);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_10005930(void)

{
  DWORD DVar1;
  LONG LVar2;
  int iVar3;
  
  DVar1 = GetCurrentThreadId();
  if (DAT_10058a00 != DVar1) {
    LVar2 = InterlockedExchange((LONG *)&DAT_10058a08,1);
    if (LVar2 != 0) {
      return;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_10058a0c);
    DAT_10058a00 = GetCurrentThreadId();
  }
  DAT_10058a04 = DAT_10058a04 + 1;
  iVar3 = 0;
  if (0 < DAT_10058a24) {
    do {
      if (((code *)(&DAT_10058900)[iVar3 * 2] == (code *)0x0) || ((&DAT_10058904)[iVar3 * 2] == 0))
      {
        (&DAT_10058900)[iVar3 * 2] = *(undefined4 *)(&DAT_100588f8 + DAT_10058a24 * 8);
        (&DAT_10058904)[iVar3 * 2] = *(undefined4 *)(&DAT_100588fc + DAT_10058a24 * 8);
        *(undefined4 *)(&DAT_100588f8 + DAT_10058a24 * 8) = 0;
        *(undefined4 *)(&DAT_100588fc + DAT_10058a24 * 8) = 0;
        DAT_10058a24 = DAT_10058a24 + -1;
        iVar3 = iVar3 + -1;
      }
      else {
        (*(code *)(&DAT_10058900)[iVar3 * 2])((&DAT_10058904)[iVar3 * 2]);
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < DAT_10058a24);
  }
  if (DAT_10058a04 < 2) {
    DAT_10058a00 = 0;
    DAT_10058a04 = 0;
    _DAT_10058a08 = 0;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_10058a0c);
    return;
  }
  DAT_10058a04 = DAT_10058a04 - 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __cdecl FUN_10005a50(int param_1)

{
  DWORD local_4;
  
  DAT_10058a24 = 0;
  DAT_10057094 = 0xffffffff;
  DAT_100588d8 = 0;
  DAT_100588dc = 0;
  DAT_100588e0 = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&DAT_100588e4);
  DAT_10058a00 = 0;
  DAT_10058a04 = 0;
  _DAT_10058a08 = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&DAT_10058a0c);
  DAT_10058a28 = (HANDLE)0x1;
  DAT_10058a28 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_10005a10,
                              (LPVOID)0x0,0,&local_4);
  if (DAT_10058a28 != (HANDLE)0x0) {
    SetThreadPriority(DAT_10058a28,param_1);
    CloseHandle(DAT_10058a28);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_10005af0(void)

{
  DAT_10058a28 = 0;
  if (0 < DAT_10057094) {
    do {
      Sleep(1);
    } while (0 < DAT_10057094);
  }
  DAT_100588e0 = 0;
  DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_100588e4);
  _DAT_10058a08 = 0;
  DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_10058a0c);
  return;
}



void FUN_10005b50(void)

{
  FID_conflict___time32((__time32_t *)0x0);
  return;
}



char * __cdecl FUN_10005b60(int param_1,char *param_2,int param_3)

{
  ulonglong uVar1;
  uint uVar2;
  uint uVar3;
  char *pcVar4;
  char *pcVar5;
  
  if (0 < param_3) {
    if (0xf < param_3) {
      uVar2 = (uint)*(byte *)(param_1 + 4);
      pcVar4 = param_2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *param_2 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        param_2[1] = (char)(uVar1 / 10) + '0';
        pcVar4 = param_2 + 2;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar4 = (char)uVar3 + '0';
        pcVar4 = pcVar4 + 1;
      }
      *pcVar4 = (char)uVar2 + '0';
      pcVar4[1] = '.';
      uVar2 = (uint)*(byte *)(param_1 + 5);
      pcVar5 = pcVar4 + 2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *pcVar5 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        pcVar4[3] = (char)(uVar1 / 10) + '0';
        pcVar5 = pcVar4 + 4;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar5 = (char)uVar3 + '0';
        pcVar5 = pcVar5 + 1;
      }
      *pcVar5 = (char)uVar2 + '0';
      pcVar5[1] = '.';
      uVar2 = (uint)*(byte *)(param_1 + 6);
      pcVar4 = pcVar5 + 2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *pcVar4 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        pcVar5[3] = (char)(uVar1 / 10) + '0';
        pcVar4 = pcVar5 + 4;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar4 = (char)uVar3 + '0';
        pcVar4 = pcVar4 + 1;
      }
      *pcVar4 = (char)uVar2 + '0';
      pcVar4[1] = '.';
      uVar2 = (uint)*(byte *)(param_1 + 7);
      pcVar5 = pcVar4 + 2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *pcVar5 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        pcVar4[3] = (char)(uVar1 / 10) + '0';
        pcVar5 = pcVar4 + 4;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar5 = (char)uVar3 + '0';
        pcVar5 = pcVar5 + 1;
      }
      *pcVar5 = (char)uVar2 + '0';
      pcVar5[1] = '\0';
      return param_2;
    }
    *param_2 = '\0';
  }
  return (char *)0x0;
}



void __cdecl FUN_10005ca0(char *param_1,size_t param_2,char *param_3)

{
  *param_1 = '\0';
  __vsnprintf(param_1,param_2,param_3,&stack0x00000010);
  param_1[param_2 - 1] = '\0';
  return;
}



void __cdecl FUN_10005cd0(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte bVar2;
  
  do {
    bVar2 = *param_1;
    param_1 = param_1 + 1;
    if (('@' < (char)bVar2) && ((char)bVar2 < '[')) {
      bVar2 = bVar2 ^ 0x20;
    }
    bVar1 = *param_2;
    param_2 = param_2 + 1;
    if (('@' < (char)bVar1) && ((char)bVar1 < '[')) {
      bVar1 = bVar1 ^ 0x20;
    }
  } while ((bVar2 != 0) && (bVar2 == bVar1));
  return;
}



int __cdecl FUN_10005d10(byte *param_1,byte *param_2,uint param_3)

{
  byte bVar1;
  byte bVar2;
  uint uVar3;
  
  if (param_3 == 0) {
    return 0;
  }
  uVar3 = 0;
  do {
    bVar2 = *param_1;
    param_1 = param_1 + 1;
    if (('@' < (char)bVar2) && ((char)bVar2 < '[')) {
      bVar2 = bVar2 ^ 0x20;
    }
    bVar1 = *param_2;
    param_2 = param_2 + 1;
    if (('@' < (char)bVar1) && ((char)bVar1 < '[')) {
      bVar1 = bVar1 ^ 0x20;
    }
    uVar3 = uVar3 + 1;
  } while (((bVar2 != 0) && ((int)(char)bVar2 - (int)(char)bVar1 == 0)) && (uVar3 < param_3));
  return (int)(char)bVar2 - (int)(char)bVar1;
}



char * __cdecl FUN_10005d70(char *param_1,char *param_2,size_t param_3)

{
  _strncpy(param_1,param_2,param_3);
  param_1[param_3 - 1] = '\0';
  return param_1;
}



undefined4 __cdecl FUN_10005de0(undefined4 param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte local_14 [20];
  
  pbVar4 = &DAT_1004d26f;
  iVar3 = 0x14;
  pbVar2 = local_14;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar1,pbVar2,iVar3,pbVar4);
  if (local_14[0] == 0) {
    pbVar4 = &DAT_1004d26f;
    iVar3 = 0x14;
    pbVar2 = local_14;
    pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c0);
    FUN_10002a30(pbVar1,pbVar2,iVar3,pbVar4);
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c8,local_14);
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c0,local_14);
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"PERSONAS",local_14);
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8ac);
  FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8ac,pbVar2);
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8a8,1);
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"SHARE",1);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x54) = 0;
  return 0;
}



undefined4 __cdecl FUN_10006020(undefined4 *param_1,int param_2)

{
  byte *pbVar1;
  int iVar2;
  byte local_34 [20];
  byte local_20 [32];
  
  iVar2 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"BSLOT");
  FUN_10002480((char *)pbVar1,iVar2);
  iVar2 = 0;
  while( true ) {
    _sprintf((char *)local_20,"PERS%d",iVar2);
    pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),local_20);
    if (pbVar1 == (byte *)0x0) break;
    FUN_10002a30(pbVar1,local_34,0x11,&DAT_1004d26f);
    FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                 (byte *)"BSLOT=%d BIDX=%d PERS=%s");
    FUN_10014430(*param_1,param_2,0x21626174,0,*(char **)(param_2 + 0x60),(char *)0xffffffff);
    iVar2 = iVar2 + 1;
  }
  *(undefined4 *)(param_2 + 0x58) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  return 0;
}



void FUN_10006270(void)

{
  int in_EAX;
  undefined4 *puVar1;
  int iVar2;
  
  puVar1 = (undefined4 *)(in_EAX + 0x404);
  iVar2 = 8;
  do {
    if ((void *)*puVar1 != (void *)0x0) {
      FUN_10015f70((void *)*puVar1);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 0x238;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



int __cdecl FUN_100062b0(byte *param_1)

{
  int iVar1;
  int unaff_EBX;
  uint uVar2;
  byte *pbVar3;
  
  uVar2 = 0;
  pbVar3 = (byte *)(unaff_EBX + 0x1e4);
  do {
    if (*(int *)(pbVar3 + 0x220) != 0) {
      iVar1 = FUN_10005cd0(pbVar3,param_1);
      if (iVar1 == 0) {
        return uVar2 * 0x8e0 + 0x1e4 + unaff_EBX;
      }
    }
    uVar2 = uVar2 + 1;
    pbVar3 = pbVar3 + 0x8e0;
  } while (uVar2 < 8);
  return 0;
}



undefined4 FUN_10006300(void)

{
  int in_EAX;
  byte *pbVar1;
  byte *pbVar2;
  uint uVar3;
  int *piVar4;
  byte *unaff_ESI;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  byte local_120 [32];
  byte local_100 [256];
  
  iVar6 = -1;
  pbVar1 = FUN_100020f0(unaff_ESI,&DAT_1004d950);
  iVar6 = FUN_10002480((char *)pbVar1,iVar6);
  if (iVar6 == -1) {
    return 0x6d697373;
  }
  if ((-1 < iVar6) && (iVar6 < 8)) {
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x20;
    pbVar1 = local_120;
    pbVar2 = FUN_100020f0(unaff_ESI,(byte *)"LOBBY");
    FUN_10002a30(pbVar2,pbVar1,iVar5,pbVar7);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x100;
    pbVar1 = local_100;
    pbVar2 = FUN_100020f0(unaff_ESI,(byte *)"PARAM");
    FUN_10002a30(pbVar2,pbVar1,iVar5,pbVar7);
    if (local_120[0] != 0) {
      iVar5 = FUN_100062b0(local_120);
      if (iVar5 == 0) {
        FUN_10016450(0x40000);
        return 0;
      }
      *(int *)(iVar5 + 0x730) = iVar6;
      FUN_10005d70((char *)(iVar5 + 0x734),(char *)local_100,0x100);
      return 0;
    }
    uVar3 = 0;
    piVar4 = (int *)(in_EAX + 0x404);
    do {
      if (*piVar4 != 0) {
        iVar5 = uVar3 * 0x8e0 + in_EAX;
        *(int *)(iVar5 + 0x914) = iVar6;
        FUN_10005d70((char *)(iVar5 + 0x918),(char *)local_100,0x100);
        return 0;
      }
      uVar3 = uVar3 + 1;
      piVar4 = piVar4 + 0x238;
    } while (uVar3 < 8);
    return 0x6e666e64;
  }
  return 0x696e7670;
}



void __cdecl FUN_10006460(int param_1)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  char *unaff_ESI;
  uint *puVar4;
  uint local_28;
  int local_24;
  char local_20 [32];
  
  FUN_10016c00(unaff_ESI,"downmsglist");
  local_28 = 0;
  pbVar2 = (byte *)(param_1 + 0x4994);
  do {
    FUN_10016c00(unaff_ESI,&DAT_1004d970);
    FUN_10017110(unaff_ESI,"index",local_28);
    if (*pbVar2 != 0) {
      FUN_10016f90(unaff_ESI,&DAT_1004d964,pbVar2);
      pbVar1 = FUN_10017ca0(*(int **)(param_1 + 0x4908),pbVar2,0x656e5553);
      FUN_10016f90(unaff_ESI,&DAT_1004d95c,pbVar1);
      iVar3 = 0;
      puVar4 = (uint *)(param_1 + 0x914);
      local_24 = 8;
      do {
        if ((puVar4[-0x144] != 0) && (*puVar4 == local_28)) {
          _sprintf(local_20,"lobby%d",iVar3);
          FUN_10016f90(unaff_ESI,local_20,(byte *)(puVar4 + -0x1cc));
          iVar3 = iVar3 + 1;
        }
        puVar4 = puVar4 + 0x238;
        local_24 = local_24 + -1;
      } while (local_24 != 0);
    }
    FUN_10016d40(unaff_ESI);
    local_28 = local_28 + 1;
    pbVar2 = pbVar2 + 0x100;
  } while (local_28 < 8);
  FUN_10016d40(unaff_ESI);
  return;
}



void FUN_10006570(void)

{
  int in_EAX;
  int iVar1;
  byte *pbVar2;
  char *unaff_EDI;
  
  pbVar2 = (byte *)(in_EAX + 0x204);
  iVar1 = 8;
  do {
    if ((*(int *)(pbVar2 + 0x200) != 0) || (pbVar2[-0x20] != 0)) {
      FUN_10016c00(unaff_EDI,"lobby");
      FUN_10016f90(unaff_EDI,"ident",pbVar2 + -0x20);
      FUN_10016f90(unaff_EDI,"match",pbVar2);
      FUN_10016f90(unaff_EDI,"status",pbVar2 + 0x100);
      FUN_10016d40(unaff_EDI);
    }
    pbVar2 = pbVar2 + 0x8e0;
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  return;
}



undefined4 __cdecl FUN_100065e0(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  
  if ((param_2 == (byte *)0x0) || (bVar1 = *param_2, bVar1 == 0)) {
    return 0xffffffff;
  }
  bVar2 = *param_1;
  if (bVar2 == 0) {
    return 0;
  }
  iVar5 = (int)param_1 - (int)param_2;
  do {
    if (bVar2 == bVar1) {
      iVar4 = 0;
      pbVar3 = param_2;
      bVar2 = bVar1;
      do {
        if (('`' < (char)bVar2) && ((char)bVar2 < '{')) {
          bVar2 = bVar2 ^ 0x20;
        }
        if ((pbVar3[iVar5] != 0x3f) && (pbVar3[iVar5] != bVar2)) break;
        bVar2 = pbVar3[1];
        iVar4 = iVar4 + 1;
        pbVar3 = pbVar3 + 1;
      } while (bVar2 != 0);
      if (param_2[iVar4] == 0) {
        return 1;
      }
    }
    bVar2 = param_1[1];
    param_1 = param_1 + 1;
    iVar5 = iVar5 + 1;
    if (bVar2 == 0) {
      return 0;
    }
  } while( true );
}



void __cdecl FUN_100066d0(void *param_1)

{
  FUN_10017c60(*(undefined4 **)((int)param_1 + 0x4908));
  FUN_10006270();
  _free(param_1);
  return;
}



undefined4 __cdecl FUN_10007440(int param_1,int param_2,int *param_3)

{
  bool bVar1;
  byte *pbVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  char *pcVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  char *pcVar11;
  int iVar12;
  int iVar13;
  char *pcVar14;
  byte *pbVar15;
  byte local_20 [32];
  
  pbVar15 = &DAT_1004d26f;
  iVar12 = 0x20;
  pbVar3 = local_20;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"LOBBY");
  FUN_10002a30(pbVar2,pbVar3,iVar12,pbVar15);
  iVar12 = 0x26ac;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d240);
  iVar12 = FUN_10002480((char *)pbVar3,iVar12);
  uVar4 = *(uint *)(param_2 + 0x14);
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004db60);
  uVar4 = FUN_10002780(pbVar3,uVar4);
  iVar5 = FUN_100062b0(local_20);
  if (iVar5 == 0) {
    FUN_10016450(0x40000);
    return 0;
  }
  iVar13 = 0x20;
  pbVar3 = (byte *)(iVar5 + 0x8c0);
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"SECRET");
  pbVar3 = FUN_10002c10((char *)pbVar2,pbVar3,iVar13);
  *(bool *)(param_1 + 0x4904) = 0 < (int)pbVar3;
  FUN_10023510();
  uVar10 = *(undefined4 *)(param_1 + 0x10c);
  uVar9 = *(undefined4 *)(param_2 + 0xc);
  pcVar14 = (char *)0x0;
  pcVar11 = (char *)0x0;
  pcVar8 = (char *)0x0;
  uVar7 = 0;
  iVar13 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"LIMIT");
  iVar13 = FUN_10002480((char *)pbVar3,iVar13);
  iVar6 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"COUNT");
  iVar6 = FUN_10002480((char *)pbVar3,iVar6);
  bVar1 = FUN_10015fa0(*(int *)(iVar5 + 0x220),*param_3,uVar4,iVar12,iVar6,iVar13,uVar7,pcVar8,uVar9
                       ,uVar10,pcVar11,pcVar14);
  if (bVar1) {
    FUN_10016490(0x40000);
  }
  return 0;
}



void __cdecl FUN_10007740(int param_1,int param_2)

{
  uint uVar1;
  char cVar2;
  byte *pbVar3;
  undefined1 *puVar4;
  uint uVar5;
  uint *puVar6;
  char *pcVar7;
  byte *pbVar8;
  int iVar9;
  byte *pbVar10;
  byte local_28 [8];
  byte local_20 [32];
  
  pcVar7 = *(char **)(param_2 + 0x60);
  if (*(uint *)(param_2 + 0x14) != 0x7f000001) {
    cVar2 = FUN_100180c0((void *)(param_1 + 0x15c),*(uint *)(param_2 + 0x14));
    if (cVar2 == '\0') goto LAB_10007986;
  }
  pbVar10 = &DAT_1004d26f;
  iVar9 = 0x20;
  pbVar8 = local_20;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004de40);
  FUN_10002a30(pbVar3,pbVar8,iVar9,pbVar10);
  iVar9 = FUN_10005cd0(local_20,(byte *)"downmsgset");
  if (iVar9 == 0) {
    iVar9 = FUN_10006300();
    *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
    *(undefined4 *)(param_2 + 0x50) = 0x48545450;
    *(undefined4 *)(param_2 + 0x54) = 0x584d4c21;
    FUN_10016ae0(*(char **)(param_2 + 0x60),*(uint *)(param_2 + 0x5c),1);
    FUN_10016c00(*(char **)(param_2 + 0x60),"downmsgset");
    if (iVar9 != 0) {
      FUN_10017110(*(char **)(param_2 + 0x60),"errorcode",iVar9);
      _sprintf((char *)local_28,"%c%c%c%c",iVar9 >> 0x18,iVar9 >> 0x10,iVar9 >> 8,iVar9);
      FUN_10016f90(*(char **)(param_2 + 0x60),"error",local_28);
    }
    FUN_10016d40(*(char **)(param_2 + 0x60));
    FUN_10016bc0(*(char **)(param_2 + 0x60));
    return;
  }
  iVar9 = FUN_10005cd0(local_20,(byte *)"downmsglist");
  if (iVar9 == 0) {
    FUN_10016ae0(*(char **)(param_2 + 0x60),*(uint *)(param_2 + 0x5c),1);
    FUN_10006460(param_1);
    FUN_10016bc0(*(char **)(param_2 + 0x60));
  }
  else {
    iVar9 = FUN_10005cd0(local_20,(byte *)"downmsgclear");
    if (iVar9 == 0) {
      puVar4 = (undefined1 *)(param_1 + 0x918);
      iVar9 = 8;
      do {
        *(undefined4 *)(puVar4 + -4) = 0xffffffff;
        *puVar4 = 0;
        puVar4 = puVar4 + 0x8e0;
        iVar9 = iVar9 + -1;
      } while (iVar9 != 0);
      *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
      *(undefined4 *)(param_2 + 0x50) = 0x48545450;
      *(undefined4 *)(param_2 + 0x54) = 0x584d4c21;
      FUN_10016ae0(*(char **)(param_2 + 0x60),*(uint *)(param_2 + 0x5c),1);
      FUN_10016c00(*(char **)(param_2 + 0x60),"downmsg");
      FUN_10016d40(*(char **)(param_2 + 0x60));
      FUN_10016bc0(*(char **)(param_2 + 0x60));
      return;
    }
    iVar9 = FUN_10005cd0(local_20,(byte *)"lobbylist");
    if (iVar9 != 0) {
LAB_10007986:
      iVar9 = _sprintf(pcVar7,"Redirector info summary:\r\n");
      pcVar7 = pcVar7 + iVar9;
      uVar5 = 0;
      puVar6 = (uint *)(param_1 + 0x40c);
      do {
        if (puVar6[-2] != 0) {
          uVar1 = *puVar6;
          iVar9 = _sprintf(pcVar7,"Master #%d (%s): %d.%d.%d.%d\r\n",uVar5,puVar6 + -0x8a,
                           uVar1 >> 0x18,uVar1 >> 0x10 & 0xff,uVar1 >> 8 & 0xff,uVar1 & 0xff);
          pcVar7 = pcVar7 + iVar9;
          if ((char)puVar6[-0x42] != '\0') {
            iVar9 = _sprintf(pcVar7,"Master is down with message: %s\r\n",puVar6 + -0x42);
            pcVar7 = pcVar7 + iVar9;
          }
          pcVar7 = FUN_10016110(puVar6[-2],"Slave",*(int *)(param_1 + 0x10c),pcVar7);
        }
        uVar5 = uVar5 + 1;
        puVar6 = puVar6 + 0x238;
      } while (uVar5 < 8);
      _sprintf(pcVar7,"Report complete\r\n");
      *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
      *(undefined4 *)(param_2 + 0x50) = 0x48545450;
      *(undefined4 *)(param_2 + 0x54) = 0x48545450;
      return;
    }
    FUN_10016ae0(*(char **)(param_2 + 0x60),*(uint *)(param_2 + 0x5c),1);
    FUN_10016c00(*(char **)(param_2 + 0x60),"lobbylist");
    FUN_10006570();
    FUN_10016d40(*(char **)(param_2 + 0x60));
    FUN_10016bc0(*(char **)(param_2 + 0x60));
  }
  *(undefined4 *)(param_2 + 0x58) = 0;
  *(undefined4 *)(param_2 + 0x50) = 0x48545450;
  *(undefined4 *)(param_2 + 0x54) = 0x584d4c21;
  return;
}



undefined4 FUN_10007a60(void)

{
  int in_EAX;
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  char *pcVar4;
  bool bVar5;
  
  pcVar2 = *(char **)(in_EAX + 0x7c);
  pcVar1 = _strchr(pcVar2,0x2b);
  if (pcVar1 == (char *)0x0) {
    return 0xffffffff;
  }
  iVar3 = 4;
  bVar5 = true;
  *pcVar1 = '\0';
  pcVar4 = "RC4";
  do {
    if (iVar3 == 0) break;
    iVar3 = iVar3 + -1;
    bVar5 = *pcVar2 == *pcVar4;
    pcVar2 = pcVar2 + 1;
    pcVar4 = pcVar4 + 1;
  } while (bVar5);
  if (bVar5) {
    pcVar2 = _strchr(pcVar1 + 1,0x2d);
    if (pcVar2 != (char *)0x0) {
      iVar3 = 4;
      bVar5 = true;
      *pcVar2 = '\0';
      pcVar1 = pcVar1 + 1;
      pcVar4 = "MD5";
      do {
        if (iVar3 == 0) break;
        iVar3 = iVar3 + -1;
        bVar5 = *pcVar1 == *pcVar4;
        pcVar1 = pcVar1 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if ((bVar5) && (pcVar2[1] == 'V')) {
        if ((pcVar2[2] == '1') && (pcVar2[3] == '\0')) {
          return 0;
        }
        if ((pcVar2[2] == '2') && (pcVar2[3] == '\0')) {
          return 1;
        }
      }
    }
  }
  return 0xffffffff;
}



void __cdecl FUN_10007bf0(int *param_1,int param_2,int param_3)

{
  int iVar1;
  char cVar2;
  int *piVar3;
  
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x34) = 0;
  *(int **)(param_2 + 0x2c) = param_1;
  if (*(int *)(param_2 + 0x6c) == 0x40646972) {
    *(undefined1 **)(param_2 + 0x28) = &LAB_10006aa0;
  }
  else if (*(int *)(param_2 + 0x6c) == 0x40746963) {
    *(undefined1 **)(param_2 + 0x28) = &LAB_10007af0;
  }
  if ((*(uint *)(param_2 + 0x14) != 0x7f000001) &&
     (cVar2 = FUN_100180c0(param_1 + 0x57,*(uint *)(param_2 + 0x14)), cVar2 == '\0')) {
    return;
  }
  if (param_3 == 0) {
    piVar3 = FUN_10014240(*param_1,param_2,(int)param_1);
    if (piVar3 == (int *)0x0) {
      return;
    }
    iVar1 = param_1[0x42];
    param_1[0x42] = iVar1 + 1;
    *piVar3 = iVar1 + 1;
  }
  if (*(int *)(param_2 + 0x6c) != 0x40636e74) {
    if (*(int *)(param_2 + 0x6c) == 0x40616c76) {
      *(undefined1 **)(param_2 + 0x28) = &LAB_100075e0;
    }
    return;
  }
  *(code **)(param_2 + 0x28) = FUN_10007440;
  return;
}



void __cdecl FUN_10007ca0(int param_1,int param_2,int *param_3)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  
  piVar1 = param_3;
  if (*param_3 != 0) {
    piVar3 = (int *)(param_1 + 0x408);
    param_3 = (int *)0x8;
    do {
      if (piVar3[-1] != 0) {
        if ((*piVar1 == *piVar3) && (*(int *)(param_2 + 0x14) == piVar3[1])) {
          piVar3[1] = 0;
          *piVar3 = 0;
          FUN_10016490(0x40000);
        }
        iVar2 = FUN_10016200(piVar3[-1],*piVar1,*(int *)(param_2 + 0x14));
        if (-1 < iVar2) {
          FUN_10016250(piVar3[-1],iVar2);
          FUN_10016490(0x40000);
        }
      }
      piVar3 = piVar3 + 0x238;
      param_3 = (int *)((int)param_3 + -1);
    } while (param_3 != (int *)0x0);
  }
  return;
}



void __cdecl FUN_10007e90(int param_1)

{
  undefined1 *puVar1;
  byte *pbVar2;
  char *pcVar3;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  undefined4 local_fc8 [2];
  int local_fc0;
  byte local_fbc;
  byte local_fbb [63];
  char local_f7c [64];
  byte local_f3c [3900];
  
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x40;
  pbVar4 = &local_fbc;
  pbVar2 = FUN_100020f0((byte *)(param_1 + 0x2ccc18),&DAT_1004df18);
  FUN_10002a30(pbVar2,pbVar4,iVar5,pbVar6);
  pbVar4 = &local_fbc;
  if (local_fbc == 0x2f) {
    pbVar4 = local_fbb;
  }
  pcVar3 = _strchr((char *)pbVar4,0x2f);
  if (pcVar3 == (char *)0x0) {
    local_fc8[0] = 0x6f7363;
  }
  else {
    iVar5 = 0;
    if (0 < (int)pcVar3 - (int)pbVar4) {
      local_fc0 = (int)pbVar4 - (int)local_fc8;
      do {
        if (6 < iVar5) break;
        puVar1 = (undefined1 *)((int)local_fc8 + iVar5);
        iVar5 = iVar5 + 1;
        *puVar1 = puVar1[local_fc0];
      } while (iVar5 < (int)pcVar3 - (int)pbVar4);
    }
    *(undefined1 *)((int)local_fc8 + iVar5) = 0;
  }
  FUN_10005ca0(local_f7c,0x40,"%s/cross_product");
  FUN_10022c50(*(int *)(param_1 + 0x4364));
  iVar5 = FUN_10022c60(*(int *)(param_1 + 0x4364),(undefined4 *)0x0);
  while (iVar5 != 0) {
    if (*(char *)(iVar5 + 0x213f4) != '\0') {
      FUN_100225a0(iVar5,local_f3c,0xf3c);
      FUN_10003e20(local_f3c,0xf3c,(byte *)"~GAME=%d DP=%s SKEY=%s SUBKEY=%s");
      FUN_10003cf0(local_f3c,0xf3c,&DAT_1004ded4,pbVar4);
      FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a727074,0,(char *)local_f3c,
                   (char *)0xffffffff);
    }
    iVar5 = FUN_10022c60(*(int *)(param_1 + 0x4364),(undefined4 *)0x0);
  }
  return;
}



void __cdecl FUN_10008010(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  void *this;
  code *pcVar3;
  undefined4 uVar4;
  byte local_100 [256];
  
  if (*(char *)(param_3 + 0x404c) != '\0') {
    uVar1 = FUN_100141d0(*(int *)(param_3 + 0x4020),0x63757272);
    uVar2 = FUN_100141d0(*(int *)(param_3 + 0x4020),0x6d61786d);
    if ((int)uVar2 < 0xfb) {
      uVar2 = 0;
    }
    else {
      uVar2 = uVar2 - 0x32;
    }
    local_100[0] = 0;
    FUN_10003cf0(local_100,0x100,(byte *)"LOBBY",(byte *)(param_3 + 0x4000));
    FUN_10002370(local_100,0x100,&DAT_1004d240,*(uint *)(param_3 + 0x4040));
    if (*(char *)(param_3 + 0x2ccce4) != '\0') {
      FUN_10002b70(local_100,0x100,(byte *)"SECRET",(byte *)(param_3 + 0x2cccc4),0x20);
    }
    if (*(int *)(param_3 + 0x2cc52c) == 0) {
      FUN_10002370(local_100,0x100,(byte *)"COUNT",uVar1);
    }
    else {
      FUN_10002370(local_100,0x100,(byte *)"COUNT",uVar1 + 1);
      uVar2 = 1;
    }
    FUN_10002370(local_100,0x100,(byte *)"LIMIT",uVar2);
    FUN_10022490(*(undefined4 **)(param_3 + 0x4044),0x40636e74,0,(char *)local_100,
                 (char *)0xffffffff);
  }
  FUN_100234a0(*(int *)(param_3 + 0x2cc694),*(int *)(param_3 + 0x403c),30000);
  uVar4 = 0;
  pcVar3 = FUN_10008010;
  uVar1 = 10000;
  this = (void *)FUN_10022980(*(undefined4 **)(param_3 + 0x4020));
  FUN_100230b0(this,uVar1,pcVar3,uVar4,param_3);
  return;
}



void __cdecl FUN_100081a0(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  undefined4 local_8;
  undefined4 local_4;
  
  iVar1 = param_2;
  iVar2 = FUN_10022340(*(int *)(param_2 + 0x4044),&local_4,&local_8,&param_2);
  while (-1 < iVar2) {
    FUN_100223d0(*(int *)(iVar1 + 0x4044),(undefined4 *)0x0,(undefined4 *)0x0,(undefined4 *)0x0,0);
    iVar2 = FUN_10022340(*(int *)(iVar1 + 0x4044),&local_4,&local_8,&param_2);
  }
  return;
}



char __cdecl FUN_10008210(int param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  int iVar5;
  int iVar6;
  
  piVar2 = (int *)(param_1 + 0x3800);
  iVar6 = -1;
  iVar5 = -1;
  cVar4 = '\0';
  iVar3 = 0;
  if (*(int *)(param_1 + 0x3800) != 0) {
    do {
      if (cVar4 != '\0') goto LAB_10008292;
      if (*piVar2 == *(int *)(param_2 + 0x6c)) {
        cVar4 = '\x01';
        iVar6 = iVar3;
      }
      piVar1 = piVar2 + 2;
      piVar2 = piVar2 + 2;
      iVar3 = iVar3 + 1;
    } while (*piVar1 != 0);
    if (cVar4 != '\0') goto LAB_10008292;
  }
  piVar2 = (int *)FUN_10023500();
  if (piVar2 == (int *)0x0) {
    return cVar4;
  }
  iVar3 = 0;
  if (*piVar2 == 0) {
    return cVar4;
  }
  do {
    if (cVar4 != '\0') goto LAB_10008292;
    if (*piVar2 == *(int *)(param_2 + 0x6c)) {
      cVar4 = '\x01';
      iVar5 = iVar3;
    }
    piVar1 = piVar2 + 3;
    piVar2 = piVar2 + 3;
    iVar3 = iVar3 + 1;
  } while (*piVar1 != 0);
  if (cVar4 == '\0') {
    return '\0';
  }
LAB_10008292:
  if (*(int *)(param_3 + 0xa38) == 0) {
    if (*(int *)(param_3 + 0xa34) == 0) {
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
      return cVar4;
    }
  }
  else if (*(int *)(param_3 + 0xa34) == 0) {
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x70617574;
    return cVar4;
  }
  if (iVar6 == -1) {
    *(code **)(param_2 + 0x28) = FUN_1001d8a0;
    *(undefined4 *)(param_2 + 0x34) = 0xf;
    *(int *)(param_3 + 0xabc) = iVar5;
  }
  else {
    *(code **)(param_2 + 0x28) = FUN_1001d3d0;
    *(undefined4 *)(param_2 + 0x34) = 0x1e;
    *(int *)(param_3 + 0xabc) = iVar6;
  }
  if (*(int *)(param_1 + 0x2cc55c) != 0) {
    *(int *)(param_3 + 0xab8) = *(int *)(param_1 + 0x403c) + *(int *)(param_1 + 0x2cc55c);
  }
  return cVar4;
}



void __cdecl FUN_10008330(int param_1)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  int iVar5;
  byte *local_4;
  
  FUN_10022c50(*(int *)(param_1 + 0x4364));
  iVar2 = FUN_10022c60(*(int *)(param_1 + 0x4364),&local_4);
  do {
    if (iVar2 == 0) {
      return;
    }
    pbVar4 = (byte *)(iVar2 + 4);
    pbVar3 = local_4;
    do {
      if (((*pbVar3 != *pbVar4) || (*pbVar3 == 0)) || (pbVar1 = pbVar3 + 1, *pbVar1 != pbVar4[1]))
      break;
      pbVar3 = pbVar3 + 2;
      pbVar4 = pbVar4 + 2;
    } while (*pbVar1 != 0);
    FUN_10016490(0x400000);
    iVar5 = 0;
    if (*(int *)(iVar2 + 0x4070) != 0) {
      do {
        FUN_10016490(0x400000);
        iVar5 = iVar5 + 1;
      } while (iVar5 != *(int *)(iVar2 + 0x4070));
    }
    iVar2 = FUN_10022c60(*(int *)(param_1 + 0x4364),&local_4);
  } while( true );
}



undefined4 __cdecl FUN_10008430(int param_1)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *unaff_EBX;
  undefined4 *puVar4;
  int iVar5;
  byte *pbVar6;
  uint uVar7;
  byte local_110 [48];
  byte local_e0 [96];
  byte local_80 [128];
  
  if ((*(int *)(param_1 + 0x10) != 1) && (*(int *)(param_1 + 0x10) != 2)) {
    FUN_10016450(0x400000);
    return 0;
  }
  iVar1 = *(int *)(param_1 + 0xc);
  if (*(int *)(iVar1 + 0x4070) == 0x400) {
    FUN_10016450(0x400000);
    return 0;
  }
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x30;
  pbVar3 = local_110;
  puVar4 = (undefined4 *)((*(int *)(iVar1 + 0x4070) + 7) * 0x10 + iVar1);
  pbVar2 = FUN_100020f0(unaff_EBX,&DAT_1004d8c8);
  FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar6);
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x60;
  pbVar3 = local_e0;
  pbVar2 = FUN_100020f0(unaff_EBX,&DAT_1004df70);
  FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar6);
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x80;
  pbVar3 = local_80;
  pbVar2 = FUN_100020f0(unaff_EBX,(byte *)"PARAMS");
  FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar6);
  pbVar3 = FUN_10023710(*(void **)(iVar1 + 0x214f8),local_110);
  *puVar4 = pbVar3;
  pbVar3 = FUN_10023710(*(void **)(iVar1 + 0x214f8),local_e0);
  puVar4[1] = pbVar3;
  pbVar3 = FUN_10023710(*(void **)(iVar1 + 0x214f8),local_80);
  uVar7 = 0;
  puVar4[2] = pbVar3;
  pbVar3 = FUN_100020f0(unaff_EBX,&DAT_1004df60);
  uVar7 = FUN_10002930(pbVar3,uVar7);
  puVar4[3] = uVar7;
  *(int *)(iVar1 + 0x4070) = *(int *)(iVar1 + 0x4070) + 1;
  *(undefined4 *)(param_1 + 0x10) = 2;
  return 1;
}



undefined4 __cdecl FUN_100085a0(byte *param_1)

{
  int *piVar1;
  undefined4 uVar2;
  void *this;
  int *piVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  int iVar7;
  void *this_00;
  int *unaff_EBX;
  byte *pbVar8;
  int iVar9;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_1004ce4b;
  local_c = ExceptionList;
  if ((unaff_EBX[4] != 0) && (unaff_EBX[4] != 2)) {
    ExceptionList = &local_c;
    FUN_10016450(0x400000);
    ExceptionList = local_c;
    return 0;
  }
  ExceptionList = &local_c;
  piVar1 = (int *)_malloc(0x214fc);
  uVar2 = 0;
  if (piVar1 != (int *)0x0) {
    piVar3 = piVar1;
    for (iVar7 = 0x853f; iVar7 != 0; iVar7 = iVar7 + -1) {
      *piVar3 = 0;
      piVar3 = piVar3 + 1;
    }
    this = operator_new(0x10);
    local_4 = 0;
    if (this == (void *)0x0) {
      piVar3 = (int *)0x0;
    }
    else {
      piVar3 = FUN_100236d0(this,0x400,0x80);
    }
    pbVar8 = &DAT_1004d26f;
    iVar7 = 0xc;
    pbVar6 = (byte *)(piVar1 + 1);
    local_4 = 0xffffffff;
    piVar1[0x853e] = (int)piVar3;
    pbVar5 = pbVar6;
    pbVar4 = FUN_100020f0(param_1,&DAT_1004e040);
    FUN_10002a30(pbVar4,pbVar5,iVar7,pbVar8);
    piVar1[0x101c] = 0;
    iVar7 = FUN_10022a40(this_00,*(int *)(*unaff_EBX + 0x4364),pbVar6);
    if (iVar7 != 0) {
      FUN_10016450(0x400000);
      ExceptionList = local_c;
      return 0;
    }
    iVar7 = FUN_100229d0(*(void **)(*unaff_EBX + 0x4364),(int *)*(void **)(*unaff_EBX + 0x4364),
                         pbVar6,(int)piVar1);
    if (iVar7 < 0) {
      FUN_10016450(0x400000);
      ExceptionList = local_c;
      return 0;
    }
    pbVar4 = &DAT_1004d26f;
    pbVar6 = (byte *)(piVar1 + 0x101d);
    iVar7 = 0x10;
    *pbVar6 = 0;
    pbVar5 = FUN_100020f0(param_1,&DAT_1004dff4);
    FUN_10002a30(pbVar5,pbVar6,iVar7,pbVar4);
    pbVar8 = &DAT_1004d26f;
    iVar7 = 0x200;
    pbVar6 = (byte *)(piVar1 + 0x1021);
    pbVar5 = pbVar6;
    pbVar4 = FUN_100020f0(param_1,(byte *)"EXTRACT");
    FUN_10002a30(pbVar4,pbVar5,iVar7,pbVar8);
    if (*pbVar6 != 0) {
      FUN_10023b40(piVar1 + 0x10a9,(char *)pbVar6,&LAB_10007e50,*unaff_EBX);
    }
    pbVar4 = &DAT_1004d26f;
    iVar7 = 0x60;
    pbVar6 = (byte *)(piVar1 + 4);
    pbVar5 = FUN_100020f0(param_1,&DAT_1004df70);
    FUN_10002a30(pbVar5,pbVar6,iVar7,pbVar4);
    pbVar4 = &DAT_1004d26f;
    iVar7 = 0x20;
    pbVar6 = (byte *)(piVar1 + 0x10a1);
    pbVar5 = FUN_100020f0(param_1,(byte *)"STYLE");
    FUN_10002a30(pbVar5,pbVar6,iVar7,pbVar4);
    iVar7 = 0;
    pbVar6 = FUN_100020f0(param_1,(byte *)"EXTERNAL");
    iVar7 = FUN_10002480((char *)pbVar6,iVar7);
    iVar9 = 0;
    *(bool *)(piVar1 + 0x84fd) = iVar7 != 0;
    pbVar6 = FUN_100020f0(param_1,(byte *)"EXPORT");
    iVar7 = FUN_10002480((char *)pbVar6,iVar9);
    *(bool *)((int)piVar1 + 0x213f5) = iVar7 != 0;
    uVar2 = 1;
    if (iVar7 != 0) {
      *(undefined1 *)(piVar1 + 0x84fd) = 1;
    }
    if ((char)piVar1[0x84fd] == '\0') {
      *piVar1 = unaff_EBX[5];
      unaff_EBX[5] = unaff_EBX[5] + 1;
    }
    else {
      *piVar1 = -1;
    }
    unaff_EBX[3] = (int)piVar1;
    unaff_EBX[4] = 1;
  }
  ExceptionList = local_c;
  return uVar2;
}



undefined4 __cdecl FUN_10008850(int param_1)

{
  byte *in_EAX;
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  char *pcVar4;
  bool bVar5;
  char local_64 [100];
  
  if (*in_EAX != 0x23) {
    iVar1 = FUN_10003810((char *)in_EAX,local_64,100);
    if (iVar1 != 0) {
      iVar1 = 5;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "NAME";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_10008430(param_1);
        return uVar2;
      }
      iVar1 = 5;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "VIEW";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_100085a0(in_EAX);
        return uVar2;
      }
      FUN_10016450(0x400000);
      return 0;
    }
  }
  return 1;
}



int __cdecl FUN_10008900(int param_1)

{
  FILE *_File;
  char *pcVar1;
  int iVar2;
  char *unaff_EDI;
  int local_418;
  char local_400 [1024];
  
  iVar2 = 0;
  FUN_10016490(0x400000);
  _File = (FILE *)FUN_100409a9(unaff_EDI,"r");
  if (_File == (FILE *)0x0) {
    FUN_10016450(0x400000);
    return 0;
  }
  local_418 = param_1;
  pcVar1 = _fgets(local_400,0x400,_File);
  if (pcVar1 == (char *)0x0) {
LAB_100089d8:
    FUN_10016450(0x400000);
  }
  else {
    do {
      iVar2 = FUN_10008850((int)&local_418);
      if (iVar2 == 0) goto LAB_100089d8;
      pcVar1 = _fgets(local_400,0x400,_File);
    } while (pcVar1 != (char *)0x0);
    FUN_10016490(0x400000);
    FUN_10008330(param_1);
  }
  _fclose(_File);
  return iVar2;
}



uint __cdecl FUN_10008a00(int param_1,int param_2,int *param_3)

{
  byte *pbVar1;
  uint uVar2;
  int iVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  int iVar4;
  uint local_508;
  byte local_504 [256];
  byte local_404 [1028];
  
  local_508 = *(uint *)(param_1 + 0x2cc384);
  iVar3 = param_3[0xe];
  do {
    if ((iVar3 == 0) || (uVar2 = param_3[0xe], *(uint *)(param_1 + 0x4368) <= uVar2)) {
      return CONCAT31((int3)((uint)iVar3 >> 8),1);
    }
    iVar4 = (uVar2 % *(uint *)(param_1 + 0x436c)) * 0x478;
    iVar3 = iVar4 + 0x4370 + param_1;
    if ((*(uint *)(iVar4 + 0x4370 + param_1) == uVar2) &&
       (((((iVar4 = *(int *)(iVar3 + 0x460), iVar4 < 0 ||
           ((*(int *)(iVar3 + 0x45c) != 0 && (*(int *)(iVar3 + 0x45c) == param_3[0x28d])))) ||
          ((0 < iVar4 &&
           ((iVar4 == *(int *)(local_508 + 0x30) || ((0 < iVar4 && (iVar4 == *param_3)))))))) ||
         ((*(int *)(iVar3 + 0x464) != 0 &&
          (uVar2 = FUN_10025c90(local_508,*(int *)(iVar3 + 0x464)), (char)uVar2 != '\0')))) ||
        ((*(int *)(iVar3 + 0x468) != 0 && (*(int *)(local_508 + 0x34) == *(int *)(iVar3 + 0x468)))))
       )) {
      uVar2 = *(uint *)(iVar3 + 0x458);
      if (*(int *)(iVar3 + 0x45c) == 0) {
        if (*(int *)(iVar3 + 0x464) == 0) {
          if (*(int *)(iVar3 + 0x468) == 0) {
            if (*(int *)(iVar3 + 0x460) < 0) {
              uVar2 = uVar2 | 4;
            }
            else {
              uVar2 = uVar2 | 0x4000000;
            }
          }
          else {
            uVar2 = uVar2 | 0x80;
          }
        }
        else {
          uVar2 = uVar2 | 0x2000000;
        }
      }
      else {
        uVar2 = uVar2 | 0x10000;
      }
      pbVar1 = (byte *)(iVar3 + 4);
      iVar4 = FUN_10025580((char *)pbVar1,(char *)(local_508 + 0x20));
      if (iVar4 == 0) {
        uVar2 = uVar2 | 0x200000;
      }
      if ((param_3[0xf] & uVar2) != 0) {
        if (((char)param_3[0x14] != '\0') && ((*(uint *)(local_508 + 8) & 0x4000) == 0)) {
          FUN_10005d70((char *)local_404,(char *)(iVar3 + 0x14),0x404);
          FUN_100254c0(*(undefined4 *)(param_1 + 0x2cc37c),local_404);
          FUN_10025120(*(int **)(param_1 + 0x2cc37c),local_404);
        }
        FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"F=%f T=%s U=%s"
                    );
        iVar4 = *(int *)(iVar3 + 0x460);
        if (((iVar4 == 0) || (iVar4 == *(int *)(local_508 + 0x30))) || (iVar4 != *param_3)) {
          FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e168,pbVar1);
          this = extraout_ECX_00;
        }
        else {
          _sprintf((char *)local_504,"(mon) %s",pbVar1);
          FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e168,local_504);
          this = extraout_ECX;
        }
        if (((uVar2 & 0x40000) == 0) || (*(int *)(iVar3 + 0x45c) < 1)) {
LAB_10008d53:
          *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
          *(undefined4 *)(param_2 + 0x50) = 0x2b6d7367;
          param_3[0xe] = param_3[0xe] + 1;
          return (uint)param_3 & 0xffffff00;
        }
        iVar3 = FUN_10022a40(this,*(int *)(param_1 + 0x40f8),pbVar1);
        if (iVar3 != 0) {
          FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                       (byte *)"~M=%s A=%a P=%d S=%s");
          if ((*(uint *)(iVar3 + 0x218) & 0x2000) != 0) {
            FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e14c,
                         (byte *)(iVar3 + 0x194));
          }
          if ('/' < (char)*(byte *)(iVar3 + 0xd0)) {
            FUN_10002fe0((byte *)(iVar3 + 0xd0),&local_508,-1,&DAT_1004e148);
            iVar3 = FUN_100210a0(*(int *)(param_1 + 0x4120),local_508);
            local_508 = iVar3 + 1;
            if (0 < (int)local_508) {
              FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e144,
                           local_508);
            }
          }
          goto LAB_10008d53;
        }
      }
    }
    iVar3 = param_3[0xe] + 1;
    param_3[0xe] = iVar3;
  } while( true );
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

uint __cdecl FUN_10008d80(int param_1,int param_2,int param_3)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  byte *_Dest;
  byte *_Dest_00;
  undefined4 *local_1008;
  undefined4 *local_1004;
  byte local_1000 [1984];
  byte local_840 [64];
  byte local_800 [2044];
  undefined4 uStack_4;
  
  uStack_4 = 0x10008d8a;
  piVar1 = (int *)(param_3 + 0x28);
  puVar2 = (undefined4 *)param_3;
  if ((0 < *(int *)(param_3 + 0x28)) &&
     ((puVar2 = *(undefined4 **)(param_3 + 0x2c), puVar2 == (undefined4 *)0x0 ||
      (*(undefined4 **)(param_1 + 0x403c) != puVar2 &&
       -1 < (int)*(undefined4 **)(param_1 + 0x403c) - (int)puVar2)))) {
    puVar2 = *(undefined4 **)(param_1 + 0x2cc568);
    _Dest = local_1000;
    _Dest_00 = local_800;
    local_1004 = puVar2;
    if (0 < (int)puVar2) {
      while (puVar2 = (undefined4 *)FUN_100262e0(*(int *)(param_1 + 0x40f0),piVar1,&local_1008),
            puVar2 != (undefined4 *)0x0) {
        *piVar1 = *piVar1 + 1;
        puVar2 = local_1008;
        if (local_1008 != (undefined4 *)0x0) {
          if (_Dest != local_1000) {
            *_Dest = 0x2c;
            _Dest = _Dest + 1;
          }
          iVar3 = _sprintf((char *)_Dest,"%d/%d",*local_1008,local_1008[0x43]);
          _Dest = _Dest + iVar3;
          if (_Dest_00 != local_800) {
            *_Dest_00 = 0x2c;
            _Dest_00 = _Dest_00 + 1;
          }
          puVar2 = (undefined4 *)_sprintf((char *)_Dest_00,"%d",local_1008[0x44]);
          _Dest_00 = _Dest_00 + (int)puVar2;
        }
        if ((local_840 < _Dest) ||
           (puVar2 = (undefined4 *)((int)local_1004 + -1), local_1004 = puVar2, (int)puVar2 < 1))
        break;
      }
      if (_Dest != local_1000) {
        **(undefined1 **)(param_2 + 0x60) = 0;
        FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e18c,local_1000);
        FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e188,local_800);
        *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
        *(undefined4 *)(param_2 + 0x50) = 0x2b706f70;
        if ((*(int *)(param_1 + 0x2cc384) == 0) ||
           (*(int *)(*(int *)(param_1 + 0x2cc384) + 0x30) == 0)) {
          iVar3 = *(int *)(param_1 + 0x2cc560);
        }
        else {
          iVar3 = *(int *)(param_1 + 0x2cc564);
        }
        *(int *)(param_3 + 0x2c) = iVar3 + *(int *)(param_1 + 0x403c);
        return param_3 & 0xffffff00;
      }
    }
  }
  return CONCAT31((int3)((uint)puVar2 >> 8),1);
}



undefined4 __cdecl FUN_10008f40(int param_1,int param_2,int param_3)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  uint uVar6;
  int *piVar7;
  int local_c;
  int local_8;
  int *local_4;
  
  piVar1 = *(int **)(param_1 + 0x2cc384);
  piVar5 = (int *)(param_3 + 0x84);
  local_4 = piVar1;
  if ((0 < *(int *)(param_3 + 0x84)) &&
     (iVar2 = FUN_100262e0(*(int *)(param_1 + 0x4118),piVar5,&local_c), iVar2 != 0)) {
    do {
      iVar3 = 0;
      piVar4 = (int *)(param_3 + 0x54);
      piVar7 = piVar1 + 199;
      do {
        if ((iVar2 == *piVar4) || (iVar2 == *piVar7)) {
          if (local_c == 0) {
            if (*piVar5 < *(int *)(param_3 + 0x88)) {
              *piVar5 = *piVar5 + 1;
              goto LAB_10008fb4;
            }
            uVar6 = FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                                 &DAT_1004e1b0);
          }
          else {
            uVar6 = FUN_10025aa0(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),local_c);
          }
          *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
          *(undefined4 *)(param_2 + 0x50) = 0x2b757374;
          *piVar5 = *piVar5 + 1;
          return uVar6 & 0xffffff00;
        }
        iVar3 = iVar3 + 1;
        piVar4 = piVar4 + 1;
        piVar7 = piVar7 + 1;
      } while (iVar3 < 4);
      *piVar5 = *piVar5 + 1;
LAB_10008fb4:
      iVar2 = FUN_100262e0(*(int *)(param_1 + 0x4118),piVar5,&local_c);
    } while (iVar2 != 0);
  }
  uVar6 = 0;
  piVar5 = (int *)(param_3 + 0x54);
  do {
    iVar2 = *piVar5;
    if (iVar2 != 0) {
      local_c = FUN_10026280(*(int *)(param_1 + 0x4118),iVar2);
      if (local_c == 0) {
        *piVar5 = 0;
        piVar5[4] = 0;
        iVar2 = 0;
      }
      else {
        piVar1 = piVar5 + 4;
        iVar2 = FUN_100262e0(*(int *)(local_c + 0xe8),piVar1,&local_8);
        if (iVar2 != 0) {
          do {
            if (local_8 != 0) {
              FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                           (byte *)"I=%d N=%s F=%f G=%d");
              if ((*(uint *)(local_8 + 0x218) & 0x80000) != 0) {
                FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e14c,
                             (byte *)(local_8 + 0x194));
              }
LAB_10009185:
              FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e198,uVar6);
              *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
              *(undefined4 *)(param_2 + 0x50) = 0x2b75736d;
              *(int *)(param_3 + 100 + uVar6 * 4) = *(int *)(param_3 + 100 + uVar6 * 4) + 1;
              return param_3 & 0xffffff00;
            }
            if (piVar5[8] <= *piVar1) {
              FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),&DAT_1004e1b0);
              if (iVar2 == *local_4) {
                *(undefined4 *)(param_3 + 0x54 + uVar6 * 4) = 0;
              }
              goto LAB_10009185;
            }
            *piVar1 = *piVar1 + 1;
            iVar2 = FUN_100262e0(*(int *)(local_c + 0xe8),piVar1,&local_8);
          } while (iVar2 != 0);
          iVar2 = 0;
        }
      }
    }
    uVar6 = uVar6 + 1;
    piVar5 = piVar5 + 1;
    if (3 < (int)uVar6) {
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
  } while( true );
}



uint __cdecl FUN_100091c0(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int unaff_EBX;
  int *piVar5;
  int unaff_EDI;
  int local_4;
  
  iVar1 = *(int *)(unaff_EDI + 0x2cc384);
  iVar2 = *(int *)(unaff_EDI + 0x2cc388);
  iVar3 = iVar1;
  if (iVar2 != 0) {
    iVar3 = *(int *)(param_1 + 0x30);
    piVar5 = (int *)(param_1 + 0x30);
    if (0 < iVar3) {
      while( true ) {
        iVar3 = FUN_100262e0(*(int *)(iVar2 + 0x11c),piVar5,&local_4);
        if (iVar3 == 0) break;
        iVar3 = *piVar5;
        *piVar5 = iVar3 + 1;
        if (local_4 == 0) {
          if (*(int *)(param_1 + 0x34) <= iVar3 + 1) {
            uVar4 = FUN_10003e20(*(byte **)(unaff_EBX + 0x60),*(size_t *)(unaff_EBX + 0x5c),
                                 (byte *)"IDENT=%d");
LAB_1000929c:
            *(undefined4 *)(unaff_EBX + 0x58) = 0xffffffff;
            *(undefined4 *)(unaff_EBX + 0x50) = 0x2b61676d;
            return uVar4 & 0xffffff00;
          }
        }
        else if (((*(int *)(iVar1 + 0x30) != 0) &&
                 (*(int *)(iVar1 + 0x30) == *(int *)(local_4 + 0x8c))) &&
                ((*(uint *)(local_4 + 4) & 0x20008) == 0)) {
          uVar4 = FUN_100265c0(*(void **)(unaff_EDI + 0x40f8),*(undefined4 *)(unaff_EDI + 0x40ec),
                               local_4,iVar1,*(byte **)(unaff_EBX + 0x60),
                               *(size_t *)(unaff_EBX + 0x5c),FUN_10015a20,
                               *(undefined4 *)(unaff_EDI + 0x2ccc9c),'\0','\0','\0',
                               *(char *)(unaff_EDI + 0x2cd5b0));
          goto LAB_1000929c;
        }
      }
    }
  }
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}



undefined4 __cdecl FUN_100092c0(int param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  int unaff_ESI;
  int unaff_EDI;
  int local_4;
  
  iVar1 = *(int *)(unaff_ESI + 0x2cc384);
  if ((*(int *)(iVar1 + 0x34) != 0) || (iVar2 = param_1, *(int *)(param_1 + 0x4c) != 0)) {
    iVar2 = *(int *)(param_1 + 0x48);
    piVar4 = (int *)(param_1 + 0x48);
    if (0 < iVar2) {
      iVar2 = FUN_100262e0(*(int *)(unaff_ESI + 0x4104),piVar4,&local_4);
      while (iVar2 != 0) {
        *piVar4 = *piVar4 + 1;
        if ((iVar2 == *(int *)(iVar1 + 0x34)) || (iVar2 == *(int *)(param_1 + 0x4c))) {
          if (local_4 == 0) {
            uVar3 = FUN_10003e20(*(byte **)(unaff_EDI + 0x60),*(size_t *)(unaff_EDI + 0x5c),
                                 (byte *)"IDENT=%d");
            *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
            *(undefined4 *)(unaff_EDI + 0x50) = 0x2b6d676d;
            *(undefined4 *)(param_1 + 0x4c) = 0;
            return uVar3 & 0xffffff00;
          }
          FUN_100265c0(*(void **)(unaff_ESI + 0x40f8),*(undefined4 *)(unaff_ESI + 0x40ec),local_4,
                       iVar1,*(byte **)(unaff_EDI + 0x60),*(size_t *)(unaff_EDI + 0x5c),FUN_10015a20
                       ,*(undefined4 *)(unaff_ESI + 0x2ccc9c),'\0','\x01','\x01',
                       *(char *)(unaff_ESI + 0x2cd5b0));
          *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
          *(undefined4 *)(unaff_EDI + 0x50) = 0x2b6d676d;
          uVar3 = *(uint *)(iVar1 + 0x34);
          *(uint *)(param_1 + 0x4c) = uVar3;
          return uVar3 & 0xffffff00;
        }
        iVar2 = FUN_100262e0(*(int *)(unaff_ESI + 0x4104),piVar4,&local_4);
      }
    }
  }
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



undefined4 __cdecl FUN_100093d0(int param_1)

{
  int *piVar1;
  int iVar2;
  int in_EAX;
  int iVar3;
  uint uVar4;
  int unaff_EBX;
  byte *pbVar5;
  size_t sVar6;
  int local_8;
  int local_4;
  
  local_4 = *(int *)(unaff_EBX + 0x2cc384);
  piVar1 = (int *)(in_EAX + 0xc54);
  if (*piVar1 != 0) {
    iVar3 = FUN_100262e0(*(int *)(unaff_EBX + 0x4104),piVar1,&local_8);
    iVar2 = local_4;
    while (local_4 = iVar3, local_4 != 0) {
      *piVar1 = *piVar1 + 1;
      iVar3 = local_4;
      local_4 = iVar2;
      iVar3 = FUN_10026c80(in_EAX + 0xac0,iVar3);
      iVar2 = local_4;
      if (iVar3 != -1) {
        if (local_8 == 0) {
          if (*piVar1 < *(int *)(in_EAX + 0xc58)) goto LAB_1000943d;
          sVar6 = *(size_t *)(param_1 + 0x5c);
          pbVar5 = *(byte **)(param_1 + 0x60);
        }
        else {
          iVar3 = FUN_10020410(unaff_EBX,local_8,*(uint *)(in_EAX + 0xc5c),*(uint *)(in_EAX + 0xc60)
                               ,*(uint *)(in_EAX + 0xc64),*(uint *)(in_EAX + 0xc68),
                               *(int *)(in_EAX + 0xc6c),*(int *)(in_EAX + 0xc70),
                               *(int *)(in_EAX + 0xc74),(char *)(in_EAX + 0xc78),local_4);
          if (iVar3 == 0) {
            uVar4 = FUN_100265c0(*(void **)(unaff_EBX + 0x40f8),*(undefined4 *)(unaff_EBX + 0x40ec),
                                 local_8,iVar2,*(byte **)(param_1 + 0x60),
                                 *(size_t *)(param_1 + 0x5c),FUN_10015a20,
                                 *(undefined4 *)(unaff_EBX + 0x2ccc9c),'\0','\0','\0',
                                 *(char *)(unaff_EBX + 0x2cd5b0));
            goto LAB_10009521;
          }
          sVar6 = *(size_t *)(param_1 + 0x5c);
          pbVar5 = *(byte **)(param_1 + 0x60);
        }
        uVar4 = FUN_10003e20(pbVar5,sVar6,(byte *)"IDENT=%d");
LAB_10009521:
        *(undefined4 *)(param_1 + 0x58) = 0xffffffff;
        *(undefined4 *)(param_1 + 0x50) = 0x2b67616d;
        return uVar4 & 0xffffff00;
      }
LAB_1000943d:
      iVar3 = FUN_100262e0(*(int *)(unaff_EBX + 0x4104),piVar1,&local_8);
      iVar2 = local_4;
    }
  }
  return CONCAT31((int3)((uint)local_4 >> 8),1);
}



uint __cdecl FUN_10009540(int param_1,int param_2)

{
  int iVar1;
  uint *puVar2;
  uint uVar3;
  int unaff_ESI;
  
  iVar1 = *(int *)(unaff_ESI + 0x2cc384);
  puVar2 = *(uint **)(iVar1 + 0x34);
  if ((puVar2 != (uint *)0x0) && (*(uint **)(param_2 + 0x14) != puVar2)) {
    puVar2 = (uint *)FUN_10026280(*(int *)(unaff_ESI + 0x4104),(int)puVar2);
    if ((puVar2 != (uint *)0x0) && ((puVar2[1] & 0x80000) != 0)) {
      *(undefined4 *)(param_2 + 0x14) = *(undefined4 *)(iVar1 + 0x34);
      FUN_10026d60(*(void **)(unaff_ESI + 0x40f8),*(undefined4 *)(unaff_ESI + 0x40ec),
                   *(byte **)(param_1 + 0x60),*(size_t *)(param_1 + 0x5c),puVar2,iVar1,FUN_10015a20,
                   *(undefined4 *)(unaff_ESI + 0x2ccc9c),*(char *)(unaff_ESI + 0x2cd5b0));
      uVar3 = CONCAT31((int3)(puVar2[1] >> 8),*(undefined1 *)(param_2 + 0xa10));
      if ((puVar2[1] & 0x40000) == 0) {
        uVar3 = uVar3 | 1;
      }
      else {
        uVar3 = uVar3 | 2;
      }
      *(char *)(param_2 + 0xa10) = (char)uVar3;
      if ((puVar2[1] & 0x20000) != 0) {
        *(byte *)(param_2 + 0xa10) = *(byte *)(param_2 + 0xa10) | 4;
      }
      *(undefined4 *)(param_1 + 0x58) = 0xffffffff;
      *(undefined4 *)(param_1 + 0x50) = 0x2b736573;
      return uVar3 & 0xffffff00;
    }
  }
  return CONCAT31((int3)((uint)puVar2 >> 8),1);
}



uint __cdecl FUN_10009610(int param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int unaff_EBX;
  int unaff_EDI;
  bool bVar4;
  
  iVar2 = *(int *)(unaff_EDI + 0x40);
  do {
    if ((iVar2 == 0) ||
       (uVar1 = *(uint *)(unaff_EDI + 0x40), *(uint *)(unaff_EBX + 0x240370) <= uVar1)) {
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
    iVar3 = (uVar1 % *(uint *)(unaff_EBX + 0x240374)) * 0x118;
    iVar2 = iVar3 + 0x240378 + unaff_EBX;
    if (*(uint *)(iVar3 + 0x240378 + unaff_EBX) == uVar1) {
      iVar3 = *(int *)(iVar2 + 0x110);
      if (iVar3 == 0) goto LAB_100096c7;
      if (iVar3 == 1) {
        bVar4 = *(int *)(iVar2 + 0x114) == *(int *)(unaff_EDI + 0xa34);
      }
      else {
        if ((iVar3 != 3) ||
           (iVar3 = FUN_10026280(*(int *)(unaff_EBX + 0x4118),*(int *)(iVar2 + 0x114)), iVar3 == 0))
        goto LAB_100096b1;
        iVar3 = FUN_10026280(*(int *)(iVar3 + 0xe8),*(int *)(unaff_EDI + 0xa34));
        bVar4 = iVar3 != 0;
      }
      if (bVar4) {
LAB_100096c7:
        FUN_10005d70(*(char **)(param_1 + 0x60),(char *)(iVar2 + 0xc),*(size_t *)(param_1 + 0x5c));
        *(undefined4 *)(param_1 + 0x58) = 0xffffffff;
        *(undefined4 *)(param_1 + 0x50) = *(undefined4 *)(iVar2 + 4);
        *(undefined4 *)(param_1 + 0x54) = *(undefined4 *)(iVar2 + 8);
        uVar1 = *(int *)(unaff_EDI + 0x40) + 1;
        *(uint *)(unaff_EDI + 0x40) = uVar1;
        return uVar1 & 0xffffff00;
      }
    }
LAB_100096b1:
    iVar2 = *(int *)(unaff_EDI + 0x40) + 1;
    *(int *)(unaff_EDI + 0x40) = iVar2;
  } while( true );
}



uint __fastcall FUN_10009700(int param_1)

{
  int iVar1;
  int in_EAX;
  uint uVar2;
  int unaff_ESI;
  
  if (*(int *)(param_1 + 0xd24) != 0) {
    iVar1 = *(int *)(in_EAX + 0x403c);
    if (iVar1 != *(int *)(param_1 + 0xd28) && -1 < iVar1 - *(int *)(param_1 + 0xd28)) {
      *(int *)(param_1 + 0xd28) = iVar1 + *(int *)(param_1 + 0xd24);
      if (*(int *)(in_EAX + 0x2cccc0) != *(int *)(param_1 + 0xd20)) {
        *(int *)(param_1 + 0xd20) = *(int *)(in_EAX + 0x2cccc0);
        uVar2 = FUN_10003e20(*(byte **)(unaff_ESI + 0x60),*(size_t *)(unaff_ESI + 0x5c),
                             (byte *)"UIL=%d UIR=%d UIG=%d GIP=%d GCR=%d GCM=%d");
        *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
        *(undefined4 *)(unaff_ESI + 0x50) = 0x2b737374;
        return uVar2 & 0xffffff00;
      }
    }
  }
  return CONCAT31((int3)((uint)in_EAX >> 8),1);
}



int __cdecl
FUN_10009ce0(int param_1,byte *param_2,int param_3,undefined4 *param_4,int *param_5,uint *param_6,
            undefined4 param_7,int param_8,int param_9,undefined4 param_10)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  void *this;
  int iVar5;
  int local_8;
  uint local_4;
  
  pbVar1 = param_2;
  iVar4 = *(int *)(param_1 + 0x4120 + *(int *)(param_2 + 0x94) * 4);
  pbVar3 = param_2 + 0x99;
  iVar5 = 0;
  param_2 = (byte *)0x0;
  iVar2 = param_3;
  if (*pbVar3 == 0) {
    if (pbVar1[0x98] == 0) goto LAB_10009d43;
    iVar2 = *(int *)(pbVar1 + param_3 * 8 + 0x6e4);
  }
  param_2 = pbVar1 + (iVar2 + 10) * 0x10;
  iVar2 = FUN_10021940(iVar4,param_2);
LAB_10009d43:
  local_8 = 0;
  local_4 = 0;
  pbVar3 = (byte *)FUN_10021690(iVar4,iVar2,&local_4,&local_8,(int *)&param_2);
  if (param_2 == (byte *)0x0) {
    if (*(int *)(pbVar1 + 0x9c) != 0) {
      iVar5 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(pbVar1 + 0xa34));
      param_2 = (byte *)(iVar5 + 0x20);
    }
  }
  else {
    iVar5 = FUN_10022a40(this,*(int *)(param_1 + 0x40f8),param_2);
  }
  iVar2 = *(int *)(pbVar1 + 0x9c);
  if ((iVar2 == 0) || (*(char *)(iVar2 + 0xdd8) == '\0')) {
    if (pbVar3 == (byte *)0x0) {
      if (iVar2 == 0) {
        return -1;
      }
      local_8 = FUN_10021640(iVar4);
      local_4 = 0;
      iVar4 = FUN_100235c0();
    }
    else {
      iVar4 = FUN_10023540();
    }
  }
  else {
    FUN_100244d0((void *)(iVar2 + 0xed8),(char *)param_2,pbVar3,0x80);
    iVar4 = FUN_10023ca0((void *)(*(int *)(pbVar1 + 0x9c) + 0xed8),param_8,param_9);
  }
  *param_4 = param_2;
  *param_5 = local_8 + 1;
  *param_6 = local_4;
  *(bool *)param_7 = iVar5 != 0;
  return iVar4;
}



void __cdecl FUN_10009ef0(int param_1)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *unaff_EBX;
  uint uVar4;
  byte *pbVar5;
  int iVar6;
  int iVar7;
  byte local_10 [16];
  
  iVar6 = 0;
  pbVar1 = FUN_100020f0(unaff_EBX,&DAT_1004e304);
  iVar6 = FUN_10002480((char *)pbVar1,iVar6);
  iVar7 = 0;
  *(short *)(param_1 + 0xdc8) = (short)iVar6;
  pbVar1 = FUN_100020f0(unaff_EBX,&DAT_1004e300);
  iVar6 = FUN_10002480((char *)pbVar1,iVar7);
  uVar4 = 0;
  *(short *)(param_1 + 0xdca) = (short)iVar6;
  if (*(short *)(param_1 + 0xdc8) != 0) {
    pbVar1 = (byte *)(param_1 + 0x68);
    do {
      _sprintf((char *)local_10,"CN%d",uVar4);
      pbVar5 = &DAT_1004d26f;
      iVar6 = 0x20;
      pbVar3 = pbVar1 + -0x40;
      pbVar2 = FUN_100020f0(unaff_EBX,local_10);
      FUN_10002a30(pbVar2,pbVar3,iVar6,pbVar5);
      _sprintf((char *)local_10,"CD%d",uVar4);
      pbVar5 = &DAT_1004d26f;
      iVar6 = 0x20;
      pbVar3 = pbVar1 + -0x20;
      pbVar2 = FUN_100020f0(unaff_EBX,local_10);
      FUN_10002a30(pbVar2,pbVar3,iVar6,pbVar5);
      _sprintf((char *)local_10,"CP%d",uVar4);
      pbVar5 = &DAT_1004d26f;
      iVar6 = 0x20;
      pbVar3 = pbVar1;
      pbVar2 = FUN_100020f0(unaff_EBX,local_10);
      FUN_10002a30(pbVar2,pbVar3,iVar6,pbVar5);
      _sprintf((char *)local_10,"CW%d",uVar4);
      iVar6 = 0x38;
      pbVar3 = FUN_100020f0(unaff_EBX,local_10);
      iVar6 = FUN_10002480((char *)pbVar3,iVar6);
      *(int *)(pbVar1 + 0x20) = iVar6;
      _sprintf((char *)local_10,"CT%d",uVar4);
      iVar6 = 0;
      pbVar3 = FUN_100020f0(unaff_EBX,local_10);
      iVar6 = FUN_10002480((char *)pbVar3,iVar6);
      *(int *)(pbVar1 + 0x24) = iVar6;
      _sprintf((char *)local_10,"CS%d",uVar4);
      iVar6 = 0;
      pbVar3 = FUN_100020f0(unaff_EBX,local_10);
      iVar6 = FUN_10002480((char *)pbVar3,iVar6);
      *(int *)(pbVar1 + 0x28) = iVar6;
      uVar4 = uVar4 + 1;
      pbVar1 = pbVar1 + 0x6c;
    } while (uVar4 != *(ushort *)(param_1 + 0xdc8));
  }
  return;
}



void __cdecl FUN_1000a090(int param_1,byte *param_2,undefined2 param_3)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  void *pvVar6;
  int *piVar7;
  long lVar8;
  void *extraout_ECX;
  void *extraout_ECX_00;
  uint uVar9;
  int iVar10;
  undefined4 *puVar11;
  undefined4 *puVar12;
  int iVar13;
  byte *pbVar14;
  byte *pbVar15;
  long *local_134;
  byte local_124 [12];
  byte abStack_118 [12];
  byte local_10c [256];
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_1004ce8e;
  local_c = ExceptionList;
  iVar13 = 0;
  ExceptionList = &local_c;
  pbVar1 = FUN_100020f0(param_2,&DAT_1004e390);
  uVar2 = FUN_10002480((char *)pbVar1,iVar13);
  iVar13 = 0;
  pbVar1 = FUN_100020f0(param_2,&DAT_1004e38c);
  uVar3 = FUN_10002480((char *)pbVar1,iVar13);
  iVar13 = 0;
  pbVar1 = FUN_100020f0(param_2,&DAT_1004e388);
  uVar4 = FUN_10002480((char *)pbVar1,iVar13);
  pbVar14 = &DAT_1004d26f;
  iVar13 = 0xc;
  pbVar1 = local_124;
  pbVar5 = FUN_100020f0(param_2,&DAT_1004e040);
  FUN_10002a30(pbVar5,pbVar1,iVar13,pbVar14);
  pbVar1 = (byte *)FUN_10022a40(local_124,*(int *)(param_1 + 0x4360),local_124);
  if (pbVar1 == (byte *)0x0) {
    pbVar1 = (byte *)_malloc(0x28);
    FUN_10005d70((char *)pbVar1,(char *)local_124,0xc);
    pbVar1[0xc] = 0;
    pbVar1[0xd] = 0;
    pbVar1[0xe] = 0;
    pbVar1[0xf] = 0;
    pbVar1[0x10] = 0;
    pbVar1[0x11] = 0;
    pbVar1[0x12] = 0;
    pbVar1[0x13] = 0;
    pbVar1[0x14] = 0;
    pbVar1[0x15] = 0;
    pbVar1[0x16] = 0;
    pbVar1[0x17] = 0;
    pbVar1[0x18] = 0;
    pbVar1[0x19] = 0;
    pbVar1[0x1a] = 0;
    pbVar1[0x1b] = 0;
    pbVar1[0x1c] = 0;
    pbVar1[0x1d] = 0;
    pbVar1[0x1e] = 0;
    pbVar1[0x1f] = 0;
    pbVar1[0x20] = 0;
    pbVar1[0x21] = 0;
    pbVar1[0x22] = 0;
    pbVar1[0x23] = 0;
    pvVar6 = operator_new(0x10);
    local_4 = 0;
    if (pvVar6 == (void *)0x0) {
      piVar7 = (int *)0x0;
      pvVar6 = extraout_ECX;
    }
    else {
      piVar7 = FUN_100236d0(pvVar6,0x400,0x20);
      pvVar6 = extraout_ECX_00;
    }
    *(int **)(pbVar1 + 0x24) = piVar7;
    local_4 = 0xffffffff;
    FUN_100229d0(pvVar6,*(int **)(param_1 + 0x4360),pbVar1,(int)pbVar1);
  }
  *(int *)(pbVar1 + 0x20) = *(int *)(pbVar1 + 0x20) + 1;
  if (*(uint *)(pbVar1 + 0x14) <= uVar2) {
    iVar13 = uVar2 + 2;
    pvVar6 = _realloc(*(void **)(pbVar1 + 0xc),iVar13 * 0x14);
    if (pvVar6 == (void *)0x0) {
      FUN_10016450(0x400000);
      ExceptionList = local_c;
      return;
    }
    puVar12 = (undefined4 *)((int)pvVar6 + uVar2 * 0x14);
    for (uVar9 = (iVar13 - *(int *)(pbVar1 + 0x14)) * 5 & 0x3fffffff; uVar9 != 0; uVar9 = uVar9 - 1)
    {
      *puVar12 = 0;
      puVar12 = puVar12 + 1;
    }
    for (iVar10 = 0; iVar10 != 0; iVar10 = iVar10 + -1) {
      *(undefined1 *)puVar12 = 0;
      puVar12 = (undefined4 *)((int)puVar12 + 1);
    }
    *(void **)(pbVar1 + 0xc) = pvVar6;
    *(int *)(pbVar1 + 0x14) = iVar13;
  }
  pbVar15 = &DAT_1004d26f;
  iVar13 = 0x100;
  pbVar5 = local_10c;
  puVar12 = (undefined4 *)(*(int *)(pbVar1 + 0xc) + uVar2 * 0x14);
  pbVar14 = FUN_100020f0(param_2,&DAT_1004e364);
  FUN_10002a30(pbVar14,pbVar5,iVar13,pbVar15);
  pbVar5 = FUN_10023710(*(void **)(pbVar1 + 0x24),local_10c);
  *puVar12 = pbVar5;
  if (*(uint *)(pbVar1 + 0x10) < uVar2 + 1) {
    *(uint *)(pbVar1 + 0x10) = uVar2 + 1;
  }
  puVar12[1] = uVar2;
  if ((uint)puVar12[4] <= uVar4) {
    pvVar6 = _realloc((void *)puVar12[2],(uVar4 + 2) * 0x14);
    if (pvVar6 == (void *)0x0) {
      FUN_10016450(0x400000);
      ExceptionList = local_c;
      return;
    }
    puVar11 = (undefined4 *)((int)pvVar6 + uVar4 * 0x14);
    for (uVar2 = ((uVar4 + 2) - puVar12[4]) * 5 & 0x3fffffff; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    for (iVar13 = 0; iVar13 != 0; iVar13 = iVar13 + -1) {
      *(undefined1 *)puVar11 = 0;
      puVar11 = (undefined4 *)((int)puVar11 + 1);
    }
    puVar12[2] = pvVar6;
    puVar12[4] = uVar4 + 2;
  }
  pbVar15 = &DAT_1004d26f;
  puVar11 = (undefined4 *)(puVar12[2] + uVar4 * 0x14);
  iVar13 = 0x100;
  pbVar5 = local_10c;
  pbVar14 = FUN_100020f0(param_2,&DAT_1004e344);
  FUN_10002a30(pbVar14,pbVar5,iVar13,pbVar15);
  pbVar5 = FUN_10023710(*(void **)(pbVar1 + 0x24),local_10c);
  *puVar11 = pbVar5;
  if ((uint)puVar12[3] < uVar4 + 1) {
    puVar12[3] = uVar4 + 1;
    *(int *)(pbVar1 + 0x18) = *(int *)(pbVar1 + 0x18) + 1;
  }
  puVar11[1] = uVar4;
  if ((uint)puVar11[4] <= uVar3) {
    pvVar6 = _realloc((void *)puVar11[2],(uVar3 + 2) * 0x1e028);
    if (pvVar6 == (void *)0x0) {
      FUN_10016450(0x400000);
      ExceptionList = local_c;
      return;
    }
    puVar11[4] = uVar3 + 2;
    puVar11[2] = pvVar6;
  }
  pbVar15 = &DAT_1004d26f;
  iVar13 = 0x100;
  pbVar5 = local_10c;
  puVar12 = (undefined4 *)(uVar3 * 0x1e028 + puVar11[2]);
  pbVar14 = FUN_100020f0(param_2,&DAT_1004e320);
  FUN_10002a30(pbVar14,pbVar5,iVar13,pbVar15);
  pbVar5 = FUN_10023710(*(void **)(pbVar1 + 0x24),local_10c);
  *puVar12 = pbVar5;
  puVar12[9] = uVar3;
  if ((uint)puVar11[3] < uVar3 + 1) {
    puVar11[3] = uVar3 + 1;
    *(int *)(pbVar1 + 0x1c) = *(int *)(pbVar1 + 0x1c) + 1;
  }
  pbVar14 = &DAT_1004d26f;
  iVar13 = 0x20;
  pbVar1 = (byte *)(puVar12 + 1);
  *(undefined2 *)(puVar12 + 0x373) = param_3;
  pbVar5 = FUN_100020f0(param_2,&DAT_1004df70);
  FUN_10002a30(pbVar5,pbVar1,iVar13,pbVar14);
  iVar13 = 100;
  pbVar1 = FUN_100020f0(param_2,(byte *)"RANGE");
  iVar13 = FUN_10002480((char *)pbVar1,iVar13);
  iVar10 = 0;
  *(short *)(puVar12 + 0x374) = (short)iVar13;
  pbVar1 = FUN_100020f0(param_2,(byte *)"FLAGS");
  iVar13 = FUN_10002480((char *)pbVar1,iVar10);
  uVar2 = 0;
  *(short *)((int)puVar12 + 0xdd2) = (short)iVar13;
  pbVar1 = FUN_100020f0(param_2,(byte *)"USERS");
  uVar2 = FUN_10002930(pbVar1,uVar2);
  pbVar14 = &DAT_1004d26f;
  iVar13 = 0x100;
  puVar12[0x375] = uVar2;
  pbVar1 = (byte *)(puVar12 + 0x376);
  pbVar5 = FUN_100020f0(param_2,(byte *)"EXTRACT");
  FUN_10002a30(pbVar5,pbVar1,iVar13,pbVar14);
  FUN_10023b40(puVar12 + 0x3b6,(char *)(puVar12 + 0x376),&LAB_10007e50,param_1);
  pbVar1 = FUN_100020f0(param_2,(byte *)"PARAMS");
  iVar13 = 0;
  if (pbVar1 != (byte *)0x0) {
    local_134 = puVar12 + 0x36a;
    do {
      iVar10 = FUN_10003680(pbVar1,abStack_118,0xc,&DAT_1004d26f,iVar13,0x2c);
      if ((iVar10 < 1) || (abStack_118[0] == 0)) break;
      lVar8 = _atol((char *)abStack_118);
      *local_134 = lVar8;
      iVar13 = iVar13 + 1;
      local_134 = local_134 + 1;
    } while (iVar13 != 8);
  }
  *(short *)((int)puVar12 + 0xdce) = (short)iVar13;
  FUN_10009ef0((int)puVar12);
  ExceptionList = local_c;
  return;
}



void __cdecl FUN_1000a580(int param_1)

{
  byte *pbVar1;
  undefined4 *puVar2;
  byte *unaff_ESI;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  
  iVar3 = 0;
  pbVar1 = FUN_100020f0(unaff_ESI,&DAT_1004d950);
  iVar3 = FUN_10002480((char *)pbVar1,iVar3);
  iVar4 = 0;
  pbVar1 = FUN_100020f0(unaff_ESI,&DAT_1004e3a8);
  iVar4 = FUN_10002480((char *)pbVar1,iVar4);
  iVar5 = 0;
  pbVar1 = FUN_100020f0(unaff_ESI,&DAT_1004e3a0);
  iVar5 = FUN_10002480((char *)pbVar1,iVar5);
  iVar6 = 0;
  pbVar1 = FUN_100020f0(unaff_ESI,&DAT_1004e39c);
  iVar6 = FUN_10002480((char *)pbVar1,iVar6);
  iVar7 = 0;
  pbVar1 = FUN_100020f0(unaff_ESI,&DAT_1004e398);
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  iVar8 = 0;
  pbVar1 = FUN_100020f0(unaff_ESI,&DAT_1004e394);
  iVar8 = FUN_10002480((char *)pbVar1,iVar8);
  puVar2 = FUN_10020e00(iVar4,iVar5,iVar6,iVar7,iVar8 != 0);
  *(undefined4 **)(param_1 + 0x4120 + iVar3 * 4) = puVar2;
  return;
}



void __cdecl FUN_1000a660(int param_1,int param_2,char *param_3,int param_4)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  undefined4 *puVar4;
  char *pcVar5;
  int unaff_EDI;
  
  if (param_2 == -1) {
    FUN_10022490(*(undefined4 **)(unaff_EDI + 0x4028),0x2a736470,0,(char *)(unaff_EDI + 0x2cca18),
                 (char *)0xffffffff);
    return;
  }
  if (param_1 < 0) {
    uVar3 = FUN_10014340(*(int *)(unaff_EDI + 0x4020),-param_1);
    if (((uVar3 != 0) && (*(int *)(uVar3 + 0x28) != 0)) &&
       (iVar2 = *(int *)(uVar3 + 0x94), iVar2 != 0)) {
      puVar4 = FUN_10028690(*(int **)(unaff_EDI + 0x2cc690),param_4 + 1);
      *(undefined4 **)(iVar2 + 0xab0) = puVar4;
      pcVar5 = (char *)puVar4[3];
      do {
        cVar1 = *param_3;
        param_3 = param_3 + 1;
        *pcVar5 = cVar1;
        pcVar5 = pcVar5 + 1;
      } while (cVar1 != '\0');
      **(int **)(iVar2 + 0xab0) = param_1;
      *(int *)(*(int *)(iVar2 + 0xab0) + 4) = param_2;
      *(undefined4 *)(uVar3 + 0x30) = 0;
    }
  }
  else if (param_1 == 0x2a736470) {
    if (param_2 != 0) {
      FUN_10016450(8);
      FUN_100141b0(*(int **)(unaff_EDI + 0x4020));
      return;
    }
    if (*(char *)(unaff_EDI + 0x402c) == '\0') {
      *(undefined1 *)(unaff_EDI + 0x402c) = 1;
      FUN_10007e90(unaff_EDI);
      return;
    }
  }
  return;
}



void __cdecl FUN_1000a750(int param_1,int param_2,char *param_3,int param_4)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  undefined4 *puVar4;
  char *pcVar5;
  int unaff_EDI;
  
  if (param_2 == -1) {
    FUN_10022490(*(undefined4 **)(unaff_EDI + 0x4030),0x2a736470,0,(char *)(unaff_EDI + 0x2cca18),
                 (char *)0xffffffff);
    return;
  }
  if (param_1 < 0) {
    uVar3 = FUN_10014340(*(int *)(unaff_EDI + 0x4020),-param_1);
    if (((uVar3 != 0) && (*(int *)(uVar3 + 0x28) != 0)) &&
       (iVar2 = *(int *)(uVar3 + 0x94), iVar2 != 0)) {
      puVar4 = FUN_10028690(*(int **)(unaff_EDI + 0x2cc690),param_4 + 1);
      *(undefined4 **)(iVar2 + 0xab0) = puVar4;
      pcVar5 = (char *)puVar4[3];
      do {
        cVar1 = *param_3;
        param_3 = param_3 + 1;
        *pcVar5 = cVar1;
        pcVar5 = pcVar5 + 1;
      } while (cVar1 != '\0');
      **(int **)(iVar2 + 0xab0) = param_1;
      *(int *)(*(int *)(iVar2 + 0xab0) + 4) = param_2;
      *(undefined4 *)(uVar3 + 0x30) = 0;
    }
  }
  else if ((param_1 == 0x2a736470) && (param_2 != 0)) {
    FUN_10016450(8);
    FUN_100141b0(*(int **)(unaff_EDI + 0x4020));
    return;
  }
  return;
}



void __cdecl FUN_1000a830(undefined4 param_1,char *param_2)

{
  char *pcVar1;
  int iVar2;
  int local_8;
  int local_4;
  
  pcVar1 = param_2;
  iVar2 = FUN_10022340(*(int *)(param_2 + 0x4028),&local_4,&local_8,&param_2);
  while (-1 < iVar2) {
    if (local_4 == -1) {
      FUN_10022490(*(undefined4 **)(pcVar1 + 0x4028),0x2a736470,0,pcVar1 + 0x2cca18,
                   (char *)0xffffffff);
    }
    else {
      FUN_1000a660(local_4,local_8,param_2,iVar2);
    }
    FUN_100223d0(*(int *)(pcVar1 + 0x4028),(undefined4 *)0x0,(undefined4 *)0x0,(undefined4 *)0x0,0);
    iVar2 = FUN_10022340(*(int *)(pcVar1 + 0x4028),&local_4,&local_8,&param_2);
  }
  return;
}



void __cdecl FUN_1000a8e0(undefined4 param_1,char *param_2)

{
  char *pcVar1;
  int iVar2;
  int local_8;
  int local_4;
  
  pcVar1 = param_2;
  iVar2 = FUN_10022340(*(int *)(param_2 + 0x4030),&local_4,&local_8,&param_2);
  while (-1 < iVar2) {
    if (local_4 == -1) {
      FUN_10022490(*(undefined4 **)(pcVar1 + 0x4030),0x2a736470,0,pcVar1 + 0x2cca18,
                   (char *)0xffffffff);
    }
    else {
      FUN_1000a750(local_4,local_8,param_2,iVar2);
    }
    FUN_100223d0(*(int *)(pcVar1 + 0x4030),(undefined4 *)0x0,(undefined4 *)0x0,(undefined4 *)0x0,0);
    iVar2 = FUN_10022340(*(int *)(pcVar1 + 0x4030),&local_4,&local_8,&param_2);
  }
  return;
}



void __cdecl FUN_1000aad0(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  
  if (*(int *)(param_2 + 0x84) == 0) {
    FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                 (byte *)
                 "I=%d N=%s M=%s F=%f A=%a P=%d S=%s G=%d AT=%f CL=%d LV=%d MD=%d LA=%a HW=%d RP=%d MA=%s LO=%t"
                );
    if ((*(uint *)(param_3 + 0x218) & 0x200000) != 0) {
      FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e14c,
                   (byte *)(param_3 + 0x194));
    }
    if (param_4 != 0) {
      FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                   (byte *)"~RM=%s RI=%d RF=%f RT=%d RG=%d");
    }
    if (*(char *)(param_3 + 0x434) != '\0') {
      FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"~CI=%s CT=%s");
    }
    FUN_10025b00(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),param_3);
    iVar1 = FUN_100219e0(*(int *)(param_1 + 0x4120),(byte *)(param_3 + 0x20));
    if (-1 < iVar1) {
      FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e144,iVar1 + 1);
    }
  }
  return;
}



void __cdecl FUN_1000ac40(int param_1,int param_2,int param_3,int param_4)

{
  undefined4 uVar1;
  byte *pbVar2;
  
  FUN_10025580((char *)(param_4 + 0x50),(char *)(param_3 + 0x20));
  FUN_10025580((char *)(param_4 + 0x60),(char *)(param_3 + 0x20));
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
               (byte *)"I=%d N=%s H=%s F=%f T=%d GT=%d L=%d LO=%t");
  if ((*(uint *)(param_4 + 4) & 0x1000) == 0) {
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e4dc,
                 (byte *)(param_4 + 0x2c));
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e4d8,
                 (byte *)(param_4 + 0x84));
  }
  else {
    uVar1 = *(undefined4 *)(param_1 + 0x2ccc9c);
    pbVar2 = FUN_10017ca0(*(int **)(param_1 + 0x2ccca4),(byte *)(param_4 + 0x2c),
                          *(undefined4 *)(param_3 + 0x428));
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e4dc,pbVar2);
    pbVar2 = FUN_10023690(uVar1,*(int **)(param_1 + 0x2ccca4),param_3,(byte *)(param_4 + 0x84));
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e4d8,pbVar2);
  }
  FUN_10002d30(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e4d0,
               (uint *)(param_4 + 0x1ac),0x24,&DAT_1004e4d4);
  return;
}



void __cdecl FUN_1000ada0(int param_1)

{
  if (*(int *)(param_1 + 0x84) == 0) {
    **(undefined1 **)(param_1 + 0x60) = 0;
    *(undefined4 *)(param_1 + 0x50) = *(undefined4 *)(param_1 + 0x6c);
  }
  else if (*(int *)(param_1 + 0x84) == 1) {
    FUN_10016ae0(*(char **)(param_1 + 0x60),*(uint *)(param_1 + 0x5c),1);
    FUN_10016c00(*(char **)(param_1 + 0x60),*(undefined4 *)(param_1 + 0x88));
    return;
  }
  return;
}



uint __cdecl FUN_1000adf0(int param_1)

{
  int iVar1;
  uint uVar2;
  byte *unaff_ESI;
  int unaff_EDI;
  undefined1 local_d;
  uint local_c;
  int local_8;
  undefined4 local_4;
  
  iVar1 = *(int *)(unaff_ESI + 0x90);
  if ((0 < iVar1) && (*(int *)(unaff_ESI + 0x8c) < iVar1)) {
    FUN_10003e20(*(byte **)(unaff_EDI + 0x60),*(size_t *)(unaff_EDI + 0x5c),&DAT_1004e524);
    iVar1 = *(int *)(unaff_ESI + 0x8c);
    *(int *)(unaff_ESI + 0x8c) = iVar1 + 1;
    iVar1 = FUN_10009ce0(param_1,unaff_ESI,iVar1,&local_4,&local_8,&local_c,&local_d,
                         *(int *)(unaff_EDI + 0x60),*(int *)(unaff_EDI + 0x5c),
                         *(undefined4 *)(unaff_ESI + 0xa00));
    if (-1 < iVar1) {
      uVar2 = FUN_10003e20((byte *)(*(int *)(unaff_EDI + 0x60) + iVar1),
                           *(int *)(unaff_EDI + 0x5c) - iVar1,(byte *)" N=%s R=%d P=%d O=%d");
      *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
      *(undefined4 *)(unaff_EDI + 0x50) = 0x2b736e70;
      return uVar2 & 0xffffff00;
    }
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



undefined4 __cdecl FUN_1000aeb0(int param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int unaff_EDI;
  
  iVar4 = param_2;
  iVar2 = *(int *)(unaff_EDI + 0x2cc384);
  iVar5 = *(int *)(param_2 + 0x20);
  puVar1 = (uint *)(param_2 + 0x20);
  if (0 < iVar5) {
    iVar5 = FUN_100262e0(*(int *)(unaff_EDI + 0x40ec),(int *)puVar1,&param_2);
    while (iVar5 != 0) {
      if (param_2 == 0) {
        if (*(int *)(iVar4 + 0x24) <= (int)*puVar1) {
          FUN_10003e20(*(byte **)(param_1 + 0x60),*(size_t *)(param_1 + 0x5c),&DAT_1004e1b0);
          goto LAB_1000af54;
        }
        *puVar1 = *puVar1 + 1;
      }
      else {
        if (((*(uint *)(param_2 + 4) & 0x200) == 0) ||
           ((iVar2 != 0 && ((*(uint *)(iVar2 + 8) & 0x2002) != 0)))) {
          FUN_1000ac40(unaff_EDI,param_1,iVar2,param_2);
LAB_1000af54:
          *(undefined4 *)(param_1 + 0x58) = 0xffffffff;
          *(undefined4 *)(param_1 + 0x50) = 0x2b726f6d;
          uVar3 = *puVar1;
          *puVar1 = uVar3 + 1;
          return uVar3 + 1 & 0xffffff00;
        }
        *puVar1 = *puVar1 + 1;
      }
      iVar5 = FUN_100262e0(*(int *)(unaff_EDI + 0x40ec),(int *)puVar1,&param_2);
    }
  }
  return CONCAT31((int3)((uint)iVar5 >> 8),1);
}



undefined4 __cdecl FUN_1000af70(int param_1,int param_2,int param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int *local_4;
  
  iVar2 = *(int *)(param_1 + 0x2cc388);
  iVar4 = param_1;
  if (iVar2 != 0) {
    iVar4 = *(int *)(param_3 + 0x18);
    puVar1 = (uint *)(param_3 + 0x18);
    if (0 < iVar4) {
      iVar4 = FUN_100262e0(*(int *)(iVar2 + 0x118),(int *)puVar1,&local_4);
      while (iVar4 != 0) {
        if (local_4 != (int *)0x0) {
          FUN_10025580((char *)(iVar2 + 0x50),(char *)(local_4 + 8));
          FUN_10025580((char *)(iVar2 + 0x60),(char *)(local_4 + 8));
          FUN_1000aad0(param_1,param_2,(int)local_4,iVar2);
LAB_1000b063:
          FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e528,
                       *(uint *)(iVar2 + 0x10c));
          *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
          *(undefined4 *)(param_2 + 0x50) = 0x2b757372;
          uVar3 = *puVar1;
          *puVar1 = uVar3 + 1;
          return uVar3 + 1 & 0xffffff00;
        }
        if (*(int *)(param_3 + 0x1c) <= (int)*puVar1) {
          FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),&DAT_1004e1b0);
          goto LAB_1000b063;
        }
        *puVar1 = *puVar1 + 1;
        iVar4 = FUN_100262e0(*(int *)(iVar2 + 0x118),(int *)puVar1,&local_4);
      }
    }
  }
  return CONCAT31((int3)((uint)iVar4 >> 8),1);
}



void __cdecl FUN_1000b700(int param_1,int *param_2,int *param_3,int param_4,int param_5)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  
  piVar1 = param_2;
  *(int *)(param_1 + 0x403c) = param_4;
  if (param_2[5] == -1) {
    return;
  }
  if (param_2[5] == -2) {
    return;
  }
  if (*(char *)((int)param_3 + 0xa1e) < '\x01') {
    if (param_5 == 0) {
      if ((param_3[0x288] != 0) && (iVar2 = param_4 - param_3[0x288], 0 < iVar2)) {
        if (*(char *)((int)param_3 + 0xa1e) != '\0') {
          return;
        }
        if (iVar2 == 1000 || iVar2 + -1000 < 0) {
          return;
        }
        param_2[0x14] = 0x7e706e67;
        *(undefined1 *)param_2[0x18] = 0;
        FUN_10003240((byte *)param_2[0x18],param_2[0x17],&DAT_1004e620,0);
        param_2[0x16] = -1;
        *(undefined1 *)((int)param_3 + 0xa1e) = 1;
        param_3[0x288] = *(int *)(param_1 + 0x2cc554) * 1000 + param_4;
        return;
      }
      iVar2 = FUN_10026280(*(int *)(param_1 + 0x40fc),param_3[0x28d]);
      if ((iVar2 == 0) || (*(int *)(iVar2 + 0x30) == 0)) {
        if (param_3[1] == 0) {
          param_2 = (int *)0x0;
        }
        else {
          param_2 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),param_3[1]);
        }
      }
      else {
        param_2 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),*(int *)(iVar2 + 0x30));
      }
      *(int *)(param_1 + 0x2cc384) = iVar2;
      *(int **)(param_1 + 0x2cc388) = param_2;
      iVar3 = param_3[0x2ad];
      if (((iVar3 != 0) && (param_4 != iVar3 && -1 < param_4 - iVar3)) &&
         ((iVar2 == 0 || ((*(uint *)(iVar2 + 8) & 0x2000) == 0)))) {
        piVar1[0x14] = 0x2b6d7367;
        piVar1[0x15] = 0;
        piVar1[0x16] = -1;
        *(undefined1 *)piVar1[0x18] = 0;
        FUN_10003e20((byte *)piVar1[0x18],piVar1[0x17],(byte *)"F=%f N=%s T=%s");
        piVar1[5] = -2;
      }
      iVar3 = param_3[0x2ae];
      if (((iVar3 != 0) && (param_4 != iVar3 && -1 < param_4 - iVar3)) &&
         ((iVar2 == 0 || ((*(uint *)(iVar2 + 8) & 0x2080) == 0)))) {
        piVar1[0x14] = 0x2b6d7367;
        piVar1[0x15] = 0;
        piVar1[0x16] = -1;
        *(undefined1 *)piVar1[0x18] = 0;
        FUN_10003e20((byte *)piVar1[0x18],piVar1[0x17],(byte *)"F=%f N=%s T=%s");
        piVar1[5] = -2;
      }
      if (iVar2 == 0) {
        if (param_3[0x28d] == 0) {
          return;
        }
        piVar1[5] = -1;
        FUN_10016490(0x400000);
        return;
      }
      if (param_2 == (int *)0x0) {
        param_4 = 0;
      }
      else {
        param_4 = *param_2;
      }
      if (((param_3[3] != param_4) || (param_3[4] != *(int *)(iVar2 + 8))) ||
         (param_3[2] != *(int *)(iVar2 + 4))) {
        if ((param_2 != (int *)0x0) && (param_3[3] != param_4)) {
          param_3[6] = 1;
          iVar3 = FUN_100262d0(param_2[0x46]);
          param_3[7] = iVar3;
          param_3[0xc] = 1;
          iVar3 = FUN_100262d0(param_2[0x47]);
          param_3[0xd] = iVar3;
        }
        param_3[3] = param_4;
        param_3[4] = *(int *)(iVar2 + 8);
        param_3[2] = *(int *)(iVar2 + 4);
        FUN_1000aad0(param_1,(int)piVar1,iVar2,(int)param_2);
        FUN_10002d30((byte *)piVar1[0x18],piVar1[0x17],&DAT_1004e4d0,(uint *)(iVar2 + 0x3bc),0x24,
                     &DAT_1004e4d4);
        piVar1[0x14] = 0x2b77686f;
        piVar1[0x16] = -1;
        return;
      }
    }
    iVar2 = *(int *)(param_1 + 0x2cc384);
    if ((*(uint *)(iVar2 + 8) & 0x4000000) == 0) {
      uVar4 = FUN_10008a00(param_1,(int)piVar1,param_3);
      if ((((((char)uVar4 != '\0') && (uVar5 = FUN_1000adf0(param_1), (char)uVar5 != '\0')) &&
           ((uVar5 = FUN_1000aeb0((int)piVar1,(int)param_3), (char)uVar5 != '\0' &&
            (((uVar5 = FUN_10008d80(param_1,(int)piVar1,(int)param_3), (char)uVar5 != '\0' &&
              (uVar5 = FUN_1000af70(param_1,(int)piVar1,(int)param_3), (char)uVar5 != '\0')) &&
             (uVar5 = FUN_10008f40(param_1,(int)piVar1,(int)param_3), (char)uVar5 != '\0')))))) &&
          ((uVar5 = FUN_100091c0((int)param_3), (char)uVar5 != '\0' &&
           (uVar5 = FUN_100092c0((int)param_3), (char)uVar5 != '\0')))) &&
         ((uVar5 = FUN_100093d0((int)piVar1), (char)uVar5 != '\0' &&
          (((uVar5 = FUN_10009540((int)piVar1,(int)param_3), (char)uVar5 != '\0' &&
            (uVar4 = FUN_10009610((int)piVar1), (char)uVar4 != '\0')) &&
           ((uVar5 = FUN_10009700((int)param_3), (char)uVar5 != '\0' &&
            (((*(char *)(param_1 + 0x2cccf4) != '\0' && (param_3[0x10] != 0)) &&
             (uVar5 = FUN_1002a930(param_1,(int)piVar1,iVar2), (char)uVar5 != '\0')))))))))) {
        piVar1[0x14] = 0x2b6b6f68;
        piVar1[0x16] = -1;
      }
      return;
    }
  }
  else if (param_4 == param_3[0x288] || param_4 - param_3[0x288] < 0) {
    return;
  }
  piVar1[5] = -1;
  return;
}



undefined1 __thiscall FUN_1000bb40(void *this,int param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  char cVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  undefined4 *puVar6;
  long lVar7;
  void *pvVar8;
  void *this_00;
  int *piVar9;
  uint uVar10;
  uint *puVar11;
  int iVar12;
  uint uVar13;
  uint uVar14;
  undefined4 uVar15;
  char *pcVar16;
  void *this_01;
  void *this_02;
  void *this_03;
  void *this_04;
  void *this_05;
  void *this_06;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  char *pcVar17;
  long *plVar18;
  int *piVar19;
  uint *puVar20;
  bool bVar21;
  bool bVar22;
  float10 fVar23;
  undefined4 uVar24;
  int iVar25;
  int iVar26;
  code *pcVar27;
  u_short uVar28;
  byte *pbVar29;
  uint uVar30;
  float fVar31;
  byte *pbVar32;
  uint local_edc;
  uint local_ed8;
  uint local_ed4;
  int local_ed0;
  int local_ecc;
  int local_ec8;
  byte local_ec4 [16];
  byte local_eb4 [64];
  byte local_e74 [32];
  byte local_e54 [64];
  byte local_e14 [64];
  byte local_dd4 [64];
  byte local_d94 [132];
  byte local_d10 [260];
  byte local_c0c [1024];
  byte local_80c [2048];
  void *local_c;
  undefined1 *puStack_8;
  void *local_4;
  
  local_4 = (void *)0xffffffff;
  puStack_8 = &LAB_1004cebc;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  if (param_2 == 0x534c4156) {
    ExceptionList = &local_c;
    FUN_10016490(0x400000);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x80;
    pbVar5 = (byte *)(param_1 + 0x2cc40c);
    pbVar4 = FUN_100020f0((byte *)this,&DAT_1004dcb8);
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    uVar30 = 0;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e96c);
    uVar30 = FUN_10002780(pbVar5,uVar30);
    iVar25 = 1;
    *(uint *)(param_1 + 0x4038) = uVar30;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"RANKINGS");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    pbVar29 = &DAT_1004d26f;
    iVar26 = 0x20;
    pbVar5 = (byte *)(param_1 + 0x2cc50c);
    *(int *)(param_1 + 0x411c) = iVar25;
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"WEBPASS");
    FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x40;
    pbVar5 = local_e54;
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"START");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    pbVar5 = (byte *)(param_1 + 0x2cc48c);
    if (*(char *)(param_1 + 0x2cc48c) == '\0') {
      pbVar4 = local_e54;
      iVar25 = (int)pbVar5 - (int)pbVar4;
      do {
        bVar1 = *pbVar4;
        pbVar4[iVar25] = bVar1;
        pbVar4 = pbVar4 + 1;
      } while (bVar1 != 0);
    }
    pbVar4 = local_e54;
    do {
      bVar1 = *pbVar5;
      bVar21 = bVar1 < *pbVar4;
      if (bVar1 != *pbVar4) {
LAB_1000bc95:
        iVar25 = (1 - (uint)bVar21) - (uint)(bVar21 != 0);
        goto LAB_1000bc9a;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar5[1];
      bVar21 = bVar1 < pbVar4[1];
      if (bVar1 != pbVar4[1]) goto LAB_1000bc95;
      pbVar5 = pbVar5 + 2;
      pbVar4 = pbVar4 + 2;
    } while (bVar1 != 0);
    iVar25 = 0;
LAB_1000bc9a:
    if (iVar25 != 0) {
      FUN_100141b0(*(int **)(param_1 + 0x4020));
    }
  }
  if (param_3 == -1) {
    local_e74[0] = 0;
    FUN_100024f0(local_e74,0x20,(byte *)"UPDATES",0x7c28aa);
    FUN_10022490(*(undefined4 **)(param_1 + 0x4024),0x534c4156,0,(char *)local_e74,
                 (char *)0xffffffff);
    *(int *)(param_1 + 0x2cc5ac) = *(int *)(param_1 + 0x2cc5ac) + 1;
    ExceptionList = local_c;
    return 0;
  }
  if ((((param_2 < 0) && (uVar30 = FUN_10014340(*(int *)(param_1 + 0x4020),-param_2), uVar30 != 0))
      && (*(int *)(uVar30 + 0x28) != 0)) && (iVar25 = *(int *)(uVar30 + 0x94), iVar25 != 0)) {
    puVar6 = FUN_10028690(*(int **)(param_1 + 0x2cc690),param_4 + 1);
    *(undefined4 **)(iVar25 + 0xab0) = puVar6;
    pcVar17 = (char *)puVar6[3];
    pcVar16 = (char *)this;
    do {
      cVar2 = *pcVar16;
      pcVar16 = pcVar16 + 1;
      *pcVar17 = cVar2;
      pcVar17 = pcVar17 + 1;
    } while (cVar2 != '\0');
    **(int **)(iVar25 + 0xab0) = param_2;
    *(int *)(*(int *)(iVar25 + 0xab0) + 4) = param_3;
    *(undefined4 *)(uVar30 + 0x30) = 0;
  }
  pbVar5 = (byte *)this;
  if (param_2 == 0x2b736563) {
    do {
      bVar1 = *pbVar5;
      pbVar5 = pbVar5 + 1;
    } while (bVar1 != 0);
    FUN_1002a5b0(*(int *)(param_1 + 0x4034),(byte *)this,(char *)pbVar5);
    iVar25 = FUN_10005cd0((byte *)this,(byte *)"FILTER");
    if ((iVar25 == 0) || (iVar25 = FUN_10005cd0((byte *)this,(byte *)"FILTER-TEXT"), iVar25 == 0)) {
      FUN_10024d30(*(undefined4 **)(param_1 + 0x2cc37c),pbVar5);
    }
    iVar25 = FUN_10005cd0((byte *)this,(byte *)"FILTER");
    if ((iVar25 != 0) && (iVar25 = FUN_10005cd0((byte *)this,(byte *)"FILTER-NAME"), iVar25 != 0)) {
      ExceptionList = local_c;
      return 0;
    }
    FUN_10024d30(*(undefined4 **)(param_1 + 0x2cc380),pbVar5);
    ExceptionList = local_c;
    return 0;
  }
  if (param_2 == 0x2b636667) {
    FUN_1002a5b0(*(int *)(param_1 + 0x4034),&DAT_1004d26f,(char *)this);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x20;
    pbVar5 = (byte *)(param_1 + 0x4000);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"LOBBY_IDENT");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    iVar25 = 0x3c;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"PINGTIME");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    iVar26 = 0x1e;
    *(int *)(param_1 + 0x2cc550) = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"PINGWAIT");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    iVar26 = 0;
    *(int *)(param_1 + 0x2cc554) = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"TIMEMAXM");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    iVar26 = 0;
    *(int *)(param_1 + 0x2cc558) = iVar25 * 60000;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"TIMEIDLE");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    iVar26 = 0x9c4;
    *(int *)(param_1 + 0x2cc55c) = iVar25 * 60000;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"TIMEPOPL");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    *(int *)(param_1 + 0x2cc560) = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"TIMEPOPLROOM");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    iVar26 = 0x40;
    *(int *)(param_1 + 0x2cc564) = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"TIMEPOPLMAX");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    iVar26 = 0;
    *(int *)(param_1 + 0x2cc568) = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"FORCE_LOCAL");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    pbVar29 = &DAT_1004e8c8;
    iVar26 = 0x10;
    pbVar5 = (byte *)(param_1 + 0x2cc570);
    *(int *)(param_1 + 0x2cc56c) = iVar25;
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"MESG_ECHO");
    FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x80;
    pbVar5 = (byte *)(param_1 + 0x2cc698);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"CHEAT_PAT");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x200;
    pbVar5 = (byte *)(param_1 + 0x2cc718);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"CHEAT_HIT");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x100;
    pbVar5 = (byte *)(param_1 + 0x2cc918);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"GFIDS");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    iVar25 = 0;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"AUTH_ENTITLEMENT_MASK");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    pbVar29 = &DAT_1004d26f;
    *(int *)(param_1 + 0x2cd0f8) = iVar25;
    iVar25 = 0x10;
    pbVar5 = (byte *)(param_1 + 0x2cc580);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"MESG_ECHO");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    iVar25 = 0x20;
    pbVar5 = (byte *)(param_1 + 0x2cccc4);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"SECRET");
    pbVar5 = FUN_10002c10((char *)pbVar4,pbVar5,iVar25);
    *(bool *)(param_1 + 0x2ccce4) = 0 < (int)pbVar5;
    if (0 < (int)pbVar5) {
      FUN_10023510();
    }
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x400;
    pbVar5 = (byte *)(param_1 + 0x2cccf5);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"ADMIN_LIST");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    iVar25 = 1000;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"KOTH_LIST_SIZE");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    iVar26 = 600;
    *(int *)(param_1 + 0x2cccf0) = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"KOTH_TIME_BETWEEN_UPDATES_SEC");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    iVar26 = 5;
    *(int *)(param_1 + 0x2ccce8) = iVar25 * 1000;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"KOTH_NUMBER_TO_SEND");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    iVar26 = 0;
    *(int *)(param_1 + 0x2cccec) = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"KOTH_ACTIVE");
    iVar25 = FUN_10002480((char *)pbVar5,iVar26);
    fVar31 = 0.0;
    *(bool *)(param_1 + 0x2cccf4) = iVar25 != 0;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"GAME_SEARCH_MIN_AVG_RANK");
    fVar23 = FUN_100035a0(pbVar5,fVar31);
    *(float *)(param_1 + 0x2cd5a8) = (float)fVar23;
    uVar30 = (uint)*(byte *)(param_1 + 0x2cd5b0);
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"ENABLE_GAME_ADDR_FIXUPS");
    iVar25 = FUN_10002480((char *)pbVar5,uVar30);
    pbVar29 = &DAT_1004d26f;
    iVar26 = 0x400;
    pbVar5 = local_c0c;
    *(bool *)(param_1 + 0x2cd5b0) = iVar25 != 0;
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"CUSTCMDS");
    FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
    *(undefined4 *)(param_1 + 0x3800) = 0;
    if (local_c0c[0] != 0) {
      iVar25 = 0;
      FUN_10003680(local_c0c,local_eb4,0x40,&DAT_1004d26f,0,0x3a);
      if (local_eb4[0] != 0) {
        plVar18 = (long *)(param_1 + 0x3804);
        do {
          FUN_10003680(local_eb4,local_e14,0x40,&DAT_1004d26f,0,0x2c);
          uVar30 = _atol((char *)local_e14);
          plVar18[-1] = uVar30 ^ 0x20202020;
          FUN_10003680(local_eb4,local_e14,0x40,&DAT_1004d26f,1,0x2c);
          lVar7 = _atol((char *)local_e14);
          iVar25 = iVar25 + 1;
          *plVar18 = lVar7;
          plVar18 = plVar18 + 2;
          FUN_10003680(local_c0c,local_eb4,0x40,&DAT_1004d26f,iVar25,0x3a);
        } while (local_eb4[0] != 0);
      }
      *(undefined4 *)(param_1 + 0x3800 + iVar25 * 8) = 0;
    }
    FUN_100140a0(*(undefined4 **)(param_1 + 0x4020),param_1);
    FUN_10016490(0x400000);
    ExceptionList = local_c;
    return 0;
  }
  if (param_2 == 0x2b636174) {
    iVar25 = -1;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"IDENT");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    iVar26 = -1;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"CATEGORY_ID");
    uVar30 = FUN_10002480((char *)pbVar5,iVar26);
    if (uVar30 == 0xffffffff) {
      pvVar8 = (void *)FUN_100261a0(*(int *)(param_1 + 0x40dc),iVar25);
      if (pvVar8 != (void *)0x0) {
        FUN_10022bf0(*(int **)(param_1 + 0x40d8),*(int *)((int)pvVar8 + 8));
        FUN_10026fa0((int)pvVar8);
        _free(pvVar8);
      }
    }
    else {
      pvVar8 = (void *)FUN_100276f0(*(int *)(param_1 + 0x40d8),uVar30);
      if (pvVar8 == (void *)0x0) {
        this_00 = operator_new(0x294);
        if (this_00 == (void *)0x0) {
          pvVar8 = (void *)0x0;
        }
        else {
          local_4 = pvVar8;
          pvVar8 = (void *)FUN_10026e80(this_00,*(undefined4 *)(param_1 + 0x2ccca4));
        }
        local_4 = (void *)0xffffffff;
        FUN_10022b00(*(int **)(param_1 + 0x40d8),uVar30,(int)pvVar8);
        FUN_10026030(*(int **)(param_1 + 0x40dc),iVar25,pvVar8);
        FUN_10027010(pvVar8,uVar30,(byte *)this);
      }
      else {
        FUN_100260e0(*(int *)(param_1 + 0x40dc),iVar25);
        FUN_10027010(pvVar8,uVar30,(byte *)this);
      }
    }
    iVar25 = FUN_10022980(*(undefined4 **)(param_1 + 0x40d8));
    if (iVar25 != *(int *)(param_1 + 0x40e4)) {
      _free(*(void **)(param_1 + 0x40e0));
      iVar25 = FUN_10022980(*(undefined4 **)(param_1 + 0x40d8));
      *(int *)(param_1 + 0x40e4) = iVar25;
      pvVar8 = _malloc(iVar25 << 2);
      *(void **)(param_1 + 0x40e0) = pvVar8;
    }
    FUN_10022c50(*(int *)(param_1 + 0x40d8));
    iVar25 = FUN_10022c60(*(int *)(param_1 + 0x40d8),(undefined4 *)0x0);
    if (iVar25 != 0) {
      iVar26 = 0;
      do {
        *(int *)(iVar26 + *(int *)(param_1 + 0x40e0)) = iVar25;
        iVar26 = iVar26 + 4;
        iVar25 = FUN_10022c60(*(int *)(param_1 + 0x40d8),(undefined4 *)0x0);
      } while (iVar25 != 0);
    }
    _qsort(*(void **)(param_1 + 0x40e0),*(size_t *)(param_1 + 0x40e4),4,
           (_PtFuncCompare *)&LAB_10027720);
    ExceptionList = local_c;
    return 1;
  }
  if (param_2 == 0x2b737677) {
    puVar6 = (undefined4 *)_malloc(0x214fc);
    pvVar8 = operator_new(0x10);
    local_4 = (void *)0x1;
    if (pvVar8 == (void *)0x0) {
      piVar9 = (int *)0x0;
    }
    else {
      piVar9 = FUN_100236d0(pvVar8,0x400,0x80);
    }
    local_4 = (void *)0xffffffff;
    puVar6[0x853e] = piVar9;
    FUN_10022630((byte *)this,puVar6);
    FUN_10023b40(puVar6 + 0x10a9,(char *)(puVar6 + 0x1021),&LAB_10007e50,param_1);
    FUN_100229d0(this_01,*(int **)(param_1 + 0x4364),(byte *)(puVar6 + 1),(int)puVar6);
    ExceptionList = local_c;
    return 0;
  }
  if (param_2 == 0x2b726f6d) {
    iVar25 = 0;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"IDENT");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    piVar9 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),iVar25);
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004d8c8);
    if (pbVar5 != (byte *)0x0) {
      if (piVar9 == (int *)0x0) {
        piVar9 = (int *)_malloc(0x1d4);
        piVar19 = piVar9;
        for (iVar26 = 0x75; iVar26 != 0; iVar26 = iVar26 + -1) {
          *piVar19 = 0;
          piVar19 = piVar19 + 1;
        }
        puVar6 = FUN_10025f60(10,100,0,0);
        piVar9[0x46] = (int)puVar6;
        puVar6 = FUN_10025f60(10,100,0,0);
        pbVar29 = (byte *)0x0;
        iVar26 = 0x24;
        piVar9[0x47] = (int)puVar6;
        *piVar9 = iVar25;
        pbVar5 = (byte *)(piVar9 + 2);
        pbVar4 = FUN_100020f0((byte *)this,&DAT_1004d8c8);
        FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
        FUN_100229d0(this_02,*(int **)(param_1 + 0x40e8),(byte *)(piVar9 + 2),(int)piVar9);
        FUN_10026030(*(int **)(param_1 + 0x40ec),*piVar9,piVar9);
        FUN_10026030(*(int **)(param_1 + 0x40f0),*piVar9,piVar9);
      }
      else {
        FUN_100260e0(*(int *)(param_1 + 0x40ec),*piVar9);
      }
      pbVar29 = (byte *)0x0;
      iVar25 = 0x10;
      pbVar5 = (byte *)(piVar9 + 0x14);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e7a4);
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
      pbVar29 = (byte *)0x0;
      iVar25 = 0x24;
      pbVar5 = (byte *)(piVar9 + 0xb);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e79c);
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
      pbVar29 = (byte *)0x0;
      iVar25 = 0x84;
      pbVar5 = (byte *)(piVar9 + 0x21);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004df70);
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
      pbVar29 = (byte *)0x0;
      iVar25 = 0x10;
      pbVar5 = (byte *)(piVar9 + 0x18);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e794);
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
      pbVar29 = (byte *)0x0;
      iVar25 = 0x14;
      pbVar5 = (byte *)(piVar9 + 0x1c);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e5a0);
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
      pbVar29 = &DAT_1004d26f;
      iVar25 = 0x80;
      pbVar5 = (byte *)(piVar9 + 0x48);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e78c);
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
      uVar30 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004dca4);
      uVar10 = FUN_10002930(pbVar5,uVar30);
      uVar30 = piVar9[1];
      piVar9[0x6a] = uVar10;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"FLAGS");
      uVar30 = FUN_100025a0((char *)pbVar5,uVar30);
      iVar25 = piVar9[0x42];
      piVar9[1] = uVar30;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"LIMIT");
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      pbVar4 = &DAT_1004e4d4;
      piVar9[0x42] = iVar25;
      iVar25 = 0x24;
      puVar11 = (uint *)(piVar9 + 0x6b);
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e784);
      FUN_10002fe0(pbVar5,puVar11,iVar25,pbVar4);
      iVar25 = -1;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"CATEGORY");
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      piVar9[0x69] = iVar25;
      ExceptionList = local_c;
      return 1;
    }
    if (piVar9 == (int *)0x0) {
      ExceptionList = local_c;
      return 1;
    }
    FUN_100261a0(*(int *)(param_1 + 0x40f0),*piVar9);
    FUN_100261a0(*(int *)(param_1 + 0x40ec),*piVar9);
    FUN_10022a90(this_03,*(int **)(param_1 + 0x40e8),(byte *)(piVar9 + 2));
    FUN_10026000((void *)piVar9[0x46]);
    FUN_10026000((void *)piVar9[0x47]);
    _free(piVar9);
    ExceptionList = local_c;
    return 1;
  }
  if (param_2 == 0x2b757374) {
    iVar25 = 0;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"IDENT");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    puVar11 = (uint *)FUN_10026280(*(int *)(param_1 + 0x4118),iVar25);
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e774);
    if (pbVar5 == (byte *)0x0) {
      if (puVar11 == (uint *)0x0) {
        ExceptionList = local_c;
        return 1;
      }
      FUN_100261a0(*(int *)(param_1 + 0x4118),*puVar11);
      FUN_10022a90(*(void **)(param_1 + 0x4114),(int *)*(void **)(param_1 + 0x4114),
                   (byte *)(puVar11 + 9));
      FUN_100256b0(puVar11);
      ExceptionList = local_c;
      return 1;
    }
    if (puVar11 != (uint *)0x0) {
      FUN_100260e0(*(int *)(param_1 + 0x4118),*puVar11);
      FUN_10025dc0((byte *)this,&DAT_1004e774,puVar11);
      ExceptionList = local_c;
      return 1;
    }
    iVar25 = 0;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e76c);
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    puVar11 = FUN_10025650(iVar25);
    FUN_10025dc0((byte *)this,&DAT_1004e774,puVar11);
    FUN_100229d0(*(void **)(param_1 + 0x4114),(int *)*(void **)(param_1 + 0x4114),
                 (byte *)(puVar11 + 9),(int)puVar11);
    FUN_10026030(*(int **)(param_1 + 0x4118),*puVar11,puVar11);
    ExceptionList = local_c;
    return 1;
  }
  if (param_2 == 0x2b757372) {
    iVar25 = 0;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"IDENT");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    piVar9 = (int *)FUN_10026280(*(int *)(param_1 + 0x40fc),iVar25);
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004d8c8);
    if (pbVar5 == (byte *)0x0) {
      if (piVar9 == (int *)0x0) {
        ExceptionList = local_c;
        return 1;
      }
      if ((piVar9[0xc] != 0) &&
         (piVar19 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),piVar9[0xc]),
         piVar19 != (int *)0x0)) {
        FUN_100261a0(piVar19[0x46],*piVar9);
        iVar25 = FUN_100262c0(piVar19[0x46]);
        piVar19[0x43] = iVar25;
        if (piVar9[0xd] != 0) {
          piVar19[0x44] = piVar19[0x44] + -1;
        }
        FUN_100260e0(*(int *)(param_1 + 0x40f0),*piVar19);
      }
      FUN_10025b80(*(int *)(param_1 + 0x4118),*(int **)(param_1 + 0x4114),piVar9);
      FUN_100261a0(*(int *)(param_1 + 0x40fc),*piVar9);
      FUN_10022a90(*(void **)(param_1 + 0x40f8),(int *)*(void **)(param_1 + 0x40f8),
                   (byte *)(piVar9 + 8));
      FUN_10022a90(this_05,*(int **)(param_1 + 0x40f4),(byte *)(piVar9 + 3));
      _free(piVar9);
      ExceptionList = local_c;
      return 1;
    }
    iVar26 = 0;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004db40);
    uVar30 = FUN_10002480((char *)pbVar5,iVar26);
    uVar30 = FUN_10014370(*(int *)(param_1 + 0x4020),uVar30);
    if (uVar30 == 0) {
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004db40);
      if (pbVar5 != (byte *)0x0) {
        uVar10 = 0;
        pbVar5 = FUN_100020f0((byte *)this,&DAT_1004db60);
        uVar10 = FUN_10002780(pbVar5,uVar10);
        if (uVar10 != 0) {
          FUN_10022490(*(undefined4 **)(param_1 + 0x4024),0x5445524d,iVar25,"",(char *)0xffffffff);
          *(int *)(param_1 + 0x2cc5a8) = *(int *)(param_1 + 0x2cc5a8) + 1;
          ExceptionList = local_c;
          return 1;
        }
      }
    }
    else {
      iVar26 = *(int *)(uVar30 + 0x94);
      *(int *)(iVar26 + 0xa34) = iVar25;
      if (*(int *)(iVar26 + 0xa14) == 0) {
        *(undefined4 *)(iVar26 + 0xa14) = *(undefined4 *)(param_1 + 0x403c);
      }
    }
    if (piVar9 == (int *)0x0) {
      piVar9 = (int *)_malloc(0x474);
      pbVar5 = (byte *)0x0;
      piVar19 = piVar9;
      for (iVar26 = 0x11d; iVar26 != 0; iVar26 = iVar26 + -1) {
        *piVar19 = 0;
        piVar19 = piVar19 + 1;
      }
      iVar26 = 0x14;
      *piVar9 = iVar25;
      pbVar4 = (byte *)(piVar9 + 3);
      pbVar29 = FUN_100020f0((byte *)this,&DAT_1004d8c8);
      FUN_10002a30(pbVar29,pbVar4,iVar26,pbVar5);
      pbVar29 = (byte *)0x0;
      iVar26 = 0x10;
      pbVar5 = (byte *)(piVar9 + 8);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004d8d8);
      FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
      FUN_100229d0(this_04,*(int **)(param_1 + 0x40f4),(byte *)(piVar9 + 3),(int)piVar9);
      FUN_100229d0(*(void **)(param_1 + 0x40f8),(int *)*(void **)(param_1 + 0x40f8),
                   (byte *)(piVar9 + 8),(int)piVar9);
      FUN_10026030(*(int **)(param_1 + 0x40fc),iVar25,piVar9);
    }
    else {
      FUN_100260e0(*(int *)(param_1 + 0x40fc),*piVar9);
    }
    iVar25 = piVar9[0xc];
    piVar19 = (int *)0x0;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e764);
    iVar26 = FUN_10002480((char *)pbVar5,iVar25);
    iVar25 = piVar9[0xc];
    if (iVar26 == iVar25) {
      if ((iVar25 != 0) &&
         (piVar19 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),iVar25), piVar19 != (int *)0x0))
      {
        FUN_100260e0(piVar19[0x46],*piVar9);
      }
    }
    else {
      if ((iVar25 != 0) &&
         (piVar19 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),iVar25), piVar19 != (int *)0x0))
      {
        FUN_100261a0(piVar19[0x46],*piVar9);
        iVar25 = FUN_100262c0(piVar19[0x46]);
        piVar19[0x43] = iVar25;
        if (piVar9[0xd] != 0) {
          piVar19[0x44] = piVar19[0x44] + -1;
        }
        FUN_100260e0(*(int *)(param_1 + 0x40f0),*piVar19);
      }
      if ((iVar26 != 0) &&
         (piVar19 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),iVar26), piVar19 != (int *)0x0))
      {
        FUN_10026030((int *)piVar19[0x46],*piVar9,piVar9);
        iVar25 = FUN_100262c0(piVar19[0x46]);
        piVar19[0x43] = iVar25;
        if (piVar9[0xd] != 0) {
          piVar19[0x44] = piVar19[0x44] + 1;
        }
        FUN_100260e0(*(int *)(param_1 + 0x40f0),*piVar19);
      }
      if ((uVar30 != 0) && (iVar26 == 0)) {
        if (*(int *)(param_1 + 0x2cc560) <
            *(int *)(*(int *)(uVar30 + 0x94) + 0x2c) - *(int *)(param_1 + 0x403c)) {
          *(int *)(*(int *)(uVar30 + 0x94) + 0x2c) =
               *(int *)(param_1 + 0x403c) + *(int *)(param_1 + 0x2cc560);
        }
      }
      piVar9[0xc] = iVar26;
    }
    iVar25 = piVar9[0xd];
    iVar26 = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e75c);
    iVar12 = FUN_10002480((char *)pbVar5,iVar26);
    bVar21 = iVar25 != iVar12;
    piVar9[0xd] = iVar12;
    iVar26 = piVar9[0xc];
    if (iVar26 != 0) {
      if (iVar12 == 0) {
        if (iVar25 == 0) goto LAB_1000ccaf;
        if ((piVar19 == (int *)0x0) || (*piVar19 != iVar26)) {
          piVar19 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),iVar26);
        }
        iVar25 = piVar19[0x44] + -1;
      }
      else {
        if (iVar25 != 0) goto LAB_1000ccaf;
        if ((piVar19 == (int *)0x0) || (*piVar19 != iVar26)) {
          piVar19 = (int *)FUN_10026280(*(int *)(param_1 + 0x40ec),iVar26);
        }
        iVar25 = piVar19[0x44] + 1;
      }
      piVar19[0x44] = iVar25;
      FUN_100260e0(*(int *)(param_1 + 0x40f0),*piVar19);
    }
LAB_1000ccaf:
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0xc4;
    pbVar5 = (byte *)(piVar9 + 0x34);
    pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e754);
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    if ((piVar9[0x86] & 0x80000U) == 0) {
      pbVar29 = &DAT_1004d26f;
      iVar25 = 0x84;
      pbVar5 = (byte *)(piVar9 + 0x65);
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e750);
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    }
    else {
      pbVar5 = (byte *)(piVar9 + 0x65);
      pbVar4 = pbVar5;
      do {
        bVar1 = *pbVar4;
        pbVar4[(int)(local_d94 + -(int)pbVar5)] = bVar1;
        pbVar4 = pbVar4 + 1;
      } while (bVar1 != 0);
      pbVar32 = &DAT_1004d26f;
      iVar25 = 0x84;
      pbVar4 = pbVar5;
      pbVar29 = FUN_100020f0((byte *)this,&DAT_1004e750);
      FUN_10002a30(pbVar29,pbVar4,iVar25,pbVar32);
      pbVar4 = local_d94;
      do {
        bVar1 = *pbVar4;
        bVar22 = bVar1 < *pbVar5;
        if (bVar1 != *pbVar5) {
LAB_1000cd59:
          iVar25 = (1 - (uint)bVar22) - (uint)(bVar22 != 0);
          goto LAB_1000cd5e;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar4[1];
        bVar22 = bVar1 < pbVar5[1];
        if (bVar1 != pbVar5[1]) goto LAB_1000cd59;
        pbVar4 = pbVar4 + 2;
        pbVar5 = pbVar5 + 2;
      } while (bVar1 != 0);
      iVar25 = 0;
LAB_1000cd5e:
      if (iVar25 != 0) {
        bVar21 = true;
      }
    }
    iVar25 = piVar9[0x86];
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"AUXFL");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    pbVar29 = &DAT_1004d26f;
    iVar26 = 0x10;
    pbVar5 = (byte *)(piVar9 + 8);
    piVar9[0x86] = iVar25;
    pbVar4 = FUN_100020f0((byte *)this,&DAT_1004d8d8);
    FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
    iVar25 = piVar9[0xb1];
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e744);
    iVar26 = FUN_10002480((char *)pbVar5,iVar25);
    iVar25 = piVar9[0xc5];
    piVar9[0xb1] = iVar26;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"_LEVEL");
    iVar26 = FUN_10002480((char *)pbVar5,iVar25);
    iVar25 = piVar9[0xc6];
    piVar9[0xc5] = iVar26;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"MEDALS");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    piVar9[0xc6] = iVar25;
    uVar10 = piVar9[0xb4];
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004db60);
    uVar13 = FUN_10002780(pbVar5,uVar10);
    uVar10 = piVar9[0xb5];
    piVar9[0xb4] = uVar13;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"LADDR");
    uVar13 = FUN_10002780(pbVar5,uVar10);
    uVar10 = piVar9[0xb6];
    piVar9[0xb5] = uVar13;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e96c);
    uVar10 = FUN_10002780(pbVar5,uVar10);
    piVar9[0xb6] = uVar10;
    iVar25 = piVar9[0xb7];
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e724);
    iVar26 = FUN_10002480((char *)pbVar5,iVar25);
    iVar25 = piVar9[0xb0];
    piVar9[0xb7] = iVar26;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e71c);
    iVar26 = FUN_10002480((char *)pbVar5,iVar25);
    iVar25 = piVar9[0xb3];
    piVar9[0xb0] = iVar26;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e714);
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    piVar9[0xb3] = iVar25;
    iVar25 = piVar9[0x10c];
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e70c);
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    piVar9[0x10c] = iVar25;
    uVar10 = piVar9[2];
    uVar13 = uVar10;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"FLAGS");
    uVar13 = FUN_100025a0((char *)pbVar5,uVar13);
    piVar9[2] = uVar13;
    if ((uVar30 != 0) && (((uVar10 ^ uVar13) & 0x2000000) != 0)) {
      FUN_10014630(uVar30,(byte)(uVar13 >> 0x19) & 1);
    }
    if (uVar10 != piVar9[2]) {
      bVar21 = true;
    }
    if (((((char)uVar10 < '\0') && (-1 < (char)piVar9[2])) && (uVar30 != 0)) &&
       (*(int *)(param_1 + 0x2cc55c) != 0)) {
      *(int *)(*(int *)(uVar30 + 0x94) + 0xab8) =
           *(int *)(param_1 + 0x403c) + *(int *)(param_1 + 0x2cc55c);
    }
    iVar25 = piVar9[1];
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e704);
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    pbVar29 = &DAT_1004d26f;
    iVar26 = 0x20;
    pbVar5 = (byte *)(piVar9 + 0xb9);
    piVar9[1] = iVar25;
    pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e700);
    FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x40;
    pbVar5 = (byte *)(piVar9 + 0x87);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"MADDR");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x40;
    pbVar5 = (byte *)(piVar9 + 0xa0);
    pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e6f0);
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    iVar25 = piVar9[0xc1];
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"GFIDS");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    pbVar4 = &DAT_1004e4d4;
    piVar9[0xc1] = iVar25;
    iVar25 = 0x24;
    puVar11 = (uint *)(piVar9 + 0xef);
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e784);
    FUN_10002fe0(pbVar5,puVar11,iVar25,pbVar4);
    uVar30 = piVar9[0xc4];
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e6e8);
    uVar30 = FUN_100025a0((char *)pbVar5,uVar30);
    iVar25 = piVar9[0xc2];
    piVar9[0xc4] = uVar30;
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"HWFLAG");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    piVar9[0xc2] = iVar25;
    iVar25 = piVar9[0xc3];
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"HWMASK");
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    uVar30 = 0;
    piVar9[0xc3] = iVar25;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004dca4);
    uVar30 = FUN_10002930(pbVar5,uVar30);
    iVar25 = 0;
    piVar9[0x10a] = uVar30;
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e70c);
    iVar25 = FUN_10002480((char *)pbVar5,iVar25);
    pbVar29 = &DAT_1004d26f;
    iVar26 = 0x24;
    pbVar5 = (byte *)(piVar9 + 0x97);
    piVar9[0x10c] = iVar25;
    pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e6d4);
    FUN_10002a30(pbVar4,pbVar5,iVar26,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 0x14;
    pbVar5 = (byte *)(piVar9 + 0x10d);
    pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e6cc);
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    pbVar29 = &DAT_1004d26f;
    iVar25 = 8;
    pbVar5 = (byte *)(piVar9 + 0x112);
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"_CTAG");
    FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
    puVar11 = (uint *)(piVar9 + 199);
    local_ed4 = *puVar11;
    local_ed0 = piVar9[200];
    pbVar4 = &DAT_1004e4d4;
    iVar25 = 0x10;
    local_ecc = piVar9[0xc9];
    local_ec8 = piVar9[0xca];
    pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e6bc);
    FUN_10002fe0(pbVar5,puVar11,iVar25,pbVar4);
    FUN_100258f0(*(int *)(param_1 + 0x4118),(int)&local_ed4,piVar9,bVar21);
    ExceptionList = local_c;
    return 1;
  }
  if (param_2 != 0x2b67616d) {
    if (param_2 == 0x2b677374) {
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"IDENT");
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      piVar9 = (int *)FUN_10026280(*(int *)(param_1 + 0x4110),iVar25);
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e6b4);
      if (pbVar5 != (byte *)0x0) {
        if (piVar9 == (int *)0x0) {
          piVar9 = (int *)_malloc(0x100c);
          *piVar9 = iVar25;
          FUN_10026030(*(int **)(param_1 + 0x4110),iVar25,piVar9);
        }
        else {
          FUN_100260e0(*(int *)(param_1 + 0x4110),iVar25);
        }
        *piVar9 = iVar25;
        iVar25 = FUN_10003320((char *)pbVar5,0);
        piVar9[2] = iVar25;
        FUN_100020b0((char *)(piVar9 + 3),0x1000,(char *)this);
        ExceptionList = local_c;
        return 0;
      }
      FUN_100261a0(*(int *)(param_1 + 0x4110),iVar25);
      if (piVar9 == (int *)0x0) {
        ExceptionList = local_c;
        return 0;
      }
      _free(piVar9);
      ExceptionList = local_c;
      return 0;
    }
    if (param_2 == 0x2b766172) {
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004d950);
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      if (0x8f < iVar25) {
        ExceptionList = local_c;
        return 0;
      }
      FUN_1000a090(param_1,(byte *)this,(short)iVar25);
      ExceptionList = local_c;
      return 0;
    }
    if (param_2 == 0x2b726b61) {
      FUN_1000a580(param_1);
      ExceptionList = local_c;
      return 0;
    }
    if (param_2 == 0x2b726e6b) {
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004d950);
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      iVar26 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e6b0);
      uVar30 = FUN_10002480((char *)pbVar5,iVar26);
      iVar26 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e6ac);
      iVar26 = FUN_10002480((char *)pbVar5,iVar26);
      pbVar29 = &DAT_1004d26f;
      iVar12 = 0x10;
      pbVar5 = local_ec4;
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004d8c8);
      FUN_10002a30(pbVar4,pbVar5,iVar12,pbVar29);
      pbVar29 = &DAT_1004d26f;
      iVar12 = 0x800;
      pbVar5 = local_80c;
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e754);
      FUN_10002a30(pbVar4,pbVar5,iVar12,pbVar29);
      if (iVar26 == 1) {
        FUN_10021020(*(int **)(param_1 + 0x4120 + iVar25 * 4));
        ExceptionList = local_c;
        return 0;
      }
      FUN_10021150(*(int **)(param_1 + 0x4120 + iVar25 * 4),uVar30,local_ec4,(int *)local_80c);
      ExceptionList = local_c;
      return 0;
    }
    if (param_2 == 0x2b6d7367) {
      uVar30 = 0;
      puVar20 = (uint *)((*(uint *)(param_1 + 0x4368) % *(uint *)(param_1 + 0x436c)) * 0x478 +
                         0x4370 + param_1);
      *puVar20 = *(uint *)(param_1 + 0x4368);
      puVar20[0x11b] = 1;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"FLAGS");
      uVar30 = FUN_100025a0((char *)pbVar5,uVar30);
      iVar25 = 0;
      puVar20[0x116] = uVar30;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e6a4);
      uVar30 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = 0;
      puVar20[0x117] = uVar30;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e774);
      uVar30 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = 0;
      puVar20[0x119] = uVar30;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e75c);
      uVar30 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = 0;
      puVar20[0x11a] = uVar30;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e764);
      uVar30 = FUN_10002480((char *)pbVar5,iVar25);
      pbVar4 = &DAT_1004d26f;
      iVar25 = 0x10;
      puVar11 = puVar20 + 1;
      puVar20[0x118] = uVar30;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004d8c8);
      FUN_10002a30(pbVar5,(byte *)puVar11,iVar25,pbVar4);
      pbVar4 = &DAT_1004d26f;
      iVar25 = 0x404;
      puVar11 = puVar20 + 5;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e69c);
      FUN_10002a30(pbVar5,(byte *)puVar11,iVar25,pbVar4);
      pbVar4 = &DAT_1004d26f;
      iVar25 = 0x3f;
      puVar20 = puVar20 + 0x106;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e6f0);
      FUN_10002a30(pbVar5,(byte *)puVar20,iVar25,pbVar4);
      *(int *)(param_1 + 0x4368) = *(int *)(param_1 + 0x4368) + 1;
      ExceptionList = local_c;
      return 1;
    }
    if (param_2 == 0x2b617379) {
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004df60);
      uVar30 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e694);
      uVar10 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e68c);
      uVar13 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e684);
      uVar14 = FUN_10002480((char *)pbVar5,iVar25);
      pbVar5 = &DAT_1004d26f;
      iVar25 = 0x104;
      if (uVar30 == 2) {
        pbVar4 = local_d10;
        pbVar29 = FUN_100020f0((byte *)this,&DAT_1004e67c);
        FUN_10002a30(pbVar29,pbVar4,iVar25,pbVar5);
        FUN_10023510();
        ExceptionList = local_c;
        return 0;
      }
      uVar3 = *(uint *)(param_1 + 0x240370);
      puVar11 = (uint *)((uVar3 % *(uint *)(param_1 + 0x240374)) * 0x118 + 0x240378 + param_1);
      puVar11[0x44] = uVar30;
      *puVar11 = uVar3;
      puVar11[0x45] = -(uint)(uVar30 != 0) & uVar10;
      puVar11[1] = uVar13;
      puVar11[2] = uVar14;
      puVar11 = puVar11 + 3;
      pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e67c);
      FUN_10002a30(pbVar4,(byte *)puVar11,iVar25,pbVar5);
      *(int *)(param_1 + 0x240370) = *(int *)(param_1 + 0x240370) + 1;
      ExceptionList = local_c;
      return 1;
    }
    if (param_2 == 0x2b657874) {
      FUN_100232a0(*(int **)(param_1 + 0x2cc694),(byte *)this,0,*(undefined4 *)(param_1 + 0x403c));
      ExceptionList = local_c;
      return 0;
    }
    if (param_2 == 0x2b73796e) {
      if (0 < *(int *)(param_1 + 0x2cc378)) {
        ExceptionList = local_c;
        return 0;
      }
      pbVar29 = &DAT_1004d26f;
      iVar25 = 0x80;
      pbVar5 = (byte *)(param_1 + 0x2ccc18);
      pbVar4 = FUN_100020f0((byte *)this,(byte *)"CONTEXT");
      FUN_10002a30(pbVar4,pbVar5,iVar25,pbVar29);
      pbVar5 = (byte *)(param_1 + 0x2cca18);
      FUN_100020b0((char *)pbVar5,0x200,(char *)(param_1 + 0x2ccc18));
      FUN_10003cf0(pbVar5,0x200,&DAT_1004dcb8,(byte *)(param_1 + 0x2cc38c));
      uVar30 = FUN_10022130(*(int *)(param_1 + 0x4044),0x706f7274);
      uVar10 = FUN_100141d0(*(int *)(param_1 + 0x4020),0x706f7274);
      _sprintf((char *)local_dd4,"slav/%d/%d",uVar10,uVar30);
      FUN_10003cf0(pbVar5,0x200,&DAT_1004df70,local_dd4);
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"APORT");
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      uVar28 = (u_short)iVar25;
      uVar30 = 0x7f000001;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"AADDR");
      uVar30 = FUN_10002780(pbVar5,uVar30);
      FUN_100221c0(*(int *)(param_1 + 0x4028),uVar30,uVar28);
      uVar30 = 0;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"CADDR");
      uVar30 = FUN_10002780(pbVar5,uVar30);
      iVar25 = 0;
      pbVar5 = FUN_100020f0((byte *)this,(byte *)"CPORT");
      FUN_10002480((char *)pbVar5,iVar25);
      if (uVar30 != 0) {
        pcVar27 = FUN_1000a8e0;
        uVar24 = 0x10000;
        iVar25 = param_1;
        uVar15 = FUN_10022980(*(undefined4 **)(param_1 + 0x4020));
        puVar6 = FUN_10022030(uVar15,uVar24,pcVar27,iVar25);
        iVar25 = 0;
        *(undefined4 **)(param_1 + 0x4030) = puVar6;
        pbVar5 = FUN_100020f0((byte *)this,(byte *)"CPORT");
        iVar25 = FUN_10002480((char *)pbVar5,iVar25);
        uVar28 = (u_short)iVar25;
        uVar30 = 0x7f000001;
        pbVar5 = FUN_100020f0((byte *)this,(byte *)"CADDR");
        uVar30 = FUN_10002780(pbVar5,uVar30);
        FUN_100221c0(*(int *)(param_1 + 0x4030),uVar30,uVar28);
      }
      *(undefined4 *)(param_1 + 0x2cc378) = 1;
      FUN_10008010(0,0,param_1);
      ExceptionList = local_c;
      return 0;
    }
    if (param_2 == 0x2b736874) {
      FUN_100141b0(*(int **)(param_1 + 0x4020));
      ExceptionList = local_c;
      return 0;
    }
    if (param_2 == 0x2b737374) {
      iVar25 = *(int *)(param_1 + 0x2ccca8);
      *(int *)(param_1 + 0x2cccc0) = *(int *)(param_1 + 0x2cccc0) + 1;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e644);
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      *(int *)(param_1 + 0x2ccca8) = iVar25;
      iVar25 = *(int *)(param_1 + 0x2cccac);
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e640);
      iVar26 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = *(int *)(param_1 + 0x2cccb0);
      *(int *)(param_1 + 0x2cccac) = iVar26;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e63c);
      iVar26 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = *(int *)(param_1 + 0x2cccb4);
      *(int *)(param_1 + 0x2cccb0) = iVar26;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e638);
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      *(int *)(param_1 + 0x2cccb4) = iVar25;
      iVar25 = *(int *)(param_1 + 0x2cccb8);
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e634);
      iVar26 = FUN_10002480((char *)pbVar5,iVar25);
      iVar25 = *(int *)(param_1 + 0x2cccbc);
      *(int *)(param_1 + 0x2cccb8) = iVar26;
      pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e630);
      iVar25 = FUN_10002480((char *)pbVar5,iVar25);
      *(int *)(param_1 + 0x2cccbc) = iVar25;
      ExceptionList = local_c;
      return 1;
    }
    if (param_2 != 0x2b6c766c) {
      ExceptionList = local_c;
      return 0;
    }
    pbVar4 = &DAT_1004e4d4;
    iVar25 = 0x4a4;
    puVar11 = (uint *)(param_1 + 0x2cd0fc);
    pbVar5 = FUN_100020f0((byte *)this,(byte *)"THRESHOLDS");
    FUN_10002fe0(pbVar5,puVar11,iVar25,pbVar4);
    ExceptionList = local_c;
    return 0;
  }
  iVar25 = 0;
  local_ed8 = 0xffffffff;
  pbVar5 = FUN_100020f0((byte *)this,(byte *)"IDENT");
  iVar25 = FUN_10002480((char *)pbVar5,iVar25);
  puVar11 = (uint *)FUN_10026280(*(int *)(param_1 + 0x4104),iVar25);
  pbVar5 = FUN_100020f0((byte *)this,&DAT_1004e75c);
  if (pbVar5 == (byte *)0x0) {
    if (puVar11 == (uint *)0x0) {
      ExceptionList = local_c;
      return 1;
    }
    if ((puVar11[0x23] != 0) &&
       (iVar25 = FUN_10026280(*(int *)(param_1 + 0x40ec),puVar11[0x23]), iVar25 != 0)) {
      FUN_100261a0(*(int *)(iVar25 + 0x11c),*puVar11);
    }
    FUN_100261a0(*(int *)(param_1 + 0x4104),*puVar11);
    FUN_10022a90(*(void **)(param_1 + 0x4100),(int *)*(void **)(param_1 + 0x4100),
                 (byte *)(puVar11 + 0xc));
    FUN_1002a7f0(*(int **)(param_1 + 0x4108),(int)puVar11,'\0');
    if ((char)puVar11[0x56] != '\0') {
      FUN_10022a90((void *)CONCAT31((int3)((uint)extraout_ECX_00 >> 8),(char)puVar11[0x56]),
                   *(int **)(param_1 + 0x410c),(byte *)(puVar11 + 0x56));
    }
    FUN_10026c30(*(int *)(param_1 + 0x4108),(int)puVar11);
    ExceptionList = local_c;
    return 1;
  }
  if (puVar11 == (uint *)0x0) {
    local_edc = 0;
    puVar11 = (uint *)FUN_10026c10(*(undefined4 *)(param_1 + 0x4108));
    puVar20 = puVar11;
    for (iVar25 = 0x1bc; iVar25 != 0; iVar25 = iVar25 + -1) {
      *puVar20 = 0;
      puVar20 = puVar20 + 1;
    }
    FUN_10026a90((byte *)this,puVar11);
    FUN_100229d0(*(void **)(param_1 + 0x4100),(int *)*(void **)(param_1 + 0x4100),
                 (byte *)(puVar11 + 0xc),(int)puVar11);
    FUN_10026030(*(int **)(param_1 + 0x4104),*puVar11,puVar11);
    FUN_1002a740(*(int **)(param_1 + 0x4108),(int)puVar11);
    piVar9 = (int *)CONCAT31((int3)((uint)extraout_ECX >> 8),(char)puVar11[0x56]);
    puVar20 = puVar11 + 0x56;
    if ((char)puVar11[0x56] == '\0') goto LAB_1000d3ff;
    piVar19 = *(int **)(param_1 + 0x410c);
  }
  else {
    local_ed8 = puVar11[0x76];
    FUN_100260e0(*(int *)(param_1 + 0x4104),*puVar11);
    local_edc = puVar11[0x23];
    puVar20 = puVar11 + 0x56;
    if ((char)puVar11[0x56] != '\0') {
      FUN_10022a90(this_06,*(int **)(param_1 + 0x410c),(byte *)puVar20);
    }
    FUN_10026a90((byte *)this,puVar11);
    if ((byte)*puVar20 == 0) goto LAB_1000d3ff;
    piVar9 = *(int **)(param_1 + 0x410c);
    piVar19 = piVar9;
  }
  FUN_100229d0(piVar9,piVar19,(byte *)puVar20,(int)puVar11);
LAB_1000d3ff:
  uVar30 = puVar11[0x23];
  if (local_edc != uVar30) {
    if ((local_edc != 0) &&
       (iVar25 = FUN_10026280(*(int *)(param_1 + 0x40ec),local_edc), iVar25 != 0)) {
      FUN_100261a0(*(int *)(iVar25 + 0x11c),*puVar11);
    }
    if (puVar11[0x23] == 0) {
      ExceptionList = local_c;
      return 1;
    }
    iVar25 = FUN_10026280(*(int *)(param_1 + 0x40ec),puVar11[0x23]);
    if (iVar25 == 0) {
      ExceptionList = local_c;
      return 1;
    }
    FUN_10026030(*(int **)(iVar25 + 0x11c),*puVar11,puVar11);
    ExceptionList = local_c;
    return 1;
  }
  if (uVar30 == 0) {
    ExceptionList = local_c;
    return 1;
  }
  iVar25 = FUN_10026280(*(int *)(param_1 + 0x40ec),uVar30);
  if (iVar25 == 0) {
    ExceptionList = local_c;
    return 1;
  }
  if (local_ed8 == puVar11[0x76]) {
    ExceptionList = local_c;
    return 1;
  }
  FUN_100260e0(*(int *)(iVar25 + 0x11c),*puVar11);
  ExceptionList = local_c;
  return 1;
}



void __cdecl FUN_1000dd30(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *local_28;
  int local_24;
  byte local_20 [32];
  
  iVar1 = param_2;
  iVar2 = FUN_10022340(*(int *)(param_2 + 0x4024),&local_24,&param_2,&local_28);
  while (-1 < iVar2) {
    if (local_24 == -1) {
      if (param_2 == -1) {
        local_20[0] = 0;
        FUN_100024f0(local_20,0x20,(byte *)"UPDATES",0x7c28aa);
        FUN_10022490(*(undefined4 **)(iVar1 + 0x4024),0x534c4156,0,(char *)local_20,
                     (char *)0xffffffff);
        *(int *)(iVar1 + 0x2cc5b0) = *(int *)(iVar1 + 0x2cc5b0) + 1;
      }
      else {
        FUN_10022490(*(undefined4 **)(iVar1 + 0x4024),0x4e554c4c,0,(char *)0x0,(char *)0x0);
        *(int *)(iVar1 + 0x2cc5b0) = *(int *)(iVar1 + 0x2cc5b0) + 1;
      }
    }
    else {
      FUN_1000bb40(local_28,iVar1,local_24,param_2,iVar2);
    }
    FUN_100223d0(*(int *)(iVar1 + 0x4024),(undefined4 *)0x0,(undefined4 *)0x0,(undefined4 *)0x0,0);
    iVar2 = FUN_10022340(*(int *)(iVar1 + 0x4024),&local_24,&param_2,&local_28);
  }
  return;
}



void FUN_1000e430(void)

{
  byte *pbVar1;
  int unaff_ESI;
  byte local_190 [16];
  byte local_180 [256];
  byte local_80 [128];
  
  local_180[0] = 0;
  if (*(int *)(&DAT_100570cc + *(int *)(unaff_ESI + 0x19c8) * 0x18) != 0) {
    pbVar1 = FUN_100020f0((byte *)(unaff_ESI + 0x1568),&DAT_1004df18);
    FUN_10003680(pbVar1,local_190,0x10,&DAT_1004d26f,(uint)(*pbVar1 == 0x2f),0x2f);
    FUN_10005ca0((char *)local_80,0x80,
                 *(char **)(&DAT_100570cc + *(int *)(unaff_ESI + 0x19c8) * 0x18));
    FUN_10003cf0(local_180,0x100,&DAT_1004df18,local_80);
  }
  if (*(byte **)(&DAT_100570d0 + *(int *)(unaff_ESI + 0x19c8) * 0x18) != (byte *)0x0) {
    FUN_10003cf0(local_180,0x100,&DAT_1004dff4,
                 *(byte **)(&DAT_100570d0 + *(int *)(unaff_ESI + 0x19c8) * 0x18));
  }
  if (*(byte **)(&DAT_100570d4 + *(int *)(unaff_ESI + 0x19c8) * 0x18) != (byte *)0x0) {
    FUN_10003cf0(local_180,0x100,(byte *)"SUBKEY",
                 *(byte **)(&DAT_100570d4 + *(int *)(unaff_ESI + 0x19c8) * 0x18));
  }
  FUN_10002370(local_180,0x100,&DAT_1004e75c,
               (uint)(byte)(&DAT_100570d8)[*(int *)(unaff_ESI + 0x19c8) * 0x18]);
  FUN_10022490(*(undefined4 **)(unaff_ESI + 0x19b0),0x2a646d70,0,(char *)local_180,
               (char *)0xffffffff);
  return;
}



void FUN_1000e570(void)

{
  FUN_1000e430();
  return;
}



void __cdecl FUN_1000e580(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  void *this;
  code *pcVar3;
  undefined4 uVar4;
  byte local_240 [64];
  byte local_200 [512];
  
  FUN_100020b0((char *)local_200,0x200,(char *)(param_3 + 0x1568));
  FUN_10002370(local_200,0x200,(byte *)"MASTER",1);
  FUN_10003cf0(local_200,0x200,&DAT_1004dcb8,(byte *)(param_3 + 0x1428));
  uVar1 = FUN_10022130(*(int *)(param_3 + 0x19a8),0x706f7274);
  uVar2 = FUN_100141d0(*(int *)(param_3 + 0x1400),0x706f7274);
  _sprintf((char *)local_240,"mstr/%d/%d",uVar2,uVar1);
  FUN_10003cf0(local_200,0x200,&DAT_1004df70,local_240);
  FUN_10022490(*(undefined4 **)(param_3 + 0x19b0),0x2a736470,0,(char *)local_200,(char *)0xffffffff)
  ;
  uVar4 = 0;
  pcVar3 = FUN_1000e580;
  uVar1 = 10000;
  this = (void *)FUN_10022980(*(undefined4 **)(param_3 + 0x1400));
  FUN_100230b0(this,uVar1,pcVar3,uVar4,param_3);
  return;
}



void __cdecl FUN_1000e670(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  void *this;
  code *pcVar3;
  undefined4 uVar4;
  byte local_240 [64];
  byte local_200 [512];
  
  FUN_100020b0((char *)local_200,0x200,(char *)(param_3 + 0x1568));
  FUN_10002370(local_200,0x200,(byte *)"MASTER",1);
  FUN_10003cf0(local_200,0x200,&DAT_1004dcb8,(byte *)(param_3 + 0x1428));
  uVar1 = FUN_10022130(*(int *)(param_3 + 0x19a8),0x706f7274);
  uVar2 = FUN_100141d0(*(int *)(param_3 + 0x1400),0x706f7274);
  _sprintf((char *)local_240,"mstr/%d/%d",uVar2,uVar1);
  FUN_10003cf0(local_200,0x200,&DAT_1004df70,local_240);
  FUN_10022490(*(undefined4 **)(param_3 + 0x19b4),0x2a736470,0,(char *)local_200,(char *)0xffffffff)
  ;
  uVar4 = 0;
  pcVar3 = FUN_1000e670;
  uVar1 = 10000;
  this = (void *)FUN_10022980(*(undefined4 **)(param_3 + 0x1400));
  FUN_100230b0(this,uVar1,pcVar3,uVar4,param_3);
  return;
}



void __cdecl FUN_1000e760(undefined4 param_1,undefined4 param_2,int param_3)

{
  char *pcVar1;
  void *this;
  uint uVar2;
  code *pcVar3;
  undefined4 uVar4;
  byte local_100 [256];
  
  local_100[0] = 0;
  FUN_10003cf0(local_100,0x100,(byte *)"LOBBY",(byte *)(param_3 + 0x1404));
  FUN_10002370(local_100,0x100,(byte *)"ALIVE",1);
  if (*(int *)(param_3 + 0x1acc) != 0) {
    pcVar1 = (char *)(param_3 + 0x19cc);
    if (*(char *)(param_3 + 0x19cc) == '\0') {
      pcVar1 = "The server is unavailable";
    }
    FUN_10003cf0(local_100,0x100,&DAT_1004dbf4,(byte *)pcVar1);
  }
  FUN_10022490(*(undefined4 **)(param_3 + 0x19a8),0x40616c76,0,(char *)local_100,(char *)0xffffffff)
  ;
  uVar4 = 0;
  pcVar3 = FUN_1000e760;
  uVar2 = 10000;
  this = (void *)FUN_10022980(*(undefined4 **)(param_3 + 0x1400));
  FUN_100230b0(this,uVar2,pcVar3,uVar4,param_3);
  return;
}



void __cdecl FUN_1000e830(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  undefined4 local_8;
  undefined4 local_4;
  
  iVar1 = param_2;
  iVar2 = FUN_10022340(*(int *)(param_2 + 0x19a8),&local_4,&local_8,&param_2);
  while (-1 < iVar2) {
    FUN_100223d0(*(int *)(iVar1 + 0x19a8),(undefined4 *)0x0,(undefined4 *)0x0,(undefined4 *)0x0,0);
    iVar2 = FUN_10022340(*(int *)(iVar1 + 0x19a8),&local_4,&local_8,&param_2);
  }
  return;
}



void __cdecl FUN_1000e8a0(undefined4 param_1,int param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  undefined4 *puVar7;
  char *pcVar8;
  char *pcVar9;
  int local_8;
  char *local_4;
  
  iVar3 = param_2;
  iVar4 = FUN_10022340(*(int *)(param_2 + 0x19b4),&local_8,&param_2,&local_4);
  while (-1 < iVar4) {
    if (local_8 < 0) {
      uVar5 = FUN_100387a0(*(int *)(iVar3 + 0x2638),*(int **)(iVar3 + 0x2634),local_8,param_2,iVar4,
                           local_4);
      if ((((char)uVar5 == '\0') &&
          (uVar6 = FUN_10014340(*(int *)(iVar3 + 0x1400),-local_8), uVar6 != 0)) &&
         ((*(int *)(uVar6 + 0x28) != 0 && (iVar2 = *(int *)(uVar6 + 0x94), iVar2 != 0)))) {
        puVar7 = FUN_10028690(*(int **)(iVar3 + 0x2634),iVar4 + 1);
        *(undefined4 **)(iVar2 + 0x500) = puVar7;
        pcVar9 = (char *)puVar7[3];
        pcVar8 = local_4;
        do {
          cVar1 = *pcVar8;
          pcVar8 = pcVar8 + 1;
          *pcVar9 = cVar1;
          pcVar9 = pcVar9 + 1;
        } while (cVar1 != '\0');
        **(int **)(iVar2 + 0x500) = local_8;
        *(int *)(*(int *)(iVar2 + 0x500) + 4) = param_2;
        *(undefined4 *)(uVar6 + 0x30) = 0;
      }
    }
    else if (((local_8 == 0x2a736470) && (param_2 != 0)) && (*(int *)(iVar3 + 0x19bc) == 0)) {
      FUN_10016450(4);
      FUN_100141b0(*(int **)(iVar3 + 0x1400));
    }
    FUN_100223d0(*(int *)(iVar3 + 0x19b4),(undefined4 *)0x0,(undefined4 *)0x0,(undefined4 *)0x0,0);
    iVar4 = FUN_10022340(*(int *)(iVar3 + 0x19b4),&local_8,&param_2,&local_4);
  }
  return;
}



void __cdecl FUN_1000ea10(int param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int local_20;
  int local_1c;
  int local_18;
  int local_10;
  int local_c;
  int local_8;
  
  FUN_10022c50(*(int *)(param_1 + 0x1988));
  iVar1 = FUN_10022c60(*(int *)(param_1 + 0x1988),(undefined4 *)0x0);
  while (iVar1 != 0) {
    FUN_10016490(4);
    local_8 = 0;
    if (*(int *)(iVar1 + 0x10) != 0) {
      local_18 = 0;
      do {
        iVar5 = *(int *)(iVar1 + 0xc) + local_18;
        FUN_10016490(4);
        local_c = 0;
        if (*(int *)(iVar5 + 0xc) != 0) {
          local_1c = 0;
          do {
            iVar3 = *(int *)(iVar5 + 8) + local_1c;
            FUN_10016490(4);
            local_10 = 0;
            if (*(int *)(iVar3 + 0xc) != 0) {
              local_20 = 0;
              do {
                uVar2 = 0;
                iVar4 = *(int *)(iVar3 + 8) + local_20;
                FUN_10016490(4);
                if (*(short *)(iVar4 + 0xdc8) != 0) {
                  do {
                    FUN_10016490(4);
                    uVar2 = uVar2 + 1;
                  } while (uVar2 != *(ushort *)(iVar4 + 0xdc8));
                }
                local_10 = local_10 + 1;
                local_20 = local_20 + 0x1e028;
              } while (local_10 != *(int *)(iVar3 + 0xc));
            }
            local_c = local_c + 1;
            local_1c = local_1c + 0x14;
          } while (local_c != *(int *)(iVar5 + 0xc));
        }
        local_8 = local_8 + 1;
        local_18 = local_18 + 0x14;
      } while (local_8 != *(int *)(iVar1 + 0x10));
    }
    iVar1 = FUN_10022c60(*(int *)(param_1 + 0x1988),(undefined4 *)0x0);
  }
  return;
}



undefined4 __cdecl FUN_1000ebf0(byte *param_1)

{
  int iVar1;
  void *pvVar2;
  byte *pbVar3;
  byte *pbVar4;
  uint uVar5;
  int iVar6;
  int unaff_EBX;
  int iVar7;
  undefined4 *puVar8;
  byte *pbVar9;
  byte local_20 [32];
  
  if ((*(int *)(unaff_EBX + 0x20) != 1) && (*(int *)(unaff_EBX + 0x20) != 5)) {
    FUN_10016450(4);
    return 0;
  }
  iVar1 = *(int *)(unaff_EBX + 0xc);
  iVar6 = *(int *)(iVar1 + 0x14);
  if (*(int *)(iVar1 + 0x10) == iVar6) {
    iVar7 = 2;
    if (iVar6 != 0) {
      iVar7 = iVar6 * 2;
    }
    pvVar2 = _realloc(*(void **)(iVar1 + 0xc),iVar7 * 0x14);
    if (pvVar2 == (void *)0x0) {
      FUN_10016450(4);
      return 0;
    }
    puVar8 = (undefined4 *)((int)pvVar2 + *(int *)(iVar1 + 0x10) * 0x14);
    for (uVar5 = (iVar7 - *(int *)(iVar1 + 0x14)) * 5 & 0x3fffffff; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    }
    for (iVar6 = 0; iVar6 != 0; iVar6 = iVar6 + -1) {
      *(undefined1 *)puVar8 = 0;
      puVar8 = (undefined4 *)((int)puVar8 + 1);
    }
    *(void **)(iVar1 + 0xc) = pvVar2;
    *(int *)(iVar1 + 0x14) = iVar7;
  }
  pbVar9 = &DAT_1004d26f;
  iVar6 = 0x20;
  pbVar4 = local_20;
  puVar8 = (undefined4 *)(*(int *)(iVar1 + 0xc) + *(int *)(iVar1 + 0x10) * 0x14);
  pbVar3 = FUN_100020f0(param_1,(byte *)"CATEGORY");
  FUN_10002a30(pbVar3,pbVar4,iVar6,pbVar9);
  pbVar4 = FUN_10023710(*(void **)(iVar1 + 0x24),local_20);
  *puVar8 = pbVar4;
  puVar8[1] = *(undefined4 *)(iVar1 + 0x10);
  *(int *)(iVar1 + 0x10) = *(int *)(iVar1 + 0x10) + 1;
  puVar8[3] = 0;
  *(undefined4 **)(unaff_EBX + 0x10) = puVar8;
  *(undefined4 *)(unaff_EBX + 0x20) = 2;
  return 1;
}



undefined4 __cdecl FUN_1000ed20(int param_1)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *unaff_EDI;
  int iVar5;
  byte *pbVar6;
  uint uVar7;
  
  if ((*(int *)(param_1 + 0x20) != 5) && (*(int *)(param_1 + 0x20) != 4)) {
    FUN_10016450(4);
    return 0;
  }
  iVar2 = *(int *)(param_1 + 0x18);
  if (*(ushort *)(iVar2 + 0xdc8) == 0x20) {
    FUN_10016450(4);
    return 0;
  }
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x20;
  pbVar1 = (byte *)((uint)*(ushort *)(iVar2 + 0xdc8) * 0x6c + 0x28 + iVar2);
  pbVar4 = pbVar1;
  pbVar3 = FUN_100020f0(unaff_EDI,(byte *)"COLUMN");
  FUN_10002a30(pbVar3,pbVar4,iVar5,pbVar6);
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x20;
  pbVar4 = pbVar1 + 0x20;
  pbVar3 = FUN_100020f0(unaff_EDI,&DAT_1004df70);
  FUN_10002a30(pbVar3,pbVar4,iVar5,pbVar6);
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x20;
  pbVar4 = pbVar1 + 0x40;
  pbVar3 = FUN_100020f0(unaff_EDI,(byte *)"PARAM");
  FUN_10002a30(pbVar3,pbVar4,iVar5,pbVar6);
  iVar5 = 0x38;
  pbVar4 = FUN_100020f0(unaff_EDI,(byte *)"WIDTH");
  iVar5 = FUN_10002480((char *)pbVar4,iVar5);
  uVar7 = 0;
  *(int *)(pbVar1 + 0x60) = iVar5;
  pbVar4 = FUN_100020f0(unaff_EDI,&DAT_1004df60);
  uVar7 = FUN_10002930(pbVar4,uVar7);
  iVar5 = 0;
  *(uint *)(pbVar1 + 100) = uVar7;
  pbVar4 = FUN_100020f0(unaff_EDI,(byte *)"STYLE");
  iVar5 = FUN_10002480((char *)pbVar4,iVar5);
  *(int *)(pbVar1 + 0x68) = iVar5;
  *(short *)(iVar2 + 0xdc8) = *(short *)(iVar2 + 0xdc8) + 1;
  *(undefined4 *)(param_1 + 0x20) = 5;
  return 1;
}



undefined4 __cdecl FUN_1000ee60(byte *param_1)

{
  int iVar1;
  void *pvVar2;
  byte *pbVar3;
  byte *pbVar4;
  uint uVar5;
  int iVar6;
  int unaff_EBX;
  int iVar7;
  undefined4 *puVar8;
  byte *pbVar9;
  byte local_20 [32];
  
  if ((*(int *)(unaff_EBX + 0x20) != 2) && (*(int *)(unaff_EBX + 0x20) != 5)) {
    FUN_10016450(4);
    return 0;
  }
  iVar1 = *(int *)(unaff_EBX + 0x10);
  iVar6 = *(int *)(iVar1 + 0x10);
  if (*(int *)(iVar1 + 0xc) == iVar6) {
    iVar7 = 2;
    if (iVar6 != 0) {
      iVar7 = iVar6 * 2;
    }
    pvVar2 = _realloc(*(void **)(iVar1 + 8),iVar7 * 0x14);
    if (pvVar2 == (void *)0x0) {
      FUN_10016450(4);
      return 0;
    }
    puVar8 = (undefined4 *)((int)pvVar2 + *(int *)(iVar1 + 0xc) * 0x14);
    for (uVar5 = (iVar7 - *(int *)(iVar1 + 0x10)) * 5 & 0x3fffffff; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    }
    for (iVar6 = 0; iVar6 != 0; iVar6 = iVar6 + -1) {
      *(undefined1 *)puVar8 = 0;
      puVar8 = (undefined4 *)((int)puVar8 + 1);
    }
    *(void **)(iVar1 + 8) = pvVar2;
    *(int *)(iVar1 + 0x10) = iVar7;
  }
  pbVar9 = &DAT_1004d26f;
  iVar6 = 0x20;
  pbVar4 = local_20;
  puVar8 = (undefined4 *)(*(int *)(iVar1 + 8) + *(int *)(iVar1 + 0xc) * 0x14);
  pbVar3 = FUN_100020f0(param_1,(byte *)"INDEX");
  FUN_10002a30(pbVar3,pbVar4,iVar6,pbVar9);
  pbVar4 = FUN_10023710(*(void **)(*(int *)(unaff_EBX + 0xc) + 0x24),local_20);
  *puVar8 = pbVar4;
  puVar8[1] = *(undefined4 *)(iVar1 + 0xc);
  *(int *)(iVar1 + 0xc) = *(int *)(iVar1 + 0xc) + 1;
  puVar8[3] = 0;
  *(undefined4 **)(unaff_EBX + 0x14) = puVar8;
  *(undefined4 *)(unaff_EBX + 0x20) = 3;
  return 1;
}



undefined4 __cdecl FUN_1000ef90(int *param_1,byte *param_2)

{
  byte bVar1;
  char cVar2;
  void *pvVar3;
  byte *pbVar4;
  byte *pbVar5;
  long lVar6;
  int iVar7;
  char *pcVar8;
  byte *pbVar9;
  uint uVar10;
  int iVar11;
  undefined4 *puVar12;
  int iVar13;
  undefined4 *puVar14;
  long *plVar15;
  undefined4 *puVar16;
  undefined4 *puVar17;
  bool bVar18;
  byte *pbVar19;
  byte local_8c [12];
  byte local_80 [32];
  byte local_60 [32];
  byte local_40 [32];
  byte local_20 [32];
  
  if ((param_1[8] != 3) && (param_1[8] != 5)) {
    FUN_10016450(4);
    return 0;
  }
  iVar7 = param_1[5];
  iVar11 = *(int *)(iVar7 + 0x10);
  if (*(int *)(iVar7 + 0xc) == iVar11) {
    iVar13 = 2;
    if (iVar11 != 0) {
      iVar13 = iVar11 * 2;
    }
    pvVar3 = _realloc(*(void **)(iVar7 + 8),iVar13 * 0x1e028);
    if (pvVar3 == (void *)0x0) {
      FUN_10016450(4);
      return 0;
    }
    puVar14 = (undefined4 *)(*(int *)(iVar7 + 0xc) * 0x1e028 + (int)pvVar3);
    for (uVar10 = (uint)((iVar13 - *(int *)(iVar7 + 0xc)) * 0x1e028) >> 2; uVar10 != 0;
        uVar10 = uVar10 - 1) {
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
    for (iVar11 = 0; iVar11 != 0; iVar11 = iVar11 + -1) {
      *(undefined1 *)puVar14 = 0;
      puVar14 = (undefined4 *)((int)puVar14 + 1);
    }
    *(int *)(iVar7 + 0x10) = iVar13;
    *(void **)(iVar7 + 8) = pvVar3;
  }
  pbVar19 = &DAT_1004d26f;
  iVar11 = 0x20;
  pbVar5 = local_20;
  puVar14 = (undefined4 *)(*(int *)(iVar7 + 0xc) * 0x1e028 + *(int *)(iVar7 + 8));
  pbVar4 = FUN_100020f0(param_2,(byte *)"VARIATION");
  FUN_10002a30(pbVar4,pbVar5,iVar11,pbVar19);
  pbVar4 = FUN_10023710(*(void **)(param_1[3] + 0x24),local_20);
  pbVar19 = &DAT_1004d26f;
  iVar11 = 0x20;
  pbVar5 = (byte *)(puVar14 + 1);
  *puVar14 = pbVar4;
  pbVar4 = FUN_100020f0(param_2,&DAT_1004d8c8);
  FUN_10002a30(pbVar4,pbVar5,iVar11,pbVar19);
  iVar11 = 0;
  pbVar5 = FUN_100020f0(param_2,(byte *)"FIXED");
  iVar11 = FUN_10002480((char *)pbVar5,iVar11);
  iVar13 = 100;
  *(short *)((int)puVar14 + 0xdca) = (short)iVar11;
  pbVar5 = FUN_100020f0(param_2,(byte *)"RANGE");
  iVar11 = FUN_10002480((char *)pbVar5,iVar13);
  iVar13 = 0;
  *(short *)(puVar14 + 0x374) = (short)iVar11;
  *(undefined2 *)((int)puVar14 + 0xdd2) = 0;
  pbVar5 = FUN_100020f0(param_2,(byte *)"CENTERED");
  iVar11 = FUN_10002480((char *)pbVar5,iVar13);
  if (iVar11 != 0) {
    *(byte *)((int)puVar14 + 0xdd2) = *(byte *)((int)puVar14 + 0xdd2) | 1;
  }
  uVar10 = 0;
  pbVar5 = FUN_100020f0(param_2,(byte *)"USERS");
  uVar10 = FUN_10002930(pbVar5,uVar10);
  puVar14[0x375] = uVar10;
  if (uVar10 != 0) {
    *(byte *)((int)puVar14 + 0xdd2) = *(byte *)((int)puVar14 + 0xdd2) | 2;
  }
  iVar11 = -1;
  pbVar5 = FUN_100020f0(param_2,&DAT_1004ecbc);
  iVar11 = FUN_10002480((char *)pbVar5,iVar11);
  if (iVar11 < 0) {
    if (*(int *)(*param_1 + 0x198c) == 0x80) {
      FUN_10016450(4);
      return 0;
    }
    *(undefined2 *)(puVar14 + 0x373) = *(undefined2 *)(*param_1 + 0x198c);
    *(int *)(*param_1 + 0x198c) = *(int *)(*param_1 + 0x198c) + 1;
    *(int *)(param_1[3] + 0x20) = *(int *)(param_1[3] + 0x20) + 1;
  }
  else {
    *(short *)(puVar14 + 0x373) = (short)iVar11;
  }
  pbVar5 = FUN_100020f0(param_2,(byte *)"PARAMS");
  if (pbVar5 == (byte *)0x0) {
    *(undefined2 *)((int)puVar14 + 0xdce) = 0;
  }
  else {
    iVar11 = 0;
    plVar15 = puVar14 + 0x36a;
    do {
      iVar13 = FUN_10003680(pbVar5,local_8c,0xc,&DAT_1004d26f,iVar11,0x2c);
      if ((iVar13 < 1) || (local_8c[0] == 0)) break;
      lVar6 = _atol((char *)local_8c);
      *plVar15 = lVar6;
      iVar11 = iVar11 + 1;
      plVar15 = plVar15 + 1;
    } while (iVar11 != 8);
    *(short *)((int)puVar14 + 0xdce) = (short)iVar11;
  }
  puVar14[9] = *(undefined4 *)(iVar7 + 0xc);
  *(int *)(iVar7 + 0xc) = *(int *)(iVar7 + 0xc) + 1;
  *(undefined2 *)(puVar14 + 0x372) = 0;
  pbVar5 = FUN_100020f0(param_2,(byte *)"USE_COLUMNS");
  if (pbVar5 != (byte *)0x0) {
    FUN_10003680(pbVar5,local_40,0x20,&DAT_1004d26f,0,0x2c);
    FUN_10003680(pbVar5,local_80,0x20,&DAT_1004d26f,1,0x2c);
    FUN_10003680(pbVar5,local_60,0x20,&DAT_1004d26f,2,0x2c);
    uVar10 = 0;
    if (*(int *)(param_1[3] + 0x10) != 0) {
      puVar16 = *(undefined4 **)(param_1[3] + 0xc);
      puVar12 = puVar16;
      do {
        pbVar19 = (byte *)*puVar12;
        pbVar4 = local_40;
        do {
          bVar1 = *pbVar4;
          bVar18 = bVar1 < *pbVar19;
          if (bVar1 != *pbVar19) {
LAB_1000f324:
            iVar7 = (1 - (uint)bVar18) - (uint)(bVar18 != 0);
            goto LAB_1000f329;
          }
          if (bVar1 == 0) break;
          bVar1 = pbVar4[1];
          bVar18 = bVar1 < pbVar19[1];
          if (bVar1 != pbVar19[1]) goto LAB_1000f324;
          pbVar4 = pbVar4 + 2;
          pbVar19 = pbVar19 + 2;
        } while (bVar1 != 0);
        iVar7 = 0;
LAB_1000f329:
        if (iVar7 == 0) {
          puVar16 = puVar16 + uVar10 * 5;
          if (puVar16 != (undefined4 *)0x0) {
            uVar10 = 0;
            if (puVar16[3] == 0) goto LAB_1000f3e9;
            puVar12 = (undefined4 *)puVar16[2];
            goto LAB_1000f398;
          }
          break;
        }
        uVar10 = uVar10 + 1;
        puVar12 = puVar12 + 5;
      } while (uVar10 < *(uint *)(param_1[3] + 0x10));
    }
    FUN_10016450(4);
    return 0;
  }
LAB_1000f505:
  pbVar4 = (byte *)(puVar14 + 0x376);
  iVar7 = 0x100;
  pbVar19 = pbVar4;
  pbVar9 = FUN_100020f0(param_2,(byte *)"EXTRACT");
  FUN_10002a30(pbVar9,pbVar4,iVar7,pbVar19);
  param_1[6] = (int)puVar14;
  param_1[8] = (pbVar5 != (byte *)0x0) + 4;
  return 1;
LAB_1000f398:
  pbVar19 = (byte *)*puVar12;
  pbVar4 = local_80;
  do {
    bVar1 = *pbVar4;
    bVar18 = bVar1 < *pbVar19;
    if (bVar1 != *pbVar19) {
LAB_1000f3c4:
      iVar7 = (1 - (uint)bVar18) - (uint)(bVar18 != 0);
      goto LAB_1000f3c9;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar4[1];
    bVar18 = bVar1 < pbVar19[1];
    if (bVar1 != pbVar19[1]) goto LAB_1000f3c4;
    pbVar4 = pbVar4 + 2;
    pbVar19 = pbVar19 + 2;
  } while (bVar1 != 0);
  iVar7 = 0;
LAB_1000f3c9:
  if (iVar7 == 0) {
    puVar16 = (undefined4 *)puVar16[2] + uVar10 * 5;
    if (puVar16 != (undefined4 *)0x0) {
      uVar10 = 0;
      if (puVar16[3] == 0) goto LAB_1000f484;
      puVar12 = (undefined4 *)puVar16[2];
      goto LAB_1000f430;
    }
    goto LAB_1000f3e9;
  }
  uVar10 = uVar10 + 1;
  puVar12 = puVar12 + 5;
  if ((uint)puVar16[3] <= uVar10) {
LAB_1000f3e9:
    FUN_10016450(4);
    return 0;
  }
  goto LAB_1000f398;
LAB_1000f430:
  pbVar19 = (byte *)*puVar12;
  pbVar4 = local_60;
  do {
    bVar1 = *pbVar4;
    bVar18 = bVar1 < *pbVar19;
    if (bVar1 != *pbVar19) {
LAB_1000f45a:
      iVar7 = (1 - (uint)bVar18) - (uint)(bVar18 != 0);
      goto LAB_1000f45f;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar4[1];
    bVar18 = bVar1 < pbVar19[1];
    if (bVar1 != pbVar19[1]) goto LAB_1000f45a;
    pbVar4 = pbVar4 + 2;
    pbVar19 = pbVar19 + 2;
  } while (bVar1 != 0);
  iVar7 = 0;
LAB_1000f45f:
  if (iVar7 == 0) {
    puVar16 = (undefined4 *)puVar16[2] + uVar10 * 0x780a;
    if (puVar16 != (undefined4 *)0x0) {
      puVar12 = puVar16 + 10;
      puVar17 = puVar14 + 10;
      for (iVar7 = 0x360; iVar7 != 0; iVar7 = iVar7 + -1) {
        *puVar17 = *puVar12;
        puVar12 = puVar12 + 1;
        puVar17 = puVar17 + 1;
      }
      *(undefined2 *)(puVar14 + 0x372) = *(undefined2 *)(puVar16 + 0x372);
      *(undefined2 *)((int)puVar14 + 0xdca) = *(undefined2 *)((int)puVar16 + 0xdca);
      pcVar8 = (char *)(puVar16 + 0x376);
      iVar7 = 0xdd8 - (int)pcVar8;
      do {
        cVar2 = *pcVar8;
        pcVar8[(int)puVar14 + iVar7] = cVar2;
        pcVar8 = pcVar8 + 1;
      } while (cVar2 != '\0');
      goto LAB_1000f505;
    }
    goto LAB_1000f484;
  }
  uVar10 = uVar10 + 1;
  puVar12 = puVar12 + 0x780a;
  if ((uint)puVar16[3] <= uVar10) {
LAB_1000f484:
    FUN_10016450(4);
    return 0;
  }
  goto LAB_1000f430;
}



undefined4 __cdecl FUN_1000f550(byte *param_1)

{
  byte *pbVar1;
  byte *pbVar2;
  void *pvVar3;
  int *piVar4;
  void *extraout_ECX;
  void *extraout_ECX_00;
  int *unaff_EDI;
  byte *pbVar5;
  int iVar6;
  byte *pbVar7;
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_1004cefb;
  local_c = ExceptionList;
  if ((unaff_EDI[8] != 0) && (unaff_EDI[8] != 5)) {
    ExceptionList = &local_c;
    FUN_10016450(4);
    ExceptionList = local_c;
    return 0;
  }
  ExceptionList = &local_c;
  pbVar1 = (byte *)_malloc(0x28);
  if (pbVar1 != (byte *)0x0) {
    pbVar7 = &DAT_1004d26f;
    iVar6 = 0xc;
    pbVar5 = pbVar1;
    pbVar2 = FUN_100020f0(param_1,&DAT_1004e040);
    FUN_10002a30(pbVar2,pbVar5,iVar6,pbVar7);
    pbVar1[0xc] = 0;
    pbVar1[0xd] = 0;
    pbVar1[0xe] = 0;
    pbVar1[0xf] = 0;
    pbVar1[0x10] = 0;
    pbVar1[0x11] = 0;
    pbVar1[0x12] = 0;
    pbVar1[0x13] = 0;
    pbVar1[0x14] = 0;
    pbVar1[0x15] = 0;
    pbVar1[0x16] = 0;
    pbVar1[0x17] = 0;
    pbVar1[0x20] = 0;
    pbVar1[0x21] = 0;
    pbVar1[0x22] = 0;
    pbVar1[0x23] = 0;
    pvVar3 = operator_new(0x10);
    local_4 = 0;
    if (pvVar3 == (void *)0x0) {
      piVar4 = (int *)0x0;
      pvVar3 = extraout_ECX;
    }
    else {
      piVar4 = FUN_100236d0(pvVar3,0x400,0x20);
      pvVar3 = extraout_ECX_00;
    }
    *(int **)(pbVar1 + 0x24) = piVar4;
    iVar6 = FUN_100229d0(pvVar3,*(int **)(*unaff_EDI + 0x1988),pbVar1,(int)pbVar1);
    if (-1 < iVar6) {
      iVar6 = -1;
      unaff_EDI[3] = (int)pbVar1;
      unaff_EDI[8] = 1;
      pbVar1 = FUN_100020f0(param_1,(byte *)"RESET");
      iVar6 = FUN_10002480((char *)pbVar1,iVar6);
      if (0 < iVar6) {
        *(undefined4 *)(*unaff_EDI + 0x198c) = 0;
      }
      ExceptionList = local_c;
      return 1;
    }
  }
  ExceptionList = local_c;
  return 0;
}



undefined4 __cdecl FUN_1000f680(byte *param_1)

{
  int *in_EAX;
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  char *pcVar4;
  bool bVar5;
  char local_64 [100];
  
  if (*param_1 != 0x23) {
    iVar1 = FUN_10003810((char *)param_1,local_64,100);
    if (iVar1 != 0) {
      iVar1 = 9;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "CATEGORY";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000ebf0(param_1);
        return uVar2;
      }
      iVar1 = 7;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "COLUMN";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000ed20((int)in_EAX);
        return uVar2;
      }
      iVar1 = 6;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "INDEX";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000ee60(param_1);
        return uVar2;
      }
      iVar1 = 10;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "VARIATION";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000ef90(in_EAX,param_1);
        return uVar2;
      }
      iVar1 = 5;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "VIEW";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000f550(param_1);
        return uVar2;
      }
      FUN_10016450(4);
      return 0;
    }
  }
  return 1;
}



int FUN_1000f7a0(void)

{
  FILE *_File;
  char *pcVar1;
  int unaff_EBX;
  int iVar2;
  char *unaff_EDI;
  byte local_400 [1024];
  
  iVar2 = 0;
  *(undefined4 *)(unaff_EBX + 0x198c) = 0;
  FUN_10016490(4);
  _File = (FILE *)FUN_100409a9(unaff_EDI,"r");
  if (_File == (FILE *)0x0) {
    FUN_10016450(4);
    return 0;
  }
  pcVar1 = _fgets((char *)local_400,0x400,_File);
  if (pcVar1 != (char *)0x0) {
    while (iVar2 = FUN_1000f680(local_400), iVar2 != 0) {
      pcVar1 = _fgets((char *)local_400,0x400,_File);
      if (pcVar1 == (char *)0x0) {
        FUN_10016490(4);
        FUN_1000ea10(unaff_EBX);
        _fclose(_File);
        return iVar2;
      }
    }
  }
  FUN_10016490(4);
  _fclose(_File);
  return iVar2;
}



void __cdecl FUN_1000f9f0(int param_1)

{
  byte *pbVar1;
  int iVar2;
  int in_EAX;
  uint uVar3;
  byte *pbVar4;
  byte local_10 [16];
  
  pbVar1 = *(byte **)(in_EAX + 0x60);
  iVar2 = *(int *)(in_EAX + 0x5c);
  uVar3 = 0;
  if (*(short *)(param_1 + 0xdc8) != 0) {
    pbVar4 = (byte *)(param_1 + 0x68);
    do {
      _sprintf((char *)local_10,"CN%d",uVar3);
      FUN_10003cf0(pbVar1,iVar2,local_10,pbVar4 + -0x40);
      _sprintf((char *)local_10,"CD%d",uVar3);
      FUN_10003cf0(pbVar1,iVar2,local_10,pbVar4 + -0x20);
      _sprintf((char *)local_10,"CP%d",uVar3);
      FUN_10003cf0(pbVar1,iVar2,local_10,pbVar4);
      _sprintf((char *)local_10,"CW%d",uVar3);
      FUN_10002370(pbVar1,iVar2,local_10,*(uint *)(pbVar4 + 0x20));
      _sprintf((char *)local_10,"CT%d",uVar3);
      FUN_10002370(pbVar1,iVar2,local_10,*(uint *)(pbVar4 + 0x24));
      _sprintf((char *)local_10,"CS%d",uVar3);
      FUN_10002370(pbVar1,iVar2,local_10,*(uint *)(pbVar4 + 0x28));
      uVar3 = uVar3 + 1;
      pbVar4 = pbVar4 + 0x6c;
    } while (uVar3 != *(ushort *)(param_1 + 0xdc8));
  }
  return;
}



undefined4 FUN_1000fb00(void)

{
  size_t sVar1;
  byte *pbVar2;
  int in_EAX;
  int iVar3;
  int unaff_EBX;
  uint uVar4;
  int iVar5;
  char *_Dest;
  undefined4 *local_7c;
  char local_60 [96];
  
  sVar1 = *(size_t *)(unaff_EBX + 0x5c);
  pbVar2 = *(byte **)(unaff_EBX + 0x60);
  iVar5 = *(int *)(in_EAX + 0x4d8) * 0x1e028 +
          *(int *)(*(int *)(*(int *)(*(int *)(in_EAX + 0x4c8) + 0xc) +
                            *(int *)(in_EAX + 0x4d0) * 0x14 + 8) + *(int *)(in_EAX + 0x4d4) * 0x14 +
                  8);
  uVar4 = 0;
  local_60[0] = '\0';
  _Dest = local_60;
  if (*(short *)(iVar5 + 0xdce) != 0) {
    local_7c = (undefined4 *)(iVar5 + 0xda8);
    do {
      if (uVar4 != 0) {
        *_Dest = ',';
        _Dest = _Dest + 1;
      }
      iVar3 = _sprintf(_Dest,"%d",*local_7c);
      local_7c = local_7c + 1;
      _Dest = _Dest + iVar3;
      uVar4 = uVar4 + 1;
    } while (uVar4 != *(ushort *)(iVar5 + 0xdce));
  }
  FUN_10003e20(pbVar2,sVar1,
               (byte *)
               "IDX=%d VIEW=%s CN=%s CI=%d IN=%s II=%d VN=%s VI=%d CC=%d FC=%d DESC=%s RANGE=%d FLAGS=%d PARAMS=%s EXTRACT=%s USERS=%t"
              );
  FUN_1000f9f0(iVar5);
  *(undefined4 *)(unaff_EBX + 0x58) = 0xffffffff;
  *(undefined4 *)(unaff_EBX + 0x50) = 0x2b766172;
  return 1;
}



undefined4 __cdecl FUN_1000fc50(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int unaff_ESI;
  
  iVar1 = *(int *)(unaff_ESI + 0x4c8);
  if (iVar1 == 0) {
    FUN_10022c50(*(int *)(param_1 + 0x1988));
    iVar1 = FUN_10022c60(*(int *)(param_1 + 0x1988),(undefined4 *)0x0);
    if (iVar1 == 0) {
      *(undefined4 *)(unaff_ESI + 0x4c4) = 1;
    }
    else {
      *(int *)(unaff_ESI + 0x4c8) = iVar1;
    }
  }
  else {
    iVar3 = *(int *)(iVar1 + 0xc) + *(int *)(unaff_ESI + 0x4d0) * 0x14;
    iVar2 = *(int *)(iVar3 + 8);
    iVar5 = *(int *)(unaff_ESI + 0x4d8) + 1;
    *(int *)(unaff_ESI + 0x4d8) = iVar5;
    if (iVar5 == *(int *)(iVar2 + *(int *)(unaff_ESI + 0x4d4) * 0x14 + 0xc)) {
      iVar2 = *(int *)(unaff_ESI + 0x4d4) + 1;
      *(undefined4 *)(unaff_ESI + 0x4d8) = 0;
      *(int *)(unaff_ESI + 0x4d4) = iVar2;
      if (iVar2 == *(int *)(iVar3 + 0xc)) {
        iVar3 = *(int *)(unaff_ESI + 0x4d0) + 1;
        *(undefined4 *)(unaff_ESI + 0x4d4) = 0;
        *(int *)(unaff_ESI + 0x4d0) = iVar3;
        if (iVar3 == *(int *)(iVar1 + 0x10)) {
          *(undefined4 *)(unaff_ESI + 0x4d0) = 0;
          iVar1 = FUN_10022980(*(undefined4 **)(param_1 + 0x1988));
          iVar3 = *(int *)(unaff_ESI + 0x4cc) + 1;
          *(int *)(unaff_ESI + 0x4cc) = iVar3;
          if (iVar3 == iVar1) {
            *(undefined4 *)(unaff_ESI + 0x4c4) = 1;
          }
          else {
            FUN_10022c50(*(int *)(param_1 + 0x1988));
            uVar4 = 0;
            do {
              iVar1 = FUN_10022c60(*(int *)(param_1 + 0x1988),(undefined4 *)0x0);
              if (iVar1 == 0) {
                *(undefined4 *)(unaff_ESI + 0x4c4) = 1;
                *(undefined4 *)(unaff_ESI + 0x4c8) = 0;
                goto LAB_1000fd86;
              }
              uVar4 = uVar4 + 1;
            } while (uVar4 <= *(uint *)(unaff_ESI + 0x4cc));
            *(int *)(unaff_ESI + 0x4c8) = iVar1;
          }
        }
      }
    }
  }
LAB_1000fd86:
  if (*(int *)(unaff_ESI + 0x4c4) == 0) {
    FUN_1000fb00();
  }
  return 1;
}



uint FUN_1000fdb0(void)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int unaff_EBX;
  int unaff_ESI;
  int unaff_EDI;
  
  iVar2 = *(int *)(unaff_EDI + 0x2c);
  while( true ) {
    if ((iVar2 == 0) ||
       (uVar3 = *(uint *)(unaff_EDI + 0x2c), *(uint *)(unaff_ESI + 0x8d54) <= uVar3)) {
      return CONCAT31((int3)((uint)iVar2 >> 8),1);
    }
    piVar1 = (int *)((uVar3 % *(uint *)(unaff_ESI + 0x8d58)) * 0x478 + 0x8d5c + unaff_ESI);
    *(uint *)(unaff_EDI + 0x2c) = uVar3 + 1;
    if (((piVar1[0x11b] != *(int *)(unaff_EBX + 0x14)) ||
        (piVar1[0x11c] != *(int *)(unaff_EBX + 0x18))) && (*piVar1 + 1 == uVar3 + 1)) break;
    iVar2 = *(int *)(unaff_EDI + 0x2c);
  }
  uVar3 = FUN_10003e20(*(byte **)(unaff_EBX + 0x60),*(size_t *)(unaff_EBX + 0x5c),
                       (byte *)"PRIV=%d SET=%d ROOM=%d GAME=%d FLAGS=%f NAME=%s TEXT=%s PUID=%s");
  *(undefined4 *)(unaff_EBX + 0x58) = 0xffffffff;
  *(undefined4 *)(unaff_EBX + 0x50) = 0x2b6d7367;
  return uVar3 & 0xffffff00;
}



uint __fastcall FUN_1000fe70(int param_1)

{
  int in_EAX;
  int iVar1;
  uint uVar2;
  int *piVar3;
  int unaff_EDI;
  int local_4;
  
  iVar1 = *(int *)(in_EAX + 0x18);
  piVar3 = (int *)(in_EAX + 0x18);
  local_4 = 0;
  if (0 < iVar1) {
    iVar1 = FUN_100262e0(*(int *)(param_1 + 0x1604),piVar3,&local_4);
    if (iVar1 != 0) {
      *piVar3 = *piVar3 + 1;
      if (local_4 == 0) {
        uVar2 = FUN_10003e20(*(byte **)(unaff_EDI + 0x60),*(size_t *)(unaff_EDI + 0x5c),
                             (byte *)"IDENT=%d");
      }
      else {
        uVar2 = FUN_10027430(*(byte **)(unaff_EDI + 0x60),*(size_t *)(unaff_EDI + 0x5c));
      }
      *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
      *(undefined4 *)(unaff_EDI + 0x50) = 0x2b636174;
      return uVar2 & 0xffffff00;
    }
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



undefined4 __fastcall FUN_1000fef0(int param_1)

{
  int in_EAX;
  int iVar1;
  uint uVar2;
  int unaff_EBX;
  int *piVar3;
  int unaff_EDI;
  int local_4;
  
  iVar1 = *(int *)(in_EAX + 0x4c0);
  piVar3 = (int *)(in_EAX + 0x4c0);
  local_4 = param_1;
  while ((0 < iVar1 &&
         (iVar1 = FUN_100262e0(*(int *)(unaff_EBX + 0x1608),piVar3,&local_4), iVar1 != 0))) {
    iVar1 = *piVar3 + 1;
    *piVar3 = iVar1;
    if (local_4 != 0) {
      uVar2 = FUN_100225a0(local_4,*(byte **)(unaff_EDI + 0x60),*(size_t *)(unaff_EDI + 0x5c));
      *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
      *(undefined4 *)(unaff_EDI + 0x50) = 0x2b737677;
      return uVar2 & 0xffffff00;
    }
    local_4 = 0;
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



undefined4 __cdecl FUN_1000ff60(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int unaff_EBX;
  int unaff_ESI;
  
  iVar2 = param_1;
  iVar3 = *(int *)(param_1 + 0x10);
  piVar1 = (int *)(param_1 + 0x10);
  do {
    if ((iVar3 < 1) ||
       (iVar3 = FUN_100262e0(*(int *)(unaff_EBX + 0x15f8),piVar1,&param_1), iVar3 == 0)) {
      return CONCAT31((int3)((uint)iVar3 >> 8),1);
    }
    iVar3 = *piVar1 + 1;
    *piVar1 = iVar3;
  } while ((param_1 == 0) && (iVar3 <= *(int *)(iVar2 + 0x14)));
  uVar4 = FUN_10003e20(*(byte **)(unaff_ESI + 0x60),*(size_t *)(unaff_ESI + 0x5c),(byte *)"IDENT=%d"
                      );
  if (param_1 != 0) {
    FUN_10003e20((byte *)(*(int *)(unaff_ESI + 0x60) + uVar4),*(int *)(unaff_ESI + 0x5c) - uVar4,
                 (byte *)" NAME=%s HOST=%s FLAGS=%f LIMIT=%d LOC=%t");
    FUN_10002d30(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e784,
                 (uint *)(param_1 + 0x1ac),0x24,&DAT_1004e4d4);
    if (*(char *)(param_1 + 0x60) != '\0') {
      FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e794,
                   (byte *)(param_1 + 0x60));
    }
    if (*(char *)(param_1 + 0x84) != '\0') {
      FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004df70,
                   (byte *)(param_1 + 0x84));
    }
    if (*(char *)(param_1 + 0x2c) != '\0') {
      FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e79c,
                   (byte *)(param_1 + 0x2c));
    }
    if (*(char *)(param_1 + 0x70) != '\0') {
      FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e5a0,
                   (byte *)(param_1 + 0x70));
    }
    if (*(char *)(param_1 + 0x120) != '\0') {
      FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e78c,
                   (byte *)(param_1 + 0x120));
    }
    uVar4 = FUN_10002370(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),(byte *)"CATEGORY",
                         *(uint *)(param_1 + 0x1a4));
  }
  *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
  *(undefined4 *)(unaff_ESI + 0x50) = 0x2b726f6d;
  return uVar4 & 0xffffff00;
}



undefined4 __cdecl FUN_10010110(uint *param_1)

{
  uint *puVar1;
  uint *puVar2;
  uint uVar3;
  uint uVar4;
  int unaff_EBX;
  int unaff_EDI;
  
  puVar2 = param_1;
  puVar1 = param_1 + 7;
  uVar4 = param_1[7];
  do {
    uVar3 = uVar4;
    if (((int)uVar3 < 1) ||
       (uVar3 = FUN_100262e0(*(int *)(unaff_EBX + 0x173c),(int *)puVar1,&param_1), uVar3 == 0)) {
      return CONCAT31((int3)(uVar3 >> 8),1);
    }
    uVar4 = *puVar1 + 1;
    *puVar1 = uVar4;
  } while ((param_1 == (uint *)0x0) && ((int)uVar4 <= (int)puVar2[8]));
  **(undefined1 **)(unaff_EDI + 0x60) = 0;
  FUN_10002370(*(byte **)(unaff_EDI + 0x60),*(int *)(unaff_EDI + 0x5c),(byte *)"IDENT",uVar3);
  if (param_1 != (uint *)0x0) {
    FUN_10002370(*(byte **)(unaff_EDI + 0x60),*(int *)(unaff_EDI + 0x5c),&DAT_1004e76c,param_1[8]);
    param_1 = (uint *)FUN_10025d70(*(byte **)(unaff_EDI + 0x60),*(int *)(unaff_EDI + 0x5c),
                                   &DAT_1004e774,param_1);
  }
  *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
  *(undefined4 *)(unaff_EDI + 0x50) = 0x2b757374;
  return (uint)param_1 & 0xffffff00;
}



undefined4 __cdecl FUN_100101c0(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int unaff_EBX;
  int unaff_ESI;
  
  iVar2 = param_1;
  iVar3 = *(int *)(param_1 + 8);
  piVar1 = (int *)(param_1 + 8);
  do {
    if ((iVar3 < 1) ||
       (iVar3 = FUN_100262e0(*(int *)(unaff_EBX + 0x1614),piVar1,&param_1), iVar3 == 0)) {
      return CONCAT31((int3)((uint)iVar3 >> 8),1);
    }
    iVar3 = *piVar1 + 1;
    *piVar1 = iVar3;
  } while ((param_1 == 0) && (iVar3 <= *(int *)(iVar2 + 0xc)));
  uVar4 = FUN_10003e20(*(byte **)(unaff_ESI + 0x60),*(size_t *)(unaff_ESI + 0x5c),(byte *)"IDENT=%d"
                      );
  if (param_1 != 0) {
    FUN_10003e20((byte *)(*(int *)(unaff_ESI + 0x60) + uVar4),*(int *)(unaff_ESI + 0x5c) - uVar4,
                 (byte *)
                 " NAME=%s PERS=%s UID=%s ROOM=%d GAME=%d STAT=%s AUX=%s AUXFL=%d RGB=%d PING=%d SEED=%d FLAGS=%f SYNC=%d ADDR=%a LADDR=%a SERV=%a SPRT=%d MADDR=%s GFIDS=%d ATTR=%f HWFLAG=%d HWMASK=%d _LEVEL=%d MEDALS=%d LOC=%t _REP=%d MAC=%s PUID=%s _CID=%s _CTAG=%s"
                );
    FUN_10002d30(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e784,
                 (uint *)(param_1 + 0x3bc),0x24,&DAT_1004e4d4);
    FUN_10002d30(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e6bc,
                 (uint *)(param_1 + 0x31c),0x10,&DAT_1004e4d4);
    uVar4 = param_1;
    if ((*(int *)(param_1 + 0x2d8) == *(int *)(unaff_ESI + 0x14)) &&
       (*(int *)(param_1 + 0x2dc) == *(int *)(unaff_ESI + 0x18))) {
      uVar4 = FUN_10002370(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004db40,
                           *(uint *)(param_1 + 0x2e0));
    }
  }
  *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
  *(undefined4 *)(unaff_ESI + 0x50) = 0x2b757372;
  return uVar4 & 0xffffff00;
}



undefined4 __cdecl FUN_100103a0(uint *param_1)

{
  uint *puVar1;
  uint *puVar2;
  uint uVar3;
  int unaff_EBX;
  int unaff_EDI;
  
  puVar2 = param_1;
  uVar3 = param_1[9];
  puVar1 = param_1 + 9;
  do {
    if (((int)uVar3 < 1) ||
       (uVar3 = FUN_100262e0(*(int *)(unaff_EBX + 0x1728),(int *)puVar1,&param_1), uVar3 == 0)) {
      return CONCAT31((int3)(uVar3 >> 8),1);
    }
    uVar3 = *puVar1 + 1;
    *puVar1 = uVar3;
  } while ((param_1 == (uint *)0x0) && ((int)uVar3 <= (int)puVar2[10]));
  FUN_10003e20(*(byte **)(unaff_EDI + 0x60),*(size_t *)(unaff_EDI + 0x5c),(byte *)"IDENT=%d");
  if (param_1 != (uint *)0x0) {
    FUN_10002370(*(byte **)(unaff_EDI + 0x60),*(int *)(unaff_EDI + 0x5c),&DAT_1004e704,param_1[0x76]
                );
    param_1 = (uint *)FUN_100269a0(*(byte **)(unaff_EDI + 0x60),*(int *)(unaff_EDI + 0x5c),param_1);
  }
  *(undefined4 *)(unaff_EDI + 0x58) = 0xffffffff;
  *(undefined4 *)(unaff_EDI + 0x50) = 0x2b67616d;
  return (uint)param_1 & 0xffffff00;
}



uint __fastcall FUN_10010450(int param_1)

{
  int in_EAX;
  uint uVar1;
  int unaff_ESI;
  int *piVar2;
  int local_4;
  
  uVar1 = *(uint *)(in_EAX + 0x34);
  piVar2 = (int *)(in_EAX + 0x34);
  if (0 < (int)uVar1) {
    local_4 = param_1;
    uVar1 = FUN_100262e0(*(int *)(param_1 + 0x1734),piVar2,&local_4);
    if (uVar1 != 0) {
      *piVar2 = *piVar2 + 1;
      if (local_4 == 0) {
        uVar1 = FUN_10002370(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),(byte *)"IDENT"
                             ,uVar1);
      }
      else {
        FUN_100020b0(*(char **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),(char *)(local_4 + 0xc)
                    );
        FUN_10002370(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),(byte *)"IDENT",uVar1);
        uVar1 = FUN_10003240(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e6b4,
                             *(int *)(local_4 + 8));
      }
      *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
      *(undefined4 *)(unaff_ESI + 0x50) = 0x2b677374;
      return uVar1 & 0xffffff00;
    }
  }
  return CONCAT31((int3)(uVar1 >> 8),1);
}



uint __fastcall FUN_10010500(int param_1)

{
  int iVar1;
  uint uVar2;
  int unaff_ESI;
  int unaff_EDI;
  
  iVar1 = *(int *)(unaff_EDI + 0x4dc);
  if ((0 < iVar1) && (iVar1 < *(int *)(param_1 + 0x2640))) {
    FUN_10003e20(*(byte **)(unaff_ESI + 0x60),*(size_t *)(unaff_ESI + 0x5c),
                 (byte *)
                 "IDENT=%d TYPE=%s COUNT=%d LIMIT=%d ADDR=%a PORT=%d FLAGS=%f SECRET=%s CUSTOM=%s FORMAT=%s"
                );
    *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
    *(undefined4 *)(unaff_ESI + 0x50) = 0x2b657874;
    uVar2 = *(int *)(unaff_EDI + 0x4dc) + 1;
    *(uint *)(unaff_EDI + 0x4dc) = uVar2;
    return uVar2 & 0xffffff00;
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



undefined4 __cdecl FUN_10010590(int param_1,int param_2)

{
  uint uVar1;
  byte *pbVar2;
  int unaff_EBX;
  int *piVar3;
  int *local_10;
  byte *local_c;
  uint local_8;
  uint local_4;
  
  pbVar2 = *(byte **)(param_2 + 0x38);
  if (pbVar2 != (byte *)0x0) {
    if (*(int *)(param_2 + 0x4c4) == 0) {
      uVar1 = FUN_1000fc50(param_1);
      if (uVar1 != 0) {
LAB_100106f3:
        return uVar1 & 0xffffff00;
      }
    }
    uVar1 = 0;
    local_10 = (int *)(param_1 + 0x1748);
    piVar3 = (int *)(param_2 + 0x40);
    do {
      pbVar2 = (byte *)*local_10;
      if (pbVar2 != (byte *)0x0) {
        if (*piVar3 < 0) {
          *(undefined4 *)(param_2 + 0x40 + uVar1 * 8) = 0;
          FUN_10021680(*(int *)(param_1 + 0x1748 + uVar1 * 4));
          FUN_100262d0(*(int *)(param_1 + 0x1748 + uVar1 * 4));
          FUN_100396f0(*(int *)(param_1 + 0x1748 + uVar1 * 4));
          FUN_10021670(*(int *)(param_1 + 0x1748 + uVar1 * 4));
          FUN_10021660(*(int *)(param_1 + 0x1748 + uVar1 * 4));
          uVar1 = FUN_10003e20(*(byte **)(unaff_EBX + 0x60),*(size_t *)(unaff_EBX + 0x5c),
                               (byte *)"IDX=%d CNT=%d XTRA=%d WID=%d STY=%d AS=%d");
          *(undefined4 *)(unaff_EBX + 0x58) = 0xffffffff;
          *(undefined4 *)(unaff_EBX + 0x50) = 0x2b726b61;
          return uVar1 & 0xffffff00;
        }
        pbVar2 = (byte *)FUN_10021710((int)pbVar2,piVar3 + 1,piVar3,&local_8,&local_4,
                                      (int *)&local_c);
        if (pbVar2 == (byte *)0x0) {
          pbVar2 = (byte *)FUN_10021690(*local_10,*piVar3,&local_4,(int *)0x0,(int *)&local_c);
          if (pbVar2 == (byte *)0x0) goto LAB_10010633;
          piVar3 = (int *)(param_2 + 0x40 + uVar1 * 8);
          *piVar3 = *piVar3 + 1;
          local_8 = 0;
        }
        **(undefined1 **)(unaff_EBX + 0x60) = 0;
        FUN_10002370(*(byte **)(unaff_EBX + 0x60),*(int *)(unaff_EBX + 0x5c),&DAT_1004d950,uVar1);
        FUN_10003cf0(*(byte **)(unaff_EBX + 0x60),*(int *)(unaff_EBX + 0x5c),&DAT_1004d8c8,local_c);
        if (local_8 != 0) {
          FUN_10002370(*(byte **)(unaff_EBX + 0x60),*(int *)(unaff_EBX + 0x5c),&DAT_1004e6ac,local_8
                      );
        }
        if (0 < (int)local_4) {
          FUN_10002370(*(byte **)(unaff_EBX + 0x60),*(int *)(unaff_EBX + 0x5c),&DAT_1004e6b0,local_4
                      );
          local_4 = FUN_10003cf0(*(byte **)(unaff_EBX + 0x60),*(int *)(unaff_EBX + 0x5c),
                                 &DAT_1004e754,pbVar2);
        }
        *(undefined4 *)(unaff_EBX + 0x58) = 0xffffffff;
        *(undefined4 *)(unaff_EBX + 0x50) = 0x2b726e6b;
        uVar1 = local_4;
        goto LAB_100106f3;
      }
LAB_10010633:
      uVar1 = uVar1 + 1;
      local_10 = local_10 + 1;
      piVar3 = piVar3 + 2;
    } while ((int)uVar1 < 0x90);
  }
  return CONCAT31((int3)((uint)pbVar2 >> 8),1);
}



uint FUN_100107a0(void)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int unaff_EBX;
  int unaff_ESI;
  int unaff_EDI;
  
  iVar3 = *(int *)(unaff_ESI + 0x30);
  while ((iVar3 != 0 &&
         (uVar2 = *(uint *)(unaff_ESI + 0x30), uVar2 < *(uint *)(unaff_EDI + 0x11e8d5c)))) {
    uVar1 = *(uint *)(unaff_EDI + 0x11e8d60);
    iVar3 = uVar2 + 1;
    *(int *)(unaff_ESI + 0x30) = iVar3;
    if (*(int *)((uVar2 % uVar1) * 0x118 + 0x11e8d64 + unaff_EDI) + 1 == iVar3) {
      uVar2 = FUN_10003e20(*(byte **)(unaff_EBX + 0x60),*(size_t *)(unaff_EBX + 0x5c),
                           (byte *)"TYPE=%d TARG=%d KIND=%d CODE=%d DATA=%s");
      *(undefined4 *)(unaff_EBX + 0x58) = 0xffffffff;
      *(undefined4 *)(unaff_EBX + 0x50) = 0x2b617379;
      return uVar2 & 0xffffff00;
    }
  }
  return CONCAT31((int3)((uint)iVar3 >> 8),1);
}



uint __fastcall FUN_10010830(undefined4 param_1,int param_2)

{
  int in_EAX;
  uint uVar1;
  int unaff_ESI;
  
  if (((*(uint *)(param_2 + 4) & 0x80000) != 0) &&
     (*(int *)(param_2 + 0x514) != *(int *)(in_EAX + 0x1274e90))) {
    *(int *)(param_2 + 0x514) = *(int *)(in_EAX + 0x1274e90);
    uVar1 = FUN_10003e20(*(byte **)(unaff_ESI + 0x60),*(size_t *)(unaff_ESI + 0x5c),
                         (byte *)"UIL=%d UIR=%d UIG=%d GIP=%d GCR=%d GCM=%d");
    *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
    *(undefined4 *)(unaff_ESI + 0x50) = 0x2b737374;
    return uVar1 & 0xffffff00;
  }
  return CONCAT31((int3)((uint)in_EAX >> 8),1);
}



uint FUN_100108a0(void)

{
  int in_EAX;
  char *pcVar1;
  int iVar2;
  uint uVar3;
  int unaff_EBX;
  int unaff_ESI;
  char *local_104;
  byte local_100 [256];
  
  if ((-1 < *(int *)(in_EAX + 0x4e4)) && (*(int *)(in_EAX + 0x4e4) != *(int *)(unaff_EBX + 0x15e8)))
  {
    *(undefined4 *)(in_EAX + 0x4e4) = 0xffffffff;
    FUN_10016490(4);
  }
  iVar2 = *(int *)(in_EAX + 0x4e4);
  if (iVar2 < 0) {
    pcVar1 = FUN_1002a540(*(uint **)(unaff_EBX + 0x15ec),-iVar2,&local_104);
    *(int *)(in_EAX + 0x4e4) = *(int *)(in_EAX + 0x4e4) + -1;
    if (pcVar1 != (char *)0x0) {
      iVar2 = FUN_100020b0(*(char **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),local_104);
      iVar2 = iVar2 + 1;
      uVar3 = FUN_100020b0((char *)(*(int *)(unaff_ESI + 0x60) + iVar2),
                           *(int *)(unaff_ESI + 0x5c) - iVar2,pcVar1);
      *(uint *)(unaff_ESI + 0x58) = uVar3 + 1 + iVar2;
      *(undefined4 *)(unaff_ESI + 0x50) = 0x2b736563;
      return uVar3 & 0xffffff00;
    }
    pcVar1 = FUN_1002a540(*(uint **)(unaff_EBX + 0x15ec),0,(undefined4 *)0x0);
    FUN_100020b0(*(char **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),pcVar1);
    local_100[0] = 0;
    iVar2 = FUN_1002d3a0(unaff_EBX,(char *)local_100,0x100);
    if (iVar2 == 0) {
      FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),(byte *)"GFIDS",local_100
                  );
    }
    FUN_1002d7c0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c));
    *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
    *(undefined4 *)(unaff_ESI + 0x50) = 0x2b636667;
    *(undefined4 *)(in_EAX + 0x4e4) = *(undefined4 *)(unaff_EBX + 0x15e8);
    uVar3 = FUN_10016490(4);
    return uVar3 & 0xffffff00;
  }
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



uint __fastcall FUN_10010a00(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  int unaff_ESI;
  
  iVar1 = *(int *)(param_2 + 0x12755ec);
  if (*(int *)(param_1 + 0x518) != iVar1) {
    *(int *)(param_1 + 0x518) = iVar1;
    uVar2 = FUN_10002d30(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),
                         (byte *)"THRESHOLDS",(uint *)(param_2 + 0x1275148),0x4a4,&DAT_1004e4d4);
    *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
    *(undefined4 *)(unaff_ESI + 0x50) = 0x2b6c766c;
    return uVar2 & 0xffffff00;
  }
  return CONCAT31((int3)((uint)iVar1 >> 8),1);
}



undefined4 __cdecl FUN_10010d10(int param_1)

{
  *(undefined4 *)(param_1 + 0x54) = 0;
  *(undefined4 *)(param_1 + 0x28) = 0;
  return 0;
}



void __cdecl
FUN_10010db0(int param_1,uint param_2,uint param_3,uint param_4,char *param_5,char *param_6)

{
  uint *puVar1;
  char cVar2;
  int iVar3;
  
  puVar1 = (uint *)((*(uint *)(param_1 + 0x8d54) % *(uint *)(param_1 + 0x8d58)) * 0x478 + 0x8d5c +
                   param_1);
  *puVar1 = *(uint *)(param_1 + 0x8d54);
  *(int *)(param_1 + 0x8d54) = *(int *)(param_1 + 0x8d54) + 1;
  puVar1[0x11b] = 0;
  puVar1[0x11c] = 0;
  puVar1[0x11d] = *(uint *)(param_1 + 0x1994);
  puVar1[0x117] = param_2;
  puVar1[0x118] = param_3;
  puVar1[0x116] = param_4;
  iVar3 = 4 - (int)param_5;
  do {
    cVar2 = *param_5;
    param_5[(int)puVar1 + iVar3] = cVar2;
    param_5 = param_5 + 1;
  } while (cVar2 != '\0');
  iVar3 = 0x14 - (int)param_6;
  do {
    cVar2 = *param_6;
    param_6[(int)puVar1 + iVar3] = cVar2;
    param_6 = param_6 + 1;
  } while (cVar2 != '\0');
  return;
}



void __cdecl FUN_10010eb0(int param_1)

{
  void *pvVar1;
  void *_Memory;
  int iVar2;
  int iVar3;
  undefined4 local_4;
  
  iVar2 = 0;
  local_4 = 0;
  if (*(int *)(param_1 + 0x8d4c) != 0) {
    do {
      _Memory = *(void **)(*(int *)(param_1 + 0x8d50) + 0x28 + iVar2);
      iVar3 = *(int *)(param_1 + 0x8d50) + iVar2;
      pvVar1 = (void *)(iVar3 + 0x2c);
      if (_Memory != pvVar1) {
        _free(_Memory);
        *(void **)(iVar3 + 0x28) = pvVar1;
      }
      local_4 = local_4 + 1;
      iVar2 = iVar2 + 300;
    } while (local_4 < *(uint *)(param_1 + 0x8d4c));
  }
  _free(*(void **)(param_1 + 0x8d50));
  return;
}



void __cdecl FUN_10010f20(int param_1,uint param_2,char *param_3,char *param_4)

{
  char cVar1;
  char *pcVar2;
  void *pvVar3;
  uint *puVar4;
  
  puVar4 = (uint *)((*(uint *)(param_1 + 0x8d48) % *(uint *)(param_1 + 0x8d4c)) * 300 +
                   *(int *)(param_1 + 0x8d50));
  *puVar4 = *(uint *)(param_1 + 0x8d48);
  *(int *)(param_1 + 0x8d48) = *(int *)(param_1 + 0x8d48) + 1;
  puVar4[1] = param_2;
  if (param_3 == (char *)0x0) {
    param_3 = "";
  }
  FUN_100020b0((char *)(puVar4 + 2),0x20,param_3);
  if ((uint *)puVar4[10] != puVar4 + 0xb) {
    _free((uint *)puVar4[10]);
    puVar4[10] = (uint)(puVar4 + 0xb);
  }
  pcVar2 = param_4;
  do {
    cVar1 = *pcVar2;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  if (0xff < (int)pcVar2 - (int)(param_4 + 1)) {
    pvVar3 = _malloc(((int)pcVar2 - (int)(param_4 + 1)) + 1);
    puVar4[10] = (uint)pvVar3;
  }
  pcVar2 = (char *)puVar4[10];
  do {
    cVar1 = *param_4;
    param_4 = param_4 + 1;
    *pcVar2 = cVar1;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  FUN_10016490(param_2);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_10010fe0(int param_1,uint param_2,char *param_3)

{
  char *pcVar1;
  char local_2000 [8188];
  undefined4 uStack_4;
  
  uStack_4 = 0x10010fea;
  pcVar1 = FUN_10017330(local_2000,0x2000,param_3,(int)&stack0x00000010);
  FUN_10010f20(param_1,param_2,(char *)0x0,pcVar1);
  return;
}



int * __cdecl FUN_10011030(int param_1,uint *param_2,uint param_3)

{
  int *piVar1;
  uint uVar2;
  
  if (*param_2 != *(uint *)(param_1 + 0x8d48)) {
    do {
      piVar1 = (int *)((*param_2 % *(uint *)(param_1 + 0x8d4c)) * 300 + *(int *)(param_1 + 0x8d50));
      uVar2 = *param_2 + 1;
      *param_2 = uVar2;
      if ((*piVar1 + 1U == uVar2) && ((piVar1[1] & param_3) != 0)) {
        return piVar1;
      }
    } while (*param_2 != *(uint *)(param_1 + 0x8d48));
  }
  return (int *)0x0;
}



void __cdecl FUN_10011140(undefined4 param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  undefined4 *puVar6;
  int *piVar7;
  void *this;
  long lVar8;
  byte *pbVar9;
  byte *pbVar10;
  int iVar11;
  code *pcVar12;
  byte *pbVar13;
  int iVar14;
  byte *pbVar15;
  int iVar16;
  int local_58;
  int local_54;
  byte local_50 [16];
  byte local_40 [32];
  byte local_20 [32];
  
  pbVar2 = param_2;
  iVar3 = FUN_10022340(*(int *)(param_2 + 0x19b0),&local_54,&local_58,&param_2);
  do {
    if (iVar3 < 0) {
      return;
    }
    if (local_54 < 0) {
      uVar4 = FUN_100387a0(*(int *)(pbVar2 + 0x2638),*(int **)(pbVar2 + 0x2634),local_54,local_58,
                           iVar3,(char *)param_2);
      if (((((char)uVar4 == '\0') &&
           (uVar5 = FUN_10014340(*(int *)(pbVar2 + 0x1400),-local_54), uVar5 != 0)) &&
          (*(int *)(uVar5 + 0x28) != 0)) && (iVar14 = *(int *)(uVar5 + 0x94), iVar14 != 0)) {
        puVar6 = FUN_10028690(*(int **)(pbVar2 + 0x2634),iVar3 + 1);
        *(undefined4 **)(iVar14 + 0x500) = puVar6;
        pbVar10 = (byte *)puVar6[3];
        pbVar9 = param_2;
        do {
          bVar1 = *pbVar9;
          pbVar9 = pbVar9 + 1;
          *pbVar10 = bVar1;
          pbVar10 = pbVar10 + 1;
        } while (bVar1 != 0);
        **(int **)(iVar14 + 0x500) = local_54;
        *(int *)(*(int *)(iVar14 + 0x500) + 4) = local_58;
        *(undefined4 *)(uVar5 + 0x30) = 0;
      }
    }
    else if ((local_54 == 0x21757372) || (local_54 == 0x2167616d)) {
      if (local_58 == 0x73747274) {
        pbVar2[0x19c0] = 0;
        pbVar2[0x19c1] = 0;
        pbVar2[0x19c2] = 0;
        pbVar2[0x19c3] = 0;
      }
      else if (local_58 == 0x646f6e65) {
        iVar3 = 0;
        pbVar10 = FUN_100020f0(param_2,&DAT_1004f224);
        FUN_10002480((char *)pbVar10,iVar3);
        FUN_10016490(4);
        iVar3 = *(int *)(pbVar2 + 0x19c8);
        *(int *)(pbVar2 + 0x19c8) = iVar3 + 1;
        if (iVar3 + 1 == 1) {
          pbVar2[0x19bc] = 1;
          pbVar2[0x19bd] = 0;
          pbVar2[0x19be] = 0;
          pbVar2[0x19bf] = 0;
          FUN_1000e760(0,0,(int)pbVar2);
        }
        else {
LAB_100113f5:
          FUN_1000e430();
        }
      }
      else {
        (**(code **)(&DAT_100570dc + *(int *)(pbVar2 + 0x19c8) * 0x18))(pbVar2,param_2);
        iVar3 = *(int *)(pbVar2 + 0x19c0);
        *(uint *)(pbVar2 + 0x19c0) = iVar3 + 1U;
        if ((iVar3 + 1U & 0x7fff) == 0) {
          FUN_10016490(4);
        }
      }
    }
    else if (local_54 == 0x21646c70) {
      pbVar15 = &DAT_1004d26f;
      iVar3 = 0x20;
      pbVar10 = local_20;
      pbVar9 = FUN_100020f0(param_2,&DAT_1004d8d8);
      FUN_10002a30(pbVar9,pbVar10,iVar3,pbVar15);
      pbVar10 = pbVar2 + 0x1748;
      iVar3 = 0x90;
      do {
        if (*(int **)pbVar10 != (int *)0x0) {
          FUN_10021610(*(int **)pbVar10,local_20);
        }
        pbVar10 = pbVar10 + 4;
        iVar3 = iVar3 + -1;
      } while (iVar3 != 0);
      piVar7 = (int *)FUN_10022a40(*(void **)(pbVar2 + 0x1610),(int)*(void **)(pbVar2 + 0x1610),
                                   local_20);
      if (piVar7 != (int *)0x0) {
        FUN_10037720(pbVar2,piVar7);
      }
    }
    else if (local_54 == 0x21626174) {
      FUN_10038830(*(int *)(pbVar2 + 0x2638),0x21626174,local_58,iVar3,param_2);
    }
    else if (local_54 == 0x21627475) {
      pbVar15 = &DAT_1004d26f;
      iVar3 = 0x10;
      pbVar10 = local_50;
      pbVar9 = FUN_100020f0(param_2,&DAT_1004d8d8);
      FUN_10002a30(pbVar9,pbVar10,iVar3,pbVar15);
      if ((local_50[0] != 0) &&
         (piVar7 = (int *)FUN_10022a40(local_50,*(int *)(pbVar2 + 0x1610),local_50),
         piVar7 != (int *)0x0)) {
        piVar7[2] = piVar7[2] | 0x4000000;
        FUN_100260e0(*(int *)(pbVar2 + 0x1614),*piVar7);
        FUN_10010fe0((int)pbVar2,0x80000,"<ADMIN time=%e target=%s>%s</>");
      }
    }
    else if (local_54 == 0x2a736470) {
      if (local_58 == 0) {
        if (pbVar2[0x19c4] == 0) {
          pbVar2[0x19c4] = 1;
          FUN_10022490(*(undefined4 **)(pbVar2 + 0x19b0),0x2a676c76,0,"CONFIG=1",(char *)0xffffffff)
          ;
          goto LAB_100113f5;
        }
      }
      else if (*(int *)(pbVar2 + 0x19bc) == 0) {
        FUN_10016450(4);
        FUN_100141b0(*(int **)(pbVar2 + 0x1400));
      }
    }
    else if (local_54 == 0x2a646d70) {
      if (local_58 != 0) {
        FUN_10016450(4);
        uVar4 = 0;
        pcVar12 = FUN_1000e570;
        uVar5 = 10000;
        pbVar10 = pbVar2;
        this = (void *)FUN_10022980(*(undefined4 **)(pbVar2 + 0x1400));
        FUN_100230b0(this,uVar5,pcVar12,uVar4,pbVar10);
      }
    }
    else if (local_54 == 0x2a676c76) {
      iVar3 = 0;
      pbVar10 = pbVar2 + 0x12752d4;
      do {
        iVar16 = 0x2c;
        pbVar13 = &DAT_1004f244;
        iVar11 = 0x20;
        pbVar9 = local_40;
        iVar14 = iVar3;
        pbVar15 = FUN_100020f0(param_2,(byte *)"SKILL");
        FUN_10003680(pbVar15,pbVar9,iVar11,pbVar13,iVar14,iVar16);
        lVar8 = _atol((char *)local_40);
        iVar16 = 0x2c;
        pbVar13 = &DAT_1004f244;
        iVar11 = 0x20;
        pbVar9 = local_40;
        *(long *)(pbVar10 + -0x18c) = lVar8;
        iVar14 = iVar3;
        pbVar15 = FUN_100020f0(param_2,(byte *)"SOCIAL");
        FUN_10003680(pbVar15,pbVar9,iVar11,pbVar13,iVar14,iVar16);
        lVar8 = _atol((char *)local_40);
        iVar16 = 0x2c;
        pbVar13 = &DAT_1004f244;
        iVar11 = 0x20;
        pbVar9 = local_40;
        *(long *)pbVar10 = lVar8;
        iVar14 = iVar3;
        pbVar15 = FUN_100020f0(param_2,(byte *)"GAMER");
        FUN_10003680(pbVar15,pbVar9,iVar11,pbVar13,iVar14,iVar16);
        lVar8 = _atol((char *)local_40);
        *(long *)(pbVar10 + 0x18c) = lVar8;
        iVar3 = iVar3 + 1;
        pbVar10 = pbVar10 + 4;
      } while (iVar3 < 99);
      *(int *)(pbVar2 + 0x12755ec) = *(int *)(pbVar2 + 0x12755ec) + 1;
    }
    FUN_100223d0(*(int *)(pbVar2 + 0x19b0),(undefined4 *)0x0,(undefined4 *)0x0,(undefined4 *)0x0,0);
    iVar3 = FUN_10022340(*(int *)(pbVar2 + 0x19b0),&local_54,&local_58,&param_2);
  } while( true );
}



void __cdecl FUN_10011ef0(int *param_1)

{
  int *piVar1;
  void *_Memory;
  void *pvVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  
  FUN_10010fe0((int)param_1,0x80000,"<NOTICE time=%e>%s</>");
  FUN_10028640((int *)param_1[0x98d]);
  FUN_10038540((void *)param_1[0x98e]);
  iVar4 = *param_1;
  piVar5 = param_1;
  while (iVar4 != 0) {
    if (*piVar5 == 0x3c3c3c3c) {
      (*(code *)piVar5[2])(param_1,0,0);
    }
    piVar1 = piVar5 + 5;
    piVar5 = piVar5 + 5;
    iVar4 = *piVar1;
  }
  FUN_10020fe0((void *)param_1[0x653]);
  FUN_10020fe0((void *)param_1[0x652]);
  FUN_10010eb0((int)param_1);
  pvVar2 = (void *)FUN_10022920((int *)param_1[0x662]);
  while (pvVar2 != (void *)0x0) {
    FUN_1002a880(pvVar2);
    pvVar2 = (void *)FUN_10022920((int *)param_1[0x662]);
  }
  FUN_10022830((void *)param_1[0x662]);
  pvVar2 = (void *)FUN_10022920((int *)param_1[0x580]);
  while (pvVar2 != (void *)0x0) {
    FUN_10026fa0((int)pvVar2);
    _free(pvVar2);
    pvVar2 = (void *)FUN_10022920((int *)param_1[0x580]);
  }
  FUN_10022830((void *)param_1[0x580]);
  FUN_10026000((void *)param_1[0x581]);
  iVar4 = 1;
  pvVar2 = (void *)FUN_100261a0(param_1[0x582],1);
  while (pvVar2 != (void *)0x0) {
    _Memory = *(void **)((int)pvVar2 + 0x214f8);
    if (_Memory != (void *)0x0) {
      FUN_10023700((int)_Memory);
      _free(_Memory);
    }
    _free(pvVar2);
    iVar4 = iVar4 + 1;
    pvVar2 = (void *)FUN_100261a0(param_1[0x582],iVar4);
  }
  FUN_10026000((void *)param_1[0x582]);
  iVar4 = FUN_10022920((int *)param_1[0x5c9]);
  while (iVar4 != 0) {
    FUN_10026c30(param_1[0x5cb],iVar4);
    iVar4 = FUN_10022920((int *)param_1[0x5c9]);
  }
  FUN_10022830((void *)param_1[0x5c9]);
  FUN_10026000((void *)param_1[0x5ca]);
  FUN_1002a690((void *)param_1[0x5cb],'\0');
  FUN_10022830((void *)param_1[0x5cc]);
  iVar4 = 1;
  iVar3 = FUN_100262c0(param_1[0x5cd]);
  while (0 < iVar3) {
    pvVar2 = (void *)FUN_100261a0(param_1[0x5cd],iVar4);
    if (pvVar2 != (void *)0x0) {
      _free(pvVar2);
    }
    iVar4 = iVar4 + 1;
    iVar3 = FUN_100262c0(param_1[0x5cd]);
  }
  FUN_10026000((void *)param_1[0x5cd]);
  pvVar2 = (void *)FUN_10022920((int *)param_1[0x5ce]);
  while (pvVar2 != (void *)0x0) {
    FUN_100256b0(pvVar2);
    pvVar2 = (void *)FUN_10022920((int *)param_1[0x5ce]);
  }
  FUN_10022830((void *)param_1[0x5ce]);
  FUN_10026000((void *)param_1[0x5cf]);
  pvVar2 = (void *)FUN_10022920((int *)param_1[0x584]);
  while (pvVar2 != (void *)0x0) {
    _free(pvVar2);
    pvVar2 = (void *)FUN_10022920((int *)param_1[0x584]);
  }
  FUN_10022830((void *)param_1[0x584]);
  FUN_10022830((void *)param_1[0x583]);
  FUN_10026000((void *)param_1[0x585]);
  pvVar2 = (void *)FUN_10022920((int *)param_1[0x57d]);
  while (pvVar2 != (void *)0x0) {
    _free(pvVar2);
    pvVar2 = (void *)FUN_10022920((int *)param_1[0x57d]);
  }
  FUN_10022830((void *)param_1[0x57d]);
  FUN_10026000((void *)param_1[0x57e]);
  FUN_100391b0((void *)param_1[0x5d1]);
  FUN_10024ca0((void *)param_1[0x735]);
  FUN_10024ca0((void *)param_1[0x736]);
  FUN_100220d0((void *)param_1[0x66a]);
  FUN_100220d0((void *)param_1[0x66c]);
  FUN_100220d0((void *)param_1[0x66d]);
  pvVar2 = (void *)FUN_10022920((int *)param_1[0x98f]);
  while (pvVar2 != (void *)0x0) {
    FUN_10015f70(pvVar2);
    pvVar2 = (void *)FUN_10022920((int *)param_1[0x98f]);
  }
  FUN_10022830((void *)param_1[0x98f]);
  FUN_10017c60((undefined4 *)param_1[0x49d39d]);
  pvVar2 = (void *)param_1[0x49d57c];
  if (pvVar2 != (void *)0x0) {
    FUN_10038a10((int)pvVar2);
    _free(pvVar2);
  }
  _free(param_1);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_100122b0(int *param_1,int param_2,byte *param_3)

{
  int *piVar1;
  byte *pbVar2;
  byte *pbVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  char *pcVar8;
  uint uVar9;
  int iStack_1014;
  byte abStack_1010 [16];
  byte local_1000 [4092];
  undefined4 uStack_4;
  
  uStack_4 = 0x100122ba;
  param_1[0x57b] = param_2;
  if (param_3 != (byte *)0x0) {
    local_1000[0] = 0;
    FUN_10003240(local_1000,0x1000,(byte *)"STAMP",0);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x40;
    pbVar3 = (byte *)(param_1 + 0x54a);
    pbVar2 = FUN_100020f0(local_1000,(byte *)"STAMP");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    if (param_1[0x57a] == 0) {
      FUN_10010fe0((int)param_1,0x80000,"<NOTICE time=%e>%s</>");
    }
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x6b5);
    pbVar2 = FUN_100020f0(param_3,(byte *)"PATHLOG");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x6f5);
    pbVar2 = FUN_100020f0(param_3,(byte *)"ARCHLOG");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    pcVar8 = "Crypt %d";
    iVar5 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x737);
    pbVar2 = FUN_100020f0(param_3,(byte *)"CRYPT");
    FUN_10002a30(pbVar2,pbVar3,iVar5,(byte *)pcVar8);
    iVar5 = 0x20;
    pbVar3 = (byte *)(param_1 + 0x777);
    pbVar2 = FUN_100020f0(param_3,(byte *)"SECRET");
    pbVar3 = FUN_10002c10((char *)pbVar2,pbVar3,iVar5);
    uVar9 = 0xffffff00;
    *(bool *)(param_1 + 0x77f) = 0 < (int)pbVar3;
    pbVar3 = FUN_100020f0(param_3,(byte *)"TRUST");
    uVar9 = FUN_10002780(pbVar3,uVar9);
    pcVar8 = "ober4icer";
    param_1[0x984] = uVar9;
    iVar5 = 0x20;
    pbVar3 = (byte *)(param_1 + 0x985);
    pbVar2 = FUN_100020f0(param_3,(byte *)"WEBPASS");
    FUN_10002a30(pbVar2,pbVar3,iVar5,(byte *)pcVar8);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x20;
    pbVar3 = (byte *)(param_1 + 0x501);
    pbVar2 = FUN_100020f0(param_3,(byte *)"LOBBY_IDENT");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x400;
    pbVar3 = (byte *)((int)param_1 + 0x1dfd);
    pbVar2 = FUN_100020f0(param_3,(byte *)"ADMIN_LIST");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x400;
    pbVar3 = (byte *)((int)param_1 + 0x21fd);
    pbVar2 = FUN_100020f0(param_3,(byte *)"ADMIN_FILT");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x10;
    pbVar3 = (byte *)((int)param_1 + 0x25fd);
    pbVar2 = FUN_100020f0(param_3,(byte *)"ADMIN_BUDDY");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    pbVar7 = &DAT_1004d26f;
    iVar5 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x49d3ba);
    pbVar2 = FUN_100020f0(param_3,(byte *)"AUDIT_LIST");
    FUN_10002a30(pbVar2,pbVar3,iVar5,pbVar7);
    pbVar3 = FUN_10014600(param_1[0x500],(byte *)"FILTER-TEXT");
    FUN_10024d30((undefined4 *)param_1[0x735],pbVar3);
    pbVar3 = FUN_10014600(param_1[0x500],(byte *)"FILTER-NAME");
    FUN_10024d30((undefined4 *)param_1[0x736],pbVar3);
    pcVar8 = FUN_10014600(param_1[0x500],(byte *)"FILTER");
    if (*pcVar8 != '\0') {
      pbVar3 = FUN_10014600(param_1[0x500],(byte *)"FILTER");
      FUN_10024d30((undefined4 *)param_1[0x735],pbVar3);
      pbVar3 = FUN_10014600(param_1[0x500],(byte *)"FILTER");
      FUN_10024d30((undefined4 *)param_1[0x736],pbVar3);
    }
    FUN_10038fa0((undefined4 *)param_1[0x5d1],param_3);
    iVar5 = 1000;
    pbVar3 = FUN_100020f0(param_3,(byte *)"ROOMMAX");
    iVar5 = FUN_10002480((char *)pbVar3,iVar5);
    iVar6 = 0;
    param_1[0x57c] = iVar5;
    pbVar3 = FUN_100020f0(param_3,(byte *)"ROOM_DOOR_MESG");
    iVar5 = FUN_10002480((char *)pbVar3,iVar6);
    iVar6 = 0x1ff;
    param_1[0x57f] = iVar5;
    pbVar3 = FUN_100020f0(param_3,(byte *)"DEFAULT_USER_COLOR");
    iVar5 = FUN_10002480((char *)pbVar3,iVar6);
    pbVar7 = &DAT_1004d26f;
    iVar6 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x49d35c);
    param_1[0x49d35b] = iVar5;
    pbVar2 = FUN_100020f0(param_3,(byte *)"ALERTS_DCR_URL");
    FUN_10002a30(pbVar2,pbVar3,iVar6,pbVar7);
    uVar9 = 0;
    pbVar3 = FUN_100020f0(param_3,(byte *)"DEFAULT_ALERT_SETTINGS");
    uVar9 = FUN_100025a0((char *)pbVar3,uVar9);
    iVar5 = 0x1ff;
    param_1[0x49d39c] = uVar9;
    pbVar3 = FUN_100020f0(param_3,(byte *)"DEFAULT_USER_COLOR");
    iVar5 = FUN_10002480((char *)pbVar3,iVar5);
    iVar6 = 5;
    param_1[0x49d35b] = iVar5;
    pbVar3 = FUN_100020f0(param_3,(byte *)"SERVER_STAT_REFRESH");
    iVar5 = FUN_10002480((char *)pbVar3,iVar6);
    param_1[0x49d3a5] = iVar5 * 1000;
    iVar5 = *param_1;
    piVar4 = param_1;
    while (iVar5 != 0) {
      if (*piVar4 == 0x26262626) {
        (*(code *)piVar4[2])(param_1,param_3,0);
      }
      piVar1 = piVar4 + 5;
      piVar4 = piVar4 + 5;
      iVar5 = *piVar1;
    }
    pcVar8 = "STAT,INFO";
    iVar5 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x49d3fa);
    pbVar2 = FUN_100020f0(param_3,(byte *)"UNRANKALL_FIELDS");
    FUN_10002a30(pbVar2,pbVar3,iVar5,(byte *)pcVar8);
    pcVar8 = "........................";
    iVar5 = 0x18;
    pbVar3 = (byte *)(param_1 + 0x49d43a);
    pbVar2 = FUN_100020f0(param_3,(byte *)"CONFIG_RELOAD_SCHEDULE");
    FUN_10002a30(pbVar2,pbVar3,iVar5,(byte *)pcVar8);
    iVar5 = 0x5a;
    pbVar3 = FUN_100020f0(param_3,(byte *)"LKEY_REFRESH_INTERVAL");
    iVar5 = FUN_10002480((char *)pbVar3,iVar5);
    iVar6 = 10;
    param_1[0x49d44f] = iVar5 * 60000;
    pbVar3 = FUN_100020f0(param_3,(byte *)"LKEY_REFRESH_CHECK");
    iVar5 = FUN_10002480((char *)pbVar3,iVar6);
    param_1[0x49d450] = iVar5 * 60000;
    FUN_10034dd0((int)param_1);
    if ((char)param_1[0x671] != '\0') {
      FUN_10022490((undefined4 *)param_1[0x66c],0x2a676c76,0,"CONFIG=1",(char *)0xffffffff);
    }
    iVar5 = 0;
    pbVar3 = FUN_100020f0(param_3,(byte *)"GAME_INFO_SYNC_PERIOD");
    iVar5 = FUN_10002480((char *)pbVar3,iVar5);
    FUN_10038be0((void *)param_1[0x49d57c],iVar5 * 1000);
    iVar5 = 0;
    pbVar3 = FUN_100020f0(param_3,(byte *)"KOTH_TOP_COLORS_ENABLED");
    iVar5 = FUN_10002480((char *)pbVar3,iVar5);
    *(bool *)(param_1 + 0x49d443) = iVar5 != 0;
    if (iVar5 != 0) {
      iStack_1014 = 0;
      do {
        pbVar3 = (byte *)FUN_100022d0(param_3,"KOTH_TOP_COLOR",iStack_1014);
        if (pbVar3 == (byte *)0x0) {
          if (iStack_1014 == 0) {
            uVar9 = 0x31;
          }
          else if (iStack_1014 == 1) {
            uVar9 = 0x19;
          }
          else {
            uVar9 = param_1[iStack_1014 + 0x49d443];
          }
        }
        else {
          FUN_10003680(pbVar3,abStack_1010,0x10,&DAT_1004f244,0,0x2c);
          uVar9 = FUN_10002480((char *)abStack_1010,0);
          FUN_10003680(pbVar3,abStack_1010,0x10,&DAT_1004f244,1,0x2c);
          iVar5 = FUN_10002480((char *)abStack_1010,0);
          FUN_10003680(pbVar3,abStack_1010,0x10,&DAT_1004f244,2,0x2c);
          iVar6 = FUN_10002480((char *)abStack_1010,0);
          uVar9 = (uVar9 & 0xe0) << 1 | iVar5 >> 2 & 0x38U | iVar6 >> 5 & 7U;
        }
        param_1[iStack_1014 + 0x49d444] = uVar9;
        iStack_1014 = iStack_1014 + 1;
      } while (iStack_1014 < 5);
    }
    iVar5 = 0;
    pbVar3 = FUN_100020f0(param_3,(byte *)"MAX_GAMES_PER_ROOM");
    iVar5 = FUN_10002480((char *)pbVar3,iVar5);
    iVar6 = 0;
    param_1[0x49d57d] = iVar5;
    pbVar3 = FUN_100020f0(param_3,(byte *)"ENABLE_GAME_ADDR_FIXUPS");
    iVar5 = FUN_10002480((char *)pbVar3,iVar6);
    *(bool *)(param_1 + 0x49d57e) = iVar5 != 0;
    param_1[0x57a] = param_1[0x57a] + 1;
    FUN_10010fe0((int)param_1,0x80000,"<NOTICE time=%e rev=%d>%s</>");
    FUN_10016490(4);
  }
  return;
}



uint __thiscall FUN_10012940(void *this,int param_1)

{
  int *piVar1;
  uint uVar2;
  int unaff_ESI;
  
  piVar1 = *(int **)((int)this + 0x504);
  if (piVar1 != (int *)0x0) {
    piVar1 = FUN_10011030(param_1,(uint *)((int)this + 0x508),(uint)piVar1);
    if (piVar1 != (int *)0x0) {
      **(undefined1 **)(unaff_ESI + 0x60) = 0;
      FUN_100024f0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004f5a0,piVar1[1]);
      FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004f59c,
                   (byte *)(piVar1 + 2));
      uVar2 = FUN_10003cf0(*(byte **)(unaff_ESI + 0x60),*(int *)(unaff_ESI + 0x5c),&DAT_1004e528,
                           (byte *)piVar1[10]);
      *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
      *(undefined4 *)(unaff_ESI + 0x50) = 0x2b6c6f67;
      return uVar2 & 0xffffff00;
    }
  }
  return CONCAT31((int3)((uint)piVar1 >> 8),1);
}



void __cdecl FUN_100129d0(int param_1,int param_2,uint *param_3,uint param_4)

{
  uint uVar1;
  undefined4 uVar2;
  undefined4 extraout_ECX;
  int extraout_ECX_00;
  
  uVar1 = FUN_1000fdb0();
  if ((char)uVar1 == '\0') {
    return;
  }
  uVar2 = FUN_1000fe70(param_1);
  if ((char)uVar2 == '\0') {
    return;
  }
  uVar2 = FUN_1000ff60((int)param_3);
  if ((char)uVar2 == '\0') {
    return;
  }
  uVar2 = FUN_10010110(param_3);
  if ((char)uVar2 == '\0') {
    return;
  }
  uVar2 = FUN_100101c0((int)param_3);
  if ((char)uVar2 == '\0') {
    return;
  }
  uVar2 = FUN_100103a0(param_3);
  if ((char)uVar2 == '\0') {
    return;
  }
  uVar2 = FUN_10010590(param_1,(int)param_3);
  if ((char)uVar2 == '\0') {
    return;
  }
  uVar1 = FUN_100107a0();
  if ((char)uVar1 != '\0') {
    uVar2 = FUN_10010830(extraout_ECX,(int)param_3);
    if ((char)uVar2 == '\0') {
      return;
    }
    uVar2 = FUN_10012940(param_3,param_1);
    if ((char)uVar2 == '\0') {
      return;
    }
    uVar2 = FUN_1000fef0(extraout_ECX_00);
    if ((char)uVar2 == '\0') {
      return;
    }
    uVar1 = FUN_10010500(param_1);
    if ((char)uVar1 != '\0') {
      uVar1 = FUN_10010a00((int)param_3,param_1);
      if ((char)uVar1 == '\0') {
        return;
      }
      uVar2 = FUN_10010450(param_1);
      if ((char)uVar2 != '\0') {
        if ((((((param_3[0x138] != 0) &&
               ((param_3[0xb] == 0 || (param_3[0xb] == *(uint *)(param_1 + 0x8d54))))) &&
              ((param_3[0xc] == 0 || (param_3[0xc] == *(uint *)(param_1 + 0x11e8d5c))))) &&
             ((((param_3[4] == 0 ||
                (uVar1 = FUN_100262d0(*(int *)(param_1 + 0x15f8)), param_3[4] == uVar1)) &&
               ((param_3[6] == 0 ||
                (uVar1 = FUN_100262d0(*(int *)(param_1 + 0x1604)), param_3[6] == uVar1)))) &&
              ((param_3[2] == 0 ||
               (uVar1 = FUN_100262d0(*(int *)(param_1 + 0x1614)), param_3[2] == uVar1)))))) &&
            ((param_3[7] == 0 ||
             (uVar1 = FUN_100262d0(*(int *)(param_1 + 0x173c)), param_3[7] == uVar1)))) &&
           ((param_3[9] == 0 ||
            (uVar1 = FUN_100262d0(*(int *)(param_1 + 0x1728)), param_3[9] == uVar1)))) {
          param_3[0x138] = 0;
          FUN_10022130(*(int *)(param_1 + 0x19b4),0x706f7274);
          FUN_10022130(*(int *)(param_1 + 0x19b4),0x61646472);
          FUN_10022130(*(int *)(param_1 + 0x19b0),0x706f7274);
          FUN_10022130(*(int *)(param_1 + 0x19b0),0x61646472);
          FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                       (byte *)"CONTEXT=%s AADDR=%a APORT=%d CADDR=%a CPORT=%d");
          *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
          *(undefined4 *)(param_2 + 0x50) = 0x2b73796e;
          return;
        }
        uVar1 = *(uint *)(param_1 + 0x1acc);
        if (((1000 < uVar1) && (param_4 != uVar1 && -1 < (int)(param_4 - uVar1))) &&
           (*(int *)(param_2 + 0x14) != 0)) {
          *(undefined4 *)(param_2 + 0x14) = 0;
          *(undefined4 *)(param_2 + 0x50) = 0x2b736874;
          return;
        }
        FUN_100108a0();
        return;
      }
      return;
    }
    return;
  }
  return;
}



void __cdecl FUN_10012e60(int param_1)

{
  *(undefined4 *)(param_1 + 0x1c) = 0x41000000;
  *(undefined4 *)(param_1 + 0x20) = 0x5fffffff;
  *(undefined4 *)(param_1 + 0x18) = 0x51c;
  *(undefined4 *)(param_1 + 4) = 1;
  *(undefined4 *)(param_1 + 0x14) = 0x32;
  *(undefined4 *)(param_1 + 0xc) = 0x2000;
  *(undefined4 *)(param_1 + 0x10) = 0x4000;
  builtin_strncpy((char *)(param_1 + 0x24),"mast",4);
  *(undefined2 *)(param_1 + 0x28) = 0x7265;
  *(undefined1 *)(param_1 + 0x2a) = 0;
  *(undefined4 *)(param_1 + 0x44) = 0x20544547;
  *(undefined4 *)(param_1 + 0x48) = 0x2f736d2f;
  *(undefined1 *)(param_1 + 0x4c) = 0;
  *(undefined1 **)(param_1 + 0x54) = &LAB_10011670;
  *(code **)(param_1 + 0x58) = FUN_100122b0;
  *(code **)(param_1 + 0x5c) = FUN_10011ef0;
  *(undefined1 **)(param_1 + 0x60) = &LAB_1000f8b0;
  *(undefined1 **)(param_1 + 100) = &LAB_10010be0;
  *(undefined1 **)(param_1 + 0x68) = &LAB_10010a50;
  *(code **)(param_1 + 0x6c) = FUN_100129d0;
  *(undefined1 **)(param_1 + 0x70) = &LAB_10012c80;
  return;
}



void __fastcall FUN_10012f10(int param_1)

{
  int in_EAX;
  char local_20 [16];
  char local_10 [16];
  
  if (in_EAX < 0) {
    _sprintf(local_10,"%x");
  }
  else {
    _sprintf(local_10,"%c%c%c%c",in_EAX >> 0x18,in_EAX >> 0x10,in_EAX >> 8);
  }
  if (param_1 == 0) {
    _sprintf(local_20,"0");
  }
  else {
    _sprintf(local_20,"%c%c%c%c",param_1 >> 0x18,param_1 >> 0x10,param_1 >> 8,param_1);
  }
  FUN_10016490(0x10);
  return;
}



void __fastcall FUN_10012ff0(undefined4 param_1,int param_2)

{
  int in_EAX;
  int iVar1;
  char unaff_BL;
  
  iVar1 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_2 + 4),*(undefined1 *)(param_2 + 5)),
                            *(undefined1 *)(param_2 + 6)),*(undefined1 *)(param_2 + 7));
  if (((unaff_BL != '\0') || (*(int *)(in_EAX + 0x58) != 0)) &&
     (0xc < CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_2 + 8),*(undefined1 *)(param_2 + 9)),
                              *(undefined1 *)(param_2 + 10)),*(undefined1 *)(param_2 + 0xb)))) {
    FUN_10012f10(iVar1);
    return;
  }
  FUN_10012f10(iVar1);
  return;
}



undefined4 FUN_10013090(void)

{
  byte *pbVar1;
  byte *pbVar2;
  int unaff_EDI;
  undefined4 uVar3;
  char *pcVar4;
  int iVar5;
  int iVar6;
  int local_4;
  
  pbVar1 = FUN_1002a500(*(uint **)(unaff_EDI + 0xcc8),&DAT_1004d26f);
  iVar5 = 0x32;
  pbVar2 = FUN_100020f0(pbVar1,(byte *)"SLOWIDLE");
  iVar5 = FUN_10002480((char *)pbVar2,iVar5);
  iVar6 = 8000;
  *(int *)(unaff_EDI + 0xcd0) = iVar5;
  pbVar2 = FUN_100020f0(pbVar1,(byte *)"MAX_UPDATE_TIME");
  iVar5 = FUN_10002480((char *)pbVar2,iVar6);
  *(int *)(unaff_EDI + 0xcd4) = iVar5;
  FUN_10017ff0((void *)(unaff_EDI + 0xcfc),(byte *)"AUDIT",(byte *)"AUDIT_MASK",pbVar1,0);
  iVar5 = unaff_EDI + 0x44c;
  local_4 = 8;
  do {
    if ((*(int *)(iVar5 + -0x24) != 0) && (*(int *)(iVar5 + 0x34) != 0)) {
      if (*(int *)(iVar5 + -0x1c) < 1) {
        pcVar4 = "Refreshing %s";
        uVar3 = 8;
        iVar6 = iVar5;
        FUN_10016490(8);
        (**(code **)(iVar5 + 0x34))
                  (*(undefined4 *)(iVar5 + -0x24),*(undefined4 *)(unaff_EDI + 0xcc8),0,0,uVar3,
                   pcVar4,iVar6);
      }
      else {
        pcVar4 = "Reconfiguring %s";
        uVar3 = 8;
        FUN_10016490(8);
        (**(code **)(iVar5 + 0x34))
                  (*(undefined4 *)(iVar5 + -0x24),*(undefined4 *)(unaff_EDI + 0xcc8),pbVar1,
                   unaff_EDI + 0x1c,uVar3,pcVar4);
        *(undefined4 *)(iVar5 + -0x1c) = 0;
      }
    }
    iVar5 = iVar5 + 0x74;
    local_4 = local_4 + -1;
  } while (local_4 != 0);
  return 0;
}



undefined4 __cdecl FUN_10013190(int param_1,uint *param_2)

{
  char cVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  undefined4 *puVar5;
  uint *puVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  int *piVar12;
  uint uVar13;
  int *unaff_ESI;
  int *piVar14;
  char *_Str1;
  char local_20 [16];
  char local_10 [16];
  
  puVar6 = param_2;
  uVar7 = *param_2;
  if ((uVar7 & 0x12) != 0) {
    if ((((uVar7 & 2) == 0) && (unaff_ESI[5] != -1)) &&
       ((unaff_ESI[0x18] != 0 || (unaff_ESI[0xf] < unaff_ESI[0x10])))) {
      *param_2 = 0;
      unaff_ESI[5] = -2;
      return 1;
    }
    *param_2 = 0;
    FUN_10039970(*(int **)(param_1 + 0x41c),param_2[1]);
    FUN_100164d0(8,"%d: got EVT_TERM");
    if ((char)unaff_ESI[0x24] != '\0') {
      _sprintf(local_10,"%c%c%c%c",0x2a,0x2a2a,0x2a2a2a,0x2a2a2a2a);
      _sprintf(local_20,"0");
      FUN_10016490(0x10);
    }
    if ((void *)unaff_ESI[0x20] != (void *)0x0) {
      _free((void *)unaff_ESI[0x20]);
    }
    if ((void *)unaff_ESI[0x18] != (void *)0x0) {
      _free((void *)unaff_ESI[0x18]);
    }
    if ((void *)unaff_ESI[0x12] != (void *)0x0) {
      _free((void *)unaff_ESI[0x12]);
    }
    puVar5 = (undefined4 *)unaff_ESI[0x23];
    if ((puVar5 != (undefined4 *)0x0) && ((code *)puVar5[0x1c] != (code *)0x0)) {
      (*(code *)puVar5[0x1c])(*puVar5);
    }
    uVar7 = *(uint *)(param_1 + 4);
    uVar13 = unaff_ESI[3] + uVar7;
    if (0x7effffff < uVar13) {
      uVar13 = uVar13 % uVar7 + uVar7;
    }
    uVar10 = unaff_ESI[4] + uVar7;
    if (0x7effffff < uVar10) {
      uVar10 = uVar10 % uVar7 + uVar7;
    }
    piVar12 = (int *)unaff_ESI[1];
    iVar11 = *unaff_ESI;
    iVar8 = unaff_ESI[2];
    piVar14 = unaff_ESI;
    for (iVar9 = 0x26; iVar9 != 0; iVar9 = iVar9 + -1) {
      *piVar14 = 0;
      piVar14 = piVar14 + 1;
    }
    unaff_ESI[4] = uVar10;
    unaff_ESI[3] = uVar13;
    unaff_ESI[2] = iVar8;
    unaff_ESI[0x25] = *(int *)(*(int *)(param_1 + 0x10) + iVar8 * 4);
    if (iVar11 != 0) {
      *(int **)(iVar11 + 4) = piVar12;
    }
    if (piVar12 != (int *)0x0) {
      *piVar12 = iVar11;
    }
    if (unaff_ESI == *(int **)(param_1 + 0x14)) {
      *(int **)(param_1 + 0x14) = piVar12;
    }
    if (unaff_ESI == *(int **)(param_1 + 0xd88)) {
      *(undefined4 *)(param_1 + 0xd88) = *(undefined4 *)(param_1 + 0x14);
    }
    *(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + -1;
    return 0;
  }
  if ((uVar7 & 4) != 0) {
    if (unaff_ESI[0x1f] == 0) {
      uVar7 = param_2[2];
      uVar13 = param_2[5];
      _Str1 = (char *)(uVar13 + uVar7);
      iVar11 = 0;
      param_2 = (uint *)CONCAT31(CONCAT21(CONCAT11(_Str1[8],_Str1[9]),
                                          *(undefined1 *)(uVar13 + 10 + uVar7)),
                                 *(undefined1 *)(uVar13 + 0xb + uVar7));
      if (((int)param_2 < 0xc) ||
         (uVar7 = FUN_10039830(*(uint **)(param_1 + 0x41c),0x72786275), (int)uVar7 < (int)param_2))
      {
        param_2 = (uint *)0x0;
        piVar12 = (int *)(param_1 + 0x428);
        while ((*piVar12 == 0 || (iVar11 = _strncmp(_Str1,(char *)(piVar12 + 0x11),8), iVar11 != 0))
              ) {
          param_2 = (uint *)((int)param_2 + 1);
          piVar12 = piVar12 + 0x1d;
          if ((uint *)0x7 < param_2) {
            *puVar6 = *puVar6 | 0x10;
            return 0;
          }
        }
        iVar11 = piVar12[7];
        if (iVar11 == 0) {
          *puVar6 = *puVar6 | 0x10;
          return 0;
        }
        *_Str1 = (char)((uint)iVar11 >> 0x18);
        _Str1[1] = (char)((uint)iVar11 >> 0x10);
        _Str1[2] = (char)((uint)iVar11 >> 8);
        _Str1[4] = _Str1[8];
        param_2 = (uint *)0x40c;
        _Str1[3] = (char)iVar11;
        _Str1[5] = _Str1[9];
        _Str1[6] = _Str1[10];
        _Str1[7] = _Str1[0xb];
      }
      unaff_ESI[0x1d] = 0;
      unaff_ESI[0x1e] = (int)(param_2 + -3);
      unaff_ESI[0x1b] = CONCAT31(CONCAT21(CONCAT11(*_Str1,_Str1[1]),_Str1[2]),_Str1[3]);
      cVar3 = _Str1[6];
      cVar4 = _Str1[7];
      cVar1 = _Str1[4];
      cVar2 = _Str1[5];
      unaff_ESI[0x1a] = iVar11;
      unaff_ESI[0x1f] = (int)&DAT_1004d26f;
      unaff_ESI[0x1c] = CONCAT31(CONCAT21(CONCAT11(cVar1,cVar2),cVar3),cVar4);
      *puVar6 = *puVar6 ^ 4;
      iVar11 = 0x40;
      if (unaff_ESI[0x1a] == 0) {
        iVar11 = unaff_ESI[0x1e];
      }
      FUN_10039aa0(*(int **)(param_1 + 0x41c),puVar6[1],iVar11,0);
    }
    if ((*puVar6 & 4) != 0) {
LAB_10013512:
      *puVar6 = *puVar6 ^ 4;
      unaff_ESI[0x1f] = puVar6[2] + 0xc + puVar6[5];
      uVar7 = puVar6[4];
      if ((int)puVar6[3] <= (int)puVar6[4]) {
        uVar7 = puVar6[3];
      }
      iVar11 = (uVar7 - puVar6[2]) + -0xc;
      unaff_ESI[0x1d] = iVar11;
      if (unaff_ESI[0x1a] != 0) {
        iVar8 = 0;
        if (0 < iVar11) {
          do {
            if (*(char *)(unaff_ESI[0x1f] + iVar8) < ' ') {
              *(undefined1 *)(unaff_ESI[0x1f] + iVar8) = 0;
              unaff_ESI[0x1e] = unaff_ESI[0x1d];
              unaff_ESI[0x1a] = 0;
              if (((((9 < iVar8) &&
                    (iVar11 = iVar8 + unaff_ESI[0x1f],
                    *(char *)(iVar8 + -9 + unaff_ESI[0x1f]) == ' ')) &&
                   (*(char *)(iVar11 + -8) == 'H')) &&
                  ((*(char *)(iVar11 + -7) == 'T' && (*(char *)(iVar11 + -6) == 'T')))) &&
                 (*(char *)(iVar11 + -5) == 'P')) {
                *(undefined1 *)(iVar11 + -9) = 0;
              }
              *(undefined1 *)unaff_ESI[0x1f] = 9;
              iVar11 = 1;
              if (1 < unaff_ESI[0x1e]) goto LAB_100135b5;
              break;
            }
            iVar8 = iVar8 + 1;
          } while (iVar8 < unaff_ESI[0x1d]);
        }
        goto LAB_100135d0;
      }
      goto LAB_100135ee;
    }
LAB_100135f8:
    iVar11 = unaff_ESI[0x1e];
    if ((unaff_ESI[0x1d] == iVar11) && (unaff_ESI[0x1d] = iVar11, iVar11 == 0)) {
      unaff_ESI[0x1f] = param_1 + 0xd8c;
    }
  }
  return 1;
  while( true ) {
    if (cVar1 == '&') {
      *(undefined1 *)(unaff_ESI[0x1f] + iVar11) = 9;
    }
    iVar11 = iVar11 + 1;
    if (unaff_ESI[0x1e] <= iVar11) break;
LAB_100135b5:
    cVar1 = *(char *)(unaff_ESI[0x1f] + iVar11);
    if (cVar1 < ' ') break;
  }
LAB_100135d0:
  if (unaff_ESI[0x1a] != 0) {
    FUN_10039aa0(*(int **)(param_1 + 0x41c),puVar6[1],0x40,0);
  }
LAB_100135ee:
  if ((*puVar6 & 4) == 0) goto LAB_100135f8;
  goto LAB_10013512;
}



char __cdecl FUN_10013620(int param_1,int param_2,uint param_3)

{
  char *pcVar1;
  undefined1 uVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  char *pcVar6;
  char *pcVar7;
  undefined4 *puVar8;
  char *pcVar9;
  uint uVar10;
  uint _Size;
  int *piVar11;
  undefined4 *puVar12;
  
  *(undefined1 **)(param_2 + 0x60) = &DAT_10058a5c;
  *(undefined4 *)(param_2 + 0x5c) = 0xfff4;
  *(undefined4 *)(param_2 + 0x50) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0;
  if (*(int *)(param_2 + 0x28) == 0) {
    iVar4 = *(int *)(param_2 + 0x6c);
    if (iVar4 == 0x7e706e67) {
      *(uint *)(param_2 + 0x70) = param_3 - *(int *)(param_2 + 0x70);
    }
    puVar12 = *(undefined4 **)(param_2 + 0x8c);
    *(undefined4 *)(param_2 + 0x68) = 0;
    if (((puVar12 == (undefined4 *)0x0) || (iVar5 = puVar12[7], iVar4 < iVar5)) ||
       ((int)puVar12[8] < iVar4)) {
      uVar10 = 0;
      piVar11 = (int *)(param_1 + 0x428);
      do {
        if (((*piVar11 != 0) && (piVar11[7] <= iVar4)) && (iVar4 <= piVar11[8])) {
          if (iVar4 != piVar11[7]) {
            if (piVar11[0x19] != 0) {
              uVar2 = *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c));
              *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = 0;
              *(undefined4 *)(param_2 + 0x84) = 0;
              if (*(char *)(param_2 + 0x90) != '\0') {
                FUN_10012f10(*(int *)(param_2 + 0x70));
              }
              (*(code *)piVar11[0x19])(*piVar11,param_2,0);
              *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = uVar2;
              break;
            }
            if (iVar4 != piVar11[7]) break;
          }
          if (piVar11[0x1a] != 0) {
            *(undefined4 *)(param_2 + 0x6c) = *(undefined4 *)(param_2 + 0x70);
            *(undefined4 *)(param_2 + 0x70) = 0;
            *(undefined4 *)(param_2 + 0x84) = 1;
            (*(code *)piVar11[0x1a])(*piVar11,param_2,0);
          }
          break;
        }
        uVar10 = uVar10 + 1;
        piVar11 = piVar11 + 0x1d;
      } while (uVar10 < 8);
    }
    else if (iVar4 == iVar5) {
LAB_100136f9:
      if (puVar12[0x1a] != 0) {
        *(undefined4 *)(param_2 + 0x6c) = *(undefined4 *)(param_2 + 0x70);
        *(undefined4 *)(param_2 + 0x70) = 0;
        *(undefined4 *)(param_2 + 0x84) = 1;
        (*(code *)puVar12[0x1a])
                  (*puVar12,param_2,
                   *(undefined4 *)(*(int *)(param_1 + 0x10) + *(int *)(param_2 + 8) * 4));
      }
    }
    else if (puVar12[0x19] == 0) {
      if (iVar4 == iVar5) goto LAB_100136f9;
    }
    else {
      uVar2 = *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c));
      *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = 0;
      *(undefined4 *)(param_2 + 0x84) = 0;
      if (*(char *)(param_2 + 0x90) != '\0') {
        FUN_10012f10(*(int *)(param_2 + 0x70));
      }
      (*(code *)(*(undefined4 **)(param_2 + 0x8c))[0x19])
                (**(undefined4 **)(param_2 + 0x8c),param_2,
                 *(undefined4 *)(*(int *)(param_1 + 0x10) + *(int *)(param_2 + 8) * 4));
      *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = uVar2;
    }
    if (*(int *)(param_2 + 0x28) != 0) goto LAB_100137de;
  }
  else {
LAB_100137de:
    if (*(int *)(param_2 + 0x30) == 0) {
      if ((*(int **)(param_2 + 0x8c) == (int *)0x0) ||
         (**(int **)(param_2 + 0x8c) != *(int *)(param_2 + 0x2c))) {
        uVar2 = *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c));
        *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = 0;
        (**(code **)(param_2 + 0x28))(*(undefined4 *)(param_2 + 0x2c),param_2,0);
        *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = uVar2;
      }
      else {
        uVar2 = *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c));
        *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = 0;
        (**(code **)(param_2 + 0x28))
                  (*(undefined4 *)(param_2 + 0x2c),param_2,
                   *(undefined4 *)(*(int *)(param_1 + 0x10) + *(int *)(param_2 + 8) * 4));
        *(undefined1 *)(*(int *)(param_2 + 0x74) + *(int *)(param_2 + 0x7c)) = uVar2;
      }
    }
    uVar10 = *(uint *)(param_2 + 0x34);
    if (uVar10 == 0) {
      *(undefined4 *)(param_2 + 0x28) = 0;
    }
    else if (uVar10 < 0x79) {
      *(uint *)(param_2 + 0x34) = uVar10 * 1000 + param_3;
    }
    else if (param_3 != uVar10 && -1 < (int)(param_3 - uVar10)) {
      *(undefined4 *)(param_2 + 0x34) = 0xffffffff;
      *(undefined4 *)(param_2 + 0x30) = 0;
    }
    if (*(int *)(param_2 + 0x28) != 0) goto LAB_100138b8;
  }
  if (*(void **)(param_2 + 0x80) != (void *)0x0) {
    _free(*(void **)(param_2 + 0x80));
  }
  *(undefined4 *)(param_2 + 0x80) = 0;
  *(undefined4 *)(param_2 + 0x7c) = 0;
  FUN_10039aa0(*(int **)(param_1 + 0x41c),*(int *)(param_2 + 8),0xc,1);
LAB_100138b8:
  if (*(int *)(param_2 + 0x50) != 0) {
    if (*(int *)(param_2 + 0x68) != 0) {
      *(int *)(param_2 + 0x50) = *(int *)(param_2 + 0x68);
    }
    iVar4 = *(int *)(param_2 + 0x50);
    if (iVar4 == 0x48545450) {
      pcVar9 = (char *)0x0;
      if (*(int *)(param_2 + 0x54) == 0x48545450) {
        pcVar9 = PTR_s_HTTP_1_0_200_OK_Connection__clos_100570e0;
      }
      if (*(int *)(param_2 + 0x54) == 0x584d4c21) {
        pcVar9 = PTR_s_HTTP_1_0_200_OK_Connection__clos_100570e4;
      }
      if (pcVar9 != (char *)0x0) {
        pcVar6 = pcVar9;
        do {
          cVar3 = *pcVar6;
          pcVar6 = pcVar6 + 1;
        } while (cVar3 != '\0');
        pcVar7 = *(char **)(param_2 + 0x60);
        pcVar1 = pcVar7 + 1;
        do {
          cVar3 = *pcVar7;
          pcVar7 = pcVar7 + 1;
        } while (cVar3 != '\0');
        *(char **)(param_2 + 0x5c) = pcVar6 + (int)(pcVar7 + (-(int)pcVar1 - (int)(pcVar9 + 1)));
        pcVar6 = (char *)_malloc((size_t)(pcVar6 + (int)(pcVar7 + (-(int)pcVar1 - (int)(pcVar9 + 1))
                                                        ) + 1));
        *(char **)(param_2 + 0x60) = pcVar6;
        do {
          cVar3 = *pcVar9;
          pcVar9 = pcVar9 + 1;
          *pcVar6 = cVar3;
          pcVar6 = pcVar6 + 1;
        } while (cVar3 != '\0');
        pcVar9 = &DAT_10058a5c;
        do {
          pcVar6 = pcVar9;
          pcVar9 = pcVar6 + 1;
        } while (*pcVar6 != '\0');
        puVar12 = (undefined4 *)(*(int *)(param_2 + 0x60) + -1);
        do {
          pcVar9 = (char *)((int)puVar12 + 1);
          puVar12 = (undefined4 *)((int)puVar12 + 1);
        } while (*pcVar9 != '\0');
        puVar8 = (undefined4 *)&DAT_10058a5c;
        for (uVar10 = (uint)(pcVar6 + -0x10058a5b) >> 2; uVar10 != 0; uVar10 = uVar10 - 1) {
          *puVar12 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar12 = puVar12 + 1;
        }
        for (uVar10 = (uint)(pcVar6 + -0x10058a5b) & 3; uVar10 != 0; uVar10 = uVar10 - 1) {
          *(undefined1 *)puVar12 = *(undefined1 *)puVar8;
          puVar8 = (undefined4 *)((int)puVar8 + 1);
          puVar12 = (undefined4 *)((int)puVar12 + 1);
        }
        *(undefined4 *)(param_2 + 0x58) = 0;
        return '\0';
      }
    }
    if ((*(int *)(param_2 + 0x58) == 0) && (iVar4 == 0x7e706e67)) {
      *(uint *)(param_2 + 0x54) = param_3;
    }
    DAT_10058a50 = (undefined1)((uint)iVar4 >> 0x18);
    DAT_10058a51 = *(undefined1 *)(param_2 + 0x52);
    DAT_10058a52 = (undefined1)((uint)*(undefined4 *)(param_2 + 0x50) >> 8);
    DAT_10058a53 = *(undefined1 *)(param_2 + 0x50);
    DAT_10058a54 = *(undefined1 *)(param_2 + 0x57);
    DAT_10058a55 = *(undefined1 *)(param_2 + 0x56);
    DAT_10058a56 = (undefined1)((uint)*(undefined4 *)(param_2 + 0x54) >> 8);
    DAT_10058a57 = *(undefined1 *)(param_2 + 0x54);
    pcVar9 = *(char **)(param_2 + 0x58);
    if ((int)pcVar9 < 0) {
      pcVar9 = *(char **)(param_2 + 0x60);
      pcVar6 = pcVar9 + 1;
      do {
        cVar3 = *pcVar9;
        pcVar9 = pcVar9 + 1;
      } while (cVar3 != '\0');
      pcVar9 = pcVar9 + (1 - (int)pcVar6);
    }
    pcVar9 = pcVar9 + 0xc;
    DAT_10058a58 = (undefined1)((uint)pcVar9 >> 0x18);
    DAT_10058a59 = (undefined1)((uint)pcVar9 >> 0x10);
    DAT_10058a5a = (undefined1)((uint)pcVar9 >> 8);
    DAT_10058a5b = SUB41(pcVar9,0);
    if (*(char *)(param_2 + 0x90) != '\0') {
      FUN_10012ff0((int)pcVar9 >> 0x10,0x10058a50);
    }
    pcVar6 = (char *)FUN_10039bb0(*(int **)(param_1 + 0x41c),*(int *)(param_2 + 8),&DAT_10058a50,
                                  (int)pcVar9);
    if ((int)pcVar6 < 0) {
      pcVar6 = (char *)0x0;
    }
    if (pcVar6 != pcVar9) {
      _Size = (int)pcVar9 - (int)pcVar6;
      puVar8 = (undefined4 *)_malloc(_Size);
      *(undefined4 **)(param_2 + 0x60) = puVar8;
      puVar12 = (undefined4 *)(&DAT_10058a50 + (int)pcVar6);
      for (uVar10 = _Size >> 2; uVar10 != 0; uVar10 = uVar10 - 1) {
        *puVar8 = *puVar12;
        puVar12 = puVar12 + 1;
        puVar8 = puVar8 + 1;
      }
      for (uVar10 = _Size & 3; uVar10 != 0; uVar10 = uVar10 - 1) {
        *(undefined1 *)puVar8 = *(undefined1 *)puVar12;
        puVar12 = (undefined4 *)((int)puVar12 + 1);
        puVar8 = (undefined4 *)((int)puVar8 + 1);
      }
      *(uint *)(param_2 + 0x5c) = _Size;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return '\0';
    }
  }
  *(undefined4 *)(param_2 + 0x60) = 0;
  return (*(int *)(param_2 + 0x28) == 0) + '\x01';
}



undefined4 __cdecl FUN_10013ac0(int param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  
  uVar2 = 0;
  iVar1 = FUN_10039bb0(*(int **)(param_1 + 0x41c),*(int *)(param_2 + 8),
                       (char *)(*(int *)(param_2 + 0x60) + *(int *)(param_2 + 0x58)),
                       *(int *)(param_2 + 0x5c) - *(int *)(param_2 + 0x58));
  if (iVar1 < 1) {
    if (*(int *)(param_2 + 100) == 0) {
      *(int *)(param_2 + 100) = param_3 + 10000;
    }
    if (param_3 != *(int *)(param_2 + 100) && -1 < param_3 - *(int *)(param_2 + 100)) {
      *(undefined4 *)(param_2 + 0x14) = 0xffffffff;
      return 0xffffffff;
    }
  }
  else {
    iVar1 = *(int *)(param_2 + 0x58) + iVar1;
    *(int *)(param_2 + 0x58) = iVar1;
    *(int *)(param_2 + 100) = param_3 + 120000;
    if (iVar1 == *(int *)(param_2 + 0x5c)) {
      uVar2 = 1;
      _free(*(void **)(param_2 + 0x60));
      *(undefined4 *)(param_2 + 0x60) = 0;
      *(undefined4 *)(param_2 + 100) = 0;
      if ((*(int *)(param_2 + 0x50) == 0x48545450) &&
         ((*(int *)(param_2 + 0x54) == 0x48545450 || (*(int *)(param_2 + 0x54) == 0x584d4c21)))) {
        FUN_10039930(*(int **)(param_1 + 0x41c),*(int *)(param_2 + 8));
        return 0xffffffff;
      }
    }
  }
  return uVar2;
}



undefined4 __thiscall FUN_10013b90(void *this,int param_1,int param_2,int param_3)

{
  int iVar1;
  
  if ((*(int *)(param_2 + 0x4c) == 0) && (*(char *)(param_2 + 0x90) != '\0')) {
    FUN_10012ff0(this,*(int *)(param_2 + 0x48));
  }
  iVar1 = FUN_10039bb0(*(int **)(param_1 + 0x41c),*(int *)(param_2 + 8),
                       (char *)(*(int *)(param_2 + 0x48) + *(int *)(param_2 + 0x3c)),
                       *(int *)(param_2 + 0x40) - *(int *)(param_2 + 0x3c));
  if (iVar1 < 1) {
    if (*(int *)(param_2 + 0x4c) == 0) {
      *(int *)(param_2 + 0x4c) = param_3 + 10000;
    }
    if (param_3 != *(int *)(param_2 + 0x4c) && -1 < param_3 - *(int *)(param_2 + 0x4c)) {
      *(undefined4 *)(param_2 + 0x14) = 0xffffffff;
      return 0xffffffff;
    }
  }
  else {
    iVar1 = *(int *)(param_2 + 0x3c) + iVar1;
    *(int *)(param_2 + 0x3c) = iVar1;
    *(int *)(param_2 + 0x4c) = param_3 + 120000;
    if (iVar1 == *(int *)(param_2 + 0x40)) {
      return 1;
    }
  }
  return 0;
}



undefined4 __cdecl FUN_10013c40(int param_1,int param_2,int param_3)

{
  char *pcVar1;
  char cVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint _Size;
  undefined4 *puVar8;
  undefined4 *puVar9;
  int local_c;
  undefined4 *local_8;
  
  iVar3 = param_2;
  local_8 = (undefined4 *)0x0;
  if (param_3 - *(int *)(param_2 + 0x38) < 1) {
    return 0;
  }
  *(undefined1 **)(param_2 + 0x60) = &DAT_10058a5c;
  *(undefined4 *)(param_2 + 0x5c) = 0xfff4;
  local_c = *(int *)(*(int *)(param_2 + 0x8c) + 0x10);
  param_2 = 0;
  do {
    *(undefined4 *)(iVar3 + 0x50) = 0;
    *(undefined4 *)(iVar3 + 0x54) = 0;
    *(undefined4 *)(iVar3 + 0x58) = 0;
    (*(code *)(*(undefined4 **)(iVar3 + 0x8c))[0x1b])
              (**(undefined4 **)(iVar3 + 0x8c),iVar3,
               *(undefined4 *)(*(int *)(param_1 + 0x10) + *(int *)(iVar3 + 8) * 4),param_3,param_2);
    iVar7 = *(int *)(iVar3 + 0x50);
    if (iVar7 != 0) {
      if (iVar7 == 0x7e706e67) {
        *(int *)(iVar3 + 0x54) = param_3;
      }
      iVar5 = *(int *)(iVar3 + 0x60);
      *(undefined1 *)(iVar5 + -0xc) = (char)((uint)iVar7 >> 0x18);
      *(undefined1 *)(iVar5 + -0xb) = *(undefined1 *)(iVar3 + 0x52);
      *(char *)(iVar5 + -10) = (char)((uint)*(undefined4 *)(iVar3 + 0x50) >> 8);
      *(undefined1 *)(iVar5 + -9) = *(undefined1 *)(iVar3 + 0x50);
      *(undefined1 *)(iVar5 + -8) = *(undefined1 *)(iVar3 + 0x57);
      *(undefined1 *)(iVar5 + -7) = *(undefined1 *)(iVar3 + 0x56);
      *(char *)(iVar5 + -6) = (char)((uint)*(undefined4 *)(iVar3 + 0x54) >> 8);
      *(undefined1 *)(iVar5 + -5) = *(undefined1 *)(iVar3 + 0x54);
      pcVar4 = *(char **)(iVar3 + 0x58);
      if ((int)pcVar4 < 0) {
        pcVar4 = *(char **)(iVar3 + 0x60);
        pcVar1 = pcVar4 + 1;
        do {
          cVar2 = *pcVar4;
          pcVar4 = pcVar4 + 1;
        } while (cVar2 != '\0');
        pcVar4 = pcVar4 + (1 - (int)pcVar1);
      }
      pcVar4 = pcVar4 + 0xc;
      *(char *)(iVar5 + -4) = (char)((uint)pcVar4 >> 0x18);
      *(char *)(iVar5 + -3) = (char)((uint)pcVar4 >> 0x10);
      *(char *)(iVar5 + -2) = (char)((uint)pcVar4 >> 8);
      *(char *)(iVar5 + -1) = (char)pcVar4;
      if (*(char *)(iVar3 + 0x90) != '\0') {
        FUN_10012ff0(CONCAT31((int3)(short)((uint)pcVar4 >> 0x10),*(char *)(iVar3 + 0x90)),
                     iVar5 + -0xc);
      }
      *(char **)(iVar3 + 0x60) = pcVar4 + *(int *)(iVar3 + 0x60);
      *(int *)(iVar3 + 0x5c) = *(int *)(iVar3 + 0x5c) - (int)pcVar4;
    }
    iVar7 = *(int *)(iVar3 + 0x60) + -0x10058a5c;
    if ((*(int *)(iVar3 + 0x50) == 0) || (*(int *)(*(int *)(iVar3 + 0x8c) + 0xc) < iVar7)) {
      if (iVar7 == 0) {
        if (param_2 == 0) {
          *(int *)(iVar3 + 0x38) = *(int *)(*(int *)(iVar3 + 0x8c) + 0x14) + param_3;
          *(undefined4 *)(iVar3 + 0x60) = 0;
          return 0;
        }
        goto LAB_10013e56;
      }
      iVar5 = FUN_10039bb0(*(int **)(param_1 + 0x41c),*(int *)(iVar3 + 8),&DAT_10058a50,iVar7);
      if (iVar5 < 0) {
        iVar5 = 0;
      }
      if (iVar5 != iVar7) {
        _Size = iVar7 - iVar5;
        local_8 = (undefined4 *)_malloc(_Size);
        puVar8 = (undefined4 *)(&DAT_10058a50 + iVar5);
        puVar9 = local_8;
        for (uVar6 = _Size >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
          *puVar9 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar9 = puVar9 + 1;
        }
        for (uVar6 = _Size & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
          *(undefined1 *)puVar9 = *(undefined1 *)puVar8;
          puVar8 = (undefined4 *)((int)puVar8 + 1);
          puVar9 = (undefined4 *)((int)puVar9 + 1);
        }
        *(undefined4 **)(iVar3 + 0x60) = local_8;
        *(undefined4 *)(iVar3 + 0x58) = 0;
        *(uint *)(iVar3 + 0x5c) = _Size;
LAB_10013e56:
        *(undefined4 **)(iVar3 + 0x60) = local_8;
        return 0;
      }
      local_c = local_c - iVar7;
      if ((*(int *)(iVar3 + 0x50) == 0) || (local_c < 0)) goto LAB_10013e56;
      *(undefined1 **)(iVar3 + 0x60) = &DAT_10058a5c;
      *(undefined4 *)(iVar3 + 0x5c) = 0xfff4;
    }
    param_2 = param_2 + 1;
  } while( true );
}



int __cdecl FUN_10013e70(int param_1)

{
  int iVar1;
  uint uVar2;
  char *pcVar3;
  
  uVar2 = 0;
  pcVar3 = (char *)(param_1 + 0x44c);
  do {
    if (*pcVar3 == '\0') {
      iVar1 = uVar2 * 0x74 + 0x428 + param_1;
      *(undefined1 *)(iVar1 + 0x24) = 0x2a;
      *(undefined1 *)(iVar1 + 0x25) = 0;
      *(undefined4 *)(iVar1 + 0x1c) = 1;
      *(undefined4 *)(iVar1 + 0x20) = 0;
      return iVar1;
    }
    uVar2 = uVar2 + 1;
    pcVar3 = pcVar3 + 0x74;
  } while (uVar2 < 8);
  return 0;
}



void FUN_10013ec0(int *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  char *pcVar4;
  int *piVar5;
  
  FUN_10016490(8);
  piVar2 = param_1 + 0x121;
  iVar1 = 8;
  do {
    if ((piVar2[-0x17] != 0) && (*piVar2 != 0)) {
      piVar5 = piVar2 + -0xe;
      pcVar4 = "Destroying %s";
      uVar3 = 8;
      FUN_10016490(8);
      (*(code *)*piVar2)(piVar2[-0x17],uVar3,pcVar4,piVar5);
    }
    piVar2 = piVar2 + 0x1d;
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  _free((void *)param_1[0x33e]);
  if ((void *)param_1[0x107] != (void *)0x0) {
    FUN_100397d0((void *)param_1[0x107]);
    param_1[0x107] = 0;
  }
  if (param_1[3] != 0) {
    iVar1 = 0;
    if (0 < param_1[1]) {
      do {
        _free(*(void **)(param_1[3] + iVar1 * 4));
        _free(*(void **)(param_1[4] + iVar1 * 4));
        iVar1 = iVar1 + 1;
      } while (iVar1 < param_1[1]);
    }
    _free((void *)param_1[3]);
    _free((void *)param_1[4]);
    param_1[3] = 0;
    param_1[4] = 0;
  }
  FUN_1002a630((uint *)param_1[0x333]);
  FUN_1002a630((uint *)param_1[0x332]);
  FUN_10016490(8);
  if ((undefined4 *)*param_1 != (undefined4 *)0x0) {
    (*(code *)**(undefined4 **)*param_1)(1);
  }
  _free(param_1);
  _fflush((FILE *)&DAT_10057480);
  return;
}



void __cdecl FUN_10013fe0(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  uint uVar1;
  undefined4 uVar2;
  
  param_3[0x361] = 0;
  uVar1 = FUN_1002a570((uint *)param_3[0x333],0x73746174,0);
  if (uVar1 == 1) {
    uVar2 = FUN_100230b0((void *)*param_3,0x32,FUN_10013fe0,0,param_3);
    param_3[0x361] = uVar2;
    return;
  }
  uVar1 = FUN_1002a570((uint *)param_3[0x332],0x73746174,0);
  if (uVar1 == 0) {
    FUN_1002a630((uint *)param_3[0x332]);
    param_3[0x332] = param_3[0x333];
    param_3[0x333] = 0;
    FUN_10013090();
    return;
  }
  FUN_1002a4b0((uint *)param_3[0x333]);
  FUN_10016410(8);
  uVar2 = FUN_1002a630((uint *)param_3[0x333]);
  param_3[0x333] = uVar2;
  return;
}



void __cdecl FUN_100140a0(undefined4 *param_1,int param_2)

{
  uint *puVar1;
  undefined4 uVar2;
  
  if ((param_2 == 0) || (param_2 == param_1[0x10a])) {
    param_1[0x10c] = 1;
  }
  if ((param_2 == 0) || (param_2 == param_1[0x127])) {
    param_1[0x129] = 1;
  }
  if ((param_2 == 0) || (param_2 == param_1[0x144])) {
    param_1[0x146] = 1;
  }
  if ((param_2 == 0) || (param_2 == param_1[0x161])) {
    param_1[0x163] = 1;
  }
  if ((param_2 == 0) || (param_2 == param_1[0x17e])) {
    param_1[0x180] = 1;
  }
  if ((param_2 == 0) || (param_2 == param_1[0x19b])) {
    param_1[0x19d] = 1;
  }
  if ((param_2 == 0) || (param_2 == param_1[0x1b8])) {
    param_1[0x1ba] = 1;
  }
  if ((param_2 == 0) || (param_2 == param_1[0x1d5])) {
    param_1[0x1d7] = 1;
  }
  FUN_1002a630((uint *)param_1[0x333]);
  puVar1 = FUN_1002a210();
  param_1[0x333] = puVar1;
  FUN_1002a320(puVar1,param_1 + 0x1f2,(char *)(param_1 + 0x232));
  FUN_10016490(8);
  if (param_1[0x361] != 0) {
    FUN_100230e0((void *)*param_1,param_1[0x361]);
  }
  uVar2 = FUN_100230b0((void *)*param_1,0x32,FUN_10013fe0,0,param_1);
  param_1[0x361] = uVar2;
  return;
}



void __cdecl FUN_100141b0(int *param_1)

{
  param_1[0x108] = -1;
  if (*param_1 != 0) {
    FUN_10022f30(*param_1);
    return;
  }
  return;
}



uint __cdecl FUN_100141d0(int param_1,int param_2)

{
  uint uVar1;
  
  uVar1 = 0;
  if (param_2 == 0x63757272) {
    uVar1 = *(uint *)(param_1 + 0x18);
  }
  else {
    if (param_2 == 0x6d61786d) {
      return *(uint *)(param_1 + 4);
    }
    if (param_2 == 0x61646472) {
      uVar1 = FUN_10039830(*(uint **)(param_1 + 0x41c),0x61646472);
      return uVar1;
    }
    if (param_2 == 0x706f7274) {
      uVar1 = FUN_10039830(*(uint **)(param_1 + 0x41c),0x706f7274);
      return uVar1;
    }
  }
  return uVar1;
}



undefined4 * __cdecl FUN_10014240(int param_1,int param_2,int param_3)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int *piVar3;
  uint uVar4;
  uint uVar5;
  undefined4 *puVar6;
  
  puVar1 = (undefined4 *)0x0;
  if (param_3 == 0) {
    *(undefined4 *)(param_2 + 0x8c) = 0;
    return puVar1;
  }
  uVar5 = 0;
  piVar3 = (int *)(param_1 + 0x428);
  do {
    if (*piVar3 == param_3) {
      if ((*(int **)(param_2 + 0x8c) == (int *)0x0) || (*(int **)(param_2 + 0x8c) == piVar3)) {
        *(int **)(param_2 + 0x8c) = piVar3;
        uVar2 = FUN_10039d40(*(int *)(param_1 + 0x41c));
        *(undefined4 *)(param_2 + 0x38) = uVar2;
        puVar1 = *(undefined4 **)(*(int *)(param_1 + 0x10) + *(int *)(param_2 + 8) * 4);
        uVar5 = *(uint *)(param_1 + 8);
        puVar6 = puVar1;
        for (uVar4 = uVar5 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        }
        for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
          *(undefined1 *)puVar6 = 0;
          puVar6 = (undefined4 *)((int)puVar6 + 1);
        }
        FUN_10039d80(*(int *)(param_1 + 0x41c),*(int *)(param_2 + 8),0);
      }
      return puVar1;
    }
    uVar5 = uVar5 + 1;
    piVar3 = piVar3 + 0x1d;
  } while (uVar5 < 8);
  return puVar1;
}



void __cdecl FUN_100142e0(int param_1,int param_2,int param_3)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = (int *)(param_1 + 0x428);
  do {
    if (*piVar2 == param_2) {
      piVar2[1] = param_3;
      return;
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 0x1d;
  } while (uVar1 < 8);
  return;
}



void __cdecl FUN_10014310(int param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *(uint *)(param_1 + 4);
  uVar2 = *(int *)(param_2 + 0x10) + uVar1;
  if (0x7effffff < uVar2) {
    uVar2 = uVar2 % uVar1 + uVar1;
  }
  *(uint *)(param_2 + 0x10) = uVar2;
  return;
}



uint __cdecl FUN_10014340(int param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = *(uint *)(*(int *)(param_1 + 0xc) + (param_2 % *(uint *)(param_1 + 4)) * 4);
  return (param_2 != *(uint *)(uVar1 + 0x10)) - 1 & uVar1;
}



uint __cdecl FUN_10014370(int param_1,uint param_2)

{
  uint uVar1;
  
  uVar1 = *(uint *)(*(int *)(param_1 + 0xc) + (param_2 % *(uint *)(param_1 + 4)) * 4);
  return (param_2 != *(uint *)(uVar1 + 0xc)) - 1 & uVar1;
}



void __cdecl FUN_100143a0(undefined4 param_1,undefined4 param_2,int *param_3)

{
  int *piVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int *piVar4;
  
  piVar1 = param_3;
  if (param_3[0x107] == 0) {
    FUN_10016410(8);
    FUN_10022f30(*param_3);
    return;
  }
  uVar2 = FUN_10039d40(param_3[0x107]);
  uVar3 = FUN_10039cf0(param_3[0x107]);
  piVar4 = param_3 + 0x10a;
  param_3 = (int *)0x8;
  do {
    if ((*piVar4 != 0) && ((code *)piVar4[0x18] != (code *)0x0)) {
      (*(code *)piVar4[0x18])(*piVar4,uVar2,uVar3);
    }
    piVar4 = piVar4 + 0x1d;
    param_3 = (int *)((int)param_3 + -1);
  } while (param_3 != (int *)0x0);
  FUN_100230b0((void *)*piVar1,1000,FUN_100143a0,0,piVar1);
  return;
}



char * __cdecl
FUN_10014430(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4,char *param_5,
            char *param_6)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  char *pcVar10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  if ((int)param_6 < 0) {
    pcVar3 = param_5;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    param_6 = pcVar3 + (1 - (int)(param_5 + 1));
  }
  pcVar3 = (char *)0x0;
  if (param_2 != 0) {
    pcVar3 = param_6 + 0xc;
    if (*(int *)(param_2 + 0x40) <= *(int *)(param_2 + 0x3c)) {
      *(undefined4 *)(param_2 + 0x40) = 0;
      *(undefined4 *)(param_2 + 0x3c) = 0;
    }
    iVar7 = *(int *)(param_2 + 0x44) - *(int *)(param_2 + 0x40);
    if ((iVar7 < (int)pcVar3) && (iVar2 = *(int *)(param_2 + 0x3c), (int)pcVar3 <= iVar7 + iVar2)) {
      uVar5 = *(int *)(param_2 + 0x40) - iVar2;
      puVar4 = (undefined4 *)((int)*(undefined4 **)(param_2 + 0x48) + iVar2);
      puVar8 = *(undefined4 **)(param_2 + 0x48);
      for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *puVar8 = *puVar4;
        puVar4 = puVar4 + 1;
        puVar8 = puVar8 + 1;
      }
      for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
        *(undefined1 *)puVar8 = *(undefined1 *)puVar4;
        puVar4 = (undefined4 *)((int)puVar4 + 1);
        puVar8 = (undefined4 *)((int)puVar8 + 1);
      }
      *(int *)(param_2 + 0x40) = *(int *)(param_2 + 0x40) - *(int *)(param_2 + 0x3c);
      *(undefined4 *)(param_2 + 0x3c) = 0;
    }
    iVar7 = *(int *)(param_2 + 0x40);
    if (*(int *)(param_2 + 0x44) - iVar7 < (int)pcVar3) {
      iVar2 = *(int *)(param_2 + 0x3c);
      puVar4 = (undefined4 *)_malloc((size_t)(pcVar3 + (iVar7 - iVar2) + 0x8000));
      if (puVar4 == (undefined4 *)0x0) {
        return (char *)0xffffffff;
      }
      if (0 < *(int *)(param_2 + 0x40)) {
        uVar5 = *(int *)(param_2 + 0x40) - *(int *)(param_2 + 0x3c);
        puVar8 = (undefined4 *)(*(int *)(param_2 + 0x48) + *(int *)(param_2 + 0x3c));
        puVar9 = puVar4;
        for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
          *puVar9 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar9 = puVar9 + 1;
        }
        for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
          *(undefined1 *)puVar9 = *(undefined1 *)puVar8;
          puVar8 = (undefined4 *)((int)puVar8 + 1);
          puVar9 = (undefined4 *)((int)puVar9 + 1);
        }
        *(int *)(param_2 + 0x40) = *(int *)(param_2 + 0x40) - *(int *)(param_2 + 0x3c);
        *(undefined4 *)(param_2 + 0x3c) = 0;
      }
      if (*(void **)(param_2 + 0x48) != (void *)0x0) {
        _free(*(void **)(param_2 + 0x48));
        *(undefined4 *)(param_2 + 0x48) = 0;
      }
      *(undefined4 **)(param_2 + 0x48) = puVar4;
      *(char **)(param_2 + 0x44) = pcVar3 + (iVar7 - iVar2) + 0x8000;
    }
    local_c = CONCAT13((char)param_3,
                       CONCAT12((char)((uint)param_3 >> 8),
                                CONCAT11((char)((uint)param_3 >> 0x10),(char)((uint)param_3 >> 0x18)
                                        )));
    local_8._0_2_ = CONCAT11((char)((uint)param_4 >> 0x10),(char)((uint)param_4 >> 0x18));
    local_8 = CONCAT13((char)param_4,CONCAT12((char)((uint)param_4 >> 8),(undefined2)local_8));
    puVar4 = (undefined4 *)(*(int *)(param_2 + 0x48) + *(int *)(param_2 + 0x40));
    local_4._0_2_ = CONCAT11((char)((uint)pcVar3 >> 0x10),(char)((uint)pcVar3 >> 0x18));
    *puVar4 = local_c;
    puVar4[1] = local_8;
    local_4 = CONCAT13((char)pcVar3,CONCAT12((char)((uint)pcVar3 >> 8),(undefined2)local_4));
    puVar4[2] = local_4;
    pcVar10 = (char *)(*(int *)(param_2 + 0x48) + 0xc + *(int *)(param_2 + 0x40));
    for (uVar6 = (uint)param_6 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)pcVar10 = *(undefined4 *)param_5;
      param_5 = param_5 + 4;
      pcVar10 = pcVar10 + 4;
    }
    for (uVar6 = (uint)param_6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
      *pcVar10 = *param_5;
      param_5 = param_5 + 1;
      pcVar10 = pcVar10 + 1;
    }
    *(int *)(param_2 + 0x40) = (int)(pcVar3 + *(int *)(param_2 + 0x40));
    *(undefined4 *)(param_2 + 0x4c) = 0;
  }
  return pcVar3;
}



undefined1 * __cdecl FUN_10014600(int param_1,byte *param_2)

{
  undefined1 *puVar1;
  
  puVar1 = FUN_1002a500(*(uint **)(param_1 + 0xcc8),param_2);
  if (puVar1 == (undefined1 *)0x0) {
    puVar1 = &DAT_1004d26f;
  }
  return puVar1;
}



void __cdecl FUN_10014630(int param_1,undefined1 param_2)

{
  *(undefined1 *)(param_1 + 0x90) = param_2;
  return;
}



void FUN_10014640(undefined4 *param_1)

{
  FUN_10022de0((int *)*param_1);
  return;
}



void __cdecl FUN_10014650(int param_1,int param_2,uint param_3)

{
  char cVar1;
  uint *puVar2;
  int iVar3;
  undefined3 extraout_var;
  
  do {
    puVar2 = (uint *)FUN_10039900(*(int **)(param_1 + 0x41c),*(int *)(param_2 + 8),0xffff);
    if ((puVar2 != (uint *)0x0) && (iVar3 = FUN_10013190(param_1,puVar2), iVar3 < 1)) {
      return;
    }
    if ((*(int *)(param_2 + 0x14) == -1) ||
       (((*(int *)(param_2 + 0x14) == -2 && (*(int *)(param_2 + 0x60) == 0)) &&
        (*(int *)(param_2 + 0x40) <= *(int *)(param_2 + 0x3c))))) {
      FUN_10039930(*(int **)(param_1 + 0x41c),*(int *)(param_2 + 8));
      *(undefined4 *)(param_2 + 0x14) = 0;
    }
    if (*(int *)(param_2 + 0x14) == 0) {
      return;
    }
    iVar3 = 0;
    if (*(int *)(param_2 + 0x3c) < *(int *)(param_2 + 0x40)) {
LAB_10014742:
      if (*(int *)(param_2 + 0x60) != 0) goto LAB_10014749;
LAB_1001475f:
      if ((int)*(void **)(param_2 + 0x3c) < *(int *)(param_2 + 0x40)) {
        FUN_10013b90(*(void **)(param_2 + 0x3c),param_1,param_2,param_3);
      }
    }
    else {
      if (*(int *)(param_2 + 0x60) == 0) {
        if (((*(int *)(param_2 + 0x7c) != 0) &&
            (*(int *)(param_2 + 0x74) == *(int *)(param_2 + 0x78))) &&
           ((*(int *)(param_2 + 0x8c) == 0 || (-1 < *(int *)(*(int *)(param_2 + 0x8c) + 4))))) {
          cVar1 = FUN_10013620(param_1,param_2,param_3);
          iVar3 = CONCAT31(extraout_var,cVar1);
        }
        if (*(int *)(param_2 + 0x28) == 0) {
          if (*(int *)(param_2 + 0x60) != 0) goto LAB_10014749;
          if ((*(int *)(param_2 + 0x8c) != 0) && (*(int *)(*(int *)(param_2 + 0x8c) + 0x6c) != 0)) {
            FUN_10013c40(param_1,param_2,param_3);
          }
        }
        goto LAB_10014742;
      }
LAB_10014749:
      FUN_10013ac0(param_1,param_2,param_3);
      if (*(int *)(param_2 + 0x60) == 0) goto LAB_1001475f;
    }
    if (iVar3 < 2) {
      return;
    }
  } while( true );
}



void FUN_10014790(void)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int *unaff_ESI;
  
  *(int *)(*unaff_ESI + 0x44) = unaff_ESI[0x109];
  uVar2 = FUN_10039d40(unaff_ESI[0x107]);
  iVar3 = unaff_ESI[0x362];
  DAT_10058a48 = '\0';
  if (iVar3 == 0) {
    iVar3 = unaff_ESI[5];
  }
  unaff_ESI[0x362] = 0;
  if (iVar3 != 0) {
    while( true ) {
      iVar1 = *(int *)(iVar3 + 4);
      FUN_10014650((int)unaff_ESI,iVar3,uVar2);
      if (DAT_10058a48 != '\0') break;
      iVar3 = iVar1;
      if (iVar1 == 0) {
        return;
      }
    }
    unaff_ESI[0x362] = iVar1;
    *(int *)(*unaff_ESI + 0x44) = (int)(unaff_ESI[0x109] + (unaff_ESI[0x109] >> 0x1f & 3U)) >> 2;
  }
  return;
}



void FUN_10014810(void)

{
  FUN_10014790();
  return;
}



void __cdecl FUN_10014820(undefined4 param_1,int param_2,int param_3)

{
  uint uVar1;
  
  uVar1 = FUN_10039d40(*(int *)(param_2 + 0x41c));
  FUN_10014650(param_2,*(int *)(*(int *)(param_2 + 0xc) + param_3 * 4),uVar1);
  return;
}



void __cdecl FUN_10014850(uint param_1,int param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  char cVar5;
  undefined2 uVar6;
  undefined4 uVar7;
  undefined2 extraout_var;
  u_long uVar8;
  int iVar9;
  uint uVar10;
  undefined4 *puVar11;
  
  uVar4 = param_1;
  *(int *)(param_1 + 0x3c) = *(int *)(param_1 + 4);
  *(code **)(param_1 + 0x34) = FUN_10014820;
  *(int *)(param_1 + 0x38) = param_2;
  puVar1 = *(undefined4 **)(*(int *)(param_2 + 0xc) + *(int *)(param_1 + 4) * 4);
  uVar2 = *(uint *)(param_2 + 4);
  param_1 = puVar1[3] + uVar2;
  if (0x7effffff < param_1) {
    param_1 = param_1 % uVar2 + uVar2;
  }
  uVar10 = puVar1[4] + uVar2;
  if (0x7effffff < uVar10) {
    uVar10 = uVar10 % uVar2 + uVar2;
  }
  iVar3 = puVar1[2];
  puVar11 = puVar1;
  for (iVar9 = 0x26; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar11 = 0;
    puVar11 = puVar11 + 1;
  }
  puVar1[2] = iVar3;
  puVar1[3] = param_1;
  puVar1[4] = uVar10;
  puVar1[0x25] = *(undefined4 *)(*(int *)(param_2 + 0x10) + iVar3 * 4);
  FUN_10039aa0(*(int **)(param_2 + 0x41c),*(int *)(uVar4 + 4),0xc,1);
  FUN_10039d80(*(int *)(param_2 + 0x41c),*(int *)(uVar4 + 4),60000);
  uVar7 = FUN_10039c20(*(int **)(param_2 + 0x41c),*(int *)(uVar4 + 4));
  puVar1[5] = uVar7;
  uVar6 = FUN_10039c50(*(int **)(param_2 + 0x41c),*(int *)(uVar4 + 4));
  puVar1[6] = CONCAT22(extraout_var,uVar6);
  uVar8 = FUN_10039c80(*(int **)(param_2 + 0x41c),*(int *)(uVar4 + 4));
  puVar1[9] = uVar8;
  if ((*(int *)(param_2 + 0xd00) != 0) || (*(char *)(param_2 + 0xcfc) != '\0')) {
    cVar5 = FUN_100180c0((char *)(param_2 + 0xcfc),puVar1[5]);
    if (cVar5 != '\0') {
      *(undefined1 *)(puVar1 + 0x24) = 1;
    }
  }
  puVar1[1] = *(undefined4 *)(param_2 + 0x14);
  *puVar1 = 0;
  if (*(undefined4 **)(param_2 + 0x14) != (undefined4 *)0x0) {
    **(undefined4 **)(param_2 + 0x14) = puVar1;
  }
  *(undefined4 **)(param_2 + 0x14) = puVar1;
  *(int *)(param_2 + 0x18) = *(int *)(param_2 + 0x18) + 1;
  FUN_100164d0(8,"%d: Accept");
  return;
}



undefined4 __cdecl FUN_100149a0(int param_1,int param_2)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  undefined4 uVar8;
  char *pcVar9;
  byte *pbVar10;
  int iVar11;
  byte *pbVar12;
  byte local_40 [32];
  byte local_20 [32];
  
  pcVar9 = *(char **)(param_2 + 0x60);
  pbVar12 = &DAT_1004d26f;
  iVar11 = 0x20;
  pbVar10 = local_40;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004de40);
  FUN_10002a30(pbVar1,pbVar10,iVar11,pbVar12);
  pbVar12 = &DAT_1004d26f;
  iVar11 = 0x20;
  pbVar10 = local_20;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e5a0);
  FUN_10002a30(pbVar1,pbVar10,iVar11,pbVar12);
  uVar2 = FUN_10039d40(*(int *)(param_1 + 0x41c));
  iVar11 = _sprintf(pcVar9,"Server utilization summary (tick=%u.%03u):\r\n",uVar2 / 1000,
                    uVar2 % 1000);
  uVar8 = *(undefined4 *)(param_1 + 0xcd0);
  pcVar9 = pcVar9 + iVar11;
  uVar2 = FUN_10039830(*(uint **)(param_1 + 0x41c),0x64656c79);
  uVar3 = FUN_10039830(*(uint **)(param_1 + 0x41c),0x72786275);
  uVar4 = FUN_10039830(*(uint **)(param_1 + 0x41c),0x70657269);
  uVar5 = FUN_10039830(*(uint **)(param_1 + 0x41c),0x73696d75);
  iVar6 = _sprintf(pcVar9,
                   "Server configuration: simul=%d, perip=%d, rxlen=%d, delay=%d, slowidle=%d\r\n",
                   uVar5,uVar4,uVar3,uVar2,uVar8);
  iVar7 = _sprintf(pcVar9 + iVar6,"Connect status: max=%d, cur=%d\r\n",*(undefined4 *)(param_1 + 4),
                   *(undefined4 *)(param_1 + 0x18));
  iVar11 = *(int *)(param_1 + 0x14);
  pcVar9 = pcVar9 + iVar6 + iVar7;
  iVar6 = 0;
  do {
    if (iVar11 == 0) break;
    if (*(int *)(iVar11 + 0x8c) == 0) {
      uVar8 = 0;
    }
    else {
      uVar8 = *(undefined4 *)(*(int *)(iVar11 + 0x8c) + 4);
    }
    iVar7 = _sprintf(pcVar9,"%3d/%08x: %08x INP=%c (%08x), OUT=%c (%08x), PRI=%d\r\n",
                     *(undefined4 *)(iVar11 + 8),*(undefined4 *)(iVar11 + 0xc),
                     *(undefined4 *)(iVar11 + 0x14),
                     (int)(char)(((*(int *)(iVar11 + 0x7c) == 0) - 1U & 0xb) + 0x4e),
                     *(undefined4 *)(iVar11 + 0x6c),
                     (int)(char)(((*(int *)(iVar11 + 0x60) == 0) - 1U & 0xb) + 0x4e),
                     *(undefined4 *)(iVar11 + 0x50),uVar8);
    iVar11 = *(int *)(iVar11 + 4);
    pcVar9 = pcVar9 + iVar7;
    iVar6 = iVar6 + 1;
  } while (iVar6 < 0x19);
  *(undefined4 *)(param_2 + 0x50) = 0x48545450;
  *(undefined4 *)(param_2 + 0x54) = 0x48545450;
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0;
}



undefined4 * __cdecl FUN_10014b50(byte *param_1,byte *param_2)

{
  char *pcVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  
  FUN_10001fe0('\t');
  puVar2 = (undefined4 *)_malloc(0xd90);
  puVar3 = puVar2;
  for (iVar4 = 0x364; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  if (param_1 != (byte *)0x0) {
    FUN_10003cf0((byte *)(puVar2 + 7),0x400,(byte *)"VERSION",param_1);
  }
  if (param_2 != (byte *)0x0) {
    FUN_10003cf0((byte *)(puVar2 + 7),0x400,(byte *)"PARAM",param_2);
  }
  puVar3 = (undefined4 *)FUN_10013e70((int)puVar2);
  *puVar3 = puVar2;
  puVar3[8] = 1;
  puVar3[7] = 1;
  pcVar1 = (char *)(puVar3 + 9);
  pcVar1[0] = 's';
  pcVar1[1] = 'e';
  pcVar1[2] = 'r';
  pcVar1[3] = 'v';
  *(undefined2 *)(puVar3 + 10) = 0x7265;
  *(undefined1 *)((int)puVar3 + 0x2a) = 0;
  puVar3[0x11] = 0x20544547;
  puVar3[0x12] = 0x2f76732f;
  puVar3[0x1a] = &LAB_10014b30;
  *(undefined1 *)(puVar3 + 0x13) = 0;
  return puVar2;
}



undefined4 __cdecl FUN_10014c10(int *param_1,char *param_2,char *param_3)

{
  char cVar1;
  uint *puVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  undefined4 uVar6;
  void *pvVar7;
  undefined4 *puVar8;
  int *piVar9;
  uint uVar10;
  int iVar11;
  undefined2 uVar12;
  int iVar13;
  int iVar14;
  uint uVar15;
  int iVar16;
  int iVar17;
  char *pcVar18;
  byte local_12c [32];
  char local_10c [256];
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_1004cf3e;
  local_c = ExceptionList;
  iVar11 = (int)(param_1 + 0x1f2) - (int)param_2;
  ExceptionList = &local_c;
  do {
    cVar1 = *param_2;
    param_2[iVar11] = cVar1;
    param_2 = param_2 + 1;
  } while (cVar1 != '\0');
  FUN_100020b0((char *)(param_1 + 0x232),0x400,param_3);
  puVar2 = FUN_1002a210();
  param_1[0x332] = (int)puVar2;
  FUN_1002a320(puVar2,param_1 + 0x1f2,(char *)(param_1 + 0x232));
  FUN_1002a400((uint *)param_1[0x332]);
  pbVar3 = FUN_1002a500((uint *)param_1[0x332],&DAT_1004d26f);
  if ((pbVar3 == (byte *)0x0) || (*pbVar3 == 0)) {
    FUN_1002a4b0((uint *)param_1[0x332]);
    FUN_10005ca0(local_10c,0x100,"ServerConfig: config load failed: %s [%s]");
    _fprintf((FILE *)&DAT_100574a0,"%s\n",local_10c);
    param_1[0x108] = -1;
    if (*param_1 != 0) {
      FUN_10022f30(*param_1);
    }
    uVar6 = 1;
  }
  else {
    iVar11 = 4;
    pbVar4 = FUN_100020f0(pbVar3,(byte *)"log.level");
    iVar11 = FUN_10002480((char *)pbVar4,iVar11);
    uVar15 = 0xffffffff;
    pbVar4 = FUN_100020f0(pbVar3,(byte *)"log.categoryMask");
    uVar15 = FUN_100025a0((char *)pbVar4,uVar15);
    FUN_10016340(&DAT_100570e8,uVar15,iVar11);
    FUN_10016490(8);
    iVar11 = 0x2000;
    pbVar4 = FUN_100020f0(pbVar3,(byte *)"scheduler.maxEvents");
    iVar11 = FUN_10002480((char *)pbVar4,iVar11);
    iVar17 = 0x100;
    pbVar4 = FUN_100020f0(pbVar3,(byte *)"scheduler.maxFd");
    iVar17 = FUN_10002480((char *)pbVar4,iVar17);
    pcVar18 = "select";
    iVar16 = 0x20;
    pbVar4 = local_12c;
    pbVar5 = FUN_100020f0(pbVar3,(byte *)"scheduler.type");
    FUN_10002a30(pbVar5,pbVar4,iVar16,(byte *)pcVar18);
    if (local_12c[0] == 0) {
      FUN_10016410(8);
      uVar6 = 2;
    }
    else {
      iVar16 = FUN_10005cd0(local_12c,(byte *)"select");
      if (iVar16 == 0) {
        pvVar7 = operator_new(0xc058);
        local_4 = 0;
        if (pvVar7 == (void *)0x0) {
          puVar8 = (undefined4 *)0x0;
        }
        else {
          puVar8 = FUN_1003a3d0(pvVar7,iVar11,iVar17);
        }
        local_4 = 0xffffffff;
        *param_1 = (int)puVar8;
      }
      if (*param_1 == 0) {
        FUN_10016410(8);
        uVar6 = 2;
      }
      else {
        FUN_100230f0(*param_1);
        FUN_10016490(8);
        iVar11 = 0x400c;
        pbVar4 = FUN_100020f0(pbVar3,(byte *)"RXLEN");
        iVar11 = FUN_10002480((char *)pbVar4,iVar11);
        if (iVar11 < 0x400c) {
          iVar11 = 0x400c;
        }
        iVar17 = *(int *)(*param_1 + 0x28);
        iVar16 = 10;
        pbVar4 = FUN_100020f0(pbVar3,(byte *)"RXDEL");
        iVar16 = FUN_10002480((char *)pbVar4,iVar16);
        iVar14 = 8;
        pbVar4 = FUN_100020f0(pbVar3,(byte *)"PERIP");
        iVar14 = FUN_10002480((char *)pbVar4,iVar14);
        iVar13 = 0x26ac;
        pbVar4 = FUN_100020f0(pbVar3,&DAT_1004d240);
        iVar13 = FUN_10002480((char *)pbVar4,iVar13);
        uVar12 = (undefined2)iVar13;
        uVar15 = 0;
        pbVar4 = FUN_100020f0(pbVar3,&DAT_1004db60);
        uVar15 = FUN_10002780(pbVar4,uVar15);
        piVar9 = FUN_1003a0d0((int *)*param_1,uVar15,uVar12,iVar17,iVar11,iVar14,iVar16);
        param_1[0x107] = (int)piVar9;
        if (piVar9 == (int *)0x0) {
          FUN_10016410(8);
          uVar6 = 2;
        }
        else {
          iVar11 = 0x32;
          pbVar4 = FUN_100020f0(pbVar3,(byte *)"SLOWIDLE");
          iVar11 = FUN_10002480((char *)pbVar4,iVar11);
          iVar17 = 8000;
          param_1[0x334] = iVar11;
          pbVar4 = FUN_100020f0(pbVar3,(byte *)"MAX_UPDATE_TIME");
          iVar11 = FUN_10002480((char *)pbVar4,iVar17);
          param_1[0x335] = iVar11;
          pbVar4 = (byte *)(param_1 + 7);
          uVar15 = FUN_10039830((uint *)param_1[0x107],0x61646472);
          FUN_100025e0(pbVar4,0x400,&DAT_1004db60,uVar15);
          uVar15 = FUN_10039830((uint *)param_1[0x107],0x706f7274);
          FUN_10002370(pbVar4,0x400,&DAT_1004d240,uVar15);
          uVar15 = FUN_10039830((uint *)param_1[0x107],0x73696d75);
          FUN_10002370(pbVar4,0x400,(byte *)"SIMUL",uVar15);
          uVar15 = FUN_10039830((uint *)param_1[0x107],0x70657269);
          FUN_10002370(pbVar4,0x400,(byte *)"PERIP",uVar15);
          uVar15 = FUN_10039d40(param_1[0x107]);
          FUN_10002370(pbVar4,0x400,(byte *)"STARTUP",uVar15);
          iVar11 = 0;
          if (0 < param_1[0x110]) {
            iVar11 = param_1[0x110];
          }
          if (iVar11 < param_1[0x12d]) {
            iVar11 = param_1[0x12d];
          }
          if (iVar11 < param_1[0x14a]) {
            iVar11 = param_1[0x14a];
          }
          if (iVar11 < param_1[0x167]) {
            iVar11 = param_1[0x167];
          }
          if (iVar11 < param_1[0x184]) {
            iVar11 = param_1[0x184];
          }
          if (iVar11 < param_1[0x1a1]) {
            iVar11 = param_1[0x1a1];
          }
          if (iVar11 < param_1[0x1be]) {
            iVar11 = param_1[0x1be];
          }
          if (iVar11 < param_1[0x1db]) {
            iVar11 = param_1[0x1db];
          }
          uVar15 = FUN_10039830((uint *)param_1[0x107],0x73696d75);
          param_1[2] = iVar11;
          param_1[1] = uVar15;
          FUN_10016490(8);
          pvVar7 = _malloc(param_1[1] << 2);
          param_1[3] = (int)pvVar7;
          pvVar7 = _malloc(param_1[1] << 2);
          param_1[4] = (int)pvVar7;
          iVar11 = 0;
          if (0 < param_1[1]) {
            do {
              pvVar7 = _malloc(0x98);
              *(void **)(param_1[3] + iVar11 * 4) = pvVar7;
              puVar8 = *(undefined4 **)(param_1[3] + iVar11 * 4);
              for (iVar17 = 0x26; iVar17 != 0; iVar17 = iVar17 + -1) {
                *puVar8 = 0;
                puVar8 = puVar8 + 1;
              }
              pvVar7 = _malloc(param_1[2]);
              *(void **)(param_1[4] + iVar11 * 4) = pvVar7;
              uVar15 = param_1[2];
              puVar8 = *(undefined4 **)(param_1[4] + iVar11 * 4);
              for (uVar10 = uVar15 >> 2; uVar10 != 0; uVar10 = uVar10 - 1) {
                *puVar8 = 0;
                puVar8 = puVar8 + 1;
              }
              for (uVar15 = uVar15 & 3; uVar15 != 0; uVar15 = uVar15 - 1) {
                *(undefined1 *)puVar8 = 0;
                puVar8 = (undefined4 *)((int)puVar8 + 1);
              }
              *(undefined4 *)(*(int *)(param_1[3] + iVar11 * 4) + 0x94) =
                   *(undefined4 *)(param_1[4] + iVar11 * 4);
              iVar11 = iVar11 + 1;
            } while (iVar11 < param_1[1]);
          }
          iVar17 = 0;
          iVar11 = 0;
          if (0 < param_1[1]) {
            do {
              *(int *)(*(int *)(param_1[3] + iVar11 * 4) + 8) = iVar11;
              iVar16 = *(int *)(param_1[3] + iVar11 * 4);
              *(int *)(iVar16 + 0xc) = *(int *)(iVar16 + 8) + param_1[1];
              iVar16 = *(int *)(param_1[3] + iVar11 * 4);
              *(undefined4 *)(iVar16 + 0x10) = *(undefined4 *)(iVar16 + 0xc);
              iVar11 = iVar11 + 1;
            } while (iVar11 < param_1[1]);
          }
          param_1[5] = 0;
          pvVar7 = _malloc(param_1[1] * 0x20c);
          param_1[0x33e] = (int)pvVar7;
          pbVar4 = (byte *)(param_1 + 0x113);
          do {
            if (param_1[0x108] != 0) goto LAB_10015233;
            if (*pbVar4 != 0) {
              iVar11 = 0;
              pbVar5 = FUN_100020f0(pbVar3,pbVar4);
              iVar11 = FUN_10002480((char *)pbVar5,iVar11);
              if (iVar11 != 0) {
                if (*(int *)(pbVar4 + 0x30) != 0) {
                  pcVar18 = "Creating %s";
                  uVar6 = 8;
                  pbVar5 = pbVar4;
                  FUN_10016490(8);
                  uVar6 = (**(code **)(pbVar4 + 0x30))
                                    (param_1,param_1[0x332],pbVar3,param_1 + 7,uVar6,pcVar18,pbVar5)
                  ;
                  *(undefined4 *)(pbVar4 + -0x24) = uVar6;
                }
                if ((*(int *)(pbVar4 + 0x34) != 0) && (*(int *)(pbVar4 + -0x24) != 0)) {
                  pcVar18 = "Configuring %s";
                  uVar6 = 8;
                  pbVar5 = pbVar4;
                  FUN_10016490(8);
                  (**(code **)(pbVar4 + 0x34))
                            (*(undefined4 *)(pbVar4 + -0x24),param_1[0x332],pbVar3,param_1 + 7,uVar6
                             ,pcVar18,pbVar5);
                }
                if (*(int *)(pbVar4 + -0x18) == 0) {
                  pbVar4[-0xffffffff00000018] = 0;
                  pbVar4[-0xffffffff00000017] = 0x10;
                  pbVar4[-0xffffffff00000016] = 0;
                  pbVar4[-0xffffffff00000015] = 0;
                }
                if (*(int *)(pbVar4 + -0x14) == 0) {
                  pbVar4[-0xffffffff00000014] = 0;
                  pbVar4[-0xffffffff00000013] = 0x20;
                  pbVar4[-0xffffffff00000012] = 0;
                  pbVar4[-0xffffffff00000011] = 0;
                }
                if (*(int *)(pbVar4 + -0x10) == 0) {
                  pbVar4[-0xffffffff00000010] = 100;
                  pbVar4[-0xffffffff0000000f] = 0;
                  pbVar4[-0xffffffff0000000e] = 0;
                  pbVar4[-0xffffffff0000000d] = 0;
                }
              }
            }
            iVar17 = iVar17 + 1;
            pbVar4 = pbVar4 + 0x74;
          } while (iVar17 < 8);
          if (param_1[0x108] == 0) {
            FUN_10016490(8);
          }
LAB_10015233:
          FUN_10017ff0(param_1 + 0x33f,(byte *)"AUDIT",(byte *)"AUDIT_MASK",pbVar3,0);
          uVar6 = 0;
        }
      }
    }
  }
  ExceptionList = local_c;
  return uVar6;
}



void __cdecl FUN_100152c0(int *param_1,char param_2)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  param_1[0x109] = 0;
  piVar2 = param_1 + 300;
  iVar3 = 2;
  do {
    if ((((char)piVar2[-0x19] != '\0') && (iVar1 = piVar2[-0x1d], 0 < iVar1)) &&
       ((param_1[0x109] == 0 || (iVar1 < param_1[0x109])))) {
      param_1[0x109] = iVar1;
    }
    if ((((char)piVar2[4] != '\0') && (iVar1 = *piVar2, 0 < iVar1)) &&
       ((param_1[0x109] == 0 || (iVar1 < param_1[0x109])))) {
      param_1[0x109] = iVar1;
    }
    if ((((char)piVar2[0x21] != '\0') && (iVar1 = piVar2[0x1d], 0 < iVar1)) &&
       ((param_1[0x109] == 0 || (iVar1 < param_1[0x109])))) {
      param_1[0x109] = iVar1;
    }
    if ((((char)piVar2[0x3e] != '\0') && (iVar1 = piVar2[0x3a], 0 < iVar1)) &&
       ((param_1[0x109] == 0 || (iVar1 < param_1[0x109])))) {
      param_1[0x109] = iVar1;
    }
    piVar2 = piVar2 + 0x74;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  FUN_10022f10((void *)*param_1,FUN_10014810,param_1);
  *(int *)(*param_1 + 0x44) = param_1[0x109];
  FUN_100230b0((void *)*param_1,1000,FUN_100143a0,0,param_1);
  FUN_10022ec0((void *)*param_1,param_2);
  return;
}



undefined4 * __cdecl FUN_100153c0(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)_malloc(0x7f8);
  puVar2 = puVar1;
  for (iVar3 = 0x1fe; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *puVar1 = param_1;
  puVar2 = FUN_10020e00(1,1,1,0,'\0');
  puVar1[0x2a] = puVar2;
  DAT_10068a54 = param_1;
  return puVar1;
}



void __cdecl FUN_10015660(void *param_1)

{
  _free(param_1);
  DAT_10068a54 = 0;
  return;
}



undefined4 __cdecl FUN_10015680(int param_1,int param_2)

{
  undefined4 uVar1;
  
  uVar1 = 0;
  if ((-1 < param_2) && (param_2 < 1)) {
    uVar1 = *(undefined4 *)(param_1 + 0xa8 + param_2 * 4);
  }
  return uVar1;
}



undefined4 FUN_100156a0(void)

{
  return 1;
}



undefined4 __cdecl FUN_100156b0(int param_1,byte *param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  int *piVar4;
  byte local_8 [8];
  
  FUN_10002fe0((byte *)(param_3 + 0xd0),(uint *)(param_4 + 0xac),0x58,&DAT_1004e4d4);
  iVar1 = FUN_10021660(*(int *)(param_1 + 0xa8));
  iVar2 = FUN_100210a0(*(int *)(param_1 + 0xa8),*(uint *)(param_4 + 0xac));
  iVar2 = iVar2 + 1;
  *(int *)(param_4 + 0x54) = iVar2;
  if ((iVar2 < 1) || (iVar1 < iVar2)) {
    *(int *)(param_4 + 0x54) = iVar1;
  }
  iVar1 = 0;
  piVar4 = (int *)(param_4 + 0x6c);
  do {
    _sprintf((char *)local_8,"GS%d",iVar1);
    iVar2 = 0;
    pbVar3 = FUN_100020f0(param_2,local_8);
    iVar2 = FUN_10002480((char *)pbVar3,iVar2);
    *piVar4 = iVar2;
    iVar1 = iVar1 + 1;
    piVar4 = piVar4 + 1;
  } while (iVar1 < 0x10);
  iVar1 = -1;
  pbVar3 = FUN_100020f0(param_2,&DAT_1004fc5c);
  iVar1 = FUN_10002480((char *)pbVar3,iVar1);
  iVar2 = -1;
  *(int *)(param_4 + 0x58) = iVar1;
  pbVar3 = FUN_100020f0(param_2,&DAT_1004fc58);
  iVar1 = FUN_10002480((char *)pbVar3,iVar2);
  iVar2 = -1;
  *(int *)(param_4 + 0x5c) = iVar1;
  pbVar3 = FUN_100020f0(param_2,&DAT_1004fc54);
  iVar1 = FUN_10002480((char *)pbVar3,iVar2);
  iVar2 = 0;
  *(int *)(param_4 + 0x60) = iVar1;
  pbVar3 = FUN_100020f0(param_2,(byte *)"GAMETYPE");
  iVar1 = FUN_10002480((char *)pbVar3,iVar2);
  *(int *)(param_4 + 0x68) = iVar1;
  *(uint *)(param_4 + 100) = *(byte *)(param_3 + 0x308) >> 2 & 1;
  *(undefined4 *)(param_4 + 0x50) = *(undefined4 *)(param_3 + 0x2c0);
  return 0;
}



uint __cdecl FUN_100157f0(undefined4 param_1,byte *param_2,byte *param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  int iVar10;
  bool bVar11;
  
  pbVar4 = param_2;
  pbVar9 = param_3;
  do {
    bVar1 = *pbVar4;
    bVar11 = bVar1 < *pbVar9;
    if (bVar1 != *pbVar9) {
LAB_10015824:
      iVar5 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      goto LAB_10015829;
    }
    if (bVar1 == 0) break;
    bVar1 = pbVar4[1];
    bVar11 = bVar1 < pbVar9[1];
    if (bVar1 != pbVar9[1]) goto LAB_10015824;
    pbVar4 = pbVar4 + 2;
    pbVar9 = pbVar9 + 2;
  } while (bVar1 != 0);
  iVar5 = 0;
LAB_10015829:
  if (iVar5 != 0) {
    return 0xffffffff;
  }
  iVar5 = *(int *)(param_2 + 0x54);
  iVar6 = *(int *)(param_2 + 0x58);
  iVar2 = *(int *)(param_3 + 0x54);
  iVar10 = iVar5 - iVar2;
  if (((((((iVar6 != 1) || (iVar2 < 0x65)) &&
         ((iVar7 = *(int *)(param_3 + 0x58), iVar7 != 1 || (iVar5 < 0x65)))) &&
        (((iVar6 != 2 || (iVar2 < 0x3e9)) && ((iVar7 != 2 || (iVar5 < 0x3e9)))))) &&
       (((iVar6 != 3 && (iVar7 != 3)) || ((iVar10 < 0x65 && (-0x65 < iVar10)))))) &&
      (((iVar6 != 4 && (iVar7 != 4)) || ((iVar10 < 0x3e9 && (-0x3e9 < iVar10)))))) &&
     ((((((iVar6 != 5 && (iVar7 != 5)) || ((iVar10 < 0x1389 && (-0x1389 < iVar10)))) &&
        ((*(int *)(param_2 + 0x5c) != 1 || (*(int *)(param_3 + 100) == 1)))) &&
       ((*(int *)(param_3 + 0x5c) != 1 || (*(int *)(param_2 + 100) == 1)))) &&
      (((*(int *)(param_2 + 0x60) < 1 || (*(int *)(param_3 + 0xcc) <= *(int *)(param_2 + 0x60))) &&
       ((*(int *)(param_3 + 0x60) < 1 || (*(int *)(param_2 + 0xcc) <= *(int *)(param_3 + 0x60)))))))
     )) {
    iVar6 = 0;
    pbVar4 = param_3 + 0x6c;
    do {
      if (*(int *)(pbVar4 + ((int)param_2 - (int)param_3)) != *(int *)pbVar4) {
        return 0xffffffff;
      }
      iVar6 = iVar6 + 1;
      pbVar4 = pbVar4 + 4;
    } while (iVar6 < 0x10);
    if (*(int *)(param_2 + 0x68) == *(int *)(param_3 + 0x68)) {
      if (param_4 != 0) {
        if (iVar5 <= iVar2) {
          iVar10 = iVar2 - iVar5;
        }
        iVar6 = *(int *)(param_2 + 0x50);
        iVar7 = *(int *)(param_3 + 0x50);
        if (iVar7 < iVar6) {
          iVar7 = iVar6 - iVar7;
        }
        else {
          iVar7 = iVar7 - iVar6;
        }
        iVar8 = *(int *)(param_4 + 0x54);
        if (iVar8 < iVar5) {
          iVar8 = iVar5 - iVar8;
        }
        else {
          iVar8 = iVar8 - iVar5;
        }
        iVar3 = *(int *)(param_4 + 0x50);
        if (iVar3 < iVar6) {
          iVar6 = iVar6 - iVar3;
        }
        else {
          iVar6 = iVar3 - iVar6;
        }
        if (iVar6 + iVar8 < iVar10 + iVar7) {
          return 0xffffffff;
        }
      }
      return (uint)(iVar5 < iVar2);
    }
  }
  return 0xffffffff;
}



undefined4 FUN_100159c0(void)

{
  return 0xffffffff;
}



undefined4 __cdecl FUN_100159d0(int param_1,char *param_2,size_t param_3)

{
  if (*(char *)(param_1 + 4) == '\0') {
    return 0xffffffff;
  }
  FUN_10005d70(param_2,(char *)(param_1 + 4),param_3);
  param_2[param_3 - 1] = '\0';
  return 0;
}



undefined * FUN_10015a10(void)

{
  return &DAT_1004fb7c;
}



undefined1 FUN_10015a20(void)

{
  return 0;
}



void __cdecl FUN_10015a30(undefined4 param_1,byte *param_2,int param_3,char *param_4,int param_5)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  long lVar4;
  uint uVar5;
  char *pcVar6;
  uint uVar7;
  char *pcVar8;
  bool bVar9;
  int iVar10;
  char local_34 [16];
  char local_24;
  char local_23;
  char local_22;
  char local_21;
  
  uVar7 = 0;
  uVar5 = 0;
  *(undefined4 *)(param_5 + 8) = 0;
  if (param_3 == 0) {
    *(undefined4 *)(param_5 + 8) = 3;
    *(undefined4 *)(param_5 + 0x18) = 3;
    *(undefined4 *)(param_5 + 0x1c) = 3;
    *(undefined4 *)(param_5 + 0x20) = 3;
    FUN_100275e0(param_4,local_34,0x10,&local_24,0x24);
    iVar10 = 4;
    bVar9 = true;
    pcVar6 = local_34;
    pcVar8 = "LVL";
    do {
      if (iVar10 == 0) break;
      iVar10 = iVar10 + -1;
      bVar9 = *pcVar6 == *pcVar8;
      pcVar6 = pcVar6 + 1;
      pcVar8 = pcVar8 + 1;
    } while (bVar9);
    if (bVar9) {
      lVar4 = _atol(&local_24);
      *(long *)(param_5 + 0x18) = lVar4 << 3;
    }
    else {
      iVar10 = 4;
      bVar9 = true;
      pcVar6 = local_34;
      pcVar8 = "CNT";
      do {
        if (iVar10 == 0) break;
        iVar10 = iVar10 + -1;
        bVar9 = *pcVar6 == *pcVar8;
        pcVar6 = pcVar6 + 1;
        pcVar8 = pcVar8 + 1;
      } while (bVar9);
      if (bVar9) {
        if (local_24 == '\0') {
          *(undefined4 *)(param_5 + 0x1c) = 0;
        }
        else {
          *(uint *)(param_5 + 0x1c) =
               ((uint)(ushort)(short)local_24 * 0x100 + (uint)(ushort)(short)local_23 & 0xffff) << 3
          ;
        }
      }
      else {
        iVar10 = 4;
        bVar9 = true;
        pcVar6 = local_34;
        pcVar8 = "CLB";
        do {
          if (iVar10 == 0) break;
          iVar10 = iVar10 + -1;
          bVar9 = *pcVar6 == *pcVar8;
          pcVar6 = pcVar6 + 1;
          pcVar8 = pcVar8 + 1;
        } while (bVar9);
        if (bVar9) {
          *(int *)(param_5 + 0x20) =
               ((((int)local_24 << 8 | (int)local_23) << 8 | (int)local_22) << 8 | (int)local_21) <<
               3;
        }
      }
    }
    iVar10 = 0;
    pbVar2 = FUN_100020f0(param_2,(byte *)"LVLMIN");
    uVar5 = FUN_10002480((char *)pbVar2,iVar10);
    iVar10 = 0;
    pbVar2 = FUN_100020f0(param_2,(byte *)"LVLMAX");
    uVar7 = FUN_10002480((char *)pbVar2,iVar10);
  }
  else {
    iVar10 = 0;
    pbVar2 = FUN_100020f0(param_2,(byte *)"LVLRNG");
    uVar3 = FUN_10002480((char *)pbVar2,iVar10);
    if (-1 < (int)uVar3) {
      uVar7 = *(uint *)(param_3 + 0x314) & 0x3ff;
      if (uVar7 < 100) {
        if (uVar7 == 0) {
          uVar7 = 1;
        }
      }
      else {
        uVar7 = 99;
      }
      if (uVar3 < uVar7) {
        uVar5 = uVar7 - uVar3;
      }
      else {
        uVar5 = 1;
      }
      uVar7 = uVar7 + uVar3;
      if (uVar7 < 100) {
        if (uVar7 == 0) {
          uVar7 = 1;
        }
      }
      else {
        uVar7 = 99;
      }
    }
  }
  iVar10 = 100;
  pbVar2 = FUN_100020f0(param_2,&DAT_1004fc80);
  iVar10 = FUN_10002480((char *)pbVar2,iVar10);
  if ((uVar5 == 0) || (uVar7 < uVar5)) {
    *(undefined4 *)(param_5 + 0xc) = 3;
    *(undefined4 *)(param_5 + 0x10) = 3;
  }
  else {
    *(uint *)(param_5 + 0xc) = uVar5 * 8 | 3;
    *(uint *)(param_5 + 0x10) = uVar7 * 8 | 2;
  }
  iVar1 = *(int *)(param_5 + 8);
  *(int *)(param_5 + 8) = iVar1 + 2;
  if ((0 < iVar10) && (iVar10 < 100)) {
    *(uint *)(param_5 + 0x14) = iVar10 << 3 | 2;
    *(int *)(param_5 + 8) = iVar1 + 3;
    return;
  }
  *(undefined4 *)(param_5 + 0x14) = 3;
  return;
}



undefined4 FUN_10015c60(void)

{
  return 0;
}



char __cdecl FUN_10015d10(undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  
  if (*(int *)(param_2 + 0x1c4) != 0) {
    iVar1 = *(int *)(param_3 + 0x94) - *(int *)(param_2 + 0x10);
    if (iVar1 < 0) {
      iVar1 = -iVar1;
    }
    if ((*(int *)(param_2 + 0x11c) == -1) || (iVar1 < *(int *)(param_2 + 0x11c))) {
      *(int *)(param_2 + 0x11c) = iVar1;
      return (iVar1 == 0) + '\x01';
    }
  }
  return '\0';
}



void __cdecl
FUN_10015d60(undefined4 param_1,byte *param_2,int param_3,int *param_4,undefined4 param_5,
            int param_6)

{
  int iVar1;
  int iVar2;
  int aiStackY_360 [60];
  undefined4 uStackY_270;
  byte local_248 [8];
  uint local_240 [16];
  byte local_200 [512];
  
  iVar2 = *param_4;
  iVar1 = 0x120;
  local_200[0] = 0;
  do {
    if (*(int *)(iVar1 + iVar2) == -1) {
      if (*(int *)(iVar1 + param_4[1]) == -1) {
        *(undefined4 *)((int)aiStackY_360 + iVar1) = 0xffffffff;
      }
      else {
        *(int *)((int)aiStackY_360 + iVar1) = *(int *)(iVar1 + param_4[1]);
      }
    }
    else {
      *(int *)((int)aiStackY_360 + iVar1) = *(int *)(iVar1 + iVar2);
    }
    iVar1 = iVar1 + 4;
  } while (iVar1 < 0x160);
  iVar2 = 0;
  do {
    _sprintf((char *)local_248,"GS%d");
    uStackY_270 = 0x10015dda;
    FUN_10002370(local_200,0x200,local_248,local_240[iVar2]);
    iVar2 = iVar2 + 1;
  } while (iVar2 < 0x10);
  FUN_100020b0((char *)param_2,param_3,(char *)(param_4[param_6] + 0x1c));
  uStackY_270 = 0x10015e17;
  FUN_10003cf0(param_2,param_3,(byte *)"PARAMS",local_200);
  return;
}



void __fastcall FUN_10015e30(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  
  iVar2 = *(int *)(param_2 + 0x28);
  if ((*(int *)(iVar2 + 0x18) != 0) && (iVar3 = 0, *(int *)(iVar2 + 0x19c) != 0)) {
    iVar1 = 0;
    do {
      iVar4 = *(int *)(iVar1 + iVar2);
      if (*(int *)(*(int *)(param_2 + 0x28) + 8 + iVar1) <=
          *(int *)(*(int *)(param_2 + 0x28) + iVar1)) {
        iVar4 = iVar4 + 999999;
      }
      iVar2 = *(int *)(iVar1 + 0x184 + iVar2);
      if (*(int *)(*(int *)(param_2 + 0x28) + iVar1 + 0x18c) <=
          *(int *)(*(int *)(param_2 + 0x28) + 0x184 + iVar1)) {
        iVar2 = iVar2 + 999999;
      }
      if (iVar2 < iVar4) {
        puVar6 = (undefined4 *)(iVar1 + *(int *)(param_2 + 0x28));
        puVar5 = (undefined4 *)
                 (*(int *)(param_2 + 0x20) * 0x184 + -0x184 + *(int *)(param_2 + 0x28));
        for (iVar2 = 0x61; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar5 = *puVar6;
          puVar6 = puVar6 + 1;
          puVar5 = puVar5 + 1;
        }
        puVar6 = (undefined4 *)(iVar1 + *(int *)(param_2 + 0x28));
        puVar5 = puVar6 + 0x61;
        for (iVar2 = 0x61; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar6 = *puVar5;
          puVar5 = puVar5 + 1;
          puVar6 = puVar6 + 1;
        }
        puVar6 = (undefined4 *)
                 (*(int *)(param_2 + 0x20) * 0x184 + -0x184 + *(int *)(param_2 + 0x28));
        puVar5 = (undefined4 *)(iVar1 + 0x184 + *(int *)(param_2 + 0x28));
        for (iVar2 = 0x61; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar5 = *puVar6;
          puVar6 = puVar6 + 1;
          puVar5 = puVar5 + 1;
        }
        if ((0 < iVar3) &&
           (*(int *)(*(int *)(param_2 + 0x28) + iVar1) <
            *(int *)(*(int *)(param_2 + 0x28) + -0x184 + iVar1))) {
          iVar3 = iVar3 + -2;
          iVar1 = iVar1 + -0x308;
        }
      }
      iVar2 = *(int *)(param_2 + 0x28);
      iVar4 = iVar1 + 800;
      iVar1 = iVar1 + 0x184;
      iVar3 = iVar3 + 1;
    } while (*(int *)(iVar4 + iVar2) != 0);
  }
  return;
}



char * __cdecl FUN_10015f20(char *param_1,int param_2)

{
  char *pcVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  
  pcVar1 = (char *)_malloc(0x2c);
  FUN_10005d70(pcVar1,param_1,0x20);
  uVar4 = (param_2 + 1) * 0x184;
  *(int *)(pcVar1 + 0x20) = param_2;
  puVar2 = (undefined4 *)_malloc(uVar4);
  *(undefined4 **)(pcVar1 + 0x28) = puVar2;
  for (uVar4 = uVar4 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  return pcVar1;
}



void __cdecl FUN_10015f70(void *param_1)

{
  if (param_1 != (void *)0x0) {
    _free(*(void **)((int)param_1 + 0x28));
  }
  _free(param_1);
  return;
}



undefined4 __cdecl FUN_10015f90(undefined4 param_1)

{
  return param_1;
}



bool __cdecl
FUN_10015fa0(int param_1,int param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5,
            undefined4 param_6,undefined4 param_7,char *param_8,undefined4 param_9,
            undefined4 param_10,char *param_11,char *param_12)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  bool bVar4;
  
  iVar1 = *(int *)(param_1 + 0x20);
  iVar3 = 0;
  if (0 < iVar1) {
    piVar2 = (int *)(*(int *)(param_1 + 0x28) + 0x1c);
    do {
      if ((piVar2[-1] == 0) || (*piVar2 == param_2)) break;
      iVar3 = iVar3 + 1;
      piVar2 = piVar2 + 0x61;
    } while (iVar3 < iVar1);
  }
  if (iVar1 <= iVar3) {
    FUN_10016410(8);
    return false;
  }
  iVar3 = iVar3 * 0x184;
  bVar4 = *(int *)(iVar3 + 0x18 + *(int *)(param_1 + 0x28)) == 0;
  if (bVar4) {
    *(int *)(iVar3 + 0x1c + *(int *)(param_1 + 0x28)) = param_2;
    *(undefined4 *)(iVar3 + 0x18 + *(int *)(param_1 + 0x28)) = param_3;
    *(undefined4 *)(iVar3 + 0xc + *(int *)(param_1 + 0x28)) = param_4;
    *(undefined4 *)(iVar3 + 0x19c + *(int *)(param_1 + 0x28)) = 0;
  }
  *(undefined4 *)(iVar3 + 4 + *(int *)(param_1 + 0x28)) = param_5;
  *(undefined4 *)(iVar3 + 8 + *(int *)(param_1 + 0x28)) = param_6;
  *(undefined4 *)(iVar3 + 0x14 + *(int *)(param_1 + 0x28)) = param_7;
  if (param_8 == (char *)0x0) {
    *(undefined1 *)(iVar3 + 0x24 + *(int *)(param_1 + 0x28)) = 0;
  }
  else {
    FUN_10005d70((char *)(iVar3 + 0x24 + *(int *)(param_1 + 0x28)),param_8,0x20);
  }
  if (param_11 == (char *)0x0) {
    *(undefined1 *)(iVar3 + 0x44 + *(int *)(param_1 + 0x28)) = 0;
  }
  else {
    FUN_10005d70((char *)(iVar3 + 0x44 + *(int *)(param_1 + 0x28)),param_11,0x100);
  }
  if (param_12 == (char *)0x0) {
    *(undefined1 *)(iVar3 + 0x144 + *(int *)(param_1 + 0x28)) = 0;
  }
  else {
    FUN_10005d70((char *)(iVar3 + 0x144 + *(int *)(param_1 + 0x28)),param_12,0x40);
  }
  *(undefined4 *)(iVar3 + 0x10 + *(int *)(param_1 + 0x28)) = param_9;
  *(undefined4 *)(iVar3 + 0x20 + *(int *)(param_1 + 0x28)) = param_10;
  if (*(int *)(iVar3 + 8 + *(int *)(param_1 + 0x28)) < 1) {
    *(undefined4 *)(iVar3 + 8 + *(int *)(param_1 + 0x28)) = 5000;
  }
  iVar1 = *(int *)(param_1 + 0x28);
  *(undefined4 *)(iVar3 + iVar1) = *(undefined4 *)(iVar3 + 4 + iVar1);
  FUN_10015e30(iVar1,param_1);
  return bVar4;
}



char * __cdecl FUN_10016110(int param_1,undefined4 param_2,int param_3,char *param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  
  if (*(int *)(*(int *)(param_1 + 0x28) + 0x18) != 0) {
    iVar4 = 0;
    do {
      puVar3 = (undefined4 *)(*(int *)(param_1 + 0x28) + iVar4);
      uVar1 = puVar3[6];
      iVar2 = _sprintf(param_4,"%s %d.%d.%d.%d/%d - %d/%d/%d - %d\r\n",param_2,uVar1 >> 0x18,
                       uVar1 >> 0x10 & 0xff,uVar1 >> 8 & 0xff,(uint)*(byte *)(puVar3 + 6),puVar3[3],
                       puVar3[1],*puVar3,puVar3[2],
                       (uint)(param_3 - *(int *)(*(int *)(param_1 + 0x28) + 0x20 + iVar4)) / 1000);
      param_4 = param_4 + iVar2;
      iVar2 = iVar4 + 0x19c;
      iVar4 = iVar4 + 0x184;
    } while (*(int *)(iVar2 + *(int *)(param_1 + 0x28)) != 0);
    return param_4;
  }
  return param_4;
}



bool __cdecl FUN_100161b0(int param_1)

{
  return *(int *)(*(int *)(param_1 + 0x28) + 0x18) != 0;
}



undefined4 __cdecl FUN_100161d0(int param_1)

{
  return *(undefined4 *)(param_1 + 0x28);
}



void __cdecl FUN_100161e0(int param_1,int param_2)

{
  **(int **)(param_1 + 0x28) = **(int **)(param_1 + 0x28) + param_2;
  FUN_10015e30(param_2,param_1);
  return;
}



void __cdecl FUN_10016200(int param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar1 = -1;
  iVar3 = 0;
  if (0 < *(int *)(param_1 + 0x20)) {
    iVar4 = 0;
    do {
      if (-1 < iVar1) {
        return;
      }
      iVar2 = *(int *)(param_1 + 0x28) + iVar4;
      if ((param_2 == *(int *)(iVar2 + 0x1c)) && (param_3 == *(int *)(iVar2 + 0x18))) {
        iVar1 = iVar3;
      }
      iVar3 = iVar3 + 1;
      iVar4 = iVar4 + 0x184;
    } while (iVar3 < *(int *)(param_1 + 0x20));
  }
  return;
}



void __cdecl FUN_10016250(int param_1,int param_2)

{
  void *_Dst;
  
  _Dst = (void *)(param_2 * 0x184 + *(int *)(param_1 + 0x28));
  _memmove(_Dst,(void *)((int)_Dst + 0x184),(*(int *)(param_1 + 0x20) - param_2) * 0x184 - 0x184);
  return;
}



void __cdecl FUN_10016290(int param_1,int param_2,uint param_3)

{
  void *_Dst;
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = *(int *)(param_1 + 0x28);
  if (*(int *)(iVar1 + 0x18) != 0) {
    iVar3 = 0;
    iVar2 = 0;
    do {
      if (param_3 < (uint)(param_2 - *(int *)(iVar3 + 0x20 + iVar1))) {
        _Dst = (void *)(*(int *)(param_1 + 0x28) + iVar3);
        _memmove(_Dst,(void *)((int)_Dst + 0x184),(*(int *)(param_1 + 0x20) - iVar2) * 0x184);
      }
      else {
        iVar2 = iVar2 + 1;
        iVar3 = iVar3 + 0x184;
      }
      iVar1 = *(int *)(param_1 + 0x28);
    } while (*(int *)(iVar3 + 0x18 + iVar1) != 0);
  }
  return;
}



void __thiscall FUN_10016340(void *this,undefined4 param_1,undefined4 param_2)

{
  *(undefined4 *)((int)this + 4) = param_1;
  *(undefined4 *)this = param_2;
  return;
}



void FUN_10016350(uint param_1,undefined4 param_2)

{
  char cVar1;
  int iVar2;
  char *in_stack_00000018;
  va_list in_stack_0000001c;
  
  iVar2 = 0;
  if ((~param_1 & 1) != 0) {
    do {
      param_1 = param_1 >> 1;
      iVar2 = iVar2 + 1;
    } while ((iVar2 < 0x20 & ~(byte)param_1) != 0);
  }
  switch(param_2) {
  case 1:
    cVar1 = 'E';
    break;
  case 2:
    cVar1 = 'W';
    break;
  default:
    cVar1 = '*';
    break;
  case 4:
    cVar1 = 'I';
    break;
  case 8:
    cVar1 = 'D';
  }
  _fprintf((FILE *)&DAT_10057480,"%c%c ",(int)cVar1,iVar2 + 0x40);
  _vfprintf((FILE *)&DAT_10057480,in_stack_00000018,in_stack_0000001c);
  _fprintf((FILE *)&DAT_10057480,"\n");
  _fflush((FILE *)&DAT_10057480);
  return;
}



void __cdecl FUN_10016410(uint param_1)

{
  if ((0 < DAT_100570e8) && ((DAT_100570ec & param_1) != 0)) {
    FUN_10016350(param_1,1);
  }
  return;
}



void __cdecl FUN_10016450(uint param_1)

{
  if ((1 < DAT_100570e8) && ((DAT_100570ec & param_1) != 0)) {
    FUN_10016350(param_1,2);
  }
  return;
}



void __cdecl FUN_10016490(uint param_1)

{
  if ((3 < DAT_100570e8) && ((DAT_100570ec & param_1) != 0)) {
    FUN_10016350(param_1,4);
  }
  return;
}



void __cdecl FUN_100164d0(uint param_1,char *param_2)

{
  int iVar1;
  
  if ((7 < DAT_100570e8) && ((param_1 & DAT_100570ec) != 0)) {
    iVar1 = 0;
    if ((~param_1 & 1) != 0) {
      do {
        param_1 = param_1 >> 1;
        iVar1 = iVar1 + 1;
      } while ((iVar1 < 0x20 & ~(byte)param_1) != 0);
    }
    _fprintf((FILE *)&DAT_10057480,"%c%c ",0x44,iVar1 + 0x40);
    _vfprintf((FILE *)&DAT_10057480,param_2,&stack0x0000000c);
    _fprintf((FILE *)&DAT_10057480,"\n");
    _fflush((FILE *)&DAT_10057480);
  }
  return;
}



undefined4 * __cdecl FUN_10016560(undefined4 *param_1)

{
  int iVar1;
  ulonglong uVar2;
  uint in_EAX;
  uint uVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  uint uVar7;
  
  uVar3 = in_EAX / 0x15180;
  uVar2 = ((ulonglong)in_EAX % 0x15180) / 0x3c;
  *param_1 = (int)(((ulonglong)in_EAX % 0x15180) % 0x3c);
  param_1[1] = (int)(uVar2 % 0x3c);
  param_1[2] = (int)(uVar2 / 0x3c);
  uVar7 = 0x7b2;
  while( true ) {
    if (((uVar7 & 3) == 0) && (((int)uVar7 % 100 != 0 || ((int)uVar7 % 400 == 0)))) {
      uVar4 = 0x16e;
    }
    else {
      uVar4 = 0x16d;
    }
    if ((int)uVar3 < (int)uVar4) break;
    uVar4 = (int)uVar3 / 0x16e + uVar7;
    if (uVar4 == uVar7) {
      uVar4 = uVar4 + 1;
    }
    iVar6 = uVar7 - 1;
    iVar1 = uVar4 - 1;
    uVar3 = uVar3 + ((((((uVar7 - uVar4) * 0x16d + iVar6 / 400) - iVar1 / 400) - iVar6 / 100) +
                      iVar1 / 100 + ((int)(iVar6 + (iVar6 >> 0x1f & 3U)) >> 2)) -
                    ((int)(iVar1 + (iVar1 >> 0x1f & 3U)) >> 2));
    uVar7 = uVar4;
  }
  piVar5 = &DAT_1004fd80 + (uVar4 & 1) * 0xc;
  param_1[5] = uVar7 - 0x76c;
  param_1[7] = uVar3;
  param_1[4] = 0;
  iVar6 = *piVar5;
  if (iVar6 <= (int)uVar3) {
    do {
      uVar3 = uVar3 - iVar6;
      piVar5 = piVar5 + 1;
      param_1[4] = param_1[4] + 1;
      iVar6 = *piVar5;
    } while (iVar6 <= (int)uVar3);
  }
  param_1[8] = 0;
  param_1[3] = uVar3 + 1;
  return param_1;
}



undefined4 __fastcall FUN_100166b0(undefined4 param_1,int param_2)

{
  char cVar1;
  int in_EAX;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar3 = 0;
  iVar2 = in_EAX + -1;
  do {
    if (iVar2 < 0x10) {
      return 0;
    }
    cVar1 = *(char *)(iVar2 + param_2);
    if (((cVar1 == '>') && (*(char *)(iVar2 + -1 + param_2) == '/')) ||
       ((cVar1 == '/' && (*(char *)(iVar2 + -1 + param_2) == '<')))) {
      iVar3 = iVar3 + 1;
      iVar2 = iVar2 + -1;
    }
    else if ((cVar1 == '<') && (iVar4 = iVar4 + 1, iVar3 < iVar4)) {
      return 1;
    }
    iVar2 = iVar2 + -1;
  } while( true );
}



undefined4 __fastcall FUN_10016700(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = param_1 + -1;
  if ((0 < param_1) && (*(char *)(iVar1 + param_2) == '>')) {
    for (; (0xf < iVar1 &&
           ((*(char *)(iVar1 + param_2) != '>' || (*(char *)(iVar1 + -1 + param_2) != '/'))));
        iVar1 = iVar1 + -1) {
      if (*(char *)(iVar1 + param_2) == '<') {
        return 1;
      }
    }
  }
  return 0;
}



undefined4 __fastcall FUN_10016740(int param_1,uint param_2,uint param_3)

{
  int in_EAX;
  uint uVar1;
  int unaff_EDI;
  
  if (unaff_EDI < 0) {
    *(undefined1 *)(in_EAX + -1 + param_2) = 0;
    *(char *)(in_EAX + 1) = "0123456789abcdef"[(int)param_2 >> 0xc & 0xf];
    *(char *)(in_EAX + 2) = "0123456789abcdef"[(int)param_2 >> 8 & 0xf];
    *(char *)(in_EAX + 3) = "0123456789abcdef"[(int)param_2 >> 4 & 0xf];
    *(char *)(in_EAX + 4) = "0123456789abcdef"[param_2 & 0xf];
    return 0xffffffff;
  }
  uVar1 = param_1 + unaff_EDI;
  *(char *)(in_EAX + 1) = "0123456789abcdef"[(int)uVar1 >> 0xc & 0xf];
  *(char *)(in_EAX + 2) = "0123456789abcdef"[(int)uVar1 >> 8 & 0xf];
  *(char *)(in_EAX + 3) = "0123456789abcdef"[(int)uVar1 >> 4 & 0xf];
  *(char *)(in_EAX + 4) = "0123456789abcdef"[uVar1 & 0xf];
  *(char *)(in_EAX + 9) = "0123456789abcdef"[(int)param_3 >> 4 & 0xf];
  *(char *)(in_EAX + 10) = "0123456789abcdef"[param_3 & 0xf];
  return 0;
}



int __fastcall FUN_10016800(int param_1,int param_2,int param_3,byte param_4)

{
  int in_EAX;
  int iVar1;
  size_t _Count;
  
  iVar1 = 0;
  if ((param_4 & 1) == 0) {
    return iVar1;
  }
  _Count = param_1 - param_2;
  if (in_EAX == 0) {
    if (0 < (int)_Count) {
      iVar1 = __snprintf((char *)(param_3 + param_2),_Count,"\n");
      return iVar1;
    }
  }
  else if (in_EAX * 2 + 1 < (int)_Count) {
    iVar1 = __snprintf((char *)(param_3 + param_2),_Count,"\n%*c",in_EAX * 2,0x20);
  }
  return iVar1;
}



undefined4 __cdecl FUN_10016860(char *param_1,char *param_2)

{
  char cVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  byte bVar6;
  char *pcVar7;
  int iVar8;
  char *pcVar9;
  uint uVar10;
  uint uVar11;
  
  pcVar7 = param_1;
  if ((((*param_1 != '<') || (param_1[0xd] != ' ')) || (param_1[0xe] != '/')) ||
     (param_1[0xf] != '>')) {
    return 0xfffffffe;
  }
  bVar2 = "0123456789abcdef"[param_1[5] + 0x10];
  uVar11 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
  bVar3 = "0123456789abcdef"[param_1[6] + 0x10];
  bVar4 = "0123456789abcdef"[param_1[7] + 0x10];
  bVar5 = "0123456789abcdef"[param_1[8] + 0x10];
  uVar10 = (uint)(byte)"0123456789abcdef"[param_1[9] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[10] + 0x10];
  bVar6 = "0123456789abcdef"[param_1[0xc] + 0x10];
  iVar8 = FUN_100166b0((int)param_1[0xc],(int)param_1);
  if (iVar8 == 0) {
    return 0xfffffffd;
  }
  param_1 = (char *)0x0;
  if (*param_2 == '<') {
    param_1 = (char *)0x0;
    if ((bVar6 & 1) != 0) {
      param_1 = (char *)(uVar10 * 2 + 1);
    }
  }
  else {
    pcVar9 = _strchr(param_2,0x22);
    if (pcVar9 != (char *)0x0) {
      iVar8 = FUN_10016700(uVar11,(int)pcVar7);
      if (iVar8 == 0) {
        return 0xfffffffc;
      }
      pcVar7[uVar11 - 1] = ' ';
    }
  }
  pcVar9 = param_2;
  do {
    cVar1 = *pcVar9;
    pcVar9 = pcVar9 + 1;
  } while (cVar1 != '\0');
  if ((int)(param_1 + ((int)pcVar9 - (int)(param_2 + 1))) <
      (int)(((((uint)bVar2 << 4 | (uint)bVar3) << 4 | (uint)bVar4) << 4 | (uint)bVar5) - uVar11)) {
    if ((*param_2 == '<') && ((bVar6 & 1) != 0)) {
      pcVar7[uVar11] = '\n';
      uVar11 = uVar11 + 1;
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        pcVar7[uVar11] = ' ';
        pcVar7[uVar11 + 1] = ' ';
        uVar11 = uVar11 + 2;
      }
    }
    cVar1 = *param_2;
    while (cVar1 != '\0') {
      pcVar7[uVar11] = cVar1;
      pcVar9 = param_2 + 1;
      uVar11 = uVar11 + 1;
      param_2 = param_2 + 1;
      cVar1 = *pcVar9;
    }
    pcVar7[uVar11] = '\0';
    pcVar7[1] = "0123456789abcdef"[(int)uVar11 >> 0xc & 0xf];
    pcVar7[2] = "0123456789abcdef"[(int)uVar11 >> 8 & 0xf];
    pcVar7[3] = "0123456789abcdef"[(int)uVar11 >> 4 & 0xf];
    pcVar7[4] = "0123456789abcdef"[uVar11 & 0xf];
    return 0;
  }
  return 0xffffffff;
}



int __cdecl FUN_10016a50(byte *param_1,int param_2,byte *param_3)

{
  byte bVar1;
  int iVar2;
  
  iVar2 = param_2;
  if (1 < param_2) {
    do {
      bVar1 = *param_3;
      if (bVar1 == 0) break;
      if (((((char)bVar1 < ' ') || (bVar1 == 0x3d)) || (bVar1 == 0x3c)) ||
         (((bVar1 == 0x3e || (bVar1 == 0x26)) || ((bVar1 == 0x22 || ('~' < (char)bVar1)))))) {
        if (3 < iVar2) {
          *param_1 = 0x25;
          param_1[1] = "0123456789abcdef"[*param_3 >> 4];
          param_1[2] = "0123456789abcdef"[*param_3 & 0xf];
          param_1 = param_1 + 3;
          iVar2 = iVar2 + -3;
        }
      }
      else {
        *param_1 = bVar1;
        param_1 = param_1 + 1;
        iVar2 = iVar2 + -1;
      }
      param_3 = param_3 + 1;
    } while (1 < iVar2);
  }
  if (0 < iVar2) {
    *param_1 = 0;
  }
  return param_2 - iVar2;
}



void __cdecl FUN_10016ae0(char *param_1,uint param_2,byte param_3)

{
  uint uVar1;
  char *pcVar2;
  
  pcVar2 = param_1;
  for (uVar1 = param_2 >> 2; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2 = pcVar2 + 4;
  }
  for (uVar1 = param_2 & 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    *pcVar2 = '\0';
    pcVar2 = pcVar2 + 1;
  }
  if (0x10 < (int)param_2) {
    uVar1 = __snprintf(param_1,param_2 - 1,"<000000000000 />");
    param_1[1] = "0123456789abcdef"[(int)uVar1 >> 0xc & 0xf];
    param_1[2] = "0123456789abcdef"[(int)uVar1 >> 8 & 0xf];
    param_1[3] = "0123456789abcdef"[(int)uVar1 >> 4 & 0xf];
    param_1[4] = "0123456789abcdef"[uVar1 & 0xf];
    param_1[5] = "0123456789abcdef"[(int)param_2 >> 0xc & 0xf];
    param_1[6] = "0123456789abcdef"[(int)param_2 >> 8 & 0xf];
    param_1[7] = "0123456789abcdef"[(int)param_2 >> 4 & 0xf];
    param_1[8] = "0123456789abcdef"[param_2 & 0xf];
    param_1[0xb] = "0123456789abcdef"[(int)(uint)param_3 >> 4];
    param_1[0xc] = "0123456789abcdef"[param_3 & 0xf];
  }
  return;
}



char * __cdecl FUN_10016bc0(char *param_1)

{
  if ((((*param_1 == '<') && (param_1[0xd] == ' ')) && (param_1[0xe] == '/')) &&
     (param_1[0xf] == '>')) {
    builtin_strncpy(param_1,"                ",0x10);
    param_1 = param_1 + 0x10;
  }
  return param_1;
}



undefined4 __cdecl FUN_10016c00(char *param_1,undefined4 param_2)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  
  if ((((*param_1 == '<') && (param_1[0xd] == ' ')) && (param_1[0xe] == '/')) &&
     (param_1[0xf] == '>')) {
    uVar6 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
    bVar1 = "0123456789abcdef"[param_1[9] + 0x10];
    uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
    bVar2 = "0123456789abcdef"[param_1[10] + 0x10];
    iVar3 = FUN_10016800(uVar7,uVar6,(int)param_1,
                         "0123456789abcdef"[param_1[0xb] + 0x10] << 4 |
                         "0123456789abcdef"[param_1[0xc] + 0x10]);
    if (uVar7 <= uVar6) {
      return 0xffffffff;
    }
    iVar4 = __snprintf(param_1 + iVar3 + uVar6,(uVar7 - iVar3) - uVar6,"<%s>",param_2);
    param_1[iVar3 + iVar4 + uVar6] = '\0';
    uVar5 = FUN_10016740(uVar6,uVar7,((uint)bVar1 << 4 | (uint)bVar2) + 1);
    return uVar5;
  }
  return 0xfffffffe;
}



undefined4 __cdecl FUN_10016d40(char *param_1)

{
  char cVar1;
  char cVar2;
  byte bVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  size_t _Count;
  int iVar10;
  int local_94;
  char local_84 [132];
  
  local_94 = 0;
  if ((((*param_1 != '<') || (param_1[0xd] != ' ')) || (param_1[0xe] != '/')) ||
     (param_1[0xf] != '>')) {
    return 0xfffffffe;
  }
  uVar8 = (((uint)(byte)"0123456789abcdef"[param_1[2] + 0x10] |
           (uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
  cVar2 = "0123456789abcdef"[param_1[0xb] + 0x10];
  uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
  bVar3 = "0123456789abcdef"[param_1[0xc] + 0x10];
  uVar6 = ((uint)(byte)"0123456789abcdef"[param_1[9] + 0x10] << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[10] + 0x10]) - 1;
  iVar4 = uVar8 - 1;
  if (0xf < iVar4) {
    iVar9 = 0;
    do {
      cVar1 = param_1[iVar4];
      if (((cVar1 == '>') && (param_1[iVar4 + -1] == '/')) ||
         ((cVar1 == '/' && (param_1[iVar4 + -1] == '<')))) {
        iVar9 = iVar9 + 1;
        iVar4 = iVar4 + -1;
      }
      else if ((cVar1 == '<') && (local_94 = local_94 + 1, iVar9 < local_94)) {
        _Count = uVar7 - uVar8;
        if ((int)_Count < 3) {
          return 0xffffffff;
        }
        if ((iVar9 == 0) && (param_1[uVar8 - 1] == '>')) {
          (param_1 + uVar8)[-1] = ' ';
          __snprintf(param_1 + uVar8,_Count,"/>");
          uVar5 = FUN_10016740(uVar8,uVar7,uVar6);
          return uVar5;
        }
        local_84[0] = '<';
        local_84[1] = 0x2f;
        local_84[2] = 0x30;
        iVar9 = 2;
        goto LAB_10016ef3;
      }
      iVar4 = iVar4 + -1;
    } while (0xf < iVar4);
  }
  return 0;
  while (iVar4 = iVar4 + 1, iVar9 = iVar10 + 1, iVar10 + 1 < 0x7f) {
LAB_10016ef3:
    iVar10 = iVar9;
    local_84[iVar10] = param_1[iVar4 + 1];
    if ((((int)uVar7 <= iVar4 + 1) || (param_1[iVar4 + 2] == ' ')) || (param_1[iVar4 + 2] == '>'))
    break;
  }
  local_84[iVar10 + 1] = '>';
  local_84[iVar10 + 2] = '\0';
  iVar4 = FUN_10016800(uVar7,uVar8,(int)param_1,cVar2 << 4 | bVar3);
  if ((int)_Count < iVar10 + 2 + iVar4) {
    return 0xffffffff;
  }
  __snprintf(param_1 + iVar4 + uVar8,(uVar7 - iVar4) - uVar8,"%s",local_84);
  uVar5 = FUN_10016740(uVar8,uVar7,uVar6);
  return uVar5;
}



undefined4 __cdecl FUN_10016f90(char *param_1,undefined4 param_2,byte *param_3)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int extraout_EDX;
  uint uVar6;
  uint uVar7;
  
  if ((((*param_1 != '<') || (param_1[0xd] != ' ')) || (param_1[0xe] != '/')) ||
     (param_1[0xf] != '>')) {
    return 0xfffffffe;
  }
  uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
  bVar1 = "0123456789abcdef"[param_1[9] + 0x10];
  uVar6 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
  bVar2 = "0123456789abcdef"[param_1[10] + 0x10];
  iVar3 = FUN_100166b0((uint)bVar2,(int)param_1);
  if (iVar3 == 0) {
    return 0xfffffffd;
  }
  iVar3 = FUN_10016700(uVar7,extraout_EDX);
  if (iVar3 != 0) {
    iVar3 = __snprintf(param_1 + uVar7,uVar6 - uVar7,"%s=\"",param_2);
    if (-1 < iVar3) {
      iVar3 = uVar7 + iVar3;
      iVar4 = FUN_10016a50((byte *)(param_1 + iVar3),uVar6 - iVar3,param_3);
      if ((-1 < iVar4) && (iVar3 = iVar3 + iVar4, iVar3 + 3 <= (int)uVar6)) {
        (param_1 + uVar7)[-1] = ' ';
        param_1[iVar3] = '\"';
        param_1[iVar3 + 1] = '>';
        param_1[iVar3 + 2] = '\0';
        uVar5 = FUN_10016740(uVar7,uVar6,(uint)bVar1 << 4 | (uint)bVar2);
        return uVar5;
      }
    }
    return 0xffffffff;
  }
  return 0xfffffffc;
}



void __cdecl FUN_10017110(char *param_1,undefined4 param_2,undefined4 param_3)

{
  char local_100 [256];
  
  __snprintf(local_100,0x100,"%s=\"%d\">",param_2,param_3);
  FUN_10016860(param_1,local_100);
  return;
}



undefined4 __cdecl FUN_10017150(char *param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 local_124 [9];
  char local_100 [256];
  
  puVar1 = FUN_10016560(local_124);
  if (puVar1 == (undefined4 *)0x0) {
    return 0xfffffffb;
  }
  __snprintf(local_100,0x100,"%s=\"%04d-%02d-%02dT%02d:%02d:%02dZ\">",param_2,puVar1[5] + 0x76c,
             puVar1[4] + 1,puVar1[3],puVar1[2],puVar1[1],*puVar1);
  uVar2 = FUN_10016860(param_1,local_100);
  return uVar2;
}



undefined4 __cdecl FUN_100171e0(char *param_1,byte *param_2)

{
  byte bVar1;
  byte bVar2;
  char cVar3;
  byte bVar4;
  int iVar5;
  undefined4 uVar6;
  uint uVar7;
  uint uVar8;
  
  if ((((*param_1 == '<') && (param_1[0xd] == ' ')) && (param_1[0xe] == '/')) &&
     (param_1[0xf] == '>')) {
    uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
    bVar1 = "0123456789abcdef"[param_1[9] + 0x10];
    uVar8 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
    bVar2 = "0123456789abcdef"[param_1[10] + 0x10];
    cVar3 = "0123456789abcdef"[param_1[0xb] + 0x10];
    bVar4 = "0123456789abcdef"[param_1[0xc] + 0x10];
    iVar5 = FUN_100166b0((int)param_1[0xc],(int)param_1);
    if (iVar5 == 0) {
      return 0xfffffffd;
    }
    iVar5 = FUN_10016800(uVar8,uVar7,(int)param_1,cVar3 << 4 | bVar4);
    if (-1 < iVar5) {
      iVar5 = FUN_10016a50((byte *)(param_1 + uVar7 + iVar5),uVar8 - (uVar7 + iVar5),param_2);
      if (-1 < iVar5) {
        uVar6 = FUN_10016740(uVar7,uVar8,(uint)bVar1 << 4 | (uint)bVar2);
        return uVar6;
      }
    }
    return 0xffffffff;
  }
  return 0xfffffffe;
}



char * __cdecl FUN_10017330(char *param_1,uint param_2,char *param_3,int param_4)

{
  undefined4 *puVar1;
  int *piVar2;
  byte bVar3;
  char cVar4;
  int iVar5;
  uint uVar6;
  char *pcVar7;
  int iVar8;
  int iVar9;
  char *pcVar10;
  char *pcVar11;
  char local_380 [96];
  char local_320 [32];
  char local_300 [256];
  char local_200 [256];
  char local_100 [256];
  
  cVar4 = *param_3;
  if (cVar4 == ' ') {
    param_3 = param_3 + 1;
  }
  if (-1 < (int)param_2) {
    FUN_10016ae0(param_1,param_2,cVar4 == ' ');
  }
  if (*param_3 != '\0') {
    iVar9 = param_4 + -4;
    pcVar11 = param_3 + 4;
    pcVar10 = local_380 + (1 - (int)param_3);
    do {
      if (pcVar11[-4] == '<') {
        iVar5 = 0;
        pcVar7 = pcVar11 + -3;
        do {
          cVar4 = *pcVar7;
          if (((cVar4 < '\x01') || ('~' < cVar4)) || ((char)(&DAT_100570f0)[cVar4] < '!')) break;
          local_380[iVar5] = cVar4;
          cVar4 = pcVar11[iVar5 + -2];
          if (((cVar4 < '\x01') || ('~' < cVar4)) || ((char)(&DAT_100570f0)[cVar4] < '!')) {
            iVar5 = iVar5 + 1;
            break;
          }
          pcVar7[(int)(pcVar10 + -1)] = cVar4;
          cVar4 = pcVar11[iVar5 + -1];
          if (((cVar4 < '\x01') || ('~' < cVar4)) || ((char)(&DAT_100570f0)[cVar4] < '!')) {
            iVar5 = iVar5 + 2;
            break;
          }
          pcVar7[(int)pcVar10] = cVar4;
          cVar4 = pcVar11[iVar5];
          if (((cVar4 < '\x01') || ('~' < cVar4)) || ((char)(&DAT_100570f0)[cVar4] < '!')) {
            iVar5 = iVar5 + 3;
            break;
          }
          pcVar7[(int)(pcVar10 + 1)] = cVar4;
          iVar5 = iVar5 + 4;
          pcVar7 = pcVar7 + 4;
        } while (iVar5 < 0x40);
        local_380[iVar5] = '\0';
        if (0 < iVar5) {
          FUN_10016c00(param_1,local_380);
        }
      }
      cVar4 = pcVar11[-4];
      pcVar7 = pcVar11 + -4;
      if (cVar4 == '=') {
        if (pcVar11 + -4 != param_3) {
          while( true ) {
            bVar3 = pcVar7[-1];
            if (((char)bVar3 < '\x01') || ('~' < (char)bVar3)) break;
            if (((char)(&DAT_100570f0)[bVar3 & 0x7f] < '!') ||
               (pcVar7 = pcVar7 + -1, pcVar7 == param_3)) break;
          }
        }
        iVar8 = 0;
        iVar5 = -(int)pcVar7;
        do {
          if (pcVar7 == pcVar11 + -4) break;
          iVar8 = iVar8 + 1;
          pcVar7[(int)(local_380 + iVar5)] = *pcVar7;
          pcVar7 = pcVar7 + 1;
        } while (iVar8 < 0x40);
        local_380[iVar8] = '\0';
      }
      uVar6 = (((int)cVar4 | 0x2000U) << 8 | (int)pcVar11[-3]) << 8 | (int)pcVar11[-2];
      if ((cVar4 == '/') && (pcVar11[-3] == '>')) {
        FUN_10016d40(param_1);
      }
      else if (uVar6 == 0x203e2573) {
        puVar1 = (undefined4 *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        FUN_100171e0(param_1,(byte *)*puVar1);
      }
      else if (uVar6 == 0x203e2564) {
        puVar1 = (undefined4 *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        __snprintf(local_300,0x100,"%d",*puVar1);
        FUN_10016860(param_1,local_300);
      }
      else if (uVar6 == 0x203e2565) {
        iVar5 = *(int *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        if (iVar5 == 0) {
          iVar5 = FID_conflict___time32((__time32_t *)0x0);
        }
        __snprintf(local_200,0x100,"%d",iVar5);
        FUN_10016860(param_1,local_200);
      }
      else if (uVar6 == 0x203e2561) {
        uVar6 = *(uint *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        __snprintf(local_320,0x20,"%d.%d.%d.%d",uVar6 >> 0x18,uVar6 >> 0x10 & 0xff,uVar6 >> 8 & 0xff
                   ,uVar6 & 0xff);
        FUN_10016860(param_1,local_320);
      }
      else if (local_380[0] != '\0') {
        if (uVar6 == 0x203d2573) {
          puVar1 = (undefined4 *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          FUN_10016f90(param_1,local_380,(byte *)*puVar1);
        }
        else if (uVar6 == 0x203d2564) {
          puVar1 = (undefined4 *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          __snprintf(local_100,0x100,"%s=\"%d\">",local_380,*puVar1);
          FUN_10016860(param_1,local_100);
        }
        else if (uVar6 == 0x203d2565) {
          piVar2 = (int *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          if (*piVar2 == 0) {
            FID_conflict___time32((__time32_t *)0x0);
          }
          FUN_10017150(param_1,local_380);
        }
        else if (uVar6 == 0x203d2561) {
          uVar6 = *(uint *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          __snprintf(local_380 + 0x40,0x20,"%s=\"%d.%d.%d.%d\">",local_380,uVar6 >> 0x18,
                     uVar6 >> 0x10 & 0xff,uVar6 >> 8 & 0xff,uVar6 & 0xff);
          FUN_10016860(param_1,local_380 + 0x40);
        }
      }
      pcVar7 = pcVar11 + -3;
      pcVar10 = pcVar10 + -1;
      pcVar11 = pcVar11 + 1;
    } while (*pcVar7 != '\0');
  }
  if ((((-1 < (int)param_2) && (*param_1 == '<')) && (param_1[0xd] == ' ')) &&
     ((param_1[0xe] == '/' && (param_1[0xf] == '>')))) {
    builtin_strncpy(param_1,"                ",0x10);
    param_1 = param_1 + 0x10;
  }
  return param_1;
}



void __cdecl FUN_10017770(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  if (param_1 != (undefined4 *)0x0) {
    do {
      puVar1 = (undefined4 *)param_1[3];
      do {
        puVar2 = (undefined4 *)param_1[2];
        _free((void *)*param_1);
        _free(param_1);
        param_1 = puVar2;
      } while (puVar2 != (undefined4 *)0x0);
      param_1 = puVar1;
    } while (puVar1 != (undefined4 *)0x0);
  }
  return;
}



undefined4 __cdecl FUN_100177b0(int param_1,undefined4 param_2)

{
  int iVar1;
  
  iVar1 = 0;
  if (param_1 != 0) {
    do {
      if (*(short *)(param_1 + 10) == (short)((uint)param_2 >> 0x10)) {
        if (iVar1 == 0) {
          iVar1 = param_1;
        }
        if (*(short *)(param_1 + 8) == (short)param_2) {
          return *(undefined4 *)(param_1 + 0xc);
        }
      }
      param_1 = *(int *)(param_1 + 0x10);
    } while (param_1 != 0);
    if (iVar1 != 0) {
      return *(undefined4 *)(iVar1 + 0xc);
    }
  }
  return 0;
}



void __cdecl FUN_100177f0(int *param_1,char *param_2)

{
  char *pcVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  char *pcVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  byte bVar11;
  int iVar10;
  uint uVar12;
  
  iVar10 = 0;
  iVar5 = *param_1;
  iVar4 = 0;
  while (iVar3 = iVar5, iVar3 != 0) {
    iVar10 = iVar10 + 1;
    iVar4 = iVar3;
    iVar5 = *(int *)(iVar3 + 0x10);
  }
  pcVar6 = (char *)_malloc(0x14);
  if (*param_1 == 0) {
    *param_1 = (int)pcVar6;
  }
  else {
    *(char **)(iVar4 + 0x10) = pcVar6;
  }
  pcVar6[0] = '\0';
  pcVar6[1] = '\0';
  pcVar6[2] = '\0';
  pcVar6[3] = '\0';
  pcVar6[4] = '\0';
  pcVar6[5] = '\0';
  pcVar6[6] = '\0';
  pcVar6[7] = '\0';
  pcVar6[8] = '\0';
  pcVar6[9] = '\0';
  pcVar6[10] = '\0';
  pcVar6[0xb] = '\0';
  pcVar6[0xc] = '\0';
  pcVar6[0xd] = '\0';
  pcVar6[0xe] = '\0';
  pcVar6[0xf] = '\0';
  pcVar6[0x10] = '\0';
  pcVar6[0x11] = '\0';
  pcVar6[0x12] = '\0';
  pcVar6[0x13] = '\0';
  *(int *)(pcVar6 + 0xc) = iVar10;
  pcVar1 = pcVar6 + 3;
  *pcVar1 = *param_2;
  pcVar6[4] = param_2[1];
  pcVar6[5] = '\0';
  *pcVar6 = param_2[3];
  pcVar6[1] = param_2[4];
  pcVar6[2] = '\0';
  if ((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) {
    bVar11 = 0;
  }
  else {
    bVar11 = (byte)((uint)(ushort)(short)*pcVar1 * 0x100 + (uint)(ushort)(short)pcVar6[4] >> 8);
  }
  if (bVar11 < 0x41) {
LAB_100178e7:
    if ((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) {
      uVar12 = 0;
    }
    else {
      uVar12 = (uint)(ushort)(short)*pcVar1 * 0x100 + (uint)(ushort)(short)pcVar6[4] & 0xffff;
    }
    uVar12 = uVar12 >> 8;
  }
  else {
    if ((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) {
      bVar11 = 0;
    }
    else {
      bVar11 = (byte)((uint)(ushort)(short)*pcVar1 * 0x100 + (uint)(ushort)(short)pcVar6[4] >> 8);
    }
    if (0x5a < bVar11) goto LAB_100178e7;
    if ((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) {
      uVar12 = 0x20;
    }
    else {
      uVar12 = (int)((uint)(ushort)(short)*pcVar1 * 0x100 + (uint)(ushort)(short)pcVar6[4] & 0xffff)
               >> 8 | 0x20;
    }
  }
  if (pcVar1 == (char *)0x0) {
LAB_10017953:
    uVar9 = 0;
LAB_10017955:
    uVar9 = uVar9 & 0xff;
  }
  else {
    if (((*pcVar1 == '\0') || (bVar11 = pcVar6[4], bVar11 < 0x41)) || (0x5a < bVar11)) {
      if ((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) goto LAB_10017953;
      uVar9 = (uint)(ushort)(short)pcVar6[4];
      goto LAB_10017955;
    }
    uVar9 = bVar11 | 0x20;
  }
  cVar2 = *pcVar6;
  if (cVar2 == '\0') {
    bVar11 = 0;
  }
  else {
    bVar11 = (byte)((uint)(ushort)(short)cVar2 * 0x100 + (uint)(ushort)(short)pcVar6[1] >> 8);
  }
  if (bVar11 < 0x61) {
LAB_100179d6:
    if (cVar2 == '\0') {
      uVar7 = 0;
    }
    else {
      uVar7 = (uint)(ushort)(short)cVar2 * 0x100 + (uint)(ushort)(short)pcVar6[1] & 0xffff;
    }
    uVar7 = uVar7 >> 8;
  }
  else {
    if (cVar2 == '\0') {
      bVar11 = 0;
    }
    else {
      bVar11 = (byte)((uint)(ushort)(short)cVar2 * 0x100 + (uint)(ushort)(short)pcVar6[1] >> 8);
    }
    if (0x7a < bVar11) goto LAB_100179d6;
    if (cVar2 == '\0') {
      uVar7 = 0;
    }
    else {
      uVar7 = (int)((uint)(ushort)(short)cVar2 * 0x100 + (uint)(ushort)(short)pcVar6[1] & 0xffff) >>
              8 & 0xdf;
    }
  }
  if (cVar2 == '\0') {
    uVar8 = 0;
  }
  else {
    bVar11 = pcVar6[1];
    uVar8 = (uint)(ushort)(short)(char)bVar11;
    if ((0x60 < bVar11) && (bVar11 < 0x7b)) {
      uVar8 = uVar8 & 0xdf;
      goto LAB_10017a21;
    }
  }
  uVar8 = uVar8 & 0xff;
LAB_10017a21:
  *(uint *)(pcVar6 + 8) = (uVar12 * 0x100 + uVar9) * 0x10000 + (uVar7 * 0x100 + uVar8 & 0xffff);
  pcVar6[0x10] = '\0';
  pcVar6[0x11] = '\0';
  pcVar6[0x12] = '\0';
  pcVar6[0x13] = '\0';
  return;
}



void __cdecl FUN_10017a50(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  void *pvVar4;
  int iVar5;
  int iVar6;
  
  iVar5 = *(int *)(param_1 + 4);
  iVar6 = 0;
  if (iVar5 != 0) {
    iVar1 = *(int *)(iVar5 + 0xc);
    while (iVar1 != 0) {
      iVar5 = *(int *)(iVar5 + 0xc);
      iVar1 = *(int *)(iVar5 + 0xc);
    }
  }
  iVar1 = 0;
  for (iVar2 = iVar5; iVar2 != 0; iVar2 = *(int *)(iVar2 + 8)) {
    iVar6 = iVar6 + 1;
    iVar1 = iVar2;
  }
  piVar3 = (int *)_malloc(0x10);
  if (*(int *)(param_1 + 4) == 0) {
    iVar6 = 0;
    *(int **)(param_1 + 4) = piVar3;
  }
  else if (param_4 == 1) {
    iVar6 = 0;
    *(int **)(iVar5 + 0xc) = piVar3;
  }
  else {
    *(int **)(iVar1 + 8) = piVar3;
  }
  *piVar3 = 0;
  piVar3[1] = 0;
  piVar3[2] = 0;
  piVar3[3] = 0;
  piVar3[1] = iVar6;
  pvVar4 = _malloc(param_3 + 1);
  *piVar3 = (int)pvVar4;
  iVar5 = 0;
  if (0 < param_3) {
    do {
      *(undefined1 *)(iVar5 + *piVar3) = *(undefined1 *)(iVar5 + param_2);
      iVar5 = iVar5 + 1;
    } while (iVar5 < param_3);
  }
  *(undefined1 *)(param_3 + *piVar3) = 0;
  piVar3[3] = 0;
  piVar3[2] = 0;
  return;
}



int * __cdecl FUN_10017b10(undefined4 param_1)

{
  char cVar1;
  bool bVar2;
  char *pcVar3;
  int *piVar4;
  char *pcVar5;
  char *pcVar6;
  int iVar7;
  char *pcVar8;
  bool bVar9;
  int local_40c;
  char local_400 [1024];
  
  bVar2 = true;
  local_40c = 1;
  piVar4 = (int *)_malloc(8);
  *piVar4 = 0;
  piVar4[1] = 0;
  *piVar4 = 0;
  piVar4[1] = 0;
  pcVar5 = (char *)FUN_1003a710(0,param_1,0);
  if (pcVar5 != (char *)0x0) {
    pcVar8 = pcVar5;
    if (*pcVar5 != '\0') {
LAB_10017b67:
      cVar1 = *pcVar8;
      iVar7 = 0;
      if ('\x1f' < cVar1) {
        bVar9 = cVar1 == '\"';
        pcVar6 = pcVar8;
        if (bVar9) {
          pcVar8 = pcVar8 + 1;
          pcVar6 = pcVar8;
        }
        do {
          if (bVar9) {
            if ((bVar9) && (*pcVar8 == '\"')) {
              if (pcVar8[1] != '\"') goto LAB_10017ba6;
              pcVar8 = pcVar8 + 1;
            }
          }
          else if ((*pcVar8 < ' ') || (*pcVar8 == ',')) goto LAB_10017ba6;
          pcVar8 = pcVar8 + 1;
        } while( true );
      }
      if (cVar1 == '\n') {
        bVar2 = false;
        local_40c = 1;
      }
      goto LAB_10017c37;
    }
LAB_10017c47:
    FUN_1003a7d0(0,pcVar5);
  }
  return piVar4;
LAB_10017ba6:
  if ((int)pcVar8 - (int)pcVar6 < 0x400) {
    pcVar3 = local_400;
    for (; pcVar6 != pcVar8; pcVar6 = pcVar6 + 1) {
      if (((bVar9) && (*pcVar6 == '\"')) && (pcVar6[1] == '\"')) {
        pcVar6 = pcVar6 + 1;
      }
      *pcVar3 = *pcVar6;
      iVar7 = iVar7 + 1;
      pcVar3 = pcVar3 + 1;
    }
    *pcVar3 = '\0';
    if (bVar2) {
      FUN_100177f0(piVar4,local_400);
    }
    else {
      FUN_10017a50((int)piVar4,(int)local_400,iVar7,local_40c);
      local_40c = 0;
    }
    if ((bVar9) && (*pcVar8 == '\"')) {
      pcVar8 = pcVar8 + 1;
    }
    if (*pcVar8 == ',') {
LAB_10017c37:
      pcVar8 = pcVar8 + 1;
    }
  }
  if (*pcVar8 == '\0') goto LAB_10017c47;
  goto LAB_10017b67;
}



void __cdecl FUN_10017c60(undefined4 *param_1)

{
  void *pvVar1;
  void *_Memory;
  
  _Memory = (void *)*param_1;
  while (_Memory != (void *)0x0) {
    pvVar1 = *(void **)((int)_Memory + 0x10);
    _free(_Memory);
    _Memory = pvVar1;
  }
  FUN_10017770((undefined4 *)param_1[1]);
  _free(param_1);
  return;
}



byte * __cdecl FUN_10017ca0(int *param_1,byte *param_2,undefined4 param_3)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  undefined4 *puVar5;
  byte *pbVar6;
  bool bVar7;
  
  puVar5 = (undefined4 *)param_1[1];
  iVar2 = FUN_100177b0(*param_1,param_3);
  do {
    if (puVar5 == (undefined4 *)0x0) {
      return param_2;
    }
    pbVar6 = (byte *)*puVar5;
    pbVar3 = param_2;
    do {
      bVar1 = *pbVar3;
      bVar7 = bVar1 < *pbVar6;
      if (bVar1 != *pbVar6) {
LAB_10017ceb:
        iVar4 = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
        goto LAB_10017cf0;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar7 = bVar1 < pbVar6[1];
      if (bVar1 != pbVar6[1]) goto LAB_10017ceb;
      pbVar3 = pbVar3 + 2;
      pbVar6 = pbVar6 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_10017cf0:
    if (iVar4 == 0) {
      while (puVar5[1] != iVar2) {
        puVar5 = (undefined4 *)puVar5[2];
        if (puVar5 == (undefined4 *)0x0) {
          return param_2;
        }
      }
      if (puVar5 == (undefined4 *)0x0) {
        return param_2;
      }
      return (byte *)*puVar5;
    }
    puVar5 = (undefined4 *)puVar5[3];
  } while( true );
}



int __cdecl FUN_10017d30(int *param_1,byte *param_2,undefined4 param_3,char *param_4,size_t param_5)

{
  char cVar1;
  byte bVar2;
  char cVar3;
  size_t sVar4;
  int *piVar5;
  int iVar6;
  char *pcVar7;
  int *piVar8;
  char *pcVar9;
  void *pvVar10;
  uint uVar11;
  char *pcVar12;
  byte *pbVar13;
  int iVar14;
  undefined4 *puVar15;
  size_t *psVar16;
  byte *pbVar17;
  bool bVar18;
  byte *local_18;
  int local_14;
  int *local_c;
  
  puVar15 = (undefined4 *)param_1[1];
  iVar6 = FUN_100177b0(*param_1,param_3);
  local_14 = 0;
  param_1 = (int *)0x0;
  local_c = (int *)0x0;
  local_18 = param_2;
  if (*param_2 != 0) {
    psVar16 = &param_5;
    do {
      if ((((*local_18 == 0x3c) && (local_18[2] == 0x3e)) && ('/' < (char)local_18[1])) &&
         ((char)local_18[1] < ':')) {
        pcVar12 = (char *)psVar16[1];
        psVar16 = psVar16 + 1;
        if (*pcVar12 != '\0') {
          pcVar7 = pcVar12;
          do {
            cVar1 = *pcVar7;
            pcVar7 = pcVar7 + 1;
          } while (cVar1 != '\0');
          piVar8 = (int *)_malloc(0x10);
          *piVar8 = 0;
          piVar8[1] = 0;
          piVar8[2] = 0;
          piVar8[3] = 0;
          piVar8[1] = local_14;
          pcVar9 = pcVar12;
          do {
            cVar1 = *pcVar9;
            pcVar9 = pcVar9 + 1;
          } while (cVar1 != '\0');
          pvVar10 = _malloc((size_t)(pcVar9 + (1 - (int)(pcVar12 + 1))));
          *piVar8 = (int)pvVar10;
          uVar11 = 0;
          if (pcVar7 != pcVar12 + 1) {
            do {
              *(char *)(uVar11 + *piVar8) = pcVar12[uVar11];
              uVar11 = uVar11 + 1;
            } while (uVar11 < (uint)((int)pcVar7 - (int)(pcVar12 + 1)));
          }
          pcVar7 = pcVar12 + 1;
          do {
            cVar1 = *pcVar12;
            pcVar12 = pcVar12 + 1;
          } while (cVar1 != '\0');
          pcVar12[*piVar8 - (int)pcVar7] = '\0';
          piVar8[3] = 0;
          piVar8[2] = 0;
          piVar5 = piVar8;
          if (param_1 != (int *)0x0) {
            local_c[3] = (int)piVar8;
            piVar5 = param_1;
          }
          param_1 = piVar5;
          local_14 = local_14 + 1;
          local_c = piVar8;
        }
        local_18 = local_18 + 2;
      }
      pbVar17 = local_18 + 1;
      local_18 = local_18 + 1;
    } while (*pbVar17 != 0);
  }
  for (; sVar4 = param_5, puVar15 != (undefined4 *)0x0; puVar15 = (undefined4 *)puVar15[3]) {
    pbVar17 = (byte *)*puVar15;
    pbVar13 = param_2;
    do {
      bVar2 = *pbVar13;
      bVar18 = bVar2 < *pbVar17;
      if (bVar2 != *pbVar17) {
LAB_10017ecc:
        iVar14 = (1 - (uint)bVar18) - (uint)(bVar18 != 0);
        goto LAB_10017ed1;
      }
      if (bVar2 == 0) break;
      bVar2 = pbVar13[1];
      bVar18 = bVar2 < pbVar17[1];
      if (bVar2 != pbVar17[1]) goto LAB_10017ecc;
      pbVar13 = pbVar13 + 2;
      pbVar17 = pbVar17 + 2;
    } while (bVar2 != 0);
    iVar14 = 0;
LAB_10017ed1:
    if (iVar14 == 0) goto LAB_10017ee4;
  }
  goto LAB_10017e84;
  while (puVar15 = (undefined4 *)puVar15[2], puVar15 != (undefined4 *)0x0) {
LAB_10017ee4:
    if (puVar15[1] == iVar6) {
      if (puVar15 != (undefined4 *)0x0) {
        pcVar12 = (char *)*puVar15;
        cVar1 = *pcVar12;
        pcVar7 = param_4;
        do {
          if (cVar1 == '\0') {
            FUN_10017770(param_1);
            return (int)pcVar7 - (int)param_4;
          }
          if (((cVar1 == '<') && (pcVar12[2] == '>')) &&
             ((cVar3 = pcVar12[1], '/' < cVar3 && (cVar3 < ':')))) {
            if (param_1 != (int *)0x0) {
              piVar8 = param_1;
              do {
                if (piVar8[1] == cVar3 + -0x30) {
                  iVar6 = *piVar8;
                  pcVar9 = "%s";
                  goto LAB_10017f51;
                }
                piVar8 = (int *)piVar8[3];
              } while (piVar8 != (int *)0x0);
            }
            iVar6 = (int)cVar3;
            pcVar9 = "<%c>";
LAB_10017f51:
            iVar6 = __snprintf(pcVar7,(size_t)(param_4 + (sVar4 - (int)pcVar7)),pcVar9,iVar6);
            if (iVar6 < 1) {
              FUN_10017770(param_1);
              return -1;
            }
            pcVar12 = pcVar12 + 2;
          }
          else {
            iVar6 = __snprintf(pcVar7,(size_t)(param_4 + (sVar4 - (int)pcVar7)),"%c",(int)cVar1);
            if (iVar6 < 1) {
              FUN_10017770(param_1);
              return -1;
            }
          }
          pcVar7 = pcVar7 + iVar6;
          cVar1 = pcVar12[1];
          pcVar12 = pcVar12 + 1;
        } while( true );
      }
      break;
    }
  }
LAB_10017e84:
  iVar6 = __snprintf(param_4,param_5,(char *)param_2);
  return iVar6;
}



void __thiscall
FUN_10017ff0(void *this,byte *param_1,byte *param_2,byte *param_3,undefined1 param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  uint uVar3;
  int iVar4;
  byte local_20 [32];
  
  *(undefined1 *)this = param_4;
  *(undefined4 *)((int)this + 4) = 0;
  pbVar1 = FUN_100020f0(param_3,param_1);
  pbVar2 = FUN_100020f0(param_3,param_2);
  if ((pbVar1 != (byte *)0x0) && (pbVar2 != (byte *)0x0)) {
    iVar4 = 0;
    do {
      FUN_10003680(pbVar1,local_20,0x20,&DAT_1004d26f,iVar4,0x2c);
      if (local_20[0] == 0) break;
      uVar3 = FUN_10002780(local_20,0);
      *(uint *)((int)this + iVar4 * 4 + 8) = uVar3;
      FUN_10003680(pbVar2,local_20,0x20,&DAT_1004d26f,iVar4,0x2c);
      if (local_20[0] == 0) {
        uVar3 = 0xffffffff;
        if (iVar4 != 0) {
          uVar3 = *(uint *)((int)this + iVar4 * 4 + 0x44);
        }
      }
      else {
        uVar3 = FUN_10002780(local_20,0xffffffff);
      }
      *(uint *)((int)this + iVar4 * 4 + 0x48) = uVar3;
      iVar4 = iVar4 + 1;
    } while (iVar4 < 0x10);
    *(int *)((int)this + 4) = iVar4;
  }
  return;
}



undefined1 __thiscall FUN_100180c0(void *this,uint param_1)

{
  int iVar1;
  uint *puVar2;
  int iVar3;
  
  iVar1 = *(int *)((int)this + 4);
  if (iVar1 == 0) {
                    // WARNING: Load size is inaccurate
    return *this;
  }
  iVar3 = 0;
  if (0 < iVar1) {
    puVar2 = (uint *)((int)this + 8);
    do {
      if ((puVar2[0x10] & param_1) == *puVar2) {
        return 1;
      }
      iVar3 = iVar3 + 1;
      puVar2 = puVar2 + 1;
    } while (iVar3 < iVar1);
  }
  return 0;
}



void __thiscall FUN_10018110(void *this,int param_1)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  int local_40 [16];
  
  iVar4 = (int)this + 0x40;
  piVar3 = (int *)register0x00000010;
  do {
    piVar2 = piVar3;
    piVar1 = (int *)(iVar4 + -4);
    iVar4 = iVar4 + -4;
    piVar3 = piVar2 + -1;
    *piVar3 = *piVar1;
  } while (piVar3 != local_40);
  uVar8 = *(uint *)(param_1 + 0x58);
  uVar9 = *(uint *)(param_1 + 0x54);
  uVar7 = *(uint *)(param_1 + 0x50);
  uVar5 = ((uVar8 ^ uVar9) & uVar7 ^ uVar8) + *(int *)(param_1 + 0x4c) + *piVar3 + 0xd76aa478;
  uVar5 = (uVar5 >> 0x19 | uVar5 * 0x80) + uVar7;
  uVar8 = uVar8 + ((uVar9 ^ uVar7) & uVar5 ^ uVar9) + *piVar2 + 0xe8c7b756;
  uVar6 = (uVar8 >> 0x14 | uVar8 * 0x1000) + uVar5;
  uVar8 = uVar9 + ((uVar5 ^ uVar7) & uVar6 ^ uVar7) + piVar2[1] + 0x242070db;
  uVar9 = (uVar8 >> 0xf | uVar8 * 0x20000) + uVar6;
  uVar8 = uVar7 + ((uVar6 ^ uVar5) & uVar9 ^ uVar5) + piVar2[2] + 0xc1bdceee;
  uVar10 = (uVar8 * 0x400000 | uVar8 >> 10) + uVar9;
  uVar8 = uVar5 + ((uVar6 ^ uVar9) & uVar10 ^ uVar6) + piVar2[3] + 0xf57c0faf;
  uVar7 = (uVar8 >> 0x19 | uVar8 * 0x80) + uVar10;
  uVar8 = uVar6 + ((uVar9 ^ uVar10) & uVar7 ^ uVar9) + piVar2[4] + 0x4787c62a;
  uVar8 = (uVar8 >> 0x14 | uVar8 * 0x1000) + uVar7;
  uVar9 = uVar9 + ((uVar7 ^ uVar10) & uVar8 ^ uVar10) + piVar2[5] + 0xa8304613;
  uVar9 = (uVar9 >> 0xf | uVar9 * 0x20000) + uVar8;
  uVar5 = uVar10 + ((uVar8 ^ uVar7) & uVar9 ^ uVar7) + piVar2[6] + 0xfd469501;
  uVar5 = (uVar5 * 0x400000 | uVar5 >> 10) + uVar9;
  uVar7 = uVar7 + ((uVar8 ^ uVar9) & uVar5 ^ uVar8) + piVar2[7] + 0x698098d8;
  uVar6 = (uVar7 >> 0x19 | uVar7 * 0x80) + uVar5;
  uVar8 = uVar8 + ((uVar9 ^ uVar5) & uVar6 ^ uVar9) + piVar2[8] + 0x8b44f7af;
  uVar7 = (uVar8 >> 0x14 | uVar8 * 0x1000) + uVar6;
  uVar8 = (uVar9 + ((uVar6 ^ uVar5) & uVar7 ^ uVar5) + piVar2[9]) - 0xa44f;
  uVar8 = (uVar8 >> 0xf | uVar8 * 0x20000) + uVar7;
  uVar9 = uVar5 + ((uVar7 ^ uVar6) & uVar8 ^ uVar6) + piVar2[10] + 0x895cd7be;
  uVar9 = (uVar9 * 0x400000 | uVar9 >> 10) + uVar8;
  uVar5 = uVar6 + ((uVar7 ^ uVar8) & uVar9 ^ uVar7) + piVar2[0xb] + 0x6b901122;
  uVar5 = (uVar5 >> 0x19 | uVar5 * 0x80) + uVar9;
  uVar7 = uVar7 + ((uVar8 ^ uVar9) & uVar5 ^ uVar8) + piVar2[0xc] + 0xfd987193;
  uVar7 = (uVar7 >> 0x14 | uVar7 * 0x1000) + uVar5;
  uVar8 = uVar8 + ((uVar5 ^ uVar9) & uVar7 ^ uVar9) + piVar2[0xd] + 0xa679438e;
  uVar6 = (uVar8 >> 0xf | uVar8 * 0x20000) + uVar7;
  uVar8 = uVar9 + ((uVar7 ^ uVar5) & uVar6 ^ uVar5) + piVar2[0xe] + 0x49b40821;
  uVar8 = (uVar8 * 0x400000 | uVar8 >> 10) + uVar6;
  uVar9 = uVar5 + ((uVar6 ^ uVar8) & uVar7 ^ uVar6) + *piVar2 + 0xf61e2562;
  uVar9 = (uVar9 >> 0x1b | uVar9 * 0x20) + uVar8;
  uVar7 = uVar7 + ((uVar9 ^ uVar8) & uVar6 ^ uVar8) + piVar2[5] + 0xc040b340;
  uVar5 = (uVar7 >> 0x17 | uVar7 * 0x200) + uVar9;
  uVar7 = uVar6 + ((uVar5 ^ uVar9) & uVar8 ^ uVar9) + piVar2[10] + 0x265e5a51;
  uVar7 = (uVar7 >> 0x12 | uVar7 * 0x4000) + uVar5;
  uVar8 = uVar8 + ((uVar5 ^ uVar7) & uVar9 ^ uVar5) + *piVar3 + 0xe9b6c7aa;
  uVar6 = (uVar8 * 0x100000 | uVar8 >> 0xc) + uVar7;
  uVar8 = uVar9 + ((uVar7 ^ uVar6) & uVar5 ^ uVar7) + piVar2[4] + 0xd62f105d;
  uVar8 = (uVar8 >> 0x1b | uVar8 * 0x20) + uVar6;
  uVar9 = uVar5 + ((uVar8 ^ uVar6) & uVar7 ^ uVar6) + piVar2[9] + 0x2441453;
  uVar9 = (uVar9 >> 0x17 | uVar9 * 0x200) + uVar8;
  uVar7 = uVar7 + ((uVar9 ^ uVar8) & uVar6 ^ uVar8) + piVar2[0xe] + 0xd8a1e681;
  uVar5 = (uVar7 >> 0x12 | uVar7 * 0x4000) + uVar9;
  uVar7 = uVar6 + ((uVar9 ^ uVar5) & uVar8 ^ uVar9) + piVar2[3] + 0xe7d3fbc8;
  uVar7 = (uVar7 * 0x100000 | uVar7 >> 0xc) + uVar5;
  uVar8 = uVar8 + ((uVar5 ^ uVar7) & uVar9 ^ uVar5) + piVar2[8] + 0x21e1cde6;
  uVar10 = (uVar8 >> 0x1b | uVar8 * 0x20) + uVar7;
  uVar8 = uVar9 + ((uVar10 ^ uVar7) & uVar5 ^ uVar7) + piVar2[0xd] + 0xc33707d6;
  uVar8 = (uVar8 >> 0x17 | uVar8 * 0x200) + uVar10;
  uVar9 = uVar5 + ((uVar8 ^ uVar10) & uVar7 ^ uVar10) + piVar2[2] + 0xf4d50d87;
  uVar9 = (uVar9 >> 0x12 | uVar9 * 0x4000) + uVar8;
  uVar7 = uVar7 + ((uVar8 ^ uVar9) & uVar10 ^ uVar8) + piVar2[7] + 0x455a14ed;
  uVar6 = (uVar7 * 0x100000 | uVar7 >> 0xc) + uVar9;
  uVar7 = uVar10 + ((uVar9 ^ uVar6) & uVar8 ^ uVar9) + piVar2[0xc] + 0xa9e3e905;
  uVar7 = (uVar7 >> 0x1b | uVar7 * 0x20) + uVar6;
  uVar8 = uVar8 + ((uVar7 ^ uVar6) & uVar9 ^ uVar6) + piVar2[1] + 0xfcefa3f8;
  uVar10 = (uVar8 >> 0x17 | uVar8 * 0x200) + uVar7;
  uVar8 = uVar9 + ((uVar10 ^ uVar7) & uVar6 ^ uVar7) + piVar2[6] + 0x676f02d9;
  uVar5 = (uVar8 >> 0x12 | uVar8 * 0x4000) + uVar10;
  uVar8 = uVar6 + ((uVar10 ^ uVar5) & uVar7 ^ uVar10) + piVar2[0xb] + 0x8d2a4c8a;
  uVar8 = (uVar8 * 0x100000 | uVar8 >> 0xc) + uVar5;
  uVar9 = (uVar7 + (uVar10 ^ uVar5 ^ uVar8) + piVar2[4]) - 0x5c6be;
  uVar9 = (uVar9 >> 0x1c | uVar9 * 0x10) + uVar8;
  uVar7 = uVar10 + (uVar5 ^ uVar9 ^ uVar8) + piVar2[7] + 0x8771f681;
  uVar7 = (uVar7 >> 0x15 | uVar7 * 0x800) + uVar9;
  uVar5 = uVar5 + (uVar7 ^ uVar9 ^ uVar8) + piVar2[10] + 0x6d9d6122;
  uVar10 = (uVar5 >> 0x10 | uVar5 * 0x10000) + uVar7;
  uVar8 = uVar8 + (uVar7 ^ uVar10 ^ uVar9) + piVar2[0xd] + 0xfde5380c;
  uVar6 = (uVar8 * 0x800000 | uVar8 >> 9) + uVar10;
  uVar8 = uVar9 + (uVar7 ^ uVar10 ^ uVar6) + *piVar2 + 0xa4beea44;
  uVar8 = (uVar8 >> 0x1c | uVar8 * 0x10) + uVar6;
  uVar9 = uVar7 + (uVar10 ^ uVar8 ^ uVar6) + piVar2[3] + 0x4bdecfa9;
  uVar5 = (uVar9 >> 0x15 | uVar9 * 0x800) + uVar8;
  uVar9 = uVar10 + (uVar5 ^ uVar8 ^ uVar6) + piVar2[6] + 0xf6bb4b60;
  uVar7 = (uVar9 >> 0x10 | uVar9 * 0x10000) + uVar5;
  uVar9 = uVar6 + (uVar5 ^ uVar7 ^ uVar8) + piVar2[9] + 0xbebfbc70;
  uVar9 = (uVar9 * 0x800000 | uVar9 >> 9) + uVar7;
  uVar8 = uVar8 + (uVar5 ^ uVar7 ^ uVar9) + piVar2[0xc] + 0x289b7ec6;
  uVar6 = (uVar8 >> 0x1c | uVar8 * 0x10) + uVar9;
  uVar8 = uVar5 + (uVar7 ^ uVar6 ^ uVar9) + *piVar3 + 0xeaa127fa;
  uVar5 = (uVar8 >> 0x15 | uVar8 * 0x800) + uVar6;
  uVar8 = uVar7 + (uVar5 ^ uVar6 ^ uVar9) + piVar2[2] + 0xd4ef3085;
  uVar7 = (uVar8 >> 0x10 | uVar8 * 0x10000) + uVar5;
  uVar8 = uVar9 + (uVar5 ^ uVar7 ^ uVar6) + piVar2[5] + 0x4881d05;
  uVar8 = (uVar8 * 0x800000 | uVar8 >> 9) + uVar7;
  uVar9 = uVar6 + (uVar5 ^ uVar7 ^ uVar8) + piVar2[8] + 0xd9d4d039;
  uVar9 = (uVar9 >> 0x1c | uVar9 * 0x10) + uVar8;
  uVar5 = uVar5 + (uVar7 ^ uVar9 ^ uVar8) + piVar2[0xb] + 0xe6db99e5;
  uVar5 = (uVar5 >> 0x15 | uVar5 * 0x800) + uVar9;
  uVar7 = uVar7 + (uVar5 ^ uVar9 ^ uVar8) + piVar2[0xe] + 0x1fa27cf8;
  uVar6 = (uVar7 >> 0x10 | uVar7 * 0x10000) + uVar5;
  uVar8 = uVar8 + (uVar5 ^ uVar6 ^ uVar9) + piVar2[1] + 0xc4ac5665;
  uVar7 = (uVar8 * 0x800000 | uVar8 >> 9) + uVar6;
  uVar8 = uVar9 + ((~uVar5 | uVar7) ^ uVar6) + *piVar3 + 0xf4292244;
  uVar8 = (uVar8 >> 0x1a | uVar8 * 0x40) + uVar7;
  uVar9 = uVar5 + ((~uVar6 | uVar8) ^ uVar7) + piVar2[6] + 0x432aff97;
  uVar9 = (uVar9 >> 0x16 | uVar9 * 0x400) + uVar8;
  uVar5 = uVar6 + ((~uVar7 | uVar9) ^ uVar8) + piVar2[0xd] + 0xab9423a7;
  uVar5 = (uVar5 >> 0x11 | uVar5 * 0x8000) + uVar9;
  uVar7 = uVar7 + ((~uVar8 | uVar5) ^ uVar9) + piVar2[4] + 0xfc93a039;
  uVar6 = (uVar7 * 0x200000 | uVar7 >> 0xb) + uVar5;
  uVar8 = uVar8 + ((~uVar9 | uVar6) ^ uVar5) + piVar2[0xb] + 0x655b59c3;
  uVar7 = (uVar8 >> 0x1a | uVar8 * 0x40) + uVar6;
  uVar8 = uVar9 + ((~uVar5 | uVar7) ^ uVar6) + piVar2[2] + 0x8f0ccc92;
  uVar8 = (uVar8 >> 0x16 | uVar8 * 0x400) + uVar7;
  uVar9 = (uVar5 + ((~uVar6 | uVar8) ^ uVar7) + piVar2[9]) - 0x100b83;
  uVar9 = (uVar9 >> 0x11 | uVar9 * 0x8000) + uVar8;
  uVar5 = uVar6 + ((~uVar7 | uVar9) ^ uVar8) + *piVar2 + 0x85845dd1;
  uVar5 = (uVar5 * 0x200000 | uVar5 >> 0xb) + uVar9;
  uVar7 = uVar7 + ((~uVar8 | uVar5) ^ uVar9) + piVar2[7] + 0x6fa87e4f;
  uVar6 = (uVar7 >> 0x1a | uVar7 * 0x40) + uVar5;
  uVar8 = uVar8 + ((~uVar9 | uVar6) ^ uVar5) + piVar2[0xe] + 0xfe2ce6e0;
  uVar7 = (uVar8 >> 0x16 | uVar8 * 0x400) + uVar6;
  uVar8 = uVar9 + ((~uVar5 | uVar7) ^ uVar6) + piVar2[5] + 0xa3014314;
  uVar8 = (uVar8 >> 0x11 | uVar8 * 0x8000) + uVar7;
  uVar9 = uVar5 + ((~uVar6 | uVar8) ^ uVar7) + piVar2[0xc] + 0x4e0811a1;
  uVar9 = (uVar9 * 0x200000 | uVar9 >> 0xb) + uVar8;
  uVar5 = uVar6 + ((~uVar7 | uVar9) ^ uVar8) + piVar2[3] + 0xf7537e82;
  uVar5 = (uVar5 >> 0x1a | uVar5 * 0x40) + uVar9;
  uVar7 = uVar7 + ((~uVar8 | uVar5) ^ uVar9) + piVar2[10] + 0xbd3af235;
  uVar6 = (uVar7 >> 0x16 | uVar7 * 0x400) + uVar5;
  uVar8 = uVar8 + ((~uVar9 | uVar6) ^ uVar5) + piVar2[1] + 0x2ad7d2bb;
  uVar7 = (uVar8 >> 0x11 | uVar8 * 0x8000) + uVar6;
  iVar4 = piVar2[8];
  *(uint *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) + uVar5;
  uVar8 = uVar9 + ((~uVar5 | uVar7) ^ uVar6) + iVar4 + 0xeb86d391;
  *(uint *)(param_1 + 0x50) = (uVar8 * 0x200000 | uVar8 >> 0xb) + *(int *)(param_1 + 0x50) + uVar7;
  *(uint *)(param_1 + 0x54) = *(int *)(param_1 + 0x54) + uVar7;
  *(uint *)(param_1 + 0x58) = *(int *)(param_1 + 0x58) + uVar6;
  return;
}



void __cdecl FUN_10018990(int param_1)

{
  *(undefined4 *)(param_1 + 0x48) = 0;
  *(undefined4 *)(param_1 + 0x4c) = 0x67452301;
  *(undefined4 *)(param_1 + 0x50) = 0xefcdab89;
  *(undefined4 *)(param_1 + 0x54) = 0x98badcfe;
  *(undefined4 *)(param_1 + 0x58) = 0x10325476;
  return;
}



void __cdecl FUN_100189c0(char *param_1,char *param_2,uint param_3)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  
  if ((int)param_3 < 0) {
    param_3 = 0;
    cVar1 = *param_2;
    while (cVar1 != '\0') {
      iVar2 = param_3 + 1;
      param_3 = param_3 + 1;
      cVar1 = param_2[iVar2];
    }
  }
  uVar5 = *(uint *)(param_1 + 0x48) & 0x3f;
  *(uint *)(param_1 + 0x48) = *(uint *)(param_1 + 0x48) + param_3;
  if (uVar5 != 0) {
    uVar3 = 0x40 - uVar5;
    pcVar6 = param_1 + uVar5;
    if ((int)param_3 < (int)uVar3) goto LAB_10018a57;
    pcVar6 = param_2;
    pcVar7 = param_1 + uVar5;
    for (uVar4 = uVar3 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
      *(undefined4 *)pcVar7 = *(undefined4 *)pcVar6;
      pcVar6 = pcVar6 + 4;
      pcVar7 = pcVar7 + 4;
    }
    for (uVar5 = uVar3 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
      *pcVar7 = *pcVar6;
      pcVar6 = pcVar6 + 1;
      pcVar7 = pcVar7 + 1;
    }
    param_2 = param_2 + uVar3;
    param_3 = param_3 - uVar3;
    FUN_10018110(param_1,(int)param_1);
  }
  if (0x3f < (int)param_3) {
    uVar5 = param_3 >> 6;
    param_3 = param_3 + uVar5 * -0x40;
    do {
      FUN_10018110(param_2,(int)param_1);
      param_2 = param_2 + 0x40;
      uVar5 = uVar5 - 1;
    } while (uVar5 != 0);
  }
  pcVar6 = param_1;
  if ((int)param_3 < 1) {
    return;
  }
LAB_10018a57:
  for (uVar5 = param_3 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
    *(undefined4 *)pcVar6 = *(undefined4 *)param_2;
    param_2 = param_2 + 4;
    pcVar6 = pcVar6 + 4;
  }
  for (uVar5 = param_3 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
    *pcVar6 = *param_2;
    param_2 = param_2 + 1;
    pcVar6 = pcVar6 + 1;
  }
  return;
}



void __cdecl FUN_10018a70(void *param_1,undefined1 *param_2,int param_3)

{
  undefined *puVar1;
  uint uVar2;
  uint uVar3;
  undefined4 *puVar4;
  uint uVar5;
  
  uVar2 = *(uint *)((int)param_1 + 0x48) & 0x3f;
  uVar5 = 0;
  *(undefined1 *)(uVar2 + (int)param_1) = 0x80;
  uVar3 = uVar2 + 1;
  if (0x38 < uVar3) {
    *(undefined1 *)(uVar3 + (int)param_1) = 0;
    *(undefined1 *)(uVar2 + 2 + (int)param_1) = 0;
    *(undefined1 *)(uVar2 + 3 + (int)param_1) = 0;
    *(undefined1 *)(uVar2 + 4 + (int)param_1) = 0;
    *(undefined1 *)(uVar2 + 5 + (int)param_1) = 0;
    *(undefined1 *)(uVar2 + 6 + (int)param_1) = 0;
    *(undefined1 *)(uVar2 + 7 + (int)param_1) = 0;
    *(undefined1 *)(uVar2 + 8 + (int)param_1) = 0;
    FUN_10018110(param_1,(int)param_1);
    uVar3 = 0;
  }
  *(undefined1 *)(uVar3 + (int)param_1) = 0;
  *(undefined1 *)(uVar3 + 1 + (int)param_1) = 0;
  *(undefined1 *)(uVar3 + 2 + (int)param_1) = 0;
  uVar2 = (int)(uVar3 + 3) >> 2;
  puVar4 = (undefined4 *)((int)param_1 + uVar2 * 4);
  do {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
    uVar2 = uVar2 + 1;
  } while (uVar2 < 0x10);
  *(char *)((int)param_1 + 0x38) = *(char *)((int)param_1 + 0x48) << 3;
  uVar2 = *(uint *)((int)param_1 + 0x48);
  *(char *)((int)param_1 + 0x39) = (char)(uVar2 >> 5);
  *(char *)((int)param_1 + 0x3b) = (char)(uVar2 >> 0x15);
  *(char *)((int)param_1 + 0x3a) = (char)(uVar2 >> 0xd);
  *(byte *)((int)param_1 + 0x3c) = (byte)(uVar2 >> 0x1d);
  FUN_10018110(param_1,(int)param_1);
  puVar1 = PTR_s_0123456789abcdef_10057170;
  uVar2 = 0;
  do {
    if ((uVar2 & 3) == 0) {
      uVar5 = *(uint *)((int)param_1 + ((int)uVar2 >> 2) * 4 + 0x4c);
    }
    if (param_3 < 0x21) {
      if ((int)uVar2 < param_3) {
        *param_2 = (char)uVar5;
        goto LAB_10018b53;
      }
    }
    else {
      *param_2 = puVar1[uVar5 >> 4 & 0xf];
      param_2 = param_2 + 1;
      *param_2 = puVar1[uVar5 & 0xf];
LAB_10018b53:
      param_2 = param_2 + 1;
    }
    uVar5 = uVar5 >> 8;
    uVar2 = uVar2 + 1;
    if (0xf < (int)uVar2) {
      if (0x20 < param_3) {
        *param_2 = 0;
      }
      return;
    }
  } while( true );
}



undefined4 __cdecl FUN_10019ed0(undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    FUN_10016490(0x400000);
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    FUN_10016490(0x400000);
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x28) = 0;
    return 0;
  }
  if (*(int *)(param_2 + 0x84) == 0) {
    *(undefined4 *)(param_2 + 0x50) = 0x636c6663;
    FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
                 *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
  }
  else if (*(int *)(param_2 + 0x84) == 1) {
    FUN_1000ada0(param_2);
    FUN_1003d8a0(param_1,param_2,param_3);
  }
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x28) = 0;
  return 0xffffffff;
}



undefined4 __cdecl FUN_10019fa0(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  undefined4 uVar3;
  byte local_20;
  undefined1 local_1f;
  undefined1 local_1e;
  
  if (*(int *)(param_1 + 0x4030) == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x64697361;
    return 0;
  }
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),*(char **)(param_2 + 0x7c));
  if (*(int *)(param_2 + 0x84) == 1) {
    FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"ADMIN",1);
  }
  else {
    if (iVar1 == 0) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
      return 0;
    }
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8d8,
                 (byte *)(iVar1 + 0x20));
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e700,
                 (byte *)(iVar1 + 0x2e4));
  }
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"COUNTRY");
  iVar1 = FUN_10002480((char *)pbVar2,iVar1);
  if (iVar1 != 0) {
    local_1f = (undefined1)iVar1;
    local_20 = (byte)((uint)iVar1 >> 8);
    local_1e = 0;
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"COUNTRY",&local_20);
  }
  iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar1;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4030),0x24636663,-iVar1,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  uVar3 = FUN_1001ab10(param_2,FUN_10019ed0);
  return uVar3;
}



undefined4 __cdecl FUN_1001a120(int param_1,int param_2,int param_3)

{
  byte bVar4;
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte local_c;
  byte local_b;
  byte local_8 [8];
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    FUN_10016490(0x400000);
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    FUN_10016490(0x400000);
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x28) = 0;
    return 0;
  }
  if (*(int *)(param_2 + 0x84) != 0) {
    if (*(int *)(param_2 + 0x84) == 1) {
      FUN_1000ada0(param_2);
      FUN_1003da30(param_1,param_2,param_3);
    }
    goto LAB_1001a316;
  }
  *(undefined4 *)(param_2 + 0x50) = 0x636c6763;
  FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
               *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
  pbVar7 = &DAT_1004d26f;
  iVar1 = 3;
  pbVar6 = &local_c;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x60),(byte *)"COUNTRY");
  FUN_10002a30(pbVar2,pbVar6,iVar1,pbVar7);
  if (local_c == 0) {
    bVar4 = 0;
  }
  else {
    bVar4 = (byte)((uint)(ushort)(short)(char)local_c * 0x100 + (uint)(ushort)(short)(char)local_b
                  >> 8);
  }
  if (bVar4 < 0x61) {
LAB_1001a263:
    if (local_c == 0) {
      uVar3 = 0;
    }
    else {
      uVar3 = (uint)(ushort)(short)(char)local_c * 0x100 + (uint)(ushort)(short)(char)local_b;
    }
    uVar3 = (uVar3 & 0xffff) >> 8;
  }
  else {
    if (local_c == 0) {
      bVar4 = 0;
    }
    else {
      bVar4 = (byte)((uint)(ushort)(short)(char)local_c * 0x100 + (uint)(ushort)(short)(char)local_b
                    >> 8);
    }
    if (0x7a < bVar4) goto LAB_1001a263;
    if (local_c == 0) {
      uVar3 = 0;
    }
    else {
      uVar3 = (uint)(ushort)(short)(char)local_c * 0x100 + (uint)(ushort)(short)(char)local_b >> 8 &
              0xdf;
    }
  }
  if (local_c == 0) {
    uVar5 = 0;
LAB_1001a2a4:
    uVar5 = uVar5 & 0xff;
  }
  else {
    uVar5 = (uint)(ushort)(short)(char)local_b;
    if ((local_b < 0x61) || (0x7a < local_b)) goto LAB_1001a2a4;
    uVar5 = uVar5 & 0xdf;
  }
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"COUNTRY",
               uVar3 * 0x100 + uVar5 & 0xffff);
  pbVar7 = &DAT_1004d26f;
  iVar1 = 8;
  pbVar6 = local_8;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x60),&DAT_10050214);
  FUN_10002a30(pbVar2,pbVar6,iVar1,pbVar7);
  uVar3 = FUN_100219e0(*(int *)(param_1 + 0x4324),local_8);
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_100503f8,uVar3);
LAB_1001a316:
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x28) = 0;
  return 0xffffffff;
}



int __cdecl FUN_1001a880(char *param_1)

{
  byte bVar1;
  int in_EAX;
  byte *pbVar2;
  int iVar3;
  uint3 uVar5;
  byte *pbVar4;
  byte *unaff_EBX;
  byte *pbVar6;
  int iVar7;
  bool bVar8;
  char *pcVar9;
  byte local_28 [40];
  
  pcVar9 = "MONITOR_ACCOUNTS";
  pbVar2 = FUN_1002a500(*(uint **)(in_EAX + 0x4034),(byte *)0x0);
  pbVar2 = FUN_100020f0(pbVar2,(byte *)pcVar9);
  iVar7 = 0;
  iVar3 = FUN_10003680(pbVar2,local_28,0x26,&DAT_1004d26f,0,0x2c);
  uVar5 = (uint3)((uint)iVar3 >> 8);
  do {
    if (local_28[0] == 0) {
      return (uint)uVar5 << 8;
    }
    pcVar9 = _strchr((char *)local_28,0x2f);
    if (pcVar9 != (char *)0x0) {
      *pcVar9 = '\0';
      iVar3 = FUN_10025580(param_1,(char *)local_28);
      if (iVar3 == 0) {
        pbVar6 = (byte *)(pcVar9 + 1);
        pbVar4 = unaff_EBX;
        do {
          bVar1 = *pbVar4;
          bVar8 = bVar1 < *pbVar6;
          if (bVar1 != *pbVar6) {
LAB_1001a91b:
            iVar3 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
            goto LAB_1001a920;
          }
          if (bVar1 == 0) break;
          bVar1 = pbVar4[1];
          bVar8 = bVar1 < pbVar6[1];
          if (bVar1 != pbVar6[1]) goto LAB_1001a91b;
          pbVar4 = pbVar4 + 2;
          pbVar6 = pbVar6 + 2;
        } while (bVar1 != 0);
        iVar3 = 0;
LAB_1001a920:
        if (iVar3 == 0) {
          return 1;
        }
      }
    }
    iVar7 = iVar7 + 1;
    iVar3 = FUN_10003680(pbVar2,local_28,0x26,&DAT_1004d26f,iVar7,0x2c);
    uVar5 = (uint3)((uint)iVar3 >> 8);
  } while( true );
}



void __thiscall
FUN_1001a960(void *this,undefined4 *param_1,int param_2,undefined4 param_3,undefined4 *param_4)

{
  char cVar1;
  int in_EAX;
  int iVar2;
  int unaff_EBX;
  char *pcVar3;
  undefined4 *puVar5;
  char local_110 [16];
  char local_100 [256];
  char *pcVar4;
  
  cVar1 = *(char *)(unaff_EBX + 0x144);
  pcVar4 = (char *)(unaff_EBX + 0x144);
  if (cVar1 == '\0') {
    *(undefined1 *)this = 0;
    return;
  }
  do {
    pcVar3 = pcVar4 + 1;
    if (in_EAX < 2) {
      return;
    }
    if (cVar1 != '%') {
switchD_1001a9ba_caseD_62:
      *(char *)this = cVar1;
      this = (void *)((int)this + 1);
      in_EAX = in_EAX + -1;
      goto LAB_1001aac2;
    }
    cVar1 = *pcVar3;
    if (cVar1 == '\0') goto LAB_1001aac2;
    pcVar3 = pcVar4 + 2;
    switch(cVar1) {
    case 'a':
      iVar2 = _sprintf((char *)this,"%d.%d.%d.%d",(uint)*(byte *)(unaff_EBX + 0x1b),
                       (uint)*(byte *)(unaff_EBX + 0x1a),(uint)*(byte *)(unaff_EBX + 0x19),
                       *(uint *)(unaff_EBX + 0x18) & 0xff);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    default:
      goto switchD_1001a9ba_caseD_62;
    case 'c':
      puVar5 = (undefined4 *)(unaff_EBX + 0x44);
      goto LAB_1001aa8c;
    case 'i':
      iVar2 = _sprintf((char *)this,"%u",*param_1);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    case 'l':
      puVar5 = param_4;
      goto LAB_1001aa8c;
    case 'p':
      iVar2 = _sprintf((char *)this,"%d",*(undefined4 *)(unaff_EBX + 0xc));
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    case 's':
      _sprintf(local_110,"%08x",param_3);
      FUN_1003dc50(local_100,0x100,(char *)(param_1 + 8),*(undefined4 *)(param_2 + 0x14),local_110,
                   (char *)(unaff_EBX + 0x24));
      iVar2 = _sprintf((char *)this,"%s",local_100);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    case 'u':
      puVar5 = param_1 + 0xb9;
LAB_1001aa8c:
      iVar2 = _sprintf((char *)this,"%s",puVar5);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
    }
LAB_1001aac2:
    cVar1 = *pcVar3;
    pcVar4 = pcVar3;
    if (cVar1 == '\0') {
      return;
    }
  } while( true );
}



undefined4 __cdecl FUN_1001ab10(int param_1,undefined4 param_2)

{
  *(undefined4 *)(*(int *)(param_1 + 0x94) + 0xab0) = 0;
  *(undefined4 *)(param_1 + 0x28) = param_2;
  *(undefined4 *)(param_1 + 0x30) = 1;
  return 0;
}



undefined4 __cdecl FUN_1001ab40(int param_1)

{
  int *piVar1;
  
  *(undefined4 *)(param_1 + 0x28) = 0;
  *(undefined4 *)(param_1 + 0x58) = 0;
  *(undefined4 *)(param_1 + 0x50) = *(undefined4 *)(param_1 + 0x6c);
  piVar1 = *(int **)(*(int *)(param_1 + 0x94) + 0xab0);
  if (piVar1 == (int *)0x0) {
    *(undefined4 *)(param_1 + 0x54) = 0x74696d65;
    return 0xffffffff;
  }
  if (*piVar1 != -*(int *)(*(int *)(param_1 + 0x94) + 0xaac)) {
    *(undefined4 *)(param_1 + 0x54) = 0x6f766572;
    return 0xffffffff;
  }
  *(int *)(param_1 + 0x54) = piVar1[1];
  return 0;
}



undefined4 __cdecl FUN_1001aba0(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    return 0;
  }
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"UPDATES");
  if (pbVar2 != (byte *)0x0) {
    iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
    if (iVar1 != 0) {
      iVar1 = 0;
      pbVar3 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"IDENT");
      iVar1 = FUN_10002480((char *)pbVar3,iVar1);
      iVar4 = FUN_10026280(*(int *)(param_1 + 0x4118),iVar1);
      if (*(int *)(param_2 + 0x6c) == 0x75637265) {
        if (iVar4 == 0) {
          *(code **)(param_2 + 0x28) = FUN_1001aba0;
          *(undefined4 *)(param_2 + 0x50) = 0;
          return 0;
        }
      }
      else if (iVar4 == 0) goto LAB_1001acb5;
      iVar5 = FUN_10002480((char *)pbVar2,0);
      if ((-1 < iVar5) && (iVar5 < 4)) {
        *(int *)(param_3 + 0x54 + iVar5 * 4) = iVar1;
        *(undefined4 *)(param_3 + 100 + iVar5 * 4) = 1;
        uVar6 = FUN_100262d0(*(int *)(iVar4 + 0xe8));
        *(undefined4 *)(param_3 + 0x74 + iVar5 * 4) = uVar6;
      }
    }
  }
LAB_1001acb5:
  FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
               *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_1001ad90(int param_1,int param_2,int param_3)

{
  bool bVar1;
  int iVar2;
  byte *pbVar3;
  int *piVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  
  iVar2 = FUN_1001ab40(param_2);
  if (-1 < iVar2) {
    if (*(int *)(param_2 + 0x54) != 0) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      return 0;
    }
    iVar2 = 0;
    pbVar3 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"IDENT");
    iVar2 = FUN_10002480((char *)pbVar3,iVar2);
    piVar4 = (int *)FUN_10026280(*(int *)(param_1 + 0x4118),iVar2);
    if (piVar4 != (int *)0x0) {
      if (*(int *)(param_2 + 0x6c) == 0x7564656c) {
LAB_1001ae62:
        *(undefined4 *)(param_2 + 0x50) = 0;
        *(code **)(param_2 + 0x28) = FUN_1001ad90;
        return 0;
      }
      if (*(int *)(param_2 + 0x6c) == 0x756c6561) {
        iVar5 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
        if (iVar5 != 0) {
          bVar1 = false;
          iVar7 = 0;
          piVar6 = (int *)(iVar5 + 0x31c);
          do {
            if (bVar1) goto LAB_1001ae62;
            if (*piVar6 == *piVar4) {
              bVar1 = true;
            }
            iVar7 = iVar7 + 1;
            piVar6 = piVar6 + 1;
          } while (iVar7 < 4);
          if (bVar1) goto LAB_1001ae62;
        }
      }
    }
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"UPDATES");
    if (pbVar3 != (byte *)0x0) {
      if (*(int *)(param_3 + 0x54) == iVar2) {
        *(undefined4 *)(param_3 + 0x54) = 0;
        *(undefined4 *)(param_3 + 100) = 0;
        *(undefined4 *)(param_3 + 0x74) = 0;
      }
      if (*(int *)(param_3 + 0x58) == iVar2) {
        *(undefined4 *)(param_3 + 0x58) = 0;
        *(undefined4 *)(param_3 + 0x68) = 0;
        *(undefined4 *)(param_3 + 0x78) = 0;
      }
      if (*(int *)(param_3 + 0x5c) == iVar2) {
        *(undefined4 *)(param_3 + 0x5c) = 0;
        *(undefined4 *)(param_3 + 0x6c) = 0;
        *(undefined4 *)(param_3 + 0x7c) = 0;
      }
      if (*(int *)(param_3 + 0x60) == iVar2) {
        *(undefined4 *)(param_3 + 0x60) = 0;
        *(undefined4 *)(param_3 + 0x70) = 0;
        *(undefined4 *)(param_3 + 0x80) = 0;
      }
    }
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  }
  return 0;
}



undefined4 __cdecl FUN_1001aee0(int param_1,int param_2,int param_3)

{
  int iVar1;
  
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
               (byte *)"CALLUSER=%d CALLPING=%d CALLADDR=%a %r");
  *(int *)(param_1 + 0x2cc598) = *(int *)(param_1 + 0x2cc598) + 1;
  iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar1;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4024),*(uint *)(param_2 + 0x6c) ^ 0x20202020,-iVar1,
               *(char **)(param_2 + 0x60),(char *)0xffffffff);
  *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
  *(code **)(param_2 + 0x28) = FUN_1001ad90;
  *(undefined4 *)(param_2 + 0x30) = 1;
  return 0;
}



undefined4 __cdecl FUN_1001af80(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  uint *puVar5;
  int iVar6;
  uint uVar7;
  uint local_480 [3];
  byte local_474 [20];
  byte local_460 [176];
  byte local_3b0 [332];
  byte local_264 [168];
  int local_1bc;
  int local_178;
  int local_174;
  int local_16c;
  int local_168;
  uint local_58;
  int local_50;
  byte local_4c [20];
  byte local_38 [52];
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    **(undefined1 **)(param_2 + 0x60) = 0;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"OFFLINE");
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"OFFLINE",pbVar2);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
    return 0xffffffff;
  }
  pbVar2 = &DAT_1004d26f;
  iVar6 = 0x14;
  puVar5 = local_480;
  for (iVar1 = 0x11d; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  pbVar4 = local_474;
  pbVar3 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004d8c8);
  FUN_10002a30(pbVar3,pbVar4,iVar6,pbVar2);
  pbVar3 = &DAT_1004d26f;
  iVar1 = 0x10;
  pbVar2 = local_460;
  pbVar4 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004d8d8);
  FUN_10002a30(pbVar4,pbVar2,iVar1,pbVar3);
  uVar7 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"FLAGS");
  local_480[2] = FUN_100025a0((char *)pbVar2,uVar7);
  pbVar3 = &DAT_1004d26f;
  iVar1 = 0xc4;
  pbVar2 = local_3b0;
  pbVar4 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004e754);
  FUN_10002a30(pbVar4,pbVar2,iVar1,pbVar3);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004e744);
  local_1bc = FUN_10002480((char *)pbVar2,iVar1);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"_LEVEL");
  local_16c = FUN_10002480((char *)pbVar2,iVar1);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"MEDALS");
  local_168 = FUN_10002480((char *)pbVar2,iVar1);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004e70c);
  local_50 = FUN_10002480((char *)pbVar2,iVar1);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"_HWFLAG");
  local_178 = FUN_10002480((char *)pbVar2,iVar1);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"_HWMASK");
  local_174 = FUN_10002480((char *)pbVar2,iVar1);
  pbVar3 = &DAT_1004d26f;
  iVar1 = 0x40;
  pbVar2 = local_264;
  pbVar4 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"MADDR");
  FUN_10002a30(pbVar4,pbVar2,iVar1,pbVar3);
  if (local_264[0] == 0) {
    pbVar3 = &DAT_1004d26f;
    iVar1 = 0x40;
    pbVar2 = local_264;
    pbVar4 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004dcac);
    FUN_10002a30(pbVar4,pbVar2,iVar1,pbVar3);
  }
  uVar7 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004dca4);
  local_58 = FUN_10002930(pbVar2,uVar7);
  pbVar3 = &DAT_1004d26f;
  iVar1 = 0x14;
  pbVar2 = local_4c;
  pbVar4 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"_CLUBID");
  FUN_10002a30(pbVar4,pbVar2,iVar1,pbVar3);
  pbVar3 = &DAT_1004d26f;
  iVar1 = 8;
  pbVar2 = local_38;
  pbVar4 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"_CLUBTAG");
  FUN_10002a30(pbVar4,pbVar2,iVar1,pbVar3);
  FUN_1000ada0(param_2);
  FUN_1000aad0(param_1,param_2,(int)local_480,0);
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_1001b2d0(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  int local_14;
  byte local_10 [16];
  
  pbVar4 = &DAT_1004d26f;
  iVar3 = 0x10;
  pbVar2 = local_10;
  local_14 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar2,iVar3,pbVar4);
  if (local_10[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    return 0;
  }
  iVar3 = FUN_10022a40(*(void **)(param_1 + 0x40f8),(int)*(void **)(param_1 + 0x40f8),local_10);
  if (iVar3 == 0) {
    iVar3 = 0;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"OFFLINE");
    iVar3 = FUN_10002480((char *)pbVar2,iVar3);
    if (iVar3 != 0) {
      FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"PERS=%s");
      iVar3 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
      *(int *)(param_3 + 0xaac) = iVar3;
      FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar3,*(char **)(param_2 + 0x60),
                   (char *)0xffffffff);
      *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
      *(code **)(param_2 + 0x28) = FUN_1001af80;
      *(undefined4 *)(param_2 + 0x30) = 1;
      return 0;
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x75757372;
    return 0;
  }
  if (*(int *)(iVar3 + 0x30) != 0) {
    local_14 = FUN_10026280(*(int *)(param_1 + 0x40ec),*(int *)(iVar3 + 0x30));
  }
  FUN_1000ada0(param_2);
  FUN_1000aad0(param_1,param_2,iVar3,local_14);
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_1001b470(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte local_50 [16];
  byte local_40 [64];
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6e666e64;
    return 0;
  }
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x10;
  pbVar3 = local_50;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004d8d8);
  FUN_10002a30(pbVar2,pbVar3,iVar1,pbVar4);
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x40;
  pbVar3 = local_40;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"MADDR");
  FUN_10002a30(pbVar2,pbVar3,iVar1,pbVar4);
  if (local_40[0] == 0) {
    pbVar4 = &DAT_1004d26f;
    iVar1 = 0x40;
    pbVar3 = local_40;
    pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004dcac);
    FUN_10002a30(pbVar2,pbVar3,iVar1,pbVar4);
    if (local_40[0] == 0) {
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x6e666e64;
      return 0;
    }
  }
  FUN_10027f90(*(void **)(param_1 + 0x2cd5ac),local_50,(char *)local_40);
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"PERS=%s MADDR=%s");
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_1001b7b0(undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte local_10 [16];
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    return 0;
  }
  if (*(int *)(param_2 + 0x6c) == 0x72616e6b) {
    iVar1 = 0;
    pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004f224);
    iVar1 = FUN_10002480((char *)pbVar2,iVar1);
    *(int *)(param_3 + 0xa18) = *(int *)(param_3 + 0xa18) + iVar1;
    *(undefined4 *)(param_3 + 0x14) = 0;
  }
  if ((*(int *)(param_2 + 0x6c) == 0x7175696b) && (*(byte *)(param_3 + 0xa11) < 0xfa)) {
    pbVar4 = &DAT_1004d26f;
    iVar1 = 0x10;
    pbVar2 = local_10;
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e68c);
    FUN_10002a30(pbVar3,pbVar2,iVar1,pbVar4);
    if (local_10[0] != 0x2a) {
      *(char *)(param_3 + 0xa11) = *(char *)(param_3 + 0xa11) + '\x01';
    }
  }
  FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
               *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_1001b930(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  void *pvVar5;
  int iVar6;
  undefined4 *puVar7;
  uint uVar8;
  byte *pbVar9;
  byte *pbVar10;
  byte local_3ec [20];
  byte local_3d8 [32];
  byte local_3b8 [32];
  byte local_398 [32];
  byte local_378 [32];
  byte local_358 [32];
  uint local_338;
  int local_b4;
  int local_b0;
  byte local_ac [64];
  int local_6c;
  byte local_68 [32];
  byte local_48 [68];
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    FUN_10016490(0x1000);
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004d8a8);
  iVar1 = FUN_10002480((char *)pbVar2,iVar1);
  if (iVar1 < 1) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x746f7361;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c0);
  if (pbVar2 != (byte *)0x0) {
    iVar1 = 0;
    pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"SHARE");
    iVar1 = FUN_10002480((char *)pbVar2,iVar1);
    if (iVar1 < 1) {
      FUN_10016490(0x1000);
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x73686172;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
  }
  uVar8 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"FLAGS");
  uVar8 = FUN_100025a0((char *)pbVar2,uVar8);
  if ((uVar8 & 0x1000) != 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6c6f636b;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar9 = &DAT_1004d26f;
  iVar1 = 0x12;
  pbVar2 = local_3ec;
  pbVar3 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004d8c8);
  FUN_10002a30(pbVar3,pbVar2,iVar1,pbVar9);
  uVar8 = FUN_10025120(*(int **)(param_1 + 0x2cc380),local_3ec);
  if (0 < (int)uVar8) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x66696c74;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"GFIDS");
  if (pbVar2 != (byte *)0x0) {
    uVar8 = FUN_10002480((char *)pbVar2,0);
    if ((*(uint *)(param_1 + 0x2cd0f8) != 0) && ((uVar8 & *(uint *)(param_1 + 0x2cd0f8)) == 0)) {
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x54) = 0x64617368;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
  }
  iVar1 = *(int *)(param_3 + 0xab0);
  pbVar9 = &DAT_1004d26f;
  pbVar3 = local_3d8;
  for (iVar6 = 0xf4; iVar6 != 0; iVar6 = iVar6 + -1) {
    pbVar3[0] = 0;
    pbVar3[1] = 0;
    pbVar3[2] = 0;
    pbVar3[3] = 0;
    pbVar3 = pbVar3 + 4;
  }
  iVar6 = 0x20;
  pbVar3 = local_3d8;
  pbVar4 = FUN_100020f0(*(byte **)(iVar1 + 0xc),&DAT_1004d8c8);
  FUN_10002a30(pbVar4,pbVar3,iVar6,pbVar9);
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar3 = local_3b8;
  pbVar9 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004e700);
  FUN_10002a30(pbVar9,pbVar3,iVar1,pbVar4);
  pbVar10 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar3 = (byte *)(param_3 + 0xa8c);
  pbVar9 = pbVar3;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcac);
  FUN_10002a30(pbVar4,pbVar9,iVar1,pbVar10);
  iVar1 = 0x20;
  pbVar9 = pbVar3;
  pbVar4 = pbVar3;
  pbVar10 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6d4);
  FUN_10002a30(pbVar10,pbVar9,iVar1,pbVar4);
  iVar1 = 0x50;
  pbVar9 = (byte *)(param_3 + 0xa3c);
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcac);
  FUN_10002a30(pbVar4,pbVar9,iVar1,pbVar3);
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar3 = local_398;
  pbVar9 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcb8);
  FUN_10002a30(pbVar9,pbVar3,iVar1,pbVar4);
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar3 = local_378;
  pbVar9 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcb0);
  FUN_10002a30(pbVar9,pbVar3,iVar1,pbVar4);
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar3 = local_358;
  pbVar9 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dca8);
  FUN_10002a30(pbVar9,pbVar3,iVar1,pbVar4);
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x40;
  pbVar3 = local_48;
  pbVar9 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6f0);
  FUN_10002a30(pbVar9,pbVar3,iVar1,pbVar4);
  uVar8 = 0x656e5553;
  pbVar3 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),&DAT_1004dca4);
  local_338 = FUN_10002930(pbVar3,uVar8);
  local_6c = FUN_10002480((char *)pbVar2,0);
  pbVar9 = &DAT_1004d26f;
  iVar1 = 0x40;
  pbVar2 = local_ac;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8ac);
  FUN_10002a30(pbVar3,pbVar2,iVar1,pbVar9);
  pbVar2 = local_ac;
  iVar1 = 0x40;
  pbVar3 = pbVar2;
  pbVar9 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"MADDR");
  FUN_10002a30(pbVar9,pbVar2,iVar1,pbVar3);
  pbVar9 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar2 = local_68;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10050da4);
  FUN_10002a30(pbVar3,pbVar2,iVar1,pbVar9);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"HWFLAG");
  local_b4 = FUN_10002480((char *)pbVar2,iVar1);
  iVar1 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"HWMASK");
  local_b0 = FUN_10002480((char *)pbVar2,iVar1);
  if (local_398[0] == 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    return 0;
  }
  if (local_378[0] == 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (local_358[0] == 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (*(int *)(param_3 + 0xa38) == 0) {
    pvVar5 = _malloc(0x3d0);
    *(void **)(param_3 + 0xa38) = pvVar5;
  }
  pbVar2 = local_3d8;
  puVar7 = *(undefined4 **)(param_3 + 0xa38);
  for (iVar1 = 0xf4; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar7 = *(undefined4 *)pbVar2;
    pbVar2 = pbVar2 + 4;
    puVar7 = puVar7 + 1;
  }
  FUN_10016490(0x1000);
  FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
               *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
  FUN_100025e0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004db60,
               *(uint *)(param_2 + 0x14));
  if (*(char *)(param_1 + 0x2cc698) != '\0') {
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050cb8,
                 (byte *)(param_1 + 0x2cc698));
    pbVar9 = &DAT_1004d26f;
    iVar1 = 0x80;
    pbVar3 = (byte *)(*(int *)(param_3 + 0xa38) + 0xa4);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x60),&DAT_10050cb8);
    FUN_10002a30(pbVar2,pbVar3,iVar1,pbVar9);
    FUN_100020b0((char *)(*(int *)(param_3 + 0xa38) + 0x124),0x200,(char *)(param_1 + 0x2cc718));
  }
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  return 0xffffffff;
}



undefined4 __cdecl FUN_1001cab0(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    FUN_10016490(0x1000);
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    return 0;
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
               (byte *)
               "SESS=%d PING=%d ADDR=%a LADDR=%a HWFLAG=%d HWMASK=%d VERS=%s SLUS=%s SKU=%s LOC=%t MADDR=%s GFIDS=%d PUID=%s %r"
              );
  uVar3 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6e8);
  uVar3 = FUN_100025a0((char *)pbVar2,uVar3);
  FUN_100024f0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e6e8,uVar3);
  FUN_100027d0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"SDKVERS",
               *(uint *)(param_3 + 0xd6c));
  if (*(char *)(*(int *)(param_3 + 0xa38) + 0xa4) != '\0') {
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050cb8,
                 (byte *)(*(int *)(param_3 + 0xa38) + 0xa4));
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050f38,
                 (byte *)(*(int *)(param_3 + 0xa38) + 0x124));
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10050f30);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050f30,pbVar2);
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050da4,
                 (byte *)(*(int *)(param_3 + 0xa38) + 0x370));
  }
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c0);
  FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c0,pbVar2);
  iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar1;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4024),0x50455253,-iVar1,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  *(undefined4 *)(param_2 + 0x50) = 0;
  *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
  *(undefined1 **)(param_2 + 0x28) = &LAB_1001c840;
  *(undefined4 *)(param_2 + 0x30) = 1;
  return 0;
}



undefined4 __cdecl FUN_1001cce0(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  byte local_60 [16];
  byte local_50 [16];
  byte local_40 [64];
  
  iVar4 = 0x2a706174;
  if (*(int *)(param_3 + 0xa34) != 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x70736574;
    return 0;
  }
  if (*(int *)(param_3 + 0xa38) == 0) {
    FUN_10016490(0x1000);
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x10;
  pbVar3 = local_50;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar3,iVar5,pbVar6);
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x10;
  pbVar3 = local_60;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c0);
  FUN_10002a30(pbVar1,pbVar3,iVar5,pbVar6);
  pbVar3 = (byte *)(param_3 + 0xa3c);
  iVar5 = 0x50;
  pbVar1 = pbVar3;
  pbVar6 = pbVar3;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcac);
  FUN_10002a30(pbVar2,pbVar1,iVar5,pbVar6);
  pbVar1 = (byte *)(param_3 + 0xa8c);
  iVar5 = 0x20;
  pbVar6 = pbVar1;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6d4);
  FUN_10002a30(pbVar2,pbVar1,iVar5,pbVar6);
  if ((local_60[0] != 0) && (*(char *)(*(int *)(param_3 + 0xa38) + 0x32c) != '$')) {
    iVar4 = FUN_1001a880((char *)local_60);
    if ((char)iVar4 == '\0') {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    iVar4 = 0;
    do {
      pbVar1 = local_60 + iVar4;
      local_50[iVar4] = *pbVar1;
      iVar4 = iVar4 + 1;
    } while (*pbVar1 != 0);
    iVar4 = 0x2a676574;
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c8,
               *(byte **)(param_3 + 0xa38));
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8d8,local_50);
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c0,local_60);
  pbVar2 = (byte *)(*(int *)(param_3 + 0xa38) + 0x32c);
  iVar5 = 0x40;
  pbVar1 = local_40;
  pbVar6 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8ac);
  FUN_10002a30(pbVar6,pbVar1,iVar5,pbVar2);
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8ac,local_40);
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"PURCHBAN");
  FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"PURCHBAN",pbVar1);
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004dcac,pbVar3);
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e6d4,
               (byte *)(param_3 + 0xa8c));
  FUN_100025e0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004db60,
               *(uint *)(param_2 + 0x14));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d240,
               *(uint *)(param_2 + 0x18));
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10050fe0);
  FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050fe0,pbVar3);
  iVar5 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar5;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),iVar4,-iVar5,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
  *(code **)(param_2 + 0x28) = FUN_1001cab0;
  *(undefined4 *)(param_2 + 0x30) = 1;
  return 0;
}



undefined4 __cdecl FUN_1001d000(undefined4 param_1,int param_2,int param_3)

{
  int iVar1;
  
  iVar1 = FUN_1001ab40(param_2);
  if (-1 < iVar1) {
    *(undefined4 *)(param_2 + 0x50) = 0x63757372;
    FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
                 *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
    if (**(char **)(param_2 + 0x60) != '\0') {
      *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
    }
  }
  return 0;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

undefined4 __cdecl FUN_1001d060(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte local_1000 [4092];
  undefined4 uStack_4;
  
  uStack_4 = 0x1001d06a;
  iVar1 = FUN_1001ab40(param_2);
  if (-1 < iVar1) {
    if (*(int *)(param_2 + 0x54) != 0) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      return 0;
    }
    FUN_10005d70((char *)local_1000,*(char **)(*(int *)(param_3 + 0xab0) + 0xc),0x1000);
    FUN_10003cf0(local_1000,0x1000,(byte *)"CUSRINP",*(byte **)(param_2 + 0x7c));
    FUN_10002370(local_1000,0x1000,(byte *)"CALLUSER",*(uint *)(param_3 + 0xa34));
    iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
    *(int *)(param_3 + 0xaac) = iVar1;
    FUN_10022490(*(undefined4 **)(param_1 + 0x4024),0x43555352,-iVar1,(char *)local_1000,
                 (char *)0xffffffff);
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
    *(code **)(param_2 + 0x28) = FUN_1001d000;
    *(undefined4 *)(param_2 + 0x30) = 1;
  }
  return 0;
}



undefined4 __cdecl FUN_1001d160(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte local_20 [32];
  
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if (iVar1 == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8d8,
               (byte *)(iVar1 + 0x20));
  FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e700,
               (byte *)(iVar1 + 0x2e4));
  pbVar4 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar3 = local_20;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dff4);
  FUN_10002a30(pbVar2,pbVar3,iVar1,pbVar4);
  if (local_20[0] != 0) {
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004dff4,local_20);
  }
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1005100c,1);
  iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar1;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar1,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
  *(code **)(param_2 + 0x28) = FUN_1001d060;
  *(undefined4 *)(param_2 + 0x30) = 1;
  return 0;
}



undefined4 __cdecl FUN_1001d2a0(undefined4 param_1,int param_2,int param_3)

{
  char cVar1;
  int iVar2;
  
  iVar2 = FUN_1001ab40(param_2);
  if (-1 < iVar2) {
    FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
                 *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
    cVar1 = **(char **)(param_2 + 0x60);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (cVar1 == '\0') {
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  }
  return 0;
}



undefined4 __cdecl FUN_1001d300(int param_1,int param_2,int param_3)

{
  int iVar1;
  
  iVar1 = FUN_1001ab40(param_2);
  if (-1 < iVar1) {
    if (*(int *)(param_2 + 0x54) != 0) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x69706572;
      return 0;
    }
    FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                 (byte *)"CALLUSER=%d CALLPING=%d CALLADDR=%a REQ=%s %r");
    iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
    *(int *)(param_3 + 0xaac) = iVar1;
    FUN_10022490(*(undefined4 **)(param_1 + 0x4024),*(uint *)(param_2 + 0x6c) ^ 0x20202020,-iVar1,
                 *(char **)(param_2 + 0x60),(char *)0xffffffff);
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
    *(code **)(param_2 + 0x28) = FUN_1001d2a0;
    *(undefined4 *)(param_2 + 0x30) = 1;
  }
  return 0;
}



undefined4 __cdecl FUN_1001d3d0(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_30 [16];
  byte local_20 [32];
  
  if (*(int *)(param_1 + 0x3804 + *(int *)(param_3 + 0xabc) * 8) == 0) {
    FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                 (byte *)"CALLUSER=%d CALLPING=%d CALLADDR=%a %r");
    iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
    *(int *)(param_3 + 0xaac) = iVar1;
    FUN_10022490(*(undefined4 **)(param_1 + 0x4024),*(uint *)(param_2 + 0x6c) ^ 0x20202020,-iVar1,
                 *(char **)(param_2 + 0x60),(char *)0xffffffff);
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
    *(code **)(param_2 + 0x28) = FUN_1001d2a0;
    *(undefined4 *)(param_2 + 0x30) = 1;
    return 0;
  }
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if (iVar1 == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  iVar4 = *(int *)(param_1 + 0x3804 + *(int *)(param_3 + 0xabc) * 8);
  if (iVar4 == 1) {
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
    if (pbVar2 != (byte *)0x0) {
      FUN_10002a30(pbVar2,local_30,0x10,&DAT_1004d26f);
      FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8d8,local_30);
      goto LAB_1001d4c7;
    }
    iVar4 = *(int *)(param_2 + 0x5c);
    pbVar2 = *(byte **)(param_2 + 0x60);
    pbVar3 = (byte *)(iVar1 + 0x20);
    pbVar5 = &DAT_1004d8d8;
  }
  else {
    if (iVar4 != 2) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x696e7670;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    iVar4 = *(int *)(param_2 + 0x5c);
    pbVar2 = *(byte **)(param_2 + 0x60);
    pbVar3 = (byte *)(iVar1 + 0xc);
    pbVar5 = &DAT_1004d8c8;
  }
  FUN_10003cf0(pbVar2,iVar4,pbVar5,pbVar3);
LAB_1001d4c7:
  pbVar5 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar2 = local_20;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dff4);
  FUN_10002a30(pbVar3,pbVar2,iVar1,pbVar5);
  if (local_20[0] != 0) {
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004dff4,local_20);
  }
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1005100c,1);
  iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar1;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar1,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
  *(code **)(param_2 + 0x28) = FUN_1001d300;
  *(undefined4 *)(param_2 + 0x30) = 1;
  return 0;
}



undefined4 __cdecl FUN_1001d8a0(int param_1,int param_2,int param_3)

{
  char cVar1;
  undefined *puVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  int iVar6;
  byte *pbVar7;
  byte local_30 [16];
  byte local_20 [32];
  
  puVar2 = FUN_10023500();
  if (puVar2 == (undefined *)0x0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x62616463;
    return 0;
  }
  if (*(int *)(puVar2 + *(int *)(param_3 + 0xabc) * 0xc + 4) == 0) {
    *(undefined4 *)(param_2 + 0x54) = 0;
    **(undefined1 **)(param_2 + 0x60) = 0;
    (**(code **)(puVar2 + *(int *)(param_3 + 0xabc) * 0xc + 8))
              (*(undefined4 *)(param_1 + 0x2ccc9c),*(undefined4 *)(param_2 + 0x7c),
               *(undefined4 *)(param_2 + 0x60),*(undefined4 *)(param_2 + 0x5c),param_2 + 0x54,0,0);
    cVar1 = **(char **)(param_2 + 0x60);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (cVar1 == '\0') {
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      return 0;
    }
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
    return 0;
  }
  iVar3 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if (iVar3 == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  if (*(int *)(puVar2 + *(int *)(param_3 + 0xabc) * 0xc + 4) == 1) {
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
    if (pbVar4 != (byte *)0x0) {
      FUN_10002a30(pbVar4,local_30,0x10,&DAT_1004d26f);
      FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8d8,local_30);
      goto LAB_1001d9bf;
    }
    iVar6 = *(int *)(param_2 + 0x5c);
    pbVar4 = *(byte **)(param_2 + 0x60);
    pbVar5 = (byte *)(iVar3 + 0x20);
    pbVar7 = &DAT_1004d8d8;
  }
  else {
    if (*(int *)(puVar2 + *(int *)(param_3 + 0xabc) * 0xc + 4) != 2) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x696e7670;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    iVar6 = *(int *)(param_2 + 0x5c);
    pbVar4 = *(byte **)(param_2 + 0x60);
    pbVar5 = (byte *)(iVar3 + 0xc);
    pbVar7 = &DAT_1004d8c8;
  }
  FUN_10003cf0(pbVar4,iVar6,pbVar7,pbVar5);
LAB_1001d9bf:
  pbVar7 = &DAT_1004d26f;
  iVar3 = 0x20;
  pbVar4 = local_20;
  pbVar5 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dff4);
  FUN_10002a30(pbVar5,pbVar4,iVar3,pbVar7);
  if (local_20[0] != 0) {
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004dff4,local_20);
  }
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1005100c,1);
  iVar3 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar3;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar3,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  *(undefined4 *)(*(int *)(param_2 + 0x94) + 0xab0) = 0;
  *(undefined1 **)(param_2 + 0x28) = &LAB_1001d620;
  *(undefined4 *)(param_2 + 0x30) = 1;
  return 0;
}



undefined4 __cdecl FUN_1001dd40(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = *(int *)(param_2 + 0x70);
  *(undefined1 *)(param_3 + 0xa1e) = 0;
  if (iVar3 < 1) {
    iVar3 = 1;
  }
  else if (1000 < iVar3) {
    iVar3 = 1000;
  }
  iVar4 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004f224);
  iVar4 = FUN_10002480((char *)pbVar1,iVar4);
  if ((0 < iVar4) && (iVar4 < iVar3)) {
    iVar3 = iVar4;
  }
  if ((0 < *(short *)(param_3 + 0xa1c)) &&
     (iVar4 = *(short *)(param_3 + 0xa1c) + 0x19, iVar4 < iVar3)) {
    iVar3 = iVar4;
  }
  *(short *)(param_3 + 0xa1c) = (short)iVar3;
  if ((short)iVar3 < 100) {
    *(undefined1 *)(param_3 + 0xa1f) = 0;
  }
  if (*(char *)(param_3 + 0xa1f) < '\x01') {
    *(int *)(param_3 + 0xa20) = *(int *)(param_1 + 0x2cc550) * 1000 + *(int *)(param_1 + 0x403c);
  }
  else {
    *(char *)(param_3 + 0xa1f) = *(char *)(param_3 + 0xa1f) + -1;
    *(int *)(param_3 + 0xa20) = *(int *)(param_1 + 0x403c) + 2000;
  }
  puVar2 = (uint *)FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if ((puVar2 != (uint *)0x0) && (puVar2[0xb0] != (int)*(short *)(param_3 + 0xa1c))) {
    if (puVar2[0xb0] == 0) {
      **(undefined1 **)(param_2 + 0x60) = 0;
      FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"IDENT",*puVar2);
      FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e71c,
                   (int)*(short *)(param_3 + 0xa1c));
      FUN_10022490(*(undefined4 **)(param_1 + 0x4024),0x50494e47,0,*(char **)(param_2 + 0x60),
                   (char *)0xffffffff);
      *(int *)(param_1 + 0x2cc590) = *(int *)(param_1 + 0x2cc590) + 1;
    }
    puVar2[0xb0] = (int)*(short *)(param_3 + 0xa1c);
  }
  if ((*(int *)(param_1 + 0x2cc558) != 0) && (*(int *)(param_3 + 0xab4) == 0)) {
    *(int *)(param_3 + 0xab4) = *(int *)(param_1 + 0x403c) + *(int *)(param_1 + 0x2cc558);
  }
  if ((*(int *)(param_1 + 0x2cc55c) != 0) && (*(int *)(param_3 + 0xab8) == 0)) {
    *(int *)(param_3 + 0xab8) = *(int *)(param_1 + 0x403c) + *(int *)(param_1 + 0x2cc55c);
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10003240(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e620,0);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0;
}



void __cdecl FUN_1001df20(void *param_1,int param_2,int param_3)

{
  byte *pbVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  byte local_44 [32];
  byte local_24 [36];
  
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"USERS");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  iVar6 = 0;
  if ((iVar7 < 1) || (*(int *)(param_3 + 0x18) != 0)) {
    if (iVar7 == 0) {
      *(undefined4 *)(param_3 + 0x1c) = 0;
      *(undefined4 *)(param_3 + 0x18) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x1c) = 1;
    *(undefined4 *)(param_3 + 0x18) = 1;
  }
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"USERSETS");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  if ((iVar7 < 1) || (*(int *)(param_3 + 0x84) != 0)) {
    if (iVar7 == 0) {
      *(undefined4 *)(param_3 + 0x88) = 0;
      *(undefined4 *)(param_3 + 0x84) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x88) = 1;
    *(undefined4 *)(param_3 + 0x84) = 1;
  }
  puVar4 = (undefined4 *)(param_3 + 100);
  do {
    _sprintf((char *)local_44,"USERSET%d",iVar6);
    pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),local_44);
    if (pbVar1 != (byte *)0x0) {
      FUN_10002a30(pbVar1,local_24,0x24,&DAT_1004d26f);
      if (local_24[0] == 0) {
        uVar3 = 0;
        puVar4[-4] = 0;
        *puVar4 = 0;
      }
      else {
        puVar2 = (undefined4 *)FUN_10022a40(param_1,*(int *)((int)param_1 + 0x4114),local_24);
        if (puVar2 == (undefined4 *)0x0) goto LAB_1001e044;
        puVar4[-4] = *puVar2;
        *puVar4 = 1;
        uVar3 = FUN_100262d0(puVar2[0x3a]);
      }
      puVar4[4] = uVar3;
    }
LAB_1001e044:
    iVar6 = iVar6 + 1;
    puVar4 = puVar4 + 1;
  } while (iVar6 < 4);
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"GAMES");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  iVar6 = 0;
  if ((iVar7 < 1) || (*(int *)(param_3 + 0x30) != 0)) {
    if (iVar7 == 0) {
      *(undefined4 *)(param_3 + 0x34) = 0;
      *(undefined4 *)(param_3 + 0x30) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x34) = 1;
    *(undefined4 *)(param_3 + 0x30) = 1;
  }
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"MYGAME");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  if ((iVar7 < 1) || (*(int *)(param_3 + 0x48) != 0)) {
    if (iVar7 == 0) {
      *(undefined4 *)(param_3 + 0x48) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x48) = 1;
  }
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"INGAME");
  if (pbVar1 != (byte *)0x0) {
    iVar7 = FUN_10002480((char *)pbVar1,0);
    *(bool *)(param_3 + 0x50) = iVar7 != 0;
  }
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"ROOMS");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  if (iVar7 == 2) {
    *(undefined4 *)(param_3 + 0x20) = 0;
LAB_1001e116:
    if (*(int *)(param_3 + 0x20) == 0) {
      *(undefined4 *)(param_3 + 0x20) = 1;
      uVar3 = FUN_100262d0(*(int *)((int)param_1 + 0x40ec));
      *(undefined4 *)(param_3 + 0x24) = uVar3;
      uVar3 = FUN_100262d0(*(int *)((int)param_1 + 0x40f0));
      *(undefined4 *)(param_3 + 0x28) = uVar3;
      goto LAB_1001e156;
    }
  }
  else if (0 < iVar7) goto LAB_1001e116;
  if (iVar7 == 0) {
    *(undefined4 *)(param_3 + 0x28) = 0;
    *(undefined4 *)(param_3 + 0x24) = 0;
    *(undefined4 *)(param_3 + 0x20) = 0;
  }
LAB_1001e156:
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"MESGS");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  if ((iVar7 < 1) || (*(int *)(param_3 + 0x38) != 0)) {
    if (iVar7 == 0) {
      *(undefined4 *)(param_3 + 0x38) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x38) = *(undefined4 *)((int)param_1 + 0x4368);
    *(undefined4 *)(param_3 + 0x3c) = 0x6010084;
  }
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"MESGTYPES");
  if (pbVar1 != (byte *)0x0) {
    uVar8 = 0;
    pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"MESGTYPES");
    uVar8 = FUN_100025a0((char *)pbVar1,uVar8);
    *(uint *)(param_3 + 0x3c) = uVar8;
  }
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"ASYNC");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  if ((iVar7 < 1) || (*(int *)(param_3 + 0x40) != 0)) {
    if (iVar7 == 0) {
      *(undefined4 *)(param_3 + 0x40) = 0;
    }
  }
  else if (*(int *)(param_3 + 0x44) == 0) {
    *(undefined4 *)(param_3 + 0x40) = *(undefined4 *)((int)param_1 + 0x240370);
  }
  else {
    *(int *)(param_3 + 0x40) = *(int *)(param_3 + 0x44);
    *(undefined4 *)(param_3 + 0x44) = 0;
  }
  iVar7 = -1;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"STATS");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  if ((iVar7 < 1) || (*(int *)(param_3 + 0xd20) != 0)) {
    if (iVar7 == 0) {
      *(undefined4 *)(param_3 + 0xd20) = 0;
      *(undefined4 *)(param_3 + 0xd24) = 0;
    }
  }
  else {
    *(int *)(param_3 + 0xd20) = *(int *)((int)param_1 + 0x2cccc0) + -1;
    *(int *)(param_3 + 0xd24) = iVar7;
    *(undefined4 *)(param_3 + 0xd28) = *(undefined4 *)((int)param_1 + 0x403c);
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"GAMES",
               (uint)(0 < *(int *)(param_3 + 0x30)));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"MYGAME",
               (uint)(0 < *(int *)(param_3 + 0x48)));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"ROOMS",
               (uint)(0 < *(int *)(param_3 + 0x20)));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"USERS",
               (uint)(0 < *(int *)(param_3 + 0x18)));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"USERSETS",
               (uint)(0 < *(int *)(param_3 + 0x84)));
  piVar5 = (int *)(param_3 + 0x54);
  do {
    _sprintf((char *)local_44,"USERSET%d",iVar6);
    iVar7 = FUN_10026280(*(int *)((int)param_1 + 0x4118),*piVar5);
    if (iVar7 != 0) {
      FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),local_44,
                   (byte *)(iVar7 + 0x24));
    }
    iVar6 = iVar6 + 1;
    piVar5 = piVar5 + 1;
  } while (iVar6 < 4);
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"MESGS",
               (uint)(*(int *)(param_3 + 0x38) != 0));
  FUN_100024f0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"MESGTYPES",
               *(uint *)(param_3 + 0x3c));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"ASYNC",
               (uint)(*(int *)(param_3 + 0x40) != 0));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"STATS",
               *(uint *)(param_3 + 0xd24));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"SLOTS",
               *(uint *)((int)param_1 + 0x411c));
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"INGAME",
               (uint)*(byte *)(param_3 + 0x50));
  FUN_10003ac0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)((int)param_1 + 0x2ccc18)
              );
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return;
}



int __cdecl
FUN_1001e440(int param_1,uint param_2,size_t param_3,uint *param_4,int *param_5,int *param_6,
            size_t *param_7,int *param_8)

{
  char cVar1;
  uint uVar2;
  size_t sVar3;
  byte *pbVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  size_t sVar10;
  byte *pbVar11;
  char *pcVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int local_38;
  int local_34;
  byte *local_30;
  byte local_20;
  char local_1f;
  
  sVar3 = param_3;
  uVar2 = param_2;
  iVar13 = -1;
  local_34 = 0x32;
  local_30 = &DAT_1004d26f;
  local_38 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"INDEX");
  uVar5 = FUN_10002480((char *)pbVar4,iVar13);
  iVar13 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_100515e0);
  iVar6 = FUN_10002480((char *)pbVar4,iVar13);
  iVar13 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"START");
  iVar13 = FUN_10002480((char *)pbVar4,iVar13);
  iVar14 = -1;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"START2");
  iVar14 = FUN_10002480((char *)pbVar4,iVar14);
  iVar15 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_100515d0);
  iVar15 = FUN_10002480((char *)pbVar4,iVar15);
  iVar16 = -1;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e390);
  uVar7 = FUN_10002480((char *)pbVar4,iVar16);
  iVar16 = -1;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e388);
  uVar8 = FUN_10002480((char *)pbVar4,iVar16);
  iVar16 = -1;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e38c);
  uVar9 = FUN_10002480((char *)pbVar4,iVar16);
  *(undefined4 *)(param_3 + 0x9c) = 0;
  param_2 = uVar5;
  if ((int)uVar5 < 0) {
    if (((((int)uVar7 < 0) || (iVar16 = *(int *)(param_3 + 0xa04), iVar16 == 0)) ||
        (*(uint *)(iVar16 + 0x10) <= uVar7)) ||
       ((iVar16 = *(int *)(iVar16 + 0xc) + uVar7 * 0x14, *(uint *)(iVar16 + 0xc) <= uVar8 ||
        (iVar16 = *(int *)(iVar16 + 8) + uVar8 * 0x14, *(uint *)(iVar16 + 0xc) <= uVar9))))
    goto LAB_1001e9d0;
    local_38 = uVar9 * 0x1e028 + *(int *)(iVar16 + 8);
    param_2 = (uint)*(ushort *)(local_38 + 0xdcc);
    if (0 < *(short *)(local_38 + 0xdd0)) {
      local_34 = (int)*(short *)(local_38 + 0xdd0);
    }
    if ((*(byte *)(local_38 + 0xdd2) & 1) != 0) {
      local_30 = &DAT_10051504;
    }
    *(int *)(param_3 + 0x9c) = local_38;
  }
  if ((0x90 < (int)param_2) || (*(int *)(param_1 + 0x4120 + param_2 * 4) == 0)) {
LAB_1001e9d0:
    FUN_10016490(0x80);
    return 0x756c7374;
  }
  pbVar4 = FUN_100020f0(*(byte **)(uVar2 + 0x7c),(byte *)"RANGE");
  sVar10 = FUN_10002480((char *)pbVar4,local_34);
  if (((int)sVar10 < 0) || (500 < (int)sVar10)) {
    return 0x72616e67;
  }
  iVar16 = 0x20;
  pbVar4 = &local_20;
  *(undefined1 *)(param_3 + 0x99) = 0;
  *(undefined1 *)(param_3 + 0x98) = 0;
  pbVar11 = FUN_100020f0(*(byte **)(uVar2 + 0x7c),&DAT_100514fc);
  FUN_10002a30(pbVar11,pbVar4,iVar16,local_30);
  if (local_20 == 0x24) {
    if (local_1f == '\0') {
      iVar16 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
      if (iVar16 != 0) {
        FUN_10005d70((char *)&local_20,(char *)(iVar16 + 0x20),0x20);
      }
      goto LAB_1001e6f0;
    }
LAB_1001e6f4:
    iVar16 = FUN_10021940(*(int *)(param_1 + 0x4120 + param_2 * 4),&local_20);
    if (-1 < iVar16) {
      iVar13 = iVar16 - (int)sVar10 / 2;
      goto LAB_1001e79b;
    }
    if (local_38 != 0) {
      iVar13 = FUN_10021640(*(int *)(param_1 + 0x4120 + param_2 * 4));
      if (((iVar13 == 0) || ((int)sVar10 < 2)) || ((*(byte *)(local_38 + 0xdd2) & 1) == 0)) {
        *(undefined1 *)(param_3 + 0x99) = 1;
        FUN_10005d70((char *)(param_3 + 0xa0),(char *)&local_20,0x10);
        iVar13 = 0;
        sVar10 = 1;
        goto LAB_1001e79b;
      }
      if ((int)sVar10 <= iVar13) {
        iVar13 = iVar13 - sVar10;
      }
    }
  }
  else {
LAB_1001e6f0:
    if (local_20 != 0) goto LAB_1001e6f4;
  }
  if (iVar13 < 0) {
    return (-(uint)(local_20 != 0) & 0xf5fbf2fe) + 0x73747274;
  }
LAB_1001e79b:
  iVar16 = FUN_10021640(*(int *)(param_1 + 0x4120 + param_2 * 4));
  if (iVar16 <= (int)(iVar13 + sVar10)) {
    iVar13 = iVar16 - sVar10;
  }
  if (iVar13 < 0) {
    iVar13 = 0;
  }
  if ((0 < iVar14) && (iVar13 = iVar14, iVar16 <= iVar14)) {
    sVar10 = 0;
    iVar13 = 0;
  }
  if (((iVar16 <= (int)(iVar13 + sVar10)) && (sVar10 = iVar16 - iVar13, sVar10 == 0)) &&
     (*(char *)(param_3 + 0x99) != '\0')) {
    sVar10 = 1;
  }
  pbVar4 = FUN_100020f0(*(byte **)(uVar2 + 0x7c),(byte *)"BUDDIES");
  if ((pbVar4 != (byte *)0x0) && ((*(byte *)(local_38 + 0xdd2) & 2) != 0)) {
    local_30 = (byte *)(param_3 + 0x6e4);
    param_3 = 0;
    local_34 = 0;
    pbVar11 = (byte *)(sVar3 + 0xa0);
    do {
      iVar13 = FUN_10003680(pbVar4,pbVar11,0x10,&DAT_1004d26f,local_34,0x2c);
      if ((iVar13 < 1) || (*pbVar11 == 0)) break;
      if ((*pbVar11 == 0x24) && (pbVar11[1] == 0)) {
        iVar13 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(sVar3 + 0xa34));
        if (iVar13 != 0) {
          pcVar12 = (char *)(iVar13 + 0x20);
          iVar13 = (int)pbVar11 - (int)pcVar12;
          do {
            cVar1 = *pcVar12;
            pcVar12[iVar13] = cVar1;
            pcVar12 = pcVar12 + 1;
          } while (cVar1 != '\0');
          goto LAB_1001e8c0;
        }
      }
      else {
LAB_1001e8c0:
        if ((*(byte *)(local_38 + 0xdd2) & 2) != 0) {
          iVar13 = FUN_10021940(*(int *)(param_1 + 0x4120 + param_2 * 4),pbVar11);
          if (iVar13 < 0) {
            iVar13 = FUN_10021640(*(int *)(param_1 + 0x4120 + param_2 * 4));
            iVar13 = iVar13 + 1;
          }
          *(int *)local_30 = local_34;
          param_3 = param_3 + 1;
          *(int *)((int)local_30 + -4) = iVar13;
          local_30 = (byte *)((int)local_30 + 8);
        }
      }
      local_34 = local_34 + 1;
      pbVar11 = pbVar11 + 0x10;
    } while (local_34 != 100);
    iVar13 = 0;
    *(undefined1 *)(sVar3 + 0x98) = 1;
    _qsort((void *)(sVar3 + 0x6e0),param_3,8,(_PtFuncCompare *)&LAB_1001db20);
    sVar10 = param_3;
  }
  *(uint *)(sVar3 + 0x94) = param_2;
  *(int *)(sVar3 + 0x8c) = iVar13;
  *(size_t *)(sVar3 + 0x90) = iVar13 + sVar10;
  if (*(byte *)(sVar3 + 0xa0e) < 0xfa) {
    *(byte *)(sVar3 + 0xa0e) = *(byte *)(sVar3 + 0xa0e) + 1;
  }
  if (param_4 != (uint *)0x0) {
    *param_4 = param_2;
  }
  if (param_5 != (int *)0x0) {
    *param_5 = iVar6;
  }
  if (param_6 != (int *)0x0) {
    *param_6 = iVar13;
  }
  if (param_8 != (int *)0x0) {
    *param_8 = iVar15;
  }
  if (param_7 != (size_t *)0x0) {
    *param_7 = sVar10;
  }
  return 0;
}



undefined4 __cdecl FUN_1001ec50(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  undefined4 uVar4;
  void *this;
  int iVar5;
  byte *pbVar6;
  byte local_38 [20];
  byte local_24 [36];
  
  *(undefined4 *)(param_3 + 4) = 0;
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if (iVar1 == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  if ((*(byte *)(iVar1 + 8) & 0x10) == 0) {
    iVar1 = 0;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"IDENT");
    iVar1 = FUN_10002480((char *)pbVar2,iVar1);
    pbVar6 = &DAT_1004d26f;
    iVar5 = 0x24;
    pbVar2 = local_24;
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
    FUN_10002a30(pbVar3,pbVar2,iVar5,pbVar6);
    pbVar6 = &DAT_1004d26f;
    iVar5 = 0x14;
    pbVar2 = local_38;
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e5a0);
    FUN_10002a30(pbVar3,pbVar2,iVar5,pbVar6);
    if ((local_24[0] != 0) || (iVar1 != 0)) {
      if (iVar1 < 1) {
        iVar5 = FUN_10022a40(this,*(int *)(param_1 + 0x40e8),local_24);
      }
      else {
        iVar5 = FUN_10026280(*(int *)(param_1 + 0x40ec),iVar1);
      }
      if ((iVar5 == 0) && ((-1 < iVar1 || (local_24[0] == 0)))) {
        *(undefined4 *)(param_2 + 0x28) = 0;
        *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
        *(undefined4 *)(param_2 + 0x54) = 0x75726f6d;
        *(undefined4 *)(param_2 + 0x58) = 0;
        return 0;
      }
    }
    FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
                 (byte *)"CALLUSER=%d PING=%d NAME=%s IDENT=%d PASS=%s");
    iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
    *(int *)(param_3 + 0xaac) = iVar1;
    FUN_10022490(*(undefined4 **)(param_1 + 0x4024),0x4d4f5645,-iVar1,*(char **)(param_2 + 0x60),
                 (char *)0xffffffff);
    *(int *)(param_1 + 0x2cc5a0) = *(int *)(param_1 + 0x2cc5a0) + 1;
    uVar4 = FUN_1001ab10(param_2,&LAB_1001e9f0);
    return uVar4;
  }
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x54) = 0x64657465;
  return 0;
}



undefined4 __cdecl FUN_1001ee20(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  uint *puVar3;
  void *this;
  byte *pbVar4;
  byte *pbVar5;
  byte local_20 [32];
  
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if (iVar1 == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  if (*(int *)(iVar1 + 0x30) != 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x726f6f6d;
    return 0;
  }
  pbVar5 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar4 = local_20;
  *(undefined4 *)(param_3 + 4) = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar2,pbVar4,iVar1,pbVar5);
  if (local_20[0] == 0) {
    *(undefined4 *)(param_2 + 0x54) = 0;
  }
  else {
    puVar3 = (uint *)FUN_10022a40(this,*(int *)(param_1 + 0x40e8),local_20);
    if ((puVar3 != (uint *)0x0) && ((puVar3[1] & 0x200) == 0)) {
      *(uint *)(param_3 + 4) = *puVar3;
      *(undefined4 *)(param_3 + 0xc) = 0;
      **(undefined1 **)(param_2 + 0x60) = 0;
      FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"IDENT",*puVar3);
      FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c8,
                   (byte *)(puVar3 + 2));
      FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"COUNT",puVar3[0x43])
      ;
      FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"GCOUNT",puVar3[0x44]
                  );
      FUN_100024f0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"FLAGS",puVar3[1]);
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0;
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
      return 0xffffffff;
    }
    *(undefined4 *)(param_2 + 0x54) = 0x75726f6d;
  }
  *(undefined4 *)(param_2 + 0x58) = 0;
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  return 0;
}



undefined4 __cdecl FUN_1001f450(void *param_1,int param_2)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_40 [64];
  
  iVar1 = param_2;
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x40;
  pbVar3 = local_40;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004df60);
  FUN_10002a30(pbVar2,pbVar3,iVar4,pbVar5);
  iVar4 = FUN_10023240(param_1,*(int *)((int)param_1 + 0x2cc694),local_40,1,&param_2);
  if (iVar4 != 0) {
    *(undefined4 *)(iVar1 + 0x58) = 0;
    *(undefined4 *)(iVar1 + 0x28) = 0;
    *(int *)(iVar1 + 0x54) = iVar4;
    *(undefined4 *)(iVar1 + 0x50) = *(undefined4 *)(iVar1 + 0x6c);
    return 0;
  }
  FUN_10003e20(*(byte **)(iVar1 + 0x60),*(size_t *)(iVar1 + 0x5c),
               (byte *)"ADDR=%a PORT=%d FLAGS=%f SECRET=%s");
  *(undefined4 *)(iVar1 + 0x50) = *(undefined4 *)(iVar1 + 0x6c);
  *(undefined4 *)(iVar1 + 0x54) = 0;
  *(undefined4 *)(iVar1 + 0x28) = 0;
  *(undefined4 *)(iVar1 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_1001ff60(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int *piVar3;
  int iVar4;
  byte *pbVar5;
  byte local_24 [36];
  
  iVar4 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"IDENT");
  iVar4 = FUN_10002480((char *)pbVar1,iVar4);
  if (iVar4 == 0) {
    pbVar5 = &DAT_1004d26f;
    iVar4 = 0x24;
    pbVar1 = local_24;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
    FUN_10002a30(pbVar2,pbVar1,iVar4,pbVar5);
    if (local_24[0] == 0) {
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
      return 0;
    }
    piVar3 = (int *)FUN_10022a40(local_24,*(int *)(param_1 + 0x4100),local_24);
    if (piVar3 == (int *)0x0) {
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x54) = 0x6e666e64;
      return 0;
    }
    iVar4 = *piVar3;
  }
  iVar4 = FUN_10026280(*(int *)(param_1 + 0x4110),iVar4);
  if (iVar4 == 0) {
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6e666e64;
    return 0;
  }
  FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(char *)(iVar4 + 0xc));
  FUN_10003240(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e6b4,*(int *)(iVar4 + 8)
              );
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_100201c0(int param_1,int param_2,int param_3)

{
  int iVar1;
  char cVar2;
  byte *pbVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  byte *pbVar13;
  int local_3c;
  byte local_24 [36];
  
  iVar1 = param_2;
  iVar10 = 0;
  iVar11 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"START");
  iVar11 = FUN_10002480((char *)pbVar3,iVar11);
  iVar12 = 0x32;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"COUNT");
  local_3c = FUN_10002480((char *)pbVar3,iVar12);
  if (100 < local_3c) {
    local_3c = 100;
  }
  iVar12 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CUSTFLAGS");
  uVar4 = FUN_10002480((char *)pbVar3,iVar12);
  iVar12 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CUSTMASK");
  uVar5 = FUN_10002480((char *)pbVar3,iVar12);
  iVar12 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"SYSFLAGS");
  uVar6 = FUN_10002480((char *)pbVar3,iVar12);
  iVar12 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"SYSMASK");
  uVar7 = FUN_10002480((char *)pbVar3,iVar12);
  pbVar13 = &DAT_1004d26f;
  iVar12 = 0x24;
  pbVar3 = local_24;
  pbVar8 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar8,pbVar3,iVar12,pbVar13);
  iVar12 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if (iVar12 == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x75757372;
    return 0;
  }
  FUN_10022c50(*(int *)(param_1 + 0x4114));
  param_2 = 0;
  if (0 < local_3c) {
    do {
      iVar12 = FUN_10022c60(*(int *)(param_1 + 0x4114),(undefined4 *)0x0);
      if (iVar12 == 0) break;
      if (((iVar11 <= param_2) && ((*(uint *)(iVar12 + 0xc) & uVar5) == uVar4)) &&
         ((*(uint *)(iVar12 + 8) & uVar7) == uVar6)) {
        iVar9 = FUN_100255d0((char *)(iVar12 + 0x24),(char *)local_24);
        if (iVar9 != 0) {
          cVar2 = FUN_10023680();
          if (cVar2 != '\0') {
            FUN_10025aa0(*(byte **)(iVar1 + 0x60),*(size_t *)(iVar1 + 0x5c),iVar12);
            FUN_10014430(*(undefined4 *)(param_1 + 0x4020),iVar1,0x2b757373,0,
                         *(char **)(iVar1 + 0x60),(char *)0xffffffff);
            iVar10 = iVar10 + 1;
          }
        }
      }
      param_2 = param_2 + 1;
    } while (iVar10 < local_3c);
  }
  FUN_10003e20(*(byte **)(iVar1 + 0x60),*(size_t *)(iVar1 + 0x5c),(byte *)"COUNT=%d");
  *(undefined4 *)(iVar1 + 0x28) = 0;
  *(undefined4 *)(iVar1 + 0x54) = 0;
  *(undefined4 *)(iVar1 + 0x50) = *(undefined4 *)(iVar1 + 0x6c);
  *(undefined4 *)(iVar1 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



int __cdecl
FUN_10020410(int param_1,int param_2,uint param_3,uint param_4,uint param_5,uint param_6,int param_7
            ,int param_8,int param_9,char *param_10,undefined4 param_11)

{
  int iVar1;
  
  if (((((*(uint *)(param_2 + 8) & param_4) == param_3) &&
       ((*(uint *)(param_2 + 4) & param_6) == param_5)) && (param_7 <= *(int *)(param_2 + 0x98))) &&
     ((*(int *)(param_2 + 0x94) <= param_8 &&
      ((param_9 == 0 || (param_9 == *(int *)(param_2 + 0x8c))))))) {
    iVar1 = FUN_100255d0((char *)(param_2 + 0xc),param_10);
    if (iVar1 != 0) {
      iVar1 = FUN_10023610(*(undefined4 *)(param_1 + 0x2ccc9c),param_2,param_11,'\0');
      return iVar1;
    }
  }
  return 0x66696c74;
}



void __cdecl FUN_100204b0(int param_1,int param_2,int param_3)

{
  void *this;
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  FUN_10022c50(*(int *)(param_1 + 0x40d8));
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  **(undefined1 **)(param_2 + 0x60) = 0;
  iVar4 = 0;
  if (0 < *(int *)(param_1 + 0x40e4)) {
    iVar3 = 0;
    do {
      this = *(void **)(*(int *)(param_1 + 0x40e0) + iVar4 * 4);
      if (*(char *)((int)this + 0x208) == '\0') {
        if (iVar1 == 0) {
          iVar2 = 0x656e5553;
        }
        else {
          iVar2 = *(int *)(iVar1 + 0x428);
        }
        FUN_10027500(this,iVar3,*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),iVar2);
        iVar3 = iVar3 + 1;
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < *(int *)(param_1 + 0x40e4));
  }
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return;
}



undefined4 __cdecl FUN_10020560(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  void *this;
  byte *pbVar3;
  void *this_00;
  undefined4 *puVar4;
  int iVar5;
  byte *pbVar6;
  int local_310;
  byte local_304 [36];
  undefined4 local_2e0 [2];
  byte local_2d8 [464];
  byte local_108 [260];
  
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x40fc),*(int *)(param_3 + 0xa34));
  if (iVar1 == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  local_310 = 0;
  pbVar2 = (byte *)FUN_100022d0(*(byte **)(param_2 + 0x7c),&DAT_10051820,0);
  while (pbVar2 != (byte *)0x0) {
    FUN_10002a30(pbVar2,local_304,0x24,&DAT_1004d26f);
    if ((local_304[0] != 0) &&
       (this = (void *)FUN_10027670(*(int *)(param_1 + 0x40d8),local_304), this != (void *)0x0)) {
      pbVar6 = &DAT_1004d26f;
      iVar5 = 0x100;
      pbVar2 = local_108;
      pbVar3 = (byte *)FUN_100022d0(*(byte **)(param_2 + 0x7c),&DAT_10051818,local_310);
      FUN_10002a30(pbVar3,pbVar2,iVar5,pbVar6);
      puVar4 = local_2e0;
      for (iVar5 = 0x75; iVar5 != 0; iVar5 = iVar5 + -1) {
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      }
      FUN_10027bb0(this,(int)local_2e0);
      iVar5 = FUN_10022a40(this_00,*(int *)(param_1 + 0x40e8),local_2d8);
      if (iVar5 == 0) {
        FUN_1000ac40(param_1,param_2,iVar1,(int)local_2e0);
        FUN_10014430(*(undefined4 *)(param_1 + 0x4020),param_2,0x2b726f6d,0,
                     *(char **)(param_2 + 0x60),(char *)0xffffffff);
      }
    }
    local_310 = local_310 + 1;
    pbVar2 = (byte *)FUN_100022d0(*(byte **)(param_2 + 0x7c),&DAT_10051820,local_310);
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"COUNT=%d");
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return 0xffffffff;
}



void __cdecl
FUN_10020d80(int param_1,int param_2,undefined4 param_3,char *param_4,undefined4 *param_5)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  
  **(undefined4 **)(*(int *)(param_1 + 0x28) + param_2 * 4) = param_3;
  FUN_10005d70((char *)(*(int *)(*(int *)(param_1 + 0x28) + param_2 * 4) + 4),param_4,0x10);
  *(undefined1 *)(*(int *)(*(int *)(param_1 + 0x28) + param_2 * 4) + 0x13) = 0;
  uVar1 = *(int *)(param_1 + 0x1c) - 0x14;
  if (param_5 == (undefined4 *)0x0) {
    puVar3 = (undefined4 *)(*(int *)(*(int *)(param_1 + 0x28) + param_2 * 4) + 0x14);
    for (uVar2 = uVar1 >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
    for (uVar1 = uVar1 & 3; uVar1 != 0; uVar1 = uVar1 - 1) {
      *(undefined1 *)puVar3 = 0;
      puVar3 = (undefined4 *)((int)puVar3 + 1);
    }
    return;
  }
  puVar3 = (undefined4 *)(*(int *)(*(int *)(param_1 + 0x28) + param_2 * 4) + 0x14);
  for (uVar2 = uVar1 >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar3 = *param_5;
    param_5 = param_5 + 1;
    puVar3 = puVar3 + 1;
  }
  for (uVar1 = uVar1 & 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    *(undefined1 *)puVar3 = *(undefined1 *)param_5;
    param_5 = (undefined4 *)((int)param_5 + 1);
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  return;
}



undefined4 * __cdecl
FUN_10020e00(int param_1,int param_2,int param_3,undefined4 param_4,char param_5)

{
  int iVar1;
  void *_Memory;
  undefined4 *_Memory_00;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  
  _Memory_00 = (undefined4 *)_malloc(600);
  puVar3 = _Memory_00;
  for (iVar4 = 0x96; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  _Memory_00[1] = param_4;
  _Memory_00[2] = -(uint)(param_5 != '\0') & 0x7fffffff;
  if (param_1 < 2) {
    param_1 = 2;
  }
  if (param_2 < 1) {
    param_2 = 1;
  }
  uVar2 = param_3 + 0x17U & 0x7ffc;
  _Memory_00[7] = uVar2;
  _Memory_00[8] = param_3;
  _Memory_00[6] = param_1;
  _Memory_00[5] = param_1 + param_2;
  _Memory_00[9] = param_3 + 0x27U & 0x7ffc;
  puVar3 = (undefined4 *)_malloc(uVar2 * (param_1 + param_2));
  iVar4 = _Memory_00[5];
  iVar1 = _Memory_00[7];
  _Memory_00[0xb] = puVar3;
  for (uVar2 = (uint)(iVar4 * iVar1) >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (uVar2 = iVar4 * iVar1 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  puVar3 = (undefined4 *)_malloc(_Memory_00[5] * 4 + 4);
  _Memory_00[10] = puVar3;
  for (uVar2 = _Memory_00[5] * 4 + 4U >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  puVar3 = (undefined4 *)_malloc(_Memory_00[5] * _Memory_00[9]);
  iVar4 = _Memory_00[5];
  iVar1 = _Memory_00[9];
  _Memory_00[0xd] = puVar3;
  for (uVar2 = (uint)(iVar4 * iVar1) >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (uVar2 = iVar4 * iVar1 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  _Memory = (void *)_Memory_00[0xb];
  if (_Memory != (void *)0x0) {
    if ((_Memory_00[10] != 0) && (_Memory_00[0xd] != 0)) {
      iVar4 = 0;
      if (0 < (int)_Memory_00[5]) {
        do {
          *(int *)(_Memory_00[10] + iVar4 * 4) = _Memory_00[7] * iVar4 + _Memory_00[0xb];
          iVar4 = iVar4 + 1;
        } while (iVar4 < (int)_Memory_00[5]);
      }
      puVar3 = FUN_10022cd0(param_1 / 0x14,param_1 / 2);
      _Memory_00[0xe] = puVar3;
      if (puVar3 == (undefined4 *)0x0) {
        _free((void *)_Memory_00[0xb]);
        _free((void *)_Memory_00[10]);
        _free((void *)_Memory_00[0xd]);
        _free(_Memory_00);
        return (undefined4 *)0x0;
      }
      FUN_1003e160((int)puVar3,FUN_10025580);
      return _Memory_00;
    }
    if (_Memory != (void *)0x0) {
      _free(_Memory);
    }
  }
  if ((void *)_Memory_00[10] != (void *)0x0) {
    _free((void *)_Memory_00[10]);
  }
  if ((void *)_Memory_00[0xd] != (void *)0x0) {
    _free((void *)_Memory_00[0xd]);
  }
  _free(_Memory_00);
  return (undefined4 *)0x0;
}



void __cdecl FUN_10020fe0(void *param_1)

{
  FUN_10022830(*(void **)((int)param_1 + 0x38));
  _free(*(void **)((int)param_1 + 0x28));
  _free(*(void **)((int)param_1 + 0x2c));
  _free(*(void **)((int)param_1 + 0x34));
  _free(param_1);
  return;
}



void FUN_10021020(int *param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int *piVar4;
  undefined4 *puVar5;
  
  iVar1 = param_1[9];
  iVar2 = param_1[5];
  *param_1 = 0;
  param_1[4] = 0;
  puVar5 = (undefined4 *)param_1[0xd];
  for (uVar3 = (uint)(iVar1 * iVar2) >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  for (uVar3 = iVar1 * iVar2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined1 *)puVar5 = 0;
    puVar5 = (undefined4 *)((int)puVar5 + 1);
  }
  piVar4 = (int *)((param_1[0xc] % param_1[5]) * param_1[9] + param_1[0xd]);
  *piVar4 = param_1[0xc];
  piVar4[2] = 0;
  piVar4[3] = 0;
  piVar4[4] = 0;
  piVar4[1] = 1;
  iVar1 = param_1[8];
  piVar4 = piVar4 + 5;
  for (uVar3 = iVar1 + 0x10U >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *piVar4 = 0;
    piVar4 = piVar4 + 1;
  }
  for (uVar3 = iVar1 + 0x10U & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined1 *)piVar4 = 0;
    piVar4 = (int *)((int)piVar4 + 1);
  }
  *param_1 = *param_1 + 1;
  param_1[0xc] = param_1[0xc] + 1;
  FUN_10022870((undefined4 *)param_1[0xe]);
  return;
}



int __cdecl FUN_100210a0(int param_1,uint param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  
  iVar5 = *(int *)(param_1 + 0x10);
  if (iVar5 < 1) {
    return -1;
  }
  puVar3 = *(undefined4 **)(param_1 + 0x28);
  uVar4 = param_2 ^ *(uint *)(param_1 + 8);
  if ((int)*(uint *)*puVar3 < (int)uVar4) {
    return -1;
  }
  if (uVar4 == *(uint *)*puVar3) {
    return 0;
  }
  if (((int)uVar4 < *(int *)puVar3[iVar5 + -1]) ||
     ((*(int *)(param_1 + 0x18) <= iVar5 && ((int)uVar4 < *(int *)puVar3[*(int *)(param_1 + 0x18)]))
     )) {
    return -1;
  }
  iVar5 = iVar5 + -1;
  iVar6 = 1;
  iVar2 = 0;
  if (0 < iVar5) {
    do {
      iVar2 = (iVar5 + iVar6) / 2;
      uVar1 = *(uint *)puVar3[iVar2];
      if (uVar4 == uVar1) break;
      if (uVar4 == uVar1 || (int)(uVar4 - uVar1) < 0) {
        iVar6 = iVar2 + 1;
      }
      else {
        iVar5 = iVar2 + -1;
      }
    } while (iVar6 <= iVar5);
    if (0 < iVar2) {
      puVar3 = puVar3 + iVar2 + -1;
      do {
        if (uVar4 != *(uint *)*puVar3) {
          return iVar2;
        }
        iVar2 = iVar2 + -1;
        puVar3 = puVar3 + -1;
      } while (0 < iVar2);
    }
  }
  return iVar2;
}



int __cdecl FUN_10021150(int *param_1,uint param_2,byte *param_3,int *param_4)

{
  void *pvVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int *piVar9;
  undefined4 *puVar10;
  uint uVar11;
  undefined4 *puVar12;
  int local_c;
  int local_8;
  int local_4;
  
  local_c = -1;
  if ((param_3 == (byte *)0x0) || (*param_3 == 0)) {
    return -10;
  }
  if (param_1[1] == 1) {
    if (50000 < param_1[3]) {
      iVar2 = param_1[4] + -1;
      param_1[3] = 0;
      while (-1 < iVar2) {
        iVar5 = param_1[3];
        iVar2 = iVar2 + -1;
        param_1[3] = iVar5 + 1;
        **(int **)(param_1[10] + 4 + iVar2 * 4) = iVar5 + 1;
      }
    }
    param_2 = param_1[3] + 1;
    param_1[3] = param_2;
  }
  piVar3 = (int *)FUN_10022a40((void *)param_1[0xe],param_1[0xe],param_3);
  iVar2 = local_c;
  if (piVar3 == (int *)0x0) {
    local_8 = 0;
  }
  else {
    local_8 = *piVar3;
    if ((((0 < local_8) && (iVar5 = param_1[4], 0 < iVar5)) && (local_8 <= **(int **)param_1[10]))
       && (*(int *)((undefined4 *)param_1[10])[iVar5 + -1] <= local_8)) {
      iVar5 = iVar5 + -1;
      local_4 = 0;
      if (-1 < iVar5) {
        do {
          iVar2 = (iVar5 + local_4) / 2;
          piVar3 = *(int **)(param_1[10] + iVar2 * 4);
          iVar8 = local_8 - *piVar3;
          if ((iVar8 == 0) &&
             (iVar8 = FUN_10025580((char *)(piVar3 + 1),(char *)param_3), iVar8 == 0)) break;
          if (iVar8 < 1) {
            local_4 = iVar2 + 1;
          }
          else {
            iVar5 = iVar2 + -1;
          }
          iVar2 = local_c;
        } while (local_4 <= iVar5);
      }
    }
  }
  local_c = iVar2;
  iVar2 = -1;
  if (param_1[1] == 2) {
    if (0 < (int)param_2) {
      if ((int)param_2 < local_8) {
        return -1;
      }
      goto LAB_1002126e;
    }
  }
  else {
LAB_1002126e:
    if (0 < (int)param_2) {
      iVar5 = param_1[4];
      if ((0 < iVar5) && (**(int **)(param_1[10] + -4 + iVar5 * 4) <= (int)(param_1[2] ^ param_2)))
      {
        iVar5 = iVar5 + -1;
        iVar2 = 0;
        iVar8 = 0;
        if (-1 < iVar5) {
          do {
            iVar8 = (iVar5 + iVar2) / 2;
            piVar3 = *(int **)(param_1[10] + iVar8 * 4);
            iVar4 = (param_1[2] ^ param_2) - *piVar3;
            if ((iVar4 == 0) &&
               (iVar4 = FUN_10025580((char *)(piVar3 + 1),(char *)param_3), iVar4 == 0))
            goto LAB_100212dd;
            if (iVar4 < 1) {
              iVar2 = iVar8 + 1;
            }
            else {
              iVar5 = iVar8 + -1;
            }
          } while (iVar2 <= iVar5);
          iVar2 = iVar8 + 1;
          if (iVar4 < 0) goto LAB_100212df;
        }
LAB_100212dd:
        iVar2 = iVar8;
      }
LAB_100212df:
      if ((param_1[4] < param_1[5]) && (iVar2 < 0)) {
        iVar2 = param_1[4];
      }
    }
  }
  if ((local_c < 0) && (iVar2 < 0)) {
    return -2;
  }
  if (iVar2 < param_1[5]) {
    if (-1 < local_c) goto LAB_10021326;
  }
  else {
    if (local_c < 0) {
      return -3;
    }
LAB_10021326:
    if (local_c < iVar2) {
      iVar2 = iVar2 + -1;
    }
  }
  uVar11 = param_2 ^ param_1[2];
  piVar3 = (int *)((param_1[0xc] % param_1[5]) * param_1[9] + param_1[0xd]);
  *piVar3 = param_1[0xc];
  piVar3[1] = 0;
  piVar3[2] = uVar11;
  piVar3[3] = local_c;
  piVar3[4] = iVar2;
  FUN_10005d70((char *)(piVar3 + 5),(char *)param_3,0x10);
  uVar7 = param_1[8];
  if (param_4 == (int *)0x0) {
    piVar3 = piVar3 + 9;
    for (uVar6 = uVar7 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *piVar3 = 0;
      piVar3 = piVar3 + 1;
    }
    for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
      *(undefined1 *)piVar3 = 0;
      piVar3 = (int *)((int)piVar3 + 1);
    }
  }
  else {
    piVar9 = param_4;
    piVar3 = piVar3 + 9;
    for (uVar6 = uVar7 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *piVar3 = *piVar9;
      piVar9 = piVar9 + 1;
      piVar3 = piVar3 + 1;
    }
    for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
      *(char *)piVar3 = (char)*piVar9;
      piVar9 = (int *)((int)piVar9 + 1);
      piVar3 = (int *)((int)piVar3 + 1);
    }
  }
  *param_1 = *param_1 + 1;
  param_1[0xc] = param_1[0xc] + 1;
  if (iVar2 == local_c) {
    FUN_10020d80((int)param_1,iVar2,uVar11,(char *)param_3,param_4);
    return iVar2;
  }
  if (iVar2 < 0) {
LAB_10021470:
    if (-1 < local_c) {
      if (-1 < iVar2) goto LAB_100214d1;
      *(undefined4 *)(param_1[10] + param_1[5] * 4) = *(undefined4 *)(param_1[10] + local_c * 4);
      pvVar1 = (void *)(param_1[10] + local_c * 4);
      _memmove(pvVar1,(void *)((int)pvVar1 + 4),(param_1[4] - local_c) * 4 - 4);
      *(undefined4 *)(param_1[10] + -4 + param_1[4] * 4) =
           *(undefined4 *)(param_1[10] + param_1[5] * 4);
      param_1[4] = param_1[4] + -1;
      FUN_10022a90((void *)param_1[0xe],(int *)param_1[0xe],param_3);
    }
  }
  else if (-1 < local_c) {
    iVar5 = param_1[10];
    if (iVar2 < local_c) {
      *(undefined4 *)(iVar5 + param_1[5] * 4) = *(undefined4 *)(iVar5 + local_c * 4);
      pvVar1 = (void *)(param_1[10] + iVar2 * 4);
      _memmove((void *)((int)pvVar1 + 4),pvVar1,(local_c - iVar2) * 4);
      *(undefined4 *)(param_1[10] + iVar2 * 4) = *(undefined4 *)(param_1[10] + param_1[5] * 4);
    }
    else {
      *(undefined4 *)(iVar5 + param_1[5] * 4) = *(undefined4 *)(iVar5 + local_c * 4);
      pvVar1 = (void *)(param_1[10] + local_c * 4);
      _memmove(pvVar1,(void *)((int)pvVar1 + 4),(iVar2 - local_c) * 4);
      *(undefined4 *)(param_1[10] + iVar2 * 4) = *(undefined4 *)(param_1[10] + param_1[5] * 4);
    }
    FUN_10020d80((int)param_1,iVar2,uVar11,(char *)param_3,param_4);
    goto LAB_10021470;
  }
  if (iVar2 < 0) {
    return iVar2;
  }
LAB_100214d1:
  if (local_c < 0) {
    if (param_1[4] == param_1[5]) {
      param_1[4] = param_1[4] + -1;
      iVar5 = param_1[0xd];
      iVar8 = (param_1[0xc] % param_1[5]) * param_1[9];
      *(int *)(iVar8 + iVar5) = param_1[0xc];
      *(undefined4 *)(iVar8 + 4 + iVar5) = 0;
      *(undefined4 *)(iVar8 + 8 + iVar5) = 0;
      iVar8 = iVar8 + iVar5;
      iVar5 = param_1[4];
      *(undefined4 *)(iVar8 + 0x10) = 0xffffffff;
      *(int *)(iVar8 + 0xc) = iVar5 + -1;
      iVar5 = *(int *)(param_1[10] + param_1[4] * 4);
      *(undefined4 *)(iVar8 + 0x14) = *(undefined4 *)(iVar5 + 4);
      *(undefined4 *)(iVar8 + 0x18) = *(undefined4 *)(iVar5 + 8);
      *(undefined4 *)(iVar8 + 0x1c) = *(undefined4 *)(iVar5 + 0xc);
      *(undefined4 *)(iVar8 + 0x20) = *(undefined4 *)(iVar5 + 0x10);
      uVar7 = param_1[8];
      puVar10 = (undefined4 *)(*(int *)(param_1[10] + param_1[4] * 4) + 0x14);
      puVar12 = (undefined4 *)(iVar8 + 0x24);
      for (uVar6 = uVar7 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *puVar12 = *puVar10;
        puVar10 = puVar10 + 1;
        puVar12 = puVar12 + 1;
      }
      for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
        *(undefined1 *)puVar12 = *(undefined1 *)puVar10;
        puVar10 = (undefined4 *)((int)puVar10 + 1);
        puVar12 = (undefined4 *)((int)puVar12 + 1);
      }
      FUN_10022a90((void *)0x0,(int *)param_1[0xe],(byte *)(iVar8 + 0x14));
      param_1[0xc] = param_1[0xc] + 1;
    }
    if (0 < param_1[4]) {
      *(undefined4 *)(param_1[10] + param_1[5] * 4) = *(undefined4 *)(param_1[10] + param_1[4] * 4);
      pvVar1 = (void *)(param_1[10] + iVar2 * 4);
      _memmove((void *)((int)pvVar1 + 4),pvVar1,(param_1[4] - iVar2) * 4);
      *(undefined4 *)(param_1[10] + iVar2 * 4) = *(undefined4 *)(param_1[10] + param_1[5] * 4);
    }
    FUN_10020d80((int)param_1,iVar2,uVar11,(char *)param_3,param_4);
    param_1[4] = param_1[4] + 1;
    iVar5 = *(int *)(param_1[10] + iVar2 * 4);
    iVar5 = FUN_100229d0((void *)param_1[10],(int *)param_1[0xe],(byte *)(iVar5 + 4),iVar5);
    if (iVar5 < 0) {
      FUN_10016410(8);
      return iVar2;
    }
  }
  return iVar2;
}



void __cdecl FUN_10021610(int *param_1,byte *param_2)

{
  FUN_10021150(param_1,0,param_2,(int *)0x0);
  return;
}



undefined4 __cdecl FUN_10021630(int param_1)

{
  return *(undefined4 *)(param_1 + 0x30);
}



int __cdecl FUN_10021640(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0x10);
  if (*(int *)(param_1 + 0x18) <= *(int *)(param_1 + 0x10)) {
    iVar1 = *(int *)(param_1 + 0x18);
  }
  return iVar1;
}



undefined4 __cdecl FUN_10021660(int param_1)

{
  return *(undefined4 *)(param_1 + 0x18);
}



int __cdecl FUN_10021670(int param_1)

{
  return *(int *)(param_1 + 0x14) - *(int *)(param_1 + 0x18);
}



bool __cdecl FUN_10021680(int param_1)

{
  return *(int *)(param_1 + 8) != 0;
}



int __cdecl FUN_10021690(int param_1,int param_2,uint *param_3,int *param_4,int *param_5)

{
  int iVar1;
  
  if ((param_2 < 0) || (*(int *)(param_1 + 0x10) <= param_2)) {
    return 0;
  }
  if (param_3 != (uint *)0x0) {
    *param_3 = **(uint **)(*(int *)(param_1 + 0x28) + param_2 * 4) ^ *(uint *)(param_1 + 8);
  }
  if ((param_4 != (int *)0x0) && (*param_4 = param_2, 0 < param_2)) {
    do {
      if (**(int **)(*(int *)(param_1 + 0x28) + param_2 * 4) !=
          **(int **)(*(int *)(param_1 + 0x28) + -4 + *param_4 * 4)) break;
      iVar1 = *param_4 + -1;
      *param_4 = iVar1;
    } while (0 < iVar1);
  }
  if (param_5 != (int *)0x0) {
    *param_5 = *(int *)(*(int *)(param_1 + 0x28) + param_2 * 4) + 4;
  }
  return *(int *)(*(int *)(param_1 + 0x28) + param_2 * 4) + 0x14;
}



int __cdecl
FUN_10021710(int param_1,int *param_2,int *param_3,undefined4 *param_4,uint *param_5,int *param_6)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  
  if (*param_2 != *(int *)(param_1 + 0x30)) {
    do {
      iVar2 = (*param_2 % *(int *)(param_1 + 0x14)) * *(int *)(param_1 + 0x24) +
              *(int *)(param_1 + 0x34);
      *param_2 = *param_2 + 1;
      if (((-1 < *(int *)(iVar2 + 0xc)) && (*(int *)(iVar2 + 0xc) < *param_3)) ||
         ((-1 < *(int *)(iVar2 + 0x10) && (*(int *)(iVar2 + 0x10) < *param_3)))) {
        if ((*(int *)(iVar2 + 0xc) < 0) || (iVar1 = *param_3, iVar1 <= *(int *)(iVar2 + 0xc))) {
          *param_3 = *param_3 + 1;
        }
        else if ((*(int *)(iVar2 + 0x10) < 0) || (iVar1 <= *(int *)(iVar2 + 0x10))) {
          *param_3 = iVar1 + -1;
        }
        if (param_4 != (undefined4 *)0x0) {
          *param_4 = *(undefined4 *)(iVar2 + 4);
        }
        if (param_5 != (uint *)0x0) {
          if (*(uint *)(iVar2 + 8) == 0) {
            uVar3 = 0;
          }
          else {
            uVar3 = *(uint *)(param_1 + 8) ^ *(uint *)(iVar2 + 8);
          }
          *param_5 = uVar3;
        }
        if (param_6 != (int *)0x0) {
          *param_6 = iVar2 + 0x14;
        }
        return iVar2 + 0x24;
      }
    } while (*param_2 != *(int *)(param_1 + 0x30));
  }
  return 0;
}



bool __cdecl FUN_100217c0(int param_1,FILE *param_2)

{
  size_t sVar1;
  undefined4 local_c;
  undefined2 local_8;
  ushort uStack_6;
  ushort local_4;
  
  local_8 = *(undefined2 *)(param_1 + 0x10);
  uStack_6 = *(ushort *)(param_1 + 0x14);
  local_4 = *(ushort *)(param_1 + 0x1c);
  local_c = 0x11234;
  _fwrite(&local_c,10,1,param_2);
  sVar1 = _fwrite(*(void **)(param_1 + 0x2c),(uint)local_4,(uint)uStack_6,param_2);
  return sVar1 == uStack_6;
}



undefined4 __cdecl FUN_10021850(int *param_1,LPCSTR param_2)

{
  bool bVar1;
  FILE *_File;
  int3 extraout_var;
  char local_100 [256];
  
  if (param_2 == (LPCSTR)0x0) {
    param_2 = (LPCSTR)((int)param_1 + 0x13d);
  }
  if ((((param_1 == (int *)0x0) || (param_2 == (LPCSTR)0x0)) || (*param_2 == '\0')) ||
     (*param_1 < 1)) {
    return 0;
  }
  _sprintf(local_100,"%s.tmp",param_2);
  _File = (FILE *)FUN_100409a9(local_100,"wb");
  if (_File == (FILE *)0x0) {
    return 0;
  }
  bVar1 = FUN_100217c0((int)param_1,_File);
  if (CONCAT31(extraout_var,bVar1) != 0 && -1 < extraout_var) {
    _fclose(_File);
    FUN_10041990(param_2);
    FUN_10041962(local_100,param_2);
    *param_1 = 0;
    return 1;
  }
  _fclose(_File);
  FUN_10041990(param_2);
  return 0xffffffff;
}



int __cdecl FUN_10021940(int param_1,byte *param_2)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  iVar2 = param_1;
  piVar3 = (int *)FUN_10022a40(*(void **)(param_1 + 0x38),(int)*(void **)(param_1 + 0x38),param_2);
  if (piVar3 == (int *)0x0) {
    return -1;
  }
  iVar6 = 0;
  iVar4 = *(int *)(param_1 + 0x10);
  if (*(int *)(param_1 + 0x18) <= *(int *)(param_1 + 0x10)) {
    iVar4 = *(int *)(param_1 + 0x18);
  }
  iVar4 = iVar4 + -1;
  param_1 = -1;
  if (-1 < iVar4) {
    while( true ) {
      param_1 = (iVar4 + iVar6) / 2;
      piVar1 = *(int **)(*(int *)(iVar2 + 0x28) + param_1 * 4);
      iVar5 = *piVar3 - *piVar1;
      if ((iVar5 == 0) && (iVar5 = FUN_10025580((char *)(piVar1 + 1),(char *)param_2), iVar5 == 0))
      break;
      if (iVar5 < 1) {
        iVar6 = param_1 + 1;
      }
      else {
        iVar4 = param_1 + -1;
      }
      if (iVar4 < iVar6) {
        return -1;
      }
    }
  }
  return param_1;
}



int __cdecl FUN_100219e0(int param_1,byte *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  
  iVar1 = FUN_10021940(param_1,param_2);
  if (iVar1 < 0) {
    return -1;
  }
  if (iVar1 < *(int *)(param_1 + 0x10)) {
    iVar3 = iVar1;
    if (0 < iVar1) {
      puVar2 = (undefined4 *)(*(int *)(param_1 + 0x28) + iVar1 * 4);
      do {
        puVar2 = puVar2 + -1;
        if (**(int **)(*(int *)(param_1 + 0x28) + iVar1 * 4) != *(int *)*puVar2) break;
        iVar3 = iVar3 + -1;
      } while (0 < iVar3);
    }
    if (*(int *)(*(int *)(param_1 + 0x28) + iVar1 * 4) != -0x14) {
      return iVar3;
    }
  }
  return -1;
}



void FUN_10021a40(void)

{
  int iVar1;
  undefined1 *puVar2;
  undefined4 *unaff_ESI;
  
  iVar1 = unaff_ESI[9];
  if (unaff_ESI[1] != 0xffffffff) {
    closesocket(unaff_ESI[1]);
    (**(code **)(*(int *)*unaff_ESI + 8))(unaff_ESI[2]);
    unaff_ESI[1] = 0xffffffff;
  }
  if (unaff_ESI[0xb] != 0) {
    FUN_100230e0((void *)*unaff_ESI,unaff_ESI[0xb]);
    unaff_ESI[0xb] = 0;
  }
  if (unaff_ESI[10] != 0) {
    FUN_100230e0((void *)*unaff_ESI,unaff_ESI[10]);
    unaff_ESI[10] = 0;
  }
  unaff_ESI[9] = 3;
  if (iVar1 == 2) {
    if ((void *)unaff_ESI[0x13] != (void *)0x0) {
      _free((void *)unaff_ESI[0x13]);
    }
    unaff_ESI[0x11] = 0xc;
    unaff_ESI[0x12] = 0xc;
    puVar2 = (undefined1 *)_malloc(0xd);
    unaff_ESI[0x13] = puVar2;
    puVar2[3] = 0xff;
    puVar2[2] = 0xff;
    puVar2[1] = 0xff;
    *puVar2 = 0xff;
    puVar2[7] = 0xfe;
    puVar2[6] = 0xfe;
    puVar2[5] = 0xfe;
    puVar2[4] = 0xfe;
    puVar2[10] = 0;
    puVar2[9] = 0;
    puVar2[8] = 0;
    puVar2[0xb] = 0xc;
    if ((code *)unaff_ESI[0x17] != (code *)0x0) {
      (*(code *)unaff_ESI[0x17])();
    }
  }
  return;
}



void FUN_10021b00(void)

{
  u_short uVar1;
  undefined4 *in_EAX;
  u_long uVar2;
  undefined1 *puVar3;
  int local_18;
  int local_14;
  sockaddr sStack_10;
  
  if (in_EAX[9] == 1) {
    local_18 = 4;
    local_18 = getsockopt(in_EAX[1],0xffff,0x1007,(char *)&local_14,&local_18);
    if ((local_18 == 0) && (local_14 == 0)) {
      local_18 = 0x10;
      getsockname(in_EAX[1],&sStack_10,&local_18);
      uVar2 = ntohl(CONCAT22(sStack_10.sa_data._4_2_,sStack_10.sa_data._2_2_));
      in_EAX[7] = uVar2;
      uVar1 = ntohs(sStack_10.sa_data._0_2_);
      in_EAX[8] = (uint)uVar1;
      in_EAX[9] = 2;
      (**(code **)(*(int *)*in_EAX + 0xc))(in_EAX[2],1);
      in_EAX[0xd] = 0;
      if ((void *)in_EAX[0x13] != (void *)0x0) {
        _free((void *)in_EAX[0x13]);
      }
      in_EAX[0x11] = 0xc;
      in_EAX[0x12] = 0xc;
      puVar3 = (undefined1 *)_malloc(0xd);
      in_EAX[0x13] = puVar3;
      puVar3[3] = 0xff;
      puVar3[2] = 0xff;
      puVar3[1] = 0xff;
      *puVar3 = 0xff;
      puVar3[7] = 0xff;
      puVar3[6] = 0xff;
      puVar3[5] = 0xff;
      puVar3[4] = 0xff;
      puVar3[10] = 0;
      puVar3[9] = 0;
      puVar3[8] = 0;
      puVar3[0xb] = 0xc;
      if ((code *)in_EAX[0x17] != (code *)0x0) {
        (*(code *)in_EAX[0x17])();
      }
      if (in_EAX[0xb] != 0) {
        FUN_100230e0((void *)*in_EAX,in_EAX[0xb]);
        in_EAX[0xb] = 0;
      }
      if (in_EAX[10] != 0) {
        FUN_100230e0((void *)*in_EAX,in_EAX[10]);
        in_EAX[10] = 0;
        return;
      }
    }
    else {
      FUN_10021a40();
      FUN_10022440(in_EAX);
    }
  }
  return;
}



void FUN_10021c40(void)

{
  undefined4 *in_EAX;
  int iVar1;
  int iVar2;
  uint uVar3;
  
  FUN_10021b00();
  if (in_EAX[0xf] != 0) {
    iVar1 = in_EAX[0xd];
    if (iVar1 != in_EAX[0xc]) {
      if (in_EAX[9] == 2) {
        iVar1 = send(in_EAX[1],(char *)(iVar1 + in_EAX[0xf]),in_EAX[0xc] - iVar1,0);
        if ((iVar1 < 0) && (iVar2 = WSAGetLastError(), iVar2 != 0x2733)) {
          FUN_10021a40();
          FUN_10022440(in_EAX);
          return;
        }
        if (0 < iVar1) {
          in_EAX[0xd] = in_EAX[0xd] + iVar1;
        }
        if (in_EAX[0xd] == in_EAX[0xc]) {
          _free((void *)in_EAX[0xf]);
          in_EAX[0xf] = 0;
          iVar1 = *(int *)*in_EAX;
          uVar3 = (**(code **)(iVar1 + 0x10))(in_EAX[2]);
          (**(code **)(iVar1 + 0xc))(in_EAX[2],uVar3 & 0xfffffffd);
          return;
        }
      }
      else if (in_EAX[1] == -1) {
        return;
      }
      iVar1 = *(int *)*in_EAX;
      uVar3 = (**(code **)(iVar1 + 0x10))(in_EAX[2]);
      (**(code **)(iVar1 + 0xc))(in_EAX[2],uVar3 | 2);
    }
  }
  return;
}



void FUN_10021ec0(void)

{
  undefined4 *in_stack_00000010;
  
  FUN_10021a40();
  FUN_10022440(in_stack_00000010);
  return;
}



void __cdecl FUN_10021ee0(undefined4 param_1,undefined4 param_2,undefined4 *param_3)

{
  param_3[0xb] = 0;
  FUN_10021a40();
  FUN_10022440(param_3);
  return;
}



void FUN_10021f00(void)

{
  undefined4 *in_EAX;
  SOCKET s;
  int iVar1;
  undefined4 uVar2;
  u_long uStack_4;
  
  s = socket(2,1,0);
  in_EAX[1] = s;
  if (s == 0xffffffff) {
    WSAGetLastError();
    ntohs(*(u_short *)((int)in_EAX + 0xe));
    ntohl(in_EAX[4]);
    FUN_10016450(8);
    FUN_10021a40();
    FUN_10022440(in_EAX);
    return;
  }
  uStack_4 = 1;
  ioctlsocket(s,-0x7ffb9982,&uStack_4);
  connect(in_EAX[1],(sockaddr *)(in_EAX + 3),0x10);
  in_EAX[9] = 1;
  iVar1 = (**(code **)(*(int *)*in_EAX + 4))
                    (in_EAX[1],&LAB_10021d00,&LAB_10021eb0,FUN_10021ec0,FUN_10021ec0,0);
  if (iVar1 == -1) {
    ntohs(*(u_short *)((int)in_EAX + 0xe));
    ntohl(in_EAX[4]);
    FUN_10016450(8);
    FUN_10021a40();
    FUN_10022440(in_EAX);
    return;
  }
  in_EAX[2] = iVar1;
  (**(code **)(*(int *)*in_EAX + 0xc))(iVar1,3);
  if (in_EAX[0xb] == 0) {
    FUN_100230e0((void *)*in_EAX,0);
  }
  uVar2 = FUN_100230b0((void *)*in_EAX,30000,FUN_10021ee0,0,in_EAX);
  in_EAX[0xb] = uVar2;
  return;
}



undefined4 * __cdecl
FUN_10022030(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  WSADATA local_190;
  
  iVar1 = WSAStartup(2,&local_190);
  if (iVar1 != 0) {
    return (undefined4 *)0x0;
  }
  if (DAT_10068a58 == 0) {
    DAT_10068a58 = GetTickCount();
  }
  puVar2 = (undefined4 *)_malloc(0x2c8);
  if (puVar2 != (undefined4 *)0x0) {
    puVar3 = puVar2;
    for (iVar1 = 0xb2; iVar1 != 0; iVar1 = iVar1 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
    puVar2[9] = 0;
    puVar2[0x10] = param_2;
    *puVar2 = param_1;
    puVar2[1] = 0xffffffff;
    puVar2[0x17] = param_3;
    puVar2[0x18] = param_4;
    *(undefined2 *)((int)puVar2 + 0x66) = 0;
  }
  return puVar2;
}



void __cdecl FUN_100220d0(void *param_1)

{
  if (param_1 != (void *)0x0) {
    *(undefined1 *)((int)param_1 + 100) = 1;
    if (*(int *)((int)param_1 + 4) != -1) {
      FUN_10021a40();
    }
    Sleep(0x32);
    WSACleanup();
    if (*(void **)((int)param_1 + 0x4c) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x4c));
    }
    if (*(void **)((int)param_1 + 0x3c) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x3c));
    }
    _free(param_1);
  }
  return;
}



uint __cdecl FUN_10022130(int param_1,int param_2)

{
  u_short uVar1;
  u_long uVar2;
  
  if (param_1 != 0) {
    if (param_2 == 0x706f7274) {
      uVar1 = ntohs(*(u_short *)(param_1 + 0xe));
      return (uint)uVar1;
    }
    if (param_2 == 0x61646472) {
      uVar2 = ntohl(*(u_long *)(param_1 + 0x10));
      return uVar2;
    }
    if (param_2 == 0x6c616472) {
      return *(uint *)(param_1 + 0x1c);
    }
    if (param_2 == 0x6c707274) {
      return *(uint *)(param_1 + 0x20);
    }
    if (param_2 == 0x6f627566) {
      return *(int *)(param_1 + 0x30) - *(int *)(param_1 + 0x34);
    }
    if (param_2 == 0x69627566) {
      if (*(int *)(param_1 + 0x4c) != 0) {
        return *(int *)(param_1 + 0x44) - *(int *)(param_1 + 0x48);
      }
    }
    else {
      if (param_2 == 0x73746174) {
        return *(uint *)(param_1 + 0x24);
      }
      if (param_2 == 0x63727970) {
        return *(uint *)(param_1 + 0xbc);
      }
    }
  }
  return 0;
}



undefined4 __cdecl FUN_100221c0(int param_1,u_long param_2,u_short param_3)

{
  u_short uVar1;
  undefined4 uVar2;
  u_long uVar3;
  
  uVar2 = 0xffffffff;
  if (*(int *)(param_1 + 4) == -1) {
    if (*(void **)(param_1 + 0x4c) != (void *)0x0) {
      _free(*(void **)(param_1 + 0x4c));
      *(undefined4 *)(param_1 + 0x4c) = 0;
    }
    *(undefined4 *)(param_1 + 0xc) = 0;
    *(undefined4 *)(param_1 + 0x10) = 0;
    *(undefined4 *)(param_1 + 0x14) = 0;
    *(undefined4 *)(param_1 + 0x18) = 0;
    *(undefined2 *)(param_1 + 0xc) = 2;
    uVar3 = htonl(param_2);
    *(u_long *)(param_1 + 0x10) = uVar3;
    uVar1 = htons(param_3);
    *(u_short *)(param_1 + 0xe) = uVar1;
    *(undefined4 *)(param_1 + 0x24) = 1;
    FUN_10021f00();
    if (*(short *)(param_1 + 0x66) != 0) {
      *(undefined2 *)(param_1 + 0x66) = 0;
    }
    uVar2 = 0;
  }
  return uVar2;
}



int __cdecl FUN_10022240(int param_1,size_t param_2,int param_3)

{
  int iVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  
  pvVar2 = *(void **)(param_1 + 0x3c);
  iVar4 = 0;
  if (pvVar2 == (void *)0x0) {
    *(undefined4 *)(param_1 + 0x30) = 0;
    *(undefined4 *)(param_1 + 0x34) = 0;
    *(size_t *)(param_1 + 0x38) = param_2;
    pvVar2 = _malloc(param_2);
    *(void **)(param_1 + 0x3c) = pvVar2;
    return *(int *)(param_1 + 0x38) - *(int *)(param_1 + 0x30);
  }
  iVar1 = *(int *)(param_1 + 0x34);
  iVar7 = 0;
  if (0 < iVar1) {
    do {
      iVar4 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)((int)pvVar2 + iVar7 + 8),
                                         *(undefined1 *)((int)pvVar2 + iVar7 + 9)),
                                *(undefined1 *)((int)pvVar2 + iVar7 + 10)),
                       *(undefined1 *)((int)pvVar2 + iVar7 + 0xb));
      iVar7 = iVar7 + iVar4;
    } while (iVar7 < iVar1);
  }
  if (iVar1 < iVar7) {
    iVar7 = iVar7 - iVar4;
  }
  if (0 < iVar7) {
    _memmove(pvVar2,(void *)((int)pvVar2 + iVar7),*(int *)(param_1 + 0x30) - iVar7);
    *(int *)(param_1 + 0x30) = *(int *)(param_1 + 0x30) - iVar7;
    *(int *)(param_1 + 0x34) = *(int *)(param_1 + 0x34) - iVar7;
  }
  iVar4 = *(int *)(param_1 + 0x30);
  if (*(int *)(param_1 + 0x38) - iVar4 < (int)param_2) {
    puVar3 = (undefined4 *)_malloc(iVar4 + param_2 + param_3);
    if (puVar3 == (undefined4 *)0x0) {
      return 0;
    }
    uVar6 = *(uint *)(param_1 + 0x30);
    puVar8 = *(undefined4 **)(param_1 + 0x3c);
    puVar9 = puVar3;
    for (uVar5 = uVar6 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar9 = *puVar8;
      puVar8 = puVar8 + 1;
      puVar9 = puVar9 + 1;
    }
    for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined1 *)puVar9 = *(undefined1 *)puVar8;
      puVar8 = (undefined4 *)((int)puVar8 + 1);
      puVar9 = (undefined4 *)((int)puVar9 + 1);
    }
    _free(*(void **)(param_1 + 0x3c));
    iVar4 = *(int *)(param_1 + 0x30);
    *(undefined4 **)(param_1 + 0x3c) = puVar3;
    *(size_t *)(param_1 + 0x38) = iVar4 + param_2 + param_3;
  }
  return *(int *)(param_1 + 0x38) - iVar4;
}



int __cdecl FUN_10022340(int param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4)

{
  int iVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  
  if ((*(int *)(param_1 + 0x4c) != 0) && (*(int *)(param_1 + 0x48) == *(int *)(param_1 + 0x44))) {
    puVar2 = *(undefined1 **)(param_1 + 0x4c);
    iVar1 = *(int *)(param_1 + 0x44) + -0xc;
    puVar3 = puVar2 + 0xc;
    if (iVar1 < 1) {
      puVar3 = &DAT_1004d26f;
    }
    else {
      puVar3[iVar1] = 0;
    }
    if (param_2 != (undefined4 *)0x0) {
      *param_2 = CONCAT31(CONCAT21(CONCAT11(*puVar2,puVar2[1]),puVar2[2]),puVar2[3]);
    }
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = CONCAT31(CONCAT21(CONCAT11(puVar2[4],puVar2[5]),puVar2[6]),puVar2[7]);
    }
    if (param_4 != (undefined4 *)0x0) {
      *param_4 = puVar3;
    }
    return iVar1;
  }
  return -1;
}



uint __cdecl
FUN_100223d0(int param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4,uint param_5)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  
  uVar1 = FUN_10022340(param_1,param_2,param_3,(undefined4 *)0x0);
  if (-1 < (int)uVar1) {
    if ((int)uVar1 < (int)param_5) {
      param_5 = uVar1;
    }
    if (param_4 != (undefined4 *)0x0) {
      puVar3 = (undefined4 *)(*(int *)(param_1 + 0x4c) + 0xc);
      for (uVar2 = param_5 >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
        *param_4 = *puVar3;
        puVar3 = puVar3 + 1;
        param_4 = param_4 + 1;
      }
      for (uVar2 = param_5 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
        *(undefined1 *)param_4 = *(undefined1 *)puVar3;
        puVar3 = (undefined4 *)((int)puVar3 + 1);
        param_4 = (undefined4 *)((int)param_4 + 1);
      }
    }
    _free(*(void **)(param_1 + 0x4c));
    *(undefined4 *)(param_1 + 0x4c) = 0;
  }
  return uVar1;
}



void __cdecl FUN_10022440(undefined4 *param_1)

{
  uint uVar1;
  undefined4 uVar2;
  uint uVar3;
  
  if (*(char *)(param_1 + 0x19) == '\0') {
    uVar1 = DAT_10068a58 * 0x19660d + 0x3c6ef35f;
    uVar3 = DAT_10068a58 & 0xfff;
    DAT_10068a58 = uVar1;
    if (param_1[10] == 0) {
      uVar2 = FUN_100230b0((void *)*param_1,uVar3 + 1000,&LAB_10022020,0,param_1);
      param_1[10] = uVar2;
    }
  }
  return;
}



undefined4 __cdecl
FUN_10022490(undefined4 *param_1,int param_2,undefined4 param_3,char *param_4,char *param_5)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  undefined1 *puVar4;
  uint uVar5;
  char *pcVar6;
  
  if ((param_1 == (undefined4 *)0x0) || (*(char *)(param_1 + 0x19) != '\0')) {
    return 0xffffffff;
  }
  if (param_1[9] == 3) {
    FUN_10022440(param_1);
  }
  if ((int)param_5 < 0) {
    pcVar2 = param_4;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    param_5 = pcVar2 + (1 - (int)(param_4 + 1));
  }
  pcVar2 = param_5 + 0xc;
  iVar3 = FUN_10022240((int)param_1,(size_t)pcVar2,0x40000);
  if ((int)pcVar2 <= iVar3) {
    puVar4 = (undefined1 *)(param_1[0xf] + param_1[0xc]);
    if (0xc < (int)pcVar2) {
      pcVar6 = puVar4 + 0xc;
      for (uVar5 = (uint)param_5 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
        *(undefined4 *)pcVar6 = *(undefined4 *)param_4;
        param_4 = param_4 + 4;
        pcVar6 = pcVar6 + 4;
      }
      for (uVar5 = (uint)param_5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
        *pcVar6 = *param_4;
        param_4 = param_4 + 1;
        pcVar6 = pcVar6 + 1;
      }
    }
    param_1[0xc] = pcVar2 + param_1[0xc];
    puVar4[8] = (char)((uint)pcVar2 >> 0x18);
    puVar4[9] = (char)((uint)pcVar2 >> 0x10);
    puVar4[10] = (char)((uint)pcVar2 >> 8);
    *puVar4 = (char)((uint)param_2 >> 0x18);
    puVar4[1] = (char)((uint)param_2 >> 0x10);
    puVar4[0xb] = (char)pcVar2;
    puVar4[2] = (char)((uint)param_2 >> 8);
    puVar4[4] = (char)((uint)param_3 >> 0x18);
    puVar4[5] = (char)((uint)param_3 >> 0x10);
    puVar4[3] = (char)param_2;
    puVar4[6] = (char)((uint)param_3 >> 8);
    puVar4[7] = (char)param_3;
    if (param_2 == 0x40746963) {
      *(undefined2 *)((int)param_1 + 0x66) = 0;
    }
    FUN_10021c40();
    return 0;
  }
  return 0xffffffff;
}



void __cdecl FUN_100225a0(int param_1,byte *param_2,size_t param_3)

{
  uint uVar1;
  
  FUN_10003e20(param_2,param_3,(byte *)"NAME=%s DESC=%s KEY=%s EXTRACT=%s STYLE=%s GDP=%s");
  uVar1 = 0;
  if (*(int *)(param_1 + 0x4070) != 0) {
    do {
      FUN_10003e20(param_2,param_3,(byte *)"~R#=%s,%s,%s,%t");
      uVar1 = uVar1 + 1;
    } while (uVar1 < *(uint *)(param_1 + 0x4070));
  }
  return;
}



void __cdecl FUN_10022630(byte *param_1,undefined4 *param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  undefined4 *puVar5;
  int iVar6;
  byte *pbVar7;
  byte local_118 [8];
  byte local_110 [48];
  byte local_e0 [96];
  byte local_80 [128];
  
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0xc;
  pbVar2 = (byte *)(param_2 + 1);
  *param_2 = 0xffffffff;
  pbVar1 = FUN_100020f0(param_1,&DAT_1004d8c8);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x60;
  pbVar2 = (byte *)(param_2 + 4);
  pbVar1 = FUN_100020f0(param_1,&DAT_1004df70);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x10;
  pbVar2 = (byte *)(param_2 + 0x101d);
  pbVar1 = FUN_100020f0(param_1,&DAT_10051938);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x200;
  pbVar2 = (byte *)(param_2 + 0x1021);
  pbVar1 = FUN_100020f0(param_1,(byte *)"EXTRACT");
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x20;
  pbVar2 = (byte *)(param_2 + 0x10a1);
  pbVar1 = FUN_100020f0(param_1,(byte *)"STYLE");
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x100;
  pbVar2 = (byte *)((int)param_2 + 0x213f6);
  pbVar1 = FUN_100020f0(param_1,&DAT_1004ded4);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  *(undefined1 *)(param_2 + 0x84fd) = 1;
  *(undefined1 *)((int)param_2 + 0x213f5) = 0;
  uVar4 = 0;
  puVar5 = param_2 + 0x1d;
  do {
    pbVar2 = (byte *)FUN_100022d0(param_1,&DAT_1004e144,uVar4);
    if (pbVar2 == (byte *)0x0) break;
    FUN_10003680(pbVar2,local_110,0x30,&DAT_1004d26f,0,0x2c);
    FUN_10003680(pbVar2,local_e0,0x60,&DAT_1004d26f,1,0x2c);
    FUN_10003680(pbVar2,local_80,0x80,&DAT_1004d26f,2,0x2c);
    pbVar1 = FUN_10023710((void *)param_2[0x853e],local_110);
    puVar5[-1] = pbVar1;
    pbVar1 = FUN_10023710((void *)param_2[0x853e],local_e0);
    *puVar5 = pbVar1;
    pbVar1 = FUN_10023710((void *)param_2[0x853e],local_80);
    puVar5[1] = pbVar1;
    FUN_10003680(pbVar2,local_118,8,&DAT_1004d26f,3,0x2c);
    uVar3 = FUN_10002930(local_118,0);
    puVar5[2] = uVar3;
    uVar4 = uVar4 + 1;
    puVar5 = puVar5 + 4;
  } while (uVar4 < 0x400);
  param_2[0x101c] = uVar4;
  return;
}



void __cdecl FUN_10022830(void *param_1)

{
  int iVar1;
  undefined4 *_Memory;
  
  iVar1 = *(int *)((int)param_1 + 0x18);
  while (iVar1 != 0) {
    _Memory = *(undefined4 **)((int)param_1 + 0x18);
    *(undefined4 *)((int)param_1 + 0x18) = *_Memory;
    _free(_Memory);
    iVar1 = *(int *)((int)param_1 + 0x18);
  }
  _free(*(void **)((int)param_1 + 0x14));
  _free(param_1);
  return;
}



void __cdecl FUN_10022870(undefined4 *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = 0;
  *param_1 = 0;
  if (0 < (int)param_1[4]) {
    do {
      puVar1 = *(undefined4 **)(param_1[5] + iVar2 * 4);
      while (puVar1 != (undefined4 *)0x0) {
        *(undefined4 *)(param_1[5] + iVar2 * 4) = *puVar1;
        *puVar1 = param_1[7];
        param_1[7] = puVar1;
        puVar1 = *(undefined4 **)(param_1[5] + iVar2 * 4);
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < (int)param_1[4]);
  }
  return;
}



int __cdecl FUN_100228c0(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  if (param_2 < 1) {
    param_2 = 1;
  }
  puVar1 = (undefined4 *)_malloc((param_2 + 1) * 0xc);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = *(undefined4 *)(param_1 + 0x18);
    *(undefined4 **)(param_1 + 0x18) = puVar1;
    puVar2 = puVar1 + (param_2 + 1) * 3;
    while (puVar1 = puVar1 + 3, puVar1 != puVar2) {
      *puVar1 = *(undefined4 *)(param_1 + 0x1c);
      *(undefined4 **)(param_1 + 0x1c) = puVar1;
    }
    return param_2;
  }
  return -1;
}



int __cdecl FUN_10022920(int *param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  if (*param_1 == 0) {
    return 0;
  }
  iVar1 = param_1[5];
  if (*(int *)(iVar1 + param_1[1] * 4) == 0) {
    do {
      iVar3 = (param_1[1] + 1) % param_1[4];
      param_1[1] = iVar3;
    } while (*(int *)(param_1[5] + iVar3 * 4) == 0);
  }
  piVar2 = *(int **)(iVar1 + param_1[1] * 4);
  *(int *)(iVar1 + param_1[1] * 4) = *piVar2;
  *piVar2 = param_1[7];
  param_1[7] = (int)piVar2;
  *param_1 = *param_1 + -1;
  return piVar2[1];
}



undefined4 __cdecl FUN_10022980(undefined4 *param_1)

{
  return *param_1;
}



undefined4 __fastcall FUN_10022990(undefined4 param_1,byte *param_2,int param_3)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  
  uVar3 = 0;
  bVar2 = *param_2;
  while (bVar2 != 0) {
    if (' ' < (char)bVar2) {
      uVar3 = (bVar2 & 0x5f) + uVar3 * 0x83;
    }
    pbVar1 = param_2 + 1;
    param_2 = param_2 + 1;
    bVar2 = *pbVar1;
  }
  return (int)((longlong)(ulonglong)(uVar3 & 0x7fffffff) % (longlong)*(int *)(param_3 + 0x10));
}



undefined4 __thiscall FUN_100229d0(void *this,int *param_1,byte *param_2,int param_3)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = FUN_10022990(this,param_2,(int)param_1);
  if (param_1[7] == 0) {
    iVar3 = FUN_100228c0((int)param_1,(*param_1 * 3 + 10) / 2);
    if (iVar3 < 1) {
      return 0xffffffff;
    }
  }
  piVar1 = (int *)param_1[7];
  param_1[7] = *piVar1;
  piVar1[2] = (int)param_2;
  piVar1[1] = param_3;
  *piVar1 = *(int *)(param_1[5] + iVar2 * 4);
  *(int **)(param_1[5] + iVar2 * 4) = piVar1;
  *param_1 = *param_1 + 1;
  return 1;
}



undefined4 __thiscall FUN_10022a40(void *this,int param_1,byte *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = FUN_10022990(this,param_2,param_1);
  puVar1 = *(undefined4 **)(*(int *)(param_1 + 0x14) + iVar2 * 4);
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 0;
    }
    iVar2 = (**(code **)(param_1 + 0x20))(puVar1[2],param_2);
    if (iVar2 == 0) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return puVar1[1];
}



int __thiscall FUN_10022a90(void *this,int *param_1,byte *param_2)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  
  iVar3 = FUN_10022990(this,param_2,(int)param_1);
  piVar2 = *(int **)(param_1[5] + iVar3 * 4);
  piVar1 = (int *)(param_1[5] + iVar3 * 4);
  while( true ) {
    if (piVar2 == (int *)0x0) {
      return 0;
    }
    iVar3 = (*(code *)param_1[8])(*(undefined4 *)(*piVar1 + 8),param_2);
    if (iVar3 == 0) break;
    piVar1 = (int *)*piVar1;
    piVar2 = (int *)*piVar1;
  }
  *piVar1 = *piVar2;
  if ((int *)param_1[3] == piVar2) {
    param_1[3] = *piVar2;
  }
  *piVar2 = param_1[7];
  param_1[7] = (int)piVar2;
  *param_1 = *param_1 + -1;
  return piVar2[1];
}



undefined4 __cdecl FUN_10022b00(int *param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = param_2;
  if (param_2 < 0) {
    iVar3 = -param_2;
  }
  iVar1 = param_1[4];
  if (param_1[7] == 0) {
    iVar4 = FUN_100228c0((int)param_1,(*param_1 * 3 + 10) / 2);
    if (iVar4 < 1) {
      return 0xffffffff;
    }
  }
  piVar2 = (int *)param_1[7];
  param_1[7] = *piVar2;
  piVar2[2] = param_2;
  piVar2[1] = param_3;
  *piVar2 = *(int *)(param_1[5] + (iVar3 % iVar1) * 4);
  *(int **)(param_1[5] + (iVar3 % iVar1) * 4) = piVar2;
  *param_1 = *param_1 + 1;
  return 1;
}



undefined4 __cdecl FUN_10022b70(int param_1,int param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  
  iVar3 = param_2;
  if (param_2 < 0) {
    iVar3 = -param_2;
  }
  puVar1 = *(undefined4 **)(*(int *)(param_1 + 0x14) + (iVar3 % *(int *)(param_1 + 0x10)) * 4);
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 0;
    }
    if (puVar1[2] == param_2) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  uVar2 = puVar1[1];
  puVar1[1] = param_3;
  return uVar2;
}



undefined4 __cdecl FUN_10022bb0(int param_1,int param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = param_2;
  if (param_2 < 0) {
    iVar2 = -param_2;
  }
  puVar1 = *(undefined4 **)(*(int *)(param_1 + 0x14) + (iVar2 % *(int *)(param_1 + 0x10)) * 4);
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 0;
    }
    if (puVar1[2] == param_2) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return puVar1[1];
}



int __cdecl FUN_10022bf0(int *param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = param_2;
  if (param_2 < 0) {
    iVar4 = -param_2;
  }
  piVar1 = (int *)(param_1[5] + (iVar4 % param_1[4]) * 4);
  piVar2 = (int *)*piVar1;
  while( true ) {
    if (piVar2 == (int *)0x0) {
      return 0;
    }
    piVar3 = (int *)*piVar1;
    if (piVar3[2] == param_2) break;
    piVar2 = (int *)*piVar3;
    piVar1 = piVar3;
  }
  *piVar1 = *piVar2;
  if ((int *)param_1[3] == piVar2) {
    param_1[3] = *piVar2;
  }
  *piVar2 = param_1[7];
  param_1[7] = (int)piVar2;
  *param_1 = *param_1 + -1;
  return piVar2[1];
}



void __cdecl FUN_10022c50(int param_1)

{
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  return;
}



undefined4 __cdecl FUN_10022c60(int param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  if (*(int *)(param_1 + 0xc) == 0) {
    if (*(int *)(param_1 + 8) < *(int *)(param_1 + 0x10)) {
      do {
        if (*(int *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8) * 4) != 0) break;
        iVar2 = *(int *)(param_1 + 8) + 1;
        *(int *)(param_1 + 8) = iVar2;
      } while (iVar2 < *(int *)(param_1 + 0x10));
    }
    iVar2 = *(int *)(param_1 + 8);
    if (*(int *)(param_1 + 0x10) <= iVar2) {
      return 0;
    }
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(*(int *)(param_1 + 0x14) + iVar2 * 4);
    *(int *)(param_1 + 8) = iVar2 + 1;
  }
  puVar1 = *(undefined4 **)(param_1 + 0xc);
  *(undefined4 *)(param_1 + 0xc) = *puVar1;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = puVar1[2];
  }
  return puVar1[1];
}



undefined4 * __cdecl FUN_10022cd0(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  
  if (param_1 < 1) {
    param_1 = 1;
  }
  if (param_2 < 0x10) {
    param_2 = 0x10;
  }
  puVar1 = (undefined4 *)_malloc(0x24);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[4] = 0;
  puVar1[5] = 0;
  puVar1[6] = 0;
  puVar1[7] = 0;
  puVar1[8] = 0;
  puVar1[4] = param_2;
  puVar2 = (undefined4 *)_malloc(param_2 * 4);
  puVar1[5] = puVar2;
  for (uVar3 = puVar1[4] & 0x3fffffff; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  puVar1[8] = FUN_10025580;
  if (0 < param_1) {
    FUN_100228c0((int)puVar1,param_1);
  }
  return puVar1;
}



void __fastcall FUN_10022d60(int param_1)

{
  DWORD DVar1;
  
  DVar1 = GetTickCount();
  *(DWORD *)(param_1 + 8) = DVar1;
  *(undefined4 *)(param_1 + 0xc) = 0;
  return;
}



void __fastcall FUN_10022d80(undefined4 *param_1)

{
  void *local_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  puStack_8 = &LAB_1004cf5b;
  local_c = ExceptionList;
  ExceptionList = &local_c;
  *param_1 = &PTR_FUN_10051944;
  local_4 = 0;
  _free((void *)param_1[0xb]);
  local_4 = 0xffffffff;
  FUN_1003dfa0((int)(param_1 + 5));
  ExceptionList = local_c;
  return;
}



void __fastcall FUN_10022de0(int *param_1)

{
  int *piVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  code *pcVar5;
  uint uVar6;
  char cVar7;
  undefined4 *puVar8;
  uint local_c;
  
  piVar1 = param_1 + 5;
  local_c = 0xffffffff;
  puVar8 = (undefined4 *)FUN_1003e050((int)piVar1);
  while (((puVar8 != (undefined4 *)0x0 && ((uint)puVar8[3] <= (uint)param_1[3])) &&
         (((uint)puVar8[3] < (uint)param_1[3] || ((uint)puVar8[2] <= (uint)param_1[2]))))) {
    uVar2 = puVar8[5];
    uVar3 = puVar8[6];
    uVar4 = *puVar8;
    pcVar5 = (code *)puVar8[4];
    FUN_1003e060((int)piVar1);
    (*pcVar5)(uVar4,uVar2,uVar3);
    puVar8 = (undefined4 *)FUN_1003e050((int)piVar1);
  }
  if ((code *)param_1[0xf] != (code *)0x0) {
    (*(code *)param_1[0xf])(param_1[0x10]);
  }
  if (puVar8 != (undefined4 *)0x0) {
    if (((uint)puVar8[3] < (uint)param_1[3]) ||
       (((uint)puVar8[3] <= (uint)param_1[3] && ((uint)puVar8[2] <= (uint)param_1[2])))) {
      local_c = param_1[0x11];
    }
    else {
      local_c = puVar8[2] - param_1[2];
    }
  }
  uVar6 = param_1[0x11];
  if ((uVar6 != 0) && (uVar6 < local_c)) {
    local_c = uVar6;
  }
  cVar7 = (**(code **)(*param_1 + 0x14))(local_c);
  if (cVar7 == '\0') {
    param_1[4] = 0;
  }
  return;
}



void __thiscall FUN_10022ec0(void *this,char param_1)

{
  int iVar1;
  DWORD DVar2;
  
  *(undefined4 *)((int)this + 0x10) = 1;
  DVar2 = GetTickCount();
  *(DWORD *)((int)this + 8) = DVar2;
  *(undefined4 *)((int)this + 0xc) = 0;
  if (param_1 == '\0') {
    iVar1 = *(int *)((int)this + 0x10);
    while (iVar1 != 0) {
      FUN_10022de0((int *)this);
      iVar1 = *(int *)((int)this + 0x10);
    }
  }
  return;
}



void __thiscall FUN_10022f10(void *this,undefined4 param_1,undefined4 param_2)

{
  *(undefined4 *)((int)this + 0x3c) = param_1;
  *(undefined4 *)((int)this + 0x40) = param_2;
  return;
}



void __fastcall FUN_10022f30(int param_1)

{
  *(undefined4 *)(param_1 + 0x10) = 0;
  return;
}



void __thiscall
FUN_100230b0(void *this,uint param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  FUN_1003dfb0((void *)((int)this + 0x14),*(uint *)((int)this + 8),*(int *)((int)this + 0xc),param_1
               ,param_2,param_3,param_4);
  return;
}



void __thiscall FUN_100230e0(void *this,int param_1)

{
  FUN_1003e080((void *)((int)this + 0x14),param_1);
  return;
}



undefined4 __cdecl FUN_100230f0(undefined4 param_1)

{
  undefined4 uVar1;
  
  uVar1 = DAT_10068a5c;
  DAT_10068a5c = param_1;
  return uVar1;
}



undefined4 * __thiscall FUN_10023100(void *this,int param_1,int param_2)

{
  void *pvVar1;
  DWORD DVar2;
  int iVar3;
  undefined4 *puVar4;
  int iVar5;
  int iVar6;
  void *pvStack_c;
  undefined1 *puStack_8;
  undefined4 local_4;
  
  local_4 = 0xffffffff;
  puStack_8 = &LAB_1004cf5b;
  pvStack_c = ExceptionList;
  ExceptionList = &pvStack_c;
  *(undefined ***)this = &PTR_FUN_10051944;
  *(undefined4 *)((int)this + 8) = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x10) = 0;
  FUN_1003e0e0((void *)((int)this + 0x14),param_1);
  local_4 = 0;
  *(int *)((int)this + 0x28) = param_2;
  pvVar1 = operator_new(param_2 * 0x38);
  if (pvVar1 == (void *)0x0) {
    pvVar1 = (void *)0x0;
  }
  else if (-1 < param_2 + -1) {
    puVar4 = (undefined4 *)((int)pvVar1 + 0x34);
    do {
      puVar4[-0xd] = 0xffffffff;
      puVar4[-1] = 0;
      *puVar4 = 0;
      puVar4[-0xc] = 0xffffffff;
      puVar4[-0xb] = 0;
      puVar4[-9] = 0;
      puVar4[-8] = 0;
      puVar4[-7] = 0;
      puVar4[-6] = 0;
      puVar4[-5] = 0;
      puVar4[-4] = 0;
      puVar4[-3] = 0;
      puVar4[-2] = 0;
      puVar4 = puVar4 + 0xe;
      param_2 = param_2 + -1;
    } while (param_2 != 0);
  }
  *(void **)((int)this + 0x2c) = pvVar1;
  *(void **)((int)this + 0x30) = pvVar1;
  *(undefined4 *)((int)this + 0x34) = 0;
  *(undefined4 *)((int)this + 0x38) = 0;
  *(undefined4 *)((int)this + 0x3c) = 0;
  *(undefined4 *)((int)this + 0x40) = 0;
  DVar2 = GetTickCount();
  *(DWORD *)((int)this + 8) = DVar2;
  iVar5 = 0;
  *(undefined4 *)((int)this + 0xc) = 0;
  if (0 < *(int *)((int)this + 0x28)) {
    do {
      if (iVar5 == 0) {
        iVar6 = 0;
      }
      else {
        iVar6 = iVar5 * 0x38 + -0x38 + *(int *)((int)this + 0x2c);
      }
      iVar3 = iVar5 * 0x38;
      *(int *)(*(int *)((int)this + 0x2c) + 0x30 + iVar3) = iVar6;
      if (iVar5 < *(int *)((int)this + 0x28) + -1) {
        iVar6 = *(int *)((int)this + 0x2c) + 0x38 + iVar3;
      }
      else {
        iVar6 = 0;
      }
      *(int *)(*(int *)((int)this + 0x2c) + 0x34 + iVar3) = iVar6;
      iVar5 = iVar5 + 1;
    } while (iVar5 < *(int *)((int)this + 0x28));
  }
  ExceptionList = pvStack_c;
  return (undefined4 *)this;
}



undefined4 * __thiscall FUN_10023220(void *this,byte param_1)

{
  FUN_10022d80((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    _free(this);
  }
  return (undefined4 *)this;
}



undefined4 __thiscall FUN_10023240(void *this,int param_1,byte *param_2,int param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  
  if (*param_2 == 0) {
    return 0x6d697373;
  }
  iVar1 = FUN_10022a40(this,param_1,param_2);
  if (iVar1 == 0) {
    return 0x6e737276;
  }
  iVar2 = FUN_100161d0(iVar1);
  if (*(int *)(iVar2 + 0x18) == 0) {
    return 0x6e737276;
  }
  FUN_100161e0(iVar1,param_3);
  *param_4 = iVar2;
  return 0;
}



void __cdecl FUN_100232a0(int *param_1,byte *param_2,int param_3,undefined4 param_4)

{
  byte *pbVar1;
  char *pcVar2;
  byte *pbVar3;
  undefined4 uVar4;
  byte *pbVar5;
  void *this;
  int iVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  byte *pbVar10;
  char *pcVar11;
  uint uVar12;
  int iVar13;
  byte local_1a0 [32];
  byte local_180 [64];
  byte local_140 [64];
  byte local_100 [256];
  
  pbVar10 = &DAT_1004d26f;
  iVar8 = 0x20;
  pbVar3 = local_1a0;
  pbVar1 = FUN_100020f0(param_2,&DAT_1004df60);
  FUN_10002a30(pbVar1,pbVar3,iVar8,pbVar10);
  pcVar2 = (char *)FUN_10022a40(local_1a0,(int)param_1,local_1a0);
  if (pcVar2 == (char *)0x0) {
    pcVar2 = FUN_10015f20((char *)local_1a0,0x10);
    pcVar11 = pcVar2;
    pbVar3 = (byte *)FUN_10015f90(pcVar2);
    FUN_100229d0(this,param_1,pbVar3,(int)pcVar11);
  }
  iVar8 = 0;
  pbVar3 = FUN_100020f0(param_2,&DAT_1004d240);
  iVar8 = FUN_10002480((char *)pbVar3,iVar8);
  uVar12 = 0;
  pbVar3 = FUN_100020f0(param_2,&DAT_1004db60);
  uVar12 = FUN_10002780(pbVar3,uVar12);
  iVar13 = 0;
  pbVar3 = FUN_100020f0(param_2,(byte *)"IDENT");
  iVar13 = FUN_10002480((char *)pbVar3,iVar13);
  if (iVar8 == 0) {
    iVar8 = FUN_10016200((int)pcVar2,iVar13,uVar12);
    if (-1 < iVar8) {
      FUN_10016250((int)pcVar2,iVar8);
      return;
    }
  }
  else {
    pbVar10 = &DAT_1004d26f;
    iVar9 = 0x40;
    pbVar3 = local_140;
    pbVar1 = FUN_100020f0(param_2,(byte *)"SECRET");
    FUN_10002a30(pbVar1,pbVar3,iVar9,pbVar10);
    pbVar10 = &DAT_1004d26f;
    iVar9 = 0x100;
    pbVar3 = local_100;
    pbVar1 = FUN_100020f0(param_2,(byte *)"CUSTOM");
    FUN_10002a30(pbVar1,pbVar3,iVar9,pbVar10);
    pbVar10 = &DAT_1004d26f;
    iVar9 = 0x40;
    pbVar3 = local_180;
    pbVar1 = FUN_100020f0(param_2,(byte *)"FORMAT");
    FUN_10002a30(pbVar1,pbVar3,iVar9,pbVar10);
    if (param_3 == 0) {
      uVar4 = 0x7f000000;
    }
    else {
      uVar4 = *(undefined4 *)(param_3 + 0xc);
    }
    pbVar3 = local_180;
    pbVar1 = local_100;
    pbVar10 = local_140;
    uVar7 = 0;
    pbVar5 = FUN_100020f0(param_2,(byte *)"FLAGS");
    uVar7 = FUN_100025a0((char *)pbVar5,uVar7);
    iVar9 = 0;
    pbVar5 = FUN_100020f0(param_2,(byte *)"LIMIT");
    iVar9 = FUN_10002480((char *)pbVar5,iVar9);
    iVar6 = 0;
    pbVar5 = FUN_100020f0(param_2,(byte *)"COUNT");
    iVar6 = FUN_10002480((char *)pbVar5,iVar6);
    FUN_10015fa0((int)pcVar2,iVar13,uVar12,iVar8,iVar6,iVar9,uVar7,(char *)pbVar10,uVar4,param_4,
                 (char *)pbVar1,(char *)pbVar3);
  }
  return;
}



void __cdecl FUN_100234a0(int param_1,int param_2,uint param_3)

{
  int iVar1;
  
  FUN_10022c50(param_1);
  iVar1 = FUN_10022c60(param_1,(undefined4 *)0x0);
  while (iVar1 != 0) {
    FUN_10016290(iVar1,param_2,param_3);
    iVar1 = FUN_10022c60(param_1,(undefined4 *)0x0);
  }
  return;
}



void __cdecl FUN_100234e0(undefined4 param_1)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)_malloc(4);
  *puVar1 = 0;
  *puVar1 = param_1;
  return;
}



undefined * FUN_10023500(void)

{
  return &DAT_1005196c;
}



void FUN_10023510(void)

{
  return;
}



void FUN_10023520(void)

{
  FUN_10016450(0x800);
  return;
}



int FUN_10023540(void)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  uint uVar4;
  uint uVar5;
  char *in_stack_00000020;
  char *in_stack_00000028;
  
  FUN_10016490(0x80);
  pcVar3 = in_stack_00000020;
  if (in_stack_00000020 != (char *)0x0) {
    do {
      cVar2 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar2 != '\0');
    uVar4 = (int)pcVar3 - (int)in_stack_00000020;
    pcVar3 = in_stack_00000028 + -1;
    do {
      pcVar1 = pcVar3 + 1;
      pcVar3 = pcVar3 + 1;
    } while (*pcVar1 != '\0');
    for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
      *(undefined4 *)pcVar3 = *(undefined4 *)in_stack_00000020;
      in_stack_00000020 = in_stack_00000020 + 4;
      pcVar3 = pcVar3 + 4;
    }
    for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
      *pcVar3 = *in_stack_00000020;
      in_stack_00000020 = in_stack_00000020 + 1;
      pcVar3 = pcVar3 + 1;
    }
  }
  FUN_10016490(0x80);
  pcVar3 = in_stack_00000028 + 1;
  do {
    cVar2 = *in_stack_00000028;
    in_stack_00000028 = in_stack_00000028 + 1;
  } while (cVar2 != '\0');
  return (int)in_stack_00000028 - (int)pcVar3;
}



int FUN_100235c0(void)

{
  int iVar1;
  int iVar2;
  int in_stack_0000001c;
  int in_stack_00000024;
  int in_stack_00000028;
  
  iVar2 = 0;
  if (in_stack_0000001c != 0) {
    do {
      iVar1 = FUN_10003e20((byte *)(iVar2 + in_stack_00000024),in_stack_00000028 - iVar2,
                           &DAT_10051940);
      iVar2 = iVar2 + iVar1;
      in_stack_0000001c = in_stack_0000001c + -1;
    } while (in_stack_0000001c != 0);
  }
  return iVar2;
}



int __cdecl FUN_10023610(undefined4 param_1,int param_2,undefined4 param_3,char param_4)

{
  if (param_4 != '\0') {
    return 0;
  }
  return (-(uint)(*(int *)(param_2 + 0x94) - *(int *)(param_2 + 0x1dc) != *(int *)(param_2 + 0x9c))
         & 0x9199919c) + 0x6e666e64;
}



undefined1 FUN_10023680(void)

{
  return 1;
}



undefined * __cdecl FUN_10023690(undefined4 param_1,int *param_2,int param_3,byte *param_4)

{
  DAT_10068a60 = 0;
  FUN_10017d30(param_2,param_4,*(undefined4 *)(param_3 + 0x428),&DAT_10068a60,0x84);
  return &DAT_10068a60;
}



int * __thiscall FUN_100236d0(void *this,int param_1,int param_2)

{
  void *pvVar1;
  
  *(int *)((int)this + 4) = param_1;
  *(int *)this = param_2;
  *(undefined4 *)((int)this + 8) = 0;
  pvVar1 = operator_new(param_1 * param_2);
  *(void **)((int)this + 0xc) = pvVar1;
  return (int *)this;
}



void __fastcall FUN_10023700(int param_1)

{
  if (*(void **)(param_1 + 0xc) != (void *)0x0) {
    _free(*(void **)(param_1 + 0xc));
  }
  return;
}



byte * __thiscall FUN_10023710(void *this,byte *param_1)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte *pbVar6;
  bool bVar7;
  
  pbVar6 = *(byte **)((int)this + 0xc);
  iVar2 = 0;
  pbVar3 = param_1;
  pbVar5 = pbVar6;
  if (0 < *(int *)((int)this + 8)) {
LAB_10023728:
    do {
      bVar1 = *pbVar3;
      bVar7 = bVar1 < *pbVar6;
      if (bVar1 == *pbVar6) {
        if (bVar1 != 0) {
          bVar1 = pbVar3[1];
          bVar7 = bVar1 < pbVar6[1];
          if (bVar1 != pbVar6[1]) goto LAB_1002374c;
          pbVar6 = pbVar6 + 2;
          pbVar3 = pbVar3 + 2;
          if (bVar1 != 0) goto LAB_10023728;
        }
        iVar4 = 0;
      }
      else {
LAB_1002374c:
        iVar4 = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
      }
      if (iVar4 == 0) {
        return pbVar5;
      }
                    // WARNING: Load size is inaccurate
      pbVar6 = pbVar5 + *this;
      iVar2 = iVar2 + 1;
      pbVar3 = param_1;
      pbVar5 = pbVar6;
    } while (iVar2 < *(int *)((int)this + 8));
  }
  if (*(int *)((int)this + 8) != *(int *)((int)this + 4)) {
                    // WARNING: Load size is inaccurate
    pbVar6 = (byte *)(*this * *(int *)((int)this + 8) + *(int *)((int)this + 0xc));
    FUN_10005d70((char *)pbVar6,(char *)param_1,*this);
    *(int *)((int)this + 8) = *(int *)((int)this + 8) + 1;
    return pbVar6;
  }
  FUN_10016450(8);
  return (byte *)0x0;
}



void FUN_100237c0(int *param_1,int *param_2)

{
  int *piVar1;
  long lVar2;
  int *_Str;
  char cVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  double dVar8;
  int local_4;
  
  piVar1 = param_1;
  cVar3 = (char)*param_2;
  local_4 = 0;
  if (cVar3 == '\0') {
    *param_1 = 0;
    return;
  }
  piVar4 = param_1 + 1;
  iVar7 = 0x42;
  piVar5 = param_1 + 0x41;
  _Str = param_2;
  do {
    if (cVar3 == ',') break;
    iVar6 = 0;
    param_2 = piVar4;
    if (cVar3 == 'p') {
      *piVar4 = 0;
      _Str = (int *)((int)_Str + 1);
    }
    else if (cVar3 == 'r') {
      *piVar4 = 1;
      lVar2 = _strtol((char *)((int)_Str + 1),(char **)&param_1,10);
      piVar5[0x11] = lVar2;
      _Str = param_1;
      if (lVar2 < 0) {
        piVar5[0x11] = 0;
      }
    }
    else if (cVar3 < '!') {
      _Str = (int *)((int)_Str + 1);
    }
    else {
      *piVar4 = 2;
      if ((char)*_Str == 'f') {
        *(char *)piVar5 = '\x01';
        *(char *)((int)piVar5 + 1) = *(char *)((int)_Str + 1) + -0x30;
        _Str = (int *)((int)_Str + 2);
      }
      else {
        *(char *)piVar5 = '\0';
      }
      cVar3 = (char)*_Str;
      while (cVar3 != '\0') {
        if (cVar3 == ':') goto LAB_10023a11;
        if (cVar3 == ',') break;
        if (cVar3 == '#') {
          piVar1[iVar7 + iVar6] = 0;
          if ((char)*piVar5 == '\0') {
            lVar2 = _strtol((char *)((int)_Str + 1),(char **)&param_1,10);
            piVar1[iVar7 + iVar6 + 0x10] = lVar2;
            _Str = param_1;
          }
          else {
            dVar8 = _strtod((char *)((int)_Str + 1),(char **)&param_1);
            piVar1[iVar7 + iVar6 + 0x10] = (int)(float)dVar8;
            _Str = param_1;
          }
LAB_10023a01:
          iVar6 = iVar6 + 1;
        }
        else {
          if (cVar3 == '+') {
            piVar1[iVar7 + iVar6] = 2;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '-') {
            piVar1[iVar7 + iVar6] = 3;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '*') {
            piVar1[iVar7 + iVar6] = 4;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '/') {
            piVar1[iVar7 + iVar6] = 5;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '&') {
            piVar1[iVar7 + iVar6] = 6;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '|') {
            piVar1[iVar7 + iVar6] = 7;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '^') {
            piVar1[iVar7 + iVar6] = 8;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '~') {
            piVar1[iVar7 + iVar6] = 9;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '>') {
            piVar1[iVar7 + iVar6] = 10;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '<') {
            piVar1[iVar7 + iVar6] = 0xb;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == '(') {
            piVar1[iVar7 + iVar6] = 0xc;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (cVar3 == ')') {
            piVar1[iVar7 + iVar6] = 0xd;
            _Str = (int *)((int)_Str + 1);
            goto LAB_10023a01;
          }
          if (' ' < cVar3) {
            piVar1[iVar7 + iVar6] = 1;
            lVar2 = _strtol((char *)_Str,(char **)&param_1,10);
            piVar1[iVar7 + iVar6 + 0x10] = lVar2;
            _Str = param_1;
            if (lVar2 < 0) {
              piVar1[iVar7 + iVar6 + 0x10] = 0;
            }
            goto LAB_10023a01;
          }
          _Str = (int *)((int)_Str + 1);
        }
        cVar3 = (char)*_Str;
      }
    }
    if ((char)*_Str == ':') {
LAB_10023a11:
      _Str = (int *)((int)_Str + 1);
    }
    piVar5[0x21] = iVar6;
    cVar3 = (char)*_Str;
    local_4 = local_4 + 1;
    piVar4 = param_2 + 1;
    iVar7 = iVar7 + 0x22;
    piVar5 = piVar5 + 0x22;
  } while (cVar3 != '\0');
  *piVar1 = local_4;
  return;
}



undefined1 __thiscall FUN_10023a60(void *this,float *param_1)

{
  int iVar1;
  undefined1 uVar2;
  float fVar3;
  
  fVar3 = *(float *)(*(int *)((int)this + 0x1b218) + 0x44 + *(int *)((int)this + 0x1b21c) * 4);
  uVar2 = 1;
  if ((int)fVar3 < *(int *)((int)this + 0x1b224)) {
    iVar1 = *(int *)((int)this + 0x1b220) + (int)fVar3 * 8;
    switch(*(undefined4 *)(*(int *)((int)this + 0x1b220) + (int)fVar3 * 8)) {
    case 0x62:
      fVar3 = (float)(int)*(char *)(*(int *)((int)this + 0x1b22c) + *(int *)(iVar1 + 4));
      break;
    default:
      fVar3 = 0.0;
      break;
    case 0x6c:
      fVar3 = *(float *)(*(int *)((int)this + 0x1b22c) + *(int *)(iVar1 + 4));
      break;
    case 0x73:
      uVar2 = 0;
      break;
    case 0x77:
      fVar3 = (float)(int)*(short *)(*(int *)((int)this + 0x1b22c) + *(int *)(iVar1 + 4));
    }
  }
  else {
    fVar3 = 0.0;
  }
  if (*(char *)((int)this + 0x1b228) != '\0') {
    *param_1 = fVar3;
    *(int *)((int)this + 0x1b21c) = *(int *)((int)this + 0x1b21c) + 1;
    return uVar2;
  }
  *param_1 = (float)(int)fVar3;
  *(int *)((int)this + 0x1b21c) = *(int *)((int)this + 0x1b21c) + 1;
  return uVar2;
}



void __thiscall FUN_10023b40(void *this,char *param_1,undefined4 param_2,undefined4 param_3)

{
  int *piVar1;
  undefined4 uVar2;
  char cVar3;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  
  piVar1 = (int *)param_1;
  pcVar5 = (char *)0x0;
  if (param_1 != (char *)0x0) {
    *(undefined4 *)((int)this + 0x1d148) = param_2;
    *(undefined4 *)((int)this + 0x1d14c) = param_3;
    *(undefined4 *)((int)this + 0x1b210) = 0;
    cVar3 = *param_1;
    iVar6 = 0;
    param_1 = (char *)0x1f;
    pcVar4 = (char *)this;
    if (cVar3 != '\0') {
      do {
        if (9 < *(int *)((int)this + 0x1b210)) break;
        if (iVar6 == 0) {
          cVar3 = (char)*piVar1;
          if (cVar3 == ':') {
            *pcVar4 = '\0';
            iVar6 = 1;
            pcVar4 = (char *)(*(int *)((int)this + 0x1b210) * 0x2b68 + 0x20 + (int)this);
            param_1 = (char *)0x3f;
            pcVar5 = (char *)0x0;
          }
          else {
LAB_10023c08:
            if (pcVar5 == param_1) {
              *pcVar4 = '\0';
            }
            else {
              *pcVar4 = cVar3;
              pcVar4 = pcVar4 + 1;
              pcVar5 = pcVar5 + 1;
            }
          }
LAB_10023c42:
          piVar1 = (int *)((int)piVar1 + 1);
        }
        else {
          if (iVar6 == 1) {
            cVar3 = (char)*piVar1;
            if (cVar3 != ':') goto LAB_10023c08;
            *pcVar4 = '\0';
            iVar6 = 2;
            goto LAB_10023c42;
          }
          if (iVar6 == 2) {
            piVar1 = (int *)FUN_100237c0((int *)(*(int *)((int)this + 0x1b210) * 0x2b68 + 0x864 +
                                                (int)this),piVar1);
            if ((char)*piVar1 == ',') {
              iVar6 = 0;
              iVar7 = *(int *)((int)this + 0x1b210) + 1;
              pcVar4 = (char *)(iVar7 * 0x2b68 + (int)this);
              *(int *)((int)this + 0x1b210) = iVar7;
              param_1 = (char *)0x1f;
              pcVar5 = (char *)0x0;
            }
            if ((char)*piVar1 != '\0') goto LAB_10023c42;
            break;
          }
        }
      } while ((char)*piVar1 != '\0');
      if (iVar6 == 2) {
        *(int *)((int)this + 0x1b210) = *(int *)((int)this + 0x1b210) + 1;
      }
    }
    iVar6 = 0;
    if (0 < *(int *)((int)this + 0x1b210)) {
      pbVar8 = (byte *)((int)this + 0x20);
      do {
        uVar2 = FUN_10003940(pbVar8,(int)(pbVar8 + 0x40),0x100);
        *(undefined4 *)(pbVar8 + 0x840) = uVar2;
        iVar6 = iVar6 + 1;
        pbVar8 = pbVar8 + 0x2b68;
      } while (iVar6 < *(int *)((int)this + 0x1b210));
    }
  }
  return;
}



void __thiscall
FUN_10023b49(void *this,undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int *in_EAX;
  undefined4 uVar1;
  char cVar2;
  char *pcVar3;
  int unaff_EBX;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  bool in_ZF;
  
  if (!in_ZF) {
    *(undefined4 *)((int)this + 0x1d148) = param_3;
    *(undefined4 *)((int)this + 0x1d14c) = param_4;
    *(int *)((int)this + 0x1b210) = unaff_EBX;
    iVar4 = 0;
    param_2 = 0x1f;
    pcVar3 = (char *)this;
    if ((char)*in_EAX != '\0') {
      do {
        if (9 < *(int *)((int)this + 0x1b210)) break;
        if (iVar4 == 0) {
          cVar2 = (char)*in_EAX;
          if (cVar2 == ':') {
            *pcVar3 = '\0';
            iVar4 = 1;
            pcVar3 = (char *)(*(int *)((int)this + 0x1b210) * 0x2b68 + 0x20 + (int)this);
            param_2 = 0x3f;
            unaff_EBX = 0;
          }
          else {
LAB_10023c08:
            if (unaff_EBX == param_2) {
              *pcVar3 = '\0';
            }
            else {
              *pcVar3 = cVar2;
              pcVar3 = pcVar3 + 1;
              unaff_EBX = unaff_EBX + 1;
            }
          }
LAB_10023c42:
          in_EAX = (int *)((int)in_EAX + 1);
        }
        else {
          if (iVar4 == 1) {
            cVar2 = (char)*in_EAX;
            if (cVar2 != ':') goto LAB_10023c08;
            *pcVar3 = '\0';
            iVar4 = 2;
            goto LAB_10023c42;
          }
          if (iVar4 == 2) {
            in_EAX = (int *)FUN_100237c0((int *)(*(int *)((int)this + 0x1b210) * 0x2b68 + 0x864 +
                                                (int)this),in_EAX);
            if ((char)*in_EAX == ',') {
              iVar4 = 0;
              iVar5 = *(int *)((int)this + 0x1b210) + 1;
              pcVar3 = (char *)(iVar5 * 0x2b68 + (int)this);
              *(int *)((int)this + 0x1b210) = iVar5;
              param_2 = 0x1f;
              unaff_EBX = 0;
            }
            if ((char)*in_EAX != '\0') goto LAB_10023c42;
            break;
          }
        }
      } while ((char)*in_EAX != '\0');
      if (iVar4 == 2) {
        *(int *)((int)this + 0x1b210) = *(int *)((int)this + 0x1b210) + 1;
      }
    }
    iVar4 = 0;
    if (0 < *(int *)((int)this + 0x1b210)) {
      pbVar6 = (byte *)((int)this + 0x20);
      do {
        uVar1 = FUN_10003940(pbVar6,(int)(pbVar6 + 0x40),0x100);
        *(undefined4 *)(pbVar6 + 0x840) = uVar1;
        iVar4 = iVar4 + 1;
        pbVar6 = pbVar6 + 0x2b68;
      } while (iVar4 < *(int *)((int)this + 0x1b210));
    }
  }
  return;
}



int __thiscall FUN_10023ca0(void *this,int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  float *pfVar3;
  byte *pbVar4;
  int local_118;
  char local_110 [8];
  char local_108 [260];
  
  iVar2 = 0;
  local_118 = 0;
  if (0 < *(int *)((int)this + 0x1d144)) {
    pfVar3 = (float *)((int)this + 0x1b348);
    do {
      switch(pfVar3[-1]) {
      case 0.0:
        pbVar4 = &DAT_1005193c;
        break;
      case 1.4013e-45:
        pbVar4 = &DAT_10051940;
        break;
      case 2.8026e-45:
        _sprintf(local_110,"%%.%df");
        _sprintf(local_108,local_110,(double)*pfVar3);
        iVar1 = FUN_10003e20((byte *)(iVar2 + param_1),param_2 - iVar2,&DAT_10051940);
        goto LAB_10023d6c;
      case 4.2039e-45:
        pbVar4 = &DAT_10051940;
        break;
      default:
        goto switchD_10023cdc_caseD_4;
      }
      iVar1 = FUN_10003e20((byte *)(iVar2 + param_1),param_2 - iVar2,pbVar4);
LAB_10023d6c:
      iVar2 = iVar2 + iVar1;
switchD_10023cdc_caseD_4:
      local_118 = local_118 + 1;
      pfVar3 = pfVar3 + 3;
    } while (local_118 < *(int *)((int)this + 0x1d144));
  }
  return iVar2;
}



uint __thiscall FUN_10023db0(void *this,float *param_1)

{
  int iVar1;
  int iVar2;
  float fVar3;
  char cVar4;
  undefined3 extraout_var;
  uint uVar5;
  void *local_4;
  
  uVar5 = *(uint *)((int)this + 0x1b21c);
  iVar1 = *(int *)((int)this + 0x1b218);
  iVar2 = *(int *)(iVar1 + 4 + uVar5 * 4);
  local_4 = this;
  if (iVar2 == 1) {
    cVar4 = FUN_10023a60(this,param_1);
    uVar5 = CONCAT31(extraout_var,cVar4);
    if (cVar4 == '\0') {
LAB_10023ddd:
      return uVar5 & 0xffffff00;
    }
  }
  else {
    if (iVar2 == 0) {
      if (*(char *)((int)this + 0x1b228) != '\0') {
        *param_1 = *(float *)(iVar1 + 0x44 + uVar5 * 4);
        *(int *)((int)this + 0x1b21c) = *(int *)((int)this + 0x1b21c) + 1;
        return CONCAT31((int3)(uVar5 >> 8),1);
      }
      fVar3 = *(float *)(iVar1 + 0x44 + uVar5 * 4);
      *param_1 = fVar3;
      *(int *)((int)this + 0x1b21c) = *(int *)((int)this + 0x1b21c) + 1;
      return CONCAT31((int3)((uint)fVar3 >> 8),1);
    }
    if (iVar2 == 0xc) {
      *(uint *)((int)this + 0x1b21c) = uVar5 + 1;
      uVar5 = FUN_10024110(this,param_1);
      if ((char)uVar5 == '\0') goto LAB_10023ddd;
      uVar5 = *(uint *)((int)this + 0x1b21c);
      if (((int)uVar5 < *(int *)(*(int *)((int)this + 0x1b218) + 0x84)) &&
         (*(int *)(*(int *)((int)this + 0x1b218) + 4 + uVar5 * 4) == 0xd)) {
        *(uint *)((int)this + 0x1b21c) = uVar5 + 1;
        return CONCAT31((int3)(uVar5 + 1 >> 8),1);
      }
    }
    else if ((*(char *)((int)this + 0x1b228) != '\0') && (iVar2 == 9)) {
      *(uint *)((int)this + 0x1b21c) = uVar5 + 1;
      local_4 = (void *)0x0;
      uVar5 = FUN_10023db0(this,(float *)&local_4);
      if ((char)uVar5 == '\0') goto LAB_10023ddd;
      *param_1 = (float)~(uint)local_4;
    }
  }
  return CONCAT31((int3)(uVar5 >> 8),1);
}



undefined4 __thiscall FUN_10023eb0(void *this,float *param_1)

{
  int iVar1;
  int iVar2;
  float *pfVar3;
  uint uVar4;
  undefined3 uVar7;
  float fVar5;
  float *pfVar6;
  void *local_4;
  
  pfVar3 = param_1;
  local_4 = this;
  uVar4 = FUN_10023db0(this,param_1);
  if ((char)uVar4 != '\0') {
    iVar1 = *(int *)((int)this + 0x1b218);
    pfVar6 = *(float **)((int)this + 0x1b21c);
    if (*(int *)(iVar1 + 0x84) <= (int)pfVar6) goto LAB_10024102;
    iVar2 = *(int *)(iVar1 + 4 + (int)pfVar6 * 4);
    if (iVar2 == 5) {
      *(int *)((int)this + 0x1b21c) = (int)pfVar6 + 1;
      if (*(char *)((int)this + 0x1b228) == '\0') {
        local_4 = (void *)0x0;
        uVar4 = FUN_10023eb0(this,(float *)&local_4);
        if ((char)uVar4 != '\0') {
          uVar7 = (undefined3)
                  (CONCAT22((short)(uVar4 >> 0x10),
                            (ushort)((float)local_4 < 0.0) << 8 | (ushort)NAN((float)local_4) << 10
                            | (ushort)((float)local_4 == 0.0) << 0xe) >> 8);
          if (NAN((float)local_4) == ((float)local_4 == 0.0)) {
            *pfVar3 = *pfVar3 / (float)local_4;
            return CONCAT31(uVar7,1);
          }
          *pfVar3 = 0.0;
          return CONCAT31(uVar7,1);
        }
      }
      else {
        param_1 = (float *)0x0;
        uVar4 = FUN_10023eb0(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          if (param_1 != (float *)0x0) {
            fVar5 = *pfVar3;
            *pfVar3 = (float)((int)fVar5 / (int)param_1);
            return CONCAT31((int3)((uint)((int)fVar5 / (int)param_1) >> 8),1);
          }
          *pfVar3 = 0.0;
          return 1;
        }
      }
    }
    else if (iVar2 == 4) {
      *(int *)((int)this + 0x1b21c) = (int)pfVar6 + 1;
      if (*(char *)((int)this + 0x1b228) == '\0') {
        local_4 = (void *)0x0;
        uVar4 = FUN_10023eb0(this,(float *)&local_4);
        if ((char)uVar4 != '\0') {
          *pfVar3 = (float)local_4 * *pfVar3;
          return CONCAT31((int3)(uVar4 >> 8),1);
        }
      }
      else {
        param_1 = (float *)0x0;
        uVar4 = FUN_10023eb0(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          fVar5 = *pfVar3;
          *pfVar3 = (float)((int)fVar5 * (int)param_1);
          return CONCAT31((int3)((uint)((int)fVar5 * (int)param_1) >> 8),1);
        }
      }
    }
    else {
      if (*(char *)((int)this + 0x1b228) == '\0') goto LAB_10024102;
      param_1 = (float *)0x0;
      iVar1 = *(int *)(iVar1 + 4 + (int)pfVar6 * 4);
      if (iVar1 == 6) {
        *(int *)((int)this + 0x1b21c) = (int)pfVar6 + 1;
        uVar4 = FUN_10023eb0(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          *pfVar3 = (float)((uint)*pfVar3 & (uint)param_1);
          return CONCAT31((int3)((uint)param_1 >> 8),1);
        }
      }
      else if (iVar1 == 7) {
        *(int *)((int)this + 0x1b21c) = (int)pfVar6 + 1;
        uVar4 = FUN_10023eb0(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          fVar5 = *pfVar3;
          *pfVar3 = (float)((uint)fVar5 | (uint)param_1);
          return CONCAT31((int3)(((uint)fVar5 | (uint)param_1) >> 8),1);
        }
      }
      else if (iVar1 == 10) {
        *(int *)((int)this + 0x1b21c) = (int)pfVar6 + 1;
        uVar4 = FUN_10023eb0(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          fVar5 = (float)((int)*pfVar3 >> ((byte)param_1 & 0x1f));
          *pfVar3 = fVar5;
          return CONCAT31((int3)((uint)fVar5 >> 8),1);
        }
      }
      else {
        if (iVar1 != 0xb) {
          if (iVar1 == 8) {
            *(int *)((int)this + 0x1b21c) = (int)pfVar6 + 1;
            uVar4 = FUN_10023eb0(this,(float *)&param_1);
            if ((char)uVar4 == '\0') goto LAB_100240f0;
            *pfVar3 = (float)((uint)*pfVar3 ^ (uint)param_1);
            pfVar6 = param_1;
          }
LAB_10024102:
          return CONCAT31((int3)((uint)pfVar6 >> 8),1);
        }
        *(int *)((int)this + 0x1b21c) = (int)pfVar6 + 1;
        uVar4 = FUN_10023eb0(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          fVar5 = (float)((int)*pfVar3 << ((byte)param_1 & 0x1f));
          *pfVar3 = fVar5;
          return CONCAT31((int3)((uint)fVar5 >> 8),1);
        }
      }
    }
  }
LAB_100240f0:
  return uVar4 & 0xffffff00;
}



undefined4 __thiscall FUN_10024110(void *this,float *param_1)

{
  int iVar1;
  float fVar2;
  float *pfVar3;
  uint uVar4;
  void *local_4;
  
  pfVar3 = param_1;
  local_4 = this;
  uVar4 = FUN_10023eb0(this,param_1);
  if ((char)uVar4 != '\0') {
    uVar4 = *(uint *)((int)this + 0x1b21c);
    if (*(int *)(*(int *)((int)this + 0x1b218) + 0x84) <= (int)uVar4) {
LAB_10024213:
      return CONCAT31((int3)(uVar4 >> 8),1);
    }
    iVar1 = *(int *)(*(int *)((int)this + 0x1b218) + 4 + uVar4 * 4);
    if (iVar1 == 2) {
      *(uint *)((int)this + 0x1b21c) = uVar4 + 1;
      if (*(char *)((int)this + 0x1b228) == '\0') {
        local_4 = (void *)0x0;
        uVar4 = FUN_10024110(this,(float *)&local_4);
        if ((char)uVar4 != '\0') {
          *pfVar3 = (float)local_4 + *pfVar3;
          return CONCAT31((int3)(uVar4 >> 8),1);
        }
      }
      else {
        param_1 = (float *)0x0;
        uVar4 = FUN_10024110(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          fVar2 = *pfVar3;
          *pfVar3 = (float)((int)fVar2 + (int)param_1);
          return CONCAT31((int3)((uint)((int)fVar2 + (int)param_1) >> 8),1);
        }
      }
    }
    else {
      if (iVar1 != 3) goto LAB_10024213;
      *(uint *)((int)this + 0x1b21c) = uVar4 + 1;
      if (*(char *)((int)this + 0x1b228) == '\0') {
        local_4 = (void *)0x0;
        uVar4 = FUN_10024110(this,(float *)&local_4);
        if ((char)uVar4 != '\0') {
          *pfVar3 = *pfVar3 - (float)local_4;
          goto LAB_10024213;
        }
      }
      else {
        param_1 = (float *)0x0;
        uVar4 = FUN_10024110(this,(float *)&param_1);
        if ((char)uVar4 != '\0') {
          fVar2 = *pfVar3;
          *pfVar3 = (float)((int)fVar2 - (int)param_1);
          return CONCAT31((int3)((uint)((int)fVar2 - (int)param_1) >> 8),1);
        }
      }
    }
  }
  return uVar4 & 0xffffff00;
}



void __thiscall FUN_10024220(void *this,float param_1)

{
  char *pcVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  void *local_4;
  
  iVar2 = *(int *)((int)this + 0x1b214);
  iVar4 = *(int *)(iVar2 + 4 + (int)param_1 * 4);
  if (iVar4 == 0) {
    *(undefined4 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b344) = 1;
    *(int *)((int)this + (*(int *)((int)this + 0x1d144) + 0x2446) * 0xc) = (int)this + 0x1b230;
    *(int *)((int)this + 0x1d144) = *(int *)((int)this + 0x1d144) + 1;
    return;
  }
  local_4 = this;
  if (iVar4 == 1) {
    if (*(code **)((int)this + 0x1d148) != (code *)0x0) {
      iVar2 = (**(code **)((int)this + 0x1d148))
                        ((int)this + 0x1b230,*(undefined4 *)((int)param_1 * 0x88 + 0x148 + iVar2),
                         *(undefined4 *)((int)this + 0x1d14c));
      if (0 < iVar2) {
        *(undefined4 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b344) = 0;
        *(int *)((int)this + (*(int *)((int)this + 0x1d144) + 0x2446) * 0xc) = iVar2;
        *(int *)((int)this + 0x1d144) = *(int *)((int)this + 0x1d144) + 1;
        return;
      }
    }
    *(undefined4 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b344) = 3;
    *(int *)((int)this + 0x1d144) = *(int *)((int)this + 0x1d144) + 1;
    return;
  }
  if (*(int *)((int)this + 0x1b220) != 0) {
    iVar4 = (int)param_1 * 0x88;
    pcVar1 = (char *)(iVar4 + 0x104 + iVar2);
    *(undefined4 *)((int)this + 0x1b21c) = 0;
    *(char **)((int)this + 0x1b218) = pcVar1;
    if (*pcVar1 != '\0') {
      *(undefined1 *)((int)this + 0x1b228) = 0;
      local_4 = (void *)0x0;
      FUN_10024110(this,(float *)&local_4);
      *(undefined4 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b344) = 2;
      *(void **)((int)this + (*(int *)((int)this + 0x1d144) + 0x2446) * 0xc) = local_4;
      *(undefined1 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b34c) =
           *(undefined1 *)(iVar4 + 0x105 + *(int *)((int)this + 0x1b214));
      *(int *)((int)this + 0x1d144) = *(int *)((int)this + 0x1d144) + 1;
      return;
    }
    *(undefined1 *)((int)this + 0x1b228) = 1;
    param_1 = 0.0;
    uVar3 = FUN_10024110(this,&param_1);
    if ((char)uVar3 != '\0') {
      *(undefined4 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b344) = 0;
      *(float *)((int)this + (*(int *)((int)this + 0x1d144) + 0x2446) * 0xc) = param_1;
      *(int *)((int)this + 0x1d144) = *(int *)((int)this + 0x1d144) + 1;
      return;
    }
    if (*(int *)(*(int *)((int)this + 0x1b220) + (int)param_1 * 8) == 0x73) {
      *(undefined4 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b344) = 1;
      *(int *)((int)this + (*(int *)((int)this + 0x1d144) + 0x2446) * 0xc) =
           *(int *)((int)this + 0x1b340) + 0x1b240 + (int)this;
      iVar2 = FUN_10005ca0((char *)(*(int *)((int)this + 0x1b340) + 0x1b240 + (int)this),
                           0x100 - *(int *)((int)this + 0x1b340),"%s");
      *(int *)((int)this + 0x1b340) = *(int *)((int)this + 0x1b340) + iVar2 + 1;
      *(int *)((int)this + 0x1d144) = *(int *)((int)this + 0x1d144) + 1;
      return;
    }
  }
  *(undefined4 *)((int)this + *(int *)((int)this + 0x1d144) * 0xc + 0x1b344) = 3;
  *(int *)((int)this + 0x1d144) = *(int *)((int)this + 0x1d144) + 1;
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __thiscall FUN_100244d0(void *this,char *param_1,byte *param_2,int param_3)

{
  byte *pbVar1;
  int iVar2;
  float fVar3;
  int *piVar4;
  uint local_2000 [2047];
  undefined4 uStack_4;
  
  uStack_4 = 0x100244da;
  if (0x2000 < param_3) {
    param_3 = 0x2000;
  }
  *(undefined4 *)((int)this + 0x1d144) = 0;
  *(undefined1 *)((int)this + 0x1b240) = 0;
  *(undefined4 *)((int)this + 0x1b340) = 0;
  FUN_10005d70((char *)((int)this + 0x1b230),param_1,0x10);
  iVar2 = 0;
  if (0 < *(int *)((int)this + 0x1b210)) {
    piVar4 = (int *)((int)this + 0x864);
    do {
      fVar3 = 0.0;
      pbVar1 = param_2;
      if ((char)piVar4[-0x219] != '\0') {
        pbVar1 = FUN_100020f0(param_2,(byte *)(piVar4 + -0x219));
      }
      if (pbVar1 == (byte *)0x0) {
        *(undefined4 *)((int)this + 0x1b220) = 0;
        *(undefined4 *)((int)this + 0x1b224) = 0;
      }
      else {
        *(int **)((int)this + 0x1b220) = piVar4 + -0x201;
        *(int *)((int)this + 0x1b224) = piVar4[-1];
        *(uint **)((int)this + 0x1b22c) = local_2000;
        FUN_10002fe0(pbVar1,local_2000,param_3,(byte *)(piVar4 + -0x211));
      }
      *(int **)((int)this + 0x1b214) = piVar4;
      if (0 < *piVar4) {
        do {
          FUN_10024220(this,fVar3);
          fVar3 = (float)((int)fVar3 + 1);
        } while ((int)fVar3 < *piVar4);
      }
      iVar2 = iVar2 + 1;
      piVar4 = piVar4 + 0xada;
    } while (iVar2 < *(int *)((int)this + 0x1b210));
  }
  return;
}



undefined4 * __cdecl FUN_10024600(int param_1)

{
  byte *pbVar1;
  int in_EAX;
  undefined4 *puVar2;
  undefined4 *puVar3;
  byte bVar4;
  int iVar5;
  uint uVar6;
  
  puVar2 = (undefined4 *)_malloc(0x41c);
  puVar3 = puVar2;
  for (iVar5 = 0x107; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  *puVar2 = 1;
  puVar2[1] = in_EAX;
  puVar3 = (undefined4 *)_malloc(in_EAX * 0x50);
  puVar2[2] = puVar3;
  for (uVar6 = (uint)(puVar2[1] * 0x50) >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  puVar2[3] = 1;
  puVar2[4] = param_1;
  puVar3 = (undefined4 *)_malloc(param_1 * 4);
  puVar2[5] = puVar3;
  for (uVar6 = puVar2[4] & 0x3fffffff; uVar6 != 0; uVar6 = uVar6 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  puVar3 = (undefined4 *)((int)puVar2 + 0x1d);
  for (iVar5 = 0x3f; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar3 = 0x27272727;
    puVar3 = puVar3 + 1;
  }
  *(undefined2 *)puVar3 = 0x2727;
  *(undefined1 *)((int)puVar3 + 2) = 0x27;
  uVar6 = 0x41;
  do {
    bVar4 = (byte)uVar6 & 0x1f;
    pbVar1 = (byte *)((int)(puVar2 + 0xf) + uVar6);
    pbVar1[(int)puVar2 + (0x1c - (int)(puVar2 + 0xf))] = bVar4;
    *pbVar1 = bVar4;
    *(byte *)((uVar6 & 0x1f) + 0x11c + (int)puVar2) = (byte)uVar6;
    uVar6 = uVar6 + 1;
  } while ((int)uVar6 < 0x5b);
  puVar2[6] = 0x1b;
  return puVar2;
}



int * __cdecl FUN_100246e0(int *param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  undefined4 *puVar6;
  int *piVar7;
  
  piVar1 = (int *)_malloc(0x41c);
  piVar5 = param_1;
  piVar7 = piVar1;
  for (iVar3 = 0x107; iVar3 != 0; iVar3 = iVar3 + -1) {
    *piVar7 = *piVar5;
    piVar5 = piVar5 + 1;
    piVar7 = piVar7 + 1;
  }
  iVar3 = *param_1;
  *piVar1 = iVar3;
  piVar1[1] = iVar3;
  puVar2 = (undefined4 *)_malloc(iVar3 * 0x50);
  piVar1[2] = (int)puVar2;
  puVar6 = (undefined4 *)param_1[2];
  for (uVar4 = (uint)(piVar1[1] * 0x50) >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = *puVar6;
    puVar6 = puVar6 + 1;
    puVar2 = puVar2 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar2 = *(undefined1 *)puVar6;
    puVar6 = (undefined4 *)((int)puVar6 + 1);
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  iVar3 = param_1[3];
  piVar1[3] = iVar3;
  piVar1[4] = iVar3;
  puVar2 = (undefined4 *)_malloc(iVar3 << 2);
  piVar1[5] = (int)puVar2;
  puVar6 = (undefined4 *)param_1[5];
  for (uVar4 = piVar1[4] & 0x3fffffff; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = *puVar6;
    puVar6 = puVar6 + 1;
    puVar2 = puVar2 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar2 = *(undefined1 *)puVar6;
    puVar6 = (undefined4 *)((int)puVar6 + 1);
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  return piVar1;
}



undefined4 __thiscall FUN_10024770(void *this,byte param_1)

{
  byte bVar1;
  int iVar2;
  int *in_EAX;
  byte *pbVar3;
  ushort uVar4;
  uint uVar5;
  
                    // WARNING: Load size is inaccurate
  bVar1 = *this;
  uVar5 = 0;
  uVar4 = 0;
  pbVar3 = (byte *)this;
  do {
    if (bVar1 == 0) {
      if ((param_1 & 4) == 0) {
        *(char *)(in_EAX[5] + 3 + (uint)uVar4 * 4) = (char)pbVar3 - (char)this;
      }
      *(byte *)(in_EAX[5] + 2 + (uint)uVar4 * 4) = param_1;
      return 0;
    }
    uVar4 = *(ushort *)(in_EAX[2] + ((uint)*pbVar3 + uVar5 * 0x28) * 2);
    if (uVar4 == 0) {
      iVar2 = in_EAX[3];
      if (in_EAX[4] + -2 < iVar2) {
        return 0xfffffffe;
      }
      uVar4 = (ushort)iVar2;
      in_EAX[3] = iVar2 + 1;
      *(ushort *)(in_EAX[2] + ((uint)*pbVar3 + uVar5 * 0x28) * 2) = uVar4;
    }
    if ((pbVar3[1] != 0) && (*(short *)(in_EAX[5] + (uint)uVar4 * 4) == 0)) {
      if (in_EAX[1] + -2 < *in_EAX) {
        return 0xffffffff;
      }
      *(short *)(in_EAX[5] + (uint)uVar4 * 4) = (short)*in_EAX;
      *in_EAX = *in_EAX + 1;
    }
    uVar5 = (uint)*(ushort *)(in_EAX[5] + (uint)uVar4 * 4);
    bVar1 = pbVar3[1];
    pbVar3 = pbVar3 + 1;
  } while( true );
}



void __cdecl FUN_10024830(int param_1,int param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  short *psVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  
  uVar3 = (uint)*(ushort *)
                 (*(int *)(param_1 + 0x14) +
                 (uint)*(ushort *)(*(int *)(param_1 + 8) + (param_5 + param_3 * 0x28) * 2) * 4);
  uVar5 = (uint)*(ushort *)
                 (*(int *)(param_2 + 0x14) +
                 (uint)*(ushort *)(*(int *)(param_2 + 8) + (param_5 + param_4 * 0x28) * 2) * 4);
  if ((uVar3 != 0) && (uVar5 != 0)) {
    iVar4 = 0;
    iVar1 = uVar3 * 0x50;
    do {
      psVar2 = (short *)(iVar1 + *(int *)(param_1 + 8));
      if (*psVar2 == 0) {
        *psVar2 = *(short *)(*(int *)(param_2 + 8) + (iVar4 + uVar5 * 0x28) * 2);
      }
      else {
        FUN_10024830(param_1,param_2,uVar3,uVar5,iVar4);
      }
      iVar4 = iVar4 + 1;
      iVar1 = iVar1 + 2;
    } while (iVar4 < 0x28);
  }
  return;
}



void __cdecl FUN_100248e0(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  iVar3 = 0;
  iVar1 = param_4 * 0x50;
  do {
    uVar2 = (uint)*(ushort *)
                   (*(int *)(param_2 + 0x14) + (uint)*(ushort *)(iVar1 + *(int *)(param_2 + 8)) * 4)
    ;
    if (uVar2 != 0) {
      if (0 < param_3) {
        FUN_10024830(param_1,param_2,param_4,0,iVar3);
      }
      FUN_100248e0(param_1,param_2,param_3 + 1,uVar2);
    }
    iVar3 = iVar3 + 1;
    iVar1 = iVar1 + 2;
  } while (iVar3 < 0x28);
  return;
}



void __fastcall FUN_10024950(undefined4 param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 1;
  if (1 < *param_2) {
    iVar2 = 0x50;
    do {
      iVar3 = 6;
      do {
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + iVar1) == 0) && (*(short *)(iVar3 + -6 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + iVar1) = *(undefined2 *)(iVar3 + -6 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 2 + iVar1) == 0) && (*(short *)(iVar3 + -4 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 2 + iVar1) = *(undefined2 *)(iVar3 + -4 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 4 + iVar1) == 0) && (*(short *)(iVar3 + -2 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 4 + iVar1) = *(undefined2 *)(iVar3 + -2 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 6 + iVar1) == 0) && (*(short *)(iVar3 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 6 + iVar1) = *(undefined2 *)(iVar3 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 8 + iVar1) == 0) && (*(short *)(iVar3 + 2 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 8 + iVar1) = *(undefined2 *)(iVar3 + 2 + iVar1);
        }
        iVar3 = iVar3 + 10;
        iVar2 = iVar2 + 10;
      } while (iVar3 < 0x56);
      iVar4 = iVar4 + 1;
    } while (iVar4 < *param_2);
  }
  return;
}



void __cdecl FUN_10024a20(int param_1,int param_2)

{
  ushort *puVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  
  iVar4 = 0;
  iVar3 = param_2 * 0x50;
  do {
    uVar2 = *(ushort *)(iVar3 + *(int *)(param_1 + 8));
    uVar5 = (uint)*(ushort *)(*(int *)(param_1 + 0x14) + (uint)uVar2 * 4);
    if (uVar5 != 0) {
      FUN_10024a20(param_1,uVar5);
      puVar1 = (ushort *)(*(int *)(param_1 + 8) + (iVar4 + uVar5 * 0x28) * 2);
      if (*puVar1 == 0) {
        *puVar1 = uVar2;
      }
    }
    iVar4 = iVar4 + 1;
    iVar3 = iVar3 + 2;
  } while (iVar4 < 0x28);
  return;
}



void FUN_10024a80(void)

{
  int iVar1;
  int *in_EAX;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  int local_8;
  int local_4;
  
  iVar2 = 0;
  local_4 = 0;
  if (0 < *in_EAX) {
    do {
      pbVar3 = (byte *)(in_EAX + 0x87);
      local_8 = 0x40;
      do {
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(*pbVar3 + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x200] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(pbVar3[1] + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x1ff] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(pbVar3[2] + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x1fe] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(pbVar3[3] + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x1fd] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        pbVar3 = pbVar3 + 4;
        local_8 = local_8 + -1;
      } while (local_8 != 0);
      local_4 = local_4 + 1;
      iVar2 = iVar2 + 0x28;
    } while (local_4 < *in_EAX);
  }
  return;
}



void __fastcall FUN_10024bb0(undefined4 param_1,int param_2)

{
  ushort *puVar1;
  uint uVar2;
  int iVar3;
  short *psVar4;
  int iVar5;
  int iVar6;
  
  iVar6 = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    do {
      puVar1 = (ushort *)(*(int *)(param_2 + 0x14) + iVar6 * 4);
      uVar2 = (uint)*puVar1;
      if ((uVar2 != 0) && (*(char *)((int)puVar1 + 3) == '\0')) {
        iVar3 = uVar2 * 0x50 + 0x36;
        iVar5 = 0xd;
        do {
          psVar4 = (short *)(*(int *)(param_2 + 8) + iVar3);
          if (*psVar4 == 0) {
            *psVar4 = (short)iVar6;
          }
          iVar3 = iVar3 + 2;
          iVar5 = iVar5 + -1;
        } while (iVar5 != 0);
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < *(int *)(param_2 + 0xc));
  }
  return;
}



void FUN_10024c10(void)

{
  byte *in_EAX;
  byte bVar1;
  uint uVar2;
  uint uVar3;
  undefined1 *unaff_ESI;
  
  *unaff_ESI = 0;
  bVar1 = *in_EAX;
  if (0x1f < bVar1) {
    while (bVar1 != 0x24) {
      if (0x20 < bVar1) goto LAB_10024c8f;
      bVar1 = in_EAX[1];
      in_EAX = in_EAX + 1;
      if (bVar1 < 0x20) {
        return;
      }
    }
    if ((0x20 < in_EAX[1]) && (0x20 < in_EAX[2])) {
      uVar3 = 0x100;
      do {
        in_EAX = in_EAX + 1;
        bVar1 = *in_EAX;
        if ((bVar1 < 0x30) || (0x39 < bVar1)) {
          if ((bVar1 < 0x61) || (0x66 < bVar1)) {
            if ((bVar1 < 0x41) || (0x46 < bVar1)) goto LAB_10024c92;
            uVar2 = bVar1 - 0x37;
          }
          else {
            uVar2 = bVar1 - 0x57;
          }
          uVar3 = uVar3 << 4 | uVar2;
        }
        else {
          uVar3 = bVar1 & 0xf | uVar3 << 4;
        }
        if (0xffff < (int)uVar3) {
          *unaff_ESI = (char)uVar3;
          return;
        }
      } while( true );
    }
LAB_10024c8f:
    uVar3 = (uint)*in_EAX;
LAB_10024c92:
    *unaff_ESI = (char)uVar3;
  }
  return;
}



void __cdecl FUN_10024ca0(void *param_1)

{
  void *_Memory;
  
  _Memory = *(void **)((int)param_1 + 0x108);
  if (_Memory != (void *)0x0) {
    _free(*(void **)((int)_Memory + 8));
    _free(*(void **)((int)_Memory + 0x14));
    _free(_Memory);
  }
  _free(param_1);
  return;
}



void __cdecl FUN_10024ce0(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  int iVar2;
  
  iVar2 = 0;
  if (*param_2 < 0x20) {
    *param_1 = 0;
    param_1[1] = 0;
    return;
  }
  do {
    if (0xfe < iVar2) break;
    if (*param_2 != 0x20) {
      *(byte *)(iVar2 + 8 + (int)param_1) = *param_2;
      iVar2 = iVar2 + 1;
    }
    pbVar1 = param_2 + 1;
    param_2 = param_2 + 1;
  } while (0x1f < *pbVar1);
  *param_1 = 0;
  param_1[1] = iVar2;
  return;
}



int __cdecl FUN_10024d30(undefined4 *param_1,byte *param_2)

{
  byte bVar1;
  void *_Memory;
  int *_Memory_00;
  char *pcVar2;
  char *pcVar3;
  int *piVar4;
  int iVar5;
  byte *pbVar6;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  uint uVar7;
  byte *pbVar8;
  int iVar9;
  int *piVar10;
  byte *pbVar11;
  byte bVar12;
  int local_104;
  byte local_100 [256];
  
  local_104 = 0;
  if (param_2 == (byte *)0x0) {
    param_2 = PTR_s_ass_ass___bitch_cunt_dildo_fuck_j_1005717c;
  }
  _Memory_00 = FUN_10024600(0x4000);
  piVar4 = &DAT_10051ad0;
  piVar10 = _Memory_00 + 199;
  for (iVar5 = 0x40; iVar5 != 0; iVar5 = iVar5 + -1) {
    *piVar10 = *piVar4;
    piVar4 = piVar4 + 1;
    piVar10 = piVar10 + 1;
  }
  pcVar2 = _strstr((char *)param_2,"~repl:");
  if (pcVar2 != (char *)0x0) {
    FUN_10024ce0(param_1,(byte *)(pcVar2 + 6));
  }
  bVar12 = *PTR_DAT_10057174;
  pbVar6 = PTR_DAT_10057174;
  while (bVar12 != 0) {
    bVar12 = pbVar6[1];
    bVar1 = *pbVar6;
    uVar7 = (uint)bVar12;
    if (*(char *)(uVar7 + 0x1c + (int)_Memory_00) == '\'') {
      *(undefined1 *)((int)_Memory_00 + uVar7 + 0x1c) =
           *(undefined1 *)(bVar1 + 0x1c + (int)_Memory_00);
      if (bVar1 == bVar12) {
        *(char *)(bVar1 + 0x1c + (int)_Memory_00) = (char)_Memory_00[6];
        *(byte *)(_Memory_00[6] + 0x11c + (int)_Memory_00) = bVar1;
        _Memory_00[6] = _Memory_00[6] + 1;
      }
    }
    pbVar6 = pbVar6 + 2;
    *(byte *)((int)_Memory_00 + uVar7 + 0x21c) = bVar1;
    bVar12 = *pbVar6;
  }
  pcVar2 = _strstr((char *)param_2,"~equiv:");
  pcVar3 = PTR_DAT_10057178;
  if (pcVar2 != (char *)0x0) goto LAB_10024e20;
  while (pcVar2 = pcVar3, pcVar2 != (char *)0x0) {
LAB_10024e20:
    pbVar6 = (byte *)(pcVar2 + 7);
    bVar12 = pcVar2[7];
    while (0x1f < bVar12) {
      FUN_10024c10();
      pbVar6 = (byte *)FUN_10024c10();
      if ((0x20 < local_100[0]) && (0x20 < local_100[1])) {
        uVar7 = (uint)local_100[1];
        if (*(char *)(uVar7 + 0x1c + (int)_Memory_00) == '\'') {
          *(undefined1 *)(uVar7 + 0x1c + (int)_Memory_00) =
               *(undefined1 *)(local_100[0] + 0x1c + (int)_Memory_00);
          if (local_100[0] == local_100[1]) {
            *(char *)(local_100[0] + 0x1c + (int)_Memory_00) = (char)_Memory_00[6];
            *(byte *)(_Memory_00[6] + 0x11c + (int)_Memory_00) = local_100[0];
            _Memory_00[6] = _Memory_00[6] + 1;
          }
        }
        *(byte *)(uVar7 + 0x21c + (int)_Memory_00) = local_100[0];
        *(undefined1 *)(local_100[1] + 0x31c + (int)_Memory_00) =
             *(undefined1 *)(local_100[0] + 0x31c + (int)_Memory_00);
      }
      bVar12 = *pbVar6;
    }
    pcVar3 = _strstr((char *)pbVar6,"~equiv:");
  }
  bVar12 = *param_2;
  pbVar6 = param_2;
  while (bVar12 != 0) {
    bVar12 = *pbVar6;
    if (bVar12 < 0x21) {
      pbVar11 = pbVar6 + 1;
    }
    else {
      pbVar11 = pbVar6;
      if ((bVar12 == 0x23) || (bVar12 == 0x7e)) {
        do {
          pbVar6 = pbVar11 + 1;
          pbVar11 = pbVar11 + 1;
        } while (0x1f < *pbVar6);
      }
      else {
        bVar12 = bVar12 == 0x2a;
        if ((bool)bVar12) {
          pbVar6 = pbVar6 + 1;
        }
        bVar1 = *pbVar6;
        pbVar11 = pbVar6;
        while ((((0x20 < bVar1 && (bVar1 != 0x2a)) && (bVar1 != 0x2e)) && (bVar1 != 0x5e))) {
          pbVar8 = pbVar11 + 1;
          pbVar11 = pbVar11 + 1;
          bVar1 = *pbVar8;
        }
        if ((int)pbVar11 - (int)pbVar6 < 0x100) {
          pbVar8 = local_100;
          while (pbVar6 < pbVar11) {
            pbVar6 = (byte *)FUN_10024c10();
            *pbVar8 = *(byte *)(*pbVar8 + 0x1c + (int)_Memory_00);
            pbVar8 = pbVar8 + 1;
          }
          bVar1 = *pbVar11;
          *pbVar8 = 0;
          if (bVar1 == 0x2a) {
            bVar12 = bVar12 | 2;
            pbVar11 = pbVar11 + 1;
          }
          if (*pbVar11 == 0x5e) {
            bVar12 = bVar12 | 8;
            pbVar11 = pbVar11 + 1;
          }
          if (*pbVar11 == 0x2e) {
            pbVar11 = pbVar11 + 1;
          }
          else {
            iVar5 = FUN_10024770(local_100,bVar12);
            if (iVar5 < 0) break;
            local_104 = local_104 + 1;
          }
        }
      }
    }
    pbVar6 = pbVar11;
    bVar12 = *pbVar11;
  }
  bVar12 = *param_2;
  while (bVar12 != 0) {
    bVar12 = *param_2;
    if (bVar12 < 0x21) {
      pbVar6 = param_2 + 1;
    }
    else {
      pbVar6 = param_2;
      if ((bVar12 == 0x23) || (bVar12 == 0x7e)) {
        do {
          pbVar11 = pbVar6 + 1;
          pbVar6 = pbVar6 + 1;
        } while (0x1f < *pbVar11);
      }
      else {
        bVar12 = bVar12 == 0x2a;
        if ((bool)bVar12) {
          param_2 = param_2 + 1;
        }
        bVar1 = *param_2;
        pbVar6 = param_2;
        while (((0x20 < bVar1 && (bVar1 != 0x2a)) && ((bVar1 != 0x2e && (bVar1 != 0x5e))))) {
          pbVar11 = pbVar6 + 1;
          pbVar6 = pbVar6 + 1;
          bVar1 = *pbVar11;
        }
        if ((int)pbVar6 - (int)param_2 < 0x100) {
          pbVar11 = local_100;
          while (param_2 < pbVar6) {
            param_2 = (byte *)FUN_10024c10();
            *pbVar11 = *(byte *)(*pbVar11 + 0x1c + (int)_Memory_00);
            pbVar11 = pbVar11 + 1;
          }
          bVar1 = *pbVar6;
          *pbVar11 = 0;
          if (bVar1 == 0x2a) {
            bVar12 = bVar12 | 2;
            pbVar6 = pbVar6 + 1;
          }
          if (*pbVar6 == 0x5e) {
            bVar12 = bVar12 | 8;
            pbVar6 = pbVar6 + 1;
          }
          if (*pbVar6 == 0x2e) {
            pbVar6 = pbVar6 + 1;
            iVar5 = FUN_10024770(local_100,bVar12 | 4);
            if (iVar5 < 0) break;
          }
        }
      }
    }
    param_2 = pbVar6;
    bVar12 = *pbVar6;
  }
  _Memory = (void *)param_1[0x42];
  if (_Memory != (void *)0x0) {
    _free(*(void **)((int)_Memory + 8));
    _free(*(void **)((int)_Memory + 0x14));
    _free(_Memory);
  }
  piVar4 = FUN_100246e0(_Memory_00);
  param_1[0x42] = piVar4;
  FUN_10024a20((int)piVar4,0);
  FUN_10024a80();
  iVar5 = param_1[0x42];
  iVar9 = 0;
  do {
    uVar7 = (uint)*(ushort *)(_Memory_00[5] + (uint)*(ushort *)(iVar9 + _Memory_00[2]) * 4);
    if (uVar7 != 0) {
      FUN_100248e0(iVar5,(int)_Memory_00,1,uVar7);
    }
    iVar9 = iVar9 + 2;
  } while (iVar9 < 0x50);
  _free((void *)_Memory_00[2]);
  _free((void *)_Memory_00[5]);
  _free(_Memory_00);
  FUN_10024950(extraout_ECX,(int *)param_1[0x42]);
  FUN_10024bb0(extraout_ECX_00,param_1[0x42]);
  return local_104;
}



uint __cdecl FUN_10025120(int *param_1,byte *param_2)

{
  byte *pbVar1;
  ushort *puVar2;
  int iVar3;
  char cVar4;
  byte bVar5;
  ushort uVar6;
  int iVar7;
  byte bVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  byte bVar13;
  uint uVar14;
  uint uVar15;
  int iVar16;
  byte *pbVar17;
  uint local_28;
  byte abStack_20 [32];
  
  uVar15 = 0;
  local_28 = 0;
  if (param_1 == (int *)0x0) {
    return 0;
  }
  if ((param_2 == (byte *)0x0) || (*param_2 == 0)) {
    return 0;
  }
  iVar7 = param_1[0x42];
  uVar9 = 0;
  if (iVar7 != 0) {
    bVar8 = *(byte *)(*param_2 + 0x1c + iVar7);
    uVar12 = uVar9;
    uVar9 = local_28;
    while (bVar8 != 0) {
      iVar16 = uVar12 * 0x28;
      uVar10 = (uint)*(ushort *)(*(int *)(iVar7 + 8) + ((uint)bVar8 + iVar16) * 2);
      puVar2 = (ushort *)(*(int *)(iVar7 + 0x14) + uVar10 * 4);
      uVar14 = (uint)*(byte *)((int)puVar2 + 3);
      uVar11 = uVar15 & 0x1f;
      uVar15 = uVar15 + 1;
      abStack_20[uVar11] = uVar12 != *puVar2;
      local_28 = uVar9;
      uVar12 = uVar15;
      if (uVar14 != 0) {
        while (0 < (int)uVar12) {
          if ((int)uVar14 < 1) {
            if ((0 < (int)uVar12) && (*(char *)(param_2[uVar12 - 1] + 0x31c + iVar7) == '\0')) {
              cVar4 = *(char *)(param_2[uVar12] + 0x1c + iVar7);
              uVar14 = uVar12;
              if (*(char *)(param_2[uVar12 + 1] + 0x1c + iVar7) == cVar4) {
                do {
                  iVar3 = uVar14 + 2;
                  uVar14 = uVar14 + 1;
                } while (*(char *)(param_1[0x42] + 0x1c + (uint)param_2[iVar3]) == cVar4);
              }
              while (((int)uVar14 < (int)uVar15 &&
                     (*(char *)(param_2[uVar14 + 1] + 0x31c + iVar7) != '\0'))) {
                uVar14 = uVar14 + 1;
              }
              if (*(char *)(param_2[uVar14 + 1] + 0x1c + iVar7) == cVar4) {
                uVar12 = uVar14 + 1;
              }
            }
            break;
          }
          uVar14 = uVar14 - abStack_20[uVar12 - 1 & 0x1f];
          uVar12 = uVar12 - 1;
        }
        bVar8 = *(byte *)(param_2[uVar15] + 0x1c + iVar7);
        uVar14 = uVar15;
        if (*(ushort *)(*(int *)(iVar7 + 8) + ((uint)bVar8 + iVar16) * 2) == uVar10) {
          do {
            iVar3 = uVar14 + 1;
            uVar14 = uVar14 + 1;
          } while (*(ushort *)
                    (*(int *)(param_1[0x42] + 8) +
                    ((uint)*(byte *)(param_2[iVar3] + 0x1c + param_1[0x42]) + iVar16) * 2) == uVar10
                  );
        }
        bVar13 = *(byte *)(*(int *)(iVar7 + 0x14) + 2 + uVar10 * 4);
        if ((uVar12 == 0) || (*(char *)(param_2[uVar12 - 1] + 0x31c + iVar7) != '\0')) {
          bVar13 = bVar13 | 0x10;
        }
        bVar5 = param_2[uVar14];
        if ((bVar5 == 0) || (*(char *)(iVar7 + 0x31c + (uint)bVar5) != '\0')) {
          bVar13 = bVar13 | 0x20;
        }
        if ((bVar13 & 8) != 0) {
          if ((bVar13 & 0x30) == 0x10) {
            bVar13 = bVar13 | 2;
          }
          if ((bVar13 & 0x30) == 0x20) {
            bVar13 = bVar13 | 1;
          }
        }
        if ((bVar13 & 1) != 0) {
          while ((0 < (int)uVar12 && (*(char *)(iVar7 + 0x31c + (uint)param_2[uVar12 - 1]) == '\0'))
                ) {
            uVar12 = uVar12 - 1;
          }
        }
        if ((bVar13 & 2) != 0) {
          while ((bVar5 != 0 && (*(char *)(bVar5 + 0x31c + iVar7) == '\0'))) {
            bVar5 = param_2[uVar14 + 1];
            uVar14 = uVar14 + 1;
          }
        }
        if (((bVar13 & 0x11) != 0) && ((bVar13 & 0x22) != 0)) {
          uVar6 = *(ushort *)(*(int *)(iVar7 + 0x14) + uVar10 * 4);
          if (bVar8 != 0) {
            pbVar17 = param_2 + uVar15;
            do {
              uVar11 = (uint)*(ushort *)
                              (*(int *)(iVar7 + 8) + ((uint)bVar8 + (uint)uVar6 * 0x28) * 2);
              if (uVar11 < uVar10) break;
              if ((*(byte *)(*(int *)(iVar7 + 0x14) + 2 + uVar11 * 4) & 4) != 0) {
                if (uVar11 != 0xffffffff) goto LAB_10025481;
                break;
              }
              uVar6 = *(ushort *)(*(int *)(iVar7 + 0x14) + uVar11 * 4);
              pbVar1 = pbVar17 + 1;
              pbVar17 = pbVar17 + 1;
              bVar8 = *(byte *)(*pbVar1 + 0x1c + param_1[0x42]);
            } while (bVar8 != 0);
          }
          if (*(char *)(param_2[uVar12] + 0x31c + iVar7) != '\0') {
            do {
              iVar16 = uVar12 + 1;
              uVar12 = uVar12 + 1;
            } while (*(char *)(param_2[iVar16] + 0x31c + param_1[0x42]) != '\0');
          }
          if (*(char *)(param_2[uVar14 - 1] + 0x31c + iVar7) != '\0') {
            do {
              iVar7 = uVar14 - 2;
              uVar14 = uVar14 - 1;
            } while (*(char *)(param_2[iVar7] + 0x31c + param_1[0x42]) != '\0');
          }
          for (; (int)uVar12 < (int)uVar14; uVar12 = uVar12 + 1) {
            iVar7 = *param_1;
            *param_1 = iVar7 + 1;
            param_2[uVar12] = *(byte *)((iVar7 + 1) % param_1[1] + 8 + (int)param_1);
          }
          for (; (int)uVar15 < (int)uVar14; uVar15 = uVar15 + 1) {
            abStack_20[uVar15 & 0x1f] = 0;
          }
          local_28 = uVar9 + 1;
        }
      }
LAB_10025481:
      iVar7 = param_1[0x42];
      uVar12 = (uint)*(ushort *)(*(int *)(iVar7 + 0x14) + uVar10 * 4);
      uVar9 = local_28;
      bVar8 = *(byte *)(param_2[uVar15] + 0x1c + iVar7);
    }
  }
  return uVar9;
}



int __cdecl FUN_100254c0(undefined4 param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  bVar1 = *param_2;
  iVar3 = 0;
  pbVar5 = param_2;
  while ((bVar1 != 0 && (iVar2 = _isspace((uint)*pbVar5), iVar2 != 0))) {
    bVar1 = pbVar5[1];
    iVar3 = iVar3 + 1;
    pbVar5 = pbVar5 + 1;
  }
  bVar1 = *pbVar5;
  pbVar4 = param_2;
  if (bVar1 != 0) {
    do {
      if ((((bVar1 == 0x20) && (param_2 + 3 < pbVar4)) && (pbVar4[-1] == 0x20)) &&
         ((pbVar4[-2] == 0x20 && (pbVar4[-3] == 0x20)))) {
        iVar3 = iVar3 + 1;
      }
      else {
        *pbVar4 = bVar1;
        pbVar4 = pbVar4 + 1;
      }
      bVar1 = pbVar5[1];
      pbVar5 = pbVar5 + 1;
    } while (bVar1 != 0);
    while ((pbVar4 != param_2 && (iVar2 = _isspace((uint)pbVar4[-1]), iVar2 != 0))) {
      iVar3 = iVar3 + 1;
      pbVar4 = pbVar4 + -1;
    }
  }
  *pbVar4 = 0;
  return iVar3;
}



undefined4 * FUN_10025550(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0x10c);
  puVar3 = puVar1;
  for (iVar2 = 0x43; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  FUN_10024ce0(puVar1,&DAT_10051be0);
  return puVar1;
}



int __cdecl FUN_10025580(char *param_1,char *param_2)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  
  while( true ) {
    do {
      bVar1 = (&DAT_10051be8)[*param_1];
      param_1 = param_1 + 1;
    } while (bVar1 == 1);
    do {
      cVar2 = *param_2;
      param_2 = param_2 + 1;
    } while ((&DAT_10051be8)[cVar2] == 1);
    iVar3 = (uint)bVar1 - (uint)(byte)(&DAT_10051be8)[cVar2];
    if (iVar3 != 0) break;
    if (bVar1 == 0) {
      return 0;
    }
  }
  return iVar3;
}



undefined4 __cdecl FUN_100255d0(char *param_1,char *param_2)

{
  char cVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  if ((param_2 == (char *)0x0) || (*param_2 == '\0')) {
    return 1;
  }
  if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
    iVar4 = 0;
    do {
      iVar3 = 0;
      iVar5 = iVar4;
      do {
        do {
          cVar1 = (&DAT_10051be8)[param_1[iVar5]];
          iVar5 = iVar5 + 1;
        } while (cVar1 == '\x01');
        do {
          cVar2 = (&DAT_10051be8)[param_2[iVar3]];
          iVar3 = iVar3 + 1;
        } while (cVar2 == '\x01');
        if (cVar2 == '\0') {
          return 1;
        }
      } while ((cVar1 != '\0') && (cVar1 == cVar2));
      iVar5 = iVar4 + 1;
      iVar4 = iVar4 + 1;
      if (param_1[iVar5] == '\0') {
        return 0;
      }
    } while( true );
  }
  return 0;
}



undefined4 * __cdecl FUN_10025650(int param_1)

{
  undefined4 *puVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int iVar4;
  
  puVar1 = (undefined4 *)_malloc(0xf0);
  puVar3 = (undefined4 *)0x0;
  if (puVar1 != (undefined4 *)0x0) {
    puVar3 = puVar1;
    for (iVar4 = 0x3c; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
    puVar1[8] = param_1;
    pvVar2 = _malloc(param_1 * 4);
    puVar1[0x39] = pvVar2;
    puVar3 = FUN_10025f60(param_1,param_1 * 2,0,0);
    puVar1[0x3a] = puVar3;
    puVar3 = puVar1;
  }
  return puVar3;
}



void __cdecl FUN_100256b0(void *param_1)

{
  if (param_1 != (void *)0x0) {
    if (*(void **)((int)param_1 + 0xe4) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0xe4));
    }
    if (*(void **)((int)param_1 + 0xe8) != (void *)0x0) {
      FUN_10026000(*(void **)((int)param_1 + 0xe8));
    }
    if (*(int **)((int)param_1 + 0xec) != (int *)0x0) {
      FUN_1003e170(*(int **)((int)param_1 + 0xec));
    }
    _free(param_1);
  }
  return;
}



void __cdecl FUN_10025700(int param_1,int *param_2)

{
  int iVar1;
  
  iVar1 = FUN_100262c0(*(int *)(param_1 + 0xe8));
  if (iVar1 < *(int *)(param_1 + 0x20)) {
    *(int **)(*(int *)(param_1 + 0xe4) + iVar1 * 4) = param_2;
    FUN_10026030(*(int **)(param_1 + 0xe8),*param_2,param_2);
  }
  return;
}



undefined1 __cdecl FUN_10025740(int param_1,int *param_2)

{
  int *piVar1;
  void *_Dst;
  int iVar2;
  undefined1 uVar3;
  int iVar4;
  
  uVar3 = 0;
  FUN_100261a0(*(int *)(param_1 + 0xe8),*param_2);
  iVar2 = FUN_100262c0(*(int *)(param_1 + 0xe8));
  iVar4 = 0;
  if (-1 < iVar2) {
    do {
      piVar1 = (int *)(*(int *)(param_1 + 0xe4) + iVar4 * 4);
      if ((int *)*piVar1 == param_2) {
        if (iVar4 == iVar2) {
          *piVar1 = 0;
        }
        else {
          _Dst = (void *)(*(int *)(param_1 + 0xe4) + iVar4 * 4);
          _memmove(_Dst,(void *)((int)_Dst + 4),(iVar2 - iVar4) * 4);
          *(undefined4 *)(*(int *)(param_1 + 0xe4) + iVar2 * 4) = 0;
        }
        uVar3 = 1;
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 <= iVar2);
  }
  return uVar3;
}



void __cdecl FUN_100257e0(int *param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int local_8;
  
  piVar2 = param_1;
  iVar3 = FUN_100262c0(param_1[0x3a]);
  param_1 = (int *)0x0;
  if (0 < iVar3) {
    do {
      FUN_100261a0(piVar2[0x3a],**(int **)(piVar2[0x39] + (int)param_1 * 4));
      piVar1 = *(int **)(piVar2[0x39] + (int)param_1 * 4);
      piVar4 = piVar1 + 0xcb;
      piVar5 = piVar1 + 199;
      local_8 = 4;
      do {
        if (*piVar5 == *piVar2) {
          *piVar5 = 0;
          *(undefined1 *)piVar4 = 0;
          piVar1[1] = piVar1[1] + 1;
          FUN_100260e0(param_2,*piVar1);
        }
        piVar5 = piVar5 + 1;
        piVar4 = piVar4 + 9;
        local_8 = local_8 + -1;
      } while (local_8 != 0);
      *(undefined4 *)(piVar2[0x39] + (int)param_1 * 4) = 0;
      param_1 = (int *)((int)param_1 + 1);
    } while ((int)param_1 < iVar3);
  }
  return;
}



void __cdecl FUN_100258c0(int param_1,undefined4 *param_2)

{
  int iVar1;
  int *piVar2;
  
  iVar1 = 0;
  piVar2 = (int *)(param_1 + 0x31c);
  do {
    if (*piVar2 == 0) {
      *(undefined4 *)(param_1 + 0x31c + iVar1 * 4) = *param_2;
      *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + 1;
      return;
    }
    iVar1 = iVar1 + 1;
    piVar2 = piVar2 + 1;
  } while (iVar1 < 4);
  return;
}



void __cdecl FUN_100258f0(int param_1,int param_2,int *param_3,char param_4)

{
  int iVar1;
  bool bVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *local_4;
  
  local_4 = (int *)0x0;
  do {
    iVar5 = *(int *)(param_2 + (int)local_4 * 4);
    if (iVar5 == 0) break;
    bVar2 = false;
    iVar7 = 0;
    piVar3 = param_3 + 199;
    do {
      if (bVar2) goto LAB_10025964;
      if (*piVar3 == 0) goto LAB_1002593d;
      if (iVar5 == *piVar3) {
        bVar2 = true;
      }
      iVar7 = iVar7 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar7 < 4);
    if (!bVar2) {
LAB_1002593d:
      piVar3 = (int *)FUN_10026280(param_1,iVar5);
      if (piVar3 != (int *)0x0) {
        FUN_10025740((int)piVar3,param_3);
        FUN_100260e0(param_1,*piVar3);
      }
    }
LAB_10025964:
    local_4 = (int *)((int)local_4 + 1);
  } while ((int)local_4 < 4);
  local_4 = param_3 + 0xcb;
  piVar3 = local_4;
  for (iVar5 = 0x24; iVar5 != 0; iVar5 = iVar5 + -1) {
    *piVar3 = 0;
    piVar3 = piVar3 + 1;
  }
  iVar5 = 0;
  piVar3 = param_3 + 199;
  do {
    iVar7 = *piVar3;
    if (iVar7 == 0) break;
    bVar2 = false;
    iVar6 = 0;
    do {
      if ((bVar2) || (iVar1 = *(int *)(param_2 + iVar6 * 4), iVar1 == 0)) break;
      if (iVar1 == iVar7) {
        bVar2 = true;
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < 4);
    piVar4 = (int *)FUN_10026280(param_1,iVar7);
    if (piVar4 != (int *)0x0) {
      if (!bVar2) {
        iVar7 = FUN_100262c0(piVar4[0x3a]);
        if (iVar7 < piVar4[8]) {
          *(int **)(piVar4[0x39] + iVar7 * 4) = param_3;
          FUN_10026030((int *)piVar4[0x3a],*param_3,param_3);
        }
        FUN_100260e0(param_1,*piVar4);
      }
      FUN_10005d70((char *)local_4,(char *)(piVar4 + 9),0x24);
    }
    iVar5 = iVar5 + 1;
    local_4 = local_4 + 9;
    piVar3 = piVar3 + 1;
  } while (iVar5 < 4);
  if (param_4 != '\0') {
    iVar5 = 0;
    piVar3 = param_3 + 199;
    do {
      if (*piVar3 == 0) {
        return;
      }
      iVar7 = FUN_10026280(param_1,*piVar3);
      if (iVar7 != 0) {
        FUN_100260e0(*(int *)(iVar7 + 0xe8),*param_3);
      }
      iVar5 = iVar5 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar5 < 4);
  }
  return;
}



void __cdecl FUN_10025aa0(byte *param_1,size_t param_2,int param_3)

{
  FUN_100262c0(*(int *)(param_3 + 0xe8));
  FUN_10003e20(param_1,param_2,(byte *)"I=%d T=%d SF=%f CF=%f O=%s S=%d N=%s D=%s P=%s C=%d");
  return;
}



void __cdecl FUN_10025b00(byte *param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  byte *_Dest;
  byte local_98 [152];
  
  _Dest = local_98;
  local_98[0] = 0;
  pcVar3 = (char *)(param_3 + 0x32c);
  iVar2 = 4;
  do {
    if (*pcVar3 != '\0') {
      iVar1 = _sprintf((char *)_Dest,"%s,",pcVar3);
      _Dest = _Dest + iVar1;
    }
    pcVar3 = pcVar3 + 0x24;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  if ((_Dest != local_98) && (_Dest[-1] == 0x2c)) {
    _Dest[-1] = 0;
  }
  FUN_10003cf0(param_1,param_2,&DAT_1004dc94,local_98);
  return;
}



void __cdecl FUN_10025b80(int param_1,int *param_2,int *param_3)

{
  bool bVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *pvVar5;
  int *local_8;
  int local_4;
  
  local_8 = param_3 + 199;
  bVar1 = false;
  local_4 = 4;
  do {
    if (*local_8 != 0) {
      piVar2 = (int *)FUN_10026280(param_1,*local_8);
      if (piVar2 != (int *)0x0) {
        FUN_10025740((int)piVar2,param_3);
        iVar3 = FUN_100262c0(piVar2[0x3a]);
        iVar4 = FUN_10025580((char *)(piVar2 + 4),(char *)(param_3 + 8));
        pvVar5 = extraout_ECX;
        if (iVar4 == 0) {
          if (iVar3 == 0) {
            bVar1 = true;
          }
          else {
            if ((piVar2[2] & 0x100U) == 0) goto LAB_10025c82;
            FUN_10005d70((char *)(piVar2 + 4),(char *)(*(int *)piVar2[0x39] + 0x20),0x10);
            FUN_100260e0(param_1,*piVar2);
            pvVar5 = extraout_ECX_00;
LAB_10025c2b:
            if (!bVar1) goto LAB_10025c53;
          }
        }
        else {
          if ((iVar3 != 0) || ((piVar2[2] & 0x80000U) != 0)) goto LAB_10025c2b;
LAB_10025c82:
          bVar1 = true;
        }
        FUN_10022a90(pvVar5,param_2,(byte *)(piVar2 + 9));
        FUN_100261a0(param_1,*piVar2);
        FUN_100256b0(piVar2);
      }
    }
LAB_10025c53:
    local_8 = local_8 + 1;
    local_4 = local_4 + -1;
    if (local_4 == 0) {
      return;
    }
  } while( true );
}



uint __cdecl FUN_10025c90(int param_1,int param_2)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = (int *)(param_1 + 0x31c);
  do {
    if (*piVar2 == param_2) {
      return CONCAT31((int3)(uVar1 >> 8),1);
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 1;
  } while ((int)uVar1 < 4);
  return uVar1 & 0xffffff00;
}



undefined4 __cdecl FUN_10025d10(int param_1,char *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = FUN_100262c0(*(int *)(param_1 + 0xe8));
  iVar3 = 0;
  if (0 < iVar1) {
    do {
      iVar2 = FUN_10025580((char *)(*(int *)(*(int *)(param_1 + 0xe4) + iVar3 * 4) + 0x20),param_2);
      if (iVar2 == 0) {
        return *(undefined4 *)(*(int *)(param_1 + 0xe4) + iVar3 * 4);
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < iVar1);
  }
  return 0;
}



void __cdecl FUN_10025d70(byte *param_1,int param_2,byte *param_3,uint *param_4)

{
  if (DAT_10068ae8 == '\0') {
    _sprintf(&DAT_10068ae8,"llll%dsl%ds%ds%ds%ds",0x10,0x24,0x44,0x44,0x14);
  }
  FUN_10002d30(param_1,param_2,param_3,param_4,0xe4,(byte *)&DAT_10068ae8);
  return;
}



void __cdecl FUN_10025dc0(byte *param_1,byte *param_2,uint *param_3)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  
  if (DAT_10068ae8 == '\0') {
    _sprintf(&DAT_10068ae8,"llll%dsl%ds%ds%ds%ds",0x10,0x24,0x44,0x44,0x14);
  }
  pbVar3 = (byte *)&DAT_10068ae8;
  iVar2 = 0xe4;
  pbVar1 = FUN_100020f0(param_1,param_2);
  FUN_10002fe0(pbVar1,param_3,iVar2,pbVar3);
  return;
}



int FUN_10025e10(void)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  uint uVar4;
  int unaff_EBX;
  int iVar5;
  int iVar6;
  undefined4 *puVar7;
  
  puVar2 = *(undefined4 **)(unaff_EBX + 0x1c);
  puVar3 = puVar2;
  if (puVar2 != puVar2 + *(int *)(unaff_EBX + 0x14) * 4) {
    do {
      if (puVar2[1] != 0) {
        if ((puVar2[3] == 0) && (*(int *)(unaff_EBX + 0x2c) < *(int *)(unaff_EBX + 0x28))) {
          puVar2[1] = 0;
          *(int *)(unaff_EBX + 0x28) = *(int *)(unaff_EBX + 0x28) + -1;
        }
        else {
          *puVar3 = *puVar2;
          puVar3[1] = puVar2[1];
          puVar3[2] = puVar2[2];
          puVar3[3] = puVar2[3];
          puVar3 = puVar3 + 4;
        }
      }
      puVar2 = puVar2 + 4;
    } while (puVar2 != (undefined4 *)
                       (*(int *)(unaff_EBX + 0x14) * 0x10 + *(int *)(unaff_EBX + 0x1c)));
  }
  iVar5 = *(int *)(unaff_EBX + 0x18);
  iVar6 = *(int *)(unaff_EBX + 0x14) - ((int)puVar2 - (int)puVar3 >> 4);
  iVar1 = iVar6 * 100;
  *(int *)(unaff_EBX + 0x14) = iVar6;
  if (iVar1 + iVar5 * -0x55 != 0 && iVar5 * 0x55 <= iVar1) {
    iVar5 = (iVar5 * 3) / 2;
    puVar2 = (undefined4 *)_malloc(iVar5 << 4);
    if (puVar2 != (undefined4 *)0x0) {
      puVar3 = *(undefined4 **)(unaff_EBX + 0x1c);
      puVar7 = puVar2;
      for (uVar4 = (uint)(*(int *)(unaff_EBX + 0x14) << 4) >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
        *puVar7 = *puVar3;
        puVar3 = puVar3 + 1;
        puVar7 = puVar7 + 1;
      }
      for (iVar1 = 0; iVar1 != 0; iVar1 = iVar1 + -1) {
        *(undefined1 *)puVar7 = *(undefined1 *)puVar3;
        puVar3 = (undefined4 *)((int)puVar3 + 1);
        puVar7 = (undefined4 *)((int)puVar7 + 1);
      }
      *(int *)(unaff_EBX + 0x18) = iVar5;
      _free(*(void **)(unaff_EBX + 0x1c));
      *(undefined4 **)(unaff_EBX + 0x1c) = puVar2;
    }
  }
  puVar2 = *(undefined4 **)(unaff_EBX + 0x10);
  for (uVar4 = *(uint *)(unaff_EBX + 0xc) & 0x3fffffff; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  puVar2 = *(undefined4 **)(unaff_EBX + 0x1c);
  if (puVar2 != puVar2 + *(int *)(unaff_EBX + 0x14) * 4) {
    do {
      if (puVar2[3] != 0) {
        iVar5 = (int)puVar2[1] % *(int *)(unaff_EBX + 0xc);
        *puVar2 = *(undefined4 *)(*(int *)(unaff_EBX + 0x10) + iVar5 * 4);
        *(undefined4 **)(*(int *)(unaff_EBX + 0x10) + iVar5 * 4) = puVar2;
      }
      puVar2 = puVar2 + 4;
    } while (puVar2 != (undefined4 *)
                       (*(int *)(unaff_EBX + 0x14) * 0x10 + *(int *)(unaff_EBX + 0x1c)));
  }
  *(undefined4 *)(unaff_EBX + 0x24) = 0;
  return *(int *)(unaff_EBX + 0x18) - *(int *)(unaff_EBX + 0x14);
}



undefined4 * __cdecl FUN_10025f60(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  
  puVar1 = (undefined4 *)_malloc(0x38);
  puVar3 = puVar1;
  for (iVar4 = 0xe; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  if (param_1 < 2) {
    param_1 = 2;
  }
  if (param_2 < 2) {
    param_2 = 2;
  }
  puVar1[6] = param_1;
  pvVar2 = _malloc(param_1 << 4);
  puVar1[7] = pvVar2;
  puVar1[0xb] = param_2;
  puVar1[3] = 0x400;
  puVar3 = (undefined4 *)_malloc(0x1000);
  puVar1[4] = puVar3;
  for (uVar5 = puVar1[3] & 0x3fffffff; uVar5 != 0; uVar5 = uVar5 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  puVar1[0xc] = param_3;
  *puVar1 = 1;
  puVar1[1] = 1;
  puVar1[0xd] = param_4;
  return puVar1;
}



void __cdecl FUN_10026000(void *param_1)

{
  _free(*(void **)((int)param_1 + 0x10));
  _free(*(void **)((int)param_1 + 0x1c));
  _free(param_1);
  return;
}



int __cdecl FUN_10026030(int *param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  
  if (param_2 == 0) {
    param_2 = *param_1;
    *param_1 = param_2 + 1;
  }
  if (param_1[5] == param_1[6]) {
    iVar1 = FUN_10025e10();
    if (iVar1 < 1) {
      return 0;
    }
  }
  param_1[1] = param_1[1] + 1;
  *(int *)(param_1[5] * 0x10 + 4 + param_1[7]) = param_2;
  *(undefined4 *)(param_1[5] * 0x10 + 0xc + param_1[7]) = param_3;
  *(int *)(param_1[5] * 0x10 + 8 + param_1[7]) = param_1[1];
  iVar1 = param_1[3];
  *(undefined4 *)(param_1[5] * 0x10 + param_1[7]) =
       *(undefined4 *)(param_1[4] + (param_2 % iVar1) * 4);
  *(int *)(param_1[4] + (param_2 % iVar1) * 4) = param_1[5] * 0x10 + param_1[7];
  param_1[5] = param_1[5] + 1;
  param_1[2] = param_1[2] + 1;
  if ((code *)param_1[0xc] != (code *)0x0) {
    (*(code *)param_1[0xc])(param_1,param_1[0xd]);
  }
  return param_2;
}



undefined4 __cdecl FUN_100260e0(int param_1,int param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  
  if (param_2 == 0) {
    return 0;
  }
  if ((*(int *)(param_1 + 0x14) != *(int *)(param_1 + 0x18)) || (iVar4 = FUN_10025e10(), 0 < iVar4))
  {
    piVar1 = (int *)(*(int *)(param_1 + 0x10) + (param_2 % *(int *)(param_1 + 0xc)) * 4);
    puVar2 = (undefined4 *)*piVar1;
    while (puVar2 != (undefined4 *)0x0) {
      if (puVar2[1] == param_2) {
        *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + 1;
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 4 + *(int *)(param_1 + 0x1c)) = puVar2[1];
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 8 + *(int *)(param_1 + 0x1c)) =
             *(undefined4 *)(param_1 + 4);
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 0xc + *(int *)(param_1 + 0x1c)) =
             puVar2[3];
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + *(int *)(param_1 + 0x1c)) = *puVar2;
        *piVar1 = *(int *)(param_1 + 0x14) * 0x10 + *(int *)(param_1 + 0x1c);
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        uVar3 = puVar2[3];
        puVar2[1] = 0;
        puVar2[3] = 0;
        return uVar3;
      }
      piVar1 = (int *)*piVar1;
      puVar2 = (undefined4 *)*piVar1;
    }
  }
  return 0;
}



undefined4 __cdecl FUN_100261a0(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  
  if (param_2 == 0) {
    return 0;
  }
  if ((*(int *)(param_1 + 0x14) != *(int *)(param_1 + 0x18)) || (iVar4 = FUN_10025e10(), 0 < iVar4))
  {
    iVar4 = param_2 % *(int *)(param_1 + 0xc);
    puVar1 = (undefined4 *)(*(int *)(param_1 + 0x10) + iVar4 * 4);
    puVar2 = *(undefined4 **)(*(int *)(param_1 + 0x10) + iVar4 * 4);
    while (puVar2 != (undefined4 *)0x0) {
      if (puVar2[1] == param_2) {
        *puVar1 = *puVar2;
        *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + 1;
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 4 + *(int *)(param_1 + 0x1c)) = puVar2[1];
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 8 + *(int *)(param_1 + 0x1c)) =
             *(undefined4 *)(param_1 + 4);
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 0xc + *(int *)(param_1 + 0x1c)) = 0;
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + *(int *)(param_1 + 0x1c)) = 0;
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        uVar3 = puVar2[3];
        puVar2[1] = 0;
        puVar2[3] = 0;
        *puVar2 = 0;
        *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
        *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
        if (*(code **)(param_1 + 0x30) != (code *)0x0) {
          (**(code **)(param_1 + 0x30))(param_1,*(undefined4 *)(param_1 + 0x34));
        }
        return uVar3;
      }
      puVar1 = (undefined4 *)*puVar1;
      puVar2 = (undefined4 *)*puVar1;
    }
  }
  return 0;
}



undefined4 __cdecl FUN_10026280(int param_1,int param_2)

{
  undefined4 *puVar1;
  
  if (0 < param_2) {
    for (puVar1 = *(undefined4 **)
                   (*(int *)(param_1 + 0x10) + (param_2 % *(int *)(param_1 + 0xc)) * 4);
        puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
      if (puVar1[1] == param_2) {
        return puVar1[3];
      }
    }
  }
  return 0;
}



undefined4 __cdecl FUN_100262c0(int param_1)

{
  return *(undefined4 *)(param_1 + 8);
}



undefined4 __cdecl FUN_100262d0(int param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



undefined4 __cdecl FUN_100262e0(int param_1,int *param_2,undefined4 *param_3)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  
  if (param_3 != (undefined4 *)0x0) {
    *param_3 = 0;
  }
  if (*param_2 < 1) {
    *param_2 = 1;
  }
  iVar1 = *param_2;
  if (*(int *)(param_1 + 4) <= iVar1) {
    return 0;
  }
  iVar4 = *(int *)(param_1 + 0x20) + 1;
  if (iVar1 != *(int *)(param_1 + 0x24)) {
    iVar7 = 0;
    iVar8 = *(int *)(param_1 + 0x14) + -1;
    iVar6 = iVar1 + 1;
    if (-1 < iVar8) {
      do {
        iVar4 = (iVar8 + iVar7) / 2;
        iVar2 = *(int *)(iVar4 * 0x10 + 8 + *(int *)(param_1 + 0x1c));
        if (iVar2 == iVar6) break;
        if (iVar2 == iVar6 || iVar2 - iVar6 < 0) {
          iVar7 = iVar4 + 1;
        }
        else {
          iVar8 = iVar4 + -1;
        }
      } while (iVar7 <= iVar8);
    }
  }
  if (iVar4 < *(int *)(param_1 + 0x14)) {
    piVar5 = (int *)(iVar4 * 0x10 + 8 + *(int *)(param_1 + 0x1c));
    do {
      if (iVar1 <= *piVar5) break;
      iVar4 = iVar4 + 1;
      piVar5 = piVar5 + 4;
    } while (iVar4 < *(int *)(param_1 + 0x14));
    if (iVar4 < *(int *)(param_1 + 0x14)) {
      piVar5 = (int *)(iVar4 * 0x10 + 4 + *(int *)(param_1 + 0x1c));
      do {
        if (*piVar5 != 0) break;
        iVar4 = iVar4 + 1;
        piVar5 = piVar5 + 4;
      } while (iVar4 < *(int *)(param_1 + 0x14));
    }
  }
  iVar8 = iVar4 * 0x10;
  iVar6 = *(int *)(*(int *)(param_1 + 0x1c) + 8 + iVar8) + -1;
  if (iVar1 < iVar6) {
    *param_2 = iVar6;
  }
  if (iVar4 < *(int *)(param_1 + 0x14)) {
    uVar3 = *(undefined4 *)(*(int *)(param_1 + 0x1c) + 8 + iVar8);
    *(int *)(param_1 + 0x20) = iVar4;
    *(undefined4 *)(param_1 + 0x24) = uVar3;
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = *(undefined4 *)(*(int *)(param_1 + 0x1c) + iVar8 + 0xc);
    }
    if (*(code **)(param_1 + 0x30) != (code *)0x0) {
      (**(code **)(param_1 + 0x30))(param_1,*(undefined4 *)(param_1 + 0x34));
    }
    return *(undefined4 *)(*(int *)(param_1 + 0x1c) + 4 + iVar8);
  }
  return 0;
}



void __cdecl FUN_10026400(uint *param_1,uint *param_2,int param_3)

{
  byte *unaff_EBX;
  uint *puVar1;
  int unaff_EDI;
  byte local_20 [32];
  
  _sprintf((char *)local_20,"OPPO%d");
  FUN_10003cf0(unaff_EBX,unaff_EDI,local_20,(byte *)param_1);
  _sprintf((char *)local_20,"OPPART%d");
  FUN_10002370(unaff_EBX,unaff_EDI,local_20,param_1[4]);
  _sprintf((char *)local_20,"OPFLAG%d");
  FUN_10002370(unaff_EBX,unaff_EDI,local_20,param_1[6]);
  _sprintf((char *)local_20,"PRES%d");
  FUN_10002370(unaff_EBX,unaff_EDI,local_20,param_1[8]);
  if (param_2 != (uint *)0x0) {
    _sprintf((char *)local_20,"OPID%d");
    FUN_10002370(unaff_EBX,unaff_EDI,local_20,*param_2);
    if (param_3 == 0) {
      puVar1 = (uint *)param_1[7];
      param_1 = (uint *)param_2[0xb5];
    }
    else if (param_3 == 1) {
      puVar1 = (uint *)param_2[0xb5];
      param_1 = (uint *)param_2[0xb5];
    }
    else {
      puVar1 = param_2;
      if (param_3 == 2) {
        puVar1 = (uint *)param_1[7];
        param_1 = (uint *)param_1[7];
      }
    }
    _sprintf((char *)local_20,"ADDR%d");
    FUN_100025e0(unaff_EBX,unaff_EDI,local_20,(uint)puVar1);
    _sprintf((char *)local_20,"LADDR%d");
    FUN_100025e0(unaff_EBX,unaff_EDI,local_20,(uint)param_1);
    _sprintf((char *)local_20,"MADDR%d");
    FUN_10003cf0(unaff_EBX,unaff_EDI,local_20,(byte *)(param_2 + 0x87));
  }
  return;
}



void FUN_10026570(void)

{
  _sprintf(&DAT_10068b68,"lll%ds%ds%dslllll%ds%dsllll%dsll%ds",0x24,0x48,0x14,0x24,0x84,0x80,0x10);
  _sprintf(&DAT_10068c68,"l%ds",0x24);
  _sprintf(&DAT_10068be8,"%dslllll%dsl",0x10,0x24);
  return;
}



void __cdecl
FUN_100265c0(void *param_1,undefined4 param_2,int param_3,int param_4,byte *param_5,size_t param_6,
            undefined *param_7,undefined4 param_8,char param_9,char param_10,char param_11,
            char param_12)

{
  char cVar1;
  int iVar2;
  uint *puVar3;
  uint *puVar4;
  char *pcVar5;
  void *this;
  int *piVar6;
  int iVar7;
  uint *puVar8;
  byte *pbVar9;
  int local_30;
  uint *local_2c;
  int local_28;
  byte local_20 [32];
  
  iVar7 = 0;
  local_30 = -1;
  if (0 < *(int *)(param_3 + 0x9c)) {
    piVar6 = (int *)(param_3 + 0x250);
    do {
      if (local_30 != -1) break;
      iVar2 = FUN_10025580((char *)(param_4 + 0x20),(char *)(piVar6 + -4));
      if (iVar2 == 0) {
        local_30 = *piVar6;
      }
      iVar7 = iVar7 + 1;
      piVar6 = piVar6 + 0x1d;
    } while (iVar7 < *(int *)(param_3 + 0x9c));
  }
  FUN_10003e20(param_5,param_6,
               (byte *)
               "IDENT=%d WHEN=%e NAME=%s HOST=%s ROOM=%d MAXSIZE=%d MINSIZE=%d COUNT=%d PRIV=%d CUSTFLAGS=%d SYSFLAGS=%d EVID=%d EVGID=%d NUMPART=%d"
              );
  if (param_11 != '\0') {
    if (*(char *)(param_3 + 0x158) != '\0') {
      FUN_10003cf0(param_5,param_6,&DAT_1004db40,(byte *)(param_3 + 0x158));
    }
    if (*(char *)(param_3 + 0x1e0) != '\0') {
      FUN_10003cf0(param_5,param_6,(byte *)"PLATPARAMS",(byte *)(param_3 + 0x1e0));
    }
  }
  if (param_10 == '\0') {
    puVar4 = (uint *)FUN_10022a40(param_1,(int)param_1,
                                  (byte *)(*(int *)(param_3 + 0x90) * 0x74 + 0x240 + param_3));
    if (puVar4 != (uint *)0x0) {
      FUN_10026400((uint *)(*(int *)(param_3 + 0x90) * 0x74 + 0x240 + param_3),puVar4,0);
    }
  }
  else {
    if (param_12 == '\0') {
      _param_11 = 0;
    }
    else {
      iVar7 = 1;
      _param_11 = 1;
      if (1 < *(int *)(param_3 + 0x9c)) {
        piVar6 = (int *)(param_3 + 0x2fc);
        do {
          if ((char)piVar6[-0x12] == '\0') break;
          if ((*piVar6 == 0) && (*(int *)(param_3 + 0x25c) != piVar6[-0xb])) {
            _param_11 = 2;
            break;
          }
          iVar7 = iVar7 + 1;
          piVar6 = piVar6 + 0x1d;
        } while (iVar7 < *(int *)(param_3 + 0x9c));
      }
    }
    this = *(void **)(param_3 + 0x9c);
    local_28 = 0;
    if (0 < (int)this) {
      puVar4 = (uint *)(param_3 + 0x240);
      puVar8 = puVar4;
      local_2c = puVar4;
      do {
        if ((char)*puVar8 == '\0') break;
        puVar3 = (uint *)FUN_10022a40(this,(int)param_1,(byte *)puVar8);
        if ((puVar3 != (uint *)0x0) || (puVar8[0x12] != 0)) {
          FUN_10026400(puVar4,puVar3,_param_11);
          puVar4 = local_2c + 0x1d;
          local_2c = puVar4;
        }
        this = *(void **)(param_3 + 0x9c);
        local_28 = local_28 + 1;
        puVar8 = puVar8 + 0x1d;
      } while (local_28 < (int)this);
    }
  }
  iVar7 = 0;
  if (0 < *(int *)(param_3 + 0x154)) {
    puVar4 = (uint *)(param_3 + 0x1f0);
    do {
      _sprintf((char *)local_20,"PARTSIZE%d",iVar7);
      FUN_10002370(param_5,param_6,local_20,*puVar4);
      iVar7 = iVar7 + 1;
      puVar4 = puVar4 + 10;
    } while (iVar7 < *(int *)(param_3 + 0x154));
  }
  if ((param_7 == (undefined *)0x0) ||
     (cVar1 = (*(code *)param_7)(param_8,param_5,param_6,param_3,param_4), cVar1 == '\0')) {
    FUN_10003cf0(param_5,param_6,(byte *)"PARAMS",(byte *)(param_3 + 0xc4));
    iVar7 = 0;
    if (0 < *(int *)(param_3 + 0x154)) {
      pbVar9 = (byte *)(param_3 + 500);
      do {
        if ((param_9 == '\0') && (local_30 != iVar7)) {
          if (*(int *)(param_3 + 0x90) < 0) {
            pcVar5 = "";
          }
          else {
            pcVar5 = (char *)(*(int *)(param_3 + 0x90) * 0x74 + 0x240 + param_3);
          }
          iVar2 = FUN_10025580(pcVar5,(char *)(param_4 + 0x20));
          if (iVar2 == 0) goto LAB_10026903;
        }
        else {
LAB_10026903:
          _sprintf((char *)local_20,"PARTPARAMS%d",iVar7);
          FUN_10003cf0(param_5,param_6,local_20,pbVar9);
        }
        iVar7 = iVar7 + 1;
        pbVar9 = pbVar9 + 0x28;
      } while (iVar7 < *(int *)(param_3 + 0x154));
    }
    if (param_10 != '\0') {
      iVar7 = 0;
      piVar6 = (int *)(param_3 + 0x250);
      do {
        if ((char)piVar6[-4] == '\0') {
          return;
        }
        if ((param_9 != '\0') || (*piVar6 == local_30)) {
          _sprintf((char *)local_20,"OPPARAM%d",iVar7);
          FUN_10003cf0(param_5,param_6,local_20,(byte *)(piVar6 + 5));
        }
        iVar7 = iVar7 + 1;
        piVar6 = piVar6 + 0x1d;
      } while (iVar7 < 8);
    }
  }
  return;
}



void __cdecl FUN_100269a0(byte *param_1,int param_2,uint *param_3)

{
  uint *puVar1;
  int iVar2;
  byte local_20 [32];
  
  if (DAT_10068b68 == '\0') {
    FUN_10026570();
  }
  FUN_10002d30(param_1,param_2,&DAT_1004e75c,param_3,0x6f0,(byte *)&DAT_10068b68);
  iVar2 = 0;
  if (0 < (int)param_3[0x55]) {
    puVar1 = param_3 + 0x7c;
    do {
      _sprintf((char *)local_20,"PT%d",iVar2);
      FUN_10002d30(param_1,param_2,local_20,puVar1,0x28,&DAT_10068c68);
      iVar2 = iVar2 + 1;
      puVar1 = puVar1 + 10;
    } while (iVar2 < (int)param_3[0x55]);
  }
  iVar2 = 0;
  if (0 < (int)param_3[0x27]) {
    puVar1 = param_3 + 0x90;
    do {
      _sprintf((char *)local_20,"PL%d",iVar2);
      FUN_10002d30(param_1,param_2,local_20,puVar1,0x74,&DAT_10068be8);
      iVar2 = iVar2 + 1;
      puVar1 = puVar1 + 0x1d;
    } while (iVar2 < (int)param_3[0x27]);
  }
  return;
}



void __cdecl FUN_10026a90(byte *param_1,uint *param_2)

{
  byte *pbVar1;
  uint *puVar2;
  uint *puVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  byte local_20 [32];
  
  if (DAT_10068b68 == '\0') {
    FUN_10026570();
  }
  pbVar6 = (byte *)&DAT_10068b68;
  iVar4 = 0x6f0;
  puVar2 = param_2;
  pbVar1 = FUN_100020f0(param_1,&DAT_1004e75c);
  FUN_10002fe0(pbVar1,puVar2,iVar4,pbVar6);
  iVar4 = 0;
  if (0 < (int)param_2[0x55]) {
    puVar2 = param_2 + 0x7c;
    do {
      _sprintf((char *)local_20,"PT%d",iVar4);
      pbVar6 = &DAT_10068c68;
      iVar5 = 0x28;
      puVar3 = puVar2;
      pbVar1 = FUN_100020f0(param_1,local_20);
      FUN_10002fe0(pbVar1,puVar3,iVar5,pbVar6);
      iVar4 = iVar4 + 1;
      puVar2 = puVar2 + 10;
    } while (iVar4 < (int)param_2[0x55]);
  }
  iVar4 = 0;
  if (0 < (int)param_2[0x27]) {
    puVar2 = param_2 + 0x90;
    do {
      _sprintf((char *)local_20,"PL%d",iVar4);
      pbVar6 = &DAT_10068be8;
      iVar5 = 0x74;
      puVar3 = puVar2;
      pbVar1 = FUN_100020f0(param_1,local_20);
      FUN_10002fe0(pbVar1,puVar3,iVar5,pbVar6);
      iVar4 = iVar4 + 1;
      puVar2 = puVar2 + 0x1d;
    } while (iVar4 < (int)param_2[0x27]);
  }
  return;
}



void __cdecl FUN_10026b80(undefined4 param_1,int param_2,undefined1 *param_3,int param_4)

{
  char local_15c [92];
  char local_100 [256];
  
  FUN_10005ca0(local_100,0x100,(char *)(param_2 + 0xa0));
  FUN_10018990((int)local_15c);
  FUN_100189c0(local_15c,local_100,0xffffffff);
  FUN_10018a70(local_15c,param_3,param_4);
  return;
}



void __cdecl FUN_10026c10(undefined4 param_1)

{
  FUN_1002a6e0(param_1,0x6f0);
  return;
}



void __cdecl FUN_10026c30(int param_1,int param_2)

{
  if (param_2 != 0) {
    if (*(void **)(param_2 + 0x5e0) != (void *)0x0) {
      _free(*(void **)(param_2 + 0x5e0));
    }
    if (*(void **)(param_2 + 0x5e4) != (void *)0x0) {
      FUN_1002a690(*(void **)(param_2 + 0x5e4),'\x01');
    }
    FUN_1002a710(param_1,param_2);
  }
  return;
}



int __cdecl FUN_10026c80(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  bool bVar5;
  
  iVar4 = 0;
  iVar3 = *(int *)(param_1 + 400) + -1;
  if (-1 < iVar3) {
    do {
      iVar2 = (iVar3 + iVar4) / 2;
      iVar1 = *(int *)(param_1 + iVar2 * 4);
      if (iVar1 == param_2) {
        return iVar2;
      }
      bVar5 = iVar1 - param_2 < 0;
      if (iVar1 == param_2 || bVar5) {
        if (bVar5) {
          iVar4 = iVar2 + 1;
        }
      }
      else {
        iVar3 = iVar2 + -1;
      }
    } while (iVar4 <= iVar3);
  }
  return -1;
}



void __cdecl
FUN_10026d60(void *param_1,undefined4 param_2,byte *param_3,size_t param_4,uint *param_5,int param_6
            ,undefined *param_7,undefined4 param_8,char param_9)

{
  byte local_24 [36];
  
  FUN_100265c0(param_1,param_2,(int)param_5,param_6,param_3,param_4,param_7,param_8,'\x01','\x01',
               '\x01',param_9);
  FUN_10002370(param_3,param_4,&DAT_1004e714,(param_5[0x52] ^ *param_5) & 0xffffff);
  FUN_10003cf0(param_3,param_4,&DAT_10051e90,(byte *)(param_6 + 0x20));
  if ((param_5[1] & 0x40000) != 0) {
    FUN_10026b80(param_1,(int)param_5,local_24,0x21);
    FUN_10003cf0(param_3,param_4,&DAT_10051e88,local_24);
  }
  return;
}



int __thiscall FUN_10026e10(void *this,uint param_1)

{
  int iVar1;
  
  if (((param_1 & 0xffff) == *(uint *)((int)this + 8)) && (*(int *)((int)this + 0x20c) != 0)) {
    FUN_10022c50(*(int *)((int)this + 0x20c));
    iVar1 = FUN_10022c60(*(int *)((int)this + 0x20c),(undefined4 *)0x0);
    while (iVar1 != 0) {
      if (*(uint *)(iVar1 + 8) == param_1) {
        return iVar1;
      }
      iVar1 = FUN_10022c60(*(int *)((int)this + 0x20c),(undefined4 *)0x0);
    }
  }
  return 0;
}



void __thiscall FUN_10026e80(void *this,undefined4 param_1)

{
  undefined1 *puVar1;
  int iVar2;
  
  *(undefined4 *)this = param_1;
  *(undefined4 *)((int)this + 4) = 0;
  *(undefined4 *)((int)this + 8) = 0xffffffff;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined1 *)((int)this + 0x10) = 0;
  *(undefined1 *)((int)this + 0x50) = 0;
  *(undefined1 *)((int)this + 0xd0) = 0;
  *(undefined4 *)((int)this + 0xe0) = 0x656e5553;
  puVar1 = (undefined1 *)((int)this + 0xe4);
  iVar2 = 4;
  do {
    *puVar1 = 0;
    puVar1 = puVar1 + 0x20;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  *(undefined4 *)((int)this + 0x248) = 0x32;
  *(undefined1 *)((int)this + 0x164) = 0;
  *(undefined4 *)((int)this + 0x1e4) = 0x4b;
  *(undefined2 *)((int)this + 0x1e8) = 0x2320;
  *(undefined1 *)((int)this + 0x1ea) = 0;
  *(undefined1 *)((int)this + 0x1f0) = 0;
  *(undefined1 *)((int)this + 0x1f1) = 0;
  *(undefined4 *)((int)this + 500) = 0;
  *(undefined4 *)((int)this + 0x1f8) = 0;
  *(undefined4 *)((int)this + 0x1fc) = 1;
  *(undefined1 *)((int)this + 0x200) = 0;
  *(undefined4 *)((int)this + 0x204) = 0xffffffff;
  *(undefined1 *)((int)this + 0x208) = 0;
  builtin_strncpy((char *)((int)this + 0x210),"EA S",4);
  builtin_strncpy((char *)((int)this + 0x214),"PORT",4);
  *(undefined2 *)((int)this + 0x218) = 0x53;
  *(undefined4 *)((int)this + 0x220) = 0x1808;
  *(undefined4 *)((int)this + 0x224) = 0;
  *(undefined4 *)((int)this + 0x228) = 0;
  *(undefined4 *)((int)this + 0x22c) = 0;
  *(undefined4 *)((int)this + 0x230) = 0;
  *(undefined4 *)((int)this + 0x234) = 0;
  *(undefined4 *)((int)this + 0x238) = 0;
  *(undefined4 *)((int)this + 0x23c) = 0;
  *(undefined4 *)((int)this + 0x240) = 0;
  *(undefined4 *)((int)this + 0x244) = 0;
  *(undefined1 *)((int)this + 0x24c) = 0;
  *(undefined1 *)((int)this + 0x270) = 0;
  *(undefined4 *)((int)this + 0x20c) = 0;
  return;
}



void __fastcall FUN_10026fa0(int param_1)

{
  void *_Memory;
  
  if (*(int *)(param_1 + 0x20c) != 0) {
    FUN_10022c50(*(int *)(param_1 + 0x20c));
    _Memory = (void *)FUN_10022c60(*(int *)(param_1 + 0x20c),(undefined4 *)0x0);
    while (_Memory != (void *)0x0) {
      FUN_10026fa0((int)_Memory);
      _free(_Memory);
      _Memory = (void *)FUN_10022c60(*(int *)(param_1 + 0x20c),(undefined4 *)0x0);
    }
    FUN_10022830(*(void **)(param_1 + 0x20c));
  }
  return;
}



void __thiscall FUN_10027010(void *this,undefined4 param_1,byte *param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  uint uVar4;
  char *pcVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  
  pbVar9 = &DAT_1004d26f;
  iVar7 = 0x40;
  pbVar3 = (byte *)((int)this + 0x10);
  *(undefined4 *)((int)this + 8) = param_1;
  pbVar2 = pbVar3;
  pbVar1 = FUN_100020f0(param_2,&DAT_1004d8c8);
  FUN_10002a30(pbVar1,pbVar2,iVar7,pbVar9);
  iVar7 = 0x80;
  pbVar2 = (byte *)((int)this + 0x50);
  pbVar1 = FUN_100020f0(param_2,&DAT_1004df70);
  FUN_10002a30(pbVar1,pbVar2,iVar7,pbVar3);
  pbVar1 = &DAT_1004d26f;
  iVar7 = 0x10;
  pbVar3 = (byte *)((int)this + 0xd0);
  pbVar2 = FUN_100020f0(param_2,(byte *)"PREFIX");
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar1);
  uVar4 = *(uint *)((int)this + 0xe0);
  pbVar3 = FUN_100020f0(param_2,&DAT_1004dca4);
  uVar4 = FUN_10002930(pbVar3,uVar4);
  *(uint *)((int)this + 0xe0) = uVar4;
  iVar7 = 0;
  pbVar3 = (byte *)((int)this + 0xe4);
  do {
    pbVar9 = &DAT_1004d26f;
    iVar8 = 0x20;
    pbVar2 = pbVar3;
    pbVar1 = (byte *)FUN_100022d0(param_2,&DAT_10051f0c,iVar7);
    FUN_10002a30(pbVar1,pbVar2,iVar8,pbVar9);
    iVar7 = iVar7 + 1;
    pbVar3 = pbVar3 + 0x20;
  } while (iVar7 < 4);
  iVar7 = *(int *)((int)this + 0x248);
  pbVar3 = FUN_100020f0(param_2,&DAT_1004e76c);
  iVar7 = FUN_10002480((char *)pbVar3,iVar7);
  pbVar1 = &DAT_1004d26f;
  iVar8 = 0x80;
  pbVar3 = (byte *)((int)this + 0x164);
  *(int *)((int)this + 0x248) = iVar7;
  pbVar2 = FUN_100020f0(param_2,(byte *)"PARAM");
  FUN_10002a30(pbVar2,pbVar3,iVar8,pbVar1);
  iVar7 = *(int *)((int)this + 0x1e4);
  pbVar3 = FUN_100020f0(param_2,&DAT_10051f08);
  iVar7 = FUN_10002480((char *)pbVar3,iVar7);
  *(int *)((int)this + 0x1e4) = iVar7;
  pbVar3 = (byte *)((int)this + 0x1e8);
  iVar7 = 8;
  pbVar2 = pbVar3;
  pbVar1 = FUN_100020f0(param_2,&DAT_10051f04);
  FUN_10002a30(pbVar1,pbVar3,iVar7,pbVar2);
  iVar7 = *(int *)((int)this + 0x1fc);
  pbVar3 = FUN_100020f0(param_2,&DAT_10051f00);
  iVar7 = FUN_10002480((char *)pbVar3,iVar7);
  uVar4 = (uint)*(byte *)((int)this + 0x1f0);
  *(int *)((int)this + 0x1fc) = iVar7;
  pbVar3 = FUN_100020f0(param_2,(byte *)"AUTO_CREATE");
  iVar7 = FUN_10002480((char *)pbVar3,uVar4);
  *(bool *)((int)this + 0x1f0) = iVar7 != 0;
  if (iVar7 != 0) {
    *(undefined4 *)((int)this + 0x1fc) = 0;
  }
  uVar4 = (uint)*(byte *)((int)this + 0x1f1);
  pbVar3 = FUN_100020f0(param_2,(byte *)"AUTO_EXPAND");
  iVar7 = FUN_10002480((char *)pbVar3,uVar4);
  uVar4 = (uint)(iVar7 != 0);
  *(bool *)((int)this + 0x1f1) = iVar7 != 0;
  pbVar3 = FUN_100020f0(param_2,(byte *)"INVALID");
  iVar8 = FUN_10002480((char *)pbVar3,uVar4);
  iVar7 = *(int *)((int)this + 0xc);
  *(bool *)((int)this + 0x208) = iVar8 != 0;
  pbVar3 = FUN_100020f0(param_2,&DAT_10051ed8);
  iVar7 = FUN_10002480((char *)pbVar3,iVar7);
  *(int *)((int)this + 0xc) = iVar7;
  pbVar3 = (byte *)((int)this + 0x10);
  iVar7 = 0x24;
  pbVar2 = (byte *)((int)this + 0x24c);
  pbVar1 = pbVar2;
  pbVar9 = FUN_100020f0(param_2,&DAT_1004e764);
  FUN_10002a30(pbVar9,pbVar1,iVar7,pbVar3);
  iVar7 = 0x24;
  pbVar3 = (byte *)((int)this + 0x270);
  pbVar1 = FUN_100020f0(param_2,&DAT_1004e79c);
  FUN_10002a30(pbVar1,pbVar3,iVar7,pbVar2);
  pbVar3 = (byte *)((int)this + 0x210);
  iVar7 = 0x10;
  pbVar2 = pbVar3;
  pbVar1 = FUN_100020f0(param_2,&DAT_1004e7a4);
  FUN_10002a30(pbVar1,pbVar3,iVar7,pbVar2);
  uVar4 = *(uint *)((int)this + 0x220);
  pbVar3 = FUN_100020f0(param_2,(byte *)"FLAGS");
  uVar4 = FUN_100025a0((char *)pbVar3,uVar4);
  *(uint *)((int)this + 0x220) = uVar4 | 0x808;
  uVar4 = (uint)*(byte *)((int)this + 0x200);
  pbVar3 = FUN_100020f0(param_2,(byte *)"IN_ROOM_IN_GAME");
  iVar8 = FUN_10002480((char *)pbVar3,uVar4);
  iVar7 = *(int *)((int)this + 0x204);
  *(bool *)((int)this + 0x200) = iVar8 != 0;
  pbVar3 = FUN_100020f0(param_2,(byte *)"MAX_ROOMS");
  iVar7 = FUN_10002480((char *)pbVar3,iVar7);
  *(int *)((int)this + 0x204) = iVar7;
  uVar4 = *(uint *)((int)this + 0x224);
  pbVar3 = FUN_100020f0(param_2,&DAT_1004e784);
  uVar4 = FUN_100025a0((char *)pbVar3,uVar4);
  *(uint *)((int)this + 0x224) = uVar4;
  pbVar3 = FUN_100020f0(param_2,(byte *)"CRITMASK");
  uVar4 = FUN_100025a0((char *)pbVar3,uVar4);
  iVar7 = 0;
  *(uint *)((int)this + 0x228) = uVar4;
  *(undefined4 *)((int)this + 0x22c) = 0;
  piVar6 = (int *)((int)this + 0x230);
  do {
    pcVar5 = (char *)FUN_100022d0(param_2,"CRITVAL",iVar7);
    if (pcVar5 != (char *)0x0) {
      iVar8 = FUN_10002480(pcVar5,*piVar6);
      *piVar6 = iVar8;
      *(int *)((int)this + 0x22c) = *(int *)((int)this + 0x22c) + 1;
    }
    iVar7 = iVar7 + 1;
    piVar6 = piVar6 + 1;
  } while (iVar7 < 6);
  return;
}



void __thiscall FUN_100273b0(void *this,int param_1)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  
  pcVar2 = (char *)((int)this + 0x210);
  iVar3 = (param_1 + 0x50) - (int)pcVar2;
  do {
    cVar1 = *pcVar2;
    pcVar2[iVar3] = cVar1;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  pcVar2 = (char *)((int)this + 0x50);
  iVar3 = (param_1 + 0x84) - (int)pcVar2;
  do {
    cVar1 = *pcVar2;
    pcVar2[iVar3] = cVar1;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  *(undefined4 *)(param_1 + 4) = *(undefined4 *)((int)this + 0x220);
  puVar4 = (undefined4 *)((int)this + 0x224);
  puVar5 = (undefined4 *)(param_1 + 0x1ac);
  for (iVar3 = 9; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar5 = *puVar4;
    puVar4 = puVar4 + 1;
    puVar5 = puVar5 + 1;
  }
  *(undefined4 *)(param_1 + 0x108) = *(undefined4 *)((int)this + 0x248);
  *(undefined4 *)(param_1 + 0x1a8) = *(undefined4 *)((int)this + 0xe0);
  return;
}



void FUN_10027430(byte *param_1,size_t param_2)

{
  int iVar1;
  
  FUN_10003e20(param_1,param_2,
               (byte *)
               "IDENT=%d CATEGORY_ID=%d NAME=%s DESC=%s PREFIX=%s LOC=%t SIZE=%d PCT=%d PARAM=%s SEP=%s AUTO_CREATE=%d AUTO_EXPAND=%d HOST=%s MIN=%d IN_ROOM_IN_GAME=%d MAX_ROOMS=%d INVALID=%d ROOM=%s DISP=%s SORT=%d"
              );
  iVar1 = 0;
  do {
    FUN_10003e20(param_1,param_2,(byte *)"~RES#=%s");
    iVar1 = iVar1 + 1;
  } while (iVar1 < 4);
  return;
}



void __thiscall FUN_10027500(void *this,undefined4 param_1,byte *param_2,size_t param_3,int param_4)

{
  int iVar1;
  byte *pbVar2;
  
  iVar1 = param_4;
                    // WARNING: Load size is inaccurate
  FUN_10017ca0(*this,(byte *)((int)this + 0x164),param_4);
                    // WARNING: Load size is inaccurate
  FUN_10017ca0(*this,(byte *)((int)this + 0x10),param_4);
  FUN_10003e20(param_2,param_3,(byte *)"~CAT#=%s,%s,%s");
  pbVar2 = (byte *)((int)this + 0xe4);
  param_4 = 4;
  do {
                    // WARNING: Load size is inaccurate
    FUN_10017ca0(*this,pbVar2,iVar1);
    FUN_10003e20(param_2,param_3,&DAT_10051940);
    pbVar2 = pbVar2 + 0x20;
    param_4 = param_4 + -1;
  } while (param_4 != 0);
  FUN_10003e20(param_2,param_3,&DAT_1005193c);
  return;
}



void FUN_100275b0(char *param_1,size_t param_2)

{
  FUN_10005ca0(param_1,param_2,"%s.%s");
  return;
}



void __cdecl
FUN_100275e0(char *param_1,undefined1 *param_2,int param_3,char *param_4,size_t param_5)

{
  undefined1 *puVar1;
  char *pcVar2;
  int iVar3;
  int iVar4;
  
  if (param_2 != (undefined1 *)0x0) {
    *param_2 = 0;
  }
  if (param_4 != (char *)0x0) {
    *param_4 = '\0';
  }
  pcVar2 = _strchr(param_1,0x2e);
  if (pcVar2 != (char *)0x0) {
    if (param_2 != (undefined1 *)0x0) {
      iVar4 = (int)pcVar2 - (int)param_1;
      if (param_3 <= iVar4) {
        iVar4 = param_3 + -1;
      }
      iVar3 = 0;
      if (0 < iVar4) {
        do {
          if (param_3 <= iVar3) break;
          puVar1 = param_2 + iVar3;
          iVar3 = iVar3 + 1;
          *puVar1 = puVar1[(int)param_1 - (int)param_2];
        } while (iVar3 < iVar4);
      }
      param_2[iVar3] = 0;
    }
    param_1 = pcVar2 + 1;
  }
  if (param_4 != (char *)0x0) {
    FUN_10005d70(param_4,param_1,param_5);
  }
  return;
}



int __cdecl FUN_10027670(int param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  bool bVar6;
  
  FUN_10022c50(param_1);
  iVar2 = FUN_10022c60(param_1,(undefined4 *)0x0);
  do {
    if (iVar2 == 0) {
      return 0;
    }
    pbVar3 = (byte *)(iVar2 + 0xd0);
    pbVar5 = param_2;
    do {
      bVar1 = *pbVar3;
      bVar6 = bVar1 < *pbVar5;
      if (bVar1 != *pbVar5) {
LAB_100276c4:
        iVar4 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_100276c9;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar6 = bVar1 < pbVar5[1];
      if (bVar1 != pbVar5[1]) goto LAB_100276c4;
      pbVar3 = pbVar3 + 2;
      pbVar5 = pbVar5 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_100276c9:
    if (iVar4 == 0) {
      return iVar2;
    }
    iVar2 = FUN_10022c60(param_1,(undefined4 *)0x0);
  } while( true );
}



void __cdecl FUN_100276f0(int param_1,uint param_2)

{
  void *this;
  
  this = (void *)FUN_10022bb0(param_1,param_2 & 0xffff);
  if ((this != (void *)0x0) && (*(uint *)((int)this + 8) != param_2)) {
    FUN_10026e10(this,param_2);
  }
  return;
}



int * __thiscall FUN_10027740(void *this,int *param_1,int *param_2,int param_3,int param_4)

{
  int *piVar1;
  int iVar2;
  void *this_00;
  int *piVar3;
  char local_24 [36];
  
  piVar1 = (int *)_malloc(0x1d4);
  piVar3 = piVar1;
  for (iVar2 = 0x75; iVar2 != 0; iVar2 = iVar2 + -1) {
    *piVar3 = 0;
    piVar3 = piVar3 + 1;
  }
  FUN_100273b0(this,(int)piVar1);
  piVar1[0x74] = param_3;
  piVar1[0x69] = *(int *)((int)this + 8);
  if (*(int *)((int)this + 0x1fc) <= param_3) {
    piVar1[0x45] = param_4 + 20000;
  }
  if (param_3 == 0) {
    FUN_10005ca0((char *)(piVar1 + 2),0x24,"%s.%s");
  }
  else {
    FUN_10005ca0(local_24,0x24,"%s.%s");
    FUN_10005ca0((char *)(piVar1 + 2),0x24,"%s%s%d");
  }
  FUN_10005ca0((char *)(piVar1 + 0xb),0x24,"%s%s%d");
  FUN_100229d0(this_00,param_1,(byte *)(piVar1 + 2),(int)piVar1);
  iVar2 = FUN_10026030(param_2,0,piVar1);
  *piVar1 = iVar2;
  *(int *)((int)this + 500) = *(int *)((int)this + 500) + 1;
  return piVar1;
}



void __thiscall FUN_10027bb0(void *this,int param_1)

{
  FUN_100273b0(this,param_1);
  *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 2;
  FUN_10005ca0((char *)(param_1 + 8),0x24,"%s.%s");
  FUN_10005ca0((char *)(param_1 + 0x2c),0x24,"%s%s%d");
  return;
}



int * __thiscall FUN_10027ee0(void *this,int param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  
  *(int *)this = param_1;
  puVar1 = FUN_10022cd0(param_1,param_1 / 10);
  *(undefined4 **)((int)this + 4) = puVar1;
  uVar2 = FUN_1002a660(0);
  *(undefined4 *)((int)this + 8) = uVar2;
  return (int *)this;
}



void __fastcall FUN_10027f20(int param_1)

{
  FUN_1002a690(*(void **)(param_1 + 8),'\x01');
  FUN_10022830(*(void **)(param_1 + 4));
  return;
}



void __thiscall FUN_10027f90(void *this,byte *param_1,char *param_2)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  undefined4 *puVar4;
  byte *pbVar5;
  char *pcVar6;
  int *piVar7;
  
  iVar3 = FUN_10022a90(this,*(int **)((int)this + 4),param_1);
  if (iVar3 == 0) {
    iVar3 = FUN_10022980(*(undefined4 **)((int)this + 4));
                    // WARNING: Load size is inaccurate
    if (iVar3 == *this) {
      puVar4 = (undefined4 *)FUN_1002a780(*(int *)((int)this + 8));
      FUN_10022a90((void *)*puVar4,*(int **)((int)this + 4),(byte *)*puVar4);
      FUN_1002a7a0(*(int **)((int)this + 8));
    }
  }
  else {
    FUN_1002a7f0(*(int **)((int)this + 8),iVar3,'\x01');
  }
  pbVar5 = param_1;
  do {
    bVar1 = *pbVar5;
    pbVar5 = pbVar5 + 1;
  } while (bVar1 != 0);
  pcVar6 = param_2;
  do {
    cVar2 = *pcVar6;
    pcVar6 = pcVar6 + 1;
  } while (cVar2 != '\0');
  piVar7 = FUN_1002a6e0(*(undefined4 *)((int)this + 8),
                        (int)(pbVar5 + (int)(pcVar6 + ((10 - (int)(param_2 + 1)) -
                                                      (int)(param_1 + 1)))));
  if (piVar7 != (int *)0x0) {
    *piVar7 = (int)(piVar7 + 2);
    piVar7[1] = (int)(pbVar5 + (9 - (int)(param_1 + 1)) + (int)piVar7);
    iVar3 = (int)(piVar7 + 2) - (int)param_1;
    do {
      bVar1 = *param_1;
      param_1[iVar3] = bVar1;
      param_1 = param_1 + 1;
    } while (bVar1 != 0);
    pcVar6 = (char *)piVar7[1];
    do {
      cVar2 = *param_2;
      param_2 = param_2 + 1;
      *pcVar6 = cVar2;
      pcVar6 = pcVar6 + 1;
    } while (cVar2 != '\0');
    FUN_100229d0((void *)*piVar7,*(int **)((int)this + 4),(byte *)*piVar7,(int)piVar7);
    FUN_1002a740(*(int **)((int)this + 8),(int)piVar7);
  }
  return;
}



void __fastcall FUN_10028080(int param_1)

{
  _free(*(void **)(param_1 + 0x144));
  *(undefined4 *)(param_1 + 0x144) = 0;
  _free(*(void **)(param_1 + 0x148));
  *(undefined4 *)(param_1 + 0x148) = 0;
  _free(*(void **)(param_1 + 0x150));
  *(undefined4 *)(param_1 + 0x150) = 0;
  return;
}



void __fastcall FUN_100280d0(undefined1 *param_1)

{
  *(undefined4 *)(param_1 + 0x140) = 0;
  *(undefined4 *)(param_1 + 0x144) = 0;
  *(undefined4 *)(param_1 + 0x148) = 0;
  *(undefined4 *)(param_1 + 0x14c) = 0;
  *(undefined4 *)(param_1 + 0x150) = 0;
  *(undefined4 *)(param_1 + 0x154) = 0;
  *param_1 = 0;
  param_1[0x40] = 0;
  return;
}



uint __thiscall
FUN_10028100(void *this,char *param_1,byte *param_2,char *param_3,int param_4,undefined4 param_5)

{
  void *pvVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  char *pcVar6;
  int iVar7;
  
  _free(*(void **)((int)this + 0x144));
  iVar7 = 0;
  *(undefined4 *)((int)this + 0x144) = 0;
  _free(*(void **)((int)this + 0x148));
  *(undefined4 *)((int)this + 0x148) = 0;
  _free(*(void **)((int)this + 0x150));
  *(undefined4 *)((int)this + 0x150) = 0;
  FUN_10005d70((char *)this,param_1,0x40);
  FUN_10005d70((char *)((int)this + 0x40),param_3,0x100);
  *(int *)((int)this + 0x140) = param_4;
  *(undefined4 *)((int)this + 0x154) = param_5;
  pvVar1 = operator_new(param_4 << 5);
  *(void **)((int)this + 0x144) = pvVar1;
  if (pvVar1 != (void *)0x0) {
    pvVar1 = operator_new(*(uint *)((int)this + 0x154));
    *(void **)((int)this + 0x150) = pvVar1;
    if (pvVar1 != (void *)0x0) {
      pvVar1 = operator_new(*(int *)((int)this + 0x140) << 3);
      *(void **)((int)this + 0x148) = pvVar1;
      if (pvVar1 != (void *)0x0) {
        iVar3 = FUN_10003940((byte *)((int)this + 0x40),(int)pvVar1,*(int *)((int)this + 0x140));
        iVar4 = FUN_10003680(param_2,*(byte **)((int)this + 0x144),0x20,&DAT_1004d26f,0,0x2c);
        pcVar5 = *(char **)((int)this + 0x144);
        pcVar6 = (char *)CONCAT31((int3)((uint)iVar4 >> 8),*pcVar5);
        if (*pcVar5 != '\0') {
          iVar4 = 0;
          do {
            iVar7 = iVar7 + 1;
            iVar4 = iVar4 + 0x20;
            FUN_10003680(param_2,(byte *)(pcVar5 + iVar4),0x20,&DAT_1004d26f,iVar7,0x2c);
            pcVar5 = *(char **)((int)this + 0x144);
            pcVar6 = pcVar5;
          } while (pcVar5[iVar4] != '\0');
        }
        if (iVar7 <= iVar3) {
          iVar3 = iVar7;
        }
        *(int *)((int)this + 0x14c) = iVar3;
        return CONCAT31((int3)((uint)pcVar6 >> 8),1);
      }
    }
  }
  uVar2 = FUN_10028080((int)this);
  return uVar2 & 0xffffff00;
}



void __thiscall FUN_10028260(void *this,byte *param_1)

{
                    // WARNING: Load size is inaccurate
  if (*this != '\0') {
    param_1 = FUN_100020f0(param_1,(byte *)this);
  }
  FUN_10002fe0(param_1,*(uint **)((int)this + 0x150),*(int *)((int)this + 0x154),
               (byte *)((int)this + 0x40));
  return;
}



void __thiscall FUN_100282a0(void *this,byte *param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  char *pcVar5;
  char *pcVar6;
  
  iVar4 = *(int *)((int)this + 0x14c);
  if (-1 < iVar4) {
    iVar2 = *(int *)((int)this + 0x148) + iVar4 * 8;
    pcVar6 = *(char **)(iVar2 + -4);
    switch(*(undefined4 *)(iVar2 + -8)) {
    case 0x61:
    case 0x62:
      pcVar6 = pcVar6 + 1;
      break;
    case 0x6c:
      pcVar6 = pcVar6 + 4;
      break;
    case 0x73:
      pcVar5 = (char *)(*(int *)(*(int *)((int)this + 0x148) + -4 + iVar4 * 8) +
                       *(int *)((int)this + 0x150));
      pcVar1 = pcVar5 + 1;
      do {
        cVar3 = *pcVar5;
        pcVar5 = pcVar5 + 1;
      } while (cVar3 != '\0');
      pcVar6 = pcVar5 + ((int)pcVar6 - (int)pcVar1);
      break;
    case 0x77:
      pcVar6 = pcVar6 + 2;
    }
    FUN_10002d30(param_1,param_2,(byte *)this,*(uint **)((int)this + 0x150),(int)pcVar6,
                 (byte *)((int)this + 0x40));
  }
  return;
}



int __thiscall FUN_10028350(void *this,int param_1)

{
  return param_1 * 0x20 + *(int *)((int)this + 0x144);
}



undefined * __thiscall FUN_10028370(void *this,int param_1)

{
  switch(*(undefined4 *)(*(int *)((int)this + 0x148) + param_1 * 8)) {
  case 0x62:
    return PTR_DAT_10057180;
  default:
    return PTR_DAT_10057190;
  case 0x6c:
    return PTR_s_int32_10057188;
  case 0x73:
    return PTR_DAT_1005718c;
  case 0x77:
    return PTR_s_int16_10057184;
  }
}



void __thiscall FUN_100283f0(void *this,int param_1,char *param_2,size_t param_3)

{
  char *pcVar1;
  
  switch(*(undefined4 *)(*(int *)((int)this + 0x148) + param_1 * 8)) {
  case 0x62:
    pcVar1 = "%d";
    break;
  default:
    *param_2 = '\0';
    return;
  case 0x6c:
    goto LAB_10028445;
  case 0x73:
    pcVar1 = "%s";
    break;
  case 0x77:
LAB_10028445:
    FUN_10005ca0(param_2,param_3,"%d");
    return;
  }
  FUN_10005ca0(param_2,param_3,pcVar1);
  return;
}



void __thiscall FUN_100284c0(void *this,int param_1,char *param_2)

{
  undefined4 *puVar1;
  long lVar2;
  size_t sVar3;
  
  if ((-1 < param_1) && (param_1 < *(int *)((int)this + 0x14c))) {
    puVar1 = (undefined4 *)(*(int *)((int)this + 0x148) + param_1 * 8);
    switch(*puVar1) {
    case 0x62:
      lVar2 = _atol(param_2);
      *(char *)(*(int *)(*(int *)((int)this + 0x148) + 4 + param_1 * 8) +
               *(int *)((int)this + 0x150)) = (char)lVar2;
      return;
    case 0x6c:
      lVar2 = _atol(param_2);
      *(long *)(*(int *)(*(int *)((int)this + 0x148) + 4 + param_1 * 8) +
               *(int *)((int)this + 0x150)) = lVar2;
      return;
    case 0x73:
      if (param_1 == *(int *)((int)this + 0x14c) + -1) {
        sVar3 = *(int *)((int)this + 0x154) - puVar1[1];
      }
      else {
        sVar3 = *(int *)(*(int *)((int)this + 0x148) + 0xc + param_1 * 8) -
                *(int *)(*(int *)((int)this + 0x148) + param_1 * 8 + 4);
      }
      FUN_10005d70((char *)(puVar1[1] + *(int *)((int)this + 0x150)),param_2,sVar3);
      break;
    case 0x77:
      lVar2 = _atol(param_2);
      *(short *)(*(int *)(*(int *)((int)this + 0x148) + 4 + param_1 * 8) +
                *(int *)((int)this + 0x150)) = (short)lVar2;
      return;
    }
  }
  return;
}



int * __cdecl FUN_100285e0(int param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  
  piVar1 = (int *)_malloc(0xc);
  *piVar1 = 0;
  piVar1[1] = 0;
  piVar1[2] = 0;
  if (param_1 < 6) {
    param_1 = 0x10;
  }
  *piVar1 = param_1;
  puVar2 = (undefined4 *)_malloc(param_1 << 4);
  piVar1[2] = (int)puVar2;
  for (uVar3 = (uint)(*piVar1 << 4) >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  return piVar1;
}



void __cdecl FUN_10028640(int *param_1)

{
  void *_Memory;
  int iVar1;
  int iVar2;
  
  iVar1 = 0;
  if (0 < *param_1) {
    iVar2 = 0;
    do {
      _Memory = *(void **)(iVar2 + 0xc + param_1[2]);
      if (_Memory != (void *)0x0) {
        _free(_Memory);
      }
      iVar1 = iVar1 + 1;
      iVar2 = iVar2 + 0x10;
    } while (iVar1 < *param_1);
  }
  _free((void *)param_1[2]);
  _free(param_1);
  return;
}



undefined4 * __cdecl FUN_10028690(int *param_1,size_t param_2)

{
  void *pvVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)(param_1[1] * 0x10 + param_1[2]);
  param_1[1] = (param_1[1] + 1) % *param_1;
  if ((0 < (int)puVar2[2]) && ((int)puVar2[2] < (int)param_2)) {
    _free((void *)puVar2[3]);
    puVar2[3] = &DAT_1004d26f;
    puVar2[2] = 0;
  }
  if ((puVar2[2] == 0) && (0 < (int)param_2)) {
    pvVar1 = _malloc(param_2);
    puVar2[3] = pvVar1;
    puVar2[2] = param_2;
  }
  puVar2[1] = 0;
  *puVar2 = 0;
  return puVar2;
}



u_long __cdecl FUN_10028700(u_long param_1)

{
  SOCKET s;
  int iVar1;
  hostent *phVar2;
  u_long uVar3;
  u_long netlong;
  undefined4 uStack_124;
  undefined4 uStack_120;
  u_long uStack_11c;
  undefined4 uStack_118;
  undefined4 uStack_114;
  undefined4 uStack_110;
  u_long uStack_10c;
  undefined4 uStack_108;
  undefined4 uStack_104;
  char acStack_100 [256];
  
  uVar3 = 0;
  s = socket(2,2,0);
  if (s == 0xffffffff) {
    return 0;
  }
  uStack_11c = 0;
  uStack_118 = 0;
  uStack_114 = 0;
  uStack_120 = 2;
  uStack_11c = htonl(param_1);
  uStack_110 = 0;
  uStack_10c = 0;
  uStack_108 = 0;
  uStack_104 = 0;
  uStack_124 = 0x10;
  iVar1 = WSAIoctl(s,0xc8000014,&uStack_120,0x10,&uStack_110,0x10,&uStack_124,0,0);
  netlong = uStack_10c;
  if (iVar1 < 0) {
    gethostname(acStack_100,0x100);
    phVar2 = gethostbyname(acStack_100);
    if (phVar2 == (hostent *)0x0) goto LAB_100287c0;
    netlong = *(u_long *)*phVar2->h_addr_list;
  }
  uVar3 = ntohl(netlong);
LAB_100287c0:
  closesocket(s);
  return uVar3;
}



u_long FUN_100287e0(void)

{
  byte bVar1;
  hostent *phVar2;
  byte *pbVar3;
  u_long uVar4;
  byte *unaff_EDI;
  
  bVar1 = *unaff_EDI;
  uVar4 = 0;
  pbVar3 = unaff_EDI;
  if (bVar1 != 0) {
    do {
      if (((char)bVar1 < '0') || ('9' < (char)bVar1)) {
        if (bVar1 != 0x2e) break;
        uVar4 = uVar4 << 8;
      }
      else {
        uVar4 = uVar4 & 0xffffff00 | (bVar1 & 0xf) + (uVar4 & 0xff) * 10;
      }
      bVar1 = pbVar3[1];
      pbVar3 = pbVar3 + 1;
    } while (bVar1 != 0);
    if (uVar4 != 0) {
      return uVar4;
    }
  }
  phVar2 = gethostbyname((char *)unaff_EDI);
  if (phVar2 == (hostent *)0x0) {
    WSAGetLastError();
  }
  else if ((u_long *)*phVar2->h_addr_list != (u_long *)0x0) {
    uVar4 = ntohl(*(u_long *)*phVar2->h_addr_list);
    return uVar4;
  }
  return uVar4;
}



void __cdecl FUN_10028860(undefined4 *param_1)

{
  byte *pbVar1;
  char cVar2;
  byte bVar3;
  u_short uVar4;
  char *in_EAX;
  SOCKET *pSVar5;
  SOCKET SVar6;
  u_long hostlong;
  __time32_t _Var7;
  int iVar8;
  byte *pbVar9;
  SOCKET *pSVar10;
  char *pcVar11;
  int local_118;
  u_long uStack_114;
  sockaddr sStack_110;
  byte local_100 [256];
  
  pSVar5 = (SOCKET *)param_1[0x88];
  local_118 = 0x50;
  if (pSVar5 == (SOCKET *)0x0) {
    pSVar5 = (SOCKET *)_malloc(0x250);
    pSVar10 = pSVar5;
    for (iVar8 = 0x94; iVar8 != 0; iVar8 = iVar8 + -1) {
      *pSVar10 = 0;
      pSVar10 = pSVar10 + 1;
    }
    *pSVar5 = 0xffffffff;
    pSVar5[2] = 0;
    param_1[0x88] = pSVar5;
  }
  else if (*pSVar5 != 0xffffffff) {
    shutdown(*pSVar5,2);
    closesocket(*pSVar5);
  }
  cVar2 = *in_EAX;
  while ((cVar2 != '\0' && (cVar2 < '!'))) {
    pcVar11 = in_EAX + 1;
    in_EAX = in_EAX + 1;
    cVar2 = *pcVar11;
  }
  iVar8 = _strncmp(in_EAX,"http:",5);
  if (iVar8 == 0) {
    in_EAX = in_EAX + 5;
  }
  cVar2 = *in_EAX;
  while ((cVar2 != '\0' && (cVar2 < '!'))) {
    pcVar11 = in_EAX + 1;
    in_EAX = in_EAX + 1;
    cVar2 = *pcVar11;
  }
  if ((*in_EAX == '/') && (in_EAX[1] == '/')) {
    pbVar9 = (byte *)(in_EAX + 2);
    iVar8 = 0;
    do {
      bVar3 = *pbVar9;
      if (((((char)bVar3 < '!') || (bVar3 == 0x2f)) || (bVar3 == 0x3f)) || (bVar3 == 0x3a)) break;
      pbVar9 = pbVar9 + 1;
      local_100[iVar8] = bVar3;
      iVar8 = iVar8 + 1;
    } while (iVar8 < 0xff);
    bVar3 = *pbVar9;
    local_100[iVar8] = 0;
    if (bVar3 == 0x3a) {
      bVar3 = pbVar9[1];
      pbVar9 = pbVar9 + 1;
      local_118 = 0;
      while (('/' < (char)bVar3 && ((char)bVar3 < ':'))) {
        pbVar9 = pbVar9 + 1;
        local_118 = (bVar3 & 0xf) + local_118 * 10;
        bVar3 = *pbVar9;
      }
    }
    bVar3 = *pbVar9;
    while ((bVar3 != 0 && ((char)bVar3 < '!'))) {
      pbVar1 = pbVar9 + 1;
      pbVar9 = pbVar9 + 1;
      bVar3 = *pbVar1;
    }
    if ((local_100[0] == 0) || (local_118 == 0)) {
      param_1[2] = 0xffffffff;
      FUN_10005ca0((char *)(param_1 + 0x48a),0x80,"HTTP server (%s) or port (%d) incorrect: %s");
      return;
    }
    iVar8 = 0;
    do {
      bVar3 = *pbVar9;
      if ((bVar3 == 0) || (bVar3 == 0x3a)) break;
      *(byte *)(iVar8 + 0x150 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[1];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 1;
        pbVar9 = pbVar9 + 1;
        break;
      }
      *(byte *)(iVar8 + 0x151 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[2];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 2;
        pbVar9 = pbVar9 + 2;
        break;
      }
      *(byte *)(iVar8 + 0x152 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[3];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 3;
        pbVar9 = pbVar9 + 3;
        break;
      }
      *(byte *)(iVar8 + 0x153 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[4];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 4;
        pbVar9 = pbVar9 + 4;
        break;
      }
      *(byte *)(iVar8 + 0x154 + (int)pSVar5) = bVar3;
      iVar8 = iVar8 + 5;
      pbVar9 = pbVar9 + 5;
    } while (iVar8 < 0xff);
    *(undefined1 *)(iVar8 + 0x150 + (int)pSVar5) = 0;
    if (*pbVar9 == 0x3a) {
      pbVar9 = pbVar9 + 1;
      iVar8 = 0;
      do {
        if (*pbVar9 == 0) break;
        *(byte *)(iVar8 + 0x10 + (int)pSVar5) = *pbVar9;
        if (pbVar9[1] == 0) {
          iVar8 = iVar8 + 1;
          break;
        }
        *(byte *)(iVar8 + 0x11 + (int)pSVar5) = pbVar9[1];
        if (pbVar9[2] == 0) {
          iVar8 = iVar8 + 2;
          break;
        }
        *(byte *)(iVar8 + 0x12 + (int)pSVar5) = pbVar9[2];
        iVar8 = iVar8 + 3;
        pbVar9 = pbVar9 + 3;
      } while (iVar8 < 0x3f);
      *(undefined1 *)(iVar8 + 0x10 + (int)pSVar5) = 0;
    }
    SVar6 = socket(2,1,0);
    *pSVar5 = SVar6;
    if (SVar6 != 0xffffffff) {
      sStack_110.sa_data[2] = '\0';
      sStack_110.sa_data[3] = '\0';
      sStack_110.sa_data[4] = '\0';
      sStack_110.sa_data[5] = '\0';
      sStack_110.sa_data[6] = '\0';
      sStack_110.sa_data[7] = '\0';
      sStack_110.sa_data[8] = '\0';
      sStack_110.sa_data[9] = '\0';
      sStack_110.sa_data[10] = '\0';
      sStack_110.sa_data[0xb] = '\0';
      sStack_110.sa_data[0xc] = '\0';
      sStack_110.sa_data[0xd] = '\0';
      sStack_110.sa_family = 2;
      sStack_110.sa_data[0] = '\0';
      sStack_110.sa_data[1] = '\0';
      hostlong = FUN_100287e0();
      sStack_110.sa_data._2_4_ = htonl(hostlong);
      uVar4 = htons((u_short)local_118);
      sStack_110.sa_data._0_2_ = uVar4;
      uStack_114 = 1;
      ioctlsocket(*pSVar5,-0x7ffb9982,&uStack_114);
      connect(*pSVar5,&sStack_110,0x10);
      pSVar5[2] = 1;
      _Var7 = FID_conflict___time32((__time32_t *)0x0);
      pSVar5[1] = _Var7 + 0x1e;
      pSVar5[3] = 0;
      *param_1 = 1;
      return;
    }
    pcVar11 = "Socket create failed: %s";
  }
  else {
    pcVar11 = "Not full URL (must start with //): %s";
  }
  param_1[2] = 0xffffffff;
  FUN_10005ca0((char *)(param_1 + 0x48a),0x80,pcVar11);
  return;
}



undefined4 __cdecl FUN_10028ba0(uint param_1)

{
  byte *in_EAX;
  int iVar1;
  char *unaff_EBX;
  char *unaff_EDI;
  
  iVar1 = FUN_10005cd0(in_EAX,&DAT_100520cc);
  if (iVar1 == 0) {
    if (param_1 == 0xffffffff) {
      FUN_10018990((int)unaff_EDI);
      return 0;
    }
    if (param_1 == 0xfffffffe) {
      FUN_10018a70(unaff_EDI,unaff_EBX,0x21);
      return 0x21;
    }
    FUN_100189c0(unaff_EDI,unaff_EBX,param_1);
  }
  return 0;
}



int __cdecl FUN_10028c00(char *param_1)

{
  char cVar1;
  int in_EAX;
  char *pcVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte bVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  char *_SubStr;
  undefined **ppuVar9;
  int iVar10;
  int local_18;
  int local_14;
  
  _SubStr = (char *)(in_EAX + 1);
  local_14 = 0;
  local_18 = 0;
  pcVar2 = _strstr(param_1,_SubStr);
  if (pcVar2 == (char *)0x0) {
    return 0;
  }
  do {
    cVar1 = *_SubStr;
    _SubStr = _SubStr + 1;
  } while (cVar1 != '\0');
  pbVar3 = (byte *)(pcVar2 + ((int)_SubStr - (in_EAX + 2)));
  bVar5 = *pbVar3;
  while (bVar5 == 0x20) {
    pbVar4 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar5 = *pbVar4;
  }
  if (PTR_DAT_100571c8 != (undefined *)0x0) {
    bVar5 = *pbVar3;
    ppuVar9 = &PTR_DAT_100571c8;
    pbVar4 = PTR_DAT_100571c8;
    do {
      if (((bVar5 == *pbVar4) && (pbVar3[1] == pbVar4[1])) && (pbVar3[2] == pbVar4[2])) {
        pbVar4 = pbVar3;
        if (bVar5 != 0x2c) goto LAB_10028ce0;
        goto LAB_10028cf3;
      }
      pbVar4 = ppuVar9[1];
      ppuVar9 = ppuVar9 + 1;
    } while (pbVar4 != (byte *)0x0);
  }
  goto LAB_10028c8e;
  while( true ) {
    bVar5 = pbVar3[1];
    pbVar3 = pbVar3 + 1;
    if (bVar5 == 0) break;
LAB_10028d10:
    if (('/' < (char)bVar5) && ((char)bVar5 < ':')) break;
  }
LAB_10028d22:
  local_18 = 0;
  bVar5 = *pbVar3;
  while (('/' < (char)bVar5 && ((char)bVar5 < ':'))) {
    pbVar3 = pbVar3 + 1;
    local_18 = (bVar5 & 0xf) + local_18 * 10;
    bVar5 = *pbVar3;
  }
  if (local_14 == 0) goto LAB_10028d53;
  goto LAB_10028dee;
LAB_10028dca:
  pbVar4 = (&PTR_DAT_10057198)[iVar10];
  iVar10 = iVar10 + 1;
  if (pbVar4 == (byte *)0x0) goto LAB_10028dee;
  goto LAB_10028db6;
  while( true ) {
    bVar5 = pbVar3[1];
    pbVar4 = pbVar3 + 1;
    if (bVar5 == 0x2c) break;
LAB_10028ce0:
    pbVar3 = pbVar4;
    if ((bVar5 == 0x20) || (bVar5 == 0)) goto LAB_10028cf3;
  }
  pbVar3 = pbVar3 + 2;
LAB_10028cf3:
  for (; (*pbVar3 == 0x2c || (*pbVar3 == 0x20)); pbVar3 = pbVar3 + 1) {
  }
LAB_10028c8e:
  bVar5 = *pbVar3;
  if (((char)bVar5 < '0') || ('9' < (char)bVar5)) {
    iVar10 = 0;
    pbVar4 = PTR_DAT_10057194;
    while (pbVar4 != (byte *)0x0) {
      if (((bVar5 == *pbVar4) && (pbVar3[1] == pbVar4[1])) && (pbVar3[2] == pbVar4[2])) {
        local_14 = iVar10 + 1;
        if (bVar5 != 0) goto LAB_10028d10;
        goto LAB_10028d22;
      }
      ppuVar9 = &PTR_DAT_10057198 + iVar10;
      iVar10 = iVar10 + 1;
      pbVar4 = *ppuVar9;
    }
  }
LAB_10028d53:
  bVar5 = *pbVar3;
  if ((char)bVar5 < '0') {
LAB_10028e60:
    bVar5 = *pbVar3;
    while ((bVar5 != 0 && (((char)bVar5 < '0' || ('9' < (char)bVar5))))) {
      pbVar4 = pbVar3 + 1;
      pbVar3 = pbVar3 + 1;
      bVar5 = *pbVar4;
    }
  }
  else {
    if (((char)bVar5 < ':') &&
       ((('@' < (char)pbVar3[1] || ('@' < (char)pbVar3[2])) || ('@' < (char)pbVar3[3])))) {
      local_18 = 0;
      do {
        if ('9' < (char)bVar5) break;
        local_18 = (bVar5 & 0xf) + local_18 * 10;
        pbVar3 = pbVar3 + 1;
        bVar5 = *pbVar3;
      } while ('/' < (char)bVar5);
      bVar5 = *pbVar3;
      while ((char)bVar5 < '@') {
        pbVar4 = pbVar3 + 1;
        pbVar3 = pbVar3 + 1;
        bVar5 = *pbVar4;
      }
      iVar10 = 0;
      if (PTR_DAT_10057194 != (undefined *)0x0) {
        bVar5 = *pbVar3;
        pbVar4 = PTR_DAT_10057194;
LAB_10028db6:
        if (((bVar5 != *pbVar4) || (pbVar3[1] != pbVar4[1])) || (pbVar3[2] != pbVar4[2]))
        goto LAB_10028dca;
        local_14 = iVar10 + 1;
        while ((bVar5 != 0 && (bVar5 != 0x20))) {
          pbVar4 = pbVar3 + 1;
          pbVar3 = pbVar3 + 1;
          bVar5 = *pbVar4;
        }
      }
    }
LAB_10028dee:
    bVar5 = *pbVar3;
    if ((((char)bVar5 < '0') || ('9' < (char)bVar5)) || (local_14 != 0)) goto LAB_10028e60;
    local_14 = 0;
    do {
      if ('9' < (char)bVar5) break;
      pbVar3 = pbVar3 + 1;
      local_14 = (bVar5 & 0xf) + local_14 * 10;
      bVar5 = *pbVar3;
    } while ('/' < (char)bVar5);
    if (*pbVar3 != 0) {
      pbVar3 = pbVar3 + 1;
    }
    bVar5 = *pbVar3;
    local_18 = 0;
    while (('/' < (char)bVar5 && ((char)bVar5 < ':'))) {
      local_18 = (bVar5 & 0xf) + local_18 * 10;
      pbVar3 = pbVar3 + 1;
      bVar5 = *pbVar3;
    }
    if (*pbVar3 != 0) {
      pbVar3 = pbVar3 + 1;
      goto LAB_10028e60;
    }
  }
  bVar5 = *pbVar3;
  if ((char)bVar5 < '0') {
    uVar8 = 0;
    uVar7 = 0;
    uVar6 = 0;
    pbVar4 = pbVar3;
  }
  else {
    if ((((char)bVar5 < ':') && (pbVar3[1] != 0x3a)) && (pbVar3[2] != 0x3a)) {
      iVar10 = 0;
      do {
        if ('9' < (char)bVar5) break;
        pbVar3 = pbVar3 + 1;
        iVar10 = (bVar5 & 0xf) + iVar10 * 10;
        bVar5 = *pbVar3;
      } while ('/' < (char)bVar5);
      if (iVar10 < 1000) {
        if (iVar10 < 0x32) {
          iVar10 = iVar10 + 2000;
        }
        else {
          iVar10 = iVar10 + 0x76c;
        }
      }
      bVar5 = *pbVar3;
      while ((bVar5 != 0 && (((char)bVar5 < '0' || ('9' < (char)bVar5))))) {
        pbVar4 = pbVar3 + 1;
        pbVar3 = pbVar3 + 1;
        bVar5 = *pbVar4;
      }
    }
    else {
      iVar10 = 0;
    }
    bVar5 = *pbVar3;
    if ((char)bVar5 < '0') {
      uVar6 = 0;
      pbVar4 = pbVar3;
LAB_10028f8d:
      uVar7 = 0;
LAB_10028f91:
      uVar8 = 0;
    }
    else {
      if ((char)bVar5 < ':') {
        uVar6 = bVar5 & 0xf;
        pbVar4 = pbVar3 + 1;
        bVar5 = *pbVar4;
        if (('/' < (char)bVar5) && ((char)bVar5 < ':')) {
          uVar6 = (bVar5 & 0xf) + uVar6 * 10;
          pbVar4 = pbVar3 + 2;
        }
        pbVar3 = pbVar4;
        if (*pbVar3 == 0x3a) {
          pbVar3 = pbVar3 + 1;
        }
      }
      else {
        uVar6 = 0;
      }
      bVar5 = *pbVar3;
      pbVar4 = pbVar3;
      if ((char)bVar5 < '0') goto LAB_10028f8d;
      if ((char)bVar5 < ':') {
        uVar7 = bVar5 & 0xf;
        pbVar4 = pbVar3 + 1;
        bVar5 = *pbVar4;
        if (('/' < (char)bVar5) && ((char)bVar5 < ':')) {
          uVar7 = (bVar5 & 0xf) + uVar7 * 10;
          pbVar4 = pbVar3 + 2;
        }
        pbVar3 = pbVar4;
        if (*pbVar3 == 0x3a) {
          pbVar3 = pbVar3 + 1;
        }
      }
      else {
        uVar7 = 0;
      }
      bVar5 = *pbVar3;
      pbVar4 = pbVar3;
      if (((char)bVar5 < '0') || ('9' < (char)bVar5)) goto LAB_10028f91;
      uVar8 = bVar5 & 0xf;
      pbVar4 = pbVar3 + 1;
      bVar5 = *pbVar4;
      if (('/' < (char)bVar5) && ((char)bVar5 < ':')) {
        uVar8 = (bVar5 & 0xf) + uVar8 * 10;
        pbVar4 = pbVar3 + 2;
      }
    }
    if (iVar10 != 0) goto LAB_10028fe6;
  }
  bVar5 = *pbVar4;
  while (((bVar5 != 0 && ((char)bVar5 < '0')) && ('9' < (char)bVar5))) {
    pbVar3 = pbVar4 + 1;
    pbVar4 = pbVar4 + 1;
    bVar5 = *pbVar3;
  }
  iVar10 = 0;
  bVar5 = *pbVar4;
  while (('/' < (char)bVar5 && ((char)bVar5 < ':'))) {
    pbVar4 = pbVar4 + 1;
    iVar10 = (bVar5 & 0xf) + iVar10 * 10;
    bVar5 = *pbVar4;
  }
LAB_10028fe6:
  iVar10 = _sprintf(param_1,"%d.%d.%d_%d:%02d:%02d",iVar10,local_14,local_18,uVar6,uVar7,uVar8);
  return iVar10;
}



int FUN_10029010(void)

{
  char cVar1;
  int in_EAX;
  char *pcVar2;
  char *unaff_EBX;
  char *pcVar3;
  int iVar4;
  
  iVar4 = 0;
  pcVar3 = (char *)(in_EAX + 1);
  pcVar2 = _strstr(unaff_EBX,pcVar3);
  if (pcVar2 != (char *)0x0) {
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar2 = pcVar2 + ((int)pcVar3 - (in_EAX + 2));
    cVar1 = *pcVar2;
    while ((cVar1 != '\0' && (cVar1 < '!'))) {
      pcVar3 = pcVar2 + 1;
      pcVar2 = pcVar2 + 1;
      cVar1 = *pcVar3;
    }
    cVar1 = *pcVar2;
    while ('\x1f' < cVar1) {
      unaff_EBX[iVar4] = cVar1;
      pcVar3 = pcVar2 + 1;
      iVar4 = iVar4 + 1;
      pcVar2 = pcVar2 + 1;
      cVar1 = *pcVar3;
    }
  }
  return iVar4;
}



void __cdecl FUN_10029070(undefined4 *param_1)

{
  byte *pbVar1;
  char cVar2;
  SOCKET *pSVar3;
  undefined1 *puVar4;
  byte bVar5;
  uint uVar6;
  undefined *puVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  SOCKET SVar11;
  char *pcVar12;
  byte *_Str1;
  undefined4 uVar13;
  char *pcVar14;
  
  pSVar3 = (SOCKET *)param_1[0x88];
  SVar11 = pSVar3[2];
  if ((((SVar11 == 1) || (SVar11 == 2)) || (SVar11 == 3)) &&
     (uVar6 = FID_conflict___time32((__time32_t *)0x0), pSVar3[1] < uVar6)) {
    FUN_10005ca0((char *)(param_1 + 0x48a),0x80,"Got network timeout: %s");
    pSVar3[2] = 5;
  }
  if (pSVar3[2] == 1) {
    if (((char)pSVar3[4] == '$') || (puVar7 = &DAT_1005224c, (char)pSVar3[4] == '@')) {
      puVar7 = &DAT_10052244;
    }
    iVar8 = _sprintf(*(char **)(param_1[1] + 4),
                     "%s %s HTTP/1.0\r\nAccept: */*\r\nContent-Length: 0\r\n\r\n",puVar7,
                     pSVar3 + 0x54);
    iVar9 = send(*pSVar3,*(char **)(param_1[1] + 4),iVar8,0);
    iVar10 = WSAGetLastError();
    if (((iVar9 != -1) || ((iVar10 != 0x2749 && (iVar10 != 0x2733)))) &&
       (SVar11 = ((iVar9 == iVar8) - 1 & 3) + 2, pSVar3[2] = SVar11, SVar11 == 5)) {
      FUN_10005ca0((char *)(param_1 + 0x48a),0x80,"Got connect error (%d/%d): %s");
    }
  }
  if (pSVar3[2] == 2) {
    iVar8 = recv(*pSVar3,(char *)(*(int *)(param_1[1] + 4) + pSVar3[3]),
                 *(int *)(param_1[1] + 8) - pSVar3[3],0);
    if (iVar8 == -1) {
      iVar8 = WSAGetLastError();
      if (iVar8 != 0x2733) {
LAB_100291b2:
        FUN_10005ca0((char *)(param_1 + 0x48a),0x80,"Got receive error (%d): %s");
        pSVar3[2] = 5;
      }
    }
    else {
      if (iVar8 < 0) goto LAB_100291b2;
      pSVar3[3] = pSVar3[3] + iVar8;
    }
    if ((pSVar3[2] == 2) && (4 < (int)pSVar3[3])) {
      pcVar12 = *(char **)(param_1[1] + 4);
      pcVar14 = pcVar12 + (pSVar3[3] - 3);
      if (pcVar12 == pcVar14) {
        return;
      }
      while ((((*pcVar12 != '\r' || (pcVar12[1] != '\n')) || (pcVar12[2] != '\r')) ||
             (pcVar12[3] != '\n'))) {
        pcVar12 = pcVar12 + 1;
        if (pcVar12 == pcVar14) {
          return;
        }
      }
      if (pcVar12 == pcVar14) {
        return;
      }
      pcVar12[3] = '\0';
      pcVar12[2] = '\0';
      _Str1 = *(byte **)(param_1[1] + 4);
      iVar8 = _strncmp((char *)_Str1,"HTTP",4);
      if (iVar8 != 0) {
        pcVar14 = "Got non-HTTP response: %s";
        goto LAB_100292b0;
      }
      bVar5 = *_Str1;
      while (bVar5 != 0) {
        if (bVar5 < 0x21) {
          bVar5 = *_Str1;
          if (bVar5 != 0) goto LAB_10029284;
          break;
        }
        pbVar1 = _Str1 + 1;
        _Str1 = _Str1 + 1;
        bVar5 = *pbVar1;
      }
      goto LAB_10029290;
    }
  }
  goto LAB_100293a1;
  while( true ) {
    bVar5 = _Str1[1];
    _Str1 = _Str1 + 1;
    if (bVar5 == 0) break;
LAB_10029284:
    if (0x20 < bVar5) break;
  }
LAB_10029290:
  iVar8 = _strncmp((char *)_Str1,"200",3);
  if (iVar8 != 0) {
    pcVar14 = "Got non-200 HTTP response: %s";
LAB_100292b0:
    FUN_10005ca0((char *)(param_1 + 0x48a),0x80,pcVar14);
    pSVar3[2] = 5;
    return;
  }
  uVar6 = (*(int *)(param_1[1] + 4) - (int)pcVar12) + -4 + pSVar3[3];
  cVar2 = (char)pSVar3[4];
  SVar11 = pSVar3[3] - uVar6;
  pSVar3[3] = SVar11;
  if (cVar2 == '$') {
    iVar8 = FUN_10029010();
    *(int *)(param_1[1] + 0xc) = iVar8;
    pSVar3[2] = 4;
    *param_1 = 3;
  }
  else if (cVar2 == '@') {
    iVar8 = FUN_10028c00(*(char **)(param_1[1] + 4));
    *(int *)(param_1[1] + 0xc) = iVar8;
    pSVar3[2] = 4;
    *param_1 = 3;
  }
  else {
    if (cVar2 == '#') {
      iVar8 = FUN_10005cd0((byte *)(pSVar3 + 4),&DAT_100520cc);
      if (iVar8 == 0) {
        FUN_10018990((int)(pSVar3 + 0x14));
      }
      FUN_10028ba0(uVar6);
    }
    else {
      _memmove(*(void **)(param_1[1] + 4),(void *)((int)*(void **)(param_1[1] + 4) + SVar11),uVar6);
      *(uint *)(param_1[1] + 0xc) = uVar6;
    }
    pSVar3[2] = 3;
  }
LAB_100293a1:
  if (pSVar3[2] != 3) goto LAB_10029445;
  iVar8 = param_1[1];
  uVar6 = recv(*pSVar3,(char *)(*(int *)(iVar8 + 4) + *(int *)(iVar8 + 0xc)),
               *(int *)(iVar8 + 8) - *(int *)(iVar8 + 0xc),0);
  if (uVar6 == 0xffffffff) {
    iVar8 = WSAGetLastError();
    if (iVar8 == 0x2733) goto LAB_10029445;
LAB_100293de:
    pSVar3[2] = 5;
    param_1[2] = 0xffffffff;
    FUN_10005ca0((char *)(param_1 + 0x48a),0x80,"Network error downloading: %s");
  }
  else if ((int)uVar6 < 1) {
    if (uVar6 != 0) goto LAB_100293de;
    if ((char)pSVar3[4] == '#') {
      puVar4 = *(undefined1 **)(param_1[1] + 4);
      uVar13 = 0;
      iVar8 = FUN_10005cd0((byte *)(pSVar3 + 4),&DAT_100520cc);
      if (iVar8 == 0) {
        FUN_10018a70(pSVar3 + 0x14,puVar4,0x21);
        uVar13 = 0x21;
      }
      *(undefined4 *)(param_1[1] + 0xc) = uVar13;
    }
    pSVar3[2] = 4;
    *param_1 = 3;
  }
  else if ((char)pSVar3[4] == '#') {
    FUN_10028ba0(uVar6);
  }
  else {
    *(int *)(param_1[1] + 0xc) = *(int *)(param_1[1] + 0xc) + uVar6;
  }
  if (*(int *)(param_1[1] + 8) <= *(int *)(param_1[1] + 0xc)) {
    pSVar3[2] = 5;
    param_1[2] = 0xfffffffc;
    FUN_10005ca0((char *)(param_1 + 0x48a),0x80,"Buffer overrun loading: %s");
  }
LAB_10029445:
  if ((pSVar3[2] == 5) || (pSVar3[2] == 4)) {
    if (*pSVar3 != 0xffffffff) {
      shutdown(*pSVar3,2);
      closesocket(*pSVar3);
    }
    *pSVar3 = 0xffffffff;
    *(undefined1 *)(*(int *)(param_1[1] + 0xc) + *(int *)(param_1[1] + 4)) = 0;
  }
  if ((pSVar3[2] == 5) && (param_1[2] == 1)) {
    param_1[2] = 0xffffffff;
    if (*(char *)(param_1 + 0x48a) == '\0') {
      FUN_10005ca0((char *)(param_1 + 0x48a),0x80,"HTTP transfer error: %s");
    }
  }
  return;
}



void __fastcall FUN_10029550(int param_1)

{
  char *in_EAX;
  FILE *_File;
  size_t sVar1;
  
  if ((in_EAX != (char *)0x0) && (*in_EAX != '\0')) {
    _File = (FILE *)FUN_100409a9(in_EAX,"rb");
    if (_File != (FILE *)0x0) {
      sVar1 = _fread(*(void **)(*(int *)(param_1 + 4) + 4),1,*(size_t *)(*(int *)(param_1 + 4) + 8),
                     _File);
      *(size_t *)(*(int *)(param_1 + 4) + 0xc) = sVar1;
      _fclose(_File);
      if (*(int *)(*(int *)(param_1 + 4) + 0xc) < 0) {
        *(undefined4 *)(param_1 + 8) = 0xfffffffd;
        FUN_10005ca0((char *)(param_1 + 0x1228),0x80,"File read error: %s");
        *(undefined4 *)(*(int *)(param_1 + 4) + 0xc) = 0;
      }
      return;
    }
    *(undefined4 *)(param_1 + 8) = 0xfffffffe;
    FUN_10005ca0((char *)(param_1 + 0x1228),0x80,"File not found: %s");
    return;
  }
  *(undefined4 *)(param_1 + 8) = 0xfffffffe;
  FUN_10005ca0((char *)(param_1 + 0x1228),0x80,"File not found: <null filename>");
  return;
}



undefined4 __cdecl FUN_10029630(int param_1,byte *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  
  if ((param_2 != (byte *)0x0) && (*param_2 != 0)) {
    iVar2 = 0;
    if (0 < *(int *)(param_1 + 0xc)) {
      puVar3 = (undefined4 *)(param_1 + 0x14);
      do {
        iVar1 = FUN_10005cd0(param_2,(byte *)*puVar3);
        if (iVar1 == 0) {
          return *(undefined4 *)(param_1 + 0x14 + iVar2 * 4);
        }
        iVar2 = iVar2 + 1;
        puVar3 = puVar3 + 1;
      } while (iVar2 < *(int *)(param_1 + 0xc));
    }
    return 0;
  }
  return *(undefined4 *)(param_1 + 0x14);
}



undefined4 * __cdecl FUN_10029690(int param_1,char *param_2)

{
  char cVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined4 *puVar4;
  
  puVar2 = (undefined4 *)0x0;
  if (param_2 == (char *)0x0) {
    param_2 = "";
  }
  if (*(int *)(param_1 + 0xc) < *(int *)(param_1 + 0x10)) {
    puVar2 = (undefined4 *)_malloc(0x4c);
    puVar4 = puVar2;
    for (iVar3 = 0x13; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    }
    iVar3 = (int)puVar2 - (int)param_2;
    do {
      cVar1 = *param_2;
      param_2[iVar3] = cVar1;
      param_2 = param_2 + 1;
    } while (cVar1 != '\0');
    puVar2[0x10] = &DAT_1004d26f;
    *(undefined4 **)(param_1 + 0x14 + *(int *)(param_1 + 0xc) * 4) = puVar2;
    *(int *)(param_1 + 0xc) = *(int *)(param_1 + 0xc) + 1;
  }
  return puVar2;
}



void __cdecl FUN_10029700(int param_1)

{
  void *_Memory;
  int iVar1;
  undefined4 *puVar2;
  
  iVar1 = 0;
  if (0 < *(int *)(param_1 + 0xc)) {
    puVar2 = (undefined4 *)(param_1 + 0x14);
    do {
      _Memory = (void *)*puVar2;
      if (0 < *(int *)((int)_Memory + 0x44)) {
        _free(*(void **)((int)_Memory + 0x40));
      }
      _free(_Memory);
      *puVar2 = 0;
      iVar1 = iVar1 + 1;
      puVar2 = puVar2 + 1;
    } while (iVar1 < *(int *)(param_1 + 0xc));
    *(undefined4 *)(param_1 + 0xc) = 0;
    return;
  }
  *(undefined4 *)(param_1 + 0xc) = 0;
  return;
}



void __cdecl FUN_10029760(int param_1,undefined1 param_2)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  
  if (param_1 != 0) {
    if (*(int *)(param_1 + 0x44) <= *(int *)(param_1 + 0x48)) {
      iVar2 = ((0x1fff < *(int *)(param_1 + 0x48)) - 1 & 0xffffe400) + 0x2000 +
              *(int *)(param_1 + 0x44);
      puVar1 = (undefined4 *)_malloc(iVar2 + 1);
      uVar4 = *(uint *)(param_1 + 0x48);
      if (0 < (int)uVar4) {
        puVar5 = *(undefined4 **)(param_1 + 0x40);
        puVar6 = puVar1;
        for (uVar3 = uVar4 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
          *puVar6 = *puVar5;
          puVar5 = puVar5 + 1;
          puVar6 = puVar6 + 1;
        }
        for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
          *(undefined1 *)puVar6 = *(undefined1 *)puVar5;
          puVar5 = (undefined4 *)((int)puVar5 + 1);
          puVar6 = (undefined4 *)((int)puVar6 + 1);
        }
      }
      if (0 < *(int *)(param_1 + 0x44)) {
        _free(*(void **)(param_1 + 0x40));
      }
      *(int *)(param_1 + 0x44) = iVar2;
      *(undefined4 **)(param_1 + 0x40) = puVar1;
    }
    *(undefined1 *)(*(int *)(param_1 + 0x48) + *(int *)(param_1 + 0x40)) = param_2;
    iVar2 = *(int *)(param_1 + 0x48) + 1;
    *(int *)(param_1 + 0x48) = iVar2;
    *(undefined1 *)(iVar2 + *(int *)(param_1 + 0x40)) = 0;
  }
  return;
}



void __cdecl FUN_10029800(int param_1,char *param_2)

{
  char *pcVar1;
  char cVar2;
  
  cVar2 = *param_2;
  while (cVar2 != '\0') {
    FUN_10029760(param_1,cVar2);
    pcVar1 = param_2 + 1;
    param_2 = param_2 + 1;
    cVar2 = *pcVar1;
  }
  return;
}



void FUN_10029830(void)

{
  uint *puVar1;
  int iVar2;
  char *unaff_EBX;
  uint *unaff_ESI;
  uint *puVar3;
  
  puVar1 = (uint *)_malloc(0x10094);
  puVar3 = puVar1;
  for (iVar2 = 0x4025; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar1[1] = (uint)(puVar1 + 0x25);
  puVar1[2] = 0x10000;
  *puVar1 = unaff_ESI[1];
  unaff_ESI[1] = (uint)puVar1;
  *unaff_ESI = 3;
  FUN_100020b0((char *)(puVar1 + 5),0x80,unaff_EBX);
  iVar2 = _strncmp(unaff_EBX,"http:",5);
  if (iVar2 == 0) {
    if ((int)unaff_ESI[0x89] < 0) {
      unaff_ESI[2] = 0xffffffff;
      FUN_10005ca0((char *)(unaff_ESI + 0x48a),0x80,"Include %s while HTTP disabled");
    }
    else if (unaff_ESI[0x89] != 0) {
      FUN_10028860(unaff_ESI);
      return;
    }
    puVar3 = (uint *)unaff_ESI[1];
    if (puVar3 != (uint *)0x0) {
      unaff_ESI[1] = *puVar3;
      _free(puVar3);
    }
    *unaff_ESI = -(uint)(unaff_ESI[1] != 0) & 3;
    return;
  }
  _strncmp(unaff_EBX,"file:",5);
  FUN_10029550((int)unaff_ESI);
  return;
}



int FUN_10029910(void)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *unaff_EDI;
  
  bVar2 = *unaff_EDI;
  pbVar5 = unaff_EDI;
  pbVar4 = unaff_EDI;
  while (bVar2 != 0) {
    bVar2 = *pbVar5;
    if (bVar2 == 9) {
      *pbVar4 = 0x20;
LAB_10029935:
      pbVar4 = pbVar4 + 1;
    }
    else if ((bVar2 == 10) || (0x1f < bVar2)) {
      *pbVar4 = bVar2;
      goto LAB_10029935;
    }
    pbVar3 = pbVar5 + 1;
    pbVar5 = pbVar5 + 1;
    bVar2 = *pbVar3;
  }
  *pbVar4 = 0;
  bVar2 = *unaff_EDI;
  pbVar5 = unaff_EDI;
  pbVar4 = unaff_EDI;
  pbVar3 = unaff_EDI;
  while (bVar2 != 0) {
    bVar2 = *pbVar5;
    if ((bVar2 == 0x23) && (pbVar3 != (byte *)0x0)) {
      do {
        pbVar1 = pbVar5 + 1;
        pbVar5 = pbVar5 + 1;
      } while (0x1f < *pbVar1);
      pbVar4 = pbVar3;
      if (*pbVar1 == 0) break;
    }
    else if (bVar2 == 10) {
      *pbVar4 = 10;
      pbVar3 = pbVar4 + 1;
      pbVar4 = pbVar3;
    }
    else if (bVar2 == 0x20) {
      *pbVar4 = 0x20;
      pbVar4 = pbVar4 + 1;
    }
    else {
      *pbVar4 = bVar2;
      pbVar3 = (byte *)0x0;
      pbVar4 = pbVar4 + 1;
    }
    pbVar1 = pbVar5 + 1;
    pbVar5 = pbVar5 + 1;
    bVar2 = *pbVar1;
  }
  *pbVar4 = 0;
  return (int)pbVar4 - (int)unaff_EDI;
}



int __cdecl FUN_100299a0(byte *param_1,int param_2,int param_3)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  
  iVar4 = 0;
  if (0x40 < *param_1) {
    pbVar3 = param_1;
    do {
      if (param_3 + -1 <= iVar4) break;
      iVar2 = _tolower((uint)*pbVar3);
      pbVar3[param_2 - (int)param_1] = (byte)iVar2;
      pbVar1 = pbVar3 + 1;
      iVar4 = iVar4 + 1;
      pbVar3 = pbVar3 + 1;
    } while (0x40 < *pbVar1);
  }
  *(undefined1 *)(iVar4 + param_2) = 0;
  if (param_1[iVar4] == 0x20) {
    iVar4 = iVar4 + 1;
  }
  return iVar4;
}



int __cdecl FUN_10029a00(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  char *unaff_EBX;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  bool bVar6;
  int local_48;
  char local_40 [64];
  
  iVar3 = 0;
  local_48 = 1;
  if (*unaff_EBX == '\0') {
    return 0;
  }
  do {
    iVar1 = iVar3;
    if ((unaff_EBX[iVar3] == '%') && (unaff_EBX[iVar3 + 1] == '%')) {
      iVar1 = FUN_100299a0((byte *)(unaff_EBX + iVar3 + 2),(int)local_40,0x40);
      iVar1 = iVar3 + 2 + iVar1;
      iVar2 = 3;
      bVar6 = true;
      pcVar4 = local_40;
      pcVar5 = "if";
      do {
        if (iVar2 == 0) break;
        iVar2 = iVar2 + -1;
        bVar6 = *pcVar4 == *pcVar5;
        pcVar4 = pcVar4 + 1;
        pcVar5 = pcVar5 + 1;
      } while (bVar6);
      if (bVar6) {
        local_48 = local_48 + 1;
      }
      else {
        iVar2 = 5;
        bVar6 = true;
        pcVar4 = local_40;
        pcVar5 = "else";
        do {
          if (iVar2 == 0) break;
          iVar2 = iVar2 + -1;
          bVar6 = *pcVar4 == *pcVar5;
          pcVar4 = pcVar4 + 1;
          pcVar5 = pcVar5 + 1;
        } while (bVar6);
        if (!bVar6) {
          iVar2 = 5;
          bVar6 = true;
          pcVar4 = local_40;
          pcVar5 = "elif";
          do {
            if (iVar2 == 0) break;
            iVar2 = iVar2 + -1;
            bVar6 = *pcVar4 == *pcVar5;
            pcVar4 = pcVar4 + 1;
            pcVar5 = pcVar5 + 1;
          } while (bVar6);
          if (!bVar6) {
            iVar2 = 6;
            bVar6 = true;
            pcVar4 = local_40;
            pcVar5 = "endif";
            do {
              if (iVar2 == 0) break;
              iVar2 = iVar2 + -1;
              bVar6 = *pcVar4 == *pcVar5;
              pcVar4 = pcVar4 + 1;
              pcVar5 = pcVar5 + 1;
            } while (bVar6);
            if ((bVar6) && (local_48 = local_48 + -1, local_48 < 1)) {
              return iVar3;
            }
            goto LAB_10029acf;
          }
        }
        if ((local_48 == 1) && (param_2 == 0)) {
          return iVar3;
        }
      }
    }
LAB_10029acf:
    iVar3 = iVar1 + 1;
    if (unaff_EBX[iVar1 + 1] == '\0') {
      return iVar3;
    }
  } while( true );
}



int __cdecl FUN_10029af0(int param_1,char *param_2)

{
  int iVar1;
  long lVar2;
  u_long uVar3;
  hostent *phVar4;
  int iVar5;
  undefined4 *puVar6;
  int iVar7;
  char *pcVar8;
  char *pcVar9;
  bool bVar10;
  undefined4 uVar11;
  char local_440 [64];
  byte local_400 [1024];
  
  if ((*param_2 != '%') || (param_2[1] != '%')) {
    return 1;
  }
  iVar1 = FUN_100299a0((byte *)(param_2 + 2),(int)local_440,0x40);
  iVar1 = iVar1 + 2;
  iVar7 = 5;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "else";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
LAB_1002a187:
    iVar7 = FUN_10029a00(param_1,1);
    return iVar1 + iVar7;
  }
  iVar7 = 5;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "elif";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) goto LAB_1002a187;
  iVar7 = 3;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "if";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    iVar7 = FUN_1003f120(param_1 + 0x228,0x1000,(byte *)(param_2 + iVar1),(char *)local_400,0x400);
    iVar1 = iVar1 + iVar7;
    lVar2 = _atol((char *)local_400);
    if (lVar2 != 0) {
      return iVar1;
    }
    do {
      iVar7 = FUN_10029a00(param_1,0);
      iVar1 = iVar1 + iVar7;
      if (param_2[iVar1] != '%') {
        return iVar1;
      }
      if (param_2[iVar1 + 1] != '%') {
        return iVar1;
      }
      iVar7 = FUN_100299a0((byte *)(param_2 + iVar1 + 2),(int)local_440,0x40);
      iVar7 = iVar1 + 2 + iVar7;
      iVar1 = 5;
      bVar10 = true;
      pcVar8 = local_440;
      pcVar9 = "elif";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar10 = *pcVar8 == *pcVar9;
        pcVar8 = pcVar8 + 1;
        pcVar9 = pcVar9 + 1;
      } while (bVar10);
      if (!bVar10) {
        return iVar7;
      }
      iVar1 = FUN_1003f120(param_1 + 0x228,0x1000,(byte *)(param_2 + iVar7),(char *)local_400,0x400)
      ;
      iVar1 = iVar7 + iVar1;
      lVar2 = _atol((char *)local_400);
      if (lVar2 != 0) {
        return iVar1;
      }
    } while( true );
  }
  iVar7 = 6;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "endif";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    return iVar1;
  }
  iVar7 = 8;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "include";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    iVar7 = FUN_1003f120(param_1 + 0x228,0x1000,(byte *)(param_2 + iVar1),(char *)local_400,0x400);
    if (local_400[0] == 0) {
      return iVar1 + iVar7;
    }
    FUN_10029830();
    return iVar1 + iVar7;
  }
  iVar7 = 4;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "env";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    iVar7 = FUN_1003f120(param_1 + 0x228,0x1000,(byte *)(param_2 + iVar1),(char *)local_400,0x400);
    return iVar1 + iVar7;
  }
  iVar7 = 5;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "expr";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (!bVar10) {
    iVar7 = 4;
    bVar10 = true;
    pcVar8 = local_440;
    pcVar9 = "var";
    do {
      if (iVar7 == 0) break;
      iVar7 = iVar7 + -1;
      bVar10 = *pcVar8 == *pcVar9;
      pcVar8 = pcVar8 + 1;
      pcVar9 = pcVar9 + 1;
    } while (bVar10);
    if (!bVar10) {
      iVar7 = 5;
      bVar10 = true;
      pcVar8 = local_440;
      pcVar9 = "parm";
      do {
        if (iVar7 == 0) break;
        iVar7 = iVar7 + -1;
        bVar10 = *pcVar8 == *pcVar9;
        pcVar8 = pcVar8 + 1;
        pcVar9 = pcVar9 + 1;
      } while (bVar10);
      if (!bVar10) {
        iVar7 = 4;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "dns";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          iVar7 = FUN_1003f120(param_1 + 0x228,0x1000,(byte *)(param_2 + iVar1),(char *)local_400,
                               0x400);
          uVar3 = FUN_100287e0();
          _sprintf((char *)local_400,"%d.%d.%d.%d",uVar3 >> 0x18,uVar3 >> 0x10 & 0xff,
                   uVar3 >> 8 & 0xff,uVar3 & 0xff);
          FUN_10029800(*(int *)(param_1 + 0x214),(char *)local_400);
          return iVar1 + iVar7;
        }
        iVar7 = 5;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "bind";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          iVar7 = FUN_1003f120(param_1 + 0x228,0x1000,(byte *)(param_2 + iVar1),(char *)local_400,
                               0x400);
          uVar3 = FUN_100287e0();
          uVar3 = FUN_10028700(uVar3);
          _sprintf((char *)local_400,"%d.%d.%d.%d",uVar3 >> 0x18,uVar3 >> 0x10 & 0xff,
                   uVar3 >> 8 & 0xff,uVar3 & 0xff);
          FUN_10029800(*(int *)(param_1 + 0x214),(char *)local_400);
          return iVar1 + iVar7;
        }
        iVar7 = 9;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "hostname";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          gethostname((char *)local_400,0x400);
          phVar4 = gethostbyname((char *)local_400);
          if (phVar4 == (hostent *)0x0) {
            return iVar1;
          }
          FUN_10029800(*(int *)(param_1 + 0x214),phVar4->h_name);
          return iVar1;
        }
        iVar7 = 8;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "section";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          iVar7 = FUN_1003f120(param_1 + 0x228,0x1000,(byte *)(param_2 + iVar1),(char *)local_400,
                               0x400);
          iVar5 = FUN_10029630(param_1,local_400);
          *(int *)(param_1 + 0x214) = iVar5;
          if (iVar5 != 0) {
            return iVar1 + iVar7;
          }
          puVar6 = FUN_10029690(param_1,(char *)local_400);
          *(undefined4 **)(param_1 + 0x214) = puVar6;
          return iVar1 + iVar7;
        }
        iVar7 = 0xb;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "endsection";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          uVar11 = FUN_10029630(param_1,&DAT_1004d26f);
          *(undefined4 *)(param_1 + 0x214) = uVar11;
          return iVar1;
        }
        iVar7 = 2;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "{";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if ((bVar10) && (*(int *)(param_1 + 0x218) == 0)) {
          *(undefined4 *)(param_1 + 0x218) = *(undefined4 *)(param_1 + 0x214);
          *(undefined4 *)(param_1 + 0x214) = *(undefined4 *)(param_1 + 0x21c);
          return iVar1;
        }
        iVar7 = 2;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "*";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if ((bVar10) && (*(int *)(param_1 + 0x218) != 0)) {
          FUN_10003ac0((byte *)(param_1 + 0x228),0x1000,*(byte **)(*(int *)(param_1 + 0x21c) + 0x40)
                      );
          if (*(int *)(*(int *)(param_1 + 0x21c) + 0x48) < 1) {
            return iVar1;
          }
          *(undefined4 *)(*(int *)(param_1 + 0x21c) + 0x48) = 0;
          **(undefined1 **)(*(int *)(param_1 + 0x21c) + 0x40) = 0;
          return iVar1;
        }
        iVar7 = 2;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "}";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if ((bVar10) && (*(int *)(param_1 + 0x218) != 0)) {
          FUN_10003ac0((byte *)(param_1 + 0x228),0x1000,*(byte **)(*(int *)(param_1 + 0x21c) + 0x40)
                      );
          if (0 < *(int *)(*(int *)(param_1 + 0x21c) + 0x48)) {
            *(undefined4 *)(*(int *)(param_1 + 0x21c) + 0x48) = 0;
            **(undefined1 **)(*(int *)(param_1 + 0x21c) + 0x40) = 0;
          }
          *(undefined4 *)(param_1 + 0x214) = *(undefined4 *)(param_1 + 0x218);
          *(undefined4 *)(param_1 + 0x218) = 0;
          return iVar1;
        }
        FUN_10029760(*(int *)(param_1 + 0x214),*param_2);
        FUN_10029760(*(int *)(param_1 + 0x214),*param_2);
        return 2;
      }
      iVar7 = *(int *)(param_1 + 0x218);
      if (iVar7 == 0) {
        iVar7 = *(int *)(param_1 + 0x214);
      }
      iVar7 = *(int *)(iVar7 + 0x40);
      uVar11 = 0;
      goto LAB_1002a15e;
    }
  }
  uVar11 = 0x1000;
  iVar7 = param_1 + 0x228;
LAB_1002a15e:
  iVar7 = FUN_1003f120(iVar7,uVar11,(byte *)(param_2 + iVar1),(char *)local_400,0x400);
  FUN_10029800(*(int *)(param_1 + 0x214),(char *)local_400);
  return iVar1 + iVar7;
}



int __cdecl FUN_1002a1c0(int param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  char *unaff_EDI;
  
  cVar1 = *unaff_EDI;
  iVar3 = 0;
  if (cVar1 != '\0') {
    while ((cVar1 != '%' || (unaff_EDI[iVar3 + 1] != '%'))) {
      FUN_10029760(*(int *)(param_1 + 0x214),cVar1);
      cVar1 = unaff_EDI[iVar3 + 1];
      iVar3 = iVar3 + 1;
      if (cVar1 == '\0') {
        return iVar3;
      }
    }
    iVar2 = FUN_10029af0(param_1,unaff_EDI + iVar3);
    iVar3 = iVar3 + iVar2;
  }
  return iVar3;
}



undefined4 * FUN_1002a210(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  WSADATA local_190;
  
  puVar1 = (undefined4 *)_malloc(0x12a8);
  puVar3 = puVar1;
  for (iVar2 = 0x4aa; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar1[4] = 0x80;
  puVar1[0x89] = 1;
  WSAStartup(2,&local_190);
  return puVar1;
}



void __cdecl FUN_1002a260(uint *param_1)

{
  SOCKET s;
  uint *_Memory;
  undefined4 *puVar1;
  
  if ((SOCKET *)param_1[0x88] != (SOCKET *)0x0) {
    s = *(SOCKET *)param_1[0x88];
    if (s != 0xffffffff) {
      shutdown(s,2);
      closesocket(*(SOCKET *)param_1[0x88]);
    }
    _free((void *)param_1[0x88]);
    param_1[0x88] = 0;
  }
  _Memory = (uint *)param_1[1];
  while (_Memory != (uint *)0x0) {
    if (_Memory != (uint *)0x0) {
      param_1[1] = *_Memory;
      _free(_Memory);
    }
    _Memory = (uint *)param_1[1];
    *param_1 = -(uint)(_Memory != (uint *)0x0) & 3;
  }
  FUN_10029700((int)param_1);
  puVar1 = FUN_10029690((int)param_1,"");
  param_1[0x85] = (uint)puVar1;
  puVar1 = FUN_10029690((int)param_1,"$");
  param_1[0x86] = 0;
  *(undefined1 *)(param_1 + 0x8a) = 0;
  *(undefined1 *)(param_1 + 0x48a) = 0;
  param_1[2] = 0;
  param_1[0x87] = (uint)puVar1;
  return;
}



void __cdecl FUN_1002a320(uint *param_1,undefined4 param_2,char *param_3)

{
  FUN_1002a260(param_1);
  FUN_100020b0((char *)(param_1 + 0x8a),0x1000,param_3);
  param_1[2] = 1;
  FUN_10029830();
  return;
}



void __cdecl FUN_1002a360(uint *param_1)

{
  uint uVar1;
  uint *_Memory;
  int iVar2;
  
  while( true ) {
    if (*param_1 == 1) {
      FUN_10029070(param_1);
    }
    if ((int)param_1[2] < 0) {
      *param_1 = 3;
    }
    if (param_1[2] != 1) {
      return;
    }
    if (*param_1 == 0) {
      param_1[2] = 0;
      return;
    }
    if (*param_1 != 3) break;
    uVar1 = param_1[1];
    if (*(int *)(uVar1 + 0x10) == 0) {
      iVar2 = FUN_10029910();
      *(int *)(uVar1 + 0xc) = iVar2;
    }
    iVar2 = FUN_1002a1c0((int)param_1);
    iVar2 = *(int *)(uVar1 + 0x10) + iVar2;
    *(int *)(uVar1 + 0x10) = iVar2;
    if (*(int *)(uVar1 + 0xc) <= iVar2) {
      _Memory = (uint *)param_1[1];
      if (_Memory != (uint *)0x0) {
        param_1[1] = *_Memory;
        _free(_Memory);
      }
      *param_1 = -(uint)(param_1[1] != 0) & 3;
    }
  }
  return;
}



void __cdecl FUN_1002a400(uint *param_1)

{
  uint *_Memory;
  uint uVar1;
  int iVar2;
  
  uVar1 = param_1[2];
  while (uVar1 == 1) {
    if (*param_1 == 1) {
      FUN_10029070(param_1);
    }
    if ((int)param_1[2] < 0) {
      *param_1 = 3;
    }
    if (param_1[2] == 1) {
      if (*param_1 == 0) {
        param_1[2] = 0;
      }
      else if (*param_1 == 3) {
        uVar1 = param_1[1];
        if (*(int *)(uVar1 + 0x10) == 0) {
          iVar2 = FUN_10029910();
          *(int *)(uVar1 + 0xc) = iVar2;
        }
        iVar2 = FUN_1002a1c0((int)param_1);
        iVar2 = *(int *)(uVar1 + 0x10) + iVar2;
        *(int *)(uVar1 + 0x10) = iVar2;
        if (*(int *)(uVar1 + 0xc) <= iVar2) {
          _Memory = (uint *)param_1[1];
          if (_Memory != (uint *)0x0) {
            param_1[1] = *_Memory;
            _free(_Memory);
          }
          *param_1 = -(uint)(param_1[1] != 0) & 3;
        }
      }
    }
    uVar1 = param_1[2];
  }
  return;
}



uint * __cdecl FUN_1002a4b0(uint *param_1)

{
  uint *puVar1;
  
  FUN_1002a360(param_1);
  if (param_1[2] == 0) {
    return (uint *)&DAT_1004d26f;
  }
  if (param_1[2] == 1) {
    puVar1 = (uint *)0x0;
  }
  else {
    puVar1 = param_1 + 0x48a;
    if ((char)param_1[0x48a] == '\0') {
      return (uint *)"Misc Error";
    }
  }
  return puVar1;
}



undefined1 * __cdecl FUN_1002a500(uint *param_1,byte *param_2)

{
  int iVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  
  puVar3 = (undefined1 *)0x0;
  FUN_1002a360(param_1);
  if (*param_1 == 0) {
    iVar1 = FUN_10029630((int)param_1,param_2);
    if (iVar1 != 0) {
      puVar3 = *(undefined1 **)(iVar1 + 0x40);
    }
  }
  puVar2 = &DAT_1004d26f;
  if (param_1[2] == 0) {
    puVar2 = puVar3;
  }
  return puVar2;
}



undefined1 * __cdecl FUN_1002a540(uint *param_1,int param_2,undefined4 *param_3)

{
  byte *pbVar1;
  undefined1 *puVar2;
  
  puVar2 = (undefined1 *)0x0;
  if ((-1 < param_2) && (param_2 < (int)param_1[3])) {
    pbVar1 = (byte *)param_1[param_2 + 5];
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = pbVar1;
    }
    puVar2 = FUN_1002a500(param_1,pbVar1);
  }
  return puVar2;
}



uint __cdecl FUN_1002a570(uint *param_1,int param_2,uint param_3)

{
  uint uVar1;
  
  if (param_2 == 0x73746174) {
    if (param_1[2] == 1) {
      FUN_1002a360(param_1);
    }
    return param_1[2];
  }
  uVar1 = 0;
  if (param_2 == 0x68747470) {
    param_1[0x89] = param_3;
    uVar1 = param_3;
  }
  return uVar1;
}



void __cdecl FUN_1002a5b0(int param_1,byte *param_2,char *param_3)

{
  char *pcVar1;
  char cVar2;
  undefined4 *puVar3;
  
  puVar3 = (undefined4 *)FUN_10029630(param_1,param_2);
  if ((puVar3 != (undefined4 *)0x0) ||
     (puVar3 = FUN_10029690(param_1,(char *)param_2), puVar3 != (undefined4 *)0x0)) {
    if (0 < (int)puVar3[0x11]) {
      _free((void *)puVar3[0x10]);
      puVar3[0x11] = 0;
      puVar3[0x12] = 0;
      puVar3[0x10] = &DAT_1004d26f;
    }
    cVar2 = *param_3;
    while (cVar2 != '\0') {
      FUN_10029760((int)puVar3,cVar2);
      pcVar1 = param_3 + 1;
      param_3 = param_3 + 1;
      cVar2 = *pcVar1;
    }
  }
  return;
}



undefined4 __cdecl FUN_1002a630(uint *param_1)

{
  if (param_1 != (uint *)0x0) {
    FUN_1002a260(param_1);
    FUN_10029700((int)param_1);
    _free(param_1);
    WSACleanup();
  }
  return 0;
}



void __cdecl FUN_1002a660(undefined4 param_1)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)_malloc(0x10);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[3] = param_1;
  return;
}



void __cdecl FUN_1002a690(void *param_1,char param_2)

{
  void *pvVar1;
  void *_Memory;
  
  if (param_1 != (void *)0x0) {
    if (param_2 != '\0') {
      _Memory = *(void **)((int)param_1 + 4);
      while (_Memory != (void *)0x0) {
        if (*(code **)((int)param_1 + 0xc) != (code *)0x0) {
          (**(code **)((int)param_1 + 0xc))((int)_Memory + 0xc);
        }
        pvVar1 = *(void **)((int)_Memory + 8);
        _free(_Memory);
        _Memory = pvVar1;
      }
    }
    _free(param_1);
  }
  return;
}



undefined4 * __cdecl FUN_1002a6e0(undefined4 param_1,int param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)_malloc(param_2 + 0xc);
  *puVar1 = param_1;
  puVar1[1] = 0;
  puVar1[2] = 0;
  return puVar1 + 3;
}



void __cdecl FUN_1002a710(int param_1,int param_2)

{
  if (param_2 != 0) {
    if (*(code **)(param_1 + 0xc) != (code *)0x0) {
      (**(code **)(param_1 + 0xc))(param_2);
    }
    _free((void *)(param_2 + -0xc));
  }
  return;
}



void __cdecl FUN_1002a740(int *param_1,int param_2)

{
  int iVar1;
  
  iVar1 = param_2 + -0xc;
  *(int *)(param_2 + -8) = param_1[2];
  *(undefined4 *)(param_2 + -4) = 0;
  if (param_1[2] != 0) {
    *(int *)(param_1[2] + 8) = iVar1;
  }
  param_1[2] = iVar1;
  if (param_1[1] == 0) {
    param_1[1] = iVar1;
  }
  *param_1 = *param_1 + 1;
  return;
}



int __cdecl FUN_1002a780(int param_1)

{
  if (*(int *)(param_1 + 4) != 0) {
    return *(int *)(param_1 + 4) + 0xc;
  }
  return 0;
}



void __cdecl FUN_1002a7a0(int *param_1)

{
  void *_Memory;
  int iVar1;
  
  _Memory = (void *)param_1[1];
  if (_Memory != (void *)0x0) {
    iVar1 = *(int *)((int)_Memory + 8);
    param_1[1] = iVar1;
    if (iVar1 != 0) {
      *(undefined4 *)(iVar1 + 4) = 0;
    }
    if ((void *)param_1[2] == _Memory) {
      param_1[2] = param_1[1];
    }
    *param_1 = *param_1 + -1;
    if ((code *)param_1[3] != (code *)0x0) {
      (*(code *)param_1[3])((int)_Memory + 0xc);
    }
    _free(_Memory);
  }
  return;
}



void __cdecl FUN_1002a7f0(int *param_1,int param_2,char param_3)

{
  void *_Memory;
  
  _Memory = (void *)(param_2 + -0xc);
  if (*(int *)(param_2 + -8) != 0) {
    *(undefined4 *)(*(int *)(param_2 + -8) + 8) = *(undefined4 *)(param_2 + -4);
  }
  if (*(int *)(param_2 + -4) != 0) {
    *(undefined4 *)(*(int *)(param_2 + -4) + 4) = *(undefined4 *)(param_2 + -8);
  }
  if (_Memory == (void *)param_1[1]) {
    param_1[1] = *(int *)(param_2 + -4);
  }
  if (_Memory == (void *)param_1[2]) {
    param_1[2] = *(int *)(param_2 + -8);
  }
  *param_1 = *param_1 + -1;
  if (param_3 != '\0') {
    if ((code *)param_1[3] != (code *)0x0) {
      (*(code *)param_1[3])(param_2);
    }
    _free(_Memory);
  }
  return;
}



undefined4 * __cdecl FUN_1002a860(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    return param_1;
  }
  return (undefined4 *)*param_1;
}



int __cdecl FUN_1002a870(undefined4 param_1,int param_2)

{
  int iVar1;
  
  iVar1 = *(int *)(param_2 + -4);
  if (iVar1 == 0) {
    return iVar1;
  }
  return iVar1 + 0xc;
}



void __cdecl FUN_1002a880(void *param_1)

{
  int iVar1;
  void *_Memory;
  void *_Memory_00;
  int iVar2;
  int iVar3;
  int local_4;
  
  _Memory_00 = param_1;
  local_4 = 0;
  if (*(int *)((int)param_1 + 0x10) != 0) {
    param_1 = (void *)0x0;
    do {
      iVar1 = *(int *)((int)_Memory_00 + 0xc);
      iVar3 = 0;
      if (*(int *)(iVar1 + 0xc + (int)param_1) != 0) {
        iVar2 = 0;
        do {
          _free(*(void **)(*(int *)((int)param_1 + iVar1 + 8) + iVar2 + 8));
          iVar3 = iVar3 + 1;
          iVar2 = iVar2 + 0x14;
        } while (iVar3 != *(int *)((int)param_1 + iVar1 + 0xc));
      }
      _free(*(void **)((int)param_1 + iVar1 + 8));
      local_4 = local_4 + 1;
      param_1 = (void *)((int)param_1 + 0x14);
    } while (local_4 != *(int *)((int)_Memory_00 + 0x10));
  }
  _free(*(void **)((int)_Memory_00 + 0xc));
  _Memory = *(void **)((int)_Memory_00 + 0x24);
  if (_Memory != (void *)0x0) {
    FUN_10023700((int)_Memory);
    _free(_Memory);
  }
  _free(_Memory_00);
  return;
}



undefined4 __cdecl FUN_1002a930(int param_1,int param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  uint local_20;
  byte *local_1c;
  uint local_18;
  int local_14;
  byte local_10 [12];
  
  uVar1 = *(uint *)(param_1 + 0x4320);
  uVar3 = 0;
  if ((uVar1 != 0) &&
     (uVar1 = *(int *)(param_1 + 0x403c) - *(int *)(param_3 + 0x42c), 0 < (int)uVar1)) {
    **(undefined1 **)(param_2 + 0x60) = 0;
    uVar1 = FUN_10021640(*(int *)(param_1 + 0x4320));
    if (0 < (int)uVar1) {
      local_20 = 0;
      if (*(int *)(param_1 + 0x2cccec) != 0) {
        do {
          iVar2 = FUN_10021690(*(int *)(param_1 + 0x4320),uVar3,&local_18,&local_14,(int *)&local_1c
                              );
          if (iVar2 != 0) {
            _sprintf((char *)local_10,"N%d",uVar3);
            FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),local_10,local_1c);
            _sprintf((char *)local_10,"S%d",uVar3);
            FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),local_10,local_18);
            local_20 = local_20 + 1;
          }
          uVar3 = uVar3 + 1;
        } while (uVar3 < *(uint *)(param_1 + 0x2cccec));
      }
      FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e76c,local_20);
      *(int *)(param_3 + 0x42c) = *(int *)(param_1 + 0x2ccce8) + *(int *)(param_1 + 0x403c);
      return CONCAT31((int3)((uint)param_3 >> 8),1);
    }
  }
  return uVar1 & 0xffffff00;
}



void __cdecl FUN_1002aa70(int param_1,byte *param_2)

{
  if (*(int **)(param_1 + 0x1948) != (int *)0x0) {
    FUN_10021610(*(int **)(param_1 + 0x1948),param_2);
    return;
  }
  return;
}



void FUN_1002aa90(void)

{
  int in_EAX;
  int *piVar1;
  int unaff_ESI;
  
  piVar1 = (int *)FUN_10026280(*(int *)(unaff_ESI + 0x1728),in_EAX);
  if (piVar1 != (int *)0x0) {
    if ((piVar1[1] & 0x40U) == 0) {
      FUN_10031220(unaff_ESI,piVar1);
      return;
    }
    piVar1[1] = piVar1[1] & 0xfff7ffff;
    piVar1[0x76] = piVar1[0x76] + 1;
    FUN_100260e0(*(int *)(unaff_ESI + 0x1728),*piVar1);
  }
  return;
}



byte * __cdecl FUN_1002aae0(int param_1,byte *param_2,int *param_3,uint *param_4,char param_5)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  byte *pbVar6;
  undefined4 uVar7;
  
  iVar1 = *(int *)(param_1 + 0x1740);
  pbVar6 = (byte *)0x0;
  pbVar2 = (byte *)FUN_1002a780(*(int *)(iVar1 + 0x118));
  do {
    while( true ) {
      while( true ) {
        if (pbVar2 == (byte *)0x0) {
          return pbVar6;
        }
        if (param_2 == pbVar2) goto LAB_1002abca;
        if (*(int *)(param_2 + 0x44) != *(int *)(pbVar2 + 0x44)) break;
        pbVar3 = (byte *)FUN_1002a870(*(undefined4 *)(iVar1 + 0x118),(int)pbVar2);
        FUN_1002a7f0(*(int **)(iVar1 + 0x118),(int)pbVar2,'\x01');
        pbVar2 = pbVar3;
      }
      if ((param_5 == '\0') || (0 < *(int *)(pbVar2 + 0x40))) break;
      uVar7 = *(undefined4 *)(iVar1 + 0x118);
LAB_1002abd2:
      pbVar2 = (byte *)FUN_1002a870(uVar7,(int)pbVar2);
    }
    uVar4 = FUN_100157f0(*(undefined4 *)(iVar1 + 0x10c),param_2,pbVar2,(int)pbVar6);
    if ((int)uVar4 < 0) {
LAB_1002abca:
      uVar7 = *(undefined4 *)(iVar1 + 0x118);
      goto LAB_1002abd2;
    }
    iVar5 = FUN_10026280(*(int *)(param_1 + 0x1614),*(int *)(pbVar2 + 0x44));
    if (iVar5 != 0) {
      *param_4 = uVar4;
      *param_3 = iVar5;
      pbVar6 = pbVar2;
      goto LAB_1002abca;
    }
    pbVar3 = (byte *)FUN_1002a870(*(undefined4 *)(iVar1 + 0x118),(int)pbVar2);
    FUN_1002a7f0(*(int **)(iVar1 + 0x118),(int)pbVar2,'\x01');
    pbVar2 = pbVar3;
  } while( true );
}



int FUN_1002acf0(void)

{
  int in_EAX;
  int iVar1;
  int unaff_EBX;
  char *pcVar2;
  int iVar3;
  
  iVar3 = 0;
  pcVar2 = (char *)(in_EAX + 0x1a64);
  do {
    if (*(int *)(pcVar2 + 0x48) == 0) {
      if (*pcVar2 == '\0') {
        return 0;
      }
      iVar1 = FUN_10038730(*(int *)(unaff_EBX + 0x2638),pcVar2);
      if (iVar1 != 0) {
        return iVar1;
      }
    }
    iVar3 = iVar3 + 1;
    pcVar2 = pcVar2 + 0x74;
    if (7 < iVar3) {
      return 0;
    }
  } while( true );
}



void __fastcall FUN_1002ad30(int param_1)

{
  int in_EAX;
  int iVar1;
  int iVar2;
  int *piVar3;
  
  iVar2 = *(int *)(param_1 + 0x1740);
  FUN_10016490(0x80);
  for (iVar1 = FUN_1002a780(*(int *)(iVar2 + 0x114)); iVar1 != 0;
      iVar1 = FUN_1002a870(*(undefined4 *)(iVar2 + 0x114),iVar1)) {
    if (*(int *)(iVar1 + 0x1824) == *(int *)(in_EAX + 0x10)) {
      if (*(int *)(in_EAX + 0xc) != *(int *)(iVar1 + 0x18c0)) {
        FUN_10016490(0x80);
        return;
      }
      FUN_10038670(*(int *)(param_1 + 0x2638),in_EAX);
      FUN_100385d0(*(int *)(param_1 + 0x2638),*(int *)(iVar1 + 0x1810));
      *(undefined4 *)(iVar1 + 0x180c) = 0;
      FUN_10016490(0x80);
      return;
    }
  }
  FUN_10016490(0x80);
  FUN_10038670(*(int *)(param_1 + 0x2638),in_EAX);
  iVar2 = 0;
  piVar3 = (int *)(*(int *)(param_1 + 0x2638) + 0xc);
  do {
    if (*piVar3 == iRam00001824) {
      FUN_100385d0(*(int *)(param_1 + 0x2638),iRam00001810);
      return;
    }
    iVar2 = iVar2 + 1;
    piVar3 = piVar3 + 6;
  } while (iVar2 < 8);
  return;
}



void FUN_1002ae40(void)

{
  int iVar1;
  int in_EAX;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  void *this;
  byte *pbVar8;
  int local_f50;
  int local_f4c;
  int local_f48;
  byte local_f3c [3900];
  
  iVar1 = *(int *)(in_EAX + 0x1740);
  local_f50 = 0;
  iVar2 = FUN_1002a780(*(int *)(iVar1 + 0x114));
  iVar7 = iVar2;
  if (iVar2 != 0) {
    do {
      if ((*(uint *)(iVar7 + 0x1828) & 0x40000) == 0) {
        *(undefined4 *)(iVar7 + 0x180c) = 7;
        *(undefined4 *)(iVar7 + 0x1820) = 0;
      }
      else if (*(int *)(iVar7 + 0x180c) == 0) {
        iVar3 = FUN_1002acf0();
        if (iVar3 != 0) {
          FUN_10016490(0x80);
          if (iVar7 == iVar2) {
            if (*(int *)(iVar3 + 0x10) == *(int *)(iVar7 + 0x1824)) {
              FUN_10016490(0x80);
              *(undefined4 *)(iVar7 + 0x180c) = 1;
            }
            else {
              FUN_1002ad30(in_EAX);
            }
          }
          break;
        }
        piVar4 = FUN_10038610(*(int *)(in_EAX + 0x2638));
        *(int **)(iVar7 + 0x1820) = piVar4;
        if (piVar4 == (int *)0x0) break;
        iVar3 = FUN_10038590(*(int *)(in_EAX + 0x2638));
        *(int *)(iVar7 + 0x1810) = iVar3;
        if (iVar3 == 0) {
          FUN_10038670(*(int *)(in_EAX + 0x2638),*(int *)(iVar7 + 0x1820));
          break;
        }
        *(undefined4 *)(*(int *)(iVar7 + 0x1820) + 0x10) = *(undefined4 *)(iVar7 + 0x1824);
        *(undefined4 *)(*(int *)(iVar7 + 0x1810) + 0xc) = *(undefined4 *)(iVar7 + 0x1824);
        local_f3c[0] = 0;
        iVar3 = 0;
        if (0 < *(int *)(iVar7 + 0x18c0)) {
          pbVar8 = (byte *)(iVar7 + 0x1a64);
          local_f4c = 0;
          local_f48 = 0;
          do {
            FUN_10005d70((char *)(*(int *)(iVar7 + 0x1820) + 0x14 + local_f4c),(char *)pbVar8,0x10);
            if (*(int *)(pbVar8 + 0x48) == 0) {
              FUN_10003e20(local_f3c,0xf3c,(byte *)"~PERS#=%s BIDX#=%d");
              iVar5 = FUN_10022a40(this,*(int *)(in_EAX + 0x1610),pbVar8);
              if (iVar5 != 0) {
                FUN_10003e20(local_f3c,0xf3c,(byte *)"~UID#=%s");
              }
              iVar3 = iVar3 + 1;
            }
            local_f4c = local_f4c + 0x10;
            local_f48 = local_f48 + 1;
            pbVar8 = pbVar8 + 0x74;
          } while (local_f48 < *(int *)(iVar7 + 0x18c0));
        }
        *(int *)(*(int *)(iVar7 + 0x1820) + 8) = iVar3;
        *(undefined1 **)(*(int *)(iVar7 + 0x1820) + 0x7a94) = &LAB_1002abf0;
        *(int *)(*(int *)(iVar7 + 0x1820) + 0x7a98) = in_EAX;
        FUN_10002370(local_f3c,0xf3c,(byte *)"BSLOT",**(uint **)(iVar7 + 0x1820));
        FUN_10002370(local_f3c,0xf3c,&DAT_1005100c,1);
        uVar6 = FUN_10038560(*(int *)(in_EAX + 0x2638));
        *(undefined4 *)(*(int *)(iVar7 + 0x1810) + 8) = uVar6;
        FUN_10022490(*(undefined4 **)(in_EAX + 0x19b0),0x2a626174,
                     -*(int *)(*(int *)(iVar7 + 0x1810) + 8),(char *)local_f3c,(char *)0xffffffff);
        *(int *)(iVar7 + 0x1814) = *(int *)(in_EAX + 0x1994) + 30000;
        local_f50 = local_f50 + 1;
        *(undefined4 *)(iVar7 + 0x180c) = 1;
      }
      iVar7 = FUN_1002a870(*(undefined4 *)(iVar1 + 0x114),iVar7);
    } while (iVar7 != 0);
    if (0 < local_f50) {
      FUN_1002a860(*(undefined4 **)(iVar1 + 0x114));
      FUN_10016490(0x80);
    }
  }
  return;
}



void FUN_1002b150(void)

{
  int iVar1;
  int in_EAX;
  FILE *_File;
  undefined4 *puVar2;
  undefined4 uVar3;
  void *pvVar4;
  undefined4 local_8;
  undefined4 local_4;
  
  iVar1 = *(int *)(in_EAX + 0x1740);
  if (*(char *)(iVar1 + 0x138) != '\0') {
    _File = (FILE *)FUN_100409a9((char *)(iVar1 + 0x138),"w");
    if (_File == (FILE *)0x0) {
      FUN_10016490(0x80);
      return;
    }
    local_4 = 0;
    local_8 = 0x29a3e;
    puVar2 = FUN_1002a860(*(undefined4 **)(iVar1 + 0x114));
    local_4 = CONCAT22(local_4._2_2_,(short)puVar2);
    uVar3 = FUN_10022980(*(undefined4 **)(iVar1 + 0x110));
    local_4 = CONCAT22((short)uVar3,(undefined2)local_4);
    _fwrite(&local_8,8,1,_File);
    for (pvVar4 = (void *)FUN_1002a780(*(int *)(iVar1 + 0x114)); pvVar4 != (void *)0x0;
        pvVar4 = (void *)FUN_1002a870(*(undefined4 *)(iVar1 + 0x114),(int)pvVar4)) {
      _fwrite(pvVar4,0x3080,1,_File);
    }
    FUN_10022c50(*(int *)(iVar1 + 0x110));
    pvVar4 = (void *)FUN_10022c60(*(int *)(iVar1 + 0x110),(undefined4 *)0x0);
    while (pvVar4 != (void *)0x0) {
      _fwrite(pvVar4,0x3080,1,_File);
      pvVar4 = (void *)FUN_10022c60(*(int *)(iVar1 + 0x110),(undefined4 *)0x0);
    }
    _fclose(_File);
    FUN_10016490(0x80);
  }
  return;
}



void FUN_1002b2a0(void)

{
  int iVar1;
  int in_EAX;
  FILE *_File;
  size_t sVar2;
  undefined4 *_DstBuf;
  int iVar3;
  undefined4 local_8;
  uint local_4;
  
  iVar1 = *(int *)(in_EAX + 0x1740);
  if (*(char *)(iVar1 + 0x138) != '\0') {
    _File = (FILE *)FUN_100409a9((char *)(iVar1 + 0x138),"r");
    if (_File == (FILE *)0x0) {
      FUN_10016490(0x80);
      return;
    }
    local_8 = 0;
    local_4 = 0;
    sVar2 = _fread(&local_8,8,1,_File);
    if (sVar2 != 1) {
      FUN_10016490(0x80);
      return;
    }
    if (((short)local_8 == -0x65c2) && (local_8._2_2_ == 2)) {
      iVar3 = 0;
      if ((local_4 >> 0x10) + (local_4 & 0xffff) != 0) {
        do {
          _DstBuf = FUN_1002a6e0(*(undefined4 *)(iVar1 + 0x114),0x3080);
          sVar2 = _fread(_DstBuf,0x3080,1,_File);
          if (sVar2 != 1) {
            FUN_1002a710(*(int *)(iVar1 + 0x114),(int)_DstBuf);
            FUN_10016490(0x80);
            break;
          }
          _DstBuf[0x604] = 0;
          _DstBuf[0x603] = 0;
          _DstBuf[0x609] = 0;
          _DstBuf[0x608] = 0;
          FUN_1002a740(*(int **)(iVar1 + 0x114),(int)_DstBuf);
          iVar3 = iVar3 + 1;
        } while (iVar3 < (int)((local_4 >> 0x10) + (local_4 & 0xffff)));
      }
      _fclose(_File);
      FUN_10016490(0x80);
      return;
    }
    FUN_10016490(0x80);
  }
  return;
}



int * __cdecl FUN_1002b470(int param_1,int param_2,int *param_3)

{
  char cVar1;
  int *piVar2;
  byte *pbVar3;
  char *pcVar4;
  byte *pbVar5;
  int iVar6;
  int *unaff_EBX;
  int *piVar7;
  int iVar8;
  int iVar9;
  
  iVar9 = *(int *)(param_1 + 0x1740);
  piVar2 = (int *)FUN_10026c10(*(undefined4 *)(param_1 + 0x172c));
  piVar7 = piVar2;
  for (iVar6 = 0x1bc; iVar6 != 0; iVar6 = iVar6 + -1) {
    *piVar7 = 0;
    piVar7 = piVar7 + 1;
  }
  _sprintf((char *)(piVar2 + 3),"%s vs %s",param_3 + 8,unaff_EBX + 8);
  piVar2[1] = param_2;
  piVar2[0x24] = 0;
  FUN_10005d70((char *)(piVar2 + 0x90),(char *)(param_3 + 8),0x10);
  piVar2[0x97] = param_3[0xb4];
  FUN_10005d70((char *)(piVar2 + 0xad),(char *)(unaff_EBX + 8),0x10);
  iVar6 = unaff_EBX[0xb4];
  piVar2[0x27] = 2;
  piVar2[0x26] = 2;
  piVar2[0x25] = 2;
  piVar2[0xb4] = iVar6;
  iVar6 = FUN_10026280(*(int *)(param_1 + 0x15f8),param_3[0xc]);
  if (iVar6 != 0) {
    FUN_10005d70((char *)(piVar2 + 0xa3),(char *)(iVar6 + 8),0x24);
  }
  if (param_3[0xc] != unaff_EBX[0xc]) {
    iVar6 = FUN_10026280(*(int *)(param_1 + 0x15f8),unaff_EBX[0xc]);
  }
  if (iVar6 != 0) {
    FUN_10005d70((char *)(piVar2 + 0xc0),(char *)(iVar6 + 8),0x24);
  }
  pbVar5 = (byte *)(piVar2 + 0x31);
  FUN_100020b0((char *)pbVar5,0x84,(char *)(unaff_EBX + 0x13));
  FUN_10003ac0(pbVar5,0x84,(byte *)(param_3 + 0x13));
  iVar6 = 0;
  pbVar3 = FUN_100020f0(pbVar5,&DAT_10052824);
  iVar6 = FUN_10002480((char *)pbVar3,iVar6);
  iVar8 = 0;
  piVar2[0x53] = iVar6;
  pbVar3 = FUN_100020f0(pbVar5,(byte *)"EVGID");
  iVar6 = FUN_10002480((char *)pbVar3,iVar8);
  piVar2[0x54] = iVar6;
  FUN_10003a20(pbVar5,&DAT_10052824);
  FUN_10003a20(pbVar5,(byte *)"EVGID");
  iVar6 = FUN_10003320((char *)0x0,0);
  piVar2[0x52] = iVar6;
  pcVar4 = (char *)(iVar9 + 8);
  iVar9 = 0xa0 - (int)pcVar4;
  do {
    cVar1 = *pcVar4;
    pcVar4[(int)piVar2 + iVar9] = cVar1;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  _sprintf((char *)(piVar2 + 0xc),"%s:%u",piVar2 + 3,piVar2[0x52]);
  piVar2[0x76] = piVar2[0x76] + 1;
  FUN_10031470(param_1,piVar2);
  param_3[0xd] = *piVar2;
  *(undefined1 *)(param_3 + 0xf) = 0;
  param_3[1] = param_3[1] + 1;
  iVar9 = 1;
  unaff_EBX[0xd] = *piVar2;
  unaff_EBX[1] = unaff_EBX[1] + 1;
  *(undefined1 *)(unaff_EBX + 0xf) = 0;
  pbVar5 = FUN_100020f0(pbVar5,(byte *)"START");
  iVar9 = FUN_10002480((char *)pbVar5,iVar9);
  if (iVar9 == 1) {
    FUN_100312f0(param_1,piVar2);
    return piVar2;
  }
  FUN_100260e0(*(int *)(param_1 + 0x1614),*param_3);
  FUN_100260e0(*(int *)(param_1 + 0x1614),*unaff_EBX);
  return piVar2;
}



void __cdecl FUN_1002b6d0(int param_1,int param_2)

{
  int *in_EAX;
  int iVar1;
  int *unaff_ESI;
  
  if (0 < param_2) {
    iVar1 = FUN_100159c0();
    if (iVar1 != 0) {
      *(undefined1 *)(unaff_ESI + 0x13) = 0;
    }
    FUN_1002b470(param_1,0x60000,unaff_ESI);
    return;
  }
  iVar1 = FUN_100159c0();
  if (iVar1 != 0) {
    *(undefined1 *)(unaff_ESI + 0x13) = 0;
  }
  FUN_1002b470(param_1,0x60000,in_EAX);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_1002b860(int param_1,undefined4 param_2,byte *param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  bool bVar5;
  char *_Format;
  int iVar6;
  int iVar7;
  byte local_103c [256];
  char local_f3c [3896];
  undefined4 uStack_4;
  
  uStack_4 = 0x1002b86a;
  local_f3c[0] = '\0';
  local_103c[0] = 0;
  pbVar1 = (byte *)FUN_10038a50(*(void **)(param_1 + 0x12755f0),(byte *)"tour/stats");
  if (pbVar1 == (byte *)0x0) {
    local_f3c[0] = '\0';
    thunk_FUN_10038930(*(void **)(param_1 + 0x12755f0),(byte *)"tour/stats",local_f3c);
    pbVar1 = (byte *)FUN_10038a50(*(void **)(param_1 + 0x12755f0),(byte *)"tour/stats");
  }
  switch(param_2) {
  case 7:
    iVar6 = 0;
    pbVar2 = FUN_100020f0(param_3,&DAT_1004e76c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    _sprintf((char *)local_103c,"TOUR_CREATE_%i",iVar6);
    iVar6 = 0;
    pbVar2 = FUN_100020f0(pbVar1,local_103c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    FUN_10002370(pbVar1,0xf3c,local_103c,iVar6 + 1);
    break;
  case 8:
    iVar6 = 0;
    pbVar2 = FUN_100020f0(param_3,&DAT_1004e76c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    _Format = "TOUR_START_%i";
    goto LAB_1002b966;
  case 9:
    iVar6 = 0;
    pbVar2 = FUN_100020f0(param_3,&DAT_1004e76c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    _sprintf((char *)local_103c,"TOUR_COMPLETE_%i",iVar6);
    iVar6 = 0;
    pbVar2 = FUN_100020f0(pbVar1,local_103c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    FUN_10002370(pbVar1,0xf3c,local_103c,iVar6 + 1);
    pbVar2 = FUN_100020f0(param_3,&DAT_1004df60);
    for (pbVar2 = FUN_100038b0(pbVar2,local_103c,0x100); pbVar2 != (byte *)0x0;
        pbVar2 = FUN_100038b0(pbVar2,local_103c,0x100)) {
      FUN_10003810((char *)pbVar2,(char *)local_103c,0x100);
      iVar6 = 8;
      bVar5 = true;
      pbVar3 = local_103c;
      pbVar4 = (byte *)"EXTTYPE";
      do {
        if (iVar6 == 0) break;
        iVar6 = iVar6 + -1;
        bVar5 = *pbVar3 == *pbVar4;
        pbVar3 = pbVar3 + 1;
        pbVar4 = pbVar4 + 1;
      } while (bVar5);
      if ((!bVar5) && (local_103c[0] != 0)) {
        iVar6 = 0;
        pbVar3 = FUN_100020f0(pbVar1,local_103c);
        iVar6 = FUN_10002480((char *)pbVar3,iVar6);
        iVar7 = 0;
        pbVar3 = FUN_100020f0(pbVar2,local_103c);
        iVar7 = FUN_10002480((char *)pbVar3,iVar7);
        FUN_10002370(pbVar1,0xf3c,local_103c,iVar6 + iVar7);
      }
    }
    break;
  case 10:
    iVar6 = 0;
    pbVar2 = FUN_100020f0(param_3,&DAT_1004e76c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    _Format = "QUIK_CREATE_%i";
LAB_1002b966:
    _sprintf((char *)local_103c,_Format,iVar6);
    iVar6 = 0;
    pbVar2 = FUN_100020f0(pbVar1,local_103c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    FUN_10002370(pbVar1,0xf3c,local_103c,iVar6 + 1);
    break;
  case 0xb:
    iVar6 = 0;
    pbVar2 = FUN_100020f0(param_3,&DAT_1004e76c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    _sprintf((char *)local_103c,"QUIK_START_%i",iVar6);
    iVar6 = 0;
    pbVar2 = FUN_100020f0(pbVar1,local_103c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    FUN_10002370(pbVar1,0xf3c,local_103c,iVar6 + 1);
    break;
  case 0xc:
    iVar6 = 0;
    pbVar2 = FUN_100020f0(param_3,&DAT_1004e76c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    _sprintf((char *)local_103c,"QUIK_COMPLETE_%i",iVar6);
    iVar6 = 0;
    pbVar2 = FUN_100020f0(pbVar1,local_103c);
    iVar6 = FUN_10002480((char *)pbVar2,iVar6);
    FUN_10002370(pbVar1,0xf3c,local_103c,iVar6 + 1);
    pbVar2 = FUN_100020f0(param_3,&DAT_1004df60);
    for (pbVar2 = FUN_100038b0(pbVar2,local_103c,0x100); pbVar2 != (byte *)0x0;
        pbVar2 = FUN_100038b0(pbVar2,local_103c,0x100)) {
      FUN_10003810((char *)pbVar2,(char *)local_103c,0x100);
      iVar6 = 8;
      bVar5 = true;
      pbVar3 = local_103c;
      pbVar4 = (byte *)"EXTTYPE";
      do {
        if (iVar6 == 0) break;
        iVar6 = iVar6 + -1;
        bVar5 = *pbVar3 == *pbVar4;
        pbVar3 = pbVar3 + 1;
        pbVar4 = pbVar4 + 1;
      } while (bVar5);
      if ((!bVar5) && (local_103c[0] != 0)) {
        iVar6 = 0;
        pbVar3 = FUN_100020f0(pbVar1,local_103c);
        iVar6 = FUN_10002480((char *)pbVar3,iVar6);
        iVar7 = 0;
        pbVar3 = FUN_100020f0(pbVar2,local_103c);
        iVar7 = FUN_10002480((char *)pbVar3,iVar7);
        FUN_10002370(pbVar1,0xf3c,local_103c,iVar6 + iVar7);
      }
    }
  }
  FUN_10038a90(*(void **)(param_1 + 0x12755f0),(byte *)"tour/stats");
  return;
}



undefined4 __cdecl FUN_1002be20(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int *piVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  int iVar6;
  int iVar7;
  undefined4 *puVar8;
  byte *pbVar9;
  int local_11c;
  uint local_118;
  byte *local_114;
  byte local_110 [64];
  undefined4 local_d0;
  int local_cc;
  int local_c8;
  int local_c4;
  
  iVar7 = *(int *)(param_1 + 0x1740);
  pbVar1 = local_110;
  for (iVar6 = 0x41; iVar6 != 0; iVar6 = iVar6 + -1) {
    pbVar1[0] = 0;
    pbVar1[1] = 0;
    pbVar1[2] = 0;
    pbVar1[3] = 0;
    pbVar1 = pbVar1 + 4;
  }
  iVar6 = 0;
  local_118 = 0;
  local_11c = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  local_cc = FUN_10002480((char *)pbVar1,iVar6);
  local_c8 = *(int *)(iVar7 + 0x11c) + *(int *)(param_1 + 0x1994);
  pbVar9 = &DAT_1004d26f;
  local_c4 = *(int *)(iVar7 + 0x120) + *(int *)(param_1 + 0x1994);
  iVar6 = 0x40;
  pbVar1 = local_110;
  local_d0 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e68c);
  FUN_10002a30(pbVar2,pbVar1,iVar6,pbVar9);
  piVar3 = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),local_cc);
  if (piVar3 != (int *)0x0) {
    if (local_110[0] == 0x2a) {
      local_11c = FUN_1002a780(*(int *)(iVar7 + 0x118));
      do {
        if (local_11c == 0) {
LAB_1002bf45:
          piVar3[2] = piVar3[2] & 0xffffff7f;
          piVar3[0xd] = 0;
          piVar3[0xe] = 0;
          FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar3);
          uVar4 = FUN_10010d10(param_2);
          return uVar4;
        }
        if (local_cc == *(int *)(local_11c + 0x44)) {
          FUN_1002a870(*(undefined4 *)(iVar7 + 0x118),local_11c);
          FUN_1002a7f0(*(int **)(iVar7 + 0x118),local_11c,'\x01');
          goto LAB_1002bf45;
        }
        local_11c = FUN_1002a870(*(undefined4 *)(iVar7 + 0x118),local_11c);
      } while( true );
    }
    iVar6 = FUN_100156b0(*(int *)(iVar7 + 0x10c),*(byte **)(param_2 + 0x7c),(int)piVar3,
                         (int)local_110);
    if (iVar6 == 0) {
      if (0 < *(int *)(iVar7 + 0x120)) {
        puVar5 = FUN_1002a6e0(*(undefined4 *)(iVar7 + 0x118),0x104);
        pbVar1 = local_110;
        puVar8 = puVar5;
        for (iVar6 = 0x41; iVar6 != 0; iVar6 = iVar6 + -1) {
          *puVar8 = *(undefined4 *)pbVar1;
          pbVar1 = pbVar1 + 4;
          puVar8 = puVar8 + 1;
        }
        FUN_1002a740(*(int **)(iVar7 + 0x118),(int)puVar5);
        uVar4 = FUN_10010d10(param_2);
        return uVar4;
      }
      local_114 = FUN_1002aae0(param_1,local_110,&local_11c,&local_118,'\0');
      if (local_114 == (byte *)0x0) {
        puVar5 = FUN_1002a6e0(*(int **)(iVar7 + 0x118),0x104);
        pbVar1 = local_110;
        puVar8 = puVar5;
        for (iVar6 = 0x41; iVar6 != 0; iVar6 = iVar6 + -1) {
          *puVar8 = *(undefined4 *)pbVar1;
          pbVar1 = pbVar1 + 4;
          puVar8 = puVar8 + 1;
        }
        FUN_1002a740(*(int **)(iVar7 + 0x118),(int)puVar5);
        uVar4 = FUN_10010d10(param_2);
        return uVar4;
      }
      FUN_1002a7f0(*(int **)(iVar7 + 0x118),(int)local_114,'\0');
      *(undefined1 *)(piVar3 + 0x13) = 0;
      *(undefined1 *)(local_11c + 0x4c) = 0;
      FUN_1002b6d0(param_1,local_118);
      FUN_1002a710(*(int *)(iVar7 + 0x118),(int)local_114);
      uVar4 = FUN_10010d10(param_2);
      return uVar4;
    }
    iVar7 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar7;
    *(int *)(param_2 + 0x54) = iVar6;
    *(undefined4 *)(param_2 + 0x58) = 0;
  }
  return 0;
}



undefined4 __cdecl FUN_1002c0b0(int param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  byte *pbVar5;
  byte *pbVar6;
  char *pcVar7;
  undefined4 *puVar8;
  char *pcVar9;
  int *piVar10;
  char *local_48;
  int local_44;
  char local_40 [64];
  
  iVar2 = *(int *)(param_1 + 0x1740);
  iVar3 = FUN_1002a780(*(int *)(iVar2 + 0x118));
  while (iVar3 != 0) {
    iVar4 = FUN_10026280(*(int *)(param_1 + 0x1614),*(int *)(iVar3 + 0x44));
    if (iVar4 == 0) {
      iVar4 = FUN_1002a870(*(undefined4 *)(iVar2 + 0x118),iVar3);
      FUN_1002a7f0(*(int **)(iVar2 + 0x118),iVar3,'\x01');
      iVar3 = iVar4;
    }
    else {
      iVar3 = FUN_1002a870(*(undefined4 *)(iVar2 + 0x118),iVar3);
    }
  }
  for (iVar3 = FUN_1002a780(*(int *)(iVar2 + 0x118)); iVar3 != 0;
      iVar3 = FUN_1002a870(*(undefined4 *)(iVar2 + 0x118),iVar3)) {
    if (*(int *)(param_1 + 0x1994) != *(int *)(iVar3 + 0x4c) &&
        -1 < *(int *)(param_1 + 0x1994) - *(int *)(iVar3 + 0x4c)) {
      *(int *)(iVar3 + 0x40) = *(int *)(iVar3 + 0x40) + 1;
    }
  }
  pbVar5 = (byte *)FUN_1002a780(*(int *)(iVar2 + 0x118));
joined_r0x1002c177:
  do {
    if (pbVar5 == (byte *)0x0) {
      pcVar7 = (char *)FUN_1002a780(*(int *)(iVar2 + 0x118));
      local_48 = pcVar7;
      if (((*(int *)(iVar2 + 0x11c) != 0) &&
          (puVar8 = FUN_1002a860(*(undefined4 **)(iVar2 + 0x118)), 1 < (int)puVar8)) &&
         (*(int *)(param_1 + 0x1994) != *(int *)(pcVar7 + 0x48) &&
          -1 < *(int *)(param_1 + 0x1994) - *(int *)(pcVar7 + 0x48))) {
        FUN_1002a7f0(*(int **)(iVar2 + 0x118),(int)pcVar7,'\0');
        pcVar9 = pcVar7;
        do {
          cVar1 = *pcVar9;
          pcVar9[(int)(local_40 + -(int)pcVar7)] = cVar1;
          pcVar9 = pcVar9 + 1;
        } while (cVar1 != '\0');
        piVar10 = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),*(int *)(pcVar7 + 0x44));
        iVar3 = FUN_1002a780(*(int *)(iVar2 + 0x118));
        FUN_1002a7f0(*(int **)(iVar2 + 0x118),iVar3,'\0');
        local_44 = FUN_10026280(*(int *)(param_1 + 0x1614),*(int *)(iVar3 + 0x44));
        iVar4 = FUN_100159c0();
        if (iVar4 != 0) {
          *(undefined1 *)(piVar10 + 0x13) = 0;
        }
        FUN_1002b470(param_1,0x60000,piVar10);
        FUN_1002a710(*(int *)(iVar2 + 0x118),(int)local_48);
        FUN_1002a710(*(int *)(iVar2 + 0x118),iVar3);
      }
      FUN_10033e30(param_1);
      return 0;
    }
    if (*(int *)(param_1 + 0x1994) != *(int *)(pbVar5 + 0x4c) &&
        -1 < *(int *)(param_1 + 0x1994) - *(int *)(pbVar5 + 0x4c)) {
      pbVar6 = FUN_1002aae0(param_1,pbVar5,&local_44,(uint *)&local_48,'\x01');
      if (pbVar6 != (byte *)0x0) {
        FUN_10026280(*(int *)(param_1 + 0x1614),*(int *)(pbVar5 + 0x44));
        FUN_1002b6d0(param_1,(int)local_48);
        FUN_1002a7f0(*(int **)(iVar2 + 0x118),(int)pbVar6,'\x01');
        pbVar6 = (byte *)FUN_1002a870(*(undefined4 *)(iVar2 + 0x118),(int)pbVar5);
        FUN_1002a7f0(*(int **)(iVar2 + 0x118),(int)pbVar5,'\x01');
        pbVar5 = pbVar6;
        goto joined_r0x1002c177;
      }
      *(int *)(pbVar5 + 0x4c) = *(int *)(pbVar5 + 0x4c) + *(int *)(iVar2 + 0x120);
    }
    pbVar5 = (byte *)FUN_1002a870(*(undefined4 *)(iVar2 + 0x118),(int)pbVar5);
  } while( true );
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

undefined4 __cdecl FUN_1002c870(int param_1,int param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  uint uVar4;
  int *piVar5;
  bool bVar6;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  byte local_1fac [16];
  byte local_1f9c [32];
  byte local_1f7c [64];
  byte local_1f3c [196];
  byte local_1e78 [3900];
  byte local_f3c [3896];
  undefined4 uStack_4;
  
  uStack_4 = 0x1002c87a;
  pbVar9 = &DAT_1004d26f;
  iVar7 = 0xf3c;
  pbVar3 = local_f3c;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CUSRINP");
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar9);
  FUN_10003a20(*(byte **)(param_2 + 0x7c),(byte *)"CUSRINP");
  iVar7 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar7 = FUN_10002480((char *)pbVar3,iVar7);
  FUN_10003a20(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10005d70((char *)local_1e78,*(char **)(param_2 + 0x7c),0xf3c);
  uVar4 = FUN_10015c60();
  if ((uVar4 & 1) == 0) {
    iVar7 = -1;
    pbVar3 = FUN_100020f0(local_1e78,&DAT_1005100c);
    iVar7 = FUN_10002480((char *)pbVar3,iVar7);
    pbVar9 = &DAT_1004d26f;
    iVar8 = 0x10;
    pbVar3 = local_1fac;
    pbVar2 = FUN_100020f0(local_1e78,&DAT_1004d8d8);
    FUN_10002a30(pbVar2,pbVar3,iVar8,pbVar9);
    if ((iVar7 != -1) && (local_1fac[0] != 0)) {
      FUN_10003e20(local_1f7c,0x40,(byte *)"PERS=%s LOCK=%d");
      FUN_10022490(*(undefined4 **)(param_1 + 0x19b0),0x2a756c6b,0,(char *)local_1f7c,
                   (char *)0xffffffff);
    }
  }
  else {
    pbVar9 = &DAT_1004d26f;
    iVar8 = 0x20;
    pbVar3 = local_1f9c;
    pbVar2 = FUN_100020f0(local_f3c,&DAT_1004dff4);
    FUN_10002a30(pbVar2,pbVar3,iVar8,pbVar9);
    if (local_1f9c[0] != 0) {
      FUN_10003cf0(local_1e78,0xf3c,&DAT_1004dff4,local_1f9c);
    }
    FUN_10022490(*(undefined4 **)(param_1 + 0x19b0),0x2a707574,0,(char *)local_1e78,
                 (char *)0xffffffff);
    piVar5 = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar7);
    if (piVar5 != (int *)0x0) {
      pbVar9 = &DAT_1004d26f;
      iVar7 = 0xc4;
      pbVar3 = local_1f3c;
      pbVar2 = FUN_100020f0(local_1e78,&DAT_1004e754);
      FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar9);
      pbVar3 = (byte *)(piVar5 + 0x34);
      pbVar2 = local_1f3c;
      do {
        bVar1 = *pbVar3;
        bVar6 = bVar1 < *pbVar2;
        if (bVar1 != *pbVar2) {
LAB_1002ca47:
          iVar7 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
          goto LAB_1002ca4c;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar3[1];
        bVar6 = bVar1 < pbVar2[1];
        if (bVar1 != pbVar2[1]) goto LAB_1002ca47;
        pbVar3 = pbVar3 + 2;
        pbVar2 = pbVar2 + 2;
      } while (bVar1 != 0);
      iVar7 = 0;
LAB_1002ca4c:
      if (iVar7 != 0) {
        FUN_100020b0((char *)(piVar5 + 0x34),0xc4,(char *)local_1f3c);
        piVar5[1] = piVar5[1] + 1;
        FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar5);
      }
    }
  }
  iVar7 = *(int *)(param_2 + 0x70);
  *(undefined4 *)(param_2 + 0x28) = 0;
  if (-1 < iVar7) {
    iVar7 = *(int *)(param_2 + 0x6c);
  }
  *(int *)(param_2 + 0x50) = iVar7;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0;
  if (**(char **)(param_2 + 0x60) != '\0') {
    *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  }
  return 0;
}



undefined4 __cdecl FUN_1002cd00(void *param_1)

{
  int iVar1;
  void *this;
  int iVar2;
  byte *pbVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  int iVar9;
  uint uVar10;
  byte *pbVar11;
  undefined1 *puVar12;
  undefined4 uVar13;
  int local_1c;
  int local_18;
  byte local_10 [16];
  
  iVar1 = *(int *)((int)param_1 + 0x1740);
  local_1c = 0;
  if (*(int *)((int)param_1 + 0x19bc) == 0) {
    uVar13 = 0;
    puVar12 = &LAB_1002ccf0;
    uVar10 = 1000;
    this = (void *)FUN_10022980(*(undefined4 **)((int)param_1 + 0x1400));
    FUN_100230b0(this,uVar10,puVar12,uVar13,param_1);
    return 0;
  }
  iVar2 = FUN_1002a780(*(int *)(iVar1 + 0x114));
  if (iVar2 != 0) {
    do {
      if (*(int *)(iVar2 + 0x180c) == 0) {
        if (*(int *)(iVar2 + 0x181c) == 0) {
          *(undefined4 *)(iVar2 + 0x180c) = 7;
          goto LAB_1002cd92;
        }
        if (local_1c < 1) goto LAB_1002d236;
LAB_1002d223:
        FUN_10016490(0x80);
LAB_1002d236:
        FUN_1002ae40();
        return 0;
      }
LAB_1002cd92:
      if (*(int *)(iVar2 + 0x180c) == 1) {
        piVar4 = *(int **)(iVar2 + 0x1810);
        piVar5 = (int *)*piVar4;
        if ((piVar5 != (int *)0x0) && (-piVar4[2] == *piVar5)) {
          if (piVar5[1] == 0) {
            iVar7 = *(int *)(iVar2 + 0x1820);
            if (*(int *)(iVar7 + 0xc) == *(int *)(iVar7 + 8)) {
              iVar6 = 0;
              *(undefined4 *)(iVar2 + 0x180c) = 2;
              if (0 < *(int *)(iVar2 + 0x18c0)) {
                piVar5 = (int *)(iVar7 + 0x94);
                do {
                  iVar9 = *piVar5;
                  if ((iVar9 == 0x74696d65) || (iVar9 == 0x64626572)) {
                    if (iVar7 != 0) {
                      FUN_100385d0(*(int *)((int)param_1 + 0x2638),(int)piVar4);
                      FUN_10038670(*(int *)((int)param_1 + 0x2638),*(int *)(iVar2 + 0x1820));
                    }
                    goto LAB_1002ce9b;
                  }
                  if (iVar9 != 0) goto LAB_1002ce13;
                  iVar6 = iVar6 + 1;
                  piVar5 = piVar5 + 1;
                } while (iVar6 < *(int *)(iVar2 + 0x18c0));
              }
            }
          }
          else {
            if (*(int *)(iVar2 + 0x1820) != 0) {
              FUN_100385d0(*(int *)((int)param_1 + 0x2638),(int)piVar4);
              FUN_10038670(*(int *)((int)param_1 + 0x2638),*(int *)(iVar2 + 0x1820));
            }
            iVar7 = *(int *)(**(int **)(iVar2 + 0x1810) + 4);
            if ((iVar7 == 0x74696d65) || (iVar7 == 0x64626572)) {
LAB_1002ce9b:
              *(undefined4 *)(iVar2 + 0x180c) = 0;
            }
            else {
LAB_1002ce13:
              *(undefined4 *)(iVar2 + 0x180c) = 7;
            }
          }
        }
        if (*(int *)(iVar2 + 0x180c) == 1) {
          if (*(int *)((int)param_1 + 0x1994) == *(int *)(iVar2 + 0x1814) ||
              *(int *)((int)param_1 + 0x1994) - *(int *)(iVar2 + 0x1814) < 0) {
            if (local_1c < 1) {
              return 0;
            }
            goto LAB_1002d223;
          }
          if (*(int *)(iVar2 + 0x1820) != 0) {
            FUN_100385d0(*(int *)((int)param_1 + 0x2638),*(int *)(iVar2 + 0x1810));
            FUN_10038670(*(int *)((int)param_1 + 0x2638),*(int *)(iVar2 + 0x1820));
          }
          *(undefined4 *)(iVar2 + 0x180c) = 0;
        }
      }
      if (*(int *)(iVar2 + 0x180c) == 2) {
        uVar13 = FUN_100156a0();
        *(undefined4 *)(iVar2 + 0x1818) = uVar13;
        *(undefined4 *)(iVar2 + 0x180c) = 3;
      }
      if (*(int *)(iVar2 + 0x180c) == 3) {
        iVar7 = 0;
        local_18 = 0;
        if (0 < *(int *)(iVar2 + 0x18c0)) {
          do {
            if (*(char *)(iVar7 + 0xb4 + *(int *)(iVar2 + 0x1820)) == '\0') break;
            FUN_10003a20((byte *)(iVar7 + 0xb4 + *(int *)(iVar2 + 0x1820)),(byte *)"LPPERS");
            FUN_10003e20((byte *)(iVar7 + 0xb4 + *(int *)(iVar2 + 0x1820)),0xf3c,(byte *)"~LPPERS=")
            ;
            iVar6 = 0;
            if (0 < *(int *)(*(int *)(iVar2 + 0x1820) + 0xc)) {
              do {
                if (iVar6 != local_18) {
                  FUN_10003e20((byte *)(iVar7 + 0xb4 + *(int *)(iVar2 + 0x1820)),0xf3c,&DAT_10051940
                              );
                }
                iVar6 = iVar6 + 1;
              } while (iVar6 < *(int *)(*(int *)(iVar2 + 0x1820) + 0xc));
            }
            FUN_10016490(0x80);
            FUN_10022490(*(undefined4 **)((int)param_1 + 0x19b0),0x2a707574,0,
                         (char *)(iVar7 + 0xb4 + *(int *)(iVar2 + 0x1820)),(char *)0xffffffff);
            local_18 = local_18 + 1;
            iVar7 = iVar7 + 0xf3c;
          } while (local_18 < *(int *)(iVar2 + 0x18c0));
        }
        *(uint *)(iVar2 + 0x180c) = ((int)(char)~*(byte *)(iVar2 + 0x1818) & 1U) << 1 | 5;
      }
      if (*(int *)(iVar2 + 0x180c) == 5) {
        iVar7 = 0;
        if (0 < *(int *)(iVar2 + 0x18c0)) {
          iVar6 = 0;
          do {
            pbVar11 = &DAT_1004d26f;
            iVar9 = 0x10;
            pbVar8 = local_10;
            pbVar3 = FUN_100020f0((byte *)(*(int *)(iVar2 + 0x1820) + 0xb4 + iVar6),&DAT_1004d8d8);
            FUN_10002a30(pbVar3,pbVar8,iVar9,pbVar11);
            piVar4 = (int *)FUN_10022a40(param_1,*(int *)((int)param_1 + 0x1610),local_10);
            if (piVar4 != (int *)0x0) {
              pbVar11 = &DAT_1004d26f;
              iVar9 = 0xc4;
              pbVar8 = (byte *)(piVar4 + 0x34);
              pbVar3 = FUN_100020f0((byte *)(*(int *)(iVar2 + 0x1820) + 0xb4 + iVar6),&DAT_1004e754)
              ;
              FUN_10002a30(pbVar3,pbVar8,iVar9,pbVar11);
              piVar4[1] = piVar4[1] + 1;
              FUN_100260e0(*(int *)((int)param_1 + 0x1614),*piVar4);
            }
            iVar7 = iVar7 + 1;
            iVar6 = iVar6 + 0xf3c;
          } while (iVar7 < *(int *)(iVar2 + 0x18c0));
        }
        *(undefined4 *)(iVar2 + 0x180c) = 7;
      }
      if (*(int *)(iVar2 + 0x180c) == 7) {
        FUN_10016490(0x80);
        if (*(int *)(iVar2 + 0x1820) != 0) {
          FUN_100385d0(*(int *)((int)param_1 + 0x2638),*(int *)(iVar2 + 0x1810));
          FUN_10038670(*(int *)((int)param_1 + 0x2638),*(int *)(iVar2 + 0x1820));
        }
        FUN_1002a7a0(*(int **)(iVar1 + 0x114));
        local_1c = local_1c + 1;
      }
      iVar2 = FUN_1002a780(*(int *)(iVar1 + 0x114));
    } while (iVar2 != 0);
    if (0 < local_1c) {
      FUN_10016490(0x80);
    }
  }
  return 0;
}



void __cdecl FUN_1002d3a0(int param_1,char *param_2,size_t param_3)

{
  FUN_100159d0(*(int *)(*(int *)(param_1 + 0x1740) + 0x10c),param_2,param_3);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

undefined4 __cdecl FUN_1002d440(int param_1,int param_2,int param_3)

{
  int iVar1;
  char cVar2;
  byte *pbVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  byte *pbVar9;
  byte local_17ac [16];
  byte abStack_179c [32];
  byte abStack_177c [64];
  byte local_173c [2048];
  byte local_f3c [3896];
  undefined4 uStack_4;
  
  uStack_4 = 0x1002d44a;
  iVar5 = *(int *)(param_1 + 0x1740);
  iVar1 = *(int *)(param_3 + 0x50c);
  iVar7 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar7 = FUN_10002480((char *)pbVar3,iVar7);
  iVar7 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar7);
  if (*(int *)(iVar1 + 8) == 0) {
    pbVar3 = *(byte **)(param_2 + 0x7c);
    local_17ac[0] = 0;
  }
  else {
    pbVar8 = &DAT_1004d26f;
    iVar6 = 0x800;
    pbVar3 = local_173c;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10052bdc);
    FUN_10002a30(pbVar4,pbVar3,iVar6,pbVar8);
    FUN_10003a20(*(byte **)(param_2 + 0x7c),&DAT_10052bdc);
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
    FUN_10003c50(local_173c,0x800,(byte *)"CALLUSER",pbVar3);
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLPING");
    FUN_10003c50(local_173c,0x800,(byte *)"CALLPING",pbVar3);
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLADDR");
    FUN_10003c50(local_173c,0x800,(byte *)"CALLADDR",pbVar3);
    FUN_10003a20(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
    FUN_10003a20(*(byte **)(param_2 + 0x7c),(byte *)"CALLPING");
    FUN_10003a20(*(byte **)(param_2 + 0x7c),(byte *)"CALLADDR");
    FUN_10005d70((char *)local_f3c,*(char **)(param_2 + 0x7c),0xf3c);
    pbVar9 = &DAT_1004d26f;
    iVar6 = 0x10;
    pbVar4 = local_17ac;
    pbVar3 = local_173c;
    pbVar8 = FUN_100020f0(local_f3c,&DAT_1004d8d8);
    FUN_10002a30(pbVar8,pbVar4,iVar6,pbVar9);
  }
  *(undefined4 *)(param_2 + 0x54) = 0;
  **(undefined1 **)(param_2 + 0x60) = 0;
  cVar2 = (**(code **)(iVar1 + 0xc))
                    (*(undefined4 *)(iVar5 + 0x10c),pbVar3,*(undefined4 *)(param_2 + 0x60),
                     *(undefined4 *)(param_2 + 0x5c),(undefined4 *)(param_2 + 0x54),
                     -(uint)(*(int *)(iVar1 + 8) != 0) & (uint)local_f3c,
                     -(uint)(*(int *)(iVar1 + 8) != 0) & 0xf3c);
  if (*(int *)(iVar1 + 8) == 0) goto LAB_1002d729;
  if (cVar2 != '\0') {
    if (*(int *)(iVar1 + 8) != 1) {
LAB_1002d64e:
      pbVar8 = &DAT_1004d26f;
      iVar5 = 0x20;
      pbVar4 = abStack_179c;
      pbVar3 = FUN_100020f0(pbVar3,&DAT_1004dff4);
      FUN_10002a30(pbVar3,pbVar4,iVar5,pbVar8);
      if (abStack_179c[0] != 0) {
        FUN_10003cf0(local_f3c,0xf3c,&DAT_1004dff4,abStack_179c);
      }
      FUN_10022490(*(undefined4 **)(param_1 + 0x19b0),0x2a707574,0,(char *)local_f3c,
                   (char *)0xffffffff);
      goto LAB_1002d729;
    }
    if (iVar7 != 0) {
      iVar5 = FUN_10025580((char *)local_17ac,(char *)(iVar7 + 0x20));
      if (iVar5 == 0) goto LAB_1002d64e;
    }
  }
  iVar5 = -1;
  pbVar3 = FUN_100020f0(local_f3c,&DAT_1005100c);
  iVar5 = FUN_10002480((char *)pbVar3,iVar5);
  if ((iVar5 != -1) && (local_17ac[0] != 0)) {
    FUN_10003e20(abStack_177c,0x40,(byte *)"PERS=%s LOCK=%d");
    FUN_10022490(*(undefined4 **)(param_1 + 0x19b0),0x2a756c6b,0,(char *)abStack_177c,
                 (char *)0xffffffff);
  }
LAB_1002d729:
  *(uint *)(param_2 + 0x58) = -(uint)(**(char **)(param_2 + 0x60) != '\0');
  return 0;
}



char __cdecl FUN_1002d750(undefined4 param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  
  cVar4 = '\0';
  piVar2 = (int *)FUN_10015a10();
  if ((piVar2 != (int *)0x0) && (*piVar2 != 0)) {
    do {
      if (cVar4 != '\0') {
        return cVar4;
      }
      if (*piVar2 == *(int *)(param_2 + 0x6c)) {
        *(code **)(param_2 + 0x28) = FUN_1002d440;
        *(undefined4 *)(param_2 + 0x34) = 0;
        iVar3 = *(int *)(param_2 + 0x70);
        if (-1 < *(int *)(param_2 + 0x70)) {
          iVar3 = *(int *)(param_2 + 0x6c);
        }
        *(int *)(param_2 + 0x50) = iVar3;
        *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
        **(undefined1 **)(param_2 + 0x60) = 0;
        *(int **)(param_3 + 0x50c) = piVar2;
        cVar4 = '\x01';
      }
      piVar1 = piVar2 + 4;
      piVar2 = piVar2 + 4;
    } while (*piVar1 != 0);
    return cVar4;
  }
  return '\0';
}



void __cdecl FUN_1002d7c0(byte *param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  size_t sVar4;
  byte *pbVar5;
  byte local_400 [1024];
  
  piVar2 = (int *)FUN_10015a10();
  if (piVar2 != (int *)0x0) {
    local_400[0] = 0;
    pbVar5 = local_400;
    sVar4 = 0x400;
    iVar3 = *piVar2;
    while (iVar3 != 0) {
      if ((char)piVar2[1] != '\0') {
        iVar3 = FUN_10005ca0((char *)pbVar5,sVar4,"%d,%d:");
        pbVar5 = pbVar5 + iVar3;
        sVar4 = (int)&stack0x00000000 - (int)pbVar5;
      }
      piVar1 = piVar2 + 4;
      piVar2 = piVar2 + 4;
      iVar3 = *piVar1;
    }
    FUN_10003cf0(param_1,param_2,(byte *)"CUSTCMDS",local_400);
  }
  return;
}



void __cdecl FUN_1002d850(void *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  char *pcVar8;
  
  iVar1 = *(int *)((int)param_1 + 0x1740);
  iVar2 = FUN_10022bb0(*(int *)(iVar1 + 0x110),param_2[0xe]);
  if (iVar2 != 0) {
    if (*(int *)(iVar2 + 0x181c) == 0) {
      FUN_1002aa90();
    }
    iVar7 = 0;
    if (0 < *(int *)(iVar2 + 0x18c0)) {
      pcVar8 = (char *)(iVar2 + 0x1a64);
LAB_1002d8b6:
      iVar3 = FUN_10025580(pcVar8,(char *)(param_2 + 8));
      if (iVar3 != 0) goto code_r0x1002d8c8;
      *(undefined1 *)(iVar7 + 0x1804 + iVar2) = 1;
      uVar4 = FUN_10003320((char *)0x0,0);
      *(undefined4 *)(iVar7 * 0x360 + 4 + iVar2) = uVar4;
      iVar6 = *(int *)(iVar2 + 0x181c) + 1;
      *(int *)(iVar2 + 0x181c) = iVar6;
      iVar7 = *param_2;
      iVar3 = 0;
      if (0 < *(int *)(iVar2 + 0x18c0)) {
        piVar5 = (int *)(iVar2 + 0x1aac);
        do {
          if (*piVar5 == iVar7) {
            iVar6 = iVar6 + 1;
            *(int *)(iVar2 + 0x181c) = iVar6;
          }
          iVar3 = iVar3 + 1;
          piVar5 = piVar5 + 0x1d;
        } while (iVar3 < *(int *)(iVar2 + 0x18c0));
      }
      FUN_10016490(0x80);
    }
LAB_1002d95f:
    if (*(int *)(iVar2 + 0x181c) == *(int *)(iVar2 + 0x18c0)) {
      *(undefined4 *)(iVar2 + 0x1820) = 0;
      FUN_10022bf0(*(int **)(iVar1 + 0x110),*(int *)(iVar2 + 0x1824));
      FUN_1002a740(*(int **)(iVar1 + 0x114),iVar2);
      FUN_1002cd00(param_1);
    }
  }
  return;
code_r0x1002d8c8:
  iVar7 = iVar7 + 1;
  pcVar8 = pcVar8 + 0x74;
  if (*(int *)(iVar2 + 0x18c0) <= iVar7) goto LAB_1002d95f;
  goto LAB_1002d8b6;
}



void __cdecl FUN_1002da50(int param_1)

{
  char cVar1;
  undefined4 uVar2;
  char local_505;
  char *local_504;
  byte local_500 [256];
  byte local_400 [1024];
  
  FUN_10003e20(local_400,0x400,(byte *)"DP=%s SKEY=%s GAME=%d");
  FUN_10038ac0(*(int *)(param_1 + 0x12755f0));
  uVar2 = FUN_10038ad0(*(void **)(param_1 + 0x12755f0),&local_504,&local_505,(char *)local_500,0x100
                      );
  cVar1 = (char)uVar2;
  while (cVar1 != '\0') {
    if (local_505 == '\0') {
      FUN_10022490(*(undefined4 **)(param_1 + 0x19b0),0x2a727074,0,local_504,(char *)0xffffffff);
      FUN_10016490(4);
    }
    else {
      FUN_10003cf0(local_400,0x400,(byte *)"SUBKEY",local_500);
      FUN_10022490(*(undefined4 **)(param_1 + 0x19b0),0x2a72646c,0,(char *)local_400,
                   (char *)0xffffffff);
      FUN_10016490(4);
    }
    uVar2 = FUN_10038ad0(*(void **)(param_1 + 0x12755f0),&local_504,&local_505,(char *)local_500,
                         0x100);
    cVar1 = (char)uVar2;
  }
  return;
}



undefined4 __cdecl FUN_1002dbd0(void *param_1,byte *param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  byte *pbVar5;
  byte *pbVar6;
  int iVar7;
  uint uVar8;
  int *piVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  void *pvVar13;
  char *pcVar14;
  
  puVar1 = (undefined4 *)_malloc(0x240);
  puVar2 = puVar1;
  for (iVar7 = 0x90; iVar7 != 0; iVar7 = iVar7 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar2 = FUN_10022cd0(500,5000);
  puVar1[0x44] = puVar2;
  uVar3 = FUN_1002a660(0);
  puVar1[0x45] = uVar3;
  puVar2 = FUN_100153c0(param_1);
  uVar8 = 0;
  puVar1[0x43] = puVar2;
  iVar7 = FUN_10015680((int)puVar2,0);
  if (iVar7 != 0) {
    piVar9 = (int *)((int)param_1 + 0x1748);
    do {
      if (uVar8 < 0x80) {
        *piVar9 = iVar7;
      }
      else {
        FUN_10016450(4);
      }
      uVar8 = uVar8 + 1;
      piVar9 = piVar9 + 1;
      iVar7 = FUN_10015680(puVar1[0x43],uVar8);
    } while (iVar7 != 0);
  }
  if (*(uint *)((int)param_1 + 0x198c) == 0) {
    *(uint *)((int)param_1 + 0x198c) = uVar8;
  }
  else if (uVar8 != *(uint *)((int)param_1 + 0x198c)) {
    FUN_10016450(4);
  }
  uVar4 = FUN_10022980(*(undefined4 **)((int)param_1 + 0x1400));
  uVar3 = *(undefined4 *)((int)param_1 + 0x2638);
  uVar11 = *(undefined4 *)((int)param_1 + 0x1614);
  uVar12 = *(undefined4 *)((int)param_1 + 0x1610);
  uVar10 = *(undefined4 *)((int)param_1 + 0x19b0);
  iVar7 = 0x80;
  pvVar13 = param_1;
  pbVar5 = FUN_100020f0(param_2,(byte *)"USER_ITERATE_QUEUE_SIZE");
  iVar7 = FUN_10002480((char *)pbVar5,iVar7);
  puVar2 = FUN_1003f280(iVar7,uVar10,uVar11,uVar12,uVar3,pvVar13,uVar4);
  pcVar14 = "gamefile.bin";
  *(undefined4 **)((int)param_1 + 0x1274d64) = puVar2;
  iVar7 = 0x100;
  pbVar5 = (byte *)(puVar1 + 0x4e);
  *(undefined4 *)((int)param_1 + 0x1274d68) = 0;
  pbVar6 = FUN_100020f0(param_2,(byte *)"GAMEFILE");
  FUN_10002a30(pbVar6,pbVar5,iVar7,(byte *)pcVar14);
  uVar3 = FUN_1002a660(0);
  puVar1[0x8e] = uVar3;
  uVar3 = FUN_1002a660(0);
  puVar1[0x46] = uVar3;
  *(undefined4 **)((int)param_1 + 0x1740) = puVar1;
  FUN_1002b2a0();
  FUN_1002cd00(param_1);
  return 0;
}



undefined4 __cdecl FUN_1002dd60(int param_1)

{
  void *_Memory;
  undefined4 *puVar1;
  int iVar2;
  
  _Memory = *(void **)(param_1 + 0x1740);
  puVar1 = (undefined4 *)(param_1 + 0x1748);
  iVar2 = 0x90;
  do {
    if ((int *)*puVar1 != (int *)0x0) {
      FUN_10021850((int *)*puVar1,(LPCSTR)0x0);
    }
    puVar1 = puVar1 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  FUN_10015660(*(void **)((int)_Memory + 0x10c));
  FUN_1002da50(param_1);
  FUN_1003f390(*(int **)(param_1 + 0x1274d64));
  if (*(undefined4 **)(param_1 + 0x1274d68) != (undefined4 *)0x0) {
    FUN_1003f370(*(undefined4 **)(param_1 + 0x1274d68));
  }
  FUN_1002b150();
  iVar2 = FUN_10022920(*(int **)((int)_Memory + 0x110));
  while (iVar2 != 0) {
    FUN_1002a710(*(int *)((int)_Memory + 0x114),iVar2);
    iVar2 = FUN_10022920(*(int **)((int)_Memory + 0x110));
  }
  FUN_10022830(*(void **)((int)_Memory + 0x110));
  FUN_1002a690(*(void **)((int)_Memory + 0x114),'\0');
  FUN_1002a690(*(void **)((int)_Memory + 0x118),'\x01');
  FUN_1002a690(*(void **)((int)_Memory + 0x238),'\x01');
  _free(_Memory);
  return 0;
}



void __cdecl FUN_1002e610(int param_1,byte *param_2)

{
  byte *pbVar1;
  uint uVar2;
  byte *pbVar3;
  int iVar4;
  uint *puVar5;
  int iVar6;
  byte *pbVar7;
  byte local_168 [8];
  uint local_160 [2];
  byte local_158 [36];
  byte local_134 [16];
  int local_124;
  int local_120;
  int local_11c;
  int local_118;
  int local_114;
  int local_110;
  byte local_108 [260];
  
  iVar6 = 0;
  puVar5 = local_160;
  for (iVar4 = 0x15; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  pbVar1 = local_108;
  for (iVar4 = 0x40; iVar4 != 0; iVar4 = iVar4 + -1) {
    pbVar1[0] = 0;
    pbVar1[1] = 0;
    pbVar1[2] = 0;
    pbVar1[3] = 0;
    pbVar1 = pbVar1 + 4;
  }
  pbVar1 = FUN_100020f0(param_2,&DAT_10052f68);
  uVar2 = FUN_10002480((char *)pbVar1,iVar6);
  iVar4 = 0;
  pbVar1 = FUN_100020f0(param_2,(byte *)"OFFICIAL");
  iVar4 = FUN_10002480((char *)pbVar1,iVar4);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 8;
  pbVar1 = local_168;
  pbVar3 = FUN_100020f0(param_2,&DAT_10050214);
  FUN_10002a30(pbVar3,pbVar1,iVar6,pbVar7);
  if (iVar4 == 0) {
    FUN_10021610(*(int **)(param_1 + 0x194c),local_168);
    return;
  }
  if ((iVar4 == 1) && (0 < (int)uVar2)) {
    pbVar3 = &DAT_1004d26f;
    iVar4 = 8;
    puVar5 = local_160;
    pbVar1 = FUN_100020f0(param_2,&DAT_10050214);
    FUN_10002a30(pbVar1,(byte *)puVar5,iVar4,pbVar3);
    pbVar7 = &DAT_1004d26f;
    iVar4 = 0x24;
    pbVar1 = local_158;
    pbVar3 = FUN_100020f0(param_2,&DAT_1004d8c8);
    FUN_10002a30(pbVar3,pbVar1,iVar4,pbVar7);
    pbVar7 = &DAT_1004d26f;
    iVar4 = 0x10;
    pbVar1 = local_134;
    pbVar3 = FUN_100020f0(param_2,&DAT_10052f58);
    FUN_10002a30(pbVar3,pbVar1,iVar4,pbVar7);
    iVar4 = 0;
    pbVar1 = FUN_100020f0(param_2,(byte *)"COUNT");
    local_124 = FUN_10002480((char *)pbVar1,iVar4);
    iVar4 = 0;
    pbVar1 = FUN_100020f0(param_2,(byte *)"MAXSIZE");
    local_120 = FUN_10002480((char *)pbVar1,iVar4);
    iVar4 = 0;
    pbVar1 = FUN_100020f0(param_2,&DAT_10052f68);
    local_11c = FUN_10002480((char *)pbVar1,iVar4);
    iVar4 = 0;
    pbVar1 = FUN_100020f0(param_2,(byte *)"LOSSES");
    local_118 = FUN_10002480((char *)pbVar1,iVar4);
    iVar4 = 0;
    pbVar1 = FUN_100020f0(param_2,&DAT_10052f48);
    local_114 = FUN_10002480((char *)pbVar1,iVar4);
    iVar4 = 0;
    pbVar1 = FUN_100020f0(param_2,&DAT_1004fc80);
    local_110 = FUN_10002480((char *)pbVar1,iVar4);
    FUN_10002d30(local_108,0x100,&DAT_10052f34,local_160,0x54,(byte *)"8s36s16sl*");
    FUN_10021150(*(int **)(param_1 + 0x194c),uVar2,local_168,(int *)local_108);
  }
  return;
}



void __fastcall FUN_1002ea00(int *param_1)

{
  char cVar1;
  int in_EAX;
  int iVar2;
  int *piVar3;
  int unaff_EBX;
  int *unaff_ESI;
  
  if (unaff_ESI != (int *)0x0) {
    iVar2 = 0;
    piVar3 = unaff_ESI + 199;
    while (*piVar3 != *param_1) {
      iVar2 = iVar2 + 1;
      piVar3 = piVar3 + 1;
      if (3 < iVar2) {
        return;
      }
    }
    _memmove(unaff_ESI + iVar2 + 199,unaff_ESI + iVar2 + 200,(3 - iVar2) * 4);
    if ((in_EAX != 0) && (unaff_ESI[0xd] == in_EAX)) {
      piVar3 = (int *)FUN_10026280(*(int *)(unaff_EBX + 0x1728),in_EAX);
      if (piVar3 != (int *)0x0) {
        cVar1 = FUN_10030860((int)piVar3,unaff_ESI,(int *)0x0);
        if (cVar1 != '\0') {
          unaff_ESI[0xd] = 0;
          piVar3[0x76] = piVar3[0x76] + 1;
          FUN_100260e0(*(int *)(unaff_EBX + 0x1728),*piVar3);
        }
      }
    }
    unaff_ESI[0xca] = 0;
    unaff_ESI[1] = unaff_ESI[1] + 1;
    FUN_100260e0(*(int *)(unaff_EBX + 0x1614),*unaff_ESI);
  }
  return;
}



undefined4 __cdecl FUN_1002ead0(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  int iVar6;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  byte *pbVar7;
  uint uVar8;
  int local_f8 [8];
  int local_d8;
  byte local_d4 [36];
  byte local_b0 [68];
  byte local_6c [68];
  char local_28 [36];
  
  pbVar7 = &DAT_1004d26f;
  piVar3 = local_f8;
  for (iVar6 = 0x3c; iVar6 != 0; iVar6 = iVar6 + -1) {
    *piVar3 = 0;
    piVar3 = piVar3 + 1;
  }
  iVar6 = 0x24;
  pbVar2 = local_d4;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  iVar6 = -1;
  pbVar7 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004df60);
  local_f8[1] = FUN_10002480((char *)pbVar7,iVar6);
  iVar6 = -1;
  pbVar7 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e76c);
  local_d8 = FUN_10002480((char *)pbVar7,iVar6);
  if (local_d8 == -1) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (local_d8 < 2) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x696e7670;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  uVar8 = 0;
  pbVar7 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"SYSFLAGS");
  local_f8[2] = FUN_100025a0((char *)pbVar7,uVar8);
  uVar8 = 0;
  pbVar7 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CUSTFLAGS");
  local_f8[3] = FUN_100025a0((char *)pbVar7,uVar8);
  pbVar1 = &DAT_1004d26f;
  iVar6 = 0x44;
  pbVar7 = local_b0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004df70);
  FUN_10002a30(pbVar2,pbVar7,iVar6,pbVar1);
  pbVar1 = &DAT_1004d26f;
  iVar6 = 0x44;
  pbVar7 = local_6c;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"PARAMS");
  FUN_10002a30(pbVar2,pbVar7,iVar6,pbVar1);
  iVar6 = FUN_10022a40(local_d4,*(int *)(param_1 + 0x1738),local_d4);
  if (iVar6 != 0) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x6475706c;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  iVar6 = 0;
  pbVar7 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar6 = FUN_10002480((char *)pbVar7,iVar6);
  piVar3 = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar6);
  if (piVar3 == (int *)0x0) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  iVar6 = 0;
  piVar4 = piVar3 + 199;
  do {
    if (*piVar4 == 0) break;
    iVar6 = iVar6 + 1;
    piVar4 = piVar4 + 1;
  } while (iVar6 < 4);
  if (iVar6 == 4) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x6e737063;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  local_f8[2] = local_f8[2] & 0xfff7ffff;
  piVar4 = FUN_10025650(local_d8);
  piVar4[1] = local_f8[1];
  piVar4[2] = local_f8[2];
  piVar4[3] = local_f8[3];
  FUN_10005d70((char *)(piVar4 + 0x12),(char *)local_b0,0x44);
  FUN_10005d70((char *)(piVar4 + 0x34),local_28,0x14);
  FUN_10005d70((char *)(piVar4 + 0x23),(char *)local_6c,0x44);
  if (local_d4[0] == 0) {
    FUN_10005ca0((char *)(piVar4 + 9),0x24,"%x");
    this = extraout_ECX;
  }
  else {
    FUN_10005d70((char *)(piVar4 + 9),(char *)local_d4,0x24);
    this = extraout_ECX_00;
  }
  FUN_100229d0(this,*(int **)(param_1 + 0x1738),(byte *)(piVar4 + 9),(int)piVar4);
  iVar6 = FUN_10026030(*(int **)(param_1 + 0x173c),0,piVar4);
  *piVar4 = iVar6;
  FUN_10025700((int)piVar4,piVar3);
  FUN_10005d70((char *)(piVar4 + 4),(char *)(piVar3 + 8),0x10);
  pbVar7 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e750);
  if (pbVar7 != (byte *)0x0) {
    FUN_10002a30(pbVar7,(byte *)(piVar3 + 0x65),0x84,&DAT_1004d26f);
  }
  FUN_100258c0((int)piVar3,piVar4);
  FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar3);
  FUN_10025aa0(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(int)piVar4);
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"~IDENT=%d NAME=%s");
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  uVar5 = FUN_10010d10(param_2);
  return uVar5;
}



undefined4 __cdecl FUN_1002ee70(int param_1,int param_2)

{
  char cVar1;
  byte *pbVar2;
  int *piVar3;
  byte *pbVar4;
  int *piVar5;
  undefined4 uVar6;
  void *this;
  int iVar7;
  byte *pbVar8;
  byte local_24 [36];
  
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x24;
  pbVar4 = local_24;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar2,pbVar4,iVar7,pbVar8);
  piVar3 = (int *)FUN_10022a40(this,*(int *)(param_1 + 0x1738),local_24);
  if (piVar3 == (int *)0x0) {
    iVar7 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar7;
    *(undefined4 *)(param_2 + 0x54) = 0x6e666e64;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if ((piVar3[2] & 0x80000U) != 0) {
    iVar7 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar7;
    *(undefined4 *)(param_2 + 0x54) = 0x61757468;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  iVar7 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar7 = FUN_10002480((char *)pbVar4,iVar7);
  piVar5 = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar7);
  if (piVar5 == (int *)0x0) {
    iVar7 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar7;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  iVar7 = FUN_10025580((char *)(piVar3 + 4),(char *)(piVar5 + 8));
  if (iVar7 == 0) {
    iVar7 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar7;
    *(undefined4 *)(param_2 + 0x54) = 0x696e6f70;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  cVar1 = FUN_10025740((int)piVar3,piVar5);
  if (cVar1 == '\0') {
    iVar7 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar7;
    *(undefined4 *)(param_2 + 0x54) = 0x6a6f696e;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  FUN_1002ea00(piVar3);
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"IDENT=%d");
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  uVar6 = FUN_10010d10(param_2);
  return uVar6;
}



undefined4 __cdecl FUN_1002f010(int param_1,int param_2)

{
  bool bVar1;
  byte *pbVar2;
  int *piVar3;
  byte *pbVar4;
  uint uVar5;
  int *piVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  void *this;
  int iVar9;
  byte *pbVar10;
  byte local_44 [16];
  byte local_34 [16];
  byte local_24 [36];
  
  pbVar10 = &DAT_1004d26f;
  iVar9 = 0x24;
  pbVar4 = local_24;
  bVar1 = false;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar2,pbVar4,iVar9,pbVar10);
  piVar3 = (int *)FUN_10022a40(this,*(int *)(param_1 + 0x1738),local_24);
  if (piVar3 == (int *)0x0) {
    iVar9 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar9;
    *(undefined4 *)(param_2 + 0x54) = 0x6e666e64;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if ((piVar3[2] & 0x80000U) != 0) {
    iVar9 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar9;
    *(undefined4 *)(param_2 + 0x54) = 0x61757468;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  iVar9 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar9 = FUN_10002480((char *)pbVar4,iVar9);
  iVar9 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar9);
  if (iVar9 == 0) {
    iVar9 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar9;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  iVar9 = FUN_10025580((char *)(piVar3 + 4),(char *)(iVar9 + 0x20));
  if (iVar9 != 0) {
    iVar9 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar9;
    *(undefined4 *)(param_2 + 0x54) = 0x6e6f776e;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar10 = &DAT_1004d26f;
  iVar9 = 0x10;
  pbVar4 = local_34;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"OWNER");
  FUN_10002a30(pbVar2,pbVar4,iVar9,pbVar10);
  if (local_34[0] != 0) {
    iVar9 = FUN_10025d10((int)piVar3,(char *)local_34);
    if (iVar9 == 0) {
      iVar9 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar9) {
        iVar9 = *(int *)(param_2 + 0x6c);
      }
      *(int *)(param_2 + 0x50) = iVar9;
      *(undefined4 *)(param_2 + 0x54) = 0x75757372;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    FUN_10005d70((char *)(piVar3 + 4),(char *)(iVar9 + 0x20),0x10);
    bVar1 = true;
  }
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"SYSFLAGS");
  if (pbVar4 != (byte *)0x0) {
    uVar5 = FUN_100025a0((char *)pbVar4,piVar3[2]);
    piVar3[2] = uVar5 & 0xfff7ffff;
    bVar1 = true;
  }
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CUSTFLAGS");
  if (pbVar4 != (byte *)0x0) {
    uVar5 = FUN_100025a0((char *)pbVar4,piVar3[3]);
    piVar3[3] = uVar5;
    bVar1 = true;
  }
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004df70);
  if (pbVar4 != (byte *)0x0) {
    FUN_10002a30(pbVar4,(byte *)(piVar3 + 0x12),0x44,(byte *)(piVar3 + 0x12));
    bVar1 = true;
  }
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e5a0);
  if (pbVar4 != (byte *)0x0) {
    FUN_10002a30(pbVar4,(byte *)(piVar3 + 0x34),0x14,(byte *)(piVar3 + 0x34));
    bVar1 = true;
  }
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"PARAMS");
  if (pbVar4 != (byte *)0x0) {
    FUN_10002a30(pbVar4,(byte *)(piVar3 + 0x23),0x44,(byte *)(piVar3 + 0x23));
    bVar1 = true;
  }
  pbVar10 = &DAT_1004d26f;
  iVar9 = 0x10;
  pbVar4 = local_44;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e78c);
  FUN_10002a30(pbVar2,pbVar4,iVar9,pbVar10);
  if (local_44[0] == 0) {
LAB_1002f32f:
    if (!bVar1) goto LAB_1002f34a;
  }
  else {
    piVar6 = (int *)FUN_10025d10((int)piVar3,(char *)local_44);
    if (piVar6 == (int *)0x0) goto LAB_1002f32f;
    FUN_10025740((int)piVar3,piVar6);
    FUN_1002ea00(piVar3);
    if ((piVar3[2] & 0x800U) != 0) {
      if (piVar3[0x3b] == 0) {
        puVar7 = FUN_1003e530(0x10,0);
        piVar3[0x3b] = (int)puVar7;
        FUN_1003e160((int)puVar7,FUN_10025580);
      }
      FUN_1003e220(piVar3[0x3b],(char *)local_44,(char *)0xffffffff,(char *)0x0,0);
    }
  }
  FUN_100260e0(*(int *)(param_1 + 0x173c),*piVar3);
LAB_1002f34a:
  FUN_10025aa0(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(int)piVar3);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  uVar8 = FUN_10010d10(param_2);
  return uVar8;
}



undefined4 __cdecl FUN_1002f370(int param_1,byte *param_2)

{
  int *piVar1;
  undefined4 uVar2;
  
  piVar1 = (int *)FUN_10022a90(*(void **)(param_1 + 0x1738),(int *)*(void **)(param_1 + 0x1738),
                               param_2);
  if (piVar1 != (int *)0x0) {
    FUN_100257e0(piVar1,*(int *)(param_1 + 0x1614));
    FUN_100261a0(*(int *)(param_1 + 0x173c),*piVar1);
    uVar2 = FUN_100256b0(piVar1);
    return CONCAT31((int3)((uint)uVar2 >> 8),1);
  }
  return 0;
}



undefined4 __cdecl FUN_1002f410(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  undefined4 uVar3;
  void *this;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  byte local_24 [36];
  
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x24;
  pbVar2 = local_24;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar1,pbVar2,iVar4,pbVar5);
  iVar4 = FUN_10022a40(this,*(int *)(param_1 + 0x1738),local_24);
  if (iVar4 == 0) {
    iVar4 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar4;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6e666e64;
    return 0;
  }
  if ((*(uint *)(iVar4 + 8) & 0x80000) != 0) {
    iVar4 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar4;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x61757468;
    return 0;
  }
  iVar6 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar6 = FUN_10002480((char *)pbVar2,iVar6);
  iVar6 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar6);
  if (iVar6 == 0) {
    iVar4 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar4;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  iVar4 = FUN_10025580((char *)(iVar4 + 0x10),(char *)(iVar6 + 0x20));
  if (iVar4 != 0) {
    iVar4 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar4;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6e6f776e;
    return 0;
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"IDENT=%d");
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  FUN_1002f370(param_1,local_24);
  uVar3 = FUN_10010d10(param_2);
  return uVar3;
}



undefined4 __thiscall FUN_1002f870(void *this,int param_1,int *param_2)

{
  int *in_EAX;
  int *piVar1;
  int *piVar2;
  byte *pbVar3;
  byte *pbVar4;
  char *pcVar5;
  void *this_00;
  void *this_01;
  void *this_02;
  void *this_03;
  int *unaff_ESI;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  byte *pbVar9;
  int iVar10;
  undefined4 local_814;
  byte local_810 [16];
  byte local_800 [2048];
  
  local_814 = 0;
  if (in_EAX == (int *)0x0) {
    iVar6 = 0;
    pbVar4 = FUN_100020f0((byte *)this,(byte *)"CALLUSER");
    iVar6 = FUN_10002480((char *)pbVar4,iVar6);
    unaff_ESI[0x2a] = iVar6;
    in_EAX = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar6);
  }
  else {
    unaff_ESI[0x2a] = *in_EAX;
  }
  unaff_ESI[0xc0] = (int)in_EAX;
  pbVar4 = (byte *)(unaff_ESI + 1);
  *unaff_ESI = 0;
  *pbVar4 = 0;
  if (param_2 == (int *)0x0) {
    unaff_ESI[0xc1] = 0;
    pbVar3 = FUN_100020f0((byte *)this,(byte *)"IDENT");
    if (pbVar3 == (byte *)0x0) {
      pbVar3 = FUN_100020f0((byte *)this,&DAT_1004d8c8);
      if (pbVar3 == (byte *)0x0) {
        pbVar3 = FUN_100020f0((byte *)this,&DAT_1004d8d8);
        if (pbVar3 == (byte *)0x0) {
          pbVar3 = FUN_100020f0((byte *)this,&DAT_1004db40);
          if (pbVar3 != (byte *)0x0) {
            FUN_10002a30(pbVar3,(byte *)(unaff_ESI + 10),0x80,&DAT_1004d26f);
            piVar1 = (int *)FUN_10022a40(this_02,*(int *)(param_1 + 0x1730),(byte *)(unaff_ESI + 10)
                                        );
            unaff_ESI[0xc1] = (int)piVar1;
            if (piVar1 != (int *)0x0) {
              piVar2 = piVar1 + 3;
              *unaff_ESI = *piVar1;
              iVar6 = (int)pbVar4 - (int)piVar2;
              do {
                iVar8 = *piVar2;
                *(char *)((int)piVar2 + iVar6) = (char)iVar8;
                piVar2 = (int *)((int)piVar2 + 1);
              } while ((char)iVar8 != '\0');
            }
          }
        }
        else {
          FUN_10002a30(pbVar3,local_810,0x10,&DAT_1004d26f);
          iVar6 = FUN_10022a40(this_01,*(int *)(param_1 + 0x1610),local_810);
          if (iVar6 != 0) {
            piVar1 = (int *)FUN_10026280(*(int *)(param_1 + 0x1728),*(int *)(iVar6 + 0x34));
            unaff_ESI[0xc1] = (int)piVar1;
            if (piVar1 != (int *)0x0) {
              piVar2 = piVar1 + 3;
              *unaff_ESI = *piVar1;
              iVar6 = (int)pbVar4 - (int)piVar2;
              do {
                iVar8 = *piVar2;
                *(char *)((int)piVar2 + iVar6) = (char)iVar8;
                piVar2 = (int *)((int)piVar2 + 1);
              } while ((char)iVar8 != '\0');
            }
          }
        }
      }
      else {
        FUN_10002a30(pbVar3,pbVar4,0x24,&DAT_1004d26f);
        iVar6 = FUN_10022a40(this_00,*(int *)(param_1 + 0x1724),pbVar4);
        unaff_ESI[0xc1] = iVar6;
      }
    }
    else {
      iVar6 = FUN_10002480((char *)pbVar3,0);
      *unaff_ESI = iVar6;
      iVar6 = FUN_10026280(*(int *)(param_1 + 0x1728),iVar6);
      unaff_ESI[0xc1] = iVar6;
    }
  }
  else {
    *unaff_ESI = *param_2;
    unaff_ESI[0xc1] = (int)param_2;
  }
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x11;
  pbVar4 = (byte *)(unaff_ESI + 0x2b);
  pbVar3 = FUN_100020f0((byte *)this,&DAT_1004e5a0);
  FUN_10002a30(pbVar3,pbVar4,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x24;
  pbVar4 = (byte *)(unaff_ESI + 0x32);
  pbVar3 = FUN_100020f0((byte *)this,&DAT_1004e774);
  FUN_10002a30(pbVar3,pbVar4,iVar6,pbVar7);
  iVar6 = FUN_10022a40(this_03,*(int *)(param_1 + 0x1738),(byte *)(unaff_ESI + 0x32));
  iVar8 = 0;
  unaff_ESI[0xc2] = iVar6;
  pbVar4 = FUN_100020f0((byte *)this,(byte *)"FORCE");
  iVar6 = FUN_10002480((char *)pbVar4,iVar8);
  *(bool *)(unaff_ESI + 0x3b) = iVar6 != 0;
  if ((unaff_ESI[0xc1] != 0) && (unaff_ESI[0xc0] != 0)) {
    FUN_100020b0((char *)local_800,0x800,(char *)this);
    this = local_800;
    local_814 = FUN_10015c60();
  }
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x24;
  pbVar4 = (byte *)((int)unaff_ESI + 0xed);
  pbVar3 = FUN_100020f0((byte *)this,(byte *)"USERPARAMS");
  FUN_10002a30(pbVar3,pbVar4,iVar6,pbVar7);
  iVar6 = 0;
  pbVar4 = FUN_100020f0((byte *)this,(byte *)"USERFLAGS");
  iVar6 = FUN_10002480((char *)pbVar4,iVar6);
  iVar8 = 0;
  unaff_ESI[0x45] = iVar6;
  pbVar4 = FUN_100020f0((byte *)this,&DAT_1005301c);
  iVar6 = FUN_10002480((char *)pbVar4,iVar8);
  iVar8 = 0;
  unaff_ESI[0x30] = iVar6;
  pbVar4 = FUN_100020f0((byte *)this,&DAT_10053014);
  iVar6 = FUN_10002480((char *)pbVar4,iVar8);
  iVar8 = 0;
  unaff_ESI[0x31] = iVar6;
  pbVar4 = FUN_100020f0((byte *)this,&DAT_1004e6a4);
  iVar6 = FUN_10002480((char *)pbVar4,iVar8);
  iVar8 = 0;
  *(bool *)(unaff_ESI + 0x46) = iVar6 != 0;
  pbVar4 = FUN_100020f0((byte *)this,(byte *)"GUESTS");
  iVar6 = FUN_10002480((char *)pbVar4,iVar8);
  iVar8 = 0;
  unaff_ESI[0x47] = iVar6;
  if (0 < iVar6) {
    pbVar4 = (byte *)(unaff_ESI + 0x4c);
    do {
      pbVar9 = &DAT_1004d26f;
      iVar6 = 0x10;
      pbVar3 = pbVar4 + -0x10;
      pbVar7 = (byte *)FUN_100022d0((byte *)this,"GUEST",iVar8);
      FUN_10002a30(pbVar7,pbVar3,iVar6,pbVar9);
      pbVar9 = &DAT_1004d26f;
      iVar6 = 0x24;
      pbVar3 = pbVar4;
      pbVar7 = (byte *)FUN_100022d0((byte *)this,"GUSERPARAMS",iVar8);
      FUN_10002a30(pbVar7,pbVar3,iVar6,pbVar9);
      iVar6 = 0;
      pcVar5 = (char *)FUN_100022d0((byte *)this,"GUSERFLAGS",iVar8);
      iVar6 = FUN_10002480(pcVar5,iVar6);
      iVar10 = 0;
      *(int *)(pbVar4 + 0x24) = iVar6;
      pcVar5 = (char *)FUN_100022d0((byte *)this,"GPRES",iVar8);
      iVar6 = FUN_10002480(pcVar5,iVar10);
      *(int *)(pbVar4 + 0x28) = iVar6;
      iVar8 = iVar8 + 1;
      pbVar4 = pbVar4 + 0x3c;
    } while (iVar8 < unaff_ESI[0x47]);
  }
  return local_814;
}



int __fastcall FUN_1002fcb0(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int unaff_ESI;
  
  iVar2 = *(int *)(param_2 + 0x9c);
  iVar1 = 0;
  if (0 < iVar2) {
    piVar3 = (int *)(param_2 + 0x250);
    do {
      if (*piVar3 == unaff_ESI) {
        iVar1 = iVar1 + 1;
      }
      piVar3 = piVar3 + 0x1d;
      iVar2 = iVar2 + -1;
    } while (iVar2 != 0);
  }
  return iVar1;
}



void __fastcall FUN_1002fcd0(int param_1)

{
  int *piVar1;
  void *_Dst;
  int in_EAX;
  
  if (*(int *)(in_EAX + 0x5e0) != 0) {
    if (param_1 == *(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) + -1) {
      *(undefined1 *)(param_1 * 0x18 + *(int *)(in_EAX + 0x5e0)) = 0;
      *(undefined4 *)(param_1 * 0x18 + 0x14 + *(int *)(in_EAX + 0x5e0)) = 0xffffffff;
    }
    else {
      _Dst = (void *)(*(int *)(in_EAX + 0x5e0) + param_1 * 0x18);
      _memmove(_Dst,(void *)((int)_Dst + 0x18),
               ((*(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) - param_1) + -1) * 0x18);
      *(undefined1 *)
       (*(int *)(in_EAX + 0x5e0) + -0x18 + *(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) * 0x18) = 0;
      *(undefined4 *)
       (*(int *)(in_EAX + 0x5e0) + -4 + *(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) * 0x18) =
           0xffffffff;
    }
    piVar1 = (int *)(*(int *)(in_EAX + 0x5e0) + 0x300);
    *piVar1 = *piVar1 + -1;
  }
  return;
}



undefined4 __cdecl FUN_1002fd70(int param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int *unaff_ESI;
  int iVar5;
  int *piVar6;
  
  if (*(int *)(param_1 + 0x34) == *unaff_ESI) {
    return 0x616a6f69;
  }
  if (*(int *)(param_1 + 0x34) != 0) {
    return 0x696e676d;
  }
  if ((unaff_ESI[0x179] != 0) &&
     (pcVar1 = (char *)FUN_1002a780(unaff_ESI[0x179]), pcVar1 != (char *)0x0)) {
    do {
      iVar2 = FUN_10025580(pcVar1,(char *)(param_1 + 0x20));
      if (iVar2 == 0) {
        return 0x62616e64;
      }
      pcVar1 = (char *)FUN_1002a870(unaff_ESI[0x179],(int)pcVar1);
    } while (pcVar1 != (char *)0x0);
  }
  if ((((unaff_ESI[1] & 0x100U) != 0) && (iVar2 = unaff_ESI[0x178], iVar2 != 0)) &&
     (iVar5 = 0, 0 < *(int *)(iVar2 + 0x300))) {
    iVar4 = 0;
    do {
      iVar3 = FUN_10025580((char *)(param_1 + 0xc),(char *)(iVar4 + iVar2));
      iVar2 = unaff_ESI[0x178];
      if (iVar3 == 0) {
        if (param_2 != *(int *)(iVar2 + 0x14 + iVar5 * 0x18)) {
          return 0x70617274;
        }
        FUN_1002fcd0(iVar5);
        break;
      }
      iVar5 = iVar5 + 1;
      iVar4 = iVar4 + 0x18;
    } while (iVar5 < *(int *)(iVar2 + 0x300));
  }
  iVar2 = 7;
  if (unaff_ESI[0x27] < 8) {
    piVar6 = unaff_ESI + 0x15b;
    do {
      if (((char)piVar6[0x1c] == '\x01') &&
         (iVar5 = FUN_10025580((char *)(param_1 + 0x20),(char *)piVar6), iVar5 == 0)) {
        if (iVar2 != -1) {
          return 0;
        }
        break;
      }
      iVar2 = iVar2 + -1;
      piVar6 = piVar6 + -0x1d;
    } while (unaff_ESI[0x27] <= iVar2);
  }
  if (unaff_ESI[0x17a] + unaff_ESI[0x27] != unaff_ESI[0x25]) {
    return 0;
  }
  return 0x6e737063;
}



int __cdecl FUN_1002fec0(int param_1,char *param_2)

{
  byte bVar1;
  uint uVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 extraout_ECX;
  byte *pbVar8;
  int unaff_EDI;
  bool bVar9;
  char local_5;
  int local_4;
  
  if (*(int *)(unaff_EDI + 0x300) == 0) {
    return 0x6d617574;
  }
  iVar5 = *(int *)(unaff_EDI + 0x304);
  if (iVar5 == 0) {
    return 0x7567616d;
  }
  pbVar3 = (byte *)(iVar5 + 0x78);
  if (*(char *)(iVar5 + 0x78) != '\0') {
    pbVar8 = (byte *)(unaff_EDI + 0xac);
    do {
      bVar1 = *pbVar3;
      bVar9 = bVar1 < *pbVar8;
      if (bVar1 != *pbVar8) {
LAB_1002ff28:
        iVar4 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
        goto LAB_1002ff2d;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar9 = bVar1 < pbVar8[1];
      if (bVar1 != pbVar8[1]) goto LAB_1002ff28;
      pbVar3 = pbVar3 + 2;
      pbVar8 = pbVar8 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_1002ff2d:
    if (iVar4 != 0) {
      return 0x70617373;
    }
  }
  uVar2 = *(uint *)(iVar5 + 4);
  if (((uVar2 & 0x1000) != 0) && ((*(char *)(unaff_EDI + 0xec) == '\0' || ((uVar2 & 0x40) == 0)))) {
    return 0x6c6f636b;
  }
  if ((*(int *)(unaff_EDI + 0xc0) < 0) || (*(int *)(iVar5 + 0x154) <= *(int *)(unaff_EDI + 0xc0))) {
    return 0x696e7670;
  }
  if (((uVar2 & 0x80000) != 0) && ((*(char *)(unaff_EDI + 0xec) == '\0' || ((uVar2 & 0x40) == 0))))
  {
    return 0x61737461;
  }
  if (param_2 != (char *)0x0) {
    *param_2 = '\0';
  }
  if (*(char *)(unaff_EDI + 0x118) == '\0') {
    iVar5 = *(int *)(unaff_EDI + 0x304);
    local_4 = (*(int *)(iVar5 + 0x94) - *(int *)(iVar5 + 0x1dc)) - *(int *)(iVar5 + 0x9c);
  }
  else {
    local_4 = *(int *)(*(int *)(unaff_EDI + 0x304) + 0x1dc);
  }
  if (*(char *)(unaff_EDI + 200) == '\0') {
    iVar5 = *(int *)(unaff_EDI + 0x304);
    iVar4 = 0;
    local_5 = '\0';
    if (0 < *(int *)(iVar5 + 0x9c)) {
      iVar7 = 0;
      do {
        if (local_5 != '\0') goto LAB_10030117;
        iVar5 = FUN_10025580((char *)(iVar5 + 0x240 + iVar7),
                             (char *)(*(int *)(unaff_EDI + 0x300) + 0x20));
        if (iVar5 == 0) {
          local_5 = '\x01';
        }
        iVar5 = *(int *)(unaff_EDI + 0x304);
        iVar4 = iVar4 + 1;
        iVar7 = iVar7 + 0x74;
      } while (iVar4 < *(int *)(iVar5 + 0x9c));
      if (local_5 != '\0') {
LAB_10030117:
        if (*(int *)(unaff_EDI + 0x11c) == 0) {
          return 0x616a6f69;
        }
      }
    }
    iVar5 = (uint)(local_5 == '\0') + *(int *)(unaff_EDI + 0x11c);
    if (iVar5 <= local_4) {
      iVar4 = *(int *)(unaff_EDI + 0x304);
      iVar7 = *(int *)(unaff_EDI + 0xc0);
      iVar6 = FUN_1002fcb0(*(int *)(unaff_EDI + 0x11c),iVar4);
      if (iVar5 <= *(int *)(iVar4 + 0x1f0 + iVar7 * 0x28) - iVar6) {
        if (local_5 == '\0') {
          iVar5 = FUN_1002fd70(*(int *)(unaff_EDI + 0x300),iVar7);
          if (iVar5 != 0) {
            return iVar5;
          }
          if (param_1 != 0) {
            return param_1;
          }
        }
        if (param_2 == (char *)0x0) {
          return 0;
        }
        *param_2 = local_5;
        return 0;
      }
    }
  }
  else {
    iVar5 = *(int *)(unaff_EDI + 0x308);
    if (iVar5 == 0) {
      return 0x75757374;
    }
    if ((*(uint *)(iVar5 + 8) & 0x1000) == 0) {
      return 0x6e6c6f6b;
    }
    iVar5 = FUN_100262c0(*(int *)(iVar5 + 0xe8));
    if ((iVar5 <= local_4) &&
       (iVar4 = *(int *)(unaff_EDI + 0x304), iVar7 = *(int *)(unaff_EDI + 0xc0),
       iVar6 = FUN_1002fcb0(extraout_ECX,iVar4),
       iVar5 <= *(int *)(iVar4 + 0x1f0 + iVar7 * 0x28) - iVar6)) {
      iVar4 = 0;
      if (iVar5 < 1) {
        return 0;
      }
      while( true ) {
        iVar7 = FUN_1002fd70(*(int *)(*(int *)(*(int *)(unaff_EDI + 0x308) + 0xe4) + iVar4 * 4),
                             *(int *)(unaff_EDI + 0xc0));
        if (iVar7 != 0) {
          return iVar7;
        }
        if (param_1 != 0) break;
        iVar4 = iVar4 + 1;
        if (iVar5 <= iVar4) {
          return param_1;
        }
      }
      return param_1;
    }
  }
  return 0x66756c6c;
}



void __cdecl FUN_100301c0(char *param_1,undefined4 param_2)

{
  int *piVar1;
  char cVar2;
  void *_Dst;
  int in_EAX;
  undefined4 *puVar3;
  int iVar4;
  char *pcVar5;
  
  if (*(int *)(in_EAX + 0x5e0) == 0) {
    puVar3 = (undefined4 *)_malloc(0x304);
    *(undefined4 **)(in_EAX + 0x5e0) = puVar3;
    for (iVar4 = 0xc1; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
  }
  _Dst = *(void **)(in_EAX + 0x5e0);
  if (*(int *)((int)_Dst + 0x300) == 0x20) {
    _memmove(_Dst,(void *)((int)_Dst + 0x18),0x2e8);
    *(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) = *(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) + -1;
  }
  pcVar5 = (char *)(*(int *)(in_EAX + 0x5e0) + *(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) * 0x18);
  do {
    cVar2 = *param_1;
    param_1 = param_1 + 1;
    *pcVar5 = cVar2;
    pcVar5 = pcVar5 + 1;
  } while (cVar2 != '\0');
  *(undefined4 *)
   (*(int *)(in_EAX + 0x5e0) + 0x14 + *(int *)(*(int *)(in_EAX + 0x5e0) + 0x300) * 0x18) = param_2;
  piVar1 = (int *)(*(int *)(in_EAX + 0x5e0) + 0x300);
  *piVar1 = *piVar1 + 1;
  return;
}



void FUN_10030270(void)

{
  byte *pbVar1;
  int unaff_ESI;
  int iVar2;
  byte local_420 [32];
  byte local_400 [1024];
  
  FUN_10003e20(local_400,0x400,
               (byte *)
               "IDENT=%d SYS=%f CUST=%f NAME=%s HOST=%d COUNT=%d PARMS=%s WHEN=%e EVID=%d EVGID=%d")
  ;
  iVar2 = 0;
  if (0 < *(int *)(unaff_ESI + 0x9c)) {
    pbVar1 = (byte *)(unaff_ESI + 0x240);
    do {
      _sprintf((char *)local_420,"USER%d",iVar2);
      FUN_10003cf0(local_400,0x400,local_420,pbVar1);
      iVar2 = iVar2 + 1;
      pbVar1 = pbVar1 + 0x74;
    } while (iVar2 < *(int *)(unaff_ESI + 0x9c));
  }
  FUN_10002000(local_400,0x20);
  FUN_10016490(0x80);
  return;
}



undefined4 __cdecl FUN_10030350(char *param_1)

{
  char cVar1;
  int iVar2;
  int unaff_EBX;
  int iVar3;
  int iVar4;
  char *pcVar5;
  char *pcVar6;
  
  iVar3 = -1;
  iVar4 = 7;
  pcVar6 = (char *)(unaff_EBX + 0x56c);
  do {
    if (iVar3 != -1) goto LAB_10030397;
    if (pcVar6[0x70] == '\0') {
      return 0x6e666e64;
    }
    iVar2 = FUN_10025580(param_1,pcVar6);
    if (iVar2 == 0) {
      iVar3 = iVar4;
    }
    iVar4 = iVar4 + -1;
    pcVar6 = pcVar6 + -0x74;
  } while (-1 < iVar4);
  if (iVar3 == -1) {
    return 0x6e666e64;
  }
LAB_10030397:
  if (iVar3 != *(int *)(unaff_EBX + 0x9c)) {
    iVar3 = iVar3 + -1;
    if (*(int *)(unaff_EBX + 0x9c) <= iVar3) {
      pcVar6 = (char *)(iVar3 * 0x74 + 0x240 + unaff_EBX);
      pcVar5 = pcVar6;
      do {
        do {
          cVar1 = *pcVar6;
          pcVar6[0x74] = cVar1;
          pcVar6 = pcVar6 + 1;
        } while (cVar1 != '\0');
        pcVar5[0xe4] = pcVar5[0x70];
        iVar3 = iVar3 + -1;
        pcVar6 = pcVar5 + -0x74;
        pcVar5 = pcVar6;
      } while (*(int *)(unaff_EBX + 0x9c) <= iVar3);
    }
    iVar3 = iVar3 + 1;
  }
  iVar3 = iVar3 * 0x74 + unaff_EBX;
  *(undefined1 *)(iVar3 + 0x240) = 0;
  *(undefined1 *)(iVar3 + 0x2b0) = 0;
  *(int *)(unaff_EBX + 0x5e8) = *(int *)(unaff_EBX + 0x5e8) + -1;
  return 0;
}



void __cdecl
FUN_10030410(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,char *param_5,
            undefined4 param_6,char *param_7,char param_8)

{
  char *pcVar1;
  int iVar2;
  undefined4 *unaff_ESI;
  undefined4 *unaff_EDI;
  
  pcVar1 = param_7;
  if (param_7 == (char *)0x0) {
    FUN_10030350((char *)(unaff_EDI + 8));
    pcVar1 = (char *)(unaff_EDI + 8);
  }
  FUN_10005d70((char *)(unaff_ESI + unaff_ESI[0x27] * 0x1d + 0x90),pcVar1,0x10);
  unaff_ESI[unaff_ESI[0x27] * 0x1d + 0x94] = param_2;
  unaff_ESI[unaff_ESI[0x27] * 0x1d + 0x96] = param_3;
  unaff_ESI[unaff_ESI[0x27] * 0x1d + 0x97] = unaff_EDI[0xb4];
  unaff_ESI[unaff_ESI[0x27] * 0x1d + 0x98] = param_4;
  unaff_ESI[unaff_ESI[0x27] * 0x1d + 0x95] = param_6;
  unaff_ESI[unaff_ESI[0x27] * 0x1d + 0xa2] = 0;
  *(char *)(unaff_ESI[0x27] * 0x74 + 0x2b1 + (int)unaff_ESI) = param_8;
  if (param_5 != (char *)0x0) {
    FUN_10005d70((char *)(unaff_ESI + unaff_ESI[0x27] * 0x1d + 0x99),param_5,0x24);
  }
  if (param_7 == (char *)0x0) {
    unaff_EDI[0xd] = *unaff_ESI;
    unaff_EDI[1] = unaff_EDI[1] + 1;
    iVar2 = FUN_10026280(*(int *)(param_1 + 0x15f8),unaff_EDI[0xc]);
    if (iVar2 == 0) {
      *(undefined1 *)(unaff_ESI + unaff_ESI[0x27] * 0x1d + 0xa3) = 0;
    }
    else {
      FUN_10005d70((char *)(unaff_ESI + unaff_ESI[0x27] * 0x1d + 0xa3),(char *)(iVar2 + 8),0x24);
    }
  }
  else {
    unaff_ESI[unaff_ESI[0x27] * 0x1d + 0xa2] = *unaff_EDI;
  }
  unaff_ESI[0x27] = unaff_ESI[0x27] + 1;
  if (param_8 != '\0') {
    unaff_ESI[0x77] = unaff_ESI[0x77] + -1;
  }
  return;
}



void __cdecl FUN_100305a0(int param_1)

{
  int in_EAX;
  byte *pbVar1;
  byte *pbVar2;
  undefined4 uVar3;
  int iVar4;
  int unaff_ESI;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  
  iVar5 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(in_EAX + 0x7c),(byte *)"FORCE");
  iVar5 = FUN_10002480((char *)pbVar1,iVar5);
  iVar6 = 0;
  *(bool *)unaff_ESI = iVar5 != 0;
  pbVar1 = FUN_100020f0(*(byte **)(in_EAX + 0x7c),(byte *)"FORCE_LOCK");
  iVar5 = FUN_10002480((char *)pbVar1,iVar6);
  iVar6 = 0;
  *(bool *)(unaff_ESI + 1) = iVar5 != 0;
  pbVar1 = FUN_100020f0(*(byte **)(in_EAX + 0x7c),(byte *)"FORCE_START");
  iVar5 = FUN_10002480((char *)pbVar1,iVar6);
  iVar6 = 1;
  *(bool *)(unaff_ESI + 2) = iVar5 != 0;
  pbVar1 = FUN_100020f0(*(byte **)(in_EAX + 0x7c),&DAT_1004e774);
  iVar5 = FUN_10002480((char *)pbVar1,iVar6);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x10;
  pbVar1 = (byte *)(unaff_ESI + 8);
  *(bool *)(unaff_ESI + 3) = iVar5 != 0;
  pbVar2 = FUN_100020f0(*(byte **)(in_EAX + 0x7c),(byte *)"GUEST");
  FUN_10002a30(pbVar2,pbVar1,iVar6,pbVar7);
  iVar5 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(in_EAX + 0x7c),(byte *)"CALLUSER");
  iVar5 = FUN_10002480((char *)pbVar1,iVar5);
  *(int *)(unaff_ESI + 4) = iVar5;
  iVar5 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar5);
  *(int *)(unaff_ESI + 0x18) = iVar5;
  *(undefined4 *)(unaff_ESI + 0x1c) = 0;
  *(undefined4 *)(unaff_ESI + 0x20) = 0;
  *(undefined4 *)(unaff_ESI + 0x24) = 0xffffffff;
  if (iVar5 != 0) {
    uVar3 = FUN_10026280(*(int *)(param_1 + 0x1728),*(int *)(iVar5 + 0x34));
    *(undefined4 *)(unaff_ESI + 0x1c) = uVar3;
  }
  if (*(int *)(unaff_ESI + 0x1c) != 0) {
    *(undefined4 *)(unaff_ESI + 0x24) = 0xffffffff;
    iVar5 = 0;
    if (0 < *(int *)(*(int *)(unaff_ESI + 0x1c) + 0x9c)) {
      iVar6 = 0;
      do {
        if (*(int *)(unaff_ESI + 0x24) != -1) break;
        iVar4 = FUN_10025580((char *)(*(int *)(unaff_ESI + 0x1c) + 0x240 + iVar6),
                             (char *)(*(int *)(unaff_ESI + 0x18) + 0x20));
        if (iVar4 == 0) {
          *(int *)(unaff_ESI + 0x24) = iVar5;
        }
        iVar5 = iVar5 + 1;
        iVar6 = iVar6 + 0x74;
      } while (iVar5 < *(int *)(*(int *)(unaff_ESI + 0x1c) + 0x9c));
    }
    iVar5 = *(int *)(*(int *)(unaff_ESI + 0x24) * 0x74 + 0x254 + *(int *)(unaff_ESI + 0x1c));
    if ((iVar5 != 0) && (*(char *)(unaff_ESI + 3) != '\0')) {
      uVar3 = FUN_10026280(*(int *)(param_1 + 0x173c),iVar5);
      *(undefined4 *)(unaff_ESI + 0x20) = uVar3;
    }
  }
  return;
}



undefined4 __cdecl FUN_10030740(undefined4 param_1,undefined4 param_2,char param_3)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  undefined4 uVar4;
  char *unaff_ESI;
  
  iVar3 = *(int *)(unaff_ESI + 0x18);
  if (iVar3 == 0) {
    return 0x6d617574;
  }
  if (*(int *)(iVar3 + 0x34) != 0) {
    iVar1 = *(int *)(unaff_ESI + 0x1c);
    if (iVar1 == 0) {
      return 0x7567616d;
    }
    if ((((*(uint *)(iVar1 + 4) & 0x1000) != 0) && (*unaff_ESI == '\0')) && (unaff_ESI[1] == '\0'))
    {
      return 0x6c6f636b;
    }
    if (param_3 == '\0') {
      if (*(int *)(iVar1 + 0x90) < 0) {
        pcVar2 = "";
      }
      else {
        pcVar2 = (char *)(*(int *)(*(int *)(unaff_ESI + 0x1c) + 0x90) * 0x74 + 0x240 +
                         *(int *)(unaff_ESI + 0x1c));
      }
      iVar3 = FUN_10025580((char *)(iVar3 + 0x20),pcVar2);
      if (iVar3 == 0) {
        return 0x67687374;
      }
    }
    if ((((*(uint *)(*(int *)(unaff_ESI + 0x1c) + 4) & 0x80000) != 0) && (*unaff_ESI == '\0')) &&
       (unaff_ESI[2] == '\0')) {
      return 0x61737461;
    }
    if (*(int *)(unaff_ESI + 0x24) != -1) {
      if (((*(int *)(*(int *)(unaff_ESI + 0x24) * 0x74 + 0x254 + *(int *)(unaff_ESI + 0x1c)) != 0)
          && (unaff_ESI[3] != '\0')) && (*(int *)(unaff_ESI + 0x20) != 0)) {
        iVar3 = FUN_10025580((char *)(*(int *)(unaff_ESI + 0x20) + 0x10),
                             (char *)(*(int *)(unaff_ESI + 0x18) + 0x20));
        if (iVar3 != 0) {
          return 0x61757468;
        }
      }
      uVar4 = FUN_10015c60();
      return uVar4;
    }
  }
  return 0x6a6f696e;
}



undefined1 __cdecl FUN_10030860(int param_1,int *param_2,int *param_3)

{
  int *_Dst;
  undefined1 uVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  undefined1 local_5;
  
  local_5 = 0;
  piVar3 = param_3;
  if (param_3 == (int *)0x0) {
    piVar3 = param_2 + 8;
  }
  uVar1 = 0;
  if (0 < *(int *)(param_1 + 0x9c)) {
    piVar5 = (int *)(param_1 + 0x288);
    iVar4 = 0;
    do {
      _Dst = piVar5 + -0x12;
      iVar2 = FUN_10025580((char *)piVar3,(char *)_Dst);
      if ((iVar2 == 0) || ((param_3 == (int *)0x0 && (*param_2 == *piVar5)))) {
        if (*piVar5 == 0) {
          if ((*(uint *)(param_1 + 4) & 0x100) != 0) {
            FUN_100301c0((char *)(param_2 + 3),piVar5[-0xe]);
          }
          local_5 = 1;
        }
        *(char *)_Dst = '\0';
        if (*(char *)((int)piVar5 + 0x29) != '\0') {
          *(int *)(param_1 + 0x1dc) = *(int *)(param_1 + 0x1dc) + 1;
        }
        if (iVar4 != 7) {
          _memmove(_Dst,piVar5 + 0xb,((*(int *)(param_1 + 0x9c) - iVar4) + -1) * 0x74);
          if (iVar4 < *(int *)(param_1 + 0x90)) {
            *(int *)(param_1 + 0x90) = *(int *)(param_1 + 0x90) + -1;
          }
        }
        *(int *)(param_1 + 0x9c) = *(int *)(param_1 + 0x9c) + -1;
      }
      else {
        iVar4 = iVar4 + 1;
        piVar5 = piVar5 + 0x1d;
      }
      uVar1 = local_5;
    } while (iVar4 < *(int *)(param_1 + 0x9c));
  }
  return uVar1;
}



undefined4 __cdecl FUN_10030960(void *param_1,int *param_2)

{
  byte bVar1;
  int *piVar2;
  byte *pbVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  byte *pbVar7;
  char *pcVar8;
  undefined4 uVar9;
  int iVar10;
  undefined4 *puVar11;
  int iVar12;
  byte *pbVar13;
  byte local_10 [16];
  
  piVar2 = param_2;
  iVar12 = 0;
  pbVar3 = FUN_100020f0((byte *)param_2[0x1f],(byte *)"CALLUSER");
  iVar12 = FUN_10002480((char *)pbVar3,iVar12);
  iVar12 = FUN_10026280(*(int *)((int)param_1 + 0x1614),iVar12);
  if (iVar12 == 0) {
    iVar12 = param_2[0x1c];
    param_2[10] = 0;
    if (-1 < iVar12) {
      iVar12 = param_2[0x1b];
    }
    param_2[0x14] = iVar12;
    param_2[0x16] = 0;
    param_2[0x15] = 0x6d617574;
    return 0;
  }
  piVar4 = (int *)FUN_10026280(*(int *)((int)param_1 + 0x1728),*(int *)(iVar12 + 0x34));
  if (piVar4 == (int *)0x0) {
    iVar12 = param_2[0x1c];
    param_2[10] = 0;
    if (-1 < iVar12) {
      iVar12 = param_2[0x1b];
    }
    param_2[0x14] = iVar12;
    param_2[0x16] = 0;
    param_2[0x15] = 0x6e67616d;
    return 0;
  }
  if (piVar4[0x24] < 0) {
    piVar5 = (int *)&DAT_1004d26f;
  }
  else {
    piVar5 = piVar4 + piVar4[0x24] * 0x1d + 0x90;
  }
  iVar6 = FUN_10025580((char *)(iVar12 + 0x20),(char *)piVar5);
  if (iVar6 != 0) {
    iVar12 = param_2[0x1c];
    param_2[10] = 0;
    if (-1 < iVar12) {
      iVar12 = param_2[0x1b];
    }
    param_2[0x14] = iVar12;
    param_2[0x16] = 0;
    param_2[0x15] = 0x6e676874;
    return 0;
  }
  pbVar13 = &DAT_1004d26f;
  iVar6 = 0x10;
  pbVar3 = local_10;
  pbVar7 = FUN_100020f0((byte *)param_2[0x1f],&DAT_100530cc);
  FUN_10002a30(pbVar7,pbVar3,iVar6,pbVar13);
  if (local_10[0] == 0) {
    pbVar13 = &DAT_1004d26f;
    iVar12 = 0x10;
    pbVar3 = local_10;
    pbVar7 = FUN_100020f0((byte *)param_2[0x1f],(byte *)"UNBAN");
    FUN_10002a30(pbVar7,pbVar3,iVar12,pbVar13);
    if (local_10[0] == 0) {
      iVar12 = param_2[0x1c];
      param_2[10] = 0;
      if (-1 < iVar12) {
        iVar12 = param_2[0x1b];
      }
      param_2[0x14] = iVar12;
      param_2[0x16] = 0;
      param_2[0x15] = 0x6d697373;
      return 0;
    }
    if (piVar4[0x179] != 0) {
      for (pcVar8 = (char *)FUN_1002a780(piVar4[0x179]); pcVar8 != (char *)0x0;
          pcVar8 = (char *)FUN_1002a870(piVar4[0x179],(int)pcVar8)) {
        iVar12 = FUN_10025580(pcVar8,(char *)local_10);
        if (iVar12 == 0) {
          FUN_1002a7f0((int *)piVar4[0x179],(int)pcVar8,'\x01');
          uVar9 = FUN_10010d10((int)param_2);
          return uVar9;
        }
      }
    }
    iVar12 = param_2[0x1c];
    param_2[10] = 0;
    if (-1 < iVar12) {
      iVar12 = param_2[0x1b];
    }
    param_2[0x14] = iVar12;
    param_2[0x16] = 0;
    param_2[0x15] = 0x6e666e64;
    return 0;
  }
  iVar12 = FUN_10025580((char *)(iVar12 + 0x20),(char *)local_10);
  if (iVar12 == 0) {
    iVar12 = param_2[0x1c];
    param_2[10] = 0;
    if (-1 < iVar12) {
      iVar12 = param_2[0x1b];
    }
    param_2[0x14] = iVar12;
    param_2[0x16] = 0;
    param_2[0x15] = 0x73656c66;
    return 0;
  }
  iVar12 = -1;
  iVar6 = 0;
  if (0 < piVar4[0x27]) {
    param_2 = piVar4 + 0x90;
    do {
      if (iVar12 != -1) goto LAB_10030c0e;
      iVar10 = FUN_10025580((char *)local_10,(char *)param_2);
      if (iVar10 == 0) {
        iVar12 = iVar6;
      }
      iVar6 = iVar6 + 1;
      param_2 = param_2 + 0x1d;
    } while (iVar6 < piVar4[0x27]);
    if (iVar12 != -1) {
LAB_10030c0e:
      piVar5 = (int *)FUN_10022a40(param_1,*(int *)((int)param_1 + 0x1610),local_10);
      if (piVar5 != (int *)0x0) {
        if (piVar4[0x179] == 0) {
          iVar12 = FUN_1002a660(0);
          piVar4[0x179] = iVar12;
        }
        puVar11 = FUN_1002a6e0(piVar4[0x179],0x10);
        pbVar3 = local_10;
        iVar12 = (int)puVar11 - (int)pbVar3;
        do {
          bVar1 = *pbVar3;
          pbVar3[iVar12] = bVar1;
          pbVar3 = pbVar3 + 1;
        } while (bVar1 != 0);
        FUN_1002a740((int *)piVar4[0x179],(int)puVar11);
        FUN_10030860((int)piVar4,piVar5,(int *)0x0);
        piVar4[0x76] = piVar4[0x76] + 1;
        piVar5[1] = piVar5[1] + 1;
        piVar5[0xd] = 0;
        FUN_100260e0(*(int *)((int)param_1 + 0x1614),*piVar5);
        FUN_100260e0(*(int *)((int)param_1 + 0x1728),*piVar4);
        uVar9 = FUN_10010d10((int)piVar2);
        return uVar9;
      }
    }
  }
  iVar12 = piVar2[0x1c];
  piVar2[10] = 0;
  if (-1 < iVar12) {
    iVar12 = piVar2[0x1b];
  }
  piVar2[0x14] = iVar12;
  piVar2[0x15] = 0x6e666e64;
  piVar2[0x16] = 0;
  return 0;
}



undefined4 __cdecl FUN_10030cd0(int param_1,int param_2)

{
  byte bVar1;
  byte *pbVar2;
  int *piVar3;
  byte *pbVar4;
  int *piVar5;
  int iVar6;
  undefined4 uVar7;
  int iVar8;
  int iVar9;
  byte *pbVar10;
  byte local_34 [16];
  byte local_24 [36];
  
  iVar6 = param_2;
  iVar9 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar9 = FUN_10002480((char *)pbVar2,iVar9);
  iVar9 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar9);
  if (iVar9 == 0) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  piVar3 = (int *)FUN_10026280(*(int *)(param_1 + 0x1728),*(int *)(iVar9 + 0x34));
  if (piVar3 == (int *)0x0) {
    pbVar10 = &DAT_1004d26f;
    iVar8 = 0x24;
    pbVar2 = local_24;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
    FUN_10002a30(pbVar4,pbVar2,iVar8,pbVar10);
    piVar3 = (int *)FUN_10022a40(*(void **)(param_1 + 0x1724),(int)*(void **)(param_1 + 0x1724),
                                 local_24);
    if (piVar3 == (int *)0x0) {
      iVar6 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar6) {
        iVar6 = *(int *)(param_2 + 0x6c);
      }
      *(int *)(param_2 + 0x50) = iVar6;
      *(undefined4 *)(param_2 + 0x54) = 0x6e67616d;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
  }
  if (piVar3[0x27] == piVar3[0x25]) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x66756c6c;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if ((piVar3[1] & 0x80000U) != 0) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x61737461;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar10 = &DAT_1004d26f;
  iVar8 = 0x10;
  pbVar2 = local_34;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10051f0c);
  FUN_10002a30(pbVar4,pbVar2,iVar8,pbVar10);
  if (local_34[0] == 0) {
    pbVar10 = &DAT_1004d26f;
    iVar8 = 0x10;
    pbVar2 = local_34;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"UNRES");
    FUN_10002a30(pbVar4,pbVar2,iVar8,pbVar10);
    if (local_34[0] == 0) {
      iVar6 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar6) {
        iVar6 = *(int *)(param_2 + 0x6c);
      }
      *(int *)(param_2 + 0x50) = iVar6;
      *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    if (piVar3[0x24] < 0) {
      piVar3 = (int *)&DAT_1004d26f;
    }
    else {
      piVar3 = piVar3 + piVar3[0x24] * 0x1d + 0x90;
    }
    iVar8 = FUN_10025580((char *)(iVar9 + 0x20),(char *)piVar3);
    if (iVar8 != 0) {
      iVar9 = FUN_10025580((char *)(iVar9 + 0x20),(char *)local_34);
      if (iVar9 != 0) goto LAB_10030f39;
    }
    iVar9 = FUN_10030350((char *)local_34);
    if (iVar9 != 0) {
      iVar6 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar6) {
        iVar6 = *(int *)(param_2 + 0x6c);
      }
      *(int *)(param_2 + 0x54) = iVar9;
      *(int *)(param_2 + 0x50) = iVar6;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
  }
  else {
    if (piVar3[0x24] < 0) {
      piVar5 = (int *)&DAT_1004d26f;
    }
    else {
      piVar5 = piVar3 + piVar3[0x24] * 0x1d + 0x90;
    }
    iVar8 = FUN_10025580((char *)(iVar9 + 0x20),(char *)piVar5);
    if (iVar8 != 0) {
LAB_10030f39:
      iVar6 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar6) {
        iVar6 = *(int *)(param_2 + 0x6c);
      }
      *(int *)(param_2 + 0x50) = iVar6;
      *(undefined4 *)(param_2 + 0x54) = 0x61757468;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    iVar9 = FUN_10025580((char *)(iVar9 + 0x20),(char *)local_34);
    if (iVar9 == 0) {
      iVar6 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar6) {
        iVar6 = *(int *)(param_2 + 0x6c);
      }
      *(int *)(param_2 + 0x50) = iVar6;
      *(undefined4 *)(param_2 + 0x54) = 0x73656c66;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    iVar9 = FUN_10022a40(local_34,*(int *)(param_1 + 0x1610),local_34);
    iVar8 = 0;
    if (((iVar9 != 0) && (*(int *)(iVar9 + 0x34) != 0)) && (*(int *)(iVar9 + 0x34) != *piVar3)) {
      iVar6 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar6) {
        iVar6 = *(int *)(param_2 + 0x6c);
      }
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(int *)(param_2 + 0x50) = iVar6;
      *(undefined4 *)(param_2 + 0x54) = 0x696e676d;
      return 0;
    }
    param_2 = -1;
    piVar5 = piVar3 + 0x90;
    do {
      iVar9 = FUN_10025580((char *)local_34,(char *)piVar5);
      if (iVar9 == 0) {
        iVar9 = *(int *)(iVar6 + 0x70);
        *(undefined4 *)(iVar6 + 0x28) = 0;
        if (-1 < iVar9) {
          iVar9 = *(int *)(iVar6 + 0x6c);
        }
        *(int *)(iVar6 + 0x50) = iVar9;
        iVar9 = piVar3[iVar8 * 0x1d + 0xac];
        *(undefined4 *)(iVar6 + 0x58) = 0;
        *(uint *)(iVar6 + 0x54) = (-(uint)((char)iVar9 != '\0') & 0x1109030d) + 0x616a6f69;
        return 0;
      }
      if (((char)piVar5[0x1c] == '\0') && ((char)*piVar5 == '\0')) {
        param_2 = iVar8;
      }
      iVar8 = iVar8 + 1;
      piVar5 = piVar5 + 0x1d;
    } while (iVar8 < 8);
    if (param_2 == -1) {
      iVar9 = *(int *)(iVar6 + 0x70);
      *(undefined4 *)(iVar6 + 0x28) = 0;
      if (-1 < iVar9) {
        iVar9 = *(int *)(iVar6 + 0x6c);
      }
      *(int *)(iVar6 + 0x50) = iVar9;
      *(undefined4 *)(iVar6 + 0x54) = 0x6e737063;
      *(undefined4 *)(iVar6 + 0x58) = 0;
      return 0;
    }
    pbVar2 = local_34;
    *(undefined1 *)(piVar3 + param_2 * 0x1d + 0xac) = 1;
    iVar9 = (param_2 * 0x74 + 0x240) - (int)pbVar2;
    do {
      bVar1 = *pbVar2;
      pbVar2[(int)piVar3 + iVar9] = bVar1;
      pbVar2 = pbVar2 + 1;
    } while (bVar1 != 0);
    piVar3[0x17a] = piVar3[0x17a] + 1;
  }
  uVar7 = FUN_10010d10(iVar6);
  return uVar7;
}



void __thiscall FUN_100311a0(void *this,int param_1,int *param_2)

{
  int *piVar1;
  void *extraout_ECX;
  void *extraout_ECX_00;
  int iVar2;
  byte *pbVar3;
  
  iVar2 = 0;
  if (0 < param_2[0x27]) {
    pbVar3 = (byte *)(param_2 + 0x90);
    do {
      piVar1 = (int *)FUN_10022a40(this,*(int *)(param_1 + 0x1610),pbVar3);
      this = extraout_ECX;
      if ((piVar1 != (int *)0x0) && (this = (void *)piVar1[0xd], this == (void *)*param_2)) {
        piVar1[2] = piVar1[2] & 0xffffff7f;
        piVar1[0xd] = 0;
        piVar1[1] = piVar1[1] + 1;
        FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar1);
        this = extraout_ECX_00;
      }
      iVar2 = iVar2 + 1;
      pbVar3 = pbVar3 + 0x74;
    } while (iVar2 < param_2[0x27]);
  }
  return;
}



void __cdecl FUN_10031220(int param_1,int *param_2)

{
  int iVar1;
  undefined4 extraout_ECX;
  void *this;
  void *extraout_ECX_00;
  
  FUN_10022a90(*(void **)(param_1 + 0x1724),(int *)*(void **)(param_1 + 0x1724),
               (byte *)(param_2 + 0xc));
  FUN_100261a0(*(int *)(param_1 + 0x1728),*param_2);
  FUN_1002a7f0(*(int **)(param_1 + 0x172c),(int)param_2,'\0');
  this = (void *)CONCAT31((int3)((uint)extraout_ECX >> 8),(char)param_2[0x56]);
  if ((char)param_2[0x56] != '\0') {
    FUN_10022a90(this,*(int **)(param_1 + 0x1730),(byte *)(param_2 + 0x56));
    this = extraout_ECX_00;
  }
  FUN_100311a0(this,param_1,param_2);
  if (param_2[0x23] != 0) {
    iVar1 = FUN_10026280(*(int *)(param_1 + 0x15f8),param_2[0x23]);
    if (iVar1 != 0) {
      *(int *)(iVar1 + 0x1a0) = *(int *)(iVar1 + 0x1a0) + -1;
    }
  }
  iVar1 = FUN_10026280(*(int *)(param_1 + 0x1734),*param_2);
  if (iVar1 != 0) {
    *(int *)(iVar1 + 4) = *(int *)(*(int *)(param_1 + 0x1740) + 0x23c) + *(int *)(param_1 + 0x1994);
  }
  FUN_10026c30(*(int *)(param_1 + 0x172c),(int)param_2);
  return;
}



void __cdecl FUN_100312f0(int param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  uint *puVar4;
  int iVar5;
  void *extraout_ECX;
  void *this;
  int *piVar6;
  undefined4 *puVar7;
  int *piVar8;
  byte *pbVar9;
  
  iVar2 = param_1;
  iVar1 = *(int *)(param_1 + 0x1740);
  param_2[1] = param_2[1] | 0x80000;
  FUN_10030270();
  puVar3 = FUN_1002a6e0(*(undefined4 *)(iVar1 + 0x114),0x3080);
  puVar7 = puVar3;
  for (iVar5 = 0xc20; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar7 = 0;
    puVar7 = puVar7 + 1;
  }
  piVar6 = param_2;
  piVar8 = puVar3 + 0x609;
  for (iVar5 = 0x1bc; iVar5 != 0; iVar5 = iVar5 + -1) {
    *piVar8 = *piVar6;
    piVar6 = piVar6 + 1;
    piVar8 = piVar8 + 1;
  }
  puVar3[0x781] = 0;
  *puVar3 = puVar3[0x65b];
  FUN_10022b00(*(int **)(iVar1 + 0x110),puVar3[0x609],(int)puVar3);
  param_1 = 0;
  if (0 < param_2[0x27]) {
    pbVar9 = (byte *)(param_2 + 0x90);
    this = extraout_ECX;
    do {
      if (*(int *)(pbVar9 + 0x48) == 0) {
        puVar4 = (uint *)FUN_10022a40(this,*(int *)(iVar2 + 0x1610),pbVar9);
        if (puVar4 != (uint *)0x0) {
          puVar4[2] = puVar4[2] | 0x80;
          puVar4[0xe] = puVar4[0xd];
          FUN_10035370(iVar2,puVar4,'\x01');
          FUN_100260e0(*(int *)(iVar2 + 0x1614),*puVar4);
        }
      }
      this = (void *)param_2[0x27];
      param_1 = param_1 + 1;
      pbVar9 = pbVar9 + 0x74;
    } while (param_1 < (int)this);
  }
  return;
}



void __cdecl FUN_100313f0(int param_1,int *param_2)

{
  bool bVar1;
  int iVar2;
  
  bVar1 = false;
  iVar2 = FUN_1002a780(*(int *)(*(int *)(param_1 + 0x1740) + 0x238));
  while ((iVar2 != 0 && (!bVar1))) {
    if (*param_2 == *(int *)(iVar2 + 0xc)) {
      FUN_1002a7f0(*(int **)(*(int *)(param_1 + 0x1740) + 0x238),iVar2,'\x01');
      bVar1 = true;
    }
    else {
      iVar2 = FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x238),iVar2);
    }
  }
  return;
}



void __cdecl FUN_10031470(int param_1,int *param_2)

{
  int iVar1;
  void *this;
  
  FUN_100229d0(*(void **)(param_1 + 0x1724),(int *)*(void **)(param_1 + 0x1724),
               (byte *)(param_2 + 0xc),(int)param_2);
  iVar1 = FUN_10026030(*(int **)(param_1 + 0x1728),0,param_2);
  *param_2 = iVar1;
  FUN_1002a740(*(int **)(param_1 + 0x172c),(int)param_2);
  if ((char)param_2[0x56] != '\0') {
    FUN_10022a90(*(void **)(param_1 + 0x1730),(int *)*(void **)(param_1 + 0x1730),
                 (byte *)(param_2 + 0x56));
    FUN_100229d0(this,*(int **)(param_1 + 0x1730),(byte *)(param_2 + 0x56),(int)param_2);
  }
  return;
}



uint __thiscall FUN_100314e0(void *this,int param_1)

{
  uint in_EAX;
  uint uVar1;
  undefined4 uVar2;
  
  uVar1 = in_EAX & 0xffffff00;
  if (((*(byte *)((int)this + 4) & 2) != 0) &&
     (*(int *)((int)this + 0x9c) == *(int *)((int)this + 0x94))) {
    uVar2 = FUN_100312f0(param_1,(int *)this);
    uVar1 = CONCAT31((int3)((uint)uVar2 >> 8),1);
  }
  return uVar1;
}



void __cdecl FUN_10031510(int param_1,char param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int unaff_EBX;
  int iVar7;
  int iVar8;
  char *pcVar9;
  int local_8;
  int local_4;
  
  if (*(char *)(unaff_EBX + 200) == '\0') {
    local_8 = 0;
    iVar7 = 0x31c;
    iVar4 = 0;
    do {
      iVar8 = iVar4;
      if (iVar4 != 0) break;
      iVar1 = *(int *)(iVar7 + *(int *)(unaff_EBX + 0x300));
      iVar3 = local_8;
      if (iVar1 != 0) {
        iVar2 = *(int *)(*(int *)(unaff_EBX + 0x304) + 0x9c);
        iVar5 = 0;
        if (0 < iVar2) {
          piVar6 = (int *)(*(int *)(unaff_EBX + 0x304) + 0x254);
          do {
            iVar8 = iVar1;
            iVar3 = iVar1;
            if (*piVar6 == iVar1) break;
            iVar5 = iVar5 + 1;
            piVar6 = piVar6 + 0x1d;
            iVar8 = iVar4;
            iVar3 = local_8;
          } while (iVar5 < iVar2);
        }
      }
      local_8 = iVar3;
      iVar7 = iVar7 + 4;
      iVar4 = iVar8;
    } while (iVar7 < 0x32c);
    if (param_2 == '\0') {
      FUN_10030410(param_1,*(undefined4 *)(unaff_EBX + 0xc0),*(undefined4 *)(unaff_EBX + 0x114),
                   *(undefined4 *)(unaff_EBX + 0xc4),(char *)(unaff_EBX + 0xed),iVar8,(char *)0x0,
                   *(char *)(unaff_EBX + 0x118));
      FUN_100260e0(*(int *)(param_1 + 0x1614),**(int **)(unaff_EBX + 0x300));
    }
    local_4 = 0;
    if (0 < *(int *)(unaff_EBX + 0x11c)) {
      pcVar9 = (char *)(unaff_EBX + 0x130);
      do {
        FUN_10030410(param_1,*(undefined4 *)(unaff_EBX + 0xc0),*(undefined4 *)(pcVar9 + 0x24),
                     *(undefined4 *)(pcVar9 + 0x28),pcVar9,local_8,pcVar9 + -0x10,
                     *(char *)(unaff_EBX + 0x118));
        local_4 = local_4 + 1;
        pcVar9 = pcVar9 + 0x3c;
      } while (local_4 < *(int *)(unaff_EBX + 0x11c));
    }
  }
  else {
    iVar4 = FUN_100262c0(*(int *)(*(int *)(unaff_EBX + 0x308) + 0xe8));
    iVar7 = 0;
    if (0 < iVar4) {
      do {
        FUN_10030410(param_1,*(undefined4 *)(unaff_EBX + 0xc0),0,0,(char *)(unaff_EBX + 0xed),
                     **(undefined4 **)(unaff_EBX + 0x308),(char *)0x0,*(char *)(unaff_EBX + 0x118));
        FUN_100260e0(*(int *)(param_1 + 0x1614),
                     **(int **)(*(int *)(*(int *)(unaff_EBX + 0x308) + 0xe4) + iVar7 * 4));
        iVar7 = iVar7 + 1;
      } while (iVar7 < iVar4);
    }
  }
  piVar6 = *(int **)(unaff_EBX + 0x304);
  if (((*(byte *)(piVar6 + 1) & 2) != 0) && (piVar6[0x27] == piVar6[0x25])) {
    FUN_100312f0(param_1,piVar6);
  }
  piVar6 = (int *)(*(int *)(unaff_EBX + 0x304) + 0x1d8);
  *piVar6 = *piVar6 + 1;
  FUN_100260e0(*(int *)(param_1 + 0x1728),**(int **)(unaff_EBX + 0x304));
  return;
}



void __cdecl FUN_10031750(int param_1,int *param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  undefined3 extraout_var;
  int iVar4;
  undefined4 local_514;
  int local_510;
  byte local_50c [1292];
  
  if ((param_2[1] & 0x91008U) == 0) {
    iVar2 = FUN_1002a780(*(int *)(*(int *)(param_1 + 0x1740) + 0x238));
    while (iVar4 = iVar2, iVar4 != 0) {
      iVar2 = *(int *)(iVar4 + 0x14);
      if ((*(int *)(iVar4 + 0x18) != 0) &&
         (iVar3 = FUN_10026280(*(int *)(param_1 + 0x173c),*(int *)(iVar4 + 0x18)), iVar3 != 0)) {
        iVar3 = FUN_100262c0(*(int *)(iVar3 + 0xe8));
        iVar2 = iVar2 + -1 + iVar3;
      }
      if ((param_2[0x25] - param_2[0x27]) - param_2[0x77] < iVar2) {
        iVar2 = FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x238),iVar4);
      }
      else {
        cVar1 = FUN_10015d10(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x10c),iVar4,(int)param_2)
        ;
        local_510 = iVar4;
        iVar2 = FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x238),iVar4);
        if (CONCAT31(extraout_var,cVar1) != 0) {
          iVar3 = FUN_10026280(*(int *)(param_1 + 0x1614),*(int *)(iVar4 + 0xc));
          if (iVar3 == 0) {
            FUN_1002a7f0(*(int **)(*(int *)(param_1 + 0x1740) + 0x238),iVar4,'\x01');
          }
          else {
            FUN_100020b0((char *)local_50c,0x200,(char *)(iVar4 + 0x1c));
            FUN_10003cf0(local_50c,0x200,&DAT_1004d8c8,(byte *)(param_2 + 3));
            iVar4 = FUN_1002f870(local_50c,param_1,param_2);
            iVar4 = FUN_1002fec0(iVar4,(char *)&local_514);
            if (iVar4 == 0) {
              FUN_10031510(param_1,(char)local_514);
              FUN_1002a7f0(*(int **)(*(int *)(param_1 + 0x1740) + 0x238),local_510,'\x01');
            }
            else {
              FUN_10016490(0x80);
            }
          }
        }
      }
    }
  }
  return;
}



void FUN_10031970(void)

{
  int *piVar1;
  int iVar2;
  int unaff_EBX;
  int unaff_ESI;
  int iVar3;
  
  if ((*(char *)(unaff_ESI + 3) == '\0') || (*(int *)(unaff_ESI + 0x20) == 0)) {
    FUN_10030860(*(int *)(unaff_ESI + 0x1c),*(int **)(unaff_ESI + 0x18),
                 (int *)(-(uint)(*(char *)(unaff_ESI + 8) != '\0') & unaff_ESI + 8U));
    if (*(char *)(unaff_ESI + 8U) == '\0') {
      piVar1 = (int *)(*(int *)(unaff_ESI + 0x18) + 4);
      *piVar1 = *piVar1 + 1;
      *(undefined4 *)(*(int *)(unaff_ESI + 0x18) + 0x34) = 0;
      FUN_100260e0(*(int *)(unaff_EBX + 0x1614),**(int **)(unaff_ESI + 0x18));
    }
  }
  else {
    iVar2 = FUN_100262c0(*(int *)(*(int *)(unaff_ESI + 0x20) + 0xe8));
    iVar3 = 0;
    if (0 < iVar2) {
      do {
        FUN_10030860(*(int *)(unaff_ESI + 0x1c),
                     *(int **)(*(int *)(*(int *)(unaff_ESI + 0x20) + 0xe4) + iVar3 * 4),(int *)0x0);
        *(undefined4 *)(*(int *)(*(int *)(*(int *)(unaff_ESI + 0x20) + 0xe4) + iVar3 * 4) + 0x34) =
             0;
        piVar1 = (int *)(*(int *)(*(int *)(*(int *)(unaff_ESI + 0x20) + 0xe4) + iVar3 * 4) + 4);
        *piVar1 = *piVar1 + 1;
        FUN_100260e0(*(int *)(unaff_EBX + 0x1614),
                     **(int **)(*(int *)(*(int *)(unaff_ESI + 0x20) + 0xe4) + iVar3 * 4));
        iVar3 = iVar3 + 1;
      } while (iVar3 < iVar2);
    }
  }
  piVar1 = *(int **)(unaff_ESI + 0x1c);
  if (piVar1[0x27] == piVar1[0x25] + -1) {
    FUN_10031750(unaff_EBX,piVar1);
  }
  piVar1 = (int *)(*(int *)(unaff_ESI + 0x1c) + 0x1d8);
  *piVar1 = *piVar1 + 1;
  FUN_100260e0(*(int *)(unaff_EBX + 0x1728),**(int **)(unaff_ESI + 0x1c));
  return;
}



int __cdecl FUN_10031a90(int param_1,int *param_2,char param_3,undefined4 *param_4)

{
  char cVar1;
  byte bVar2;
  byte *in_EAX;
  byte *pbVar3;
  byte *pbVar4;
  uint uVar5;
  char *pcVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  int *piVar10;
  int *piVar11;
  int iVar12;
  int iVar13;
  byte *pbVar14;
  byte *pbVar15;
  int iVar16;
  int local_78c;
  undefined4 *local_788;
  int local_784;
  undefined4 *local_77c;
  byte local_770 [36];
  byte local_74c [32];
  byte local_72c [16];
  byte local_71c [36];
  int local_6f8 [3];
  byte local_6ec [36];
  byte local_6c8 [72];
  byte local_680 [20];
  undefined4 local_66c;
  int local_668;
  int local_664;
  int local_660;
  int local_65c;
  char local_658 [36];
  byte local_634 [132];
  undefined4 local_5b0;
  int local_5ac;
  int local_5a8;
  int local_5a4;
  byte local_5a0 [132];
  int local_51c;
  byte local_518 [16];
  int local_508;
  byte local_504 [1280];
  
  pbVar14 = &DAT_1004d26f;
  iVar7 = *(int *)(param_1 + 0x1740);
  iVar12 = 0x24;
  pbVar4 = local_6ec;
  local_788 = (undefined4 *)0x0;
  local_784 = 0;
  piVar8 = local_6f8;
  for (iVar9 = 0x1bc; iVar9 != 0; iVar9 = iVar9 + -1) {
    *piVar8 = 0;
    piVar8 = piVar8 + 1;
  }
  pbVar3 = FUN_100020f0(in_EAX,&DAT_1004d8c8);
  FUN_10002a30(pbVar3,pbVar4,iVar12,pbVar14);
  pbVar3 = &DAT_1004d26f;
  iVar9 = 0x84;
  pbVar4 = local_634;
  pbVar14 = FUN_100020f0(in_EAX,(byte *)"PARAMS");
  FUN_10002a30(pbVar14,pbVar4,iVar9,pbVar3);
  iVar9 = 0;
  pbVar4 = FUN_100020f0(in_EAX,&DAT_1004e764);
  iVar9 = FUN_10002480((char *)pbVar4,iVar9);
  local_77c = (undefined4 *)0x0;
  if (iVar9 != 0) {
    local_77c = (undefined4 *)FUN_10026280(*(int *)(param_1 + 0x15f8),iVar9);
    if (local_77c == (undefined4 *)0x0) {
      return 0x75726f6d;
    }
    if ((0 < *(int *)(param_1 + 0x12755f4)) &&
       (*(int *)(param_1 + 0x12755f4) <= (int)local_77c[0x68])) {
      return 0x6d616e79;
    }
    local_66c = *local_77c;
  }
  iVar9 = -1;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"MAXSIZE");
  local_664 = FUN_10002480((char *)pbVar4,iVar9);
  iVar9 = -1;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"MINSIZE");
  local_660 = FUN_10002480((char *)pbVar4,iVar9);
  if ((local_664 == -1) || (local_660 == -1)) {
    return 0x6d697373;
  }
  if ((((local_664 < 1) || (8 < local_664)) || (local_660 < 1)) || (local_664 < local_660)) {
    return 0x696e7670;
  }
  iVar9 = 0;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"CUSTFLAGS");
  local_6f8[2] = FUN_10002480((char *)pbVar4,iVar9);
  iVar9 = 0;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"SYSFLAGS");
  local_6f8[1] = FUN_10002480((char *)pbVar4,iVar9);
  local_6f8[1] = local_6f8[1] & 0xfff7ffff;
  pbVar3 = &DAT_1004d26f;
  iVar9 = 0x14;
  pbVar4 = local_680;
  pbVar14 = FUN_100020f0(in_EAX,&DAT_1004e5a0);
  FUN_10002a30(pbVar14,pbVar4,iVar9,pbVar3);
  if (local_680[0] != 0) {
    local_6f8[1] = local_6f8[1] | 0x10000;
  }
  iVar9 = 0;
  pbVar4 = FUN_100020f0(in_EAX,&DAT_10052824);
  local_5ac = FUN_10002480((char *)pbVar4,iVar9);
  iVar9 = 0;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"EVGID");
  local_5a8 = FUN_10002480((char *)pbVar4,iVar9);
  pbVar3 = &DAT_1004d26f;
  iVar9 = 0x80;
  pbVar4 = local_5a0;
  pbVar14 = FUN_100020f0(in_EAX,&DAT_1004db40);
  FUN_10002a30(pbVar14,pbVar4,iVar9,pbVar3);
  pbVar3 = &DAT_1004d26f;
  iVar9 = 0x10;
  pbVar4 = local_518;
  pbVar14 = FUN_100020f0(in_EAX,(byte *)"PLATPARAMS");
  FUN_10002a30(pbVar14,pbVar4,iVar9,pbVar3);
  iVar9 = 1;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"NUMPART");
  local_5a4 = FUN_10002480((char *)pbVar4,iVar9);
  if (local_5a4 < 1) {
    return 0x696e7670;
  }
  if (2 < local_5a4) {
    return 0x696e7670;
  }
  iVar9 = 0;
  pbVar4 = FUN_100020f0(in_EAX,&DAT_1004e6a4);
  local_51c = FUN_10002480((char *)pbVar4,iVar9);
  if (local_664 + -1 < local_51c) {
    return 0x696e7670;
  }
  if (param_2 == (int *)0x0) {
    return 0x6d617574;
  }
  if (param_2[0xd] != 0) {
    return 0x696e676d;
  }
  iVar9 = 0;
  local_668 = 0;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"IGNPROFNAME");
  iVar9 = FUN_10002480((char *)pbVar4,iVar9);
  if ((iVar9 == 0) && (local_6ec[0] != 0)) {
    FUN_100254c0(*(undefined4 *)(param_1 + 0x1cd4),local_6ec);
    uVar5 = FUN_10025120(*(int **)(param_1 + 0x1cd4),local_6ec);
    if ((0 < (int)uVar5) || (local_6ec[0] == 0)) {
      return 0x66696c74;
    }
  }
  iVar9 = FUN_10022a40(*(void **)(param_1 + 0x1724),(int)*(void **)(param_1 + 0x1724),local_6ec);
  if (iVar9 != 0) {
    return 0x6475706c;
  }
  iVar9 = 0;
  local_78c = 0;
  if (0 < local_5a4) {
    pbVar4 = local_504;
    do {
      _sprintf((char *)local_74c,"PARTSIZE%d",iVar9);
      iVar12 = 0;
      pbVar14 = FUN_100020f0(in_EAX,local_74c);
      iVar12 = FUN_10002480((char *)pbVar14,iVar12);
      local_78c = local_78c + iVar12;
      *(int *)(pbVar4 + -4) = iVar12;
      _sprintf((char *)local_74c,"PARTPARAMS%d",iVar9);
      pbVar15 = &DAT_1004d26f;
      iVar12 = 0x24;
      pbVar14 = pbVar4;
      pbVar3 = FUN_100020f0(in_EAX,local_74c);
      FUN_10002a30(pbVar3,pbVar14,iVar12,pbVar15);
      iVar9 = iVar9 + 1;
      pbVar4 = pbVar4 + 0x28;
    } while (iVar9 < local_5a4);
    if (local_78c != 0) {
      if (local_78c != local_664) {
        return 0x696e7670;
      }
      goto LAB_10031f20;
    }
  }
  iVar9 = 0;
  if (0 < local_5a4) {
    piVar8 = &local_508;
    do {
      *piVar8 = local_664 / local_5a4;
      iVar9 = iVar9 + 1;
      piVar8 = piVar8 + 10;
    } while (iVar9 < local_5a4);
  }
  (&local_508)[iVar9 * 10] = (&local_508)[iVar9 * 10] + local_664 % local_5a4;
LAB_10031f20:
  iVar9 = 0;
  pbVar4 = FUN_100020f0(in_EAX,(byte *)"USERPART");
  iVar9 = FUN_10002480((char *)pbVar4,iVar9);
  if ((iVar9 < 0) || (local_5a4 <= iVar9)) {
    return 0x70617274;
  }
  pbVar3 = &DAT_1004d26f;
  iVar12 = 0x24;
  pbVar4 = local_71c;
  pbVar14 = FUN_100020f0(in_EAX,&DAT_1004e774);
  FUN_10002a30(pbVar14,pbVar4,iVar12,pbVar3);
  if (local_71c[0] == 0) {
    iVar12 = 0;
    pbVar4 = FUN_100020f0(in_EAX,(byte *)"GUESTS");
    iVar12 = FUN_10002480((char *)pbVar4,iVar12);
    if ((&local_508)[iVar9 * 10] < iVar12 + 1) {
      return 0x66756c6c;
    }
    iVar16 = 0;
    pbVar4 = FUN_100020f0(in_EAX,(byte *)"USERFLAGS");
    iVar16 = FUN_10002480((char *)pbVar4,iVar16);
    pbVar3 = &DAT_1004d26f;
    iVar13 = 0x24;
    pbVar4 = local_770;
    pbVar14 = FUN_100020f0(in_EAX,(byte *)"USERPARAMS");
    FUN_10002a30(pbVar14,pbVar4,iVar13,pbVar3);
    iVar13 = 0;
    pbVar4 = FUN_100020f0(in_EAX,&DAT_10053014);
    iVar13 = FUN_10002480((char *)pbVar4,iVar13);
    FUN_10030410(param_1,iVar9,iVar16,iVar13,(char *)local_770,0,(char *)0x0,'\0');
    FUN_100260e0(*(int *)(param_1 + 0x1614),*param_2);
    local_78c = 0;
    if (0 < iVar12) {
      do {
        pbVar3 = &DAT_1004d26f;
        iVar16 = 0x10;
        pbVar4 = local_72c;
        pbVar14 = (byte *)FUN_100022d0(in_EAX,"GUEST",local_78c);
        FUN_10002a30(pbVar14,pbVar4,iVar16,pbVar3);
        pbVar3 = &DAT_1004d26f;
        iVar16 = 0x24;
        pbVar4 = local_770;
        pbVar14 = (byte *)FUN_100022d0(in_EAX,"GUSERPARAMS",local_78c);
        FUN_10002a30(pbVar14,pbVar4,iVar16,pbVar3);
        iVar16 = 0;
        pcVar6 = (char *)FUN_100022d0(in_EAX,"GUSERFLAGS",local_78c);
        iVar16 = FUN_10002480(pcVar6,iVar16);
        iVar13 = 0;
        pcVar6 = (char *)FUN_100022d0(in_EAX,"GPRES",local_78c);
        iVar13 = FUN_10002480(pcVar6,iVar13);
        FUN_10030410(param_1,iVar9,iVar16,iVar13,(char *)local_770,0,(char *)local_72c,'\0');
        local_78c = local_78c + 1;
      } while (local_78c < iVar12);
    }
  }
  else {
    local_788 = (undefined4 *)
                FUN_10022a40(*(void **)(param_1 + 0x1738),(int)*(void **)(param_1 + 0x1738),
                             local_71c);
    if (local_788 == (undefined4 *)0x0) {
      return 0x75757374;
    }
    iVar12 = FUN_10025580((char *)(local_788 + 4),(char *)(param_2 + 8));
    if (iVar12 != 0) {
      return 0x61757468;
    }
    if ((local_788[2] & 0x1000) == 0) {
      return 0x6e6c6f6b;
    }
    local_784 = FUN_100262c0(local_788[0x3a]);
    if ((&local_508)[iVar9 * 10] < local_784) {
      return 0x66756c6c;
    }
    pbVar3 = &DAT_1004d26f;
    iVar12 = 0x24;
    pbVar4 = local_770;
    pbVar14 = FUN_100020f0(in_EAX,(byte *)"USERPARAMS");
    FUN_10002a30(pbVar14,pbVar4,iVar12,pbVar3);
    local_78c = 0;
    if (0 < local_784) {
      do {
        FUN_10030410(param_1,iVar9,0,0,(char *)local_770,*local_788,(char *)0x0,'\0');
        FUN_100260e0(*(int *)(param_1 + 0x1614),**(int **)(local_788[0x39] + local_78c * 4));
        if (param_2 == *(int **)(local_788[0x39] + local_78c * 4)) {
          local_668 = local_65c + -1;
        }
        local_78c = local_78c + 1;
      } while (local_78c < local_784);
    }
  }
  local_5b0 = FUN_10003320((char *)0x0,0);
  pcVar6 = (char *)(iVar7 + 8);
  iVar7 = -(int)pcVar6;
  do {
    cVar1 = *pcVar6;
    pcVar6[(int)(local_658 + iVar7)] = cVar1;
    pcVar6 = pcVar6 + 1;
  } while (cVar1 != '\0');
  iVar7 = FUN_10015c60();
  if (iVar7 != 0) {
    return iVar7;
  }
  piVar8 = (int *)FUN_10026c10(*(undefined4 *)(param_1 + 0x172c));
  if (local_6ec[0] == 0) {
    FUN_10005ca0((char *)local_6ec,0x24,"%x");
  }
  pbVar4 = local_6ec;
  do {
    bVar2 = *pbVar4;
    pbVar4[0x24] = bVar2;
    pbVar4 = pbVar4 + 1;
  } while (bVar2 != 0);
  piVar10 = local_6f8;
  piVar11 = piVar8;
  for (iVar7 = 0x1bc; iVar7 != 0; iVar7 = iVar7 + -1) {
    *piVar11 = *piVar10;
    piVar10 = piVar10 + 1;
    piVar11 = piVar11 + 1;
  }
  FUN_10031470(param_1,piVar8);
  piVar8[0x76] = piVar8[0x76] + 1;
  if (local_71c[0] == 0) {
    param_2[0xd] = *piVar8;
    FUN_100260e0(*(int *)(param_1 + 0x1614),*param_2);
  }
  else {
    iVar7 = 0;
    if (0 < local_784) {
      do {
        *(int *)(*(int *)(local_788[0x39] + iVar7 * 4) + 0x34) = *piVar8;
        FUN_100260e0(*(int *)(param_1 + 0x1614),**(int **)(local_788[0x39] + iVar7 * 4));
        iVar7 = iVar7 + 1;
      } while (iVar7 < local_784);
    }
  }
  if (piVar8[0x23] != 0) {
    local_77c[0x68] = local_77c[0x68] + 1;
  }
  FUN_100314e0(piVar8,param_1);
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = piVar8;
  }
  if (param_3 != '\0') {
    FUN_10031750(param_1,piVar8);
  }
  return 0;
}



int __cdecl FUN_10032440(int param_1)

{
  char cVar1;
  int in_EAX;
  int *piVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  int unaff_EBX;
  int iVar6;
  int local_430;
  int local_42c;
  int local_428;
  byte local_424 [36];
  byte local_400 [1024];
  
  iVar6 = 0;
  local_430 = 0;
  if (in_EAX != 0) {
    do {
      if (iVar6 != 0) {
        return iVar6;
      }
      if ((param_1 == in_EAX) || (cVar1 = FUN_10023680(), cVar1 == '\0')) {
        iVar5 = FUN_1002a870(*(undefined4 *)(*(int *)(unaff_EBX + 0x1740) + 0x238),in_EAX);
      }
      else {
        piVar2 = (int *)FUN_10026280(*(int *)(unaff_EBX + 0x1614),*(int *)(in_EAX + 0xc));
        if ((piVar2 != (int *)0x0) && (piVar2[0xd] == 0)) {
          local_42c = param_1;
          local_428 = in_EAX;
          FUN_10015d60(*(undefined4 *)(*(int *)(unaff_EBX + 0x1740) + 0x10c),local_400,0x400,
                       &local_42c,2,1);
          iVar6 = 0;
          pbVar3 = FUN_100020f0(local_400,(byte *)"SYSFLAGS");
          uVar4 = FUN_10002480((char *)pbVar3,iVar6);
          FUN_10002370(local_400,0x400,(byte *)"SYSFLAGS",uVar4 | 0x20000);
          FUN_10005ca0((char *)local_424,0x24,"QUIK-%p");
          FUN_10003cf0(local_400,0x400,&DAT_1004d8c8,local_424);
          iVar6 = FUN_10031a90(unaff_EBX,piVar2,'\0',&local_430);
          if (iVar6 != 0) {
            FUN_10016490(0x80);
          }
        }
        iVar5 = FUN_1002a870(*(undefined4 *)(*(int *)(unaff_EBX + 0x1740) + 0x238),in_EAX);
        FUN_1002a7f0(*(int **)(*(int *)(unaff_EBX + 0x1740) + 0x238),in_EAX,'\x01');
        iVar6 = local_430;
      }
      in_EAX = iVar5;
    } while (iVar5 != 0);
  }
  return iVar6;
}



undefined4 __cdecl FUN_100332b0(int param_1,int param_2)

{
  byte *pbVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  
  iVar6 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"FORCE");
  iVar6 = FUN_10002480((char *)pbVar1,iVar6);
  iVar7 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar7 = FUN_10002480((char *)pbVar1,iVar7);
  iVar7 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar7);
  if (iVar7 == 0) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  piVar2 = (int *)FUN_10026280(*(int *)(param_1 + 0x1728),*(int *)(iVar7 + 0x34));
  if (piVar2 == (int *)0x0) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x7567616d;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (piVar2[0x24] < 0) {
    piVar3 = (int *)&DAT_1004d26f;
  }
  else {
    piVar3 = piVar2 + piVar2[0x24] * 0x1d + 0x90;
  }
  iVar4 = FUN_10025580((char *)piVar3,(char *)(iVar7 + 0x20));
  if (iVar4 != 0) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x6e676874;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (((piVar2[1] & 0x80000U) != 0) && ((iVar6 == 0 || (*(int *)(iVar7 + 0x34) == 0)))) {
    iVar6 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar6;
    *(undefined4 *)(param_2 + 0x54) = 0x696e676d;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  FUN_10031220(param_1,piVar2);
  *(undefined4 *)(param_2 + 0x58) = 0;
  uVar5 = FUN_10010d10(param_2);
  return uVar5;
}



undefined4 __cdecl FUN_10033410(int param_1,int param_2)

{
  byte *pbVar1;
  int *piVar2;
  int *piVar3;
  undefined4 uVar4;
  int iVar5;
  
  iVar5 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar5 = FUN_10002480((char *)pbVar1,iVar5);
  iVar5 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar5);
  if (iVar5 == 0) {
    iVar5 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar5;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  if (*(int *)(iVar5 + 0x34) == 0) {
    iVar5 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar5;
    *(undefined4 *)(param_2 + 0x54) = 0x6e67616d;
    return 0;
  }
  piVar2 = (int *)FUN_10026280(*(int *)(param_1 + 0x1728),*(int *)(iVar5 + 0x34));
  if (piVar2 == (int *)0x0) {
    iVar5 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar5;
    *(undefined4 *)(param_2 + 0x54) = 0x7567616d;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (piVar2[0x24] < 0) {
    piVar3 = (int *)&DAT_1004d26f;
  }
  else {
    piVar3 = piVar2 + piVar2[0x24] * 0x1d + 0x90;
  }
  iVar5 = FUN_10025580((char *)piVar3,(char *)(iVar5 + 0x20));
  if (iVar5 != 0) {
    iVar5 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar5;
    *(undefined4 *)(param_2 + 0x54) = 0x6e676874;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if ((piVar2[1] & 0x80000U) != 0) {
    iVar5 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar5;
    *(undefined4 *)(param_2 + 0x54) = 0x61737461;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (piVar2[0x27] < piVar2[0x26]) {
    iVar5 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar5;
    *(undefined4 *)(param_2 + 0x54) = 0x6e65706c;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  FUN_100312f0(param_1,piVar2);
  piVar2[0x76] = piVar2[0x76] + 1;
  FUN_100260e0(*(int *)(param_1 + 0x1728),*piVar2);
  *(undefined4 *)(param_2 + 0x58) = 0;
  uVar4 = FUN_10010d10(param_2);
  return uVar4;
}



undefined4 __cdecl FUN_10033860(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  int local_10;
  int local_c;
  
  FUN_100305a0(param_1);
  iVar1 = FUN_10030740(param_1,param_2,'\0');
  if (iVar1 != 0) {
    iVar3 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar3) {
      iVar3 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x54) = iVar1;
    *(int *)(param_2 + 0x50) = iVar3;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  FUN_10031970();
  FUN_100265c0(*(void **)(param_1 + 0x1610),*(undefined4 *)(param_1 + 0x15f8),local_c,local_10,
               *(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),FUN_10015a20,
               *(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x10c),'\0','\x01','\x01',
               *(char *)(param_1 + 0x12755f8));
  uVar2 = FUN_10010d10(param_2);
  return uVar2;
}



void __cdecl FUN_10033e30(int param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  undefined4 local_510;
  byte local_50c [1292];
  
  iVar4 = 0;
  if ((*(int *)(*(int *)(param_1 + 0x1740) + 0x120) != 0) &&
     (iVar2 = FUN_1002a780(*(int *)(*(int *)(param_1 + 0x1740) + 0x238)), iVar2 != 0)) {
    do {
      iVar1 = *(int *)(iVar2 + 8);
      if ((iVar1 != 0) &&
         (*(int *)(param_1 + 0x1994) != iVar1 && -1 < *(int *)(param_1 + 0x1994) - iVar1)) {
        *(int *)(iVar2 + 8) = *(int *)(*(int *)(param_1 + 0x1740) + 0x120) + iVar1;
        *(int *)(iVar2 + 4) = *(int *)(iVar2 + 4) + 1;
        iVar4 = iVar4 + 1;
      }
      iVar2 = FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x238),iVar2);
    } while (iVar2 != 0);
    if (iVar4 != 0) {
      for (piVar3 = (int *)FUN_1002a780(*(int *)(param_1 + 0x172c)); piVar3 != (int *)0x0;
          piVar3 = (int *)FUN_1002a870(*(undefined4 *)(param_1 + 0x172c),(int)piVar3)) {
        FUN_10031750(param_1,piVar3);
      }
      iVar4 = FUN_1002a780(*(int *)(*(int *)(param_1 + 0x1740) + 0x238));
      while (iVar4 != 0) {
        FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x238),iVar4);
        piVar3 = (int *)FUN_10032440(iVar4);
        if (piVar3 == (int *)0x0) {
          iVar4 = FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x238),iVar4);
        }
        else {
          FUN_100020b0((char *)local_50c,0x200,(char *)(iVar4 + 0x1c));
          FUN_10003cf0(local_50c,0x200,&DAT_1004d8c8,(byte *)(piVar3 + 3));
          iVar2 = FUN_1002f870(local_50c,param_1,piVar3);
          iVar2 = FUN_1002fec0(iVar2,(char *)&local_510);
          if (iVar2 == 0) {
            FUN_10031510(param_1,(char)local_510);
          }
          iVar2 = FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x238),iVar4);
          FUN_1002a7f0(*(int **)(*(int *)(param_1 + 0x1740) + 0x238),iVar4,'\x01');
          iVar4 = iVar2;
        }
      }
    }
  }
  return;
}



undefined4 __cdecl FUN_10034010(int param_1,uint param_2)

{
  int *piVar1;
  byte bVar2;
  uint uVar3;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  uint *puVar7;
  int *piVar8;
  int *piVar9;
  uint uVar10;
  undefined4 uVar11;
  void *this;
  void *this_00;
  int iVar12;
  int iVar13;
  byte *pbVar14;
  byte local_20 [32];
  
  uVar3 = param_2;
  iVar13 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar13 = FUN_10002480((char *)pbVar4,iVar13);
  iVar13 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar13);
  if (iVar13 == 0) {
    iVar13 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar13) {
      iVar13 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar13;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  iVar5 = *(int *)(iVar13 + 0x2c0);
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLPING");
  iVar5 = FUN_10002480((char *)pbVar4,iVar5);
  pbVar14 = &DAT_1004d26f;
  iVar12 = 0x20;
  pbVar4 = local_20;
  *(int *)(iVar13 + 0x2c0) = iVar5;
  pbVar6 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar6,pbVar4,iVar12,pbVar14);
  puVar7 = (uint *)FUN_10022a40(*(void **)(param_1 + 0x15f4),(int)*(void **)(param_1 + 0x15f4),
                                local_20);
  if (local_20[0] == 0x23) {
    puVar7 = (uint *)FUN_10026280(*(int *)(param_1 + 0x15f8),*(int *)(iVar13 + 0x30));
  }
  if (puVar7 == (uint *)0x0) {
    iVar13 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar13) {
      iVar13 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar13;
    *(undefined4 *)(param_2 + 0x54) = 0x75726f6d;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  param_2 = *(uint *)(iVar13 + 8) & 0x2002;
  iVar5 = FUN_10025580((char *)(iVar13 + 0x20),(char *)(puVar7 + 0x14));
  if (iVar5 == 0) {
    param_2 = param_2 | 0x100;
  }
  iVar13 = FUN_10025580((char *)(iVar13 + 0x20),(char *)(puVar7 + 0x18));
  if (iVar13 == 0) {
    param_2 = param_2 | 0x400000;
  }
  if (param_2 == 0) {
LAB_100344a8:
    iVar13 = *(int *)(uVar3 + 0x70);
    *(undefined4 *)(uVar3 + 0x28) = 0;
    if (-1 < iVar13) {
      iVar13 = *(int *)(uVar3 + 0x6c);
    }
    *(undefined4 *)(uVar3 + 0x58) = 0;
    *(int *)(uVar3 + 0x50) = iVar13;
    *(undefined4 *)(uVar3 + 0x54) = 0x61757468;
    return 0;
  }
  pbVar14 = (byte *)0x0;
  iVar13 = 0x20;
  pbVar4 = local_20;
  pbVar6 = FUN_100020f0(*(byte **)(uVar3 + 0x7c),&DAT_1004e5a0);
  iVar13 = FUN_10002a30(pbVar6,pbVar4,iVar13,pbVar14);
  if (-1 < iVar13) {
    if ((char)(param_2 >> 8) == '\0') goto LAB_100344a8;
    pbVar4 = local_20;
    iVar13 = (int)(puVar7 + 0x1c) - (int)pbVar4;
    do {
      bVar2 = *pbVar4;
      pbVar4[iVar13] = bVar2;
      pbVar4 = pbVar4 + 1;
    } while (bVar2 != 0);
    uVar10 = puVar7[1];
    puVar7[1] = uVar10 | 0x10000;
    if ((char)puVar7[0x1c] == '\0') {
      puVar7[1] = (uVar10 | 0x10000) ^ 0x10000;
    }
  }
  pbVar14 = (byte *)0x0;
  iVar13 = 0x20;
  pbVar4 = local_20;
  pbVar6 = FUN_100020f0(*(byte **)(uVar3 + 0x7c),&DAT_1004e7a4);
  iVar13 = FUN_10002a30(pbVar6,pbVar4,iVar13,pbVar14);
  if (-1 < iVar13) {
    if ((param_2 & 0x2100) == 0) goto LAB_100344a8;
    if (((char)param_2 == '\0') || (local_20[0] != 0x23)) {
      piVar8 = (int *)FUN_10022a40(*(void **)(param_1 + 0x1610),(int)*(void **)(param_1 + 0x1610),
                                   local_20);
      if (piVar8 == (int *)0x0) goto LAB_10034354;
      piVar1 = piVar8 + 8;
      iVar13 = FUN_10025580((char *)(puVar7 + 0x14),(char *)piVar1);
      if (iVar13 == 0) {
        iVar13 = *(int *)(uVar3 + 0x70);
        *(undefined4 *)(uVar3 + 0x28) = 0;
        if (-1 < iVar13) {
          iVar13 = *(int *)(uVar3 + 0x6c);
        }
        *(int *)(uVar3 + 0x50) = iVar13;
        *(undefined4 *)(uVar3 + 0x54) = 0x73616d65;
        *(undefined4 *)(uVar3 + 0x58) = 0;
        return 0;
      }
      piVar9 = (int *)FUN_10022a40(this,*(int *)(param_1 + 0x1610),(byte *)(puVar7 + 0x14));
      if (piVar9 != (int *)0x0) {
        FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar9);
      }
      piVar9 = piVar1;
      do {
        iVar13 = *piVar9;
        *(char *)((int)puVar7 + (0x50 - (int)piVar1) + (int)piVar9) = (char)iVar13;
        piVar9 = (int *)((int)piVar9 + 1);
      } while ((char)iVar13 != '\0');
      FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar8);
      FUN_10010db0(param_1,0,*puVar7,8,(char *)piVar1,"is now the room host");
    }
    else {
      pbVar4 = local_20 + 1;
      iVar13 = 0x50 - (int)pbVar4;
      do {
        bVar2 = *pbVar4;
        pbVar4[(int)puVar7 + iVar13] = bVar2;
        pbVar4 = pbVar4 + 1;
      } while (bVar2 != 0);
    }
  }
  pbVar14 = (byte *)0x0;
  iVar13 = 0x20;
  pbVar4 = local_20;
  pbVar6 = FUN_100020f0(*(byte **)(uVar3 + 0x7c),&DAT_1004e794);
  iVar13 = FUN_10002a30(pbVar6,pbVar4,iVar13,pbVar14);
  if (-1 < iVar13) {
    if ((param_2 & 0x402100) == 0) goto LAB_100344a8;
    piVar8 = (int *)FUN_10022a40(*(void **)(param_1 + 0x1610),(int)*(void **)(param_1 + 0x1610),
                                 local_20);
    if (piVar8 == (int *)0x0) {
LAB_10034354:
      iVar13 = *(int *)(uVar3 + 0x70);
      *(undefined4 *)(uVar3 + 0x28) = 0;
      if (-1 < iVar13) {
        iVar13 = *(int *)(uVar3 + 0x6c);
      }
      *(int *)(uVar3 + 0x50) = iVar13;
      *(undefined4 *)(uVar3 + 0x54) = 0x75757372;
      *(undefined4 *)(uVar3 + 0x58) = 0;
      return 0;
    }
    piVar1 = piVar8 + 8;
    iVar13 = FUN_10025580((char *)(puVar7 + 0x18),(char *)piVar1);
    if (iVar13 == 0) {
      iVar13 = *(int *)(uVar3 + 0x70);
      *(undefined4 *)(uVar3 + 0x28) = 0;
      if (-1 < iVar13) {
        iVar13 = *(int *)(uVar3 + 0x6c);
      }
      *(int *)(uVar3 + 0x50) = iVar13;
      *(undefined4 *)(uVar3 + 0x54) = 0x73656c66;
      *(undefined4 *)(uVar3 + 0x58) = 0;
      return 0;
    }
    piVar9 = (int *)FUN_10022a40(this_00,*(int *)(param_1 + 0x1610),(byte *)(puVar7 + 0x18));
    if (piVar9 != (int *)0x0) {
      FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar9);
    }
    piVar9 = piVar1;
    do {
      iVar13 = *piVar9;
      *(char *)((int)puVar7 + (0x60 - (int)piVar1) + (int)piVar9) = (char)iVar13;
      piVar9 = (int *)((int)piVar9 + 1);
    } while ((char)iVar13 != '\0');
    FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar8);
    FUN_10010db0(param_1,0,*puVar7,8,(char *)piVar1,"is now the assistant room host");
  }
  pbVar14 = (byte *)0x0;
  iVar13 = 0x20;
  pbVar4 = local_20;
  pbVar6 = FUN_100020f0(*(byte **)(uVar3 + 0x7c),(byte *)"PERSIST");
  iVar13 = FUN_10002a30(pbVar6,pbVar4,iVar13,pbVar14);
  if (-1 < iVar13) {
    if ((param_2 & 0x2000) == 0) goto LAB_100344a8;
    if (local_20[0] == 0x30) {
      puVar7[0x45] = *(int *)(param_1 + 0x1994) + 15000;
    }
    else {
      puVar7[0x45] = 0;
    }
  }
  pbVar14 = (byte *)0x0;
  iVar13 = 0x20;
  pbVar4 = local_20;
  pbVar6 = FUN_100020f0(*(byte **)(uVar3 + 0x7c),(byte *)"LIMIT");
  iVar13 = FUN_10002a30(pbVar6,pbVar4,iVar13,pbVar14);
  if (-1 < iVar13) {
    if ((param_2 & 0x2000) == 0) goto LAB_100344a8;
    uVar10 = _atol((char *)local_20);
    puVar7[0x42] = uVar10;
    if ((int)uVar10 < 1) {
      puVar7[0x42] = 1;
    }
    if (1000 < (int)puVar7[0x42]) {
      puVar7[0x42] = 1000;
    }
  }
  FUN_100260e0(*(int *)(param_1 + 0x15f8),*puVar7);
  *(undefined4 *)(uVar3 + 0x58) = 0;
  uVar11 = FUN_10010d10(uVar3);
  return uVar11;
}



undefined4 __fastcall FUN_10034530(int param_1)

{
  if ((0 < *(int *)(param_1 + 0x204)) && (*(int *)(param_1 + 0x204) <= *(int *)(param_1 + 500))) {
    return 0;
  }
  return 1;
}



undefined4 __cdecl FUN_100347d0(int param_1,int param_2)

{
  char *pcVar1;
  byte bVar2;
  int iVar3;
  byte *pbVar4;
  uint *puVar5;
  uint *puVar6;
  byte *pbVar7;
  undefined4 uVar8;
  uint *puVar9;
  char cVar10;
  uint *puVar11;
  undefined1 *puVar12;
  uint *puVar13;
  bool bVar14;
  int iVar15;
  byte *pbVar16;
  byte local_20 [32];
  
  iVar15 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar15 = FUN_10002480((char *)pbVar4,iVar15);
  puVar5 = (uint *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar15);
  if (puVar5 == (uint *)0x0) {
    iVar15 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar15;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    return 0;
  }
  puVar6 = (uint *)FUN_10026280(*(int *)(param_1 + 0x15f8),puVar5[0xc]);
  if (puVar6 == (uint *)0x0) {
    iVar15 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar15;
    *(undefined4 *)(param_2 + 0x54) = 0x6e726f6d;
    return 0;
  }
  puVar13 = puVar5 + 8;
  iVar15 = FUN_10025580((char *)puVar13,(char *)(puVar6 + 0x14));
  if (((iVar15 != 0) &&
      (iVar15 = FUN_10025580((char *)puVar13,(char *)(puVar6 + 0x18)), iVar15 != 0)) &&
     ((puVar5[2] & 0x2000) == 0)) {
    iVar15 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar15;
    *(undefined4 *)(param_2 + 0x54) = 0x61757468;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar16 = &DAT_1004d26f;
  iVar15 = 0x20;
  pbVar4 = local_20;
  pbVar7 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar7,pbVar4,iVar15,pbVar16);
  iVar15 = 2;
  bVar14 = true;
  pbVar4 = local_20;
  pbVar7 = &DAT_1005322c;
  do {
    if (iVar15 == 0) break;
    iVar15 = iVar15 + -1;
    bVar14 = *pbVar4 == *pbVar7;
    pbVar4 = pbVar4 + 1;
    pbVar7 = pbVar7 + 1;
  } while (bVar14);
  if (bVar14) {
    **(undefined1 **)(param_2 + 0x60) = 0;
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e78c,
                 (byte *)(puVar6 + 0x48));
    uVar8 = FUN_10010d10(param_2);
    return uVar8;
  }
  if (local_20[0] == 0x2d) {
    pbVar4 = local_20;
    do {
      pbVar4 = pbVar4 + 1;
      pbVar4[-1] = *pbVar4;
    } while (*pbVar4 != 0);
    puVar13 = puVar6 + 0x48;
    bVar2 = (byte)*puVar13;
    puVar5 = puVar13;
    while( true ) {
      if (bVar2 == 0) {
        iVar15 = *(int *)(param_2 + 0x70);
        *(undefined4 *)(param_2 + 0x28) = 0;
        if (-1 < iVar15) {
          iVar15 = *(int *)(param_2 + 0x6c);
        }
        *(int *)(param_2 + 0x50) = iVar15;
        *(undefined4 *)(param_2 + 0x54) = 0x6e6b696b;
        *(undefined4 *)(param_2 + 0x58) = 0;
        return 0;
      }
      iVar15 = 0;
      if (local_20[0] == bVar2) {
        do {
          iVar3 = iVar15 + 1;
          iVar15 = iVar15 + 1;
        } while (local_20[iVar3] == *(byte *)((int)puVar5 + iVar15));
      }
      if (((local_20[iVar15] == 0) && (*(char *)(iVar15 + (int)puVar5) == '/')) &&
         ((puVar5 == puVar13 || (*(char *)((int)puVar5 + -1) == '/')))) break;
      bVar2 = *(byte *)((int)puVar5 + 1);
      puVar5 = (uint *)((int)puVar5 + 1);
    }
    puVar12 = (undefined1 *)(iVar15 + 1 + (int)puVar5);
    cVar10 = *(char *)(iVar15 + 1 + (int)puVar5);
    while (cVar10 != '\0') {
      *(char *)puVar5 = cVar10;
      pcVar1 = puVar12 + 1;
      puVar5 = (uint *)((int)puVar5 + 1);
      puVar12 = puVar12 + 1;
      cVar10 = *pcVar1;
    }
    *(undefined1 *)puVar5 = 0;
    FUN_100260e0(*(int *)(param_1 + 0x15f8),*puVar6);
    uVar8 = FUN_10010d10(param_2);
    return uVar8;
  }
  puVar9 = (uint *)FUN_10022a40(local_20,*(int *)(param_1 + 0x1610),local_20);
  if (puVar9 == (uint *)0x0) {
    iVar15 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar15;
    *(undefined4 *)(param_2 + 0x54) = 0x75757372;
    return 0;
  }
  if (puVar5 == puVar9) {
    iVar15 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar15;
    *(undefined4 *)(param_2 + 0x54) = 0x73656c66;
    return 0;
  }
  iVar15 = FUN_10025580((char *)(puVar9 + 8),(char *)puVar13);
  if ((iVar15 == 0) && ((puVar5[2] & 0x2000) == 0)) {
    iVar15 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar15;
    *(undefined4 *)(param_2 + 0x54) = 0x6b696b68;
    return 0;
  }
  cVar10 = (char)puVar6[0x48];
  puVar5 = puVar6 + 0x48;
  if (cVar10 != '\0') {
    do {
      iVar15 = 0;
      if ((char)puVar9[8] == cVar10) {
        do {
          iVar3 = iVar15 + 0x21;
          iVar15 = iVar15 + 1;
        } while (*(char *)((int)puVar9 + iVar3) == *(char *)(iVar15 + (int)puVar5));
      }
      if (((*(char *)((int)puVar9 + iVar15 + 0x20) == '\0') &&
          (*(char *)(iVar15 + (int)puVar5) == '/')) &&
         ((puVar5 == puVar6 + 0x48 || (*(char *)((int)puVar5 + -1) == '/')))) {
        puVar12 = (undefined1 *)(iVar15 + 1 + (int)puVar5);
        cVar10 = *(char *)(iVar15 + 1 + (int)puVar5);
        while (cVar10 != '\0') {
          *(char *)puVar5 = cVar10;
          pcVar1 = puVar12 + 1;
          puVar5 = (uint *)((int)puVar5 + 1);
          puVar12 = puVar12 + 1;
          cVar10 = *pcVar1;
        }
        *(undefined1 *)puVar5 = 0;
        break;
      }
      cVar10 = *(char *)((int)puVar5 + 1);
      puVar5 = (uint *)((int)puVar5 + 1);
    } while (cVar10 != '\0');
  }
  iVar15 = 0;
  cVar10 = (char)puVar9[8];
  while (cVar10 != '\0') {
    iVar3 = iVar15 + 0x21;
    iVar15 = iVar15 + 1;
    cVar10 = *(char *)((int)puVar9 + iVar3);
  }
  puVar12 = (undefined1 *)((int)puVar5 + ((iVar15 + -0x11e) - (int)puVar6));
  do {
    if ((int)puVar12 < 0x80) {
      puVar11 = puVar9 + 8;
      cVar10 = (char)puVar9[8];
      while (cVar10 != '\0') {
        *(char *)puVar5 = cVar10;
        pcVar1 = (char *)((int)puVar11 + 1);
        puVar5 = (uint *)((int)puVar5 + 1);
        puVar11 = (uint *)((int)puVar11 + 1);
        cVar10 = *pcVar1;
      }
      *(undefined1 *)puVar5 = 0x2f;
      *(undefined1 *)((int)puVar5 + 1) = 0;
      FUN_100260e0(*(int *)(param_1 + 0x15f8),*puVar6);
      if (puVar9[0xc] == *puVar6) {
        _sprintf(*(char **)(param_2 + 0x60),"You have been kicked out of the room by %s",puVar13);
        FUN_10010db0(param_1,*puVar9,0,0,"Server",*(char **)(param_2 + 0x60));
        _sprintf(*(char **)(param_2 + 0x60),"has been kicked out of room by %s",puVar13);
        FUN_10010db0(param_1,0,*puVar6,8,(char *)(puVar9 + 8),*(char **)(param_2 + 0x60));
        puVar6[0x43] = puVar6[0x43] - 1;
        puVar9[0xc] = 0;
        FUN_100260e0(*(int *)(param_1 + 0x1614),*puVar9);
      }
      *(undefined4 *)(param_2 + 0x58) = 0;
      uVar8 = FUN_10010d10(param_2);
      return uVar8;
    }
    puVar11 = puVar6 + 0x48;
    cVar10 = (char)puVar6[0x48];
    while (cVar10 != '\0') {
      if (cVar10 == '/') goto LAB_10034b92;
      pcVar1 = (char *)((int)puVar11 + 1);
      puVar11 = (uint *)((int)puVar11 + 1);
      puVar12 = puVar12 + -1;
      cVar10 = *pcVar1;
    }
    if ((char)*puVar11 == '/') {
LAB_10034b92:
      puVar11 = (uint *)((int)puVar11 + 1);
      puVar12 = puVar12 + -1;
    }
    puVar5 = puVar6 + 0x48;
    cVar10 = (char)*puVar11;
    while (cVar10 != '\0') {
      *(char *)puVar5 = cVar10;
      pcVar1 = (char *)((int)puVar11 + 1);
      puVar5 = (uint *)((int)puVar5 + 1);
      puVar11 = (uint *)((int)puVar11 + 1);
      cVar10 = *pcVar1;
    }
    *(undefined1 *)puVar5 = 0;
  } while( true );
}



undefined4 __cdecl FUN_10034c90(int param_1,int param_2)

{
  byte *pbVar1;
  int *piVar2;
  byte *pbVar3;
  undefined4 uVar4;
  int iVar5;
  byte *pbVar6;
  byte local_20 [32];
  
  iVar5 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar5 = FUN_10002480((char *)pbVar1,iVar5);
  piVar2 = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar5);
  if (piVar2 == (int *)0x0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    iVar5 = *(int *)(param_2 + 0x70);
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar5;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x20;
  pbVar1 = local_20;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10052aa4);
  FUN_10002a30(pbVar3,pbVar1,iVar5,pbVar6);
  iVar5 = FUN_10005cd0(local_20,&DAT_10053234);
  if ((iVar5 == 0) && ((piVar2[2] & 0x10000U) != 0)) {
    piVar2[2] = piVar2[2] ^ 0x10000;
    FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar2);
  }
  iVar5 = FUN_10005cd0(local_20,&DAT_10053230);
  if ((iVar5 == 0) && ((piVar2[2] & 0x10000U) == 0)) {
    piVar2[2] = piVar2[2] ^ 0x10000;
    FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar2);
  }
  **(undefined1 **)(param_2 + 0x60) = 0;
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e6a4,
               ~(uint)*(ushort *)((int)piVar2 + 10) & 1);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  uVar4 = FUN_10010d10(param_2);
  return uVar4;
}



void __cdecl FUN_10034dd0(int param_1)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  void *pvVar7;
  void *this;
  byte *pbVar8;
  char *pcVar9;
  void *this_00;
  int *_Memory;
  int *piVar10;
  byte *pbVar11;
  byte *pbVar12;
  uint uVar13;
  int local_38;
  int *local_34;
  byte local_30 [36];
  void *local_c;
  undefined1 *puStack_8;
  void *local_4;
  
  iVar2 = param_1;
  local_4 = (void *)0xffffffff;
  puStack_8 = &LAB_1004cf7b;
  local_c = ExceptionList;
  local_38 = 0;
  _Memory = (int *)0x0;
  ExceptionList = &local_c;
  FUN_10022c50(*(int *)(param_1 + 0x1600));
  iVar3 = FUN_10022c60(*(int *)(param_1 + 0x1600),(undefined4 *)0x0);
  while (iVar3 != 0) {
    *(undefined1 *)(iVar3 + 0x208) = 1;
    iVar3 = FUN_10022c60(*(int *)(param_1 + 0x1600),(undefined4 *)0x0);
  }
  pbVar4 = FUN_10014600(*(int *)(param_1 + 0x1400),(byte *)"AUTOROOM");
  do {
    if ((pbVar4 == (byte *)0x0) || (*pbVar4 == 0)) {
      FUN_10022c50(*(int *)(iVar2 + 0x1600));
      iVar3 = FUN_10022c60(*(int *)(iVar2 + 0x1600),(undefined4 *)0x0);
      while (iVar3 != 0) {
        if (*(char *)(iVar3 + 0x208) != '\0') {
          *(int *)(iVar3 + 0xc) = local_38;
          local_38 = local_38 + 1;
          FUN_100260e0(*(int *)(iVar2 + 0x1604),*(int *)(iVar3 + 4));
        }
        iVar3 = FUN_10022c60(*(int *)(iVar2 + 0x1600),(undefined4 *)0x0);
      }
      ExceptionList = local_c;
      return;
    }
    iVar3 = -1;
    pbVar5 = FUN_100020f0(pbVar4,(byte *)"CATEGORY_ID");
    uVar6 = FUN_10002480((char *)pbVar5,iVar3);
    if ((int)uVar6 < 0) {
      pbVar11 = &DAT_1004d26f;
      iVar3 = 0x24;
      pbVar5 = local_30;
      pbVar8 = FUN_100020f0(pbVar4,&DAT_1004d8c8);
      FUN_10002a30(pbVar8,pbVar5,iVar3,pbVar11);
      if (local_30[0] == 0) {
        if (_Memory != (int *)0x0) {
          _free(_Memory);
        }
      }
      else {
        _Memory = (int *)_malloc(0x1d4);
        piVar10 = _Memory;
        for (iVar3 = 0x75; iVar3 != 0; iVar3 = iVar3 + -1) {
          *piVar10 = 0;
          piVar10 = piVar10 + 1;
        }
        _Memory[0x6e] = *(int *)(iVar2 + 0x1275124);
        _Memory[0x6f] = *(int *)(iVar2 + 0x1275128);
        _Memory[0x70] = *(int *)(iVar2 + 0x127512c);
        _Memory[0x71] = *(int *)(iVar2 + 0x1275130);
        iVar3 = -1;
        _Memory[0x72] = *(int *)(iVar2 + 0x1275134);
        _Memory[0x73] = *(int *)(iVar2 + 0x1275138);
        pbVar5 = FUN_100020f0(pbVar4,(byte *)"CATEGORY");
        iVar3 = FUN_10002480((char *)pbVar5,iVar3);
        _Memory[0x69] = iVar3;
        pbVar8 = local_30;
        pbVar5 = (byte *)(_Memory + 2);
        iVar3 = (int)pbVar5 - (int)pbVar8;
        do {
          bVar1 = *pbVar8;
          pbVar8[iVar3] = bVar1;
          pbVar8 = pbVar8 + 1;
        } while (bVar1 != 0);
        if (_Memory[0x69] != 0xffffffff) {
          pvVar7 = (void *)FUN_100276f0(*(int *)(iVar2 + 0x1600),_Memory[0x69]);
          if (((pvVar7 == (void *)0x0) || (*(char *)((int)pvVar7 + 0x1f0) != '\0')) ||
             (*(char *)((int)pvVar7 + 0x1f1) != '\0')) {
            FUN_10016450(8);
            _free(_Memory);
            goto LAB_100352df;
          }
          FUN_100273b0(pvVar7,(int)_Memory);
          FUN_100275b0((char *)pbVar5,0x24);
        }
        pbVar12 = &DAT_1004d26f;
        iVar3 = 0x14;
        pbVar8 = (byte *)(_Memory + 0x1c);
        pbVar11 = FUN_100020f0(pbVar4,&DAT_1004e5a0);
        FUN_10002a30(pbVar11,pbVar8,iVar3,pbVar12);
        pbVar8 = (byte *)(_Memory + 0x14);
        iVar3 = 0x10;
        pbVar11 = pbVar8;
        pbVar12 = FUN_100020f0(pbVar4,&DAT_1004e7a4);
        FUN_10002a30(pbVar12,pbVar8,iVar3,pbVar11);
        iVar3 = 0x84;
        pbVar8 = (byte *)(_Memory + 0x21);
        pbVar11 = pbVar5;
        pbVar12 = FUN_100020f0(pbVar4,&DAT_1004df70);
        FUN_10002a30(pbVar12,pbVar8,iVar3,pbVar11);
        iVar3 = 0x24;
        pbVar8 = (byte *)(_Memory + 0xb);
        pbVar11 = pbVar5;
        pbVar12 = FUN_100020f0(pbVar4,&DAT_1004e79c);
        FUN_10002a30(pbVar12,pbVar8,iVar3,pbVar11);
        uVar6 = _Memory[1];
        pbVar8 = FUN_100020f0(pbVar4,(byte *)"FLAGS");
        uVar6 = FUN_100025a0((char *)pbVar8,uVar6);
        _Memory[1] = uVar6 | 0x808;
        pbVar8 = FUN_100020f0(pbVar4,&DAT_1004dca4);
        if (pbVar8 != (byte *)0x0) {
          uVar6 = _Memory[0x6a];
          pbVar8 = FUN_100020f0(pbVar4,&DAT_1004dca4);
          uVar6 = FUN_10002930(pbVar8,uVar6);
          _Memory[0x6a] = uVar6;
        }
        uVar6 = 0;
        pbVar8 = FUN_100020f0(pbVar4,&DAT_1004e784);
        uVar6 = FUN_100025a0((char *)pbVar8,uVar6);
        uVar13 = 0;
        _Memory[0x6b] = uVar6;
        pbVar8 = FUN_100020f0(pbVar4,(byte *)"CRITMASK");
        uVar6 = FUN_100025a0((char *)pbVar8,uVar13);
        _Memory[0x6c] = uVar6;
        local_34 = _Memory + 0x6e;
        param_1 = 0;
        do {
          pcVar9 = (char *)FUN_100022d0(pbVar4,"CRITVAL",param_1);
          if (pcVar9 != (char *)0x0) {
            iVar3 = FUN_10002480(pcVar9,0);
            *local_34 = iVar3;
          }
          param_1 = param_1 + 1;
          local_34 = local_34 + 1;
        } while (param_1 < 6);
        iVar3 = _Memory[0x42];
        _Memory[0x6d] = 6;
        pbVar8 = FUN_100020f0(pbVar4,&DAT_1004e76c);
        iVar3 = FUN_10002480((char *)pbVar8,iVar3);
        _Memory[0x42] = iVar3;
        if ((char)_Memory[0x1c] != '\0') {
          _Memory[1] = _Memory[1] | 0x10000;
        }
        FUN_10015a30(*(undefined4 *)(*(int *)(iVar2 + 0x1740) + 0x10c),pbVar4,0,(char *)pbVar5,
                     (int)(_Memory + 0x6b));
        iVar3 = 0x708;
        pbVar8 = FUN_100020f0(pbVar4,&DAT_1004f224);
        iVar3 = FUN_10002480((char *)pbVar8,iVar3);
        _Memory[0x45] = iVar3 * 1000 + *(int *)(iVar2 + 0x1994);
        FUN_100229d0(this_00,*(int **)(iVar2 + 0x15f4),pbVar5,(int)_Memory);
        iVar3 = FUN_10026030(*(int **)(iVar2 + 0x15f8),0,_Memory);
        *_Memory = iVar3;
      }
    }
    else {
      pvVar7 = (void *)FUN_100276f0(*(int *)(iVar2 + 0x1600),uVar6);
      if (pvVar7 == (void *)0x0) {
        this = operator_new(0x294);
        if (this == (void *)0x0) {
          pvVar7 = (void *)0x0;
        }
        else {
          local_4 = pvVar7;
          pvVar7 = (void *)FUN_10026e80(this,*(undefined4 *)(iVar2 + 0x1274e74));
        }
        local_4 = (void *)0xffffffff;
        FUN_10022b00(*(int **)(iVar2 + 0x1600),uVar6,(int)pvVar7);
        iVar3 = FUN_10026030(*(int **)(iVar2 + 0x1604),0,pvVar7);
        *(int *)((int)pvVar7 + 4) = iVar3;
      }
      else {
        FUN_100260e0(*(int *)(iVar2 + 0x1604),*(int *)((int)pvVar7 + 4));
        uVar6 = *(uint *)((int)pvVar7 + 8);
      }
      FUN_10027010(pvVar7,uVar6,pbVar4);
      FUN_100275b0((char *)local_30,0x24);
      FUN_10015a30(*(undefined4 *)(*(int *)(iVar2 + 0x1740) + 0x10c),pbVar4,0,(char *)local_30,
                   (int)pvVar7 + 0x224);
      *(int *)((int)pvVar7 + 0xc) = local_38;
      local_38 = local_38 + 1;
      *(undefined1 *)((int)pvVar7 + 0x208) = 0;
    }
LAB_100352df:
    pbVar4 = (byte *)FUN_10003660((char *)pbVar4);
  } while( true );
}



uint * __cdecl FUN_10035370(int param_1,uint *param_2,char param_3)

{
  uint *puVar1;
  int iVar2;
  
  puVar1 = (uint *)FUN_10026280(*(int *)(param_1 + 0x15f8),param_2[0xc]);
  if (puVar1 != (uint *)0x0) {
    if (((param_3 != '\0') &&
        (iVar2 = FUN_10022bb0(*(int *)(param_1 + 0x1600),puVar1[0x69]), iVar2 != 0)) &&
       (*(char *)(iVar2 + 0x200) != '\0')) {
      return puVar1;
    }
    param_2[0xc] = 0;
    puVar1[0x43] = puVar1[0x43] - 1;
    if (0 < *(int *)(param_1 + 0x15fc)) {
      FUN_10010db0(param_1,*param_2,*puVar1,8,(char *)(param_2 + 8),"has left the pRoom");
    }
  }
  return puVar1;
}



undefined4 __cdecl FUN_10035400(int param_1,int param_2)

{
  bool bVar1;
  byte *pbVar2;
  uint *puVar3;
  uint uVar4;
  byte *pbVar5;
  uint *puVar6;
  uint *puVar7;
  uint *puVar8;
  undefined4 uVar9;
  void *this;
  uint *puVar10;
  int iVar11;
  int iVar12;
  byte *pbVar13;
  int iVar14;
  char *pcVar15;
  uint local_208 [2];
  byte local_200 [36];
  char local_1dc [36];
  char local_1b8 [32];
  byte local_198 [20];
  byte local_184 [132];
  int local_100;
  int local_f4;
  undefined4 local_64;
  uint local_60;
  uint local_5c [12];
  byte local_2c [40];
  
  iVar12 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar12 = FUN_10002480((char *)pbVar2,iVar12);
  puVar3 = (uint *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar12);
  if (puVar3 != (uint *)0x0) {
    uVar4 = puVar3[0xb0];
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLPING");
    uVar4 = FUN_10002480((char *)pbVar2,uVar4);
    puVar3[0xb0] = uVar4;
    if ((puVar3[2] & 0x10) != 0) {
      iVar12 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar12) {
        iVar12 = *(int *)(param_2 + 0x6c);
      }
      *(int *)(param_2 + 0x50) = iVar12;
      *(undefined4 *)(param_2 + 0x54) = 0x61757468;
      *(undefined4 *)(param_2 + 0x58) = 0;
      return 0;
    }
    iVar12 = FUN_100262c0(*(int *)(param_1 + 0x15f8));
    if (iVar12 <= *(int *)(param_1 + 0x15f0)) {
      pbVar13 = &DAT_1004d26f;
      iVar11 = 0x24;
      pbVar2 = local_200;
      puVar7 = local_208;
      for (iVar12 = 0x75; iVar12 != 0; iVar12 = iVar12 + -1) {
        *puVar7 = 0;
        puVar7 = puVar7 + 1;
      }
      pbVar5 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
      FUN_10002a30(pbVar5,pbVar2,iVar11,pbVar13);
      pbVar5 = &DAT_1004d26f;
      iVar12 = 0x14;
      pbVar2 = local_198;
      pbVar13 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e5a0);
      FUN_10002a30(pbVar13,pbVar2,iVar12,pbVar5);
      puVar6 = puVar3 + 8;
      puVar7 = puVar6;
      do {
        uVar4 = *puVar7;
        (local_1b8 + -(int)puVar6)[(int)puVar7] = (char)uVar4;
        puVar7 = (uint *)((int)puVar7 + 1);
      } while ((char)uVar4 != '\0');
      pbVar5 = &DAT_1004d26f;
      iVar12 = 0x84;
      pbVar2 = local_184;
      pbVar13 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004df70);
      FUN_10002a30(pbVar13,pbVar2,iVar12,pbVar5);
      uVar4 = 0;
      pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"FLAGS");
      local_208[1] = FUN_100025a0((char *)pbVar2,uVar4);
      iVar12 = 0x19;
      pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1005334c);
      local_100 = FUN_10002480((char *)pbVar2,iVar12);
      local_f4 = *(int *)(param_1 + 0x1994) + 15000;
      local_60 = puVar3[0x10a];
      FUN_100275e0((char *)local_200,(undefined1 *)0x0,0,local_1dc,0x24);
      FUN_100275e0((char *)local_200,local_2c,0x24,(char *)0x0,0);
      iVar12 = FUN_10027670(*(int *)(param_1 + 0x1600),local_2c);
      if (iVar12 == 0) {
        iVar12 = *(int *)(param_2 + 0x70);
        *(undefined4 *)(param_2 + 0x28) = 0;
        if (-1 < iVar12) {
          iVar12 = *(int *)(param_2 + 0x6c);
        }
        *(int *)(param_2 + 0x50) = iVar12;
        *(undefined4 *)(param_2 + 0x54) = 0x75636174;
        *(undefined4 *)(param_2 + 0x58) = 0;
        return 0;
      }
      local_64 = *(undefined4 *)(iVar12 + 8);
      iVar11 = 0;
      pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"IGNEXIST");
      iVar11 = FUN_10002480((char *)pbVar2,iVar11);
      iVar14 = 0;
      pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"IGNPROFNAME");
      iVar14 = FUN_10002480((char *)pbVar2,iVar14);
      if (iVar14 == 0) {
        FUN_100254c0(*(undefined4 *)(param_1 + 0x1cd4),local_200);
        uVar4 = FUN_10025120(*(int **)(param_1 + 0x1cd4),local_200);
        if ((0 < (int)uVar4) || (local_200[0] == 0)) {
          iVar12 = *(int *)(param_2 + 0x70);
          *(undefined4 *)(param_2 + 0x28) = 0;
          if (-1 < iVar12) {
            iVar12 = *(int *)(param_2 + 0x6c);
          }
          *(int *)(param_2 + 0x50) = iVar12;
          *(undefined4 *)(param_2 + 0x54) = 0x66696c74;
          *(undefined4 *)(param_2 + 0x58) = 0;
          return 0;
        }
        uVar4 = FUN_10025120(*(int **)(param_1 + 0x1cd4),local_198);
        if (0 < (int)uVar4) {
          iVar12 = *(int *)(param_2 + 0x70);
          *(undefined4 *)(param_2 + 0x28) = 0;
          if (-1 < iVar12) {
            iVar12 = *(int *)(param_2 + 0x6c);
          }
          *(int *)(param_2 + 0x50) = iVar12;
          *(undefined4 *)(param_2 + 0x54) = 0x70617373;
          *(undefined4 *)(param_2 + 0x58) = 0;
          return 0;
        }
      }
      uVar4 = local_208[1] | 8;
      if (local_198[0] != 0) {
        uVar4 = local_208[1] | 0x10008;
      }
      local_208[1] = uVar4;
      if (local_100 < 2) {
        local_100 = 2;
      }
      else if (999 < local_100) {
        local_100 = 999;
      }
      if ((puVar3[2] & 0x2002) != 0) {
        iVar14 = FUN_10005cd0(local_198,(byte *)"$invis$");
        if (iVar14 == 0) {
          local_208[1] = local_208[1] & 0xfffeffff | 0x200;
          local_198[0] = 0;
        }
      }
      FUN_10015a30(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x10c),*(byte **)(param_2 + 0x7c),
                   (int)puVar3,(char *)local_200,(int)local_5c);
      uVar4 = FUN_1003f3e0(local_5c,puVar3 + 0xef);
      if (uVar4 == 0) {
        iVar12 = *(int *)(param_2 + 0x70);
        *(undefined4 *)(param_2 + 0x28) = 0;
        if (-1 < iVar12) {
          iVar12 = *(int *)(param_2 + 0x6c);
        }
        *(int *)(param_2 + 0x50) = iVar12;
        *(undefined4 *)(param_2 + 0x54) = 0x72617574;
        *(undefined4 *)(param_2 + 0x58) = 0;
        return 0;
      }
      puVar7 = (uint *)FUN_10022a40(this,*(int *)(param_1 + 0x15f4),local_200);
      if (puVar7 != (uint *)0x0) {
        bVar1 = true;
        if (iVar11 == 0) {
          iVar12 = *(int *)(param_2 + 0x70);
          *(undefined4 *)(param_2 + 0x28) = 0;
          if (-1 < iVar12) {
            iVar12 = *(int *)(param_2 + 0x6c);
          }
          *(int *)(param_2 + 0x50) = iVar12;
          *(undefined4 *)(param_2 + 0x54) = 0x6475706c;
          *(undefined4 *)(param_2 + 0x58) = 0;
          return 0;
        }
LAB_10035901:
        puVar8 = (uint *)FUN_10026280(*(int *)(param_1 + 0x15f8),puVar3[0xc]);
        if ((puVar8 != (uint *)0x0) &&
           (puVar8[0x43] = puVar8[0x43] - 1, 0 < *(int *)(param_1 + 0x15fc))) {
          FUN_10010db0(param_1,*puVar3,*puVar8,8,(char *)puVar6,"has left the room");
        }
        puVar7[0x43] = puVar7[0x43] + 1;
        puVar3[0xc] = *puVar7;
        FUN_100260e0(*(int *)(param_1 + 0x1614),*puVar3);
        if (0 < *(int *)(param_1 + 0x15fc)) {
          if (bVar1) {
            uVar4 = *puVar7;
            pcVar15 = "has entered the room";
          }
          else {
            uVar4 = *puVar7;
            pcVar15 = "has created the room";
          }
          FUN_10010db0(param_1,0,uVar4,8,(char *)puVar6,pcVar15);
        }
        **(undefined1 **)(param_2 + 0x60) = 0;
        FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"IDENT",*puVar7);
        FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c8,
                     (byte *)(puVar7 + 2));
        FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e7a4,
                     (byte *)(puVar7 + 0x14));
        FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004df70,
                     (byte *)(puVar7 + 0x21));
        FUN_100027d0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004dca4,puVar7[0x6a])
        ;
        FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"COUNT",
                     puVar7[0x43]);
        FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"LIMIT",
                     puVar7[0x42]);
        FUN_100024f0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"FLAGS",puVar7[1]);
        FUN_10002d30(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e784,puVar7 + 0x6b
                     ,0x24,&DAT_1004e4d4);
        uVar9 = FUN_10010d10(param_2);
        return uVar9;
      }
      bVar1 = false;
      uVar9 = FUN_10034530(iVar12);
      if ((char)uVar9 != '\0') {
        puVar7 = (uint *)_malloc(0x1d4);
        puVar8 = local_208;
        puVar10 = puVar7;
        for (iVar11 = 0x75; iVar11 != 0; iVar11 = iVar11 + -1) {
          *puVar10 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar10 = puVar10 + 1;
        }
        FUN_100229d0(*(void **)(param_1 + 0x15f4),(int *)*(void **)(param_1 + 0x15f4),
                     (byte *)(puVar7 + 2),(int)puVar7);
        uVar4 = FUN_10026030(*(int **)(param_1 + 0x15f8),0,puVar7);
        *puVar7 = uVar4;
        *(int *)(iVar12 + 500) = *(int *)(iVar12 + 500) + 1;
        FUN_10016490(4);
        goto LAB_10035901;
      }
    }
    iVar12 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar12) {
      iVar12 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar12;
    *(undefined4 *)(param_2 + 0x54) = 0x66756c6c;
    *(undefined4 *)(param_2 + 0x58) = 0;
  }
  return 0;
}



undefined4 FUN_10035ab0(int param_1,uint param_2)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  int *_Memory;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  byte local_20 [32];
  
  iVar4 = param_2;
  iVar8 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar8 = FUN_10002480((char *)pbVar1,iVar8);
  iVar8 = FUN_10026280(*(int *)(param_1 + 0x1614),iVar8);
  if (iVar8 == 0) {
    return 0;
  }
  iVar2 = *(int *)(iVar8 + 0x2c0);
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLPING");
  iVar2 = FUN_10002480((char *)pbVar1,iVar2);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x20;
  pbVar1 = local_20;
  *(int *)(iVar8 + 0x2c0) = iVar2;
  pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar3,pbVar1,iVar6,pbVar7);
  _Memory = (int *)FUN_10022a40(*(void **)(param_1 + 0x15f4),(int)*(void **)(param_1 + 0x15f4),
                                local_20);
  if (_Memory == (int *)0x0) {
    iVar4 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar4;
    *(undefined4 *)(param_2 + 0x54) = 0x75726f6d;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  param_2 = *(uint *)(iVar8 + 8) & 0x2002;
  iVar2 = FUN_10025580((char *)(iVar8 + 0x20),(char *)(_Memory + 0x14));
  if (iVar2 == 0) {
    param_2 = param_2 | 0x100;
  }
  FUN_10025580((char *)(iVar8 + 0x20),(char *)(_Memory + 0x18));
  if (param_2 == 0) {
    iVar8 = *(int *)(iVar4 + 0x70);
    *(undefined4 *)(iVar4 + 0x28) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(iVar4 + 0x6c);
    }
    *(int *)(iVar4 + 0x50) = iVar8;
    *(undefined4 *)(iVar4 + 0x54) = 0x61757468;
    *(undefined4 *)(iVar4 + 0x58) = 0;
    return 0;
  }
  _sprintf(*(char **)(iVar4 + 0x60),"KILL=\'%s\'",_Memory + 2);
  FUN_100261a0(*(int *)(param_1 + 0x15f8),*_Memory);
  FUN_10022a90(*(void **)(param_1 + 0x15f4),(int *)*(void **)(param_1 + 0x15f4),
               (byte *)(_Memory + 2));
  iVar8 = FUN_100276f0(*(int *)(param_1 + 0x1600),_Memory[0x69]);
  if (iVar8 != 0) {
    *(int *)(iVar8 + 500) = *(int *)(iVar8 + 500) + -1;
  }
  _free(_Memory);
  uVar5 = FUN_10010d10(iVar4);
  return uVar5;
}



undefined4 __cdecl FUN_10036a10(int param_1,int param_2)

{
  byte *pbVar1;
  int *piVar2;
  uint uVar3;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  undefined4 uVar7;
  int iVar8;
  
  iVar8 = 0;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"CALLUSER");
  iVar8 = FUN_10002480((char *)pbVar1,iVar8);
  piVar2 = (int *)FUN_10026280(*(int *)(param_1 + 0x1614),iVar8);
  if (piVar2 == (int *)0x0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    iVar8 = *(int *)(param_2 + 0x70);
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 0x6c);
    }
    *(int *)(param_2 + 0x50) = iVar8;
    *(undefined4 *)(param_2 + 0x54) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6e8);
  if (pbVar1 != (byte *)0x0) {
    uVar3 = FUN_100025a0((char *)pbVar1,piVar2[0xc4]);
    piVar2[0xc4] = uVar3;
  }
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"HWFLAG");
  if (pbVar4 != (byte *)0x0) {
    iVar5 = FUN_10002480((char *)pbVar4,piVar2[0xc2]);
    iVar8 = piVar2[0xc3];
    piVar2[0xc2] = iVar5;
    pbVar6 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"HWMASK");
    iVar8 = FUN_10002480((char *)pbVar6,iVar8);
    piVar2[0xc3] = iVar8;
  }
  pbVar6 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"FLAGS");
  if (pbVar6 == (byte *)0x0) {
    if (pbVar4 == (byte *)0x0 && pbVar1 == (byte *)0x0) goto LAB_10036b58;
  }
  else {
    uVar3 = FUN_100025a0((char *)pbVar6,0);
    piVar2[2] = piVar2[2] ^ (uVar3 ^ piVar2[2]) & 0x78014000;
  }
  FUN_10015a20();
  piVar2[1] = piVar2[1] + 1;
  FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar2);
LAB_10036b58:
  uVar7 = FUN_10010d10(param_2);
  return uVar7;
}



undefined4 __cdecl FUN_100371f0(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  int *piVar8;
  bool bVar9;
  int local_18 [6];
  
  iVar3 = *(int *)(param_1 + 0x1994);
  if (iVar3 == *(int *)(param_1 + 0x1274e98) || iVar3 - *(int *)(param_1 + 0x1274e98) < 0) {
    return 0;
  }
  iVar4 = 0;
  iVar5 = 0;
  iVar7 = 0;
  *(int *)(param_1 + 0x1274e98) = *(int *)(param_1 + 0x1274e94) + iVar3;
  local_18[5] = 0;
  local_18[0] = 0;
  local_18[1] = 0;
  local_18[2] = 0;
  local_18[3] = 0;
  local_18[4] = 0;
  FUN_10022c50(*(int *)(param_1 + 0x1610));
  iVar3 = FUN_10022c60(*(int *)(param_1 + 0x1610),(undefined4 *)0x0);
  iVar1 = local_18[0];
  iVar2 = local_18[1];
  while (iVar3 != 0) {
    if (*(int *)(iVar3 + 0x38) == 0) {
      if (*(int *)(iVar3 + 0x30) == 0) {
        iVar5 = iVar5 + 1;
      }
      else {
        iVar7 = iVar7 + 1;
      }
    }
    else {
      local_18[2] = local_18[2] + 1;
    }
    iVar3 = FUN_10022c60(*(int *)(param_1 + 0x1610),(undefined4 *)0x0);
    iVar1 = iVar5;
    iVar2 = iVar7;
  }
  local_18[0] = iVar1;
  local_18[1] = iVar2;
  for (iVar3 = FUN_1002a780(*(int *)(param_1 + 0x172c)); iVar3 != 0;
      iVar3 = FUN_1002a870(*(undefined4 *)(param_1 + 0x172c),iVar3)) {
    if ((*(uint *)(iVar3 + 4) & 0x80000) == 0) {
      local_18[4] = local_18[4] + 1;
    }
    else {
      local_18[3] = local_18[3] + 1;
    }
  }
  iVar3 = FUN_1002a780(*(int *)(*(int *)(param_1 + 0x1740) + 0x114));
  iVar5 = local_18[5];
  while (iVar3 != 0) {
    iVar4 = iVar4 + 1;
    iVar3 = FUN_1002a870(*(undefined4 *)(*(int *)(param_1 + 0x1740) + 0x114),iVar3);
    iVar5 = iVar4;
  }
  local_18[5] = iVar5;
  FUN_10022c50(*(int *)(*(int *)(param_1 + 0x1740) + 0x110));
  iVar3 = FUN_10022c60(*(int *)(*(int *)(param_1 + 0x1740) + 0x110),(undefined4 *)0x0);
  if (iVar3 != 0) {
    do {
      iVar4 = iVar4 + 1;
      iVar3 = FUN_10022c60(*(int *)(*(int *)(param_1 + 0x1740) + 0x110),(undefined4 *)0x0);
    } while (iVar3 != 0);
    local_18[5] = iVar4;
  }
  iVar3 = 6;
  bVar9 = true;
  piVar6 = (int *)(param_1 + 0x1274e78);
  piVar8 = local_18;
  do {
    if (iVar3 == 0) break;
    iVar3 = iVar3 + -1;
    bVar9 = *piVar6 == *piVar8;
    piVar6 = piVar6 + 1;
    piVar8 = piVar8 + 1;
  } while (bVar9);
  if (!bVar9) {
    *(int *)(param_1 + 0x1274e78) = local_18[0];
    *(int *)(param_1 + 0x1274e7c) = local_18[1];
    *(int *)(param_1 + 0x1274e80) = local_18[2];
    *(int *)(param_1 + 0x1274e84) = local_18[3];
    *(int *)(param_1 + 0x1274e88) = local_18[4];
    *(int *)(param_1 + 0x1274e8c) = iVar4;
    *(int *)(param_1 + 0x1274e90) = *(int *)(param_1 + 0x1274e90) + 1;
  }
  return 0;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_100373c0(int param_1,int param_2)

{
  bool bVar1;
  byte *pbVar2;
  int *piVar3;
  byte *pbVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  byte local_115c [16];
  byte local_114c [16];
  byte local_113c [512];
  byte local_f3c [3896];
  undefined4 uStack_4;
  
  uStack_4 = 0x100373ca;
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x10;
  pbVar4 = local_114c;
  bVar1 = false;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar2,pbVar4,iVar7,pbVar8);
  piVar3 = (int *)FUN_10022a40(*(void **)(param_1 + 0x1610),(int)*(void **)(param_1 + 0x1610),
                               local_114c);
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x200;
  pbVar4 = local_113c;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"EDUSINP");
  FUN_10002a30(pbVar2,pbVar4,iVar7,pbVar8);
  FUN_10003a20(*(byte **)(param_2 + 0x7c),(byte *)"EDUSINP");
  FUN_100020b0((char *)local_f3c,0xf3c,*(char **)(param_2 + 0x7c));
  pbVar4 = FUN_100020f0(local_113c,(byte *)"MEDALS");
  if (pbVar4 != (byte *)0x0) {
    uVar5 = FUN_10002480((char *)pbVar4,0);
    FUN_10002370(local_f3c,0xf3c,(byte *)"MEDALS",uVar5);
    bVar1 = true;
    if (piVar3 != (int *)0x0) {
      piVar3[0xc6] = uVar5;
    }
  }
  pbVar4 = FUN_100020f0(local_113c,(byte *)"_LEVEL");
  if (pbVar4 != (byte *)0x0) {
    uVar5 = FUN_10002480((char *)pbVar4,0);
    FUN_10002370(local_f3c,0xf3c,(byte *)"_LEVEL",uVar5);
    bVar1 = true;
    if (piVar3 != (int *)0x0) {
      piVar3[0xc5] = uVar5;
    }
  }
  pbVar4 = FUN_100020f0(local_113c,&DAT_1004e744);
  if (pbVar4 == (byte *)0x0) {
    if (!bVar1) goto LAB_10037611;
LAB_100375c6:
    if (piVar3 != (int *)0x0) {
      piVar3[1] = piVar3[1] + 1;
      FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar3);
    }
  }
  else {
    FUN_10003680(pbVar4,local_115c,0x10,&DAT_1004f244,0,0x2c);
    uVar5 = FUN_10002480((char *)local_115c,0);
    FUN_10003680(pbVar4,local_115c,0x10,&DAT_1004f244,1,0x2c);
    iVar7 = FUN_10002480((char *)local_115c,0);
    FUN_10003680(pbVar4,local_115c,0x10,&DAT_1004f244,2,0x2c);
    iVar6 = FUN_10002480((char *)local_115c,0);
    uVar5 = (uVar5 & 0xe0) << 1 | iVar7 >> 2 & 0x38U | iVar6 >> 5 & 7U;
    FUN_10002370(local_f3c,0xf3c,&DAT_1004e744,uVar5);
    if (piVar3 != (int *)0x0) {
      piVar3[0xb1] = uVar5;
      goto LAB_100375c6;
    }
  }
  FUN_10022490(*(undefined4 **)(param_1 + 0x19b0),0x2a707574,0,(char *)local_f3c,(char *)0xffffffff)
  ;
LAB_10037611:
  FUN_10010d10(param_2);
  return;
}



void __cdecl FUN_10037630(int param_1,int param_2)

{
  byte *pbVar1;
  int *piVar2;
  byte *pbVar3;
  void *this;
  int iVar4;
  byte *pbVar5;
  byte local_20 [32];
  
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x20;
  pbVar3 = local_20;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  piVar2 = (int *)FUN_10022a40(this,*(int *)(param_1 + 0x1610),local_20);
  if (piVar2 != (int *)0x0) {
    iVar4 = piVar2[0x10c];
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_100535c0);
    iVar4 = FUN_10002480((char *)pbVar3,iVar4);
    pbVar5 = (byte *)0x0;
    piVar2[0x10c] = iVar4;
    iVar4 = 0x14;
    pbVar3 = (byte *)(piVar2 + 0x10d);
    pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6cc);
    FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
    pbVar5 = (byte *)0x0;
    iVar4 = 8;
    pbVar3 = (byte *)(piVar2 + 0x112);
    pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"_CTAG");
    FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
    piVar2[1] = piVar2[1] + 1;
    FUN_100260e0(*(int *)(param_1 + 0x1614),*piVar2);
  }
  FUN_10010d10(param_2);
  return;
}



void __cdecl FUN_10037720(void *param_1,int *param_2)

{
  char cVar1;
  uint *puVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  void *this;
  
  FUN_10023510();
  puVar2 = (uint *)FUN_10026280(*(int *)((int)param_1 + 0x15f8),param_2[0xc]);
  if ((puVar2 != (uint *)0x0) &&
     (puVar2[0x43] = puVar2[0x43] - 1, 0 < *(int *)((int)param_1 + 0x15fc))) {
    FUN_10010db0((int)param_1,0,*puVar2,8,(char *)(param_2 + 8),"has disconnected from server");
  }
  if (param_2[0xe] != 0) {
    FUN_1002d850(param_1,param_2);
  }
  if (param_2[0xd] == 0) {
    FUN_100313f0((int)param_1,param_2);
  }
  else {
    piVar3 = (int *)FUN_10026280(*(int *)((int)param_1 + 0x1728),param_2[0xd]);
    if (piVar3 != (int *)0x0) {
      if (piVar3[0x24] < 0) {
        piVar4 = (int *)&DAT_1004d26f;
      }
      else {
        piVar4 = piVar3 + piVar3[0x24] * 0x1d + 0x90;
      }
      iVar5 = FUN_10025580((char *)piVar4,(char *)(param_2 + 8));
      if (iVar5 == 0) {
        FUN_10031220((int)param_1,piVar3);
      }
      else {
        cVar1 = FUN_10030860((int)piVar3,param_2,(int *)0x0);
        if (cVar1 != '\0') {
          piVar3[0x76] = piVar3[0x76] + 1;
          FUN_100260e0(*(int *)((int)param_1 + 0x1728),*piVar3);
        }
      }
    }
  }
  FUN_10025b80(*(int *)((int)param_1 + 0x173c),*(int **)((int)param_1 + 0x1738),param_2);
  FUN_1002aa70((int)param_1,(byte *)(param_2 + 8));
  FUN_100261a0(*(int *)((int)param_1 + 0x1614),*param_2);
  FUN_10022a90(this,*(int **)((int)param_1 + 0x160c),(byte *)(param_2 + 3));
  FUN_10022a90(*(void **)((int)param_1 + 0x1610),(int *)*(void **)((int)param_1 + 0x1610),
               (byte *)(param_2 + 8));
  _free(param_2);
  return;
}



undefined4 __cdecl FUN_10037870(void *param_1,int param_2)

{
  byte bVar1;
  byte *pbVar2;
  int *piVar3;
  byte *pbVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  int *piVar8;
  undefined4 uVar9;
  void *this;
  void *this_00;
  int iVar10;
  byte *pbVar11;
  uint uVar12;
  uint uVar13;
  int iVar14;
  byte *pbVar15;
  byte local_140 [32];
  byte local_120 [32];
  char local_100 [256];
  
  pbVar11 = &DAT_1004d26f;
  iVar10 = 0x20;
  pbVar4 = local_140;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
  FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
  pbVar11 = &DAT_1004d26f;
  iVar10 = 0x20;
  pbVar4 = local_120;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
  piVar3 = (int *)FUN_10022a40(local_140,*(int *)((int)param_1 + 0x160c),local_140);
  if (piVar3 != (int *)0x0) {
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c0);
    if (pbVar4 == (byte *)0x0) {
      iVar10 = *(int *)(param_2 + 0x70);
      *(undefined4 *)(param_2 + 0x28) = 0;
      if (-1 < iVar10) {
        iVar10 = *(int *)(param_2 + 0x6c);
      }
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(int *)(param_2 + 0x50) = iVar10;
      *(undefined4 *)(param_2 + 0x54) = 0x70736574;
      return 0;
    }
    FUN_10037720(param_1,piVar3);
  }
  uVar5 = FUN_10025120(*(int **)((int)param_1 + 0x1cd8),local_140);
  if ((0 < (int)uVar5) ||
     (uVar5 = FUN_10025120(*(int **)((int)param_1 + 0x1cd8),local_120), 0 < (int)uVar5)) {
    iVar10 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar10) {
      iVar10 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar10;
    *(undefined4 *)(param_2 + 0x54) = 0x66696c74;
    return 0;
  }
  uVar5 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"FLAGS");
  uVar5 = FUN_100025a0((char *)pbVar4,uVar5);
  if ((uVar5 & 0x1000) != 0) {
    iVar10 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar10) {
      iVar10 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar10;
    *(undefined4 *)(param_2 + 0x54) = 0x6c6f636b;
    return 0;
  }
  iVar10 = FUN_100391f0(*(int **)((int)param_1 + 0x1744),(int)param_1,*(byte **)(param_2 + 0x7c));
  if (iVar10 < 0) {
    iVar10 = *(int *)(param_2 + 0x70);
    *(undefined4 *)(param_2 + 0x28) = 0;
    if (-1 < iVar10) {
      iVar10 = *(int *)(param_2 + 0x6c);
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(int *)(param_2 + 0x50) = iVar10;
    *(undefined4 *)(param_2 + 0x54) = 0x63646576;
    return 0;
  }
  uVar5 = 0;
  _sprintf(local_100,"[%s]",local_140);
  pcVar6 = _strstr((char *)((int)param_1 + 0x1dfd),local_100);
  if (pcVar6 != (char *)0x0) {
    uVar5 = 0x2002;
  }
  pcVar6 = _strstr((char *)((int)param_1 + 0x1274ee8),local_100);
  if (pcVar6 != (char *)0x0) {
    uVar5 = uVar5 | 0x2000000;
  }
  uVar12 = 0;
  pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"FLAGS");
  uVar12 = FUN_100025a0((char *)pbVar4,uVar12);
  uVar5 = uVar5 | uVar12 & 0x102000;
  if ((uVar5 & 0x2002) == 0) {
    for (pcVar6 = _strchr((char *)((int)param_1 + 0x21fd),0x5b); pcVar6 != (char *)0x0;
        pcVar6 = _strchr(pcVar6 + 1,0x5b)) {
      pcVar7 = _strchr(pcVar6,0x5d);
      iVar10 = FUN_10005d10(local_120,(byte *)(pcVar6 + 1),(uint)(pcVar7 + (-1 - (int)pcVar6)));
      if (iVar10 == 0) {
        FUN_10010fe0((int)param_1,0x80000,"<FILTER time=%e pers=%s>%s</>");
        iVar10 = *(int *)(param_2 + 0x70);
        *(undefined4 *)(param_2 + 0x28) = 0;
        if (-1 < iVar10) {
          iVar10 = *(int *)(param_2 + 0x6c);
        }
        *(undefined4 *)(param_2 + 0x58) = 0;
        *(int *)(param_2 + 0x50) = iVar10;
        *(undefined4 *)(param_2 + 0x54) = 0x72737276;
        return 0;
      }
    }
  }
  iVar10 = FUN_10022a40(*(void **)((int)param_1 + 0x160c),(int)*(void **)((int)param_1 + 0x160c),
                        local_140);
  if ((iVar10 == 0) &&
     (iVar10 = FUN_10022a40(this,*(int *)((int)param_1 + 0x1610),local_120), iVar10 == 0)) {
    piVar8 = (int *)_malloc(0x474);
    piVar3 = piVar8;
    for (iVar10 = 0x11d; iVar10 != 0; iVar10 = iVar10 + -1) {
      *piVar3 = 0;
      piVar3 = piVar3 + 1;
    }
    pbVar4 = local_140;
    iVar10 = 0xc - (int)pbVar4;
    do {
      bVar1 = *pbVar4;
      pbVar4[(int)piVar8 + iVar10] = bVar1;
      pbVar4 = pbVar4 + 1;
    } while (bVar1 != 0);
    pbVar4 = local_120;
    iVar10 = (int)(piVar8 + 8) - (int)pbVar4;
    pbVar2 = pbVar4;
    do {
      bVar1 = *pbVar4;
      pbVar2 = (byte *)CONCAT31((int3)((uint)pbVar2 >> 8),bVar1);
      pbVar4[iVar10] = bVar1;
      pbVar4 = pbVar4 + 1;
    } while (bVar1 != 0);
    FUN_100229d0(pbVar2,*(int **)((int)param_1 + 0x160c),(byte *)(piVar8 + 3),(int)piVar8);
    FUN_100229d0(this_00,*(int **)((int)param_1 + 0x1610),(byte *)(piVar8 + 8),(int)piVar8);
    iVar10 = FUN_10026030(*(int **)((int)param_1 + 0x1614),0,piVar8);
    *piVar8 = iVar10;
    piVar8[0xc] = 0;
    piVar8[0xb6] = *(int *)(param_2 + 0x14);
    uVar12 = 0;
    piVar8[0xb7] = *(int *)(param_2 + 0x18);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004db60);
    uVar12 = FUN_10002780(pbVar4,uVar12);
    uVar13 = 0;
    piVar8[0xb4] = uVar12;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"LADDR");
    uVar12 = FUN_10002780(pbVar4,uVar13);
    iVar10 = 0;
    piVar8[0xb5] = uVar12;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004db40);
    iVar10 = FUN_10002480((char *)pbVar4,iVar10);
    iVar14 = 0;
    piVar8[0xb8] = iVar10;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e71c);
    iVar10 = FUN_10002480((char *)pbVar4,iVar14);
    piVar8[0xb0] = iVar10;
    uVar12 = 0;
    piVar8[0xb3] = (((int)*(char *)((int)param_1 + 0x1998) << 8 |
                    (int)*(char *)((int)param_1 + 0x1999)) << 8 |
                   (int)*(char *)((int)param_1 + 0x199a)) << 8 |
                   (int)*(char *)((int)param_1 + 0x199b);
    piVar8[2] = uVar5;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6e8);
    uVar5 = FUN_100025a0((char *)pbVar4,uVar12);
    pbVar11 = &DAT_1004d26f;
    piVar8[0xc4] = uVar5;
    iVar10 = 0xc4;
    pbVar4 = (byte *)(piVar8 + 0x34);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e754);
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 0x20;
    pbVar4 = (byte *)(piVar8 + 0xb9);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e700);
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar15 = &DAT_1004d26f;
    iVar10 = 0x40;
    pbVar4 = (byte *)(piVar8 + 0x87);
    pbVar2 = pbVar4;
    pbVar11 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"MADDR");
    FUN_10002a30(pbVar11,pbVar2,iVar10,pbVar15);
    if (*pbVar4 == 0) {
      pbVar11 = &DAT_1004d26f;
      iVar10 = 0x40;
      pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcac);
      FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    }
    iVar10 = 0;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"GFIDS");
    iVar10 = FUN_10002480((char *)pbVar4,iVar10);
    iVar14 = 0;
    piVar8[0xc1] = iVar10;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"HWFLAG");
    iVar10 = FUN_10002480((char *)pbVar4,iVar14);
    iVar14 = 0;
    piVar8[0xc2] = iVar10;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"HWMASK");
    iVar10 = FUN_10002480((char *)pbVar4,iVar14);
    piVar8[0xc3] = iVar10;
    iVar10 = *(int *)((int)param_1 + 0x1274d6c);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e744);
    iVar10 = FUN_10002480((char *)pbVar4,iVar10);
    iVar14 = 0;
    piVar8[0xb1] = iVar10;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"_LEVEL");
    iVar10 = FUN_10002480((char *)pbVar4,iVar14);
    iVar14 = 0;
    piVar8[0xc5] = iVar10;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"MEDALS");
    iVar10 = FUN_10002480((char *)pbVar4,iVar14);
    iVar14 = 0;
    piVar8[0xc6] = iVar10;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e70c);
    iVar10 = FUN_10002480((char *)pbVar4,iVar14);
    pbVar11 = &DAT_1004d26f;
    iVar14 = 0x24;
    pbVar4 = (byte *)(piVar8 + 0x97);
    piVar8[0x10c] = iVar10;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6d4);
    FUN_10002a30(pbVar2,pbVar4,iVar14,pbVar11);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 0x14;
    pbVar4 = (byte *)(piVar8 + 0x10d);
    piVar8[0x86] = 0x202000;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"_CLUBID");
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 8;
    pbVar4 = (byte *)(piVar8 + 0x112);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"_CLUBTAG");
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 0x20;
    pbVar4 = (byte *)(piVar8 + 0x102);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcb8);
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 0x20;
    pbVar4 = (byte *)(piVar8 + 0xfa);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dcb0);
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 8;
    pbVar4 = (byte *)(piVar8 + 0xf8);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dca8);
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 0x40;
    pbVar4 = (byte *)(piVar8 + 0xa0);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6f0);
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    uVar5 = 0;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dca4);
    uVar5 = FUN_10002930(pbVar4,uVar5);
    pbVar11 = &DAT_1004d26f;
    iVar10 = 0x20;
    pbVar4 = (byte *)(piVar8 + 0x114);
    piVar8[0x10a] = uVar5;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10050ebc);
    FUN_10002a30(pbVar2,pbVar4,iVar10,pbVar11);
    piVar8[0x11c] = *(int *)((int)param_1 + 0x127513c) + *(int *)((int)param_1 + 0x1994);
    FUN_10015a20();
    piVar8[1] = piVar8[1] + 1;
    piVar8[199] = 0;
    piVar8[200] = 0;
    piVar8[0xc9] = 0;
    piVar8[0xca] = 0;
    FUN_1003a700(*(undefined4 *)(*(int *)((int)param_1 + 0x1740) + 0x10c),(int)piVar8);
    piVar8[0xb2] = piVar8[0xb1];
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8c8);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8c8,pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004d8d8,pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6b4);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e6b4,pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"PLAST");
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"PLAST",pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"SINCE");
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"SINCE",pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"PSINCE");
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"PSINCE",pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10050ebc);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050ebc,pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e754);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e754,pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e70c);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e70c,pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dca4);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004dca4,pbVar4);
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_10050fe0);
    FUN_10003c50(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_10050fe0,pbVar4);
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_100535ec,
                 (byte *)(piVar8 + 0x87));
    FUN_100025e0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_100535e8,piVar8[0xb4]);
    FUN_100025e0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_100535e4,piVar8[0xb5]);
    uVar5 = 0;
    pbVar4 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"SDKVERS");
    uVar5 = FUN_10002930(pbVar4,uVar5);
    *(uint *)((int)param_1 + 0x1274e9c) = uVar5;
    FUN_10005d70((char *)((int)param_1 + 0x1274ea0),(char *)(piVar8 + 0xf8),8);
    FUN_10005d70((char *)((int)param_1 + 0x1274ea8),(char *)(piVar8 + 0xfa),0x20);
    FUN_10005d70((char *)((int)param_1 + 0x1274ec8),(char *)(piVar8 + 0x102),0x20);
    uVar9 = FUN_10010d10(param_2);
    return uVar9;
  }
  iVar10 = *(int *)(param_2 + 0x70);
  *(undefined4 *)(param_2 + 0x28) = 0;
  if (-1 < iVar10) {
    iVar10 = *(int *)(param_2 + 0x6c);
  }
  *(undefined4 *)(param_2 + 0x58) = 0;
  *(int *)(param_2 + 0x50) = iVar10;
  *(undefined4 *)(param_2 + 0x54) = 0x6c6f676e;
  return 0;
}



undefined4 * FUN_10038510(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0x3d5a4);
  puVar3 = puVar1;
  for (iVar2 = 0xf569; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar1[0x30] = 0x7f000000;
  return puVar1;
}



void __cdecl FUN_10038540(void *param_1)

{
  if (param_1 != (void *)0x0) {
    _free(param_1);
    return;
  }
  return;
}



void __cdecl FUN_10038560(int param_1)

{
  uint uVar1;
  
  uVar1 = *(int *)(param_1 + 0xc0) + 1;
  *(uint *)(param_1 + 0xc0) = uVar1;
  if (0x7fffffff < uVar1) {
    *(undefined4 *)(param_1 + 0xc0) = 0x7f000000;
  }
  return;
}



int __cdecl FUN_10038590(int param_1)

{
  int iVar1;
  char *pcVar2;
  
  iVar1 = 0;
  pcVar2 = (char *)(param_1 + 4);
  do {
    if (*pcVar2 == '\0') {
      iVar1 = param_1 + iVar1 * 0x18;
      *(undefined1 *)(iVar1 + 4) = 1;
      *(undefined4 *)(iVar1 + 8) = 0;
      return iVar1;
    }
    iVar1 = iVar1 + 1;
    pcVar2 = pcVar2 + 0x18;
  } while (iVar1 < 8);
  return 0;
}



void __cdecl FUN_100385d0(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = 0;
  iVar2 = param_1;
  do {
    if (iVar2 == param_2) {
      iVar2 = param_1 + iVar1 * 0x18;
      *(undefined1 *)(iVar2 + 4) = 0;
      *(undefined4 *)(iVar2 + 8) = 0;
      *(undefined4 *)(iVar2 + 0x10) = 0;
      return;
    }
    iVar1 = iVar1 + 1;
    iVar2 = iVar2 + 0x18;
  } while (iVar1 < 8);
  return;
}



int * __cdecl FUN_10038610(int param_1)

{
  int *piVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  
  iVar5 = 0;
  pcVar3 = (char *)(param_1 + 200);
  do {
    if (*pcVar3 == '\0') {
      iVar2 = iVar5 * 0x7a9c + param_1;
      piVar1 = (int *)(iVar2 + 0xc4);
      piVar6 = piVar1;
      for (iVar4 = 0x1ea7; iVar4 != 0; iVar4 = iVar4 + -1) {
        *piVar6 = 0;
        piVar6 = piVar6 + 1;
      }
      *(undefined4 *)(iVar2 + 0xd0) = 0;
      *(undefined1 *)(iVar2 + 200) = 1;
      *piVar1 = iVar5;
      return piVar1;
    }
    iVar5 = iVar5 + 1;
    pcVar3 = pcVar3 + 0x7a9c;
  } while (iVar5 < 8);
  return (int *)0x0;
}



void __cdecl FUN_10038670(int param_1,int param_2)

{
  if (param_2 == param_1 + 0xc4) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  if (param_2 == param_1 + 0x7b60) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  if (param_2 == param_1 + 0xf5fc) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  if (param_2 == param_1 + 0x17098) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  if (param_2 == param_1 + 0x1eb34) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  if (param_2 == param_1 + 0x265d0) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  if (param_2 == param_1 + 0x2e06c) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  if (param_2 == param_1 + 0x35b08) {
    *(undefined1 *)(param_2 + 4) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
    *(undefined4 *)(param_2 + 0x7a94) = 0;
  }
  return;
}



int __cdecl FUN_10038730(int param_1,char *param_2)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  
  iVar3 = 0;
  pcVar2 = (char *)(param_1 + 0xd8);
  do {
    if (pcVar2[-0x10] != '\0') {
      iVar5 = 0;
      pcVar4 = pcVar2;
      do {
        if (*pcVar4 == '\0') break;
        iVar1 = FUN_10025580(pcVar4,param_2);
        if (iVar1 == 0) {
          return param_1 + 0xc4 + iVar3 * 0x7a9c;
        }
        iVar5 = iVar5 + 1;
        pcVar4 = pcVar4 + 0x10;
      } while (iVar5 < 8);
    }
    iVar3 = iVar3 + 1;
    pcVar2 = pcVar2 + 0x7a9c;
    if (7 < iVar3) {
      return 0;
    }
  } while( true );
}



undefined4 __cdecl
FUN_100387a0(int param_1,int *param_2,int param_3,undefined4 param_4,int param_5,char *param_6)

{
  char cVar1;
  uint in_EAX;
  uint uVar2;
  int *piVar3;
  undefined4 *puVar4;
  code *pcVar5;
  int iVar6;
  int iVar7;
  char *pcVar8;
  
  iVar6 = -param_3;
  uVar2 = in_EAX & 0xffffff00;
  if ((0x7effffff < iVar6) && (param_3 == -0x7fffffff || iVar6 < 0x7fffffff)) {
    iVar7 = 0;
    piVar3 = (int *)(param_1 + 8);
    while (*piVar3 != iVar6) {
      iVar7 = iVar7 + 1;
      piVar3 = piVar3 + 6;
      if (7 < iVar7) {
        return CONCAT31((int3)((uint)piVar3 >> 8),1);
      }
    }
    puVar4 = FUN_10028690(param_2,param_5 + 1);
    piVar3 = (int *)(param_1 + iVar7 * 0x18);
    *piVar3 = (int)puVar4;
    pcVar8 = (char *)puVar4[3];
    do {
      cVar1 = *param_6;
      param_6 = param_6 + 1;
      *pcVar8 = cVar1;
      pcVar8 = pcVar8 + 1;
    } while (cVar1 != '\0');
    *(int *)*piVar3 = param_3;
    *(undefined4 *)(*piVar3 + 4) = param_4;
    pcVar5 = (code *)piVar3[4];
    if (pcVar5 != (code *)0x0) {
      pcVar5 = (code *)(*pcVar5)(piVar3);
    }
    uVar2 = CONCAT31((int3)((uint)pcVar5 >> 8),1);
  }
  return uVar2;
}



void __cdecl
FUN_10038830(int param_1,undefined4 param_2,int param_3,undefined4 param_4,byte *param_5)

{
  code *pcVar1;
  byte *pbVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar4 = -1;
  pbVar2 = FUN_100020f0(param_5,(byte *)"BSLOT");
  iVar4 = FUN_10002480((char *)pbVar2,iVar4);
  iVar5 = -1;
  pbVar2 = FUN_100020f0(param_5,&DAT_10053740);
  iVar5 = FUN_10002480((char *)pbVar2,iVar5);
  FUN_10003a20(param_5,(byte *)"BSLOT");
  FUN_10003a20(param_5,&DAT_10053740);
  if (((-1 < iVar4) && (iVar4 < 8)) &&
     (iVar3 = iVar4 * 0x7a9c, *(char *)(iVar3 + 200 + param_1) != '\0')) {
    if (((-1 < iVar5) && (iVar5 < 8)) &&
       (*(int *)(param_1 + 0x158 + (iVar4 * 0x1ea7 + iVar5) * 4) = param_3, param_3 == 0)) {
      FUN_10005d70((char *)(iVar5 * 0xf3c + iVar3 + 0x178 + param_1),(char *)param_5,0xf3c);
    }
    iVar4 = *(int *)(iVar3 + 0xd0 + param_1) + 1;
    *(int *)(iVar3 + 0xd0 + param_1) = iVar4;
    if ((iVar4 == *(int *)(iVar3 + 0xcc + param_1)) &&
       (pcVar1 = *(code **)(iVar3 + 0x7b58 + param_1), pcVar1 != (code *)0x0)) {
      (*pcVar1)(iVar3 + 0xc4 + param_1);
    }
  }
  return;
}



byte * __thiscall FUN_10038930(void *this,byte *param_1,char *param_2)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  
  pbVar1 = (byte *)FUN_10022a40(this,*(int *)((int)this + 0xc0),param_1);
  if (pbVar1 == (byte *)0x0) {
    pbVar1 = (byte *)operator_new(0xf7e);
    if (pbVar1 == (byte *)0x0) {
      pbVar1 = (byte *)0x0;
    }
    else {
      pbVar3 = pbVar1;
      for (iVar2 = 0x3df; iVar2 != 0; iVar2 = iVar2 + -1) {
        pbVar3[0] = 0;
        pbVar3[1] = 0;
        pbVar3[2] = 0;
        pbVar3[3] = 0;
        pbVar3 = pbVar3 + 4;
      }
      pbVar3[0] = 0;
      pbVar3[1] = 0;
    }
    FUN_10005d70((char *)pbVar1,(char *)param_1,0x40);
    pbVar1[0xf7c] = 1;
    FUN_100229d0(*(void **)((int)this + 0xc0),(int *)*(void **)((int)this + 0xc0),pbVar1,(int)pbVar1
                );
  }
  pbVar1[0xf7d] = 0;
  FUN_10005d70((char *)(pbVar1 + 0x40),param_2,0xf3c);
  return pbVar1;
}



char * __thiscall FUN_100389c0(void *this,char *param_1,char *param_2)

{
  undefined4 *puVar1;
  
  FUN_10005d70((char *)this,param_1,0x80);
  FUN_10005d70((char *)((int)this + 0x80),param_2,0x40);
  puVar1 = FUN_10022cd0(100,1000);
  *(undefined4 **)((int)this + 0xc0) = puVar1;
  return (char *)this;
}



void __fastcall FUN_10038a10(int param_1)

{
  void *_Memory;
  
  _Memory = (void *)FUN_10022920(*(int **)(param_1 + 0xc0));
  while (_Memory != (void *)0x0) {
    _free(_Memory);
    _Memory = (void *)FUN_10022920(*(int **)(param_1 + 0xc0));
  }
  FUN_10022830(*(void **)(param_1 + 0xc0));
  return;
}



int __thiscall FUN_10038a50(void *this,byte *param_1)

{
  int iVar1;
  
  iVar1 = FUN_10022a40(*(void **)((int)this + 0xc0),(int)*(void **)((int)this + 0xc0),param_1);
  if ((iVar1 != 0) && (*(char *)(iVar1 + 0xf7d) == '\0')) {
    return iVar1 + 0x40;
  }
  return 0;
}



byte * __thiscall thunk_FUN_10038930(void *this,byte *param_1,char *param_2)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  
  pbVar1 = (byte *)FUN_10022a40(this,*(int *)((int)this + 0xc0),param_1);
  if (pbVar1 == (byte *)0x0) {
    pbVar1 = (byte *)operator_new(0xf7e);
    if (pbVar1 == (byte *)0x0) {
      pbVar1 = (byte *)0x0;
    }
    else {
      pbVar3 = pbVar1;
      for (iVar2 = 0x3df; iVar2 != 0; iVar2 = iVar2 + -1) {
        pbVar3[0] = 0;
        pbVar3[1] = 0;
        pbVar3[2] = 0;
        pbVar3[3] = 0;
        pbVar3 = pbVar3 + 4;
      }
      pbVar3[0] = 0;
      pbVar3[1] = 0;
    }
    FUN_10005d70((char *)pbVar1,(char *)param_1,0x40);
    pbVar1[0xf7c] = 1;
    FUN_100229d0(*(void **)((int)this + 0xc0),(int *)*(void **)((int)this + 0xc0),pbVar1,(int)pbVar1
                );
  }
  pbVar1[0xf7d] = 0;
  FUN_10005d70((char *)(pbVar1 + 0x40),param_2,0xf3c);
  return pbVar1;
}



void __thiscall FUN_10038a90(void *this,byte *param_1)

{
  int iVar1;
  
  iVar1 = FUN_10022a40(*(void **)((int)this + 0xc0),(int)*(void **)((int)this + 0xc0),param_1);
  if (iVar1 != 0) {
    *(undefined1 *)(iVar1 + 0xf7c) = 1;
  }
  return;
}



void __fastcall FUN_10038ac0(int param_1)

{
  FUN_10022c50(*(int *)(param_1 + 0xc0));
  return;
}



undefined4 __thiscall
FUN_10038ad0(void *this,undefined4 *param_1,undefined1 *param_2,char *param_3,size_t param_4)

{
  byte *pbVar1;
  byte *_Memory;
  int iVar2;
  void *this_00;
  
  _Memory = (byte *)FUN_10022c60(*(int *)((int)this + 0xc0),(undefined4 *)0x0);
  while( true ) {
    if (_Memory == (byte *)0x0) {
      return 0;
    }
    if (_Memory[0xf7d] != 0) break;
    if (_Memory[0xf7c] != 0) {
      pbVar1 = _Memory + 0x40;
      _Memory[0xf7c] = 0;
      FUN_10002370(pbVar1,0xf3c,&DAT_1004e75c,1);
      FUN_10003cf0(pbVar1,0xf3c,&DAT_1004df18,(byte *)this);
      FUN_10003cf0(pbVar1,0xf3c,&DAT_1004dff4,(byte *)((int)this + 0x80));
      FUN_10003cf0(pbVar1,0xf3c,(byte *)"SUBKEY",_Memory);
      *param_1 = pbVar1;
      *param_2 = 0;
      *param_3 = '\0';
      return CONCAT31((int3)((uint)param_3 >> 8),1);
    }
    _Memory = (byte *)FUN_10022c60(*(int *)((int)this + 0xc0),(undefined4 *)0x0);
  }
  *param_1 = 0;
  *param_2 = 1;
  FUN_10005d70(param_3,(char *)_Memory,param_4);
  iVar2 = FUN_10022a90(this_00,*(int **)((int)this + 0xc0),_Memory);
  _free(_Memory);
  return CONCAT31((int3)((uint)iVar2 >> 8),1);
}



void __thiscall FUN_10038be0(void *this,int param_1)

{
  if (param_1 == 0) {
    *(undefined4 *)((int)this + 200) = 300000;
    return;
  }
  *(int *)((int)this + 200) = param_1;
  return;
}



void FUN_10038c00(void)

{
  int in_EAX;
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  int unaff_EBX;
  
  if (*(void **)(unaff_EBX + 0x130) != (void *)0x0) {
    _free(*(void **)(unaff_EBX + 0x130));
    *(undefined4 *)(unaff_EBX + 0x130) = 0;
    *(undefined4 *)(unaff_EBX + 0x124) = 0;
  }
  *(int *)(unaff_EBX + 0x124) = 0;
  *(undefined4 *)(unaff_EBX + 0x128) = 0;
  *(undefined4 *)(unaff_EBX + 300) = 0;
  *(undefined4 *)(unaff_EBX + 0x130) = 0;
  puVar1 = (undefined4 *)_malloc(in_EAX * 0x84);
  *(int *)(unaff_EBX + 0x124) = in_EAX;
  *(undefined4 **)(unaff_EBX + 0x130) = puVar1;
  for (uVar2 = (uint)(in_EAX * 0x84) >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar1 = 0;
    puVar1 = puVar1 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar1 = 0;
    puVar1 = (undefined4 *)((int)puVar1 + 1);
  }
  return;
}



undefined4 __cdecl FUN_10038c70(int param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  byte *pbVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  bool bVar11;
  int local_98;
  int *local_94;
  undefined4 local_90 [35];
  
  local_98 = 0;
  if (0 < *(int *)(param_1 + 4)) {
    local_94 = *(int **)(param_1 + 0xc);
    pbVar3 = (byte *)(local_94 + 1);
    pbVar7 = param_2;
    pbVar2 = pbVar3;
LAB_10038ca5:
    do {
      bVar1 = *pbVar3;
      bVar11 = bVar1 < *pbVar7;
      if (bVar1 == *pbVar7) {
        if (bVar1 != 0) {
          bVar1 = pbVar3[1];
          bVar11 = bVar1 < pbVar7[1];
          if (bVar1 != pbVar7[1]) goto LAB_10038cc9;
          pbVar3 = pbVar3 + 2;
          pbVar7 = pbVar7 + 2;
          if (bVar1 != 0) goto LAB_10038ca5;
        }
        iVar4 = 0;
      }
      else {
LAB_10038cc9:
        iVar4 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      }
      if (iVar4 == 0) {
        *local_94 = *local_94 + 1;
        if (local_98 < 1) {
          return 0;
        }
        iVar4 = local_98 * 0x84;
        do {
          if (*(uint *)(*(int *)(param_1 + 0xc) + iVar4) <=
              *(uint *)(*(int *)(param_1 + 0xc) + -0x84 + iVar4)) {
            return 0;
          }
          puVar6 = (undefined4 *)(*(int *)(param_1 + 0xc) + iVar4);
          puVar9 = puVar6 + -0x21;
          puVar8 = puVar9;
          puVar10 = local_90;
          for (iVar5 = 0x21; iVar5 != 0; iVar5 = iVar5 + -1) {
            *puVar10 = *puVar8;
            puVar8 = puVar8 + 1;
            puVar10 = puVar10 + 1;
          }
          for (iVar5 = 0x21; iVar5 != 0; iVar5 = iVar5 + -1) {
            *puVar9 = *puVar6;
            puVar6 = puVar6 + 1;
            puVar9 = puVar9 + 1;
          }
          puVar9 = local_90;
          puVar6 = (undefined4 *)(*(int *)(param_1 + 0xc) + iVar4);
          for (iVar5 = 0x21; iVar5 != 0; iVar5 = iVar5 + -1) {
            *puVar6 = *puVar9;
            puVar9 = puVar9 + 1;
            puVar6 = puVar6 + 1;
          }
          local_98 = local_98 + -1;
          iVar4 = iVar4 + -0x84;
        } while (0 < local_98);
        return 0;
      }
      local_98 = local_98 + 1;
      local_94 = local_94 + 0x21;
      pbVar3 = pbVar2 + 0x84;
      pbVar7 = param_2;
      pbVar2 = pbVar3;
    } while (local_98 < *(int *)(param_1 + 4));
  }
  return 0xffffffff;
}



void __cdecl FUN_10038d80(char *param_1)

{
  char *pcVar1;
  uint uVar2;
  uint *in_EAX;
  int iVar3;
  undefined4 *puVar4;
  char *pcVar5;
  
  uVar2 = in_EAX[1];
  if (uVar2 < *in_EAX) {
    puVar4 = (undefined4 *)(uVar2 * 0x84 + in_EAX[3]);
    in_EAX[1] = uVar2 + 1;
    pcVar1 = (char *)(puVar4 + 1);
    pcVar5 = pcVar1;
    for (iVar3 = 0x20; iVar3 != 0; iVar3 = iVar3 + -1) {
      pcVar5[0] = '\0';
      pcVar5[1] = '\0';
      pcVar5[2] = '\0';
      pcVar5[3] = '\0';
      pcVar5 = pcVar5 + 4;
    }
    FUN_10005d70(pcVar1,param_1,0x80);
    *puVar4 = 1;
    return;
  }
  in_EAX[2] = in_EAX[2] + 1;
  return;
}



char FUN_10038dd0(void)

{
  byte *in_EAX;
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  bool bVar4;
  byte local_200 [512];
  
  if (in_EAX == (byte *)0x0) {
    return '\x01';
  }
  FUN_10002a30(in_EAX,local_200,0x200,&DAT_1004d26f);
  iVar1 = 8;
  bVar4 = true;
  pbVar2 = local_200;
  pbVar3 = (byte *)"$WATCH$";
  do {
    if (iVar1 == 0) break;
    iVar1 = iVar1 + -1;
    bVar4 = *pbVar2 == *pbVar3;
    pbVar2 = pbVar2 + 1;
    pbVar3 = pbVar3 + 1;
  } while (bVar4);
  if (bVar4) {
    return '\x02';
  }
  iVar1 = 0xc;
  bVar4 = true;
  pbVar2 = local_200;
  pbVar3 = (byte *)"$AUTOWATCH$";
  do {
    if (iVar1 == 0) break;
    iVar1 = iVar1 + -1;
    bVar4 = *pbVar2 == *pbVar3;
    pbVar2 = pbVar2 + 1;
    pbVar3 = pbVar3 + 1;
  } while (bVar4);
  if (bVar4) {
    return '\x04';
  }
  bVar4 = true;
  iVar1 = 7;
  pbVar2 = local_200;
  pbVar3 = (byte *)"$AUTO$";
  do {
    if (iVar1 == 0) break;
    iVar1 = iVar1 + -1;
    bVar4 = *pbVar2 == *pbVar3;
    pbVar2 = pbVar2 + 1;
    pbVar3 = pbVar3 + 1;
  } while (bVar4);
  return bVar4 * '\x02' + '\x03';
}



undefined4 __cdecl FUN_10038e70(int param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  int unaff_EDI;
  bool bVar4;
  
  *(undefined4 *)(param_1 + 0x18) = 0;
  if (((*(uint *)(param_1 + 0x10) <= *(uint *)(param_1 + 4)) && (*(int *)(unaff_EDI + 4) != 0)) &&
     (*(uint *)(param_1 + 0x14) <=
      (uint)(**(int **)(unaff_EDI + 0xc) * 100) / *(uint *)(param_1 + 4))) {
    *(undefined4 *)(param_1 + 0x18) = 1;
    pbVar2 = (byte *)(*(int *)(unaff_EDI + 0xc) + 4);
    do {
      bVar1 = *pbVar2;
      bVar4 = bVar1 < *param_2;
      if (bVar1 != *param_2) {
LAB_10038ed8:
        iVar3 = (1 - (uint)bVar4) - (uint)(bVar4 != 0);
        goto LAB_10038edd;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar2[1];
      bVar4 = bVar1 < param_2[1];
      if (bVar1 != param_2[1]) goto LAB_10038ed8;
      pbVar2 = pbVar2 + 2;
      param_2 = param_2 + 2;
    } while (bVar1 != 0);
    iVar3 = 0;
LAB_10038edd:
    if (iVar3 != 0) {
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
      return 0xffffffff;
    }
  }
  return 0;
}



undefined4 FUN_10038ef0(void)

{
  char *in_EAX;
  int iVar1;
  char *pcVar2;
  char *unaff_EDI;
  
  if (in_EAX != (char *)0x0) {
    do {
      iVar1 = _strncmp(in_EAX,unaff_EDI,0x20);
      if (iVar1 == 0) {
        return 0;
      }
      pcVar2 = _strchr(in_EAX,0x2c);
    } while ((pcVar2 != (char *)0x0) && (in_EAX = pcVar2 + 1, in_EAX != (char *)0x0));
  }
  return 0xffffffff;
}



int FUN_10038f30(void)

{
  int iVar1;
  int unaff_ESI;
  
  iVar1 = FUN_10038ef0();
  if (iVar1 == 0) {
    *(int *)(unaff_ESI + 0xc) = *(int *)(unaff_ESI + 0xc) + 1;
  }
  if ((*(uint *)(unaff_ESI + 0x10) <= *(uint *)(unaff_ESI + 4)) &&
     (*(uint *)(unaff_ESI + 0x14) <=
      (uint)(*(int *)(unaff_ESI + 0xc) * 100) / *(uint *)(unaff_ESI + 4))) {
    *(undefined4 *)(unaff_ESI + 0x18) = 1;
    if (iVar1 != 0) {
      *(int *)(unaff_ESI + 8) = *(int *)(unaff_ESI + 8) + 1;
    }
    return iVar1;
  }
  *(undefined4 *)(unaff_ESI + 0x18) = 0;
  return 0;
}



undefined4 * FUN_10038f80(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0x134);
  puVar3 = puVar1;
  for (iVar2 = 0x4d; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  return puVar1;
}



void __cdecl FUN_10038fa0(undefined4 *param_1,byte *param_2)

{
  byte bVar1;
  char cVar2;
  byte *pbVar3;
  byte *pbVar4;
  undefined3 extraout_var;
  undefined4 *puVar5;
  bool bVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  byte *pbVar10;
  byte local_100 [128];
  byte local_80 [128];
  
  iVar8 = 10;
  pbVar3 = FUN_100020f0(param_2,(byte *)"CHEAT_MAXLOGENT");
  iVar8 = FUN_10002480((char *)pbVar3,iVar8);
  iVar9 = 0;
  pbVar3 = FUN_100020f0(param_2,(byte *)"CHEAT_RESET");
  iVar9 = FUN_10002480((char *)pbVar3,iVar9);
  pbVar10 = &DAT_1004d26f;
  iVar7 = 0x80;
  pbVar3 = local_80;
  pbVar4 = FUN_100020f0(param_2,(byte *)"CHEAT_PAT");
  FUN_10002a30(pbVar4,pbVar3,iVar7,pbVar10);
  pbVar10 = &DAT_1004d26f;
  iVar7 = 0x80;
  pbVar3 = local_100;
  pbVar4 = FUN_100020f0(param_2,(byte *)"CHEAT_HIT");
  FUN_10002a30(pbVar4,pbVar3,iVar7,pbVar10);
  if (param_1[0x49] == iVar8) {
    pbVar4 = local_80;
    pbVar3 = (byte *)(param_1 + 9);
    do {
      bVar1 = *pbVar3;
      bVar6 = bVar1 < *pbVar4;
      if (bVar1 != *pbVar4) {
LAB_10039077:
        iVar7 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_1003907c;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar6 = bVar1 < pbVar4[1];
      if (bVar1 != pbVar4[1]) goto LAB_10039077;
      pbVar3 = pbVar3 + 2;
      pbVar4 = pbVar4 + 2;
    } while (bVar1 != 0);
    iVar7 = 0;
LAB_1003907c:
    if (iVar7 == 0) {
      pbVar4 = local_100;
      pbVar3 = (byte *)(param_1 + 0x29);
      do {
        bVar1 = *pbVar3;
        bVar6 = bVar1 < *pbVar4;
        if (bVar1 != *pbVar4) {
LAB_100390b4:
          iVar7 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
          goto LAB_100390b9;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar3[1];
        bVar6 = bVar1 < pbVar4[1];
        if (bVar1 != pbVar4[1]) goto LAB_100390b4;
        pbVar3 = pbVar3 + 2;
        pbVar4 = pbVar4 + 2;
      } while (bVar1 != 0);
      iVar7 = 0;
LAB_100390b9:
      if ((iVar7 == 0) && (iVar9 != 1)) goto LAB_1003912a;
    }
  }
  puVar5 = param_1;
  for (iVar9 = 0x4d; iVar9 != 0; iVar9 = iVar9 + -1) {
    *puVar5 = 0;
    puVar5 = puVar5 + 1;
  }
  pbVar3 = local_80;
  param_1[0x49] = iVar8;
  iVar8 = 0x24 - (int)pbVar3;
  do {
    bVar1 = *pbVar3;
    pbVar3[(int)param_1 + iVar8] = bVar1;
    pbVar3 = pbVar3 + 1;
  } while (bVar1 != 0);
  pbVar3 = local_100;
  iVar8 = 0xa4 - (int)pbVar3;
  do {
    bVar1 = *pbVar3;
    pbVar3[(int)param_1 + iVar8] = bVar1;
    pbVar3 = pbVar3 + 1;
  } while (bVar1 != 0);
  cVar2 = FUN_10038dd0();
  *param_1 = CONCAT31(extraout_var,cVar2);
  FUN_10038c00();
LAB_1003912a:
  iVar8 = 0;
  pbVar3 = FUN_100020f0(param_2,(byte *)"CHEAT_FORCELOGGING");
  iVar8 = FUN_10002480((char *)pbVar3,iVar8);
  iVar9 = 0;
  param_1[8] = iVar8;
  pbVar3 = FUN_100020f0(param_2,(byte *)"CHEAT_DIAGNOSTIC");
  iVar8 = FUN_10002480((char *)pbVar3,iVar9);
  iVar9 = 100;
  param_1[7] = iVar8;
  pbVar3 = FUN_100020f0(param_2,(byte *)"CHEAT_ENABLECT");
  iVar8 = FUN_10002480((char *)pbVar3,iVar9);
  iVar9 = 0x5f;
  param_1[4] = iVar8;
  pbVar3 = FUN_100020f0(param_2,(byte *)"CHEAT_THRESHOLDPCT");
  iVar8 = FUN_10002480((char *)pbVar3,iVar9);
  param_1[5] = iVar8;
  return;
}



void __cdecl FUN_100391b0(void *param_1)

{
  if (*(void **)((int)param_1 + 0x130) != (void *)0x0) {
    _free(*(void **)((int)param_1 + 0x130));
    *(undefined4 *)((int)param_1 + 0x130) = 0;
    *(undefined4 *)((int)param_1 + 0x124) = 0;
  }
  _free(param_1);
  return;
}



int __cdecl FUN_100391f0(int *param_1,int param_2,byte *param_3)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  char *pcVar4;
  int iVar5;
  bool bVar6;
  int iVar7;
  byte *pbVar8;
  int local_388;
  byte local_380 [32];
  byte local_360 [32];
  byte local_340 [32];
  byte local_320 [128];
  byte local_2a0 [32];
  byte local_280 [128];
  byte local_200 [512];
  
  iVar5 = 0;
  if (*param_1 == 1) {
    param_1[6] = 0;
    return 0;
  }
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x20;
  pbVar3 = local_2a0;
  pbVar2 = FUN_100020f0(param_3,&DAT_1004d8d8);
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar8);
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x20;
  pbVar3 = local_360;
  pbVar2 = FUN_100020f0(param_3,&DAT_1004dcb8);
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar8);
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x20;
  pbVar3 = local_340;
  pbVar2 = FUN_100020f0(param_3,&DAT_1004dcb0);
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar8);
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x20;
  pbVar3 = local_380;
  pbVar2 = FUN_100020f0(param_3,&DAT_10050da4);
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar8);
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x200;
  pbVar3 = local_200;
  pbVar2 = FUN_100020f0(param_3,&DAT_10050f38);
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar8);
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x80;
  pbVar3 = local_280;
  pbVar2 = FUN_100020f0(param_3,&DAT_10050cb8);
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar8);
  pbVar8 = &DAT_1004d26f;
  iVar7 = 0x80;
  pbVar3 = local_320;
  pbVar2 = FUN_100020f0(param_3,&DAT_10050f30);
  FUN_10002a30(pbVar2,pbVar3,iVar7,pbVar8);
  iVar7 = 7;
  bVar6 = true;
  pbVar3 = local_360;
  pbVar2 = (byte *)"FLM/A1";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar6 = *pbVar3 == *pbVar2;
    pbVar3 = pbVar3 + 1;
    pbVar2 = pbVar2 + 1;
  } while (bVar6);
  if (bVar6) {
    pbVar3 = local_320;
    do {
      bVar1 = *pbVar3;
      pbVar3 = pbVar3 + 1;
    } while (bVar1 != 0);
    if (pbVar3 == local_320 + 1) {
      return 0;
    }
  }
  pbVar3 = (byte *)_strstr((char *)local_380,"EACN");
  if (pbVar3 == local_380) {
    return 0;
  }
  param_1[1] = param_1[1] + 1;
  iVar7 = FUN_10038c70((int)(param_1 + 0x49),local_320);
  if (iVar7 < 0) {
    FUN_10038d80((char *)local_320);
  }
  iVar7 = *param_1;
  if (iVar7 == 2) {
    iVar5 = 0;
    param_1[6] = 0;
  }
  else {
    if (iVar7 == 4) {
      local_388 = FUN_10038e70((int)param_1,local_320);
      iVar5 = 0;
      param_1[6] = 0;
    }
    else if (iVar7 == 5) {
      iVar5 = FUN_10038e70((int)param_1,local_320);
      local_388 = iVar5;
    }
    else {
      if (iVar7 != 3) goto LAB_1003941e;
      iVar5 = FUN_10038f30();
      local_388 = iVar5;
    }
    if (local_388 != 0) goto LAB_10039424;
  }
LAB_1003941e:
  if (param_1[8] != 1) {
    return iVar5;
  }
LAB_10039424:
  pcVar4 = _strchr((char *)local_280,0x20);
  if (pcVar4 != (char *)0x0) {
    *pcVar4 = '\0';
  }
  FUN_10010fe0(param_2,0x80000,
               "<NOTICE time=%e user=%s vers=%s, slus=%s, cpat=%s, chit=%s, cdev=%s>%s</>");
  return iVar5;
}



void __cdecl FUN_100394a0(int *param_1,char *param_2,size_t param_3)

{
  float fVar1;
  float fVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  char *_Format;
  char local_800 [2048];
  
  iVar3 = _sprintf(local_800,"\n\nCheat Device Statistics\n\n");
  pcVar6 = local_800 + iVar3;
  iVar3 = _sprintf(pcVar6,"Mode: %s\n",(&PTR_s_Unknown_100573f4)[*param_1]);
  pcVar6 = pcVar6 + iVar3;
  iVar3 = _sprintf(pcVar6,"Status: %s\n\n");
  iVar4 = _sprintf(pcVar6 + iVar3,"Total Logins: %d\n",param_1[1]);
  pcVar6 = pcVar6 + iVar3 + iVar4;
  iVar3 = *param_1;
  if (iVar3 == 5) {
LAB_10039521:
    if (iVar3 == 4) goto LAB_10039526;
    _Format = "Total Rejections: %d\n";
  }
  else {
    if (iVar3 != 4) {
      if (iVar3 != 3) goto LAB_1003958c;
      goto LAB_10039521;
    }
LAB_10039526:
    _Format = "Potential Rejections: %d\n";
  }
  iVar3 = _sprintf(pcVar6,_Format);
  pcVar6 = pcVar6 + iVar3;
  iVar3 = param_1[1];
  if (iVar3 != 0) {
    fVar1 = (float)param_1[2];
    if (param_1[2] < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    fVar2 = (float)iVar3;
    if (iVar3 < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    iVar3 = _sprintf(pcVar6,"Rejection Percentage: %2.1f%%\n",(double)((fVar1 * 100.0) / fVar2));
    pcVar6 = pcVar6 + iVar3;
  }
LAB_1003958c:
  if ((*param_1 == 5) || (*param_1 == 4)) {
    iVar3 = *(int *)param_1[0x4c];
  }
  else {
    iVar3 = param_1[3];
  }
  if (param_1[0x4a] == 0) {
    iVar3 = _sprintf(pcVar6,"ThresholdPct: %d%%\n");
  }
  else {
    fVar1 = (float)iVar3;
    if (iVar3 < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    fVar2 = (float)param_1[1];
    if (param_1[1] < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    iVar3 = _sprintf(pcVar6,"ThresholdPct: %d%% (%2.1f%%)\n",param_1[5],
                     (double)((fVar1 * 100.0) / fVar2));
  }
  pcVar6 = pcVar6 + iVar3;
  iVar3 = _sprintf(pcVar6,"EnableCt: %d\n");
  pcVar6 = pcVar6 + iVar3;
  iVar3 = _sprintf(pcVar6,"\nPattern: %s\n",param_1 + 9);
  iVar4 = _sprintf(pcVar6 + iVar3,"\nCheat Response Log (max entries=%d)\n",param_1[0x49]);
  pcVar6 = pcVar6 + iVar3 + iVar4;
  uVar5 = 0;
  if (param_1[0x49] != 0) {
    iVar3 = 0;
    do {
      if (uVar5 < (uint)param_1[0x4a]) {
        iVar4 = _sprintf(pcVar6,"   %d) Count: %d  MD5: %s\n",uVar5,
                         *(undefined4 *)(param_1[0x4c] + iVar3),param_1[0x4c] + iVar3 + 4);
      }
      else {
        iVar4 = _sprintf(pcVar6,"   %d) Empty\n",uVar5);
      }
      pcVar6 = pcVar6 + iVar4;
      uVar5 = uVar5 + 1;
      iVar3 = iVar3 + 0x84;
    } while (uVar5 < (uint)param_1[0x49]);
  }
  iVar3 = _sprintf(pcVar6,"\n   %d discards\n");
  _sprintf(pcVar6 + iVar3,"\n(output=%d bytes)\n",(int)(pcVar6 + iVar3) - (int)local_800);
  FUN_10005d70(param_2,local_800,param_3);
  return;
}



undefined4 __cdecl FUN_100396f0(int param_1)

{
  return *(undefined4 *)(param_1 + 0x1c);
}



void __cdecl FUN_10039770(undefined4 param_1,int param_2,int param_3)

{
  uint uVar1;
  uint *puVar2;
  
  puVar2 = (uint *)(param_2 * 0x50 + *(int *)(param_3 + 0x1c));
  *puVar2 = *(uint *)(param_2 * 0x50 + *(int *)(param_3 + 0x1c)) | 2;
  if ((code *)puVar2[0xd] != (code *)0x0) {
    (*(code *)puVar2[0xd])(puVar2,puVar2[0xe],puVar2[0xf]);
  }
  if (puVar2[9] != 0) {
    uVar1 = FUN_100230b0(*(void **)(param_3 + 0x50),puVar2[9],FUN_10039770,param_2,param_3);
    puVar2[10] = uVar1;
    return;
  }
  puVar2[10] = 0;
  return;
}



void FUN_100397d0(void *param_1)

{
  int iVar1;
  
  for (iVar1 = *(int *)((int)param_1 + 0x24); iVar1 != 0; iVar1 = *(int *)(iVar1 + 0x4c)) {
    closesocket(*(SOCKET *)(iVar1 + 0x40));
  }
  if (*(SOCKET *)((int)param_1 + 0x2c) != 0xffffffff) {
    closesocket(*(SOCKET *)((int)param_1 + 0x2c));
  }
  FUN_10022830(*(void **)((int)param_1 + 0x28));
  _free(*(void **)((int)param_1 + 0x14));
  _free(*(void **)((int)param_1 + 0x1c));
  _free(param_1);
                    // WARNING: Could not recover jumptable at 0x10039823. Too many branches
                    // WARNING: Treating indirect jump as call
  WSACleanup();
  return;
}



uint __cdecl FUN_10039830(uint *param_1,int param_2)

{
  u_short uVar1;
  u_long uVar2;
  sockaddr local_10;
  
  if (param_2 == 0x73696d75) {
    return *param_1;
  }
  if (param_2 == 0x72786275) {
    return param_1[3] - 4;
  }
  if (param_2 == 0x70657269) {
    return param_1[6];
  }
  if (param_2 == 0x64656c79) {
    return param_1[1];
  }
  if (param_2 == 0x706f7274) {
    param_2 = 0x10;
    getsockname(param_1[0xb],&local_10,&param_2);
    uVar1 = ntohs(local_10.sa_data._0_2_);
    return (uint)uVar1;
  }
  if (param_2 == 0x61646472) {
    param_2 = 0x10;
    getsockname(param_1[0xb],&local_10,&param_2);
    uVar2 = ntohl(CONCAT22(local_10.sa_data._4_2_,local_10.sa_data._2_2_));
    return uVar2;
  }
  return 0;
}



uint __cdecl FUN_10039900(int *param_1,int param_2,uint param_3)

{
  uint *puVar1;
  
  if ((param_2 < *param_1) &&
     (puVar1 = (uint *)(param_2 * 0x50 + param_1[7]), puVar1[0x10] != 0xffffffff)) {
    return -(uint)((*puVar1 & param_3) != 0) & (uint)puVar1;
  }
  return 0;
}



void __cdecl FUN_10039930(int *param_1,int param_2)

{
  SOCKET s;
  
  if ((-1 < param_2) && (param_2 < *param_1)) {
    s = *(SOCKET *)(param_1[7] + 0x40 + param_2 * 0x50);
    if (s != 0xffffffff) {
      shutdown(s,2);
    }
    *(undefined4 *)(param_2 * 0x50 + param_1[7]) = 0x10;
  }
  return;
}



void __cdecl FUN_10039970(int *param_1,int param_2)

{
  SOCKET s;
  int *piVar1;
  int iVar2;
  int iVar3;
  
  if ((-1 < param_2) && (param_2 < *param_1)) {
    s = *(SOCKET *)(param_2 * 0x50 + 0x40 + param_1[7]);
    iVar3 = param_2 * 0x50 + param_1[7];
    if (s != 0xffffffff) {
      shutdown(s,2);
      closesocket(*(SOCKET *)(iVar3 + 0x40));
      *(undefined4 *)(iVar3 + 0x40) = 0xffffffff;
      (**(code **)(*(int *)param_1[0x14] + 8))(*(undefined4 *)(iVar3 + 0x44));
      if (*(int *)(iVar3 + 0x28) != 0) {
        FUN_100230e0((void *)param_1[0x14],*(int *)(iVar3 + 0x28));
        *(undefined4 *)(iVar3 + 0x28) = 0;
      }
      if (0 < param_1[6]) {
        iVar2 = FUN_10022bb0(param_1[10],*(int *)(iVar3 + 0x18));
        if (iVar2 + -1 == 0) {
          FUN_10022bf0((int *)param_1[10],*(int *)(iVar3 + 0x18));
        }
        else {
          FUN_10022b70(param_1[10],*(int *)(iVar3 + 0x18),iVar2 + -1);
        }
      }
      if (iVar3 == param_1[9]) {
        param_1[9] = *(int *)(iVar3 + 0x4c);
      }
      if (*(int *)(iVar3 + 0x4c) != 0) {
        *(undefined4 *)(*(int *)(iVar3 + 0x4c) + 0x48) = *(undefined4 *)(iVar3 + 0x48);
      }
      if (*(int *)(iVar3 + 0x48) != 0) {
        *(undefined4 *)(*(int *)(iVar3 + 0x48) + 0x4c) = *(undefined4 *)(iVar3 + 0x4c);
      }
      *(undefined4 *)(iVar3 + 0x48) = 0;
      *(int *)(iVar3 + 0x4c) = param_1[8];
      if (param_1[8] != 0) {
        *(int *)(param_1[8] + 0x48) = iVar3;
      }
      piVar1 = (int *)param_1[0x14];
      param_1[8] = iVar3;
      if ((piVar1[10] != piVar1[0xe] && -1 < piVar1[10] - piVar1[0xe]) &&
         (iVar3 = (**(code **)(*piVar1 + 0x10))(param_1[0xc]), iVar3 == 0)) {
        (**(code **)(*(int *)param_1[0x14] + 0xc))(param_1[0xc],1);
        FUN_10016450(8);
      }
    }
  }
  return;
}



undefined4 __cdecl FUN_10039aa0(int *param_1,int param_2,int param_3,int param_4)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  
  if ((param_2 < 0) || (*param_1 <= param_2)) {
    return 0xffffffff;
  }
  if ((-1 < param_3) && (param_3 <= param_1[3] + -4)) {
    iVar5 = param_2 * 0x50;
    puVar6 = (uint *)(param_1[7] + iVar5);
    if (param_4 == 0) {
      uVar4 = puVar6[3] + param_3;
      puVar6[3] = uVar4;
    }
    else {
      uVar4 = param_3 + puVar6[3];
      puVar6[2] = puVar6[3];
      puVar6[3] = uVar4;
    }
    uVar1 = puVar6[4];
    uVar2 = puVar6[2];
    if ((int)uVar2 < (int)uVar1) {
      if ((param_1[3] < (int)uVar4) || (param_1[4] < (int)uVar2)) {
        _memmove((void *)puVar6[5],(void *)((int)puVar6[5] + uVar2),uVar1 - uVar2);
        puVar6[3] = puVar6[3] - puVar6[2];
        puVar6[4] = puVar6[4] - puVar6[2];
        puVar6[2] = 0;
      }
      if ((0 < (int)puVar6[3]) && ((int)puVar6[3] <= (int)puVar6[4])) {
        *puVar6 = *puVar6 | 4;
      }
    }
    else if (0 < (int)uVar2) {
      puVar6[3] = uVar4 - uVar2;
      puVar6[4] = uVar1 - puVar6[2];
      puVar6[2] = 0;
    }
    if ((*puVar6 & 4) == 0) {
      iVar3 = *(int *)param_1[0x14];
      uVar4 = (**(code **)(*(int *)param_1[0x14] + 0x10))
                        (*(undefined4 *)(param_1[7] + 0x44 + iVar5));
      (**(code **)(iVar3 + 0xc))(*(undefined4 *)(param_1[7] + 0x44 + iVar5),uVar4 | 1);
    }
    return 0;
  }
  return 0xfffffffe;
}



int __cdecl FUN_10039bb0(int *param_1,int param_2,char *param_3,int param_4)

{
  SOCKET s;
  int iVar1;
  int iVar2;
  
  if ((param_2 < 0) || (*param_1 <= param_2)) {
    return -1;
  }
  iVar2 = param_2 * 0x50;
  s = *(SOCKET *)(param_1[7] + 0x40 + iVar2);
  if (s != 0xffffffff) {
    iVar1 = send(s,param_3,param_4,0);
    if (-1 < iVar1) {
      return iVar1;
    }
    iVar1 = WSAGetLastError();
    if (((iVar1 == 0) || (iVar1 == 0x2733)) || (iVar1 == 0x2747)) {
      return 0;
    }
    *(uint *)(param_1[7] + iVar2) = *(uint *)(param_1[7] + iVar2) | 0x10;
  }
  return -1;
}



undefined4 __cdecl FUN_10039c20(int *param_1,int param_2)

{
  int iVar1;
  
  if (((-1 < param_2) && (param_2 < *param_1)) &&
     (iVar1 = param_2 * 0x50 + param_1[7], *(int *)(iVar1 + 0x40) != -1)) {
    return *(undefined4 *)(iVar1 + 0x18);
  }
  return 0;
}



undefined2 __cdecl FUN_10039c50(int *param_1,int param_2)

{
  int iVar1;
  
  if (((-1 < param_2) && (param_2 < *param_1)) &&
     (iVar1 = param_2 * 0x50 + param_1[7], *(int *)(iVar1 + 0x40) != -1)) {
    return *(undefined2 *)(iVar1 + 0x1c);
  }
  return 0;
}



u_long __cdecl FUN_10039c80(int *param_1,int param_2)

{
  SOCKET s;
  int iVar1;
  u_long uVar2;
  sockaddr local_10;
  
  if (((-1 < param_2) && (param_2 < *param_1)) &&
     (s = *(SOCKET *)(param_2 * 0x50 + 0x40 + param_1[7]), s != 0xffffffff)) {
    local_10.sa_family = 0;
    local_10.sa_data[0] = '\0';
    local_10.sa_data[1] = '\0';
    local_10.sa_data[2] = '\0';
    local_10.sa_data[3] = '\0';
    local_10.sa_data[4] = '\0';
    local_10.sa_data[5] = '\0';
    local_10.sa_data[6] = '\0';
    local_10.sa_data[7] = '\0';
    local_10.sa_data[8] = '\0';
    local_10.sa_data[9] = '\0';
    local_10.sa_data[10] = '\0';
    local_10.sa_data[0xb] = '\0';
    local_10.sa_data[0xc] = '\0';
    local_10.sa_data[0xd] = '\0';
    param_2 = 0x10;
    iVar1 = getsockname(s,&local_10,&param_2);
    if (iVar1 == 0) {
      uVar2 = ntohl(local_10.sa_data._2_4_);
      return uVar2;
    }
  }
  return 0;
}



void __cdecl FUN_10039cf0(int param_1)

{
  undefined1 uVar1;
  char cVar2;
  
  uVar1 = *(undefined1 *)(param_1 + 0x40);
  *(byte *)(param_1 + 0x40) = *(byte *)(param_1 + 0x3d) ^ *(byte *)(param_1 + 0x4c);
  *(undefined1 *)(param_1 + 0x3d) = uVar1;
  uVar1 = *(undefined1 *)(param_1 + 0x47);
  *(byte *)(param_1 + 0x47) =
       (byte)((uint)*(undefined4 *)(param_1 + 0x4c) >> 8) ^ *(byte *)(param_1 + 0x42);
  *(undefined1 *)(param_1 + 0x42) = uVar1;
  uVar1 = *(undefined1 *)(param_1 + 0x49);
  *(char *)(param_1 + 0x49) = *(char *)(param_1 + 0x45) + -1;
  cVar2 = *(char *)(param_1 + 0x4b);
  *(undefined1 *)(param_1 + 0x45) = uVar1;
  *(undefined1 *)(param_1 + 0x4b) = *(undefined1 *)(param_1 + 0x3e);
  *(char *)(param_1 + 0x3e) = cVar2 + '\x01';
  return;
}



void __cdecl FUN_10039d40(int param_1)

{
  int iVar1;
  
  if (DAT_10068ce8 == 0 && DAT_10068cec == 0) {
    iVar1 = *(int *)(*(int *)(param_1 + 0x50) + 8);
    DAT_10068ce8 = iVar1 + -1;
    DAT_10068cec = *(int *)(*(int *)(param_1 + 0x50) + 0xc) + -1 + (uint)(iVar1 != 0);
  }
  *(int *)(param_1 + 0x4c) = *(int *)(*(int *)(param_1 + 0x50) + 8) - DAT_10068ce8;
  return;
}



void __cdecl FUN_10039d80(int param_1,int param_2,undefined4 param_3)

{
  undefined4 uVar1;
  int iVar2;
  
  iVar2 = param_2 * 0x50 + *(int *)(param_1 + 0x1c);
  *(undefined4 *)(iVar2 + 0x24) = param_3;
  if (*(int *)(iVar2 + 0x28) != 0) {
    FUN_100230e0(*(void **)(param_1 + 0x50),*(int *)(iVar2 + 0x28));
    *(undefined4 *)(iVar2 + 0x28) = 0;
  }
  if (*(uint *)(iVar2 + 0x24) != 0) {
    uVar1 = FUN_100230b0(*(void **)(param_1 + 0x50),*(uint *)(iVar2 + 0x24),FUN_10039770,param_2,
                         param_1);
    *(undefined4 *)(iVar2 + 0x28) = uVar1;
  }
  return;
}



void __cdecl FUN_10039ef0(undefined4 param_1,SOCKET param_2,undefined4 param_3,u_long param_4)

{
  undefined4 *puVar1;
  u_long uVar2;
  u_short uVar3;
  SOCKET s;
  u_long uVar4;
  int iVar5;
  undefined4 uVar6;
  int iVar7;
  undefined2 uVar8;
  undefined2 uVar9;
  char acStack_18 [8];
  sockaddr local_10;
  
  uVar2 = param_4;
  puVar1 = *(undefined4 **)(param_4 + 0x20);
  iVar7 = 0;
  if (puVar1 == (undefined4 *)0x0) {
    FUN_10016450(8);
    (**(code **)(**(int **)(uVar2 + 0x50) + 0xc))(*(undefined4 *)(uVar2 + 0x30),0);
    return;
  }
  param_4 = 0x10;
  s = accept(param_2,&local_10,(int *)&param_4);
  if (s != 0xffffffff) {
    if (local_10.sa_data._2_4_ == 0) {
LAB_10039fa3:
      closesocket(s);
      return;
    }
    if (0 < *(int *)(uVar2 + 0x18)) {
      uVar4 = ntohl(local_10.sa_data._2_4_);
      iVar7 = FUN_10022bb0(*(int *)(uVar2 + 0x28),uVar4);
      if (*(int *)(uVar2 + 0x18) < iVar7) {
        acStack_18[0] = '\x01';
        acStack_18[1] = '\0';
        acStack_18[2] = '\0';
        acStack_18[3] = '\0';
        acStack_18[4] = '\0';
        acStack_18[5] = '\0';
        acStack_18[6] = '\0';
        acStack_18[7] = '\0';
        setsockopt(s,0xffff,0x80,acStack_18,8);
        goto LAB_10039fa3;
      }
    }
    param_4 = 1;
    ioctlsocket(s,-0x7ffb9982,&param_4);
    uVar8 = (undefined2)puVar1[1];
    uVar9 = (undefined2)((uint)puVar1[1] >> 0x10);
    uVar3 = 0x1003;
    iVar5 = (**(code **)(**(int **)(uVar2 + 0x50) + 4))
                      (s,&LAB_10039de0,&LAB_10039700,&LAB_10039730,0x9730,uVar8,uVar2);
    if (iVar5 == -1) {
      closesocket(s);
      FUN_10016450(8);
      (**(code **)(**(int **)(uVar2 + 0x50) + 0xc))(*(undefined4 *)(uVar2 + 0x30),0);
      return;
    }
    puVar1[0x11] = iVar5;
    (**(code **)(**(int **)(uVar2 + 0x50) + 0xc))(iVar5,1);
    uVar6 = FUN_10039d40(uVar2);
    puVar1[8] = uVar6;
    uVar4 = ntohl(CONCAT22(uVar9,uVar8));
    puVar1[6] = uVar4;
    uVar3 = ntohs(uVar3);
    *(u_short *)(puVar1 + 7) = uVar3;
    puVar1[2] = 0;
    puVar1[4] = 0;
    puVar1[3] = 0;
    puVar1[9] = 0;
    if (0 < *(int *)(uVar2 + 0x18)) {
      iVar5 = FUN_10022b70(*(int *)(uVar2 + 0x28),puVar1[6],iVar7 + 1);
      if (iVar5 == 0) {
        FUN_10022b00(*(int **)(uVar2 + 0x28),puVar1[6],iVar7 + 1);
      }
    }
    *puVar1 = 0;
    puVar1[0x10] = s;
    if (*(int *)(uVar2 + 0x24) != 0) {
      *(undefined4 **)(*(int *)(uVar2 + 0x24) + 0x48) = puVar1;
    }
    iVar7 = *(int *)(*(int *)(uVar2 + 0x20) + 0x4c);
    *(int *)(uVar2 + 0x20) = iVar7;
    if (iVar7 != 0) {
      *(undefined4 *)(iVar7 + 0x48) = 0;
    }
    puVar1[0x13] = *(undefined4 *)(uVar2 + 0x24);
    puVar1[0x12] = 0;
    *(undefined4 **)(uVar2 + 0x24) = puVar1;
    (**(code **)(uVar2 + 0x54))(puVar1,*(undefined4 *)(uVar2 + 0x58));
  }
  return;
}



int * __cdecl
FUN_1003a0d0(int *param_1,int param_2,undefined2 param_3,int param_4,int param_5,int param_6,
            int param_7)

{
  int iVar1;
  u_short uVar2;
  int iVar3;
  int *_Memory;
  undefined4 *puVar4;
  SOCKET SVar5;
  uint uVar6;
  int *piVar7;
  int unaff_retaddr;
  u_long uStack_1a4;
  sockaddr sStack_1a0;
  WSADATA local_190;
  
  iVar3 = WSAStartup(2,&local_190);
  if (iVar3 == 0) {
    if ((char)local_190.wVersion == '\x02') {
      if (param_1[10] <= param_4) {
        param_4 = param_1[10] + -1;
      }
      _Memory = (int *)_malloc(0x5c);
      piVar7 = _Memory;
      for (iVar3 = 0x17; iVar3 != 0; iVar3 = iVar3 + -1) {
        *piVar7 = 0;
        piVar7 = piVar7 + 1;
      }
      _Memory[0x14] = (int)param_1;
      _Memory[6] = param_6;
      puVar4 = FUN_10022cd0(10,1000);
      _Memory[10] = (int)puVar4;
      *_Memory = param_4;
      _Memory[3] = param_5 + 4;
      if (0x1fff < param_5) {
        param_5 = param_5 + -0x1000;
      }
      _Memory[4] = param_5;
      _Memory[1] = param_7;
      _Memory[2] = 0x32;
      puVar4 = (undefined4 *)_malloc(param_4 * 0x50);
      _Memory[7] = (int)puVar4;
      for (uVar6 = (uint)(*_Memory * 0x50) >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      }
      for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
        *(undefined1 *)puVar4 = 0;
        puVar4 = (undefined4 *)((int)puVar4 + 1);
      }
      uStack_1a4 = 0;
      if (0 < *_Memory) {
        do {
          if (uStack_1a4 != 0) {
            iVar3 = uStack_1a4 * 0x50 + _Memory[7];
            *(int *)(iVar3 + 0x48) = iVar3 + -0x50;
          }
          if (uStack_1a4 != param_4 - 1U) {
            iVar3 = uStack_1a4 * 0x50 + _Memory[7];
            *(int *)(iVar3 + 0x4c) = iVar3 + 0x50;
          }
          uStack_1a4 = uStack_1a4 + 1;
        } while ((int)uStack_1a4 < *_Memory);
      }
      _Memory[8] = _Memory[7];
      _Memory[9] = 0;
      puVar4 = (undefined4 *)_malloc(_Memory[3] * *_Memory);
      iVar3 = _Memory[3];
      iVar1 = *_Memory;
      _Memory[5] = (int)puVar4;
      for (uVar6 = (uint)(iVar3 * iVar1) >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      }
      for (uVar6 = iVar3 * iVar1 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
        *(undefined1 *)puVar4 = 0;
        puVar4 = (undefined4 *)((int)puVar4 + 1);
      }
      uStack_1a4 = 0;
      if (0 < *_Memory) {
        do {
          iVar3 = uStack_1a4 * 0x50 + _Memory[7];
          *(undefined4 *)(iVar3 + 0x40) = 0xffffffff;
          *(u_long *)(iVar3 + 4) = uStack_1a4;
          *(u_long *)(iVar3 + 0x14) = _Memory[3] * uStack_1a4 + _Memory[5];
          uStack_1a4 = uStack_1a4 + 1;
        } while ((int)uStack_1a4 < *_Memory);
      }
      _Memory[0xd] = param_2;
      *(undefined2 *)(_Memory + 0xe) = param_3;
      _Memory[0xb] = -1;
      SVar5 = socket(2,1,0);
      _Memory[0xb] = SVar5;
      if (SVar5 != 0xffffffff) {
        uStack_1a4 = 1;
        ioctlsocket(_Memory[0xb],-0x7ffb9982,&uStack_1a4);
        uStack_1a4 = 1;
        setsockopt(_Memory[0xb],0xffff,4,(char *)&uStack_1a4,4);
        sStack_1a0.sa_data[2] = '\0';
        sStack_1a0.sa_data[3] = '\0';
        sStack_1a0.sa_data[4] = '\0';
        sStack_1a0.sa_data[5] = '\0';
        sStack_1a0.sa_data[6] = '\0';
        sStack_1a0.sa_data[7] = '\0';
        sStack_1a0.sa_data[8] = '\0';
        sStack_1a0.sa_data[9] = '\0';
        sStack_1a0.sa_data[10] = '\0';
        sStack_1a0.sa_data[0xb] = '\0';
        sStack_1a0.sa_data[0xc] = '\0';
        sStack_1a0.sa_data[0xd] = '\0';
        sStack_1a0.sa_family = 2;
        sStack_1a0.sa_data[0] = '\0';
        sStack_1a0.sa_data[1] = '\0';
        uVar2 = htons(*(u_short *)(_Memory + 0xe));
        sStack_1a0.sa_data._0_2_ = uVar2;
        sStack_1a0.sa_data._2_4_ = htonl(_Memory[0xd]);
        iVar3 = bind(_Memory[0xb],&sStack_1a0,0x10);
        if ((-1 < iVar3) && (iVar3 = listen(_Memory[0xb],0x19), -1 < iVar3)) {
          iVar3 = (**(code **)(*param_1 + 4))
                            (_Memory[0xb],FUN_10039ef0,0,FUN_10023510,FUN_10023510,0);
          _Memory[0xc] = iVar3;
          (**(code **)(*param_1 + 0xc))(iVar3,1);
          _Memory[0x15] = (int)local_190.lpVendorInfo;
          iVar3 = DAT_10068ce8;
          _Memory[0x16] = unaff_retaddr;
          if (iVar3 == 0 && DAT_10068cec == 0) {
            iVar1 = *(int *)(_Memory[0x14] + 8);
            iVar3 = iVar1 + -1;
            DAT_10068cec = *(int *)(_Memory[0x14] + 0xc) + -1 + (uint)(iVar1 != 0);
            DAT_10068ce8 = iVar3;
          }
          _Memory[0x13] = *(int *)(_Memory[0x14] + 8) - iVar3;
          return _Memory;
        }
      }
      _free(_Memory);
      return (int *)0x0;
    }
    WSACleanup();
  }
  return (int *)0x0;
}



undefined4 * __thiscall FUN_1003a3d0(void *this,int param_1,int param_2)

{
  FUN_10023100(this,param_1,param_2);
  *(undefined4 *)((int)this + 0x48) = 0;
  *(undefined4 *)((int)this + 0x404c) = 0;
  *(undefined4 *)((int)this + 0x8050) = 0;
  *(undefined ***)this = &PTR_FUN_10053abc;
  return (undefined4 *)this;
}



void __fastcall FUN_1003a410(undefined4 *param_1)

{
  *param_1 = &PTR_FUN_10053abc;
  FUN_10022d80(param_1);
  return;
}



undefined4 __thiscall FUN_1003a420(void *this,DWORD param_1)

{
  fd_set *readfds;
  fd_set *writefds;
  uint *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  uint uVar4;
  int iVar5;
  code *pcVar6;
  uint uVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  int local_c;
  timeval local_8;
  
  local_c = 0;
  if (*(int *)((int)this + 0x38) == 0) {
    if (param_1 == 0) {
      param_1 = 500;
    }
    Sleep(param_1);
    piVar3 = (int *)FUN_10022d60((int)this);
  }
  else {
    iVar5 = *(int *)((int)this + 0x34);
    readfds = (fd_set *)((int)this + 0x48);
    writefds = (fd_set *)((int)this + 0x404c);
    readfds->fd_count = 0;
    writefds->fd_count = 0;
    *(undefined4 *)((int)this + 0x8050) = 0;
    for (; iVar5 != 0; iVar5 = *(int *)(iVar5 + 0x34)) {
      if ((*(byte *)(iVar5 + 8) & 1) != 0) {
        uVar7 = readfds->fd_count;
        uVar4 = 0;
        if (uVar7 != 0) {
          piVar3 = (int *)((int)this + 0x4c);
          do {
            if (*piVar3 == *(int *)(iVar5 + 4)) break;
            uVar4 = uVar4 + 1;
            piVar3 = piVar3 + 1;
          } while (uVar4 < readfds->fd_count);
        }
        if ((uVar4 == uVar7) && (uVar7 < 0x1000)) {
          *(undefined4 *)((int)this + uVar4 * 4 + 0x4c) = *(undefined4 *)(iVar5 + 4);
          readfds->fd_count = readfds->fd_count + 1;
        }
      }
      if ((*(byte *)(iVar5 + 8) & 2) != 0) {
        uVar7 = writefds->fd_count;
        uVar4 = 0;
        if (uVar7 != 0) {
          piVar3 = (int *)((int)this + 0x4050);
          do {
            if (*piVar3 == *(int *)(iVar5 + 4)) break;
            uVar4 = uVar4 + 1;
            piVar3 = piVar3 + 1;
          } while (uVar4 < writefds->fd_count);
        }
        if ((uVar4 == uVar7) && (uVar7 < 0x1000)) {
          *(undefined4 *)((int)this + uVar4 * 4 + 0x4050) = *(undefined4 *)(iVar5 + 4);
          writefds->fd_count = writefds->fd_count + 1;
        }
      }
      uVar7 = *(uint *)((int)this + 0x8050);
      puVar1 = (uint *)((int)this + 0x8050);
      uVar4 = 0;
      if (uVar7 != 0) {
        piVar3 = (int *)((int)this + 0x8054);
        do {
          if (*piVar3 == *(int *)(iVar5 + 4)) break;
          uVar4 = uVar4 + 1;
          piVar3 = piVar3 + 1;
        } while (uVar4 < *puVar1);
      }
      if ((uVar4 == uVar7) && (uVar7 < 0x1000)) {
        *(undefined4 *)((int)this + uVar4 * 4 + 0x8054) = *(undefined4 *)(iVar5 + 4);
        *puVar1 = *puVar1 + 1;
      }
      if (local_c < *(int *)(iVar5 + 4)) {
        local_c = *(int *)(iVar5 + 4);
      }
    }
    local_8.tv_sec = param_1 / 1000;
    local_8.tv_usec = (param_1 % 1000) * 1000;
    iVar5 = select(local_c + 1,readfds,writefds,(fd_set *)((int)this + 0x8050),&local_8);
    piVar3 = (int *)FUN_10022d60((int)this);
    if (iVar5 < 1) {
      if ((iVar5 < 0) && (piVar3 = FUN_10041d35(), *piVar3 != 4)) {
        piVar3 = FUN_10041d35();
        _strerror((char *)*piVar3);
        uVar7 = FUN_10016450(8);
        return uVar7 & 0xffffff00;
      }
    }
    else {
      puVar8 = *(undefined4 **)((int)this + 0x34);
      if (*(undefined4 **)((int)this + 0x34) != (undefined4 *)0x0) {
        do {
          puVar2 = (undefined4 *)puVar8[0xd];
          iVar5 = __WSAFDIsSet(puVar8[1],(fd_set *)((int)this + 0x8050));
          if (iVar5 == 0) {
            iVar5 = __WSAFDIsSet(puVar8[1],readfds);
            if (iVar5 == 0) {
              pcVar6 = (code *)__WSAFDIsSet(puVar8[1],writefds);
              if ((pcVar6 != (code *)0x0) && (pcVar6 = (code *)puVar8[9], pcVar6 != (code *)0x0)) {
                uVar12 = puVar8[7];
                uVar11 = puVar8[6];
                uVar10 = puVar8[1];
                uVar9 = *puVar8;
                goto LAB_1003a63d;
              }
            }
            else {
              pcVar6 = (code *)puVar8[8];
              if (pcVar6 != (code *)0x0) {
                uVar12 = puVar8[7];
                uVar11 = puVar8[6];
                uVar10 = puVar8[1];
                uVar9 = *puVar8;
LAB_1003a63d:
                pcVar6 = (code *)(*pcVar6)(uVar9,uVar10,uVar11,uVar12);
              }
            }
          }
          else {
            pcVar6 = (code *)puVar8[0xb];
            if (pcVar6 != (code *)0x0) {
              uVar12 = puVar8[7];
              uVar11 = puVar8[6];
              uVar10 = puVar8[1];
              uVar9 = *puVar8;
              goto LAB_1003a63d;
            }
          }
          puVar8 = puVar2;
          if (puVar2 == (undefined4 *)0x0) {
            return CONCAT31((int3)((uint)pcVar6 >> 8),1);
          }
        } while( true );
      }
    }
  }
  return CONCAT31((int3)((uint)piVar3 >> 8),1);
}



undefined4 * __thiscall FUN_1003a6a0(void *this,byte param_1)

{
  FUN_1003a410((undefined4 *)this);
  if ((param_1 & 1) != 0) {
    _free(this);
  }
  return (undefined4 *)this;
}



void __cdecl FUN_1003a700(undefined4 param_1,int param_2)

{
  *(uint *)(param_2 + 0x218) = *(uint *)(param_2 + 0x218) | 0x80000;
  return;
}



void * FUN_1003a710(undefined4 param_1,char *param_2,size_t *param_3)

{
  FILE *_File;
  size_t _Count;
  void *_DstBuf;
  size_t sVar1;
  
  if ((param_2 == (char *)0x0) || (*param_2 == '\0')) {
    return (void *)0x0;
  }
  if (param_3 != (size_t *)0x0) {
    *param_3 = 0xffffffff;
  }
  _File = (FILE *)FUN_100409a9(param_2,"rb");
  if (_File == (FILE *)0x0) {
    return (void *)0x0;
  }
  _fseek(_File,0,2);
  _Count = _ftell(_File);
  _fseek(_File,0,0);
  _DstBuf = _malloc(_Count + 1);
  if (_DstBuf == (void *)0x0) {
    _fclose(_File);
    return (void *)0x0;
  }
  sVar1 = _fread(_DstBuf,1,_Count,_File);
  if (sVar1 != _Count) {
    _fclose(_File);
    _free(_DstBuf);
    return (void *)0x0;
  }
  *(undefined1 *)((int)_DstBuf + _Count) = 0;
  _fclose(_File);
  if (param_3 != (size_t *)0x0) {
    *param_3 = _Count;
  }
  return _DstBuf;
}



void __cdecl FUN_1003a7d0(undefined4 param_1,void *param_2)

{
  if (param_2 != (void *)0x0) {
    _free(param_2);
  }
  return;
}



void __cdecl FUN_1003ab30(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  void *this;
  void *this_00;
  int iVar6;
  byte *pbVar7;
  uint uVar8;
  byte local_3c [12];
  byte local_30 [16];
  byte local_20 [32];
  
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x10;
  pbVar2 = local_30;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0xc;
  pbVar2 = local_3c;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e040);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x20;
  pbVar2 = local_20;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e700);
  FUN_10002a30(pbVar1,pbVar2,iVar6,pbVar7);
  uVar8 = 0x656e5553;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dca4);
  uVar8 = FUN_10002930(pbVar2,uVar8);
  if (local_3c[0] != 0) {
    if (local_30[0] == 0) {
      *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    }
    else {
      iVar6 = FUN_10022a40(this,*(int *)(param_1 + 0x4364),local_3c);
      if (iVar6 != 0) {
        if ((local_20[0] == 0) &&
           (iVar6 = FUN_10022a40(this_00,*(int *)(param_1 + 0x40f8),local_30), iVar6 != 0)) {
          FUN_10005d70((char *)local_20,(char *)(iVar6 + 0x2e4),0x20);
        }
        FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"PERS=%s UID=%s"
                    );
        iVar6 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
        *(int *)(param_3 + 0xaac) = iVar6;
        FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar6,*(char **)(param_2 + 0x60)
                     ,(char *)0xffffffff);
        FUN_1001ab10(param_2,&LAB_1003a7e0);
        return;
      }
      *(undefined4 *)(param_2 + 0x54) = 0x75766977;
    }
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    return;
  }
  iVar6 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"EXTERNAL");
  iVar3 = FUN_10002480((char *)pbVar2,iVar6);
  FUN_1000ada0(param_2);
  iVar6 = 0;
  FUN_10022c50(*(int *)(param_1 + 0x4364));
  iVar4 = FUN_10022c60(*(int *)(param_1 + 0x4364),(undefined4 *)0x0);
  while (iVar4 != 0) {
    if (*(char *)(iVar4 + 0x213f4) == '\0') {
      iVar6 = iVar6 + 1;
    }
    iVar4 = FUN_10022c60(*(int *)(param_1 + 0x4364),(undefined4 *)0x0);
  }
  if (iVar3 == 0) {
    FUN_10017110(*(char **)(param_2 + 0x60),"count",iVar6);
  }
  else {
    iVar4 = FUN_10022980(*(undefined4 **)(param_1 + 0x4364));
    FUN_10017110(*(char **)(param_2 + 0x60),"count",iVar4 - iVar6);
  }
  FUN_10022c50(*(int *)(param_1 + 0x4364));
  puVar5 = (undefined4 *)FUN_10022c60(*(int *)(param_1 + 0x4364),(undefined4 *)0x0);
  do {
    if (puVar5 == (undefined4 *)0x0) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x54) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      return;
    }
    if (iVar3 == 0) {
      if (*(char *)(puVar5 + 0x84fd) == '\0') goto LAB_1003accf;
    }
    else if (*(char *)(puVar5 + 0x84fd) != '\0') {
LAB_1003accf:
      FUN_10016c00(*(char **)(param_2 + 0x60),&DAT_10053e34);
      FUN_10017110(*(char **)(param_2 + 0x60),"index",*puVar5);
      pbVar2 = FUN_10017ca0(*(int **)(param_1 + 0x2ccca4),(byte *)(puVar5 + 1),uVar8);
      FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e08,pbVar2);
      pbVar2 = FUN_10017ca0(*(int **)(param_1 + 0x2ccca4),(byte *)(puVar5 + 4),uVar8);
      FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e2c,pbVar2);
      FUN_10016f90(*(char **)(param_2 + 0x60),"style",(byte *)(puVar5 + 0x10a1));
      FUN_10016d40(*(char **)(param_2 + 0x60));
    }
    puVar5 = (undefined4 *)FUN_10022c60(*(int *)(param_1 + 0x4364),(undefined4 *)0x0);
  } while( true );
}



void __cdecl FUN_1003b510(int param_1,int param_2)

{
  byte *pbVar1;
  undefined4 uVar2;
  byte *pbVar3;
  undefined4 *puVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  uint uVar8;
  undefined4 *local_44;
  int local_40;
  int local_3c;
  int local_38;
  uint local_30;
  uint local_2c;
  uint local_28;
  byte local_20 [32];
  
  uVar8 = 0x656e5553;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004dca4);
  uVar8 = FUN_10002930(pbVar1,uVar8);
  FUN_1000ada0(param_2);
  uVar2 = FUN_10022980(*(undefined4 **)(param_1 + 0x4360));
  FUN_10017110(*(char **)(param_2 + 0x60),"views",uVar2);
  FUN_10022c50(*(int *)(param_1 + 0x4360));
  pbVar1 = (byte *)FUN_10022c60(*(int *)(param_1 + 0x4360),(undefined4 *)0x0);
  while (pbVar1 != (byte *)0x0) {
    FUN_10016c00(*(char **)(param_2 + 0x60),&DAT_10053e34);
    pbVar3 = FUN_10017ca0(*(int **)(param_1 + 0x2ccca4),pbVar1,uVar8);
    FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e08,pbVar3);
    FUN_10017110(*(char **)(param_2 + 0x60),"categories",*(undefined4 *)(pbVar1 + 0x10));
    local_28 = 0;
    if (*(int *)(pbVar1 + 0x10) != 0) {
      local_38 = 0;
      do {
        puVar6 = (undefined4 *)(*(int *)(pbVar1 + 0xc) + local_38);
        FUN_10016c00(*(char **)(param_2 + 0x60),"category");
        pbVar3 = FUN_10017ca0(*(int **)(param_1 + 0x2ccca4),(byte *)*puVar6,uVar8);
        FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e08,pbVar3);
        FUN_10017110(*(char **)(param_2 + 0x60),"indices",puVar6[3]);
        local_2c = 0;
        if (puVar6[3] != 0) {
          local_3c = 0;
          do {
            puVar4 = (undefined4 *)(puVar6[2] + local_3c);
            FUN_10016c00(*(char **)(param_2 + 0x60),"index");
            pbVar3 = FUN_10017ca0(*(int **)(param_1 + 0x2ccca4),(byte *)*puVar4,uVar8);
            FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e08,pbVar3);
            FUN_10017110(*(char **)(param_2 + 0x60),"variations",puVar4[3]);
            local_30 = 0;
            if (puVar4[3] != 0) {
              local_40 = 0;
              do {
                puVar7 = (undefined4 *)(puVar4[2] + local_40);
                FUN_10016c00(*(char **)(param_2 + 0x60),"variation");
                pbVar3 = FUN_10017ca0(*(int **)(param_1 + 0x2ccca4),(byte *)*puVar7,uVar8);
                FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e08,pbVar3);
                FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053ef0,(byte *)(puVar7 + 1));
                FUN_10017110(*(char **)(param_2 + 0x60),"fixed_count",
                             (uint)*(ushort *)((int)puVar7 + 0xdca));
                FUN_10017110(*(char **)(param_2 + 0x60),"range",(int)*(short *)(puVar7 + 0x374));
                FUN_10017110(*(char **)(param_2 + 0x60),"centered",
                             *(byte *)((int)puVar7 + 0xdd2) & 1);
                FUN_10017110(*(char **)(param_2 + 0x60),"users",*(byte *)((int)puVar7 + 0xdd2) & 2);
                if ((*(byte *)((int)puVar7 + 0xdd2) & 2) != 0) {
                  FUN_10005ca0((char *)local_20,0x20,"%c%c%c%c");
                  FUN_10016f90(*(char **)(param_2 + 0x60),"usertype",local_20);
                }
                uVar5 = 0;
                if (*(short *)((int)puVar7 + 0xdce) != 0) {
                  local_44 = puVar7 + 0x36a;
                  do {
                    FUN_10005ca0((char *)local_20,0x20,"param%d");
                    FUN_10017110(*(char **)(param_2 + 0x60),local_20,*local_44);
                    uVar5 = uVar5 + 1;
                    local_44 = local_44 + 1;
                  } while (uVar5 < *(ushort *)((int)puVar7 + 0xdce));
                }
                FUN_10016d40(*(char **)(param_2 + 0x60));
                local_30 = local_30 + 1;
                local_40 = local_40 + 0x1e028;
              } while (local_30 < (uint)puVar4[3]);
            }
            FUN_10016d40(*(char **)(param_2 + 0x60));
            local_2c = local_2c + 1;
            local_3c = local_3c + 0x14;
          } while (local_2c < (uint)puVar6[3]);
        }
        FUN_10016d40(*(char **)(param_2 + 0x60));
        local_28 = local_28 + 1;
        local_38 = local_38 + 0x14;
      } while (local_28 < *(uint *)(pbVar1 + 0x10));
    }
    FUN_10016d40(*(char **)(param_2 + 0x60));
    pbVar1 = (byte *)FUN_10022c60(*(int *)(param_1 + 0x4360),(undefined4 *)0x0);
  }
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return;
}



void __cdecl FUN_1003b900(int param_1,int param_2,uint param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  undefined1 uVar4;
  int unaff_ESI;
  int iVar5;
  byte *pbVar6;
  uint uVar7;
  int iVar8;
  byte *pbVar9;
  byte local_148;
  undefined1 local_147;
  undefined1 local_146;
  undefined1 local_145;
  undefined1 local_144;
  uint local_140;
  uint local_13c;
  byte local_138 [8];
  uint local_130;
  uint local_12c;
  undefined4 local_128;
  undefined4 local_124;
  byte local_11c [16];
  byte local_10c [64];
  byte local_cc [36];
  byte local_a8 [36];
  byte local_84 [132];
  
  pbVar6 = &DAT_1004d26f;
  iVar5 = 0x10;
  pbVar2 = local_11c;
  pbVar1 = FUN_100020f0(*(byte **)(unaff_ESI + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar2,iVar5,pbVar6);
  uVar7 = 0x656e5553;
  pbVar2 = FUN_100020f0(*(byte **)(unaff_ESI + 0x7c),&DAT_1004dca4);
  uVar7 = FUN_10002930(pbVar2,uVar7);
  iVar5 = *(int *)(param_2 + 0xd2c);
  FUN_1000ada0(unaff_ESI);
  FUN_10016f90(*(char **)(unaff_ESI + 0x60),&DAT_10050ca0,local_11c);
  local_13c = uVar7 >> 0x18;
  local_148 = (byte)(uVar7 >> 0x18);
  local_140 = uVar7 >> 0x10;
  local_147 = (undefined1)(uVar7 >> 0x10);
  local_130 = uVar7 >> 8;
  local_146 = (undefined1)(uVar7 >> 8);
  uVar4 = (undefined1)uVar7;
  local_144 = 0;
  local_145 = uVar4;
  FUN_10016f90(*(char **)(unaff_ESI + 0x60),&DAT_10053e20,&local_148);
  FUN_10016c00(*(char **)(unaff_ESI + 0x60),"trophies");
  iVar8 = 0;
  pbVar2 = FUN_100020f0(*(byte **)(iVar5 + 0xc),(byte *)"COUNT");
  iVar8 = FUN_10002480((char *)pbVar2,iVar8);
  FUN_10017110(*(char **)(unaff_ESI + 0x60),"count",iVar8);
  local_148 = (byte)local_13c;
  local_147 = (undefined1)local_140;
  local_146 = (undefined1)local_130;
  local_144 = 0;
  local_145 = uVar4;
  _sprintf((char *)local_10c,"@trophies.%s",&local_148);
  pbVar2 = FUN_1002a500(*(uint **)(param_1 + 0x4034),local_10c);
  if (pbVar2 == (byte *)0x0) {
    local_146 = 0;
    local_148 = (byte)local_13c;
    local_147 = (undefined1)local_140;
    _sprintf((char *)local_10c,"@trophies.%s",&local_148);
    pbVar2 = FUN_1002a500(*(uint **)(param_1 + 0x4034),local_10c);
  }
  for (pbVar1 = FUN_100038b0(*(byte **)(iVar5 + 0xc),local_138,8); pbVar1 != (byte *)0x0;
      pbVar1 = FUN_100038b0(pbVar1,local_138,8)) {
    if (local_138[0] == 0x54) {
      FUN_10016c00(*(char **)(unaff_ESI + 0x60),"trophy");
      FUN_10002fe0(pbVar1,&local_12c,0x10,&DAT_1004e4d4);
      pbVar9 = &DAT_1004d26f;
      iVar5 = 0x24;
      pbVar6 = local_cc;
      pbVar3 = (byte *)FUN_100022d0(pbVar2,&DAT_1004e168,local_12c);
      FUN_10002a30(pbVar3,pbVar6,iVar5,pbVar9);
      pbVar9 = &DAT_1004d26f;
      iVar5 = 0x84;
      pbVar6 = local_84;
      pbVar3 = (byte *)FUN_100022d0(pbVar2,&DAT_1004e4d8,local_12c);
      FUN_10002a30(pbVar3,pbVar6,iVar5,pbVar9);
      pbVar9 = &DAT_1004d26f;
      iVar5 = 0x24;
      pbVar6 = local_a8;
      pbVar3 = (byte *)FUN_100022d0(pbVar2,&DAT_10053f68,local_12c);
      FUN_10002a30(pbVar3,pbVar6,iVar5,pbVar9);
      FUN_10017110(*(char **)(unaff_ESI + 0x60),"ident",local_12c);
      FUN_10016f90(*(char **)(unaff_ESI + 0x60),&DAT_10053e08,local_cc);
      FUN_10016f90(*(char **)(unaff_ESI + 0x60),&DAT_10053e2c,local_84);
      FUN_10016f90(*(char **)(unaff_ESI + 0x60),"image",local_a8);
      FUN_10017110(*(char **)(unaff_ESI + 0x60),&DAT_10053f58,local_124);
      FUN_10017110(*(char **)(unaff_ESI + 0x60),"count",local_128);
      FUN_10016d40(*(char **)(unaff_ESI + 0x60));
    }
  }
  FUN_10016d40(*(char **)(unaff_ESI + 0x60));
  iVar5 = 0;
  uVar7 = param_3;
  if (param_3 != 0) {
    do {
      uVar7 = uVar7 & uVar7 - 1;
      iVar5 = iVar5 + 1;
    } while (uVar7 != 0);
  }
  FUN_10016c00(*(char **)(unaff_ESI + 0x60),"medals");
  FUN_10017110(*(char **)(unaff_ESI + 0x60),"count",iVar5);
  if (0 < iVar5) {
    local_148 = (byte)local_13c;
    local_147 = (undefined1)local_140;
    local_146 = (undefined1)local_130;
    local_144 = 0;
    local_145 = uVar4;
    _sprintf((char *)local_10c,"@medals.%s",&local_148);
    pbVar2 = FUN_1002a500(*(uint **)(param_1 + 0x4034),local_10c);
    if (pbVar2 == (byte *)0x0) {
      local_148 = (byte)local_13c;
      local_147 = (undefined1)local_140;
      local_146 = 0;
      _sprintf((char *)local_10c,"@medals.%s",&local_148);
      pbVar2 = FUN_1002a500(*(uint **)(param_1 + 0x4034),local_10c);
    }
    iVar5 = 0;
    if (param_3 != 0) {
      do {
        if ((param_3 & 1) != 0) {
          FUN_10016c00(*(char **)(unaff_ESI + 0x60),"medal");
          FUN_10017110(*(char **)(unaff_ESI + 0x60),&DAT_10053f38,iVar5);
          if (pbVar2 != (byte *)0x0) {
            _sprintf((char *)local_138,"N%d",iVar5);
            pbVar3 = &DAT_1004d26f;
            iVar8 = 0x24;
            pbVar1 = local_cc;
            pbVar6 = FUN_100020f0(pbVar2,local_138);
            FUN_10002a30(pbVar6,pbVar1,iVar8,pbVar3);
            pbVar3 = &DAT_1004d26f;
            iVar8 = 0x84;
            pbVar1 = local_84;
            local_138[0] = 0x44;
            pbVar6 = FUN_100020f0(pbVar2,local_138);
            FUN_10002a30(pbVar6,pbVar1,iVar8,pbVar3);
            iVar8 = 0;
            local_138[0] = 0x49;
            pbVar1 = FUN_100020f0(pbVar2,local_138);
            iVar8 = FUN_10002480((char *)pbVar1,iVar8);
            FUN_10016f90(*(char **)(unaff_ESI + 0x60),&DAT_10053e08,local_cc);
            FUN_10016f90(*(char **)(unaff_ESI + 0x60),&DAT_10053e2c,local_84);
            FUN_10017110(*(char **)(unaff_ESI + 0x60),"image",iVar8);
          }
          FUN_10016d40(*(char **)(unaff_ESI + 0x60));
        }
        param_3 = param_3 >> 1;
        iVar5 = iVar5 + 1;
      } while (param_3 != 0);
    }
  }
  FUN_10016d40(*(char **)(unaff_ESI + 0x60));
  *(undefined4 *)(unaff_ESI + 0x28) = 0;
  *(undefined4 *)(unaff_ESI + 0x50) = *(undefined4 *)(unaff_ESI + 0x6c);
  *(undefined4 *)(unaff_ESI + 0x54) = 0;
  *(undefined4 *)(unaff_ESI + 0x58) = 0xffffffff;
  return;
}



undefined4 __cdecl FUN_1003be40(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  undefined4 uVar4;
  
  iVar1 = FUN_1001ab40(param_2);
  if (-1 < iVar1) {
    if (*(int *)(param_2 + 0x54) == 0) {
      iVar1 = 0;
      pbVar2 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"MEDALS");
      uVar3 = FUN_10002480((char *)pbVar2,iVar1);
      uVar4 = FUN_1003b900(param_1,param_3,uVar3);
      return uVar4;
    }
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
  }
  return 0;
}



undefined4 __cdecl FUN_1003bfa0(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  undefined4 uVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_10 [16];
  
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x10;
  pbVar3 = local_10;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  if (local_10[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"PERS=%s SKEY=%s");
  iVar4 = FUN_10022a40(*(void **)(param_1 + 0x40f8),(int)*(void **)(param_1 + 0x40f8),local_10);
  if (iVar4 != 0) {
    FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),&DAT_1004e700,
                 (byte *)(iVar4 + 0x2e4));
  }
  iVar4 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar4;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar4,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  uVar2 = FUN_1001ab10(param_2,&LAB_1003bea0);
  return uVar2;
}



undefined4 __cdecl FUN_1003c0a0(undefined4 param_1,int param_2)

{
  int iVar1;
  
  iVar1 = FUN_1001ab40(param_2);
  if (-1 < iVar1) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
  }
  return 0;
}



undefined4 __cdecl FUN_1003c0d0(int param_1,int param_2,int param_3)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = FUN_1001ab40(param_2);
  if (-1 < iVar1) {
    if (*(int *)(param_2 + 0x54) == 0) {
      FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
                   *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
      FUN_10003cf0(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"EDUSINP",
                   *(byte **)(param_2 + 0x7c));
      iVar1 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
      *(int *)(param_3 + 0xaac) = iVar1;
      FUN_10022490(*(undefined4 **)(param_1 + 0x4024),0x45445553,-iVar1,*(char **)(param_2 + 0x60),
                   (char *)0xffffffff);
      uVar2 = FUN_1001ab10(param_2,FUN_1003c0a0);
      return uVar2;
    }
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x58) = 0;
  }
  return 0;
}



undefined4 __cdecl FUN_1003c180(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  undefined4 uVar2;
  void *this;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_30 [16];
  byte local_20 [32];
  
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x10;
  pbVar3 = local_30;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x20;
  pbVar3 = local_20;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e700);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  if (local_30[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (local_20[0] == 0) {
    iVar4 = FUN_10022a40(this,*(int *)(param_1 + 0x40f8),local_30);
    if (iVar4 != 0) {
      FUN_10005d70((char *)local_20,(char *)(iVar4 + 0x2e4),0x20);
    }
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
               (byte *)"PERS=%s UID=%s LOCK=%d");
  iVar4 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar4;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar4,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  uVar2 = FUN_1001ab10(param_2,FUN_1003c0d0);
  return uVar2;
}



undefined4 __cdecl FUN_1003c2a0(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  char *pcVar4;
  byte *pbVar5;
  uint local_64;
  uint local_60;
  int local_5c;
  int local_58;
  int local_54;
  uint local_50;
  int local_4c;
  int local_48;
  byte local_40 [32];
  byte local_20 [32];
  
  iVar1 = FUN_1001ab40(param_2);
  if (iVar1 < 0) {
    return 0;
  }
  if (*(int *)(param_2 + 0x54) != 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    return 0;
  }
  pbVar5 = &DAT_1004d26f;
  iVar1 = 0x20;
  pbVar3 = local_20;
  pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e6ac);
  FUN_10002a30(pbVar2,pbVar3,iVar1,pbVar5);
  if (local_20[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x58) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    return 0;
  }
  local_60 = 0;
  local_5c = 0;
  local_58 = 0;
  iVar1 = 0;
  local_54 = 0;
  pbVar3 = FUN_100020f0(*(byte **)(*(int *)(param_3 + 0xab0) + 0xc),(byte *)"COUNT");
  local_64 = FUN_10002480((char *)pbVar3,iVar1);
  iVar1 = FUN_10005cd0(local_20,&DAT_10053fe0);
  if (iVar1 == 0) {
    pbVar3 = FUN_1002a500(*(uint **)(param_1 + 0x4034),(byte *)"@trophies.enUS");
    if (pbVar3 == (byte *)0x0) {
      pbVar3 = FUN_1002a500(*(uint **)(param_1 + 0x4034),(byte *)"@trophies.en");
    }
    iVar1 = -1;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"IDENT");
    local_60 = FUN_10002480((char *)pbVar2,iVar1);
    if (local_60 == 0xffffffff) {
LAB_1003c52d:
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
      return 0;
    }
    iVar1 = FUN_10003320((char *)0x0,0);
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004ee14);
    local_58 = FUN_10002480((char *)pbVar2,iVar1);
    iVar1 = 1;
    pbVar2 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"COUNT");
    local_5c = FUN_10002480((char *)pbVar2,iVar1);
    iVar1 = -1;
    pcVar4 = (char *)FUN_100022d0(pbVar3,&DAT_1004f5a0,local_60);
    local_54 = FUN_10002480(pcVar4,iVar1);
    FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
                 *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
    _sprintf((char *)local_40,"T%d",local_60);
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x60),local_40);
    if (pbVar3 == (byte *)0x0) {
      FUN_10002d30(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),local_40,&local_60,0x10,
                   &DAT_1004e4d4);
      local_64 = local_64 + 1;
    }
    else {
      FUN_10002fe0(pbVar3,&local_50,0x10,&DAT_1004e4d4);
      local_48 = local_58;
      local_4c = local_4c + 1;
      FUN_10002d30(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),local_40,&local_50,0x10,
                   &DAT_1004e4d4);
    }
  }
  else {
    iVar1 = FUN_10005cd0(local_20,&DAT_10053fb8);
    if (iVar1 != 0) {
      *(undefined4 *)(param_2 + 0x28) = 0;
      *(undefined4 *)(param_2 + 0x58) = 0;
      *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
      *(undefined4 *)(param_2 + 0x54) = 0x696e6f70;
      return 0;
    }
    iVar1 = -1;
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"IDENT");
    local_60 = FUN_10002480((char *)pbVar3,iVar1);
    if (local_60 == 0xffffffff) goto LAB_1003c52d;
    iVar1 = 1;
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x7c),(byte *)"COUNT");
    local_5c = FUN_10002480((char *)pbVar3,iVar1);
    FUN_100020b0(*(char **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),
                 *(char **)(*(int *)(param_3 + 0xab0) + 0xc));
    _sprintf((char *)local_40,"T%d",local_60);
    pbVar3 = FUN_100020f0(*(byte **)(param_2 + 0x60),local_40);
    if (pbVar3 != (byte *)0x0) {
      FUN_10002fe0(pbVar3,&local_50,0x10,&DAT_1004e4d4);
      local_4c = local_4c - local_5c;
      if (local_4c < 0) {
        FUN_10003a20(*(byte **)(param_2 + 0x60),local_40);
        local_64 = local_64 - 1;
      }
      else {
        FUN_10002d30(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),local_40,&local_50,0x10,
                     &DAT_1004e4d4);
      }
    }
  }
  FUN_10002370(*(byte **)(param_2 + 0x60),*(int *)(param_2 + 0x5c),(byte *)"COUNT",local_64);
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a707574,0,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x58) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  return 0;
}



undefined4 __cdecl FUN_1003c680(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  undefined4 uVar2;
  void *this;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_30 [16];
  byte local_20 [32];
  
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x10;
  pbVar3 = local_30;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x20;
  pbVar3 = local_20;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e700);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  if (local_30[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (local_20[0] == 0) {
    iVar4 = FUN_10022a40(this,*(int *)(param_1 + 0x40f8),local_30);
    if (iVar4 != 0) {
      FUN_10005d70((char *)local_20,(char *)(iVar4 + 0x2e4),0x20);
    }
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),
               (byte *)"PERS=%s UID=%s LOCK=%d SKEY=%s");
  iVar4 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar4;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar4,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  uVar2 = FUN_1001ab10(param_2,FUN_1003c2a0);
  return uVar2;
}



undefined4 __cdecl FUN_1003cab0(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  undefined4 uVar2;
  void *this;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_30 [16];
  byte local_20 [32];
  
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x10;
  pbVar3 = local_30;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  pbVar5 = &DAT_1004d26f;
  iVar4 = 0x20;
  pbVar3 = local_20;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004e700);
  FUN_10002a30(pbVar1,pbVar3,iVar4,pbVar5);
  if (local_30[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return 0;
  }
  if (local_20[0] == 0) {
    iVar4 = FUN_10022a40(this,*(int *)(param_1 + 0x40f8),local_30);
    if (iVar4 != 0) {
      FUN_10005d70((char *)local_20,(char *)(iVar4 + 0x2e4),0x20);
    }
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"PERS=%s UID=%s");
  iVar4 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar4;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a677374,-iVar4,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  uVar2 = FUN_1001ab10(param_2,&LAB_1003c7a0);
  return uVar2;
}



void __cdecl FUN_1003cbd0(int param_1,int param_2)

{
  int iVar1;
  byte local_8;
  undefined1 local_7;
  undefined1 local_6;
  undefined1 local_5;
  undefined1 local_4;
  
  FUN_1000ada0(param_2);
  FUN_10016c00(*(char **)(param_2 + 0x60),"metrics");
  FUN_10017110(*(char **)(param_2 + 0x60),"usersInLobby",*(undefined4 *)(param_1 + 0x2ccca8));
  FUN_10017110(*(char **)(param_2 + 0x60),"usersInRooms",*(undefined4 *)(param_1 + 0x2cccac));
  FUN_10017110(*(char **)(param_2 + 0x60),"usersInGames",*(undefined4 *)(param_1 + 0x2cccb0));
  FUN_10017110(*(char **)(param_2 + 0x60),"gamesInProgress",*(undefined4 *)(param_1 + 0x2cccb4));
  FUN_10017110(*(char **)(param_2 + 0x60),"gamesCreated",*(undefined4 *)(param_1 + 0x2cccb8));
  FUN_10017110(*(char **)(param_2 + 0x60),"gamesCompleted",*(undefined4 *)(param_1 + 0x2cccbc));
  FUN_10016d40(*(char **)(param_2 + 0x60));
  FUN_10016c00(*(char **)(param_2 + 0x60),"rooms");
  FUN_10022c50(*(int *)(param_1 + 0x40e8));
  iVar1 = FUN_10022c60(*(int *)(param_1 + 0x40e8),(undefined4 *)0x0);
  while (iVar1 != 0) {
    local_7 = *(undefined1 *)(iVar1 + 0x1aa);
    local_8 = *(byte *)(iVar1 + 0x1ab);
    local_6 = *(undefined1 *)(iVar1 + 0x1a9);
    local_5 = *(undefined1 *)(iVar1 + 0x1a8);
    local_4 = 0;
    FUN_10016c00(*(char **)(param_2 + 0x60),&DAT_10054078);
    FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e08,(byte *)(iVar1 + 8));
    FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10053e2c,(byte *)(iVar1 + 0x84));
    FUN_10016f90(*(char **)(param_2 + 0x60),&DAT_10054070,(byte *)(iVar1 + 0x50));
    FUN_10017110(*(char **)(param_2 + 0x60),"flags",*(undefined4 *)(iVar1 + 4));
    FUN_10017110(*(char **)(param_2 + 0x60),"total",*(undefined4 *)(iVar1 + 0x10c));
    FUN_10017110(*(char **)(param_2 + 0x60),"limit",*(undefined4 *)(iVar1 + 0x108));
    FUN_10017110(*(char **)(param_2 + 0x60),"games",*(undefined4 *)(iVar1 + 0x1a0));
    FUN_10016f90(*(char **)(param_2 + 0x60),"locality",&local_8);
    FUN_10016d40(*(char **)(param_2 + 0x60));
    iVar1 = FUN_10022c60(*(int *)(param_1 + 0x40e8),(undefined4 *)0x0);
  }
  FUN_10016d40(*(char **)(param_2 + 0x60));
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x54) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x58) = 0xffffffff;
  return;
}



void __cdecl FUN_1003d1d0(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte local_10 [16];
  
  pbVar4 = &DAT_1004d26f;
  iVar3 = 0x10;
  pbVar2 = local_10;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar2,iVar3,pbVar4);
  if (local_10[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return;
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"PERS=%s");
  iVar3 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar3;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar3,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  FUN_1001ab10(param_2,&LAB_1003d000);
  return;
}



void __cdecl FUN_1003d4d0(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte local_10 [16];
  
  pbVar4 = &DAT_1004d26f;
  iVar3 = 0x10;
  pbVar2 = local_10;
  pbVar1 = FUN_100020f0(*(byte **)(param_2 + 0x7c),&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar2,iVar3,pbVar4);
  if (local_10[0] == 0) {
    *(undefined4 *)(param_2 + 0x28) = 0;
    *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
    *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x58) = 0;
    return;
  }
  FUN_10003e20(*(byte **)(param_2 + 0x60),*(size_t *)(param_2 + 0x5c),(byte *)"PERS=%s LOCK=%d");
  iVar3 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xaac) = iVar3;
  FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a666774,-iVar3,*(char **)(param_2 + 0x60),
               (char *)0xffffffff);
  FUN_1001ab10(param_2,&LAB_1003d290);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_1003d590(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  void *this;
  void *this_00;
  int iVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte local_41ac [16];
  byte local_419c [400];
  byte local_400c [16392];
  undefined4 uStack_4;
  
  uStack_4 = 0x1003d59a;
  pbVar6 = local_41ac;
  iVar3 = *(int *)(param_1 + 0x40f8);
  pbVar2 = *(byte **)(param_2 + 0x7c);
  pbVar5 = (byte *)0x0;
  iVar4 = 0x10;
  pbVar1 = FUN_100020f0(pbVar2,&DAT_1004d8d8);
  FUN_10002a30(pbVar1,pbVar6,iVar4,pbVar5);
  pbVar6 = (byte *)0x0;
  iVar4 = 400;
  pbVar1 = local_419c;
  pbVar2 = FUN_100020f0(pbVar2,&DAT_10054130);
  FUN_10002a30(pbVar2,pbVar1,iVar4,pbVar6);
  local_400c[0] = 0;
  if (local_419c[0] != 0) {
    FUN_10003cf0(local_400c,0x400c,&DAT_1004dc8c,(byte *)"ea_admin");
    iVar4 = FUN_10022a40(this,iVar3,(byte *)"ea_admin");
    if (iVar4 != 0) {
      FUN_10003cf0(local_400c,0x400c,(byte *)"FROM_UID",(byte *)(iVar4 + 0x2e4));
    }
    FUN_10003cf0(local_400c,0x400c,&DAT_10052040,local_419c);
    FUN_10002370(local_400c,0x400c,(byte *)"REPLY",0);
    FUN_10003cf0(local_400c,0x400c,&DAT_10052034,local_41ac);
    iVar3 = FUN_10022a40(this_00,iVar3,local_41ac);
    if (iVar3 == 0) {
      FUN_10003a20(local_400c,(byte *)"TO_UID");
    }
    else {
      FUN_10003cf0(local_400c,0x400c,(byte *)"TO_UID",(byte *)(iVar3 + 0x2e4));
    }
    iVar3 = FUN_10014310(*(int *)(param_1 + 0x4020),param_2);
    *(int *)(param_3 + 0xaac) = iVar3;
    FUN_10022490(*(undefined4 **)(param_1 + 0x4028),0x2a73696d,-iVar3,(char *)local_400c,
                 (char *)0xffffffff);
    FUN_1001ab10(param_2,FUN_1003c0a0);
    return;
  }
  *(undefined4 *)(param_2 + 0x28) = 0;
  *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(param_2 + 0x6c);
  *(undefined4 *)(param_2 + 0x54) = 0x6d697373;
  *(undefined4 *)(param_2 + 0x58) = 0;
  return;
}



void __cdecl FUN_1003d8a0(undefined4 param_1,int param_2,int param_3)

{
  byte *pbVar1;
  char *pcVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  int iVar9;
  byte local_80 [4];
  byte local_7c [8];
  byte local_74 [16];
  byte local_64 [36];
  byte local_40 [64];
  
  pbVar1 = *(byte **)(*(int *)(param_3 + 0xab0) + 0xc);
  pcVar2 = *(char **)(param_2 + 0x60);
  iVar9 = 0x2c;
  iVar4 = 0;
  iVar8 = 0;
  pbVar7 = &DAT_1004d26f;
  iVar6 = 0x21;
  pbVar5 = local_64;
  pbVar3 = FUN_100020f0(pbVar1,(byte *)"NAMES");
  for (iVar6 = FUN_10003680(pbVar3,pbVar5,iVar6,pbVar7,iVar8,iVar9); 0 < iVar6;
      iVar6 = FUN_10003680(pbVar3,pbVar5,iVar8,pbVar7,iVar6,iVar9)) {
    iVar9 = 0x2c;
    pbVar7 = &DAT_1004d26f;
    iVar8 = 5;
    pbVar5 = local_7c;
    iVar6 = iVar4;
    pbVar3 = FUN_100020f0(pbVar1,&DAT_10054154);
    FUN_10003680(pbVar3,pbVar5,iVar8,pbVar7,iVar6,iVar9);
    iVar9 = 0x2c;
    pbVar7 = &DAT_1004d26f;
    iVar8 = 0xd;
    pbVar5 = local_74;
    iVar6 = iVar4;
    pbVar3 = FUN_100020f0(pbVar1,&DAT_10054150);
    FUN_10003680(pbVar3,pbVar5,iVar8,pbVar7,iVar6,iVar9);
    iVar9 = 0x2c;
    pbVar7 = &DAT_1004d26f;
    iVar8 = 0x40;
    pbVar5 = local_40;
    iVar6 = iVar4;
    pbVar3 = FUN_100020f0(pbVar1,&DAT_1005414c);
    FUN_10003680(pbVar3,pbVar5,iVar8,pbVar7,iVar6,iVar9);
    iVar9 = 0x2c;
    pbVar7 = &DAT_1004d26f;
    iVar8 = 3;
    pbVar5 = local_80;
    iVar6 = iVar4;
    pbVar3 = FUN_100020f0(pbVar1,&DAT_1004dca4);
    FUN_10003680(pbVar3,pbVar5,iVar8,pbVar7,iVar6,iVar9);
    FUN_10016c00(pcVar2,&DAT_10054144);
    FUN_10016f90(pcVar2,&DAT_10053e08,local_64);
    FUN_10016f90(pcVar2,&DAT_10054140,local_7c);
    FUN_10016f90(pcVar2,&DAT_1005413c,local_74);
    FUN_10016f90(pcVar2,&DAT_10054138,local_40);
    FUN_10016f90(pcVar2,&DAT_10053e20,local_80);
    FUN_10016d40(pcVar2);
    iVar9 = 0x2c;
    iVar4 = iVar4 + 1;
    pbVar7 = &DAT_1004d26f;
    iVar8 = 0x21;
    pbVar5 = local_64;
    iVar6 = iVar4;
    pbVar3 = FUN_100020f0(pbVar1,(byte *)"NAMES");
  }
  return;
}



void __cdecl FUN_1003da30(undefined4 param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte bVar2;
  char *pcVar3;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  byte local_220 [32];
  byte local_200 [512];
  
  pcVar3 = *(char **)(param_2 + 0x60);
  pbVar4 = *(byte **)(*(int *)(param_3 + 0xab0) + 0xc);
  FUN_10016c00(pcVar3,&DAT_10054144);
  for (pbVar4 = FUN_100038b0(pbVar4,local_220,0x20); pbVar4 != (byte *)0x0;
      pbVar4 = FUN_100038b0(pbVar4,local_220,0x20)) {
    FUN_10002a30(pbVar4,local_200,0x200,&DAT_1004d26f);
    if (local_200[0] != 0) {
      pbVar6 = local_220;
      bVar2 = local_220[0];
      while (bVar2 != 0) {
        iVar5 = _tolower((int)(char)*pbVar6);
        *pbVar6 = (byte)iVar5;
        pbVar1 = pbVar6 + 1;
        pbVar6 = pbVar6 + 1;
        bVar2 = *pbVar1;
      }
      FUN_10016f90(pcVar3,local_220,local_200);
    }
  }
  FUN_10016d40(pcVar3);
  return;
}



bool __cdecl FUN_1003dbe0(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  
  bVar1 = *param_2;
  pbVar2 = param_1;
  do {
    if (bVar1 == 0) {
      *pbVar2 = 0;
      if (((char)*param_1 < 'a') || ('z' < (char)*param_1)) {
        *param_1 = 0;
      }
      if (param_1[1] == 0) {
        *param_1 = 0;
      }
      return *param_1 != 0;
    }
    param_2 = param_2 + 1;
    if (((char)bVar1 < 'A') || ('Z' < (char)bVar1)) {
      if ((('`' < (char)bVar1) && ((char)bVar1 < '{')) ||
         (('/' < (char)bVar1 && ((char)bVar1 < ':')))) goto LAB_1003dc15;
    }
    else {
      bVar1 = bVar1 ^ 0x20;
LAB_1003dc15:
      *pbVar2 = bVar1;
      pbVar2 = pbVar2 + 1;
    }
    bVar1 = *param_2;
  } while( true );
}



int __cdecl
FUN_1003dc50(char *param_1,size_t param_2,char *param_3,undefined4 param_4,char *param_5,
            char *param_6)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  uint uVar4;
  char local_9c [92];
  byte local_40 [64];
  
  FUN_10005d70((char *)local_40,param_3,0x40);
  FUN_1003dbe0(local_40,local_40);
  pcVar2 = param_5;
  uVar4 = 0;
  cVar1 = *param_5;
  while ('/' < cVar1) {
    iVar3 = uVar4 + 1;
    uVar4 = uVar4 + 1;
    cVar1 = param_5[iVar3];
  }
  FUN_10018990((int)local_9c);
  FUN_100189c0(local_9c,pcVar2,uVar4);
  FUN_100189c0(local_9c,(char *)local_40,0xffffffff);
  FUN_100189c0(local_9c,(char *)&param_4,4);
  FUN_100189c0(local_9c,param_6,0xffffffff);
  FUN_100189c0(local_9c,pcVar2,uVar4);
  iVar3 = 0;
  *param_1 = '\0';
  if ((int)(uVar4 + 0x22) < (int)param_2) {
    FUN_10005d70(param_1,pcVar2,param_2);
    param_1[uVar4] = ',';
    FUN_10018a70(local_9c,param_1 + uVar4 + 1,0x21);
    iVar3 = uVar4 + 0x21;
  }
  return iVar3;
}



void __cdecl FUN_1003dd40(int param_1,char *param_2,int param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  
  if (DAT_10068df8 == 0) {
    DAT_10068df8 = 1;
    FUN_1003dd40(0x10068cf0,"hello world",-1,10);
  }
  if (param_4 < 0) {
    param_4 = -param_4;
  }
  else {
    iVar2 = 0;
    do {
      *(char *)(iVar2 + param_1) = (char)iVar2;
      iVar2 = iVar2 + 1;
    } while (iVar2 < 0x100);
    *(undefined1 *)(param_1 + 0x100) = 0;
    *(undefined4 *)(param_1 + 0x104) = 0;
  }
  bVar6 = param_3 < 0;
  if (bVar6) {
    param_3 = 0;
    if (*param_2 == '\0') {
      return;
    }
    do {
      param_3 = param_3 + 1;
    } while (param_2[param_3] != '\0');
    bVar6 = param_3 < 0;
  }
  if (param_3 != 0 && !bVar6) {
    uVar5 = 0;
    uVar4 = 0;
    if (0 < param_4 * 0x100) {
      uVar3 = 0;
      do {
        uVar5 = uVar5 >> 8 ^
                *(uint *)(&DAT_10054170 + ((byte)param_2[(int)uVar4 % param_3] ^ uVar3) * 4);
        bVar1 = *(byte *)((uVar4 & 0xff) + param_1);
        uVar5 = uVar5 >> 8 ^ *(uint *)(&DAT_10054170 + (uVar5 & 0xff ^ (uint)bVar1) * 4);
        uVar3 = uVar5 & 0xff;
        *(undefined1 *)((uVar4 & 0xff) + param_1) = *(undefined1 *)(uVar3 + param_1);
        uVar4 = uVar4 + 1;
        *(byte *)(uVar3 + param_1) = bVar1;
      } while ((int)uVar4 < param_4 * 0x100);
    }
  }
  return;
}



void __cdecl FUN_1003de40(int param_1,byte *param_2,int param_3)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  
  bVar3 = *(byte *)(param_1 + 0x100);
  uVar5 = *(uint *)(param_1 + 0x104);
  if (0 < param_3) {
    pbVar6 = (byte *)((uint)bVar3 + param_1);
    uVar4 = uVar5 & 0xff;
    do {
      uVar5 = uVar5 >> 8 ^ *(uint *)(&DAT_10054170 + (*pbVar6 ^ uVar4) * 4);
      bVar3 = bVar3 + 1;
      pbVar6 = (byte *)((uint)bVar3 + param_1);
      bVar1 = *pbVar6;
      uVar4 = uVar5 & 0xff;
      bVar2 = *(byte *)(uVar4 + param_1);
      *pbVar6 = bVar2;
      *(byte *)(uVar4 + param_1) = bVar1;
      *param_2 = *param_2 ^ *(byte *)(((uint)bVar1 - (uint)bVar2 & 0xff) + param_1);
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  *(uint *)(param_1 + 0x104) = uVar5;
  *(byte *)(param_1 + 0x100) = bVar3;
  return;
}



undefined4 __cdecl
FUN_1003dee0(char *param_1,int param_2,int param_3,char *param_4,int param_5,int param_6)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  byte local_109;
  undefined1 local_108 [264];
  
  local_109 = 0;
  FUN_1003dd40((int)local_108,param_4,param_5,param_6);
  iVar3 = 0;
  if (0 < param_2 + -1) {
    while( true ) {
      bVar1 = *(byte *)(iVar3 + param_3);
      iVar3 = iVar3 + 1;
      if (bVar1 == 0) break;
      FUN_1003de40((int)local_108,&local_109,1);
      cVar2 = (char)((int)(((uint)bVar1 - (uint)local_109 % 0x60) + 0x40) % 0x60) + ' ';
      *param_1 = cVar2;
      if ((cVar2 == '\x7f') || (param_1 = param_1 + 1, param_2 + -1 <= iVar3)) break;
    }
  }
  if (iVar3 < param_2) {
    *param_1 = '\0';
  }
  return 0;
}



void __fastcall FUN_1003dfa0(int param_1)

{
  _free(*(void **)(param_1 + 4));
  return;
}



undefined4 * __thiscall
FUN_1003dfb0(void *this,uint param_1,int param_2,uint param_3,undefined4 param_4,undefined4 param_5,
            undefined4 param_6)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  
  puVar1 = *(undefined4 **)((int)this + 8);
  if (puVar1 == (undefined4 *)0x0) {
    return puVar1;
  }
  *(undefined4 *)((int)this + 8) = puVar1[7];
  uVar5 = param_2 + (uint)CARRY4(param_1,param_3);
  if (*(int *)((int)this + 0xc) == 0) {
    *(undefined4 **)((int)this + 0xc) = puVar1;
    puVar1[7] = 0;
  }
  else {
    iVar4 = *(int *)((int)this + 0xc);
    iVar6 = 0;
    while (iVar3 = iVar4, uVar2 = *(uint *)(iVar3 + 0xc), iVar4 = iVar3,
          uVar5 > uVar2 || uVar2 == uVar5) {
      if (((uVar5 <= uVar2) && (param_1 + param_3 <= *(uint *)(iVar3 + 8))) ||
         (iVar4 = *(int *)(iVar3 + 0x1c), iVar6 = iVar3, iVar4 == 0)) break;
    }
    if (iVar6 == 0) {
      puVar1[7] = iVar4;
      *(undefined4 **)((int)this + 0xc) = puVar1;
    }
    else {
      *(undefined4 **)(iVar6 + 0x1c) = puVar1;
      puVar1[7] = iVar4;
    }
  }
  if (*(int *)((int)this + 0x10) == 0) {
    *(undefined4 *)((int)this + 0x10) = 1;
  }
  *puVar1 = *(undefined4 *)((int)this + 0x10);
  *(int *)((int)this + 0x10) = *(int *)((int)this + 0x10) + 1;
  puVar1[4] = param_4;
  puVar1[2] = param_1 + param_3;
  puVar1[3] = uVar5;
  puVar1[5] = param_5;
  puVar1[6] = param_6;
  return (undefined4 *)*puVar1;
}



undefined4 __fastcall FUN_1003e050(int param_1)

{
  return *(undefined4 *)(param_1 + 0xc);
}



void __fastcall FUN_1003e060(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0xc);
  if (iVar1 != 0) {
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(iVar1 + 0x1c);
    *(undefined4 *)(iVar1 + 0x1c) = *(undefined4 *)(param_1 + 8);
    *(int *)(param_1 + 8) = iVar1;
  }
  return;
}



int __thiscall FUN_1003e080(void *this,int param_1)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  
  piVar3 = *(int **)((int)this + 0xc);
  piVar2 = (int *)0x0;
  while( true ) {
    piVar1 = piVar3;
    if (piVar1 == (int *)0x0) {
      return 0;
    }
    if (*piVar1 == param_1) break;
    piVar3 = (int *)piVar1[7];
    piVar2 = piVar1;
  }
  if (piVar2 == (int *)0x0) {
    *(int *)((int)this + 0xc) = piVar1[7];
    piVar1[7] = *(int *)((int)this + 8);
    *(int **)((int)this + 8) = piVar1;
    return piVar1[6];
  }
  piVar2[7] = piVar1[7];
  piVar1[7] = *(int *)((int)this + 8);
  *(int **)((int)this + 8) = piVar1;
  return piVar1[6];
}



int * __thiscall FUN_1003e0e0(void *this,int param_1)

{
  void *pvVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  
  *(int *)this = param_1;
  pvVar1 = operator_new(param_1 << 5);
  iVar4 = 0;
  if (pvVar1 == (void *)0x0) {
    pvVar1 = (void *)0x0;
  }
  else if (-1 < param_1 + -1) {
    puVar3 = (undefined4 *)((int)pvVar1 + 0x10);
    iVar5 = param_1;
    do {
      puVar3[-4] = 0;
      puVar3[-2] = 0;
      puVar3[-1] = 0;
      *puVar3 = 0;
      puVar3[1] = 0;
      puVar3[2] = 0;
      puVar3[3] = 0;
      puVar3 = puVar3 + 8;
      iVar5 = iVar5 + -1;
    } while (iVar5 != 0);
  }
  iVar5 = param_1 + -1;
  *(void **)((int)this + 4) = pvVar1;
  *(undefined4 *)((int)this + 0xc) = 0;
  *(undefined4 *)((int)this + 0x10) = 0;
  if (0 < iVar5) {
    do {
      iVar2 = *(int *)((int)this + 4) + iVar4;
      iVar4 = iVar4 + 0x20;
      iVar5 = iVar5 + -1;
      *(int *)(iVar2 + 0x1c) = iVar2 + 0x20;
    } while (iVar5 != 0);
  }
  *(undefined4 *)((int)this + 8) = *(undefined4 *)((int)this + 4);
  return (int *)this;
}



void __cdecl FUN_1003e160(int param_1,undefined4 param_2)

{
  *(undefined4 *)(param_1 + 0x20) = param_2;
  return;
}



void __cdecl FUN_1003e170(int *param_1)

{
  void *_Memory;
  int iVar1;
  
  iVar1 = *param_1;
  while (iVar1 != 0) {
    _Memory = (void *)*param_1;
    *param_1 = *(int *)((int)_Memory + 4);
    _free(_Memory);
    iVar1 = *param_1;
  }
  _free(param_1);
  return;
}



int FUN_1003e1b0(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  int iVar5;
  
  if (param_2 < 0x10) {
    param_2 = 0x10;
  }
  iVar1 = param_2 + 1;
  puVar3 = (undefined4 *)_malloc(param_1[7] * iVar1);
  if (puVar3 != (undefined4 *)0x0) {
    uVar2 = *param_1;
    iVar5 = 1;
    *puVar3 = uVar2;
    puVar3[1] = uVar2;
    *param_1 = puVar3;
    if (1 < iVar1) {
      do {
        uVar2 = param_1[1];
        puVar4 = (undefined4 *)(param_1[7] * iVar5 + (int)puVar3);
        iVar5 = iVar5 + 1;
        *puVar4 = uVar2;
        puVar4[1] = uVar2;
        param_1[1] = puVar4;
      } while (iVar5 < iVar1);
    }
    return param_2;
  }
  return 0;
}



undefined4 __cdecl FUN_1003e220(int param_1,char *param_2,char *param_3,char *param_4,uint param_5)

{
  undefined4 *puVar1;
  int *piVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined4 *puVar7;
  char cVar8;
  undefined4 *puVar9;
  char *pcVar10;
  int iVar11;
  int aiStack_80 [32];
  
  if ((int)param_3 < 0) {
    pcVar3 = param_2;
    do {
      cVar8 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar8 != '\0');
    param_3 = pcVar3 + (1 - (int)(param_2 + 1));
  }
  if (*(int *)(param_1 + 0xc) < (int)param_3) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x14) < (int)param_5) {
    return 0xfffffffe;
  }
  if ((*(int *)(param_1 + 4) == 0) && (iVar4 = FUN_1003e1b0(param_1,0x400), iVar4 < 1)) {
    return 0xfffffffd;
  }
  puVar1 = *(undefined4 **)(param_1 + 4);
  *(undefined1 *)((int)puVar1 + 0xb) = (undefined1)param_5;
  *(char *)((int)puVar1 + 10) = (char)param_3;
  uVar6 = (uint)param_3 >> 2;
  pcVar3 = (char *)(puVar1 + 3);
  *(undefined1 *)(puVar1 + 2) = 0;
  pcVar10 = pcVar3;
  for (; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar10 = *(undefined4 *)param_2;
    param_2 = param_2 + 4;
    pcVar10 = pcVar10 + 4;
  }
  for (uVar6 = (uint)param_3 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
    *pcVar10 = *param_2;
    param_2 = param_2 + 1;
    pcVar10 = pcVar10 + 1;
  }
  if ((param_4 != (char *)0x0) && (0 < (int)param_5)) {
    pcVar10 = pcVar3 + *(int *)(param_1 + 0x10);
    for (uVar6 = param_5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)pcVar10 = *(undefined4 *)param_4;
      param_4 = param_4 + 4;
      pcVar10 = pcVar10 + 4;
    }
    for (uVar6 = param_5 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
      *pcVar10 = *param_4;
      param_4 = param_4 + 1;
      pcVar10 = pcVar10 + 1;
    }
  }
  puVar9 = *(undefined4 **)(param_1 + 8);
  iVar4 = 0;
  if (puVar9 == (undefined4 *)0x0) {
    *(undefined4 **)(param_1 + 8) = puVar1;
    *(undefined4 *)(param_1 + 4) = *puVar1;
    puVar1[1] = 0;
    *puVar1 = 0;
    return 1;
  }
  do {
    iVar11 = iVar4;
    aiStack_80[iVar11] = (int)puVar9;
    iVar5 = (**(code **)(param_1 + 0x20))(pcVar3,puVar9 + 3);
    if (iVar5 < 0) {
      puVar9 = (undefined4 *)*puVar9;
    }
    else {
      if (iVar5 < 1) {
        return 0;
      }
      puVar9 = (undefined4 *)puVar9[1];
    }
    iVar4 = iVar11 + 1;
  } while (puVar9 != (undefined4 *)0x0);
  if (iVar5 < 0) {
    *(undefined4 *)aiStack_80[iVar11] = puVar1;
  }
  else {
    ((undefined4 *)aiStack_80[iVar11])[1] = puVar1;
  }
  *(undefined4 *)(param_1 + 4) = *puVar1;
  puVar9 = (undefined4 *)aiStack_80[iVar11];
  puVar1[1] = 0;
  *puVar1 = 0;
  cVar8 = *(char *)(puVar9 + 2) + ((undefined4 *)*puVar9 != puVar1) * '\x02' + -1;
  *(char *)(puVar9 + 2) = cVar8;
  while( true ) {
    if ((cVar8 < -1) || ('\x01' < *(char *)(puVar9 + 2))) {
      puVar1 = (undefined4 *)aiStack_80[iVar11 + 1];
      iVar4 = (int)*(char *)(puVar1 + 2) + (int)*(char *)(puVar9 + 2);
      if (iVar4 == -3) {
        *(undefined1 *)(puVar9 + 2) = 0;
        *(undefined1 *)(puVar1 + 2) = 0;
        *puVar9 = puVar1[1];
        puVar1[1] = puVar9;
        puVar7 = puVar1;
      }
      else if (iVar4 == -1) {
        puVar7 = (undefined4 *)puVar1[1];
        *puVar9 = puVar7[1];
        puVar1[1] = *puVar7;
        puVar7[1] = puVar9;
        *puVar7 = puVar1;
        *(bool *)(puVar9 + 2) = *(char *)(puVar7 + 2) == -1;
        *(char *)(puVar1 + 2) = (*(char *)(puVar7 + 2) != '\x01') + -1;
        *(undefined1 *)(puVar7 + 2) = 0;
      }
      else if (iVar4 == 1) {
        puVar7 = (undefined4 *)*puVar1;
        puVar9[1] = *puVar7;
        *puVar1 = puVar7[1];
        *puVar7 = puVar9;
        puVar7[1] = puVar1;
        *(char *)(puVar9 + 2) = (*(char *)(puVar7 + 2) != '\x01') + -1;
        *(bool *)(puVar1 + 2) = *(char *)(puVar7 + 2) == -1;
        *(undefined1 *)(puVar7 + 2) = 0;
      }
      else {
        puVar7 = (undefined4 *)0x0;
        if (iVar4 == 3) {
          *(undefined1 *)(puVar9 + 2) = 0;
          *(undefined1 *)(puVar1 + 2) = 0;
          puVar9[1] = *puVar1;
          *puVar1 = puVar9;
          puVar7 = puVar1;
        }
      }
      if (iVar11 == 0) {
        *(undefined4 **)(param_1 + 8) = puVar7;
        return 1;
      }
      piVar2 = (int *)aiStack_80[iVar11 + -1];
      if (*piVar2 == aiStack_80[iVar11]) {
        *piVar2 = (int)puVar7;
        return 1;
      }
      piVar2[1] = (int)puVar7;
      return 1;
    }
    if (*(char *)(puVar9 + 2) == '\0') {
      return 1;
    }
    if (iVar11 == 0) break;
    puVar1 = (undefined4 *)aiStack_80[iVar11 + -1];
    iVar11 = iVar11 + -1;
    cVar8 = *(char *)(puVar1 + 2) + ((undefined4 *)*puVar1 != puVar9) * '\x02' + -1;
    *(char *)(puVar1 + 2) = cVar8;
    puVar9 = puVar1;
  }
  return 1;
}



int __cdecl FUN_1003e4f0(int param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  puVar1 = *(undefined4 **)(param_1 + 8);
  while( true ) {
    while( true ) {
      if (puVar1 == (undefined4 *)0x0) {
        return 0;
      }
      iVar2 = (**(code **)(param_1 + 0x20))(param_2,puVar1 + 3);
      if (-1 < iVar2) break;
      puVar1 = (undefined4 *)*puVar1;
    }
    if (iVar2 < 1) break;
    puVar1 = (undefined4 *)puVar1[1];
  }
  return *(int *)(param_1 + 0x10) + 0xc + (int)puVar1;
}



undefined4 * __cdecl FUN_1003e530(int param_1,int param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  uint uVar3;
  
  puVar1 = (undefined4 *)_malloc(0x24);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[4] = 0;
  puVar1[5] = 0;
  puVar1[6] = 0;
  puVar1[7] = 0;
  puVar1[8] = 0;
  puVar1[3] = param_1;
  puVar1[5] = param_2;
  uVar2 = param_1 + 3U & 0x7ffc;
  uVar3 = param_2 + 3U & 0x7ffc;
  puVar1[4] = uVar2;
  puVar1[6] = uVar3;
  puVar1[7] = uVar3 + 0xc + uVar2;
  puVar1[8] = FUN_10025580;
  FUN_1003e1b0(puVar1,0x100);
  return puVar1;
}



int FUN_1003e5a0(void)

{
  char cVar1;
  byte bVar2;
  char *pcVar3;
  int iVar4;
  byte *pbVar5;
  undefined4 *unaff_ESI;
  
  pcVar3 = (char *)unaff_ESI[0x102];
  cVar1 = *pcVar3;
  iVar4 = 0;
  if (cVar1 != '%') {
    if ((cVar1 == '#') || (cVar1 == '$')) {
      pbVar5 = (byte *)(pcVar3 + 1);
      bVar2 = *pbVar5;
      while (('/' < (char)bVar2 && ((char)bVar2 < ':'))) {
        pbVar5 = pbVar5 + 1;
        iVar4 = (bVar2 & 0xf) + iVar4 * 10;
        bVar2 = *pbVar5;
      }
    }
    return iVar4;
  }
  iVar4 = 0;
  pbVar5 = FUN_100020f0((byte *)*unaff_ESI,(byte *)(pcVar3 + 1));
  iVar4 = FUN_10002480((char *)pbVar5,iVar4);
  return iVar4;
}



int __fastcall FUN_1003e600(undefined4 *param_1)

{
  char cVar1;
  char *pcVar2;
  byte *pbVar3;
  char *pcVar4;
  int iVar5;
  byte *pbVar6;
  byte *pbVar7;
  
  pcVar2 = (char *)param_1[0x102];
  cVar1 = *pcVar2;
  if (cVar1 == '%') {
    pbVar7 = &DAT_1004d26f;
    iVar5 = param_1[0x103] + -1;
    pbVar6 = (byte *)(pcVar2 + 1);
    pbVar3 = FUN_100020f0((byte *)*param_1,pbVar6);
    iVar5 = FUN_10002a30(pbVar3,pbVar6,iVar5,pbVar7);
    *pcVar2 = '$';
    return iVar5;
  }
  if ((cVar1 != '$') && (cVar1 != '#')) {
    *pcVar2 = '$';
    pcVar2[1] = '\0';
    return 0;
  }
  pcVar4 = pcVar2 + 1;
  *pcVar2 = '$';
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  return (int)pcVar4 - (int)(pcVar2 + 2);
}



byte * __cdecl FUN_1003e670(int param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  
  pbVar2 = *(byte **)(param_1 + 0x408);
  bVar1 = *param_2;
  while ((bVar1 != 0 && ((char)bVar1 < '!'))) {
    pbVar4 = param_2 + 1;
    param_2 = param_2 + 1;
    bVar1 = *pbVar4;
  }
  bVar1 = *param_2;
  if (bVar1 == 0x28) {
    pbVar2 = FUN_1003f010((undefined4 *)param_1,param_2 + 1);
    bVar1 = *pbVar2;
    while ((bVar1 != 0 && ((char)bVar1 < '!'))) {
      pbVar4 = pbVar2 + 1;
      pbVar2 = pbVar2 + 1;
      bVar1 = *pbVar4;
    }
    if (*pbVar2 == 0x29) {
      return pbVar2 + 1;
    }
  }
  else {
    if (bVar1 == 0x21) {
      pbVar2 = FUN_1003e670(param_1,param_2 + 1);
      iVar3 = FUN_1003e5a0();
      _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,(uint)(iVar3 == 0));
      return pbVar2;
    }
    if (bVar1 != 0x22) {
      if ((((char)bVar1 < '0') || ('9' < (char)bVar1)) && (bVar1 != 0x2d)) {
        if ((char)bVar1 < '@') {
          *pbVar2 = 0;
          pbVar2[1] = 0;
          return param_2;
        }
        *pbVar2 = 0x25;
        while( true ) {
          pbVar2 = pbVar2 + 1;
          bVar1 = *param_2;
          if ((((char)bVar1 < '0') || ('9' < (char)bVar1)) && ((char)bVar1 < '@')) break;
          *pbVar2 = bVar1;
          param_2 = param_2 + 1;
        }
      }
      else {
        *pbVar2 = 0x23;
        pbVar2[1] = *param_2;
        pbVar2 = pbVar2 + 2;
        bVar1 = param_2[1];
        pbVar4 = param_2;
        while ((param_2 = pbVar4 + 1, '/' < (char)bVar1 && ((char)bVar1 < ':'))) {
          *pbVar2 = bVar1;
          pbVar2 = pbVar2 + 1;
          bVar1 = pbVar4[2];
          pbVar4 = param_2;
        }
      }
      *pbVar2 = 0;
      return param_2;
    }
    *pbVar2 = 0x24;
    FUN_10002a30(param_2,pbVar2 + 1,*(int *)(param_1 + 0x40c) + -1,&DAT_1004d26f);
    bVar1 = param_2[1];
    while (pbVar2 = param_2 + 1, '\x1f' < (char)bVar1) {
      if (bVar1 == 0x22) goto LAB_1003e738;
      bVar1 = param_2[2];
      param_2 = pbVar2;
    }
    if (*pbVar2 == 0x22) {
LAB_1003e738:
      return param_2 + 2;
    }
  }
  return pbVar2;
}



byte * __cdecl FUN_1003e7b0(int param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  
  pbVar3 = FUN_1003e670(param_1,param_2);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar3;
  if ((bVar2 == 0x2a) && (pbVar3[1] != 0x2a)) {
    iVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003e7b0(param_1,pbVar3 + 1);
    iVar5 = FUN_1003e5a0();
    _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,iVar5 * iVar4);
    return pbVar3;
  }
  if ((bVar2 == 0x2f) && (pbVar3[1] != 0x2f)) {
    iVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003e7b0(param_1,pbVar3 + 1);
    iVar5 = FUN_1003e5a0();
    if (iVar5 != 0) {
      _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,iVar4 / iVar5);
      return pbVar3;
    }
    _sprintf(*(char **)(param_1 + 0x408),"%cDIV0",0x23);
    return pbVar3;
  }
  if ((bVar2 == 0x25) && (pbVar3[1] != 0x25)) {
    iVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003e7b0(param_1,pbVar3 + 1);
    iVar5 = FUN_1003e5a0();
    if (iVar5 != 0) {
      _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,iVar4 % iVar5);
      return pbVar3;
    }
    _sprintf(*(char **)(param_1 + 0x408),"%cMOD0",0x23);
  }
  return pbVar3;
}



byte * __cdecl FUN_1003e900(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  undefined1 uVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  
  pbVar4 = FUN_1003e7b0((int)param_1,param_2);
  bVar2 = *pbVar4;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar4 + 1;
    pbVar4 = pbVar4 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar4;
  if (bVar2 != 0x2b) {
    if (bVar2 == 0x2d) {
      iVar5 = FUN_1003e5a0();
      pbVar4 = FUN_1003e900(param_1,pbVar4 + 1);
      iVar6 = FUN_1003e5a0();
      _sprintf((char *)param_1[0x102],"%c%d",0x23,iVar5 - iVar6);
      return pbVar4;
    }
    if (bVar2 == 0x23) {
      iVar6 = FUN_1003e600(param_1);
      iVar5 = param_1[0x102];
      param_1[0x102] = (undefined1 *)(iVar5 + iVar6);
      param_1[0x103] = param_1[0x103] - iVar6;
      uVar3 = *(undefined1 *)(iVar5 + iVar6);
      pbVar4 = FUN_1003e900(param_1,pbVar4 + 1);
      FUN_1003e600(param_1);
      *(undefined1 *)param_1[0x102] = uVar3;
      param_1[0x102] = param_1[0x102] - iVar6;
      param_1[0x103] = param_1[0x103] + iVar6;
    }
    return pbVar4;
  }
  iVar5 = FUN_1003e5a0();
  pbVar4 = FUN_1003e900(param_1,pbVar4 + 1);
  iVar6 = FUN_1003e5a0();
  _sprintf((char *)param_1[0x102],"%c%d",0x23,iVar6 + iVar5);
  return pbVar4;
}



byte * __cdecl FUN_1003ea10(undefined4 *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  int iVar6;
  byte *_Dest;
  uint uVar7;
  char *pcVar8;
  bool bVar9;
  
  pbVar2 = FUN_1003e900(param_1,param_2);
  bVar1 = *pbVar2;
  while ((bVar1 != 0 && ((char)bVar1 < '!'))) {
    pbVar5 = pbVar2 + 1;
    pbVar2 = pbVar2 + 1;
    bVar1 = *pbVar5;
  }
  bVar1 = *pbVar2;
  if ((bVar1 == 0x3d) && (pbVar2[1] == 0x3d)) {
    iVar3 = FUN_1003e600(param_1);
    iVar3 = iVar3 + 2;
    param_1[0x102] = param_1[0x102] + iVar3;
    param_1[0x103] = param_1[0x103] - iVar3;
    pbVar4 = FUN_1003e900(param_1,pbVar2 + 2);
    FUN_1003e600(param_1);
    _Dest = (byte *)(param_1[0x102] - iVar3);
    param_1[0x103] = param_1[0x103] + iVar3;
    param_1[0x102] = _Dest;
    pbVar2 = _Dest + iVar3;
    pbVar5 = _Dest;
    do {
      bVar1 = *pbVar5;
      bVar9 = bVar1 < *pbVar2;
      if (bVar1 != *pbVar2) {
LAB_1003eae0:
        uVar7 = (uint)(1 - bVar9 == (uint)(bVar9 != 0));
        goto LAB_1003eb93;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar5[1];
      bVar9 = bVar1 < pbVar2[1];
      if (bVar1 != pbVar2[1]) goto LAB_1003eae0;
      pbVar5 = pbVar5 + 2;
      pbVar2 = pbVar2 + 2;
    } while (bVar1 != 0);
    uVar7 = 1;
  }
  else {
    if ((bVar1 != 0x21) || (pbVar2[1] != 0x3d)) {
      if ((bVar1 == 0x7e) && (pbVar2[1] == 0x3d)) {
        iVar3 = FUN_1003e600(param_1);
        iVar3 = iVar3 + 2;
        param_1[0x102] = param_1[0x102] + iVar3;
        param_1[0x103] = param_1[0x103] - iVar3;
        pbVar2 = FUN_1003e900(param_1,pbVar2 + 2);
        FUN_1003e600(param_1);
        pcVar8 = (char *)(param_1[0x102] - iVar3);
        param_1[0x103] = param_1[0x103] + iVar3;
        param_1[0x102] = pcVar8;
        pcVar8 = _strstr(pcVar8,pcVar8 + iVar3);
        _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)(pcVar8 != (char *)0x0));
        return pbVar2;
      }
      if (bVar1 == 0x3c) {
        if (pbVar2[1] != 0x3d) {
          iVar3 = FUN_1003e5a0();
          pbVar2 = FUN_1003ea10(param_1,pbVar2 + 1);
          iVar6 = FUN_1003e5a0();
          _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)(iVar3 < iVar6));
          return pbVar2;
        }
        iVar3 = FUN_1003e5a0();
        pbVar2 = FUN_1003ea10(param_1,pbVar2 + 2);
        iVar6 = FUN_1003e5a0();
        bVar9 = iVar3 <= iVar6;
      }
      else {
        if (bVar1 != 0x3e) {
          return pbVar2;
        }
        if (pbVar2[1] != 0x3d) {
          iVar3 = FUN_1003e5a0();
          pbVar2 = FUN_1003ea10(param_1,pbVar2 + 1);
          iVar6 = FUN_1003e5a0();
          _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)(iVar6 < iVar3));
          return pbVar2;
        }
        iVar3 = FUN_1003e5a0();
        pbVar2 = FUN_1003ea10(param_1,pbVar2 + 2);
        iVar6 = FUN_1003e5a0();
        bVar9 = iVar6 <= iVar3;
      }
      _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)bVar9);
      return pbVar2;
    }
    iVar3 = FUN_1003e600(param_1);
    iVar3 = iVar3 + 2;
    param_1[0x102] = param_1[0x102] + iVar3;
    param_1[0x103] = param_1[0x103] - iVar3;
    pbVar4 = FUN_1003e900(param_1,pbVar2 + 2);
    FUN_1003e600(param_1);
    _Dest = (byte *)(param_1[0x102] - iVar3);
    param_1[0x103] = param_1[0x103] + iVar3;
    param_1[0x102] = _Dest;
    pbVar2 = _Dest + iVar3;
    pbVar5 = _Dest;
    do {
      bVar1 = *pbVar5;
      bVar9 = bVar1 < *pbVar2;
      if (bVar1 != *pbVar2) {
LAB_1003eb87:
        iVar3 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
        goto LAB_1003eb8c;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar5[1];
      bVar9 = bVar1 < pbVar2[1];
      if (bVar1 != pbVar2[1]) goto LAB_1003eb87;
      pbVar5 = pbVar5 + 2;
      pbVar2 = pbVar2 + 2;
    } while (bVar1 != 0);
    iVar3 = 0;
LAB_1003eb8c:
    uVar7 = (uint)(iVar3 != 0);
  }
LAB_1003eb93:
  _sprintf((char *)_Dest,"%c%d",0x23,uVar7);
  return pbVar4;
}



byte * __cdecl FUN_1003ed40(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  uint uVar4;
  uint uVar5;
  
  pbVar3 = FUN_1003ea10(param_1,param_2);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar3;
  if ((bVar2 == 0x26) && (pbVar3[1] != 0x26)) {
    uVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003ed40(param_1,pbVar3 + 1);
    uVar5 = FUN_1003e5a0();
    _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar5 & uVar4);
    return pbVar3;
  }
  if ((bVar2 == 0x7c) && (pbVar3[1] != 0x7c)) {
    uVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003ed40(param_1,pbVar3 + 1);
    uVar5 = FUN_1003e5a0();
    _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar5 | uVar4);
    return pbVar3;
  }
  if (bVar2 == 0x5e) {
    uVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003ed40(param_1,pbVar3 + 1);
    uVar5 = FUN_1003e5a0();
    _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar5 ^ uVar4);
  }
  return pbVar3;
}



byte * __cdecl FUN_1003ee30(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  
  pbVar3 = FUN_1003ed40(param_1,param_2);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  if ((*pbVar3 == 0x26) && (pbVar3[1] == 0x26)) {
    iVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003ee30(param_1,pbVar3 + 2);
    if ((iVar4 != 0) && (iVar4 = FUN_1003e5a0(), iVar4 != 0)) {
      _sprintf((char *)param_1[0x102],"%c%d",0x23,1);
      return pbVar3;
    }
    _sprintf((char *)param_1[0x102],"%c%d",0x23,0);
    return pbVar3;
  }
  if ((*pbVar3 == 0x7c) && (pbVar3[1] == 0x7c)) {
    iVar4 = FUN_1003e5a0();
    pbVar3 = FUN_1003ee30(param_1,pbVar3 + 2);
    if ((iVar4 != 0) || (iVar4 = FUN_1003e5a0(), iVar4 != 0)) {
      iVar4 = 1;
    }
    _sprintf((char *)param_1[0x102],"%c%d",0x23,iVar4);
  }
  return pbVar3;
}



byte * __cdecl FUN_1003ef20(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  char *pcVar2;
  byte bVar3;
  char cVar4;
  byte *pbVar5;
  char *pcVar6;
  char *pcVar7;
  
  pbVar5 = FUN_1003ee30(param_1,param_2);
  bVar3 = *pbVar5;
  while ((bVar3 != 0 && ((char)bVar3 < '!'))) {
    pbVar1 = pbVar5 + 1;
    pbVar5 = pbVar5 + 1;
    bVar3 = *pbVar1;
  }
  if ((*pbVar5 == 0x3d) && (pbVar5[1] != 0x3d)) {
    pcVar6 = (char *)param_1[0x102];
    pcVar7 = pcVar6 + 1;
    do {
      cVar4 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar4 != '\0');
    pcVar6 = pcVar6 + (1 - (int)pcVar7);
    param_1[0x102] = pcVar6 + param_1[0x102];
    param_1[0x103] = param_1[0x103] - (int)pcVar6;
    pbVar5 = FUN_1003ef20(param_1,pbVar5 + 1);
    FUN_1003e600(param_1);
    FUN_10003cf0((byte *)*param_1,param_1[1],(byte *)((param_1[0x102] - (int)pcVar6) + 1),
                 (byte *)(param_1[0x102] + 1));
    pcVar7 = (char *)(param_1[0x102] - (int)pcVar6);
    param_1[0x102] = pcVar7;
    param_1[0x103] = pcVar6 + param_1[0x103];
    cVar4 = pcVar7[(int)pcVar6];
    while (cVar4 != '\0') {
      *pcVar7 = cVar4;
      pcVar2 = pcVar7 + (int)(pcVar6 + 1);
      pcVar7 = pcVar7 + 1;
      cVar4 = *pcVar2;
    }
    *pcVar7 = '\0';
  }
  return pbVar5;
}



byte * __cdecl FUN_1003f010(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  char cVar3;
  byte *pbVar4;
  int iVar5;
  char *pcVar6;
  
  pbVar4 = FUN_1003ef20(param_1,param_2);
  bVar2 = *pbVar4;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar4 + 1;
    pbVar4 = pbVar4 + 1;
    bVar2 = *pbVar1;
  }
  if (*pbVar4 == 0x3f) {
    iVar5 = FUN_1003e5a0();
    pbVar4 = FUN_1003f010(param_1,pbVar4 + 1);
    bVar2 = *pbVar4;
    while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
      pbVar1 = pbVar4 + 1;
      pbVar4 = pbVar4 + 1;
      bVar2 = *pbVar1;
    }
    if (iVar5 == 0) {
      pcVar6 = (char *)0x0;
    }
    else {
      pcVar6 = (char *)(param_1 + 2);
      do {
        cVar3 = *pcVar6;
        pcVar6 = pcVar6 + 1;
      } while (cVar3 != '\0');
      pcVar6 = pcVar6 + (1 - ((int)param_1 + 9));
    }
    if (*pbVar4 == 0x3a) {
      param_1[0x102] = pcVar6 + param_1[0x102];
      param_1[0x103] = param_1[0x103] - (int)pcVar6;
      pbVar4 = FUN_1003f010(param_1,pbVar4 + 1);
      param_1[0x102] = param_1[0x102] - (int)pcVar6;
      param_1[0x103] = pcVar6 + param_1[0x103];
    }
    return pbVar4;
  }
  return pbVar4;
}



void __fastcall FUN_1003f0e0(undefined4 *param_1)

{
  byte *pbVar1;
  byte bVar2;
  byte *in_EAX;
  byte *pbVar3;
  
  pbVar3 = FUN_1003f010(param_1,in_EAX);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  if (*pbVar3 == 0x3b) {
    bVar2 = pbVar3[1];
    while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
      bVar2 = pbVar3[2];
      pbVar3 = pbVar3 + 1;
    }
  }
  return;
}



int __cdecl
FUN_1003f120(undefined4 param_1,undefined4 param_2,byte *param_3,char *param_4,int param_5)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  bool bVar5;
  undefined4 local_410;
  undefined4 local_40c;
  undefined1 local_408 [1024];
  undefined1 *local_8;
  undefined4 local_4;
  
  local_8 = local_408;
  bVar2 = *param_3;
  local_4 = 0x400;
  local_410 = param_1;
  local_40c = param_2;
  pbVar3 = param_3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar4 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar4;
  }
  if (*pbVar3 == 0x7b) {
    pbVar4 = pbVar3 + 1;
    while( true ) {
      pbVar3 = FUN_1003f010(&local_410,pbVar4);
      bVar2 = *pbVar3;
      while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
        pbVar1 = pbVar3 + 1;
        pbVar3 = pbVar3 + 1;
        bVar2 = *pbVar1;
      }
      if (*pbVar3 == 0x3b) {
        bVar2 = pbVar3[1];
        while ((pbVar3 = pbVar3 + 1, bVar2 != 0 && ((char)bVar2 < '!'))) {
          bVar2 = pbVar3[1];
        }
      }
      if (*pbVar3 == 0) goto LAB_1003f1fb;
      if (*pbVar3 == 0x7d) break;
      bVar5 = pbVar3 == pbVar4;
      pbVar4 = pbVar3;
      if (bVar5) {
        pbVar4 = pbVar3 + 1;
      }
    }
    pbVar3 = pbVar3 + 1;
  }
  else if (*pbVar3 == 0x28) {
    pbVar3 = (byte *)FUN_1003f0e0(&local_410);
    if (*pbVar3 == 0x29) {
      pbVar3 = pbVar3 + 1;
    }
  }
  else {
    pbVar3 = (byte *)FUN_1003f0e0(&local_410);
  }
LAB_1003f1fb:
  if (param_4 != (char *)0x0) {
    FUN_1003e600(&local_410);
    FUN_100020b0(param_4,param_5,local_8 + 1);
  }
  for (; (pbVar3 != param_3 && ((char)pbVar3[-1] < '!')); pbVar3 = pbVar3 + -1) {
  }
  return (int)pbVar3 - (int)param_3;
}



undefined4 * __cdecl
FUN_1003f280(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            ,undefined4 param_6,undefined4 param_7)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  
  if (param_1 < 1) {
    param_1 = 10;
  }
  puVar1 = (undefined4 *)_malloc(0x30);
  puVar2 = puVar1;
  for (iVar3 = 0xc; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  puVar1[1] = param_1;
  puVar2 = (undefined4 *)_malloc(param_1 * 4);
  *puVar1 = puVar2;
  for (uVar4 = puVar1[1] & 0x3fffffff; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  puVar1[6] = param_2;
  puVar1[8] = param_3;
  puVar1[7] = param_4;
  puVar1[9] = param_5;
  puVar1[10] = param_6;
  puVar1[0xb] = param_7;
  return puVar1;
}



void __cdecl FUN_1003f310(undefined4 *param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  
  if (param_1 != (undefined4 *)0x0) {
    if ((param_1[0x1969] != 0) && (iVar3 = param_1[1], iVar3 < (int)param_1[4])) {
      puVar2 = param_1 + iVar3 * 4 + 5;
      piVar1 = param_1 + iVar3 + 0x7d5;
      do {
        if (*piVar1 != 0) {
          (*(code *)param_1[0x1969])(puVar2,*piVar1);
        }
        iVar3 = iVar3 + 1;
        piVar1 = piVar1 + 1;
        puVar2 = puVar2 + 4;
      } while (iVar3 < (int)param_1[4]);
    }
    for (iVar3 = 0x1b5e; iVar3 != 0; iVar3 = iVar3 + -1) {
      *param_1 = 0;
      param_1 = param_1 + 1;
    }
  }
  return;
}



void __cdecl FUN_1003f370(undefined4 *param_1)

{
  if (param_1 != (undefined4 *)0x0) {
    FUN_1003f310(param_1);
    _free(param_1);
  }
  return;
}



void __cdecl FUN_1003f390(int *param_1)

{
  undefined4 *_Memory;
  int iVar1;
  
  if (param_1 != (int *)0x0) {
    iVar1 = 0;
    if (0 < param_1[2]) {
      do {
        _Memory = *(undefined4 **)(*param_1 + iVar1 * 4);
        if (_Memory != (undefined4 *)0x0) {
          FUN_1003f310(_Memory);
          _free(_Memory);
        }
        iVar1 = iVar1 + 1;
      } while (iVar1 < param_1[2]);
    }
    _free((void *)*param_1);
    _free(param_1);
  }
  return;
}



uint __cdecl FUN_1003f3e0(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  uint uVar5;
  int iVar6;
  uint local_18 [6];
  
  uVar5 = param_1[2];
  uVar2 = (uint)((*param_1 & param_1[1]) == (param_1[1] & *param_2));
  if ((int)uVar5 < 7) {
    if ((int)uVar5 < 1) {
      return uVar2;
    }
  }
  else {
    uVar5 = 6;
  }
  iVar6 = 0;
  if (0 < (int)uVar5) {
    puVar4 = param_2 + 3;
    do {
      uVar1 = *(uint *)(((int)param_1 - (int)param_2) + (int)puVar4);
      uVar3 = uVar1 >> 3;
      switch(uVar1 & 3) {
      case 0:
        local_18[iVar6] = (uint)(*puVar4 == uVar3);
        break;
      case 1:
        local_18[iVar6] = (uint)(*puVar4 != uVar3);
        break;
      case 2:
        local_18[iVar6] = (uint)((int)*puVar4 <= (int)uVar3);
        break;
      case 3:
        local_18[iVar6] = (uint)((int)uVar3 <= (int)*puVar4);
        break;
      default:
        local_18[iVar6] = 1;
      }
      iVar6 = iVar6 + 1;
      puVar4 = puVar4 + 1;
    } while (iVar6 < (int)uVar5);
  }
  iVar6 = 1;
  if (1 < (int)uVar5) {
    puVar4 = param_1 + 4;
    do {
      if ((*puVar4 & 4) == 0) {
        local_18[0] = local_18[0] & local_18[iVar6];
      }
      else if ((*puVar4 & 4) == 4) {
        local_18[0] = local_18[0] | local_18[iVar6];
      }
      iVar6 = iVar6 + 1;
      puVar4 = puVar4 + 1;
    } while (iVar6 < (int)uVar5);
  }
  if ((param_1[3] & 4) != 0) {
    if ((param_1[3] & 4) != 4) {
      return local_18[0];
    }
    return local_18[0] | uVar2;
  }
  return local_18[0] & uVar2;
}



int WSAGetLastError(void)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f500. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSAGetLastError();
  return iVar1;
}



void WSACreateEvent(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f506. Too many branches
                    // WARNING: Treating indirect jump as call
  WSACreateEvent();
  return;
}



int setsockopt(SOCKET s,int level,int optname,char *optval,int optlen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f50c. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = setsockopt(s,level,optname,optval,optlen);
  return iVar1;
}



int ioctlsocket(SOCKET s,long cmd,u_long *argp)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f512. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = ioctlsocket(s,cmd,argp);
  return iVar1;
}



SOCKET socket(int af,int type,int protocol)

{
  SOCKET SVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f518. Too many branches
                    // WARNING: Treating indirect jump as call
  SVar1 = socket(af,type,protocol);
  return SVar1;
}



void WSACloseEvent(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f51e. Too many branches
                    // WARNING: Treating indirect jump as call
  WSACloseEvent();
  return;
}



void WSARecv(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f524. Too many branches
                    // WARNING: Treating indirect jump as call
  WSARecv();
  return;
}



void WSARecvFrom(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f52a. Too many branches
                    // WARNING: Treating indirect jump as call
  WSARecvFrom();
  return;
}



void WSAResetEvent(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f530. Too many branches
                    // WARNING: Treating indirect jump as call
  WSAResetEvent();
  return;
}



void WSAWaitForMultipleEvents(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f536. Too many branches
                    // WARNING: Treating indirect jump as call
  WSAWaitForMultipleEvents();
  return;
}



void WSAGetOverlappedResult(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f53c. Too many branches
                    // WARNING: Treating indirect jump as call
  WSAGetOverlappedResult();
  return;
}



int WSAStartup(WORD wVersionRequired,LPWSADATA lpWSAData)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f542. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSAStartup(wVersionRequired,lpWSAData);
  return iVar1;
}



int closesocket(SOCKET s)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f548. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = closesocket(s);
  return iVar1;
}



int shutdown(SOCKET s,int how)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f54e. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = shutdown(s,how);
  return iVar1;
}



void WSASetEvent(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f554. Too many branches
                    // WARNING: Treating indirect jump as call
  WSASetEvent();
  return;
}



int bind(SOCKET s,sockaddr *addr,int namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f55a. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = bind(s,addr,namelen);
  return iVar1;
}



int connect(SOCKET s,sockaddr *name,int namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f560. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = connect(s,name,namelen);
  return iVar1;
}



int sendto(SOCKET s,char *buf,int len,int flags,sockaddr *to,int tolen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f566. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = sendto(s,buf,len,flags,to,tolen);
  return iVar1;
}



int send(SOCKET s,char *buf,int len,int flags)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f56c. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = send(s,buf,len,flags);
  return iVar1;
}



int recv(SOCKET s,char *buf,int len,int flags)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f572. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = recv(s,buf,len,flags);
  return iVar1;
}



int recvfrom(SOCKET s,char *buf,int len,int flags,sockaddr *from,int *fromlen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f578. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = recvfrom(s,buf,len,flags,from,fromlen);
  return iVar1;
}



int getsockname(SOCKET s,sockaddr *name,int *namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f57e. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = getsockname(s,name,namelen);
  return iVar1;
}



hostent * gethostbyname(char *name)

{
  hostent *phVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f584. Too many branches
                    // WARNING: Treating indirect jump as call
  phVar1 = gethostbyname(name);
  return phVar1;
}



int gethostname(char *name,int namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f58a. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = gethostname(name,namelen);
  return iVar1;
}



void WSAIoctl(void)

{
                    // WARNING: Could not recover jumptable at 0x1003f590. Too many branches
                    // WARNING: Treating indirect jump as call
  WSAIoctl();
  return;
}



int WSACleanup(void)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f596. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSACleanup();
  return iVar1;
}



int __WSAFDIsSet(SOCKET param_1,fd_set *param_2)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1003f59c. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = __WSAFDIsSet(param_1,param_2);
  return iVar1;
}



float10 __cdecl FUN_1003f5a2(int param_1,int param_2)

{
  return (float10)(param_1 - param_2);
}



// Library Function - Multiple Matches With Different Base Names
//  __time32
//  _time
// 
// Libraries: Visual Studio 2003 Release, Visual Studio 2005 Release

__time32_t __cdecl FID_conflict___time32(__time32_t *_Time)

{
  undefined8 uVar1;
  _FILETIME local_c;
  
  GetSystemTimeAsFileTime(&local_c);
  uVar1 = __aulldiv(local_c.dwLowDateTime + 0x2ac18000,
                    local_c.dwHighDateTime + 0xfe624e21 + (uint)(0xd53e7fff < local_c.dwLowDateTime)
                    ,10000000,0);
  if (_Time != (__time32_t *)0x0) {
    *_Time = (__time32_t)uVar1;
  }
  return (__time32_t)uVar1;
}



void FUN_1003f5ed(void)

{
  PTR___fptrap_10057850 = __cfltcvt;
  PTR___fptrap_10057854 = &LAB_10042114;
  PTR___fptrap_10057858 = __fassign;
  PTR___fptrap_1005785c = __forcdecpt;
  PTR___fptrap_10057860 = &LAB_1004215f;
  PTR___fptrap_10057864 = __cfltcvt;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __fpmath
// 
// Library: Visual Studio 2003 Release

void __cdecl __fpmath(int param_1)

{
  FUN_1003f5ed();
  _DAT_10068e00 = __ms_p5_mp_test_fdiv();
  if (param_1 != 0) {
    __setdefaultprecision();
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  public: virtual __thiscall type_info::~type_info(void)
// 
// Library: Visual Studio 2003 Release

void __thiscall type_info::~type_info(type_info *this)

{
  *(undefined ***)this = &vftable;
  __lock(0xe);
  if (*(void **)(this + 4) != (void *)0x0) {
    _free(*(void **)(this + 4));
  }
  FUN_1003f680();
  return;
}



void FUN_1003f680(void)

{
  FUN_100425f0(0xe);
  return;
}



// Library Function - Single Match
//  public: virtual void * __thiscall type_info::`scalar deleting destructor'(unsigned int)
// 
// Library: Visual Studio 2003 Release

void * __thiscall type_info::_scalar_deleting_destructor_(type_info *this,uint param_1)

{
  ~type_info(this);
  if ((param_1 & 1) != 0) {
    _free(this);
  }
  return this;
}



// Library Function - Single Match
//  _sprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl _sprintf(char *_Dest,char *_Format,...)

{
  int iVar1;
  FILE local_24;
  
  local_24._cnt = 0x7fffffff;
  local_24._flag = 0x42;
  local_24._base = _Dest;
  local_24._ptr = _Dest;
  iVar1 = __output(&local_24,(byte *)_Format,(wchar_t *)&stack0x0000000c);
  if (_Dest != (char *)0x0) {
    local_24._cnt = local_24._cnt + -1;
    if (local_24._cnt < 0) {
      __flsbuf(0,&local_24);
    }
    else {
      *local_24._ptr = '\0';
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  void __stdcall _JumpToContinuation(void *,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

void _JumpToContinuation(void *param_1,EHRegistrationNode *param_2)

{
                    // WARNING: Load size is inaccurate
  ExceptionList = *ExceptionList;
                    // WARNING: Could not recover jumptable at 0x1003f726. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)param_1)();
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  void __stdcall _CallMemberFunction1(void *,void *,void *)
//  void __stdcall _CallMemberFunction2(void *,void *,void *,int)
// 
// Library: Visual Studio 2003 Release

void FID_conflict__CallMemberFunction1(undefined4 param_1,undefined *UNRECOVERED_JUMPTABLE)

{
  LOCK();
  UNLOCK();
                    // WARNING: Could not recover jumptable at 0x1003f732. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)UNRECOVERED_JUMPTABLE)();
  return;
}



// Library Function - Single Match
//  void __stdcall _UnwindNestedFrames(struct EHRegistrationNode *,struct EHExceptionRecord *)
// 
// Library: Visual Studio 2003 Release

void _UnwindNestedFrames(EHRegistrationNode *param_1,EHExceptionRecord *param_2)

{
  void *pvVar1;
  
  pvVar1 = ExceptionList;
  RtlUnwind(param_1,(PVOID)0x1003f75d,(PEXCEPTION_RECORD)param_2,(PVOID)0x0);
  *(uint *)(param_2 + 4) = *(uint *)(param_2 + 4) & 0xfffffffd;
  *(void **)pvVar1 = ExceptionList;
  ExceptionList = pvVar1;
  return;
}



// Library Function - Single Match
//  ___CxxFrameHandler
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl
___CxxFrameHandler(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,
                  void *param_4)

{
  _s_FuncInfo *in_EAX;
  undefined4 uVar1;
  
  uVar1 = ___InternalCxxFrameHandler
                    (param_1,param_2,param_3,param_4,in_EAX,0,(EHRegistrationNode *)0x0,'\0');
  return uVar1;
}



// Library Function - Single Match
//  int __cdecl _CallSETranslator(struct EHExceptionRecord *,struct EHRegistrationNode *,void *,void
// *,struct _s_FuncInfo const *,int,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

int __cdecl
_CallSETranslator(EHExceptionRecord *param_1,EHRegistrationNode *param_2,void *param_3,void *param_4
                 ,_s_FuncInfo *param_5,int param_6,EHRegistrationNode *param_7)

{
  _ptiddata p_Var1;
  undefined4 uVar2;
  EHExceptionRecord **ppEVar3;
  int local_38;
  EHExceptionRecord *local_34;
  void *local_30;
  undefined4 *local_2c;
  code *local_28;
  undefined4 local_24;
  _s_FuncInfo *local_20;
  EHRegistrationNode *local_1c;
  int local_18;
  EHRegistrationNode *local_14;
  undefined1 *local_10;
  undefined1 *local_c;
  int local_8;
  
  local_c = &stack0xfffffffc;
  local_10 = &stack0xffffffc4;
  if (param_1 == (EHExceptionRecord *)0x123) {
    *(undefined4 *)param_2 = 0x1003f892;
    local_38 = 1;
  }
  else {
    local_28 = TranslatorGuardHandler;
    local_24 = DAT_10057438;
    local_20 = param_5;
    local_1c = param_2;
    local_18 = param_6;
    local_14 = param_7;
    local_8 = 0;
    local_2c = (undefined4 *)ExceptionList;
    ExceptionList = &local_2c;
    local_34 = param_1;
    local_30 = param_3;
    ppEVar3 = &local_34;
    uVar2 = *(undefined4 *)param_1;
    p_Var1 = __getptd();
    (*(code *)p_Var1->_NLG_dwCode)(uVar2,ppEVar3);
    local_38 = 0;
    if (local_8 != 0) {
                    // WARNING: Load size is inaccurate
      *local_2c = *ExceptionList;
    }
    ExceptionList = local_2c;
  }
  return local_38;
}



// Library Function - Single Match
//  enum _EXCEPTION_DISPOSITION __cdecl TranslatorGuardHandler(struct EHExceptionRecord *,struct
// TranslatorGuardRN *,void *,void *)
// 
// Library: Visual Studio 2003 Release

_EXCEPTION_DISPOSITION __cdecl
TranslatorGuardHandler
          (EHExceptionRecord *param_1,TranslatorGuardRN *param_2,void *param_3,void *param_4)

{
  _EXCEPTION_DISPOSITION _Var1;
  code *local_8;
  
  if (*(int *)(param_2 + 8) == DAT_10057438) {
    if ((*(uint *)(param_1 + 4) & 0x66) == 0) {
      ___InternalCxxFrameHandler
                (param_1,*(EHRegistrationNode **)(param_2 + 0x10),(_CONTEXT *)param_3,(void *)0x0,
                 *(_s_FuncInfo **)(param_2 + 0xc),*(int *)(param_2 + 0x14),
                 *(EHRegistrationNode **)(param_2 + 0x18),'\x01');
      if (*(int *)(param_2 + 0x24) == 0) {
        _UnwindNestedFrames((EHRegistrationNode *)param_2,param_1);
      }
      _CallSETranslator((EHExceptionRecord *)0x123,(EHRegistrationNode *)&local_8,(void *)0x0,
                        (void *)0x0,(_s_FuncInfo *)0x0,0,(EHRegistrationNode *)0x0);
                    // WARNING: Could not recover jumptable at 0x1003f968. Too many branches
                    // WARNING: Treating indirect jump as call
      _Var1 = (*local_8)();
      return _Var1;
    }
    *(undefined4 *)(param_2 + 0x24) = 1;
  }
  else {
    *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 8;
  }
  return 1;
}



// Library Function - Single Match
//  struct _s_TryBlockMapEntry const * __cdecl _GetRangeOfTrysToCheck(struct _s_FuncInfo const
// *,int,int,unsigned int *,unsigned int *)
// 
// Library: Visual Studio 2003 Release

_s_TryBlockMapEntry * __cdecl
_GetRangeOfTrysToCheck(_s_FuncInfo *param_1,int param_2,int param_3,uint *param_4,uint *param_5)

{
  TryBlockMapEntry *pTVar1;
  _s_FuncInfo *p_Var2;
  _s_FuncInfo *p_Var3;
  _s_FuncInfo *local_8;
  
  p_Var2 = param_1;
  local_8 = (_s_FuncInfo *)param_1->nTryBlocks;
  pTVar1 = param_1->pTryBlockMap;
  p_Var3 = local_8;
  param_1 = local_8;
  if (-1 < param_2) {
    do {
      if (p_Var3 == (_s_FuncInfo *)0xffffffff) {
        _inconsistency();
      }
      p_Var3 = (_s_FuncInfo *)((int)&p_Var3[-1].pIPToStateMap + 3);
      if (((pTVar1[(int)p_Var3].tryHigh < param_3) && (param_3 <= pTVar1[(int)p_Var3].catchHigh)) ||
         (p_Var3 == (_s_FuncInfo *)0xffffffff)) {
        param_2 = param_2 + -1;
        local_8 = param_1;
        param_1 = p_Var3;
      }
    } while (-1 < param_2);
  }
  p_Var3 = (_s_FuncInfo *)((int)&p_Var3->magicNumber_and_bbtFlags + 1);
  *param_4 = (uint)p_Var3;
  *param_5 = (uint)local_8;
  if (((_s_FuncInfo *)p_Var2->nTryBlocks < local_8) || (local_8 < p_Var3)) {
    _inconsistency();
  }
  return pTVar1 + (int)p_Var3;
}



// Library Function - Single Match
//  struct FrameInfo * __cdecl _CreateFrameInfo(struct FrameInfo *,void *)
// 
// Library: Visual Studio 2003 Release

FrameInfo * __cdecl _CreateFrameInfo(FrameInfo *param_1,void *param_2)

{
  _ptiddata p_Var1;
  
  *(void **)param_1 = param_2;
  p_Var1 = __getptd();
  *(void **)(param_1 + 4) = p_Var1->_curexception;
  p_Var1 = __getptd();
  p_Var1->_curexception = param_1;
  return param_1;
}



// Library Function - Single Match
//  int __cdecl IsExceptionObjectToBeDestroyed(void *)
// 
// Library: Visual Studio 2003 Release

int __cdecl IsExceptionObjectToBeDestroyed(void *param_1)

{
  _ptiddata p_Var1;
  int *piVar2;
  
  p_Var1 = __getptd();
  piVar2 = (int *)p_Var1->_curexception;
  while( true ) {
    if (piVar2 == (int *)0x0) {
      return 1;
    }
    if ((void *)*piVar2 == param_1) break;
    piVar2 = (int *)piVar2[1];
  }
  return 0;
}



// Library Function - Single Match
//  void __cdecl _FindAndUnlinkFrame(struct FrameInfo *)
// 
// Library: Visual Studio 2003 Release

void __cdecl _FindAndUnlinkFrame(FrameInfo *param_1)

{
  FrameInfo *pFVar1;
  _ptiddata p_Var2;
  FrameInfo *pFVar3;
  
  p_Var2 = __getptd();
  if (param_1 == (FrameInfo *)p_Var2->_curexception) {
    p_Var2 = __getptd();
    p_Var2->_curexception = *(void **)(param_1 + 4);
    return;
  }
  p_Var2 = __getptd();
  pFVar1 = (FrameInfo *)p_Var2->_curexception;
  do {
    pFVar3 = pFVar1;
    if (*(int *)(pFVar3 + 4) == 0) {
      _inconsistency();
      return;
    }
    pFVar1 = *(FrameInfo **)(pFVar3 + 4);
  } while (param_1 != *(FrameInfo **)(pFVar3 + 4));
  *(undefined4 *)(pFVar3 + 4) = *(undefined4 *)(param_1 + 4);
  return;
}



// Library Function - Single Match
//  void * __cdecl _CallCatchBlock2(struct EHRegistrationNode *,struct _s_FuncInfo const *,void
// *,int,unsigned long)
// 
// Library: Visual Studio 2003 Release

void * __cdecl
_CallCatchBlock2(EHRegistrationNode *param_1,_s_FuncInfo *param_2,void *param_3,int param_4,
                ulong param_5)

{
  void *pvVar1;
  void *local_1c;
  undefined1 *local_18;
  undefined4 local_14;
  _s_FuncInfo *local_10;
  EHRegistrationNode *local_c;
  int local_8;
  
  local_14 = DAT_10057438;
  local_10 = param_2;
  local_8 = param_4 + 1;
  local_18 = &LAB_1003f7bc;
  local_c = param_1;
  local_1c = ExceptionList;
  ExceptionList = &local_1c;
  pvVar1 = (void *)__CallSettingFrame_12(param_3,param_1,param_5);
  ExceptionList = local_1c;
  return pvVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// Library Function - Single Match
//  _report_failure
// 
// Library: Visual Studio 2003 Release

void __cdecl report_failure(void)

{
  ___security_error_handler(1);
                    // WARNING: Subroutine does not return
  ExitProcess(3);
}



void __fastcall FUN_1003fb09(int param_1)

{
  if (param_1 == DAT_10057438) {
    return;
  }
  report_failure();
  return;
}



// Library Function - Single Match
//  __global_unwind2
// 
// Library: Visual Studio

void __cdecl __global_unwind2(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x1003fb30,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



// Library Function - Single Match
//  __local_unwind2
// 
// Library: Visual Studio 2003 Release

void __cdecl __local_unwind2(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *pvStack_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  int iStack_10;
  
  iStack_10 = param_1;
  puStack_18 = &LAB_1003fb38;
  pvStack_1c = ExceptionList;
  ExceptionList = &pvStack_1c;
  while( true ) {
    iVar1 = *(int *)(param_1 + 8);
    iVar2 = *(int *)(param_1 + 0xc);
    if ((iVar2 == -1) || (iVar2 == param_2)) break;
    local_14 = *(undefined4 *)(iVar1 + iVar2 * 0xc);
    *(undefined4 *)(param_1 + 0xc) = local_14;
    if (*(int *)(iVar1 + 4 + iVar2 * 0xc) == 0) {
      FUN_1003fbee();
      (**(code **)(iVar1 + 8 + iVar2 * 0xc))();
    }
  }
  ExceptionList = pvStack_1c;
  return;
}



// Library Function - Single Match
//  __abnormal_termination
// 
// Library: Visual Studio 2003 Release

int __cdecl __abnormal_termination(void)

{
  int iVar1;
  
  iVar1 = 0;
  if ((*(undefined1 **)((int)ExceptionList + 4) == &LAB_1003fb38) &&
     (*(int *)((int)ExceptionList + 8) == *(int *)(*(int *)((int)ExceptionList + 0xc) + 0xc))) {
    iVar1 = 1;
  }
  return iVar1;
}



// Library Function - Single Match
//  __NLG_Notify1
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void __fastcall __NLG_Notify1(undefined4 param_1)

{
  undefined4 in_EAX;
  undefined4 unaff_EBP;
  
  DAT_10057444 = param_1;
  DAT_10057440 = in_EAX;
  DAT_10057448 = unaff_EBP;
  return;
}



void FUN_1003fbee(void)

{
  undefined4 in_EAX;
  int unaff_EBP;
  
  DAT_10057444 = *(undefined4 *)(unaff_EBP + 8);
  DAT_10057440 = in_EAX;
  DAT_10057448 = unaff_EBP;
  return;
}



ulonglong FUN_1003fc08(void)

{
  ulonglong uVar1;
  uint uVar2;
  float fVar3;
  float10 in_ST0;
  undefined4 local_20;
  undefined4 uStack_1c;
  
  uVar1 = (ulonglong)ROUND(in_ST0);
  local_20 = (uint)uVar1;
  uStack_1c = (float)(uVar1 >> 0x20);
  fVar3 = (float)in_ST0;
  if ((local_20 != 0) || (fVar3 = uStack_1c, (uVar1 & 0x7fffffff00000000) != 0)) {
    if ((int)fVar3 < 0) {
      uVar1 = uVar1 + (0x80000000 < (uint)-(float)(in_ST0 - (float10)(longlong)uVar1));
    }
    else {
      uVar2 = (uint)(0x80000000 < (uint)(float)(in_ST0 - (float10)(longlong)uVar1));
      uVar1 = CONCAT44((int)uStack_1c - (uint)(local_20 < uVar2),local_20 - uVar2);
    }
  }
  return uVar1;
}



// Library Function - Single Match
//  __CxxThrowException@8
// 
// Library: Visual Studio 2003 Release

void __CxxThrowException_8(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  DWORD *pDVar2;
  DWORD *pDVar3;
  DWORD local_24 [4];
  DWORD local_14;
  ULONG_PTR local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  pDVar2 = &DAT_100545c4;
  pDVar3 = local_24;
  for (iVar1 = 8; iVar1 != 0; iVar1 = iVar1 + -1) {
    *pDVar3 = *pDVar2;
    pDVar2 = pDVar2 + 1;
    pDVar3 = pDVar3 + 1;
  }
  local_c = param_1;
  local_8 = param_2;
  RaiseException(local_24[0],local_24[1],local_14,&local_10);
  return;
}



// Library Function - Single Match
//  _strncpy
// 
// Library: Visual Studio 2003 Release

char * __cdecl _strncpy(char *_Dest,char *_Source,size_t _Count)

{
  uint uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  
  if (_Count == 0) {
    return _Dest;
  }
  puVar5 = (uint *)_Dest;
  if (((uint)_Source & 3) != 0) {
    while( true ) {
      uVar4 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 1);
      *(char *)puVar5 = (char)uVar4;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
      if (_Count == 0) {
        return _Dest;
      }
      if ((char)uVar4 == '\0') break;
      if (((uint)_Source & 3) == 0) {
        uVar4 = _Count >> 2;
        goto joined_r0x1003fd0c;
      }
    }
    do {
      if (((uint)puVar5 & 3) == 0) {
        uVar4 = _Count >> 2;
        cVar3 = '\0';
        if (uVar4 == 0) goto LAB_1003fd53;
        goto LAB_1003fdc9;
      }
      *(char *)puVar5 = '\0';
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
    } while (_Count != 0);
    return _Dest;
  }
  uVar4 = _Count >> 2;
  if (uVar4 != 0) {
    do {
      uVar1 = *(uint *)_Source;
      uVar2 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 4);
      if (((uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff) & 0x81010100) != 0) {
        if ((char)uVar2 == '\0') {
          *puVar5 = 0;
joined_r0x1003fdc5:
          while( true ) {
            uVar4 = uVar4 - 1;
            puVar5 = puVar5 + 1;
            if (uVar4 == 0) break;
LAB_1003fdc9:
            *puVar5 = 0;
          }
          cVar3 = '\0';
          _Count = _Count & 3;
          if (_Count != 0) goto LAB_1003fd53;
          return _Dest;
        }
        if ((char)(uVar2 >> 8) == '\0') {
          *puVar5 = uVar2 & 0xff;
          goto joined_r0x1003fdc5;
        }
        if ((uVar2 & 0xff0000) == 0) {
          *puVar5 = uVar2 & 0xffff;
          goto joined_r0x1003fdc5;
        }
        if ((uVar2 & 0xff000000) == 0) {
          *puVar5 = uVar2;
          goto joined_r0x1003fdc5;
        }
      }
      *puVar5 = uVar2;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
joined_r0x1003fd0c:
    } while (uVar4 != 0);
    _Count = _Count & 3;
    if (_Count == 0) {
      return _Dest;
    }
  }
  do {
    cVar3 = (char)*(uint *)_Source;
    _Source = (char *)((int)_Source + 1);
    *(char *)puVar5 = cVar3;
    puVar5 = (uint *)((int)puVar5 + 1);
    if (cVar3 == '\0') {
      while (_Count = _Count - 1, _Count != 0) {
LAB_1003fd53:
        *(char *)puVar5 = cVar3;
        puVar5 = (uint *)((int)puVar5 + 1);
      }
      return _Dest;
    }
    _Count = _Count - 1;
  } while (_Count != 0);
  return _Dest;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __CRT_INIT@12
// 
// Library: Visual Studio 2003 Release

undefined4 __CRT_INIT_12(undefined4 param_1,int param_2)

{
  BOOL BVar1;
  int iVar2;
  _ptiddata _Ptd;
  DWORD DVar3;
  DWORD local_9c;
  DWORD local_98;
  DWORD local_94;
  uint local_90;
  DWORD local_8c;
  CHAR aCStack_18 [4];
  pthreadlocinfo _Locale;
  
  if (param_2 == 1) {
    local_9c = 0x94;
    BVar1 = GetVersionExA((LPOSVERSIONINFOA)&local_9c);
    if (BVar1 != 0) {
      DAT_1006903c = local_8c;
      DAT_10069048 = local_98;
      _DAT_1006904c = local_94;
      _DAT_10069040 = local_90 & 0x7fff;
      if (local_8c != 2) {
        _DAT_10069040 = _DAT_10069040 | 0x8000;
      }
      _DAT_10069044 = local_98 * 0x100 + local_94;
      iVar2 = __heap_init();
      if (iVar2 != 0) {
        iVar2 = __mtinit();
        if (iVar2 != 0) {
          __RTC_Initialize();
          DAT_1006a724 = GetCommandLineA();
          DAT_10068e08 = ___crtGetEnvironmentStringsA();
          iVar2 = __ioinit();
          if (-1 < iVar2) {
            iVar2 = __setargv();
            if (((-1 < iVar2) && (iVar2 = __setenvp(), -1 < iVar2)) &&
               (iVar2 = __cinit(0), iVar2 == 0)) {
              DAT_10068e04 = DAT_10068e04 + 1;
              return 1;
            }
            __ioterm();
          }
          __mtterm();
        }
        __heap_term();
      }
    }
  }
  else if (param_2 == 0) {
    if (0 < DAT_10068e04) {
      DAT_10068e04 = DAT_10068e04 + -1;
      if (DAT_10069078 == 0) {
        __cexit();
      }
      __ioterm();
      __mtterm();
      __heap_term();
      return 1;
    }
  }
  else {
    if (param_2 != 2) {
      if (param_2 != 3) {
        return 1;
      }
      __freeptd((_ptiddata)0x0);
      return 1;
    }
    _Ptd = (_ptiddata)_calloc(1,0x8c);
    if (_Ptd != (_ptiddata)0x0) {
      _Locale = DAT_10057994;
      iVar2 = (*DAT_10069028)();
      if (iVar2 != 0) {
        aCStack_18[0] = '4';
        aCStack_18[1] = -1;
        aCStack_18[2] = '\x03';
        aCStack_18[3] = '\x10';
        __initptd(_Ptd,_Locale);
        DVar3 = GetCurrentThreadId();
        _Ptd->_thandle = 0xffffffff;
        _Ptd->_tid = DVar3;
        return 1;
      }
      aCStack_18[0] = 'H';
      aCStack_18[1] = -1;
      aCStack_18[2] = '\x03';
      aCStack_18[3] = '\x10';
      _free(_Ptd);
    }
  }
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3

int entry(undefined4 param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  int local_20;
  
  local_20 = 1;
  if ((param_2 == 0) && (DAT_10068e04 == 0)) {
LAB_1004003f:
    local_20 = 0;
  }
  else {
    if ((param_2 == 1) || (param_2 == 2)) {
      if (DAT_1006a728 != (code *)0x0) {
        local_20 = (*DAT_1006a728)(param_1,param_2,param_3);
      }
      if ((local_20 == 0) || (iVar1 = __CRT_INIT_12(param_1,param_2), iVar1 == 0))
      goto LAB_1004003f;
    }
    local_20 = FUN_10001560(param_1,param_2);
    if ((param_2 == 1) && (local_20 == 0)) {
      __CRT_INIT_12(param_1,0);
    }
    if ((param_2 == 0) || (param_2 == 3)) {
      iVar1 = __CRT_INIT_12(param_1,param_2);
      if (iVar1 == 0) {
        local_20 = 0;
      }
      if ((local_20 != 0) && (DAT_1006a728 != (code *)0x0)) {
        local_20 = (*DAT_1006a728)(param_1,param_2,param_3);
      }
    }
  }
  return local_20;
}



// Library Function - Single Match
//  __amsg_exit
// 
// Library: Visual Studio 2003 Release

void __cdecl __amsg_exit(int param_1)

{
  if ((DAT_10068e10 == 1) || ((DAT_10068e10 == 0 && (DAT_10068e14 == 1)))) {
    __FF_MSGBANNER();
  }
  __NMSG_WRITE(param_1);
  (*(code *)PTR___exit_10057450)(0xff);
  return;
}



// Library Function - Single Match
//  _strchr
// 
// Library: Visual Studio 2003 Release

char * __cdecl _strchr(char *_Str,int _Val)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar1 = (uint)_Str & 3;
  while (uVar1 != 0) {
    if ((char)*(uint *)_Str == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)*(uint *)_Str == '\0') {
      return (char *)0x0;
    }
    uVar1 = (uint)((int)_Str + 1) & 3;
    _Str = (char *)((int)_Str + 1);
  }
  while( true ) {
    while( true ) {
      uVar1 = *(uint *)_Str;
      uVar4 = uVar1 ^ CONCAT22(CONCAT11((char)_Val,(char)_Val),CONCAT11((char)_Val,(char)_Val));
      uVar3 = uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff;
      puVar5 = (uint *)((int)_Str + 4);
      if (((uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff) & 0x81010100) != 0) break;
      _Str = (char *)puVar5;
      if ((uVar3 & 0x81010100) != 0) {
        if ((uVar3 & 0x1010100) != 0) {
          return (char *)0x0;
        }
        if ((uVar1 + 0x7efefeff & 0x80000000) == 0) {
          return (char *)0x0;
        }
      }
    }
    uVar1 = *(uint *)_Str;
    if ((char)uVar1 == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)uVar1 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 8);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 1);
    }
    if (cVar2 == '\0') break;
    cVar2 = (char)(uVar1 >> 0x10);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 2);
    }
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 0x18);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 3);
    }
    _Str = (char *)puVar5;
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
  }
  return (char *)0x0;
}



// Library Function - Single Match
//  _strstr
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

char * __cdecl _strstr(char *_Str,char *_SubStr)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  uint uVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  char *pcVar8;
  uint *puVar9;
  char *pcVar10;
  
  cVar3 = *_SubStr;
  if (cVar3 == '\0') {
    return _Str;
  }
  if (_SubStr[1] == '\0') {
    uVar4 = (uint)_Str & 3;
    while (uVar4 != 0) {
      if ((char)*(uint *)_Str == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)*(uint *)_Str == '\0') {
        return (char *)0x0;
      }
      uVar4 = (uint)((int)_Str + 1) & 3;
      _Str = (char *)((int)_Str + 1);
    }
    while( true ) {
      while( true ) {
        uVar4 = *(uint *)_Str;
        uVar7 = uVar4 ^ CONCAT22(CONCAT11(cVar3,cVar3),CONCAT11(cVar3,cVar3));
        uVar6 = uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff;
        puVar9 = (uint *)((int)_Str + 4);
        if (((uVar7 ^ 0xffffffff ^ uVar7 + 0x7efefeff) & 0x81010100) != 0) break;
        _Str = (char *)puVar9;
        if ((uVar6 & 0x81010100) != 0) {
          if ((uVar6 & 0x1010100) != 0) {
            return (char *)0x0;
          }
          if ((uVar4 + 0x7efefeff & 0x80000000) == 0) {
            return (char *)0x0;
          }
        }
      }
      uVar4 = *(uint *)_Str;
      if ((char)uVar4 == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)uVar4 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 8);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 1);
      }
      if (cVar5 == '\0') break;
      cVar5 = (char)(uVar4 >> 0x10);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 2);
      }
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 0x18);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 3);
      }
      _Str = (char *)puVar9;
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
    }
    return (char *)0x0;
  }
  do {
    cVar5 = *_Str;
    do {
      while (_Str = _Str + 1, cVar5 != cVar3) {
        if (cVar5 == '\0') {
          return (char *)0x0;
        }
        cVar5 = *_Str;
      }
      cVar5 = *_Str;
      pcVar10 = _Str + 1;
      pcVar8 = _SubStr;
    } while (cVar5 != _SubStr[1]);
    do {
      if (pcVar8[2] == '\0') {
LAB_100401c9:
        return _Str + -1;
      }
      if (*pcVar10 != pcVar8[2]) break;
      pcVar1 = pcVar8 + 3;
      if (*pcVar1 == '\0') goto LAB_100401c9;
      pcVar2 = pcVar10 + 1;
      pcVar8 = pcVar8 + 2;
      pcVar10 = pcVar10 + 2;
    } while (*pcVar1 == *pcVar2);
  } while( true );
}



// Library Function - Single Match
//  __allmul
// 
// Library: Visual Studio 2003 Release

longlong __allmul(uint param_1,int param_2,uint param_3,int param_4)

{
  if (param_4 == 0 && param_2 == 0) {
    return (ulonglong)param_1 * (ulonglong)param_3;
  }
  return CONCAT44((int)((ulonglong)param_1 * (ulonglong)param_3 >> 0x20) +
                  param_2 * param_3 + param_1 * param_4,
                  (int)((ulonglong)param_1 * (ulonglong)param_3));
}



// Library Function - Single Match
//  __snprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl __snprintf(char *_Dest,size_t _Count,char *_Format,...)

{
  int iVar1;
  FILE local_24;
  
  local_24._cnt = _Count;
  local_24._flag = 0x42;
  local_24._base = _Dest;
  local_24._ptr = _Dest;
  iVar1 = __output(&local_24,(byte *)_Format,(wchar_t *)&stack0x00000010);
  if (_Dest != (char *)0x0) {
    local_24._cnt = local_24._cnt - 1;
    if (local_24._cnt < 0) {
      __flsbuf(0,&local_24);
    }
    else {
      *local_24._ptr = '\0';
    }
  }
  return iVar1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _localtime
// 
// Library: Visual Studio 2003 Release

tm * __cdecl _localtime(time_t *_Time)

{
  time_t *_Time_00;
  tm *_Time_01;
  int iVar1;
  
  _Time_00 = _Time;
  if ((int)*_Time < 0) {
    _Time_01 = (tm *)0x0;
  }
  else {
    ___tzset();
    iVar1 = (int)*_Time_00;
    if ((iVar1 < 0x3f481) || (0x7ffc0b7e < iVar1)) {
      _Time_01 = _gmtime(_Time_00);
      if ((DAT_10057aec == 0) || (iVar1 = __isindst(_Time_01), iVar1 == 0)) {
        _Time = (time_t *)(_Time_01->tm_sec - _DAT_10057ae8);
      }
      else {
        _Time = (time_t *)((_Time_01->tm_sec - DAT_10057af0) - _DAT_10057ae8);
        _Time_01->tm_isdst = 1;
      }
      iVar1 = (int)_Time % 0x3c;
      _Time_01->tm_sec = iVar1;
      if (iVar1 < 0) {
        _Time_01->tm_sec = iVar1 + 0x3c;
        _Time = (time_t *)((int)_Time + -0x3c);
      }
      _Time = (time_t *)((int)_Time / 0x3c + _Time_01->tm_min);
      iVar1 = (int)_Time % 0x3c;
      _Time_01->tm_min = iVar1;
      if (iVar1 < 0) {
        _Time_01->tm_min = iVar1 + 0x3c;
        _Time = (time_t *)((int)_Time + -0x3c);
      }
      _Time = (time_t *)((int)_Time / 0x3c + _Time_01->tm_hour);
      iVar1 = (int)_Time % 0x18;
      _Time_01->tm_hour = iVar1;
      if (iVar1 < 0) {
        _Time_01->tm_hour = iVar1 + 0x18;
        _Time = _Time + -3;
      }
      iVar1 = (int)_Time / 0x18;
      if (iVar1 < 1) {
        if (-1 < iVar1) {
          return _Time_01;
        }
        _Time_01->tm_wday = (_Time_01->tm_wday + 7 + iVar1) % 7;
        _Time_01->tm_mday = _Time_01->tm_mday + iVar1;
        if (_Time_01->tm_mday < 1) {
          _Time_01->tm_year = _Time_01->tm_year + -1;
          _Time_01->tm_mday = _Time_01->tm_mday + 0x1f;
          _Time_01->tm_yday = 0x16c;
          _Time_01->tm_mon = 0xb;
          return _Time_01;
        }
      }
      else {
        _Time_01->tm_wday = (_Time_01->tm_wday + iVar1) % 7;
        _Time_01->tm_mday = _Time_01->tm_mday + iVar1;
      }
      _Time_01->tm_yday = _Time_01->tm_yday + iVar1;
    }
    else {
      _Time = (time_t *)(iVar1 - _DAT_10057ae8);
      _Time_01 = _gmtime((time_t *)&_Time);
      if ((DAT_10057aec != 0) && (iVar1 = __isindst(_Time_01), iVar1 != 0)) {
        _Time = (time_t *)((int)_Time - DAT_10057af0);
        _Time_01 = _gmtime((time_t *)&_Time);
        _Time_01->tm_isdst = 1;
      }
    }
  }
  return _Time_01;
}



// Library Function - Single Match
//  _gmtime
// 
// Library: Visual Studio 2003 Release

tm * __cdecl _gmtime(time_t *_Time)

{
  bool bVar1;
  _ptiddata p_Var2;
  void *pvVar3;
  tm *ptVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  undefined4 *puVar9;
  
  iVar8 = (int)*_Time;
  bVar1 = false;
  p_Var2 = __getptd();
  if (iVar8 < 0) {
    return (tm *)0x0;
  }
  if (p_Var2->_gmtimebuf == (void *)0x0) {
    pvVar3 = _malloc(0x24);
    p_Var2->_gmtimebuf = pvVar3;
    ptVar4 = (tm *)&DAT_10068e18;
    if (pvVar3 == (void *)0x0) goto LAB_10040455;
  }
  ptVar4 = (tm *)p_Var2->_gmtimebuf;
LAB_10040455:
  iVar6 = iVar8 % 0x7861f80;
  iVar8 = (iVar8 / 0x7861f80) * 4;
  iVar5 = iVar8 + 0x46;
  iVar7 = iVar6;
  if (0x1e1337f < iVar6) {
    iVar7 = iVar6 + -0x1e13380;
    iVar5 = iVar8 + 0x47;
    if (0x1e1337f < iVar7) {
      iVar7 = iVar6 + -0x3c26700;
      iVar5 = iVar8 + 0x48;
      if (iVar7 < 0x1e28500) {
        bVar1 = true;
      }
      else {
        iVar5 = iVar8 + 0x49;
        iVar7 = iVar6 + -0x5a4ec00;
      }
    }
  }
  ptVar4->tm_year = iVar5;
  puVar9 = (undefined4 *)&DAT_10057b98;
  ptVar4->tm_yday = iVar7 / 0x15180;
  if (!bVar1) {
    puVar9 = &DAT_10057bcc;
  }
  iVar5 = 1;
  iVar8 = puVar9[1];
  while (iVar8 < ptVar4->tm_yday) {
    iVar5 = iVar5 + 1;
    iVar8 = puVar9[iVar5];
  }
  ptVar4->tm_mon = iVar5 + -1;
  ptVar4->tm_mday = ptVar4->tm_yday - puVar9[iVar5 + -1];
  ptVar4->tm_wday = ((int)*_Time / 0x15180 + 4) % 7;
  ptVar4->tm_hour = (iVar7 % 0x15180) / 0xe10;
  iVar8 = (iVar7 % 0x15180) % 0xe10;
  ptVar4->tm_min = iVar8 / 0x3c;
  ptVar4->tm_isdst = 0;
  ptVar4->tm_sec = iVar8 % 0x3c;
  return ptVar4;
}



// Library Function - Single Match
//  _strncmp
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

int __cdecl _strncmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  char cVar2;
  size_t sVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  
  sVar3 = _MaxCount;
  pcVar6 = _Str1;
  if (_MaxCount != 0) {
    do {
      if (sVar3 == 0) break;
      sVar3 = sVar3 - 1;
      cVar1 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar1 != '\0');
    iVar4 = _MaxCount - sVar3;
    do {
      pcVar6 = _Str2;
      pcVar7 = _Str1;
      if (iVar4 == 0) break;
      iVar4 = iVar4 + -1;
      pcVar7 = _Str1 + 1;
      pcVar6 = _Str2 + 1;
      cVar2 = *_Str1;
      cVar1 = *_Str2;
      _Str2 = pcVar6;
      _Str1 = pcVar7;
    } while (cVar1 == cVar2);
    uVar5 = 0;
    if ((byte)pcVar6[-1] <= (byte)pcVar7[-1]) {
      if (pcVar6[-1] == pcVar7[-1]) {
        return 0;
      }
      uVar5 = 0xfffffffe;
    }
    _MaxCount = ~uVar5;
  }
  return _MaxCount;
}



// WARNING: This is an inlined function
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  __chkstk
// 
// Library: Visual Studio 2003 Release

void __chkstk(void)

{
  uint in_EAX;
  undefined1 *puVar1;
  undefined4 unaff_retaddr;
  
  if (in_EAX < 0x1000) {
    *(undefined4 *)(&stack0x00000000 + -in_EAX) = unaff_retaddr;
    return;
  }
  puVar1 = &stack0x00000004;
  do {
    puVar1 = puVar1 + -0x1000;
    in_EAX = in_EAX - 0x1000;
  } while (0xfff < in_EAX);
  *(undefined4 *)(puVar1 + (-4 - in_EAX)) = unaff_retaddr;
  return;
}



// Library Function - Single Match
//  __vsnprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl __vsnprintf(char *_Dest,size_t _Count,char *_Format,va_list _Args)

{
  int iVar1;
  FILE local_24;
  
  local_24._cnt = _Count;
  local_24._flag = 0x42;
  local_24._base = _Dest;
  local_24._ptr = _Dest;
  iVar1 = __output(&local_24,(byte *)_Format,(wchar_t *)_Args);
  if (_Dest != (char *)0x0) {
    local_24._cnt = local_24._cnt - 1;
    if (local_24._cnt < 0) {
      __flsbuf(0,&local_24);
    }
    else {
      *local_24._ptr = '\0';
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  ___tolower_mt
// 
// Library: Visual Studio 2003 Release

uint __thiscall ___tolower_mt(void *this,int param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  LPCSTR _LpSrcStr;
  int iVar4;
  BOOL unaff_EDI;
  undefined4 local_8;
  
  uVar2 = param_2;
  iVar4 = param_1;
  if ((*(int *)(param_1 + 0x14) == 0) || ((*(int *)(param_1 + 0x24) != 0 && (param_2 < 0x80)))) {
    if ((0x40 < (int)param_2) && ((int)param_2 < 0x5b)) {
      return param_2 + 0x20;
    }
  }
  else {
    local_8 = this;
    if (param_2 < 0x100) {
      if (*(int *)(param_1 + 0x28) < 2) {
        uVar3 = *(byte *)(*(int *)(param_1 + 0x48) + param_2 * 2) & 1;
      }
      else {
        uVar3 = ___isctype_mt(this,param_1,param_2,1);
      }
      if (uVar3 == 0) {
        return uVar2;
      }
    }
    iVar1 = param_1;
    if ((*(byte *)(*(int *)(iVar4 + 0x48) + 1 + ((int)uVar2 >> 8 & 0xffU) * 2) & 0x80) == 0) {
      param_1._0_2_ = (ushort)(byte)uVar2;
      _LpSrcStr = (LPCSTR)0x1;
    }
    else {
      param_1._0_2_ = CONCAT11((byte)uVar2,(char)(uVar2 >> 8));
      param_1._3_1_ = SUB41(iVar1,3);
      param_1._0_3_ = (uint3)(ushort)param_1;
      _LpSrcStr = (LPCSTR)0x2;
    }
    iVar4 = ___crtLCMapStringA(*(_locale_t *)(iVar4 + 0x14),(LPCWSTR)0x100,(DWORD)&param_1,_LpSrcStr
                               ,(int)&local_8,(LPSTR)0x3,*(int *)(iVar4 + 4),1,unaff_EDI);
    if (iVar4 != 0) {
      if (iVar4 != 1) {
        return (uint)CONCAT11((undefined1)local_8,local_8._1_1_);
      }
      return (uint)local_8 & 0xff;
    }
  }
  return uVar2;
}



// Library Function - Single Match
//  _tolower
// 
// Library: Visual Studio 2003 Release

int __cdecl _tolower(int _C)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  uVar3 = ___tolower_mt(this,(int)ptVar2,_C);
  return uVar3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __heap_alloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl __heap_alloc(size_t _Size)

{
  int *piVar1;
  LPVOID pvVar2;
  
  if ((DAT_100695e0 == 3) && (_Size <= DAT_100695cc)) {
    __lock(4);
    piVar1 = ___sbh_alloc_block((uint *)_Size);
    FUN_1004075f();
    if (piVar1 != (int *)0x0) {
      return piVar1;
    }
  }
  if (_Size == 0) {
    _Size = 1;
  }
  if (DAT_100695e0 != 1) {
    _Size = _Size + 0xf & 0xfffffff0;
  }
  pvVar2 = HeapAlloc(DAT_100695dc,0,_Size);
  return pvVar2;
}



void FUN_1004075f(void)

{
  FUN_100425f0(4);
  return;
}



// Library Function - Single Match
//  __nh_malloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl __nh_malloc(size_t _Size,int _NhFlag)

{
  void *pvVar1;
  int iVar2;
  
  if (_Size < 0xffffffe1) {
    do {
      pvVar1 = __heap_alloc(_Size);
      if (pvVar1 != (void *)0x0) {
        return pvVar1;
      }
      if (_NhFlag == 0) {
        return (void *)0x0;
      }
      iVar2 = __callnewh(_Size);
    } while (iVar2 != 0);
  }
  return (void *)0x0;
}



// Library Function - Single Match
//  _malloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl _malloc(size_t _Size)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(_Size,DAT_1006925c);
  return pvVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _free
// 
// Library: Visual Studio 2003 Release

void __cdecl _free(void *_Memory)

{
  uint *puVar1;
  
  if (_Memory != (void *)0x0) {
    if (DAT_100695e0 == 3) {
      __lock(4);
      puVar1 = (uint *)___sbh_find_block((int)_Memory);
      if (puVar1 != (uint *)0x0) {
        ___sbh_free_block(puVar1,(int)_Memory);
      }
      FUN_100407f9();
      if (puVar1 != (uint *)0x0) {
        return;
      }
    }
    HeapFree(DAT_100695dc,0,_Memory);
  }
  return;
}



void FUN_100407f9(void)

{
  FUN_100425f0(4);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3

void __cdecl _free(void *_Memory)

{
  uint *puVar1;
  
  if (_Memory != (void *)0x0) {
    if (DAT_100695e0 == 3) {
      __lock(4);
      puVar1 = (uint *)___sbh_find_block((int)_Memory);
      if (puVar1 != (uint *)0x0) {
        ___sbh_free_block(puVar1,(int)_Memory);
      }
      FUN_100407f9();
      if (puVar1 != (uint *)0x0) {
        return;
      }
    }
    HeapFree(DAT_100695dc,0,_Memory);
  }
  return;
}



// Library Function - Single Match
//  void * __cdecl operator new(unsigned int)
// 
// Library: Visual Studio 2003 Release

void * __cdecl operator_new(uint param_1)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(param_1,1);
  return pvVar1;
}



// Library Function - Single Match
//  __fclose_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __fclose_lk(FILE *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar2 = -1;
  if ((param_1->_flag & 0x83) != 0) {
    iVar2 = __flush(param_1);
    __freebuf(param_1);
    iVar1 = __close(param_1->_file);
    if (iVar1 < 0) {
      iVar2 = -1;
    }
    else if (param_1->_tmpfname != (char *)0x0) {
      _free(param_1->_tmpfname);
      param_1->_tmpfname = (char *)0x0;
    }
  }
  param_1->_flag = 0;
  return iVar2;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fclose
// 
// Library: Visual Studio 2003 Release

int __cdecl _fclose(FILE *_File)

{
  int local_20;
  
  local_20 = -1;
  if ((_File->_flag & 0x40) == 0) {
    __lock_file(_File);
    local_20 = __fclose_lk(_File);
    FUN_100408bf();
  }
  else {
    _File->_flag = 0;
  }
  return local_20;
}



void FUN_100408bf(void)

{
  FILE *unaff_ESI;
  
  __unlock_file(unaff_ESI);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fgets
// 
// Library: Visual Studio 2003 Release

char * __cdecl _fgets(char *_Buf,int _MaxCount,FILE *_File)

{
  int *piVar1;
  uint uVar2;
  char *pcVar3;
  char *local_20;
  
  local_20 = _Buf;
  if (_MaxCount < 1) {
    local_20 = (char *)0x0;
  }
  else {
    __lock_file(_File);
    pcVar3 = _Buf;
    do {
      _MaxCount = _MaxCount + -1;
      if (_MaxCount == 0) break;
      piVar1 = &_File->_cnt;
      *piVar1 = *piVar1 + -1;
      if (*piVar1 < 0) {
        uVar2 = __filbuf(_File);
      }
      else {
        uVar2 = (uint)(byte)*_File->_ptr;
        _File->_ptr = _File->_ptr + 1;
      }
      if (uVar2 == 0xffffffff) {
        if (pcVar3 == _Buf) {
          local_20 = (char *)0x0;
          goto LAB_10040930;
        }
        break;
      }
      *pcVar3 = (char)uVar2;
      pcVar3 = pcVar3 + 1;
    } while ((char)uVar2 != '\n');
    *pcVar3 = '\0';
LAB_10040930:
    FUN_10040945();
  }
  return local_20;
}



void FUN_10040945(void)

{
  FILE *unaff_ESI;
  
  __unlock_file(unaff_ESI);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __fsopen
// 
// Library: Visual Studio 2003 Release

FILE * __cdecl __fsopen(char *_Filename,char *_Mode,int _ShFlag)

{
  FILE *pFVar1;
  int *piVar2;
  
  pFVar1 = __getstream();
  if (pFVar1 == (FILE *)0x0) {
    piVar2 = FUN_10041d35();
    *piVar2 = 0x18;
    pFVar1 = (FILE *)0x0;
  }
  else {
    pFVar1 = __openfile(_Filename,_Mode,_ShFlag,pFVar1);
    FUN_1004099f();
  }
  return pFVar1;
}



void FUN_1004099f(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + -0x1c));
  return;
}



void __cdecl FUN_100409a9(char *param_1,char *param_2)

{
  __fsopen(param_1,param_2,0x40);
  return;
}



// Library Function - Single Match
//  _atol
// 
// Library: Visual Studio 2003 Release

long __cdecl _atol(char *_Str)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  int iVar4;
  int *extraout_ECX;
  int *extraout_ECX_00;
  int *extraout_ECX_01;
  int *this;
  uint uVar5;
  int iVar6;
  byte *pbVar7;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  while( true ) {
    if ((int)ptVar2->lc_category[1].refcount < 2) {
      this = ptVar2->lc_category[3].refcount;
      uVar3 = *(byte *)((int)this + (uint)(byte)*_Str * 2) & 8;
    }
    else {
      uVar3 = ___isctype_mt(this,(int)ptVar2,(uint)(byte)*_Str,8);
      this = extraout_ECX_01;
    }
    if (uVar3 == 0) break;
    _Str = (char *)((byte *)_Str + 1);
  }
  uVar3 = (uint)(byte)*_Str;
  pbVar7 = (byte *)_Str + 1;
  if ((uVar3 == 0x2d) || (uVar5 = uVar3, uVar3 == 0x2b)) {
    uVar5 = (uint)*pbVar7;
    pbVar7 = (byte *)_Str + 2;
  }
  iVar4 = 0;
  while( true ) {
    if ((uVar5 < 0x30) || (0x39 < uVar5)) {
      iVar6 = -1;
    }
    else {
      iVar6 = uVar5 - 0x30;
    }
    if (iVar6 == -1) break;
    iVar4 = iVar6 + iVar4 * 10;
    uVar5 = (uint)*pbVar7;
    pbVar7 = pbVar7 + 1;
  }
  if (uVar3 == 0x2d) {
    iVar4 = -iVar4;
  }
  return iVar4;
}



long __cdecl _atol(char *_Str)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  int iVar4;
  int *extraout_ECX;
  int *extraout_ECX_00;
  int *extraout_ECX_01;
  int *this;
  uint uVar5;
  int iVar6;
  byte *pbVar7;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  while( true ) {
    if ((int)ptVar2->lc_category[1].refcount < 2) {
      this = ptVar2->lc_category[3].refcount;
      uVar3 = *(byte *)((int)this + (uint)(byte)*_Str * 2) & 8;
    }
    else {
      uVar3 = ___isctype_mt(this,(int)ptVar2,(uint)(byte)*_Str,8);
      this = extraout_ECX_01;
    }
    if (uVar3 == 0) break;
    _Str = (char *)((byte *)_Str + 1);
  }
  uVar3 = (uint)(byte)*_Str;
  pbVar7 = (byte *)_Str + 1;
  if ((uVar3 == 0x2d) || (uVar5 = uVar3, uVar3 == 0x2b)) {
    uVar5 = (uint)*pbVar7;
    pbVar7 = (byte *)_Str + 2;
  }
  iVar4 = 0;
  while( true ) {
    if ((uVar5 < 0x30) || (0x39 < uVar5)) {
      iVar6 = -1;
    }
    else {
      iVar6 = uVar5 - 0x30;
    }
    if (iVar6 == -1) break;
    iVar4 = iVar6 + iVar4 * 10;
    uVar5 = (uint)*pbVar7;
    pbVar7 = pbVar7 + 1;
  }
  if (uVar3 == 0x2d) {
    iVar4 = -iVar4;
  }
  return iVar4;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _realloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl _realloc(void *_Memory,size_t _NewSize)

{
  void *pvVar1;
  int iVar2;
  uint *puVar3;
  LPVOID pvVar4;
  uint *local_24;
  int *local_20;
  
  if (_Memory == (void *)0x0) {
    pvVar1 = _malloc(_NewSize);
  }
  else {
    if (_NewSize == 0) {
      _free(_Memory);
    }
    else if (DAT_100695e0 == 3) {
      do {
        local_20 = (int *)0x0;
        if (_NewSize < (uint *)0xffffffe1) {
          __lock(4);
          local_24 = (uint *)___sbh_find_block((int)_Memory);
          if (local_24 != (uint *)0x0) {
            if (_NewSize <= DAT_100695cc) {
              iVar2 = ___sbh_resize_block(local_24,(int)_Memory,_NewSize);
              if (iVar2 == 0) {
                local_20 = ___sbh_alloc_block((uint *)_NewSize);
                if (local_20 != (int *)0x0) {
                  puVar3 = (uint *)(*(int *)((int)_Memory + -4) - 1);
                  if (_NewSize <= puVar3) {
                    puVar3 = (uint *)_NewSize;
                  }
                  _memcpy(local_20,_Memory,(size_t)puVar3);
                  local_24 = (uint *)___sbh_find_block((int)_Memory);
                  ___sbh_free_block(local_24,(int)_Memory);
                }
              }
              else {
                local_20 = (int *)_Memory;
              }
            }
            if (local_20 == (int *)0x0) {
              if ((uint *)_NewSize == (uint *)0x0) {
                _NewSize = 1;
              }
              _NewSize = _NewSize + 0xf & 0xfffffff0;
              local_20 = (int *)HeapAlloc(DAT_100695dc,0,_NewSize);
              if (local_20 != (int *)0x0) {
                puVar3 = (uint *)(*(int *)((int)_Memory + -4) - 1);
                if (_NewSize <= puVar3) {
                  puVar3 = (uint *)_NewSize;
                }
                _memcpy(local_20,_Memory,(size_t)puVar3);
                ___sbh_free_block(local_24,(int)_Memory);
              }
            }
          }
          FUN_10040bb1();
          if (local_24 == (uint *)0x0) {
            if ((uint *)_NewSize == (uint *)0x0) {
              _NewSize = 1;
            }
            _NewSize = _NewSize + 0xf & 0xfffffff0;
            local_20 = (int *)HeapReAlloc(DAT_100695dc,0,_Memory,_NewSize);
          }
        }
        if (local_20 != (int *)0x0) {
          return local_20;
        }
        if (DAT_1006925c == 0) {
          return (void *)0x0;
        }
        iVar2 = __callnewh(_NewSize);
      } while (iVar2 != 0);
    }
    else {
      do {
        pvVar4 = (LPVOID)0x0;
        if (_NewSize < 0xffffffe1) {
          if (_NewSize == 0) {
            _NewSize = 1;
          }
          pvVar4 = HeapReAlloc(DAT_100695dc,0,_Memory,_NewSize);
        }
        if (pvVar4 != (LPVOID)0x0) {
          return pvVar4;
        }
        if (DAT_1006925c == 0) {
          return (void *)0x0;
        }
        iVar2 = __callnewh(_NewSize);
      } while (iVar2 != 0);
    }
    pvVar1 = (void *)0x0;
  }
  return pvVar1;
}



void FUN_10040bb1(void)

{
  FUN_100425f0(4);
  return;
}



// Library Function - Single Match
//  _shortsort
// 
// Library: Visual Studio 2003 Release

void __cdecl shortsort(undefined1 *param_1,int param_2,undefined *param_3)

{
  undefined1 uVar1;
  undefined1 *in_EAX;
  int iVar2;
  undefined1 *puVar3;
  undefined1 *puVar4;
  
  if (param_1 < in_EAX) {
    do {
      puVar3 = param_1;
      for (puVar4 = param_1 + param_2; puVar4 <= in_EAX; puVar4 = puVar4 + param_2) {
        iVar2 = (*(code *)param_3)(puVar4,puVar3);
        if (0 < iVar2) {
          puVar3 = puVar4;
        }
      }
      if ((puVar3 != in_EAX) && (param_2 != 0)) {
        puVar4 = in_EAX;
        iVar2 = param_2;
        do {
          uVar1 = puVar4[(int)puVar3 - (int)in_EAX];
          puVar4[(int)puVar3 - (int)in_EAX] = *puVar4;
          *puVar4 = uVar1;
          puVar4 = puVar4 + 1;
          iVar2 = iVar2 + -1;
        } while (iVar2 != 0);
      }
      in_EAX = in_EAX + -param_2;
    } while (param_1 < in_EAX);
  }
  return;
}



// Library Function - Single Match
//  _qsort
// 
// Library: Visual Studio 2003 Release

void __cdecl
_qsort(void *_Base,size_t _NumOfElements,size_t _SizeOfElements,_PtFuncCompare *_PtFuncCompare)

{
  undefined1 uVar1;
  uint uVar2;
  undefined1 *puVar3;
  int iVar4;
  undefined1 *puVar5;
  undefined1 *puVar6;
  size_t sVar7;
  undefined1 *puVar8;
  undefined1 *local_100;
  undefined1 *local_fc;
  int local_f8;
  size_t sStack_f4;
  undefined4 auStack_f0 [30];
  undefined4 auStack_78 [30];
  
  if ((_NumOfElements < 2) || (_SizeOfElements == 0)) {
    return;
  }
  local_f8 = 0;
  local_100 = (undefined1 *)_Base;
  local_fc = (undefined1 *)((_NumOfElements - 1) * _SizeOfElements + (int)_Base);
LAB_10040cb5:
  while (uVar2 = (uint)((int)local_fc - (int)local_100) / _SizeOfElements + 1, 8 < uVar2) {
    puVar3 = local_100 + (uVar2 >> 1) * _SizeOfElements;
    iVar4 = (*_PtFuncCompare)(local_100,puVar3);
    if ((0 < iVar4) && (local_100 != puVar3)) {
      puVar5 = puVar3;
      sVar7 = _SizeOfElements;
      do {
        uVar1 = puVar5[(int)local_100 - (int)puVar3];
        puVar5[(int)local_100 - (int)puVar3] = *puVar5;
        *puVar5 = uVar1;
        puVar5 = puVar5 + 1;
        sVar7 = sVar7 - 1;
      } while (sVar7 != 0);
    }
    iVar4 = (*_PtFuncCompare)(local_100,local_fc);
    if ((0 < iVar4) && (local_100 != local_fc)) {
      puVar5 = local_fc;
      sVar7 = _SizeOfElements;
      do {
        uVar1 = puVar5[(int)local_100 - (int)local_fc];
        puVar5[(int)local_100 - (int)local_fc] = *puVar5;
        *puVar5 = uVar1;
        puVar5 = puVar5 + 1;
        sVar7 = sVar7 - 1;
      } while (sVar7 != 0);
    }
    iVar4 = (*_PtFuncCompare)(puVar3,local_fc);
    puVar5 = local_100;
    puVar8 = local_fc;
    if ((0 < iVar4) && (puVar3 != local_fc)) {
      puVar6 = local_fc;
      sVar7 = _SizeOfElements;
      do {
        uVar1 = puVar6[(int)puVar3 - (int)local_fc];
        puVar6[(int)puVar3 - (int)local_fc] = *puVar6;
        *puVar6 = uVar1;
        puVar6 = puVar6 + 1;
        sVar7 = sVar7 - 1;
      } while (sVar7 != 0);
    }
LAB_10040da0:
    if (puVar5 < puVar3) {
      do {
        puVar5 = puVar5 + _SizeOfElements;
        if (puVar3 <= puVar5) goto LAB_10040dc0;
        iVar4 = (*_PtFuncCompare)(puVar5,puVar3);
      } while (iVar4 < 1);
      if (puVar3 <= puVar5) goto LAB_10040dc0;
    }
    else {
LAB_10040dc0:
      do {
        puVar5 = puVar5 + _SizeOfElements;
        if (local_fc < puVar5) break;
        iVar4 = (*_PtFuncCompare)(puVar5,puVar3);
      } while (iVar4 < 1);
    }
    do {
      puVar8 = puVar8 + -_SizeOfElements;
      if (puVar8 <= puVar3) break;
      iVar4 = (*_PtFuncCompare)(puVar8,puVar3);
    } while (0 < iVar4);
    if (puVar5 <= puVar8) {
      if (puVar5 != puVar8) {
        sStack_f4 = _SizeOfElements;
        puVar6 = puVar8;
        do {
          uVar1 = puVar6[(int)puVar5 - (int)puVar8];
          puVar6[(int)puVar5 - (int)puVar8] = *puVar6;
          *puVar6 = uVar1;
          puVar6 = puVar6 + 1;
          sStack_f4 = sStack_f4 - 1;
        } while (sStack_f4 != 0);
      }
      if (puVar3 == puVar8) {
        puVar3 = puVar5;
      }
      goto LAB_10040da0;
    }
    puVar8 = puVar8 + _SizeOfElements;
    if (puVar3 < puVar8) {
      do {
        puVar8 = puVar8 + -_SizeOfElements;
        if (puVar8 <= puVar3) goto LAB_10040e60;
        iVar4 = (*_PtFuncCompare)(puVar8,puVar3);
      } while (iVar4 == 0);
      if (puVar8 <= puVar3) goto LAB_10040e60;
    }
    else {
LAB_10040e60:
      do {
        puVar8 = puVar8 + -_SizeOfElements;
        if (puVar8 <= local_100) break;
        iVar4 = (*_PtFuncCompare)(puVar8,puVar3);
      } while (iVar4 == 0);
    }
    if ((int)puVar8 - (int)local_100 < (int)local_fc - (int)puVar5) goto LAB_10040ebb;
    if (local_100 < puVar8) {
      auStack_f0[local_f8] = local_100;
      auStack_78[local_f8] = puVar8;
      local_f8 = local_f8 + 1;
    }
    local_100 = puVar5;
    if (local_fc <= puVar5) goto LAB_10040cd7;
  }
  shortsort(local_100,_SizeOfElements,_PtFuncCompare);
  goto LAB_10040cd7;
LAB_10040ebb:
  if (puVar5 < local_fc) {
    auStack_f0[local_f8] = puVar5;
    auStack_78[local_f8] = local_fc;
    local_f8 = local_f8 + 1;
  }
  local_fc = puVar8;
  if (puVar8 <= local_100) {
LAB_10040cd7:
    local_f8 = local_f8 + -1;
    if (local_f8 < 0) {
      return;
    }
    local_100 = (undefined1 *)auStack_f0[local_f8];
    local_fc = (undefined1 *)auStack_78[local_f8];
  }
  goto LAB_10040cb5;
}



// Library Function - Single Match
//  _strcmp
// 
// Library: Visual Studio 2003 Release

int __cdecl _strcmp(char *_Str1,char *_Str2)

{
  undefined2 uVar1;
  undefined4 uVar2;
  byte bVar3;
  byte bVar4;
  bool bVar5;
  
  if (((uint)_Str1 & 3) != 0) {
    if (((uint)_Str1 & 1) != 0) {
      bVar4 = *_Str1;
      _Str1 = _Str1 + 1;
      bVar5 = bVar4 < (byte)*_Str2;
      if (bVar4 != *_Str2) goto LAB_10040f44;
      _Str2 = _Str2 + 1;
      if (bVar4 == 0) {
        return 0;
      }
      if (((uint)_Str1 & 2) == 0) goto LAB_10040f10;
    }
    uVar1 = *(undefined2 *)_Str1;
    _Str1 = _Str1 + 2;
    bVar4 = (byte)uVar1;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) goto LAB_10040f44;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((ushort)uVar1 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) goto LAB_10040f44;
    if (bVar4 == 0) {
      return 0;
    }
    _Str2 = (char *)((byte *)_Str2 + 2);
  }
LAB_10040f10:
  while( true ) {
    uVar2 = *(undefined4 *)_Str1;
    bVar4 = (byte)uVar2;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 0x10);
    bVar5 = bVar4 < ((byte *)_Str2)[2];
    if (bVar4 != ((byte *)_Str2)[2]) break;
    bVar3 = (byte)((uint)uVar2 >> 0x18);
    if (bVar4 == 0) {
      return 0;
    }
    bVar5 = bVar3 < ((byte *)_Str2)[3];
    if (bVar3 != ((byte *)_Str2)[3]) break;
    _Str2 = (char *)((byte *)_Str2 + 4);
    _Str1 = _Str1 + 4;
    if (bVar3 == 0) {
      return 0;
    }
  }
LAB_10040f44:
  return (uint)bVar5 * -2 + 1;
}



// Library Function - Single Match
//  __flush
// 
// Library: Visual Studio 2003 Release

int __cdecl __flush(FILE *_File)

{
  uint uVar1;
  int iVar2;
  uint _MaxCharCount;
  
  iVar2 = 0;
  if ((((byte)_File->_flag & 3) == 2) && ((_File->_flag & 0x108U) != 0)) {
    _MaxCharCount = (int)_File->_ptr - (int)_File->_base;
    if (0 < (int)_MaxCharCount) {
      uVar1 = __write(_File->_file,_File->_base,_MaxCharCount);
      if (uVar1 == _MaxCharCount) {
        if ((char)_File->_flag < '\0') {
          _File->_flag = _File->_flag & 0xfffffffd;
        }
      }
      else {
        _File->_flag = _File->_flag | 0x20;
        iVar2 = -1;
      }
    }
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return iVar2;
}



// Library Function - Single Match
//  __fflush_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __fflush_lk(FILE *param_1)

{
  int iVar1;
  
  iVar1 = __flush(param_1);
  if (iVar1 != 0) {
    return -1;
  }
  if ((param_1->_flag & 0x4000) != 0) {
    iVar1 = __commit(param_1->_file);
    return -(uint)(iVar1 != 0);
  }
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _flsall
// 
// Library: Visual Studio 2003 Release

int __cdecl flsall(int param_1)

{
  void *_File;
  FILE *pFVar1;
  int iVar2;
  int _Index;
  int local_28;
  int local_20;
  
  local_20 = 0;
  local_28 = 0;
  __lock(1);
  for (_Index = 0; _Index < DAT_1006a720; _Index = _Index + 1) {
    _File = *(void **)(DAT_10069710 + _Index * 4);
    if ((_File != (void *)0x0) && ((*(byte *)((int)_File + 0xc) & 0x83) != 0)) {
      __lock_file2(_Index,_File);
      pFVar1 = *(FILE **)(DAT_10069710 + _Index * 4);
      if ((pFVar1->_flag & 0x83U) != 0) {
        if (param_1 == 1) {
          iVar2 = __fflush_lk(pFVar1);
          if (iVar2 != -1) {
            local_20 = local_20 + 1;
          }
        }
        else if ((param_1 == 0) && ((pFVar1->_flag & 2U) != 0)) {
          iVar2 = __fflush_lk(pFVar1);
          if (iVar2 == -1) {
            local_28 = -1;
          }
        }
      }
      FUN_100410b3();
    }
  }
  FUN_100410df();
  if (param_1 != 1) {
    local_20 = local_28;
  }
  return local_20;
}



void FUN_100410b3(void)

{
  int unaff_ESI;
  
  __unlock_file2(unaff_ESI,*(void **)(DAT_10069710 + unaff_ESI * 4));
  return;
}



void FUN_100410df(void)

{
  FUN_100425f0(1);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fflush
// 
// Library: Visual Studio 2003 Release

int __cdecl _fflush(FILE *_File)

{
  int iVar1;
  
  if (_File == (FILE *)0x0) {
    iVar1 = flsall(0);
  }
  else {
    __lock_file(_File);
    iVar1 = __fflush_lk(_File);
    FUN_1004112e();
  }
  return iVar1;
}



void FUN_1004112e(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 8));
  return;
}



// Library Function - Single Match
//  __lock_file
// 
// Library: Visual Studio 2003 Release

void __cdecl __lock_file(FILE *_File)

{
  if (((FILE *)0x1005745f < _File) && (_File < (FILE *)0x100576c1)) {
    __lock(((int)(_File + -0x802ba3) >> 5) + 0x10);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



// Library Function - Single Match
//  __lock_file2
// 
// Library: Visual Studio 2003 Release

void __cdecl __lock_file2(int _Index,void *_File)

{
  if (_Index < 0x14) {
    __lock(_Index + 0x10);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)((int)_File + 0x20));
  return;
}



// Library Function - Single Match
//  __unlock_file
// 
// Libraries: Visual Studio 2003 Release, Visual Studio 2005 Release

void __cdecl __unlock_file(FILE *_File)

{
  if (((FILE *)0x1005745f < _File) && (_File < (FILE *)0x100576c1)) {
    FUN_100425f0(((int)(_File + -0x802ba3) >> 5) + 0x10);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



// Library Function - Single Match
//  __unlock_file2
// 
// Library: Visual Studio 2003 Release

void __cdecl __unlock_file2(int _Index,void *_File)

{
  if (_Index < 0x14) {
    FUN_100425f0(_Index + 0x10);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)_File + 0x20));
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl _fprintf(FILE *_File,char *_Format,...)

{
  int _Flag;
  int iVar1;
  
  __lock_file(_File);
  _Flag = __stbuf(_File);
  iVar1 = __output(_File,(byte *)_Format,(wchar_t *)&stack0x0000000c);
  __ftbuf(_Flag,_File);
  FUN_100412f6();
  return iVar1;
}



void FUN_100412f6(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + -0x20));
  return;
}



// Library Function - Single Match
//  _sscanf
// 
// Library: Visual Studio 2003 Release

int __cdecl _sscanf(char *_Src,char *_Format,...)

{
  int iVar1;
  FILE local_24;
  
  local_24._flag = 0x49;
  local_24._base = _Src;
  local_24._ptr = _Src;
  local_24._cnt = _strlen(_Src);
  iVar1 = __input(&local_24,(byte *)_Format,(undefined4 *)&stack0x0000000c);
  return iVar1;
}



// Library Function - Single Match
//  _memmove
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

void * __cdecl _memmove(void *_Dst,void *_Src,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((_Src < _Dst) && (_Dst < (void *)(_Size + (int)_Src))) {
    puVar3 = (undefined4 *)((_Size - 4) + (int)_Src);
    puVar4 = (undefined4 *)((_Size - 4) + (int)_Dst);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = _Size >> 2;
      uVar2 = _Size & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return _Dst;
        case 2:
          goto switchD_100414fb_caseD_2;
        case 3:
          goto switchD_100414fb_caseD_3;
        }
        goto switchD_100414fb_caseD_1;
      }
    }
    else {
      switch(_Size) {
      case 0:
        goto switchD_100414fb_caseD_0;
      case 1:
        goto switchD_100414fb_caseD_1;
      case 2:
        goto switchD_100414fb_caseD_2;
      case 3:
        goto switchD_100414fb_caseD_3;
      default:
        uVar1 = _Size - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_100414fb_caseD_2;
            case 3:
              goto switchD_100414fb_caseD_3;
            }
            goto switchD_100414fb_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_100414fb_caseD_2;
            case 3:
              goto switchD_100414fb_caseD_3;
            }
            goto switchD_100414fb_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_100414fb_caseD_2;
            case 3:
              goto switchD_100414fb_caseD_3;
            }
            goto switchD_100414fb_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_100414fb_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return _Dst;
    case 2:
switchD_100414fb_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return _Dst;
    case 3:
switchD_100414fb_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return _Dst;
    }
switchD_100414fb_caseD_0:
    return _Dst;
  }
  puVar3 = (undefined4 *)_Dst;
  if (((uint)_Dst & 3) == 0) {
    uVar1 = _Size >> 2;
    uVar2 = _Size & 3;
    if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *_Src;
        _Src = (undefined4 *)((int)_Src + 4);
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return _Dst;
      case 2:
        goto switchD_10041375_caseD_2;
      case 3:
        goto switchD_10041375_caseD_3;
      }
      goto switchD_10041375_caseD_1;
    }
  }
  else {
    switch(_Size) {
    case 0:
      goto switchD_10041375_caseD_0;
    case 1:
      goto switchD_10041375_caseD_1;
    case 2:
      goto switchD_10041375_caseD_2;
    case 3:
      goto switchD_10041375_caseD_3;
    default:
      uVar1 = (_Size - 4) + ((uint)_Dst & 3);
      switch((uint)_Dst & 3) {
      case 1:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 2) = *(undefined1 *)((int)_Src + 2);
        _Src = (void *)((int)_Src + 3);
        puVar3 = (undefined4 *)((int)_Dst + 3);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10041375_caseD_2;
          case 3:
            goto switchD_10041375_caseD_3;
          }
          goto switchD_10041375_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        _Src = (void *)((int)_Src + 2);
        puVar3 = (undefined4 *)((int)_Dst + 2);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10041375_caseD_2;
          case 3:
            goto switchD_10041375_caseD_3;
          }
          goto switchD_10041375_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        _Src = (void *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)_Dst + 1);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10041375_caseD_2;
          case 3:
            goto switchD_10041375_caseD_3;
          }
          goto switchD_10041375_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = *(undefined4 *)((int)_Src + (uVar1 - 7) * 4);
  case 6:
    puVar3[uVar1 - 6] = *(undefined4 *)((int)_Src + (uVar1 - 6) * 4);
  case 5:
    puVar3[uVar1 - 5] = *(undefined4 *)((int)_Src + (uVar1 - 5) * 4);
  case 4:
    puVar3[uVar1 - 4] = *(undefined4 *)((int)_Src + (uVar1 - 4) * 4);
  case 3:
    puVar3[uVar1 - 3] = *(undefined4 *)((int)_Src + (uVar1 - 3) * 4);
  case 2:
    puVar3[uVar1 - 2] = *(undefined4 *)((int)_Src + (uVar1 - 2) * 4);
  case 1:
    puVar3[uVar1 - 1] = *(undefined4 *)((int)_Src + (uVar1 - 1) * 4);
    _Src = (void *)((int)_Src + uVar1 * 4);
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_10041375_caseD_1:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    return _Dst;
  case 2:
switchD_10041375_caseD_2:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    return _Dst;
  case 3:
switchD_10041375_caseD_3:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)_Src + 2);
    return _Dst;
  }
switchD_10041375_caseD_0:
  return _Dst;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _vfprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl _vfprintf(FILE *_File,char *_Format,va_list _ArgList)

{
  int _Flag;
  int iVar1;
  
  __lock_file(_File);
  _Flag = __stbuf(_File);
  iVar1 = __output(_File,(byte *)_Format,(wchar_t *)_ArgList);
  __ftbuf(_Flag,_File);
  FUN_100416d0();
  return iVar1;
}



void FUN_100416d0(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + -0x20));
  return;
}



// Library Function - Single Match
//  __fwrite_lk
// 
// Library: Visual Studio 2003 Release

uint __cdecl __fwrite_lk(char *param_1,uint param_2,uint param_3,FILE *param_4)

{
  uint uVar1;
  int iVar2;
  uint _Size;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint local_8;
  
  uVar5 = param_2 * param_3;
  if (uVar5 == 0) {
    param_3 = 0;
  }
  else {
    uVar4 = uVar5;
    if ((param_4->_flag & 0x10c) == 0) {
      local_8 = 0x1000;
    }
    else {
      local_8 = param_4->_bufsiz;
    }
    do {
      uVar3 = param_4->_flag & 0x108;
      if ((uVar3 == 0) || (uVar1 = param_4->_cnt, uVar1 == 0)) {
        if (local_8 <= uVar4) {
          if ((uVar3 != 0) && (iVar2 = __flush(param_4), iVar2 != 0)) {
LAB_100417cf:
            return (uVar5 - uVar4) / param_2;
          }
          uVar3 = uVar4;
          if (local_8 != 0) {
            uVar3 = uVar4 - uVar4 % local_8;
          }
          _Size = __write(param_4->_file,param_1,uVar3);
          if ((_Size == 0xffffffff) || (uVar4 = uVar4 - _Size, _Size < uVar3)) {
            param_4->_flag = param_4->_flag | 0x20;
            goto LAB_100417cf;
          }
          goto LAB_1004178f;
        }
        iVar2 = __flsbuf((int)*param_1,param_4);
        if (iVar2 == -1) goto LAB_100417cf;
        param_1 = param_1 + 1;
        local_8 = param_4->_bufsiz;
        uVar4 = uVar4 - 1;
        if ((int)local_8 < 1) {
          local_8 = 1;
        }
      }
      else {
        _Size = uVar4;
        if (uVar1 <= uVar4) {
          _Size = uVar1;
        }
        _memcpy(param_4->_ptr,param_1,_Size);
        param_4->_cnt = param_4->_cnt - _Size;
        param_4->_ptr = param_4->_ptr + _Size;
        uVar4 = uVar4 - _Size;
LAB_1004178f:
        param_1 = param_1 + _Size;
      }
    } while (uVar4 != 0);
  }
  return param_3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fwrite
// 
// Library: Visual Studio 2003 Release

size_t __cdecl _fwrite(void *_Str,size_t _Size,size_t _Count,FILE *_File)

{
  uint uVar1;
  
  __lock_file(_File);
  uVar1 = __fwrite_lk((char *)_Str,_Size,_Count,_File);
  FUN_10041823();
  return uVar1;
}



void FUN_10041823(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 0x14));
  return;
}



// Library Function - Single Match
//  __fread_lk
// 
// Library: Visual Studio 2003 Release

uint __cdecl __fread_lk(undefined1 *param_1,uint param_2,uint param_3,FILE *param_4)

{
  undefined1 *puVar1;
  int iVar2;
  undefined1 *puVar3;
  undefined1 *puVar4;
  undefined1 *_Size;
  undefined1 *local_8;
  
  puVar4 = (undefined1 *)(param_2 * param_3);
  if (puVar4 == (undefined1 *)0x0) {
    param_3 = 0;
  }
  else {
    puVar3 = param_1;
    param_1 = puVar4;
    if ((param_4->_flag & 0x10c) == 0) {
      local_8 = (undefined1 *)0x1000;
    }
    else {
      local_8 = (undefined1 *)param_4->_bufsiz;
    }
    do {
      if (((param_4->_flag & 0x10c) == 0) ||
         (puVar1 = (undefined1 *)param_4->_cnt, puVar1 == (undefined1 *)0x0)) {
        if (param_1 < local_8) {
          iVar2 = __filbuf(param_4);
          if (iVar2 == -1) goto LAB_10041904;
          *puVar3 = (char)iVar2;
          local_8 = (undefined1 *)param_4->_bufsiz;
          puVar3 = puVar3 + 1;
          param_1 = param_1 + -1;
        }
        else {
          puVar1 = param_1;
          if (local_8 != (undefined1 *)0x0) {
            puVar1 = param_1 + -((uint)param_1 % (uint)local_8);
          }
          iVar2 = __read(param_4->_file,puVar3,(uint)puVar1);
          if (iVar2 == 0) {
            param_4->_flag = param_4->_flag | 0x10;
LAB_10041904:
            return (uint)((int)puVar4 - (int)param_1) / param_2;
          }
          if (iVar2 == -1) {
            param_4->_flag = param_4->_flag | 0x20;
            goto LAB_10041904;
          }
          param_1 = param_1 + -iVar2;
          puVar3 = puVar3 + iVar2;
        }
      }
      else {
        _Size = param_1;
        if (puVar1 <= param_1) {
          _Size = puVar1;
        }
        _memcpy(puVar3,param_4->_ptr,(size_t)_Size);
        param_1 = param_1 + -(int)_Size;
        param_4->_cnt = param_4->_cnt - (int)_Size;
        param_4->_ptr = _Size + (int)param_4->_ptr;
        puVar3 = puVar3 + (int)_Size;
      }
    } while (param_1 != (undefined1 *)0x0);
  }
  return param_3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fread
// 
// Library: Visual Studio 2003 Release

size_t __cdecl _fread(void *_DstBuf,size_t _ElementSize,size_t _Count,FILE *_File)

{
  uint uVar1;
  
  __lock_file(_File);
  uVar1 = __fread_lk((undefined1 *)_DstBuf,_ElementSize,_Count,_File);
  FUN_10041958();
  return uVar1;
}



void FUN_10041958(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 0x14));
  return;
}



undefined4 __cdecl FUN_10041962(LPCSTR param_1,LPCSTR param_2)

{
  BOOL BVar1;
  ulong uVar2;
  
  BVar1 = MoveFileA(param_1,param_2);
  if (BVar1 == 0) {
    uVar2 = GetLastError();
  }
  else {
    uVar2 = 0;
  }
  if (uVar2 != 0) {
    __dosmaperr(uVar2);
    return 0xffffffff;
  }
  return 0;
}



undefined4 __cdecl FUN_10041990(LPCSTR param_1)

{
  BOOL BVar1;
  ulong uVar2;
  
  BVar1 = DeleteFileA(param_1);
  if (BVar1 == 0) {
    uVar2 = GetLastError();
  }
  else {
    uVar2 = 0;
  }
  if (uVar2 != 0) {
    __dosmaperr(uVar2);
    return 0xffffffff;
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _strtod
// 
// Library: Visual Studio 2003 Release

double __cdecl _strtod(char *_Str,char **_EndPtr)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  _locale_t _Locale;
  FLT p_Var4;
  int *piVar5;
  byte *_Str_00;
  _flt local_24;
  double local_c;
  
  bVar1 = *_Str;
  _Str_00 = (byte *)_Str;
  while (iVar3 = _isspace((uint)bVar1), iVar3 != 0) {
    _Str_00 = _Str_00 + 1;
    bVar1 = *_Str_00;
  }
  _Locale = (_locale_t)_strlen((char *)_Str_00);
  p_Var4 = __fltin2(&local_24,(char *)_Str_00,_Locale);
  if (_EndPtr != (char **)0x0) {
    *_EndPtr = (char *)(_Str_00 + p_Var4->nbytes);
  }
  uVar2 = p_Var4->flags;
  if ((uVar2 & 0x240) == 0) {
    if ((uVar2 & 0x81) == 0) {
      if ((uVar2 & 0x100) == 0) {
        return p_Var4->dval;
      }
      local_c = 0.0;
    }
    else {
      local_c = _DAT_10057da0;
      if (*_Str_00 == 0x2d) {
        local_c = -_DAT_10057da0;
      }
    }
    piVar5 = FUN_10041d35();
    *piVar5 = 0x22;
  }
  else {
    local_c = 0.0;
    if (_EndPtr != (char **)0x0) {
      *_EndPtr = _Str;
    }
  }
  return local_c;
}



// Library Function - Single Match
//  _strtoxl
// 
// Library: Visual Studio 2003 Release

uint __cdecl strtoxl(byte *param_1,undefined4 *param_2,uint param_3,uint param_4)

{
  byte *pbVar1;
  _ptiddata p_Var2;
  pthreadlocinfo ptVar3;
  uint uVar4;
  int *piVar5;
  uint uVar6;
  int iVar7;
  byte bVar8;
  byte *pbVar9;
  uint local_8;
  
  p_Var2 = __getptd();
  ptVar3 = (pthreadlocinfo)p_Var2->_tfpecode;
  if (ptVar3 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar3 = ___updatetlocinfo();
  }
  local_8 = 0;
  bVar8 = *param_1;
  pbVar1 = param_1;
  while( true ) {
    pbVar9 = pbVar1 + 1;
    if ((int)ptVar3->lc_category[1].refcount < 2) {
      uVar4 = *(byte *)((int)ptVar3->lc_category[3].refcount + (uint)bVar8 * 2) & 8;
    }
    else {
      uVar4 = ___isctype_mt(param_1,(int)ptVar3,(uint)bVar8,8);
    }
    if (uVar4 == 0) break;
    bVar8 = *pbVar9;
    pbVar1 = pbVar9;
  }
  if (bVar8 == 0x2d) {
    param_4 = param_4 | 2;
LAB_10041ac3:
    bVar8 = *pbVar9;
    pbVar9 = pbVar1 + 2;
  }
  else if (bVar8 == 0x2b) goto LAB_10041ac3;
  if ((((int)param_3 < 0) || (param_3 == 1)) || (0x24 < (int)param_3)) {
    if (param_2 != (undefined4 *)0x0) {
      *param_2 = param_1;
    }
    return 0;
  }
  if (param_3 == 0) {
    if (bVar8 != 0x30) {
      param_3 = 10;
      goto LAB_10041b26;
    }
    if ((*pbVar9 != 0x78) && (*pbVar9 != 0x58)) {
      param_3 = 8;
      goto LAB_10041b26;
    }
    param_3 = 0x10;
  }
  if (((param_3 == 0x10) && (bVar8 == 0x30)) && ((*pbVar9 == 0x78 || (*pbVar9 == 0x58)))) {
    bVar8 = pbVar9[1];
    pbVar9 = pbVar9 + 2;
  }
LAB_10041b26:
  uVar4 = (uint)(0xffffffff / (ulonglong)param_3);
  do {
    if ((*(ushort *)(PTR_DAT_10057da8 + (uint)bVar8 * 2) & 4) == 0) {
      if ((*(ushort *)(PTR_DAT_10057da8 + (uint)bVar8 * 2) & 0x103) == 0) {
LAB_10041b92:
        pbVar9 = pbVar9 + -1;
        if ((param_4 & 8) == 0) {
          if (param_2 != (undefined4 *)0x0) {
            pbVar9 = param_1;
          }
          local_8 = 0;
        }
        else if (((param_4 & 4) != 0) ||
                (((param_4 & 1) == 0 &&
                 ((((param_4 & 2) != 0 && (0x80000000 < local_8)) ||
                  (((param_4 & 2) == 0 && (0x7fffffff < local_8)))))))) {
          piVar5 = FUN_10041d35();
          *piVar5 = 0x22;
          if ((param_4 & 1) == 0) {
            local_8 = ((param_4 & 2) != 0) + 0x7fffffff;
          }
          else {
            local_8 = 0xffffffff;
          }
        }
        if (param_2 != (undefined4 *)0x0) {
          *param_2 = pbVar9;
        }
        if ((param_4 & 2) == 0) {
          return local_8;
        }
        return -local_8;
      }
      if (((char)bVar8 < 'a') || ('z' < (char)bVar8)) {
        iVar7 = (int)(char)bVar8;
      }
      else {
        iVar7 = (char)bVar8 + -0x20;
      }
      uVar6 = iVar7 - 0x37;
    }
    else {
      uVar6 = (int)(char)bVar8 - 0x30;
    }
    if (param_3 <= uVar6) goto LAB_10041b92;
    if ((local_8 < uVar4) ||
       ((local_8 == uVar4 && (uVar6 <= (uint)(0xffffffff % (ulonglong)param_3))))) {
      local_8 = local_8 * param_3 + uVar6;
      param_4 = param_4 | 8;
    }
    else {
      param_4 = param_4 | 0xc;
    }
    bVar8 = *pbVar9;
    pbVar9 = pbVar9 + 1;
  } while( true );
}



// Library Function - Single Match
//  _strtol
// 
// Library: Visual Studio 2003 Release

long __cdecl _strtol(char *_Str,char **_EndPtr,int _Radix)

{
  uint uVar1;
  
  uVar1 = strtoxl((byte *)_Str,_EndPtr,_Radix,0);
  return uVar1;
}



// Library Function - Single Match
//  _isdigit
// 
// Library: Visual Studio 2003 Release

int __cdecl _isdigit(int _C)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (1 < (int)ptVar2->lc_category[1].refcount) {
    uVar3 = ___isctype_mt(this,(int)ptVar2,_C,4);
    return uVar3;
  }
  return *(byte *)((int)ptVar2->lc_category[3].refcount + _C * 2) & 4;
}



// Library Function - Single Match
//  _isxdigit
// 
// Library: Visual Studio 2003 Release

int __cdecl _isxdigit(int _C)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (1 < (int)ptVar2->lc_category[1].refcount) {
    uVar3 = ___isctype_mt(this,(int)ptVar2,_C,0x80);
    return uVar3;
  }
  return *(byte *)((int)ptVar2->lc_category[3].refcount + _C * 2) & 0x80;
}



// Library Function - Single Match
//  _isspace
// 
// Library: Visual Studio 2003 Release

int __cdecl _isspace(int _C)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (1 < (int)ptVar2->lc_category[1].refcount) {
    uVar3 = ___isctype_mt(this,(int)ptVar2,_C,8);
    return uVar3;
  }
  return *(byte *)((int)ptVar2->lc_category[3].refcount + _C * 2) & 8;
}



// Library Function - Single Match
//  _strerror
// 
// Library: Visual Studio 2003 Release

char * __cdecl _strerror(char *_ErrMsg)

{
  _ptiddata p_Var1;
  char *pcVar2;
  uint *puVar3;
  
  p_Var1 = __getptd();
  if (p_Var1->_errmsg == (char *)0x0) {
    pcVar2 = (char *)_malloc(0x86);
    p_Var1->_errmsg = pcVar2;
    if (pcVar2 == (char *)0x0) {
      puVar3 = (uint *)&DAT_10068e48;
      goto LAB_10041d0f;
    }
  }
  puVar3 = (uint *)p_Var1->_errmsg;
LAB_10041d0f:
  pcVar2 = DAT_10057e60;
  if ((-1 < (int)_ErrMsg) && ((int)_ErrMsg < (int)DAT_10057e60)) {
    pcVar2 = _ErrMsg;
  }
  FUN_10048310(puVar3,(uint *)(&PTR_s_No_error_10057db0)[(int)pcVar2]);
  return (char *)puVar3;
}



int * FUN_10041d35(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  return &p_Var1->_terrno;
}



ulong * FUN_10041d3e(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  return &p_Var1->_tdoserrno;
}



// Library Function - Single Match
//  __dosmaperr
// 
// Library: Visual Studio 2003 Release

void __cdecl __dosmaperr(ulong param_1)

{
  _ptiddata p_Var1;
  uint uVar2;
  
  p_Var1 = __getptd();
  p_Var1->_tdoserrno = param_1;
  uVar2 = 0;
  do {
    if (param_1 == (&DAT_100576e0)[uVar2 * 2]) {
      p_Var1 = __getptd();
      p_Var1->_terrno = (&DAT_100576e4)[uVar2 * 2];
      return;
    }
    uVar2 = uVar2 + 1;
  } while (uVar2 < 0x2d);
  if ((0x12 < param_1) && (param_1 < 0x25)) {
    p_Var1 = __getptd();
    p_Var1->_terrno = 0xd;
    return;
  }
  if ((0xbb < param_1) && (param_1 < 0xcb)) {
    p_Var1 = __getptd();
    p_Var1->_terrno = 8;
    return;
  }
  p_Var1 = __getptd();
  p_Var1->_terrno = 0x16;
  return;
}



// Library Function - Single Match
//  __ftell_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __ftell_lk(uint *param_1)

{
  uint _FileHandle;
  uint uVar1;
  byte bVar2;
  int *piVar3;
  uint *puVar4;
  long lVar5;
  char *pcVar6;
  uint *puVar7;
  char *pcVar8;
  char *pcVar9;
  int iVar10;
  int local_c;
  int local_8;
  
  puVar7 = param_1;
  _FileHandle = param_1[4];
  if ((int)param_1[1] < 0) {
    param_1[1] = 0;
  }
  local_8 = __lseek(_FileHandle,0,1);
  if (local_8 < 0) {
LAB_10041e57:
    local_c = -1;
  }
  else {
    uVar1 = param_1[3];
    if ((uVar1 & 0x108) == 0) {
      return local_8 - param_1[1];
    }
    pcVar6 = (char *)*param_1;
    pcVar9 = (char *)param_1[2];
    local_c = (int)pcVar6 - (int)pcVar9;
    if ((uVar1 & 3) == 0) {
      if (-1 < (char)uVar1) {
        piVar3 = FUN_10041d35();
        *piVar3 = 0x16;
        goto LAB_10041e57;
      }
    }
    else if (((*(byte *)((&DAT_10069600)[(int)_FileHandle >> 5] + 4 + (_FileHandle & 0x1f) * 0x24) &
              0x80) != 0) && (pcVar8 = pcVar9, pcVar9 < pcVar6)) {
      do {
        if (*pcVar8 == '\n') {
          local_c = local_c + 1;
        }
        pcVar8 = pcVar8 + 1;
      } while (pcVar8 < (char *)*param_1);
    }
    if (local_8 != 0) {
      if ((param_1[3] & 1) != 0) {
        if (param_1[1] == 0) {
          local_c = 0;
        }
        else {
          puVar4 = (uint *)(pcVar6 + (param_1[1] - (int)pcVar9));
          iVar10 = (_FileHandle & 0x1f) * 0x24;
          if ((*(byte *)(iVar10 + 4 + (&DAT_10069600)[(int)_FileHandle >> 5]) & 0x80) != 0) {
            lVar5 = __lseek(_FileHandle,0,2);
            if (lVar5 == local_8) {
              pcVar6 = (char *)param_1[2];
              pcVar9 = (char *)((int)puVar4 + (int)pcVar6);
              param_1 = puVar4;
              for (; pcVar6 < pcVar9; pcVar6 = pcVar6 + 1) {
                if (*pcVar6 == '\n') {
                  param_1 = (uint *)((int)param_1 + 1);
                }
              }
              bVar2 = *(byte *)((int)puVar7 + 0xd) & 0x20;
            }
            else {
              __lseek(_FileHandle,local_8,0);
              puVar7 = (uint *)0x200;
              if ((((uint *)0x200 < puVar4) || ((param_1[3] & 8) == 0)) ||
                 ((param_1[3] & 0x400) != 0)) {
                puVar7 = (uint *)param_1[6];
              }
              bVar2 = *(byte *)(iVar10 + 4 + (&DAT_10069600)[(int)_FileHandle >> 5]) & 4;
              param_1 = puVar7;
            }
            puVar4 = param_1;
            if (bVar2 != 0) {
              puVar4 = (uint *)((int)param_1 + 1);
            }
          }
          param_1 = puVar4;
          local_8 = local_8 - (int)param_1;
        }
      }
      local_c = local_c + local_8;
    }
  }
  return local_c;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _ftell
// 
// Library: Visual Studio 2003 Release

long __cdecl _ftell(FILE *_File)

{
  int iVar1;
  
  __lock_file(_File);
  iVar1 = __ftell_lk((uint *)_File);
  FUN_10041f53();
  return iVar1;
}



void FUN_10041f53(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 8));
  return;
}



// Library Function - Single Match
//  __fseek_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __fseek_lk(FILE *param_1,int param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  long lVar3;
  int *piVar4;
  
  if (((param_1->_flag & 0x83U) == 0) || (((param_3 != 0 && (param_3 != 1)) && (param_3 != 2)))) {
    piVar4 = FUN_10041d35();
    *piVar4 = 0x16;
    iVar2 = -1;
  }
  else {
    param_1->_flag = param_1->_flag & 0xffffffef;
    if (param_3 == 1) {
      iVar2 = __ftell_lk((uint *)param_1);
      param_2 = param_2 + iVar2;
      param_3 = 0;
    }
    __flush(param_1);
    uVar1 = param_1->_flag;
    if ((char)uVar1 < '\0') {
      param_1->_flag = uVar1 & 0xfffffffc;
    }
    else if ((((uVar1 & 1) != 0) && ((uVar1 & 8) != 0)) && ((uVar1 & 0x400) == 0)) {
      param_1->_bufsiz = 0x200;
    }
    lVar3 = __lseek(param_1->_file,param_2,param_3);
    iVar2 = (lVar3 != -1) - 1;
  }
  return iVar2;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fseek
// 
// Library: Visual Studio 2003 Release

int __cdecl _fseek(FILE *_File,long _Offset,int _Origin)

{
  int iVar1;
  
  __lock_file(_File);
  iVar1 = __fseek_lk(_File,_Offset,_Origin);
  FUN_1004202b();
  return iVar1;
}



void FUN_1004202b(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 8));
  return;
}



// Library Function - Single Match
//  _strrchr
// 
// Library: Visual Studio 2003 Release

char * __cdecl _strrchr(char *_Str,int _Ch)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  
  iVar2 = -1;
  do {
    pcVar4 = _Str;
    if (iVar2 == 0) break;
    iVar2 = iVar2 + -1;
    pcVar4 = _Str + 1;
    cVar1 = *_Str;
    _Str = pcVar4;
  } while (cVar1 != '\0');
  iVar2 = -(iVar2 + 1);
  pcVar4 = pcVar4 + -1;
  do {
    pcVar3 = pcVar4;
    if (iVar2 == 0) break;
    iVar2 = iVar2 + -1;
    pcVar3 = pcVar4 + -1;
    cVar1 = *pcVar4;
    pcVar4 = pcVar3;
  } while ((char)_Ch != cVar1);
  pcVar3 = pcVar3 + 1;
  if (*pcVar3 != (char)_Ch) {
    pcVar3 = (char *)0x0;
  }
  return pcVar3;
}



// Library Function - Single Match
//  __aulldiv
// 
// Libraries: Visual Studio 2003 Release, Visual Studio 2005 Release

undefined8 __aulldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



// Library Function - Single Match
//  __forcdecpt
// 
// Library: Visual Studio 2003 Release

void __cdecl __forcdecpt(char *_Buf)

{
  char cVar1;
  char cVar2;
  int iVar3;
  bool bVar4;
  
  iVar3 = _tolower((int)*_Buf);
  bVar4 = iVar3 == 0x65;
  while (!bVar4) {
    _Buf = _Buf + 1;
    iVar3 = _isdigit((int)*_Buf);
    bVar4 = iVar3 == 0;
  }
  cVar2 = *_Buf;
  *_Buf = DAT_10057e68;
  do {
    _Buf = _Buf + 1;
    cVar1 = *_Buf;
    *_Buf = cVar2;
    cVar2 = cVar1;
  } while (*_Buf != '\0');
  return;
}



// Library Function - Single Match
//  __fassign
// 
// Library: Visual Studio 2003 Release

void __cdecl __fassign(int flag,char *argument,char *number)

{
  _CRT_FLOAT local_c;
  undefined4 local_8;
  
  if (flag != 0) {
    FID_conflict___atodbl(&local_c,number);
    *(float *)argument = local_c.f;
    *(undefined4 *)(argument + 4) = local_8;
    return;
  }
  FID_conflict___atodbl((_CRT_FLOAT *)&flag,number);
  *(int *)argument = flag;
  return;
}



// Library Function - Single Match
//  __shift
// 
// Library: Visual Studio 2003 Release

void __shift(void)

{
  char *in_EAX;
  size_t sVar1;
  int unaff_EDI;
  
  if (unaff_EDI != 0) {
    sVar1 = _strlen(in_EAX);
    _memmove(in_EAX + unaff_EDI,in_EAX,sVar1 + 1);
  }
  return;
}



// Library Function - Single Match
//  __cftoe2
// 
// Library: Visual Studio 2003 Release

void __cdecl __cftoe2(int param_1,int param_2,char param_3)

{
  int *in_EAX;
  undefined1 *puVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  undefined1 *unaff_EBX;
  
  if (param_3 != '\0') {
    __shift();
  }
  if (*in_EAX == 0x2d) {
    *unaff_EBX = 0x2d;
    unaff_EBX = unaff_EBX + 1;
  }
  puVar1 = unaff_EBX;
  if (0 < param_1) {
    puVar1 = unaff_EBX + 1;
    *unaff_EBX = *puVar1;
    *puVar1 = DAT_10057e68;
  }
  puVar2 = FUN_10048310((uint *)(puVar1 + param_1 + (uint)(param_3 == '\0')),(uint *)"e+000");
  if (param_2 != 0) {
    *(undefined1 *)puVar2 = 0x45;
  }
  if (*(char *)in_EAX[3] != '0') {
    iVar3 = in_EAX[1] + -1;
    if (iVar3 < 0) {
      iVar3 = -iVar3;
      *(undefined1 *)((int)puVar2 + 1) = 0x2d;
    }
    if (99 < iVar3) {
      iVar4 = iVar3 / 100;
      iVar3 = iVar3 % 100;
      *(char *)((int)puVar2 + 2) = *(char *)((int)puVar2 + 2) + (char)iVar4;
    }
    if (9 < iVar3) {
      iVar4 = iVar3 / 10;
      iVar3 = iVar3 % 10;
      *(char *)((int)puVar2 + 3) = *(char *)((int)puVar2 + 3) + (char)iVar4;
    }
    *(char *)(puVar2 + 1) = (char)puVar2[1] + (char)iVar3;
  }
  return;
}



// Library Function - Single Match
//  __cftoe
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl __cftoe(double *_Value,char *_Buf,size_t _SizeInBytes,int _Dec,int _Caps)

{
  errno_t eVar1;
  size_t unaff_ESI;
  STRFLT _PtFlt;
  _strflt local_30;
  char local_20 [24];
  int local_8;
  
  local_8 = DAT_10057438;
  _PtFlt = *(STRFLT *)_Value;
  __fltout2((_CRT_DOUBLE)*_Value,&local_30,local_20,unaff_ESI);
  __fptostr(_Buf + (uint)(0 < (int)_SizeInBytes) + (uint)(local_30.sign == 0x2d),_SizeInBytes + 1,
            (int)&local_30,_PtFlt);
  __cftoe2(_SizeInBytes,_Dec,'\0');
  eVar1 = FUN_1003fb09(local_8);
  return eVar1;
}



// Library Function - Single Match
//  __cftof2
// 
// Library: Visual Studio 2003 Release

undefined1 * __cdecl __cftof2(undefined1 *param_1,size_t param_2,char param_3)

{
  int iVar1;
  int iVar2;
  int *in_EAX;
  undefined1 *puVar3;
  
  iVar1 = in_EAX[1];
  if ((param_3 != '\0') && (iVar1 - 1U == param_2)) {
    iVar2 = *in_EAX;
    param_1[(uint)(iVar2 == 0x2d) + (iVar1 - 1U)] = 0x30;
    (param_1 + (uint)(iVar2 == 0x2d) + (iVar1 - 1U))[1] = 0;
  }
  puVar3 = param_1;
  if (*in_EAX == 0x2d) {
    *param_1 = 0x2d;
    puVar3 = param_1 + 1;
  }
  if (in_EAX[1] < 1) {
    __shift();
    *puVar3 = 0x30;
    puVar3 = puVar3 + 1;
  }
  else {
    puVar3 = puVar3 + in_EAX[1];
  }
  if (0 < (int)param_2) {
    __shift();
    *puVar3 = DAT_10057e68;
    iVar1 = in_EAX[1];
    if (iVar1 < 0) {
      if ((param_3 != '\0') || (SBORROW4(param_2,-iVar1) == (int)(param_2 + iVar1) < 0)) {
        param_2 = -iVar1;
      }
      __shift();
      _memset(puVar3 + 1,0x30,param_2);
    }
  }
  return param_1;
}



// Library Function - Single Match
//  __cftof
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl __cftof(double *_Value,char *_Buf,size_t _SizeInBytes,int _Dec)

{
  errno_t eVar1;
  size_t unaff_ESI;
  STRFLT _PtFlt;
  _strflt local_30;
  char local_20 [24];
  int local_8;
  
  local_8 = DAT_10057438;
  _PtFlt = *(STRFLT *)_Value;
  __fltout2((_CRT_DOUBLE)*_Value,&local_30,local_20,unaff_ESI);
  __fptostr(_Buf + (local_30.sign == 0x2d),local_30.decpt + _SizeInBytes,(int)&local_30,_PtFlt);
  __cftof2(_Buf,_SizeInBytes,'\0');
  eVar1 = FUN_1003fb09(local_8);
  return eVar1;
}



// Library Function - Single Match
//  __cftog
// 
// Library: Visual Studio 2003 Release

void __cdecl __cftog(double *param_1,undefined1 *param_2,size_t param_3,int param_4)

{
  char *pcVar1;
  int iVar2;
  size_t unaff_EDI;
  char *pcVar3;
  STRFLT _PtFlt;
  _strflt local_30;
  char local_20 [24];
  int local_8;
  
  local_8 = DAT_10057438;
  _PtFlt = *(STRFLT *)param_1;
  __fltout2((_CRT_DOUBLE)*param_1,&local_30,local_20,unaff_EDI);
  iVar2 = local_30.decpt + -1;
  __fptostr(param_2 + (local_30.sign == 0x2d),param_3,(int)&local_30,_PtFlt);
  local_30.decpt = local_30.decpt + -1;
  if ((local_30.decpt < -4) || ((int)param_3 <= local_30.decpt)) {
    __cftoe2(param_3,param_4,'\x01');
  }
  else {
    pcVar1 = param_2 + (local_30.sign == 0x2d);
    if (iVar2 < local_30.decpt) {
      do {
        pcVar3 = pcVar1;
        pcVar1 = pcVar3 + 1;
      } while (*pcVar3 != '\0');
      pcVar3[-1] = '\0';
    }
    __cftof2(param_2,param_3,'\x01');
  }
  FUN_1003fb09(local_8);
  return;
}



// Library Function - Single Match
//  __cfltcvt
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl
__cfltcvt(double *arg,char *buffer,size_t sizeInBytes,int format,int precision,int caps)

{
  errno_t eVar1;
  int unaff_EBP;
  
  if ((sizeInBytes == 0x65) || (sizeInBytes == 0x45)) {
    eVar1 = __cftoe(arg,buffer,format,precision,unaff_EBP);
  }
  else {
    if (sizeInBytes == 0x66) {
      eVar1 = __cftof(arg,buffer,format,unaff_EBP);
      return eVar1;
    }
    eVar1 = __cftog(arg,buffer,format,precision);
  }
  return eVar1;
}



// Library Function - Single Match
//  __setdefaultprecision
// 
// Library: Visual Studio 2003 Release

void __setdefaultprecision(void)

{
  __controlfp(0x10000,0x30000);
  return;
}



// WARNING: Removing unreachable block (ram,0x10042520)
// Library Function - Single Match
//  __ms_p5_test_fdiv
// 
// Library: Visual Studio 2003 Release

undefined4 __ms_p5_test_fdiv(void)

{
  return 0;
}



// Library Function - Single Match
//  __ms_p5_mp_test_fdiv
// 
// Library: Visual Studio 2003 Release

void __ms_p5_mp_test_fdiv(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleA("KERNEL32");
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"IsProcessorFeaturePresent");
    if (pFVar1 != (FARPROC)0x0) {
      (*pFVar1)(0);
      return;
    }
  }
  __ms_p5_test_fdiv();
  return;
}



// Library Function - Single Match
//  __mtinitlocks
// 
// Library: Visual Studio 2003 Release

int __cdecl __mtinitlocks(void)

{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  
  iVar2 = 0;
  puVar3 = &DAT_10068ed0;
  do {
    if ((&DAT_1005786c)[iVar2 * 2] == 1) {
      (&DAT_10057868)[iVar2 * 2] = puVar3;
      puVar3 = puVar3 + 0x18;
      iVar1 = ___crtInitCritSecAndSpinCount((&DAT_10057868)[iVar2 * 2],4000);
      if (iVar1 == 0) {
        (&DAT_10057868)[iVar2 * 2] = 0;
        return 0;
      }
    }
    iVar2 = iVar2 + 1;
  } while (iVar2 < 0x24);
  return 1;
}



// Library Function - Single Match
//  __mtdeletelocks
// 
// Library: Visual Studio 2003 Release

void __cdecl __mtdeletelocks(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 *puVar1;
  
  puVar1 = &DAT_10057868;
  do {
    lpCriticalSection = (LPCRITICAL_SECTION)*puVar1;
    if ((lpCriticalSection != (LPCRITICAL_SECTION)0x0) && (puVar1[1] != 1)) {
      DeleteCriticalSection(lpCriticalSection);
      _free(lpCriticalSection);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 2;
  } while ((int)puVar1 < 0x10057988);
  puVar1 = &DAT_10057868;
  do {
    if (((LPCRITICAL_SECTION)*puVar1 != (LPCRITICAL_SECTION)0x0) && (puVar1[1] == 1)) {
      DeleteCriticalSection((LPCRITICAL_SECTION)*puVar1);
    }
    puVar1 = puVar1 + 2;
  } while ((int)puVar1 < 0x10057988);
  return;
}



void __cdecl FUN_100425f0(int param_1)

{
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_10057868)[param_1 * 2]);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __mtinitlocknum
// 
// Library: Visual Studio 2003 Release

int __cdecl __mtinitlocknum(int _LockNum)

{
  void *_Memory;
  int *piVar1;
  int iVar2;
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10054730;
  uStack_c = 0x10042611;
  piVar1 = &DAT_10057868 + _LockNum * 2;
  if (*piVar1 == 0) {
    _Memory = _malloc(0x18);
    if (_Memory == (void *)0x0) {
      piVar1 = FUN_10041d35();
      *piVar1 = 0xc;
      return 0;
    }
    __lock(10);
    local_8 = (undefined *)0x0;
    if (*piVar1 == 0) {
      iVar2 = ___crtInitCritSecAndSpinCount(_Memory,4000);
      if (iVar2 == 0) {
        _free(_Memory);
        piVar1 = FUN_10041d35();
        *piVar1 = 0xc;
        __local_unwind2((int)local_14,-1);
        return 0;
      }
      *piVar1 = (int)_Memory;
    }
    else {
      _free(_Memory);
    }
    local_8 = (undefined *)0xffffffff;
    FUN_1004269c();
  }
  return 1;
}



void FUN_1004269c(void)

{
  FUN_100425f0(10);
  return;
}



// Library Function - Single Match
//  __lock
// 
// Library: Visual Studio 2003 Release

void __cdecl __lock(int _File)

{
  int iVar1;
  
  if ((&DAT_10057868)[_File * 2] == 0) {
    iVar1 = __mtinitlocknum(_File);
    if (iVar1 == 0) {
      __amsg_exit(0x11);
    }
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(&DAT_10057868)[_File * 2]);
  return;
}



// WARNING: This is an inlined function
// WARNING: Unable to track spacebase fully for stack
// WARNING: Variable defined which should be unmapped: param_2
// Library Function - Single Match
//  __SEH_prolog
// 
// Library: Visual Studio

void __cdecl __SEH_prolog(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined4 unaff_retaddr;
  undefined4 auStack_18 [4];
  undefined1 local_8 [8];
  
  iVar1 = -param_2;
  *(undefined4 *)((int)auStack_18 + iVar1 + 0xc) = unaff_EBX;
  *(undefined4 *)((int)auStack_18 + iVar1 + 8) = unaff_ESI;
  *(undefined4 *)((int)auStack_18 + iVar1 + 4) = unaff_EDI;
  *(undefined4 *)((int)auStack_18 + iVar1) = unaff_retaddr;
  ExceptionList = local_8;
  return;
}



// WARNING: This is an inlined function
// Library Function - Single Match
//  __SEH_epilog
// 
// Library: Visual Studio

void __SEH_epilog(void)

{
  undefined4 *unaff_EBP;
  undefined4 unaff_retaddr;
  
  ExceptionList = (void *)unaff_EBP[-4];
  *unaff_EBP = unaff_retaddr;
  return;
}



void FUN_10042812(int param_1)

{
  __local_unwind2(*(int *)(param_1 + 0x18),*(int *)(param_1 + 0x1c));
  return;
}



// Library Function - Single Match
//  __flsbuf
// 
// Library: Visual Studio 2003 Release

int __cdecl __flsbuf(int _Ch,FILE *_File)

{
  uint uVar1;
  uint _FileHandle;
  char *_Buf;
  char *pcVar2;
  FILE *_File_00;
  int iVar3;
  undefined *puVar4;
  FILE *_MaxCharCount;
  
  _File_00 = _File;
  uVar1 = _File->_flag;
  _FileHandle = _File->_file;
  if (((uVar1 & 0x82) == 0) || ((uVar1 & 0x40) != 0)) {
LAB_10042939:
    _File->_flag = uVar1 | 0x20;
  }
  else {
    if ((uVar1 & 1) != 0) {
      _File->_cnt = 0;
      if ((uVar1 & 0x10) == 0) goto LAB_10042939;
      _File->_ptr = _File->_base;
      _File->_flag = uVar1 & 0xfffffffe;
    }
    uVar1 = _File->_flag;
    _File->_cnt = 0;
    _File = (FILE *)0x0;
    _File_00->_flag = uVar1 & 0xffffffef | 2;
    if (((uVar1 & 0x10c) == 0) &&
       (((_File_00 != (FILE *)&DAT_10057480 && (_File_00 != (FILE *)&DAT_100574a0)) ||
        (iVar3 = __isatty(_FileHandle), iVar3 == 0)))) {
      __getbuf(_File_00);
    }
    if ((_File_00->_flag & 0x108) == 0) {
      _MaxCharCount = (FILE *)0x1;
      _File = (FILE *)__write(_FileHandle,&_Ch,1);
    }
    else {
      _Buf = _File_00->_base;
      pcVar2 = _File_00->_ptr;
      _File_00->_ptr = _Buf + 1;
      _MaxCharCount = (FILE *)(pcVar2 + -(int)_Buf);
      _File_00->_cnt = _File_00->_bufsiz + -1;
      if ((int)_MaxCharCount < 1) {
        if (_FileHandle == 0xffffffff) {
          puVar4 = &DAT_100579a0;
        }
        else {
          puVar4 = (undefined *)
                   ((&DAT_10069600)[(int)_FileHandle >> 5] + (_FileHandle & 0x1f) * 0x24);
        }
        if ((puVar4[4] & 0x20) != 0) {
          __lseek(_FileHandle,0,2);
        }
      }
      else {
        _File = (FILE *)__write(_FileHandle,_Buf,(uint)_MaxCharCount);
      }
      *_File_00->_base = (char)_Ch;
    }
    if (_File == _MaxCharCount) {
      return _Ch & 0xff;
    }
    _File_00->_flag = _File_00->_flag | 0x20;
  }
  return -1;
}



// Library Function - Single Match
//  _write_char
// 
// Library: Visual Studio 2003 Release

void __cdecl write_char(void)

{
  int *piVar1;
  byte in_AL;
  uint uVar2;
  FILE *in_ECX;
  int *unaff_ESI;
  
  if (((in_ECX->_flag & 0x40) == 0) || (in_ECX->_base != (char *)0x0)) {
    piVar1 = &in_ECX->_cnt;
    *piVar1 = *piVar1 + -1;
    if (*piVar1 < 0) {
      uVar2 = __flsbuf((int)(char)in_AL,in_ECX);
    }
    else {
      *in_ECX->_ptr = in_AL;
      in_ECX->_ptr = in_ECX->_ptr + 1;
      uVar2 = (uint)in_AL;
    }
    if (uVar2 == 0xffffffff) {
      *unaff_ESI = -1;
      return;
    }
  }
  *unaff_ESI = *unaff_ESI + 1;
  return;
}



// Library Function - Single Match
//  _write_multi_char
// 
// Library: Visual Studio 2003 Release

void __cdecl write_multi_char(undefined4 param_1,int param_2)

{
  int *in_EAX;
  
  do {
    if (param_2 < 1) {
      return;
    }
    param_2 = param_2 + -1;
    write_char();
  } while (*in_EAX != -1);
  return;
}



// Library Function - Single Match
//  _write_string
// 
// Library: Visual Studio 2003 Release

void __cdecl write_string(int param_1)

{
  int *in_EAX;
  int unaff_EDI;
  
  if (((*(byte *)(unaff_EDI + 0xc) & 0x40) == 0) || (*(int *)(unaff_EDI + 8) != 0)) {
    do {
      if (param_1 < 1) {
        return;
      }
      param_1 = param_1 + -1;
      write_char();
    } while (*in_EAX != -1);
  }
  else {
    *in_EAX = *in_EAX + param_1;
  }
  return;
}



// WARNING: Type propagation algorithm not settling
// Library Function - Single Match
//  __output
// 
// Library: Visual Studio 2003 Release

void __cdecl __output(undefined4 param_1,byte *param_2,wchar_t *param_3)

{
  byte bVar1;
  short *psVar2;
  byte *pbVar3;
  wchar_t *pwVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int extraout_ECX;
  uint uVar8;
  byte bVar9;
  wchar_t *pwVar10;
  wchar_t *pwVar11;
  bool bVar12;
  undefined8 uVar13;
  undefined4 local_258;
  undefined4 local_254;
  size_t local_24c;
  int local_248;
  undefined4 local_244;
  int local_240;
  int local_23c;
  wchar_t *local_238;
  int local_234;
  int local_230;
  int local_22c;
  undefined1 local_228;
  char local_227;
  int local_224;
  size_t local_220;
  wchar_t *local_21c;
  int local_218;
  uint local_214;
  wchar_t local_210 [255];
  undefined2 local_11;
  int local_8;
  
  local_8 = DAT_10057438;
  local_220 = 0;
  local_224 = 0;
  local_238 = (wchar_t *)0x0;
  bVar9 = *param_2;
  iVar7 = 0;
  pbVar3 = param_2;
  pwVar11 = param_3;
  do {
    if ((bVar9 == 0) || (param_2 = pbVar3 + 1, local_224 < 0)) {
      FUN_1003fb09(local_8);
      return;
    }
    if (((char)bVar9 < ' ') || ('x' < (char)bVar9)) {
      uVar5 = 0;
    }
    else {
      uVar5 = (int)"GAIsProcessorFeaturePresent"[(char)bVar9 + 0x1a] & 0xf;
    }
    local_248 = (int)(char)(&DAT_10054740)[uVar5 * 8 + iVar7] >> 4;
    param_3 = pwVar11;
    switch(local_248) {
    case 0:
switchD_10042a59_caseD_0:
      local_234 = 0;
      if ((PTR_DAT_10057da8[(uint)bVar9 * 2 + 1] & 0x80) != 0) {
        write_char();
        param_2 = pbVar3 + 2;
      }
      write_char();
      break;
    case 1:
      local_218 = -1;
      local_244 = 0;
      local_23c = 0;
      local_230 = 0;
      local_22c = 0;
      local_214 = 0;
      local_234 = 0;
      break;
    case 2:
      if (bVar9 == 0x20) {
        local_214 = local_214 | 2;
      }
      else if (bVar9 == 0x23) {
        local_214 = local_214 | 0x80;
      }
      else if (bVar9 == 0x2b) {
        local_214 = local_214 | 1;
      }
      else if (bVar9 == 0x2d) {
        local_214 = local_214 | 4;
      }
      else if (bVar9 == 0x30) {
        local_214 = local_214 | 8;
      }
      break;
    case 3:
      if (bVar9 == 0x2a) {
        local_230 = *(int *)pwVar11;
        param_3 = pwVar11 + 2;
        if (local_230 < 0) {
          local_214 = local_214 | 4;
          local_230 = -local_230;
        }
      }
      else {
        local_230 = (char)bVar9 + -0x30 + local_230 * 10;
      }
      break;
    case 4:
      local_218 = 0;
      break;
    case 5:
      if (bVar9 == 0x2a) {
        local_218 = *(int *)pwVar11;
        param_3 = pwVar11 + 2;
        if (local_218 < 0) {
          local_218 = -1;
        }
      }
      else {
        local_218 = (char)bVar9 + -0x30 + local_218 * 10;
      }
      break;
    case 6:
      if (bVar9 == 0x49) {
        bVar1 = *param_2;
        if ((bVar1 == 0x36) && (pbVar3[2] == 0x34)) {
          param_2 = pbVar3 + 3;
          local_214 = local_214 | 0x8000;
        }
        else if ((bVar1 == 0x33) && (pbVar3[2] == 0x32)) {
          param_2 = pbVar3 + 3;
          local_214 = local_214 & 0xffff7fff;
        }
        else if (((((bVar1 != 100) && (bVar1 != 0x69)) && (bVar1 != 0x6f)) &&
                 ((bVar1 != 0x75 && (bVar1 != 0x78)))) && (bVar1 != 0x58)) {
          local_248 = 0;
          goto switchD_10042a59_caseD_0;
        }
      }
      else if (bVar9 == 0x68) {
        local_214 = local_214 | 0x20;
      }
      else if (bVar9 == 0x6c) {
        local_214 = local_214 | 0x10;
      }
      else if (bVar9 == 0x77) {
        local_214 = local_214 | 0x800;
      }
      break;
    case 7:
      if ((char)bVar9 < 'h') {
        if ((char)bVar9 < 'e') {
          if ((char)bVar9 < 'Y') {
            if (bVar9 != 0x58) {
              if (bVar9 == 0x43) {
                if ((local_214 & 0x830) == 0) {
                  local_214 = local_214 | 0x800;
                }
                goto LAB_10042cf9;
              }
              if ((bVar9 != 0x45) && (bVar9 != 0x47)) {
                if (bVar9 == 0x53) {
                  if ((local_214 & 0x830) == 0) {
                    local_214 = local_214 | 0x800;
                  }
                  goto LAB_10042c7c;
                }
                goto LAB_10043071;
              }
              local_244 = 1;
              bVar9 = bVar9 + 0x20;
              goto LAB_10042ccd;
            }
LAB_10042f17:
            local_240 = 7;
LAB_10042f1a:
            local_220 = 0x10;
            if ((local_214 & 0x80) != 0) {
              local_227 = (char)local_240 + 'Q';
              local_228 = 0x30;
              local_22c = 2;
            }
            goto LAB_10042d4a;
          }
          if (bVar9 == 0x5a) {
            param_3 = pwVar11 + 2;
            psVar2 = *(short **)pwVar11;
            pwVar11 = (wchar_t *)PTR_s__null__10057988;
            pwVar4 = (wchar_t *)PTR_s__null__10057988;
            if ((psVar2 == (short *)0x0) ||
               (local_21c = *(wchar_t **)(psVar2 + 2), pwVar4 = (wchar_t *)PTR_s__null__10057988,
               local_21c == (wchar_t *)0x0)) goto LAB_10042e8b;
            local_220 = (size_t)*psVar2;
            if ((local_214 & 0x800) == 0) {
              local_234 = 0;
            }
            else {
              local_220 = (int)local_220 / 2;
              local_234 = 1;
            }
          }
          else if (bVar9 == 99) {
LAB_10042cf9:
            if ((local_214 & 0x810) == 0) {
              local_210[0]._0_1_ = (char)*pwVar11;
              local_220 = 1;
            }
            else {
              local_220 = _wctomb((char *)local_210,*pwVar11);
              if ((int)local_220 < 0) {
                local_23c = 1;
              }
            }
            param_3 = pwVar11 + 2;
            local_21c = local_210;
          }
          else if (bVar9 == 100) goto LAB_10042d3f;
        }
        else {
LAB_10042ccd:
          local_214 = local_214 | 0x40;
          pwVar10 = local_210;
          pwVar4 = local_210;
          if (local_218 < 0) {
            local_218 = 6;
          }
          else if (local_218 == 0) {
            if (bVar9 == 0x67) {
              local_218 = 1;
            }
          }
          else {
            if (0x200 < local_218) {
              local_218 = 0x200;
            }
            if ((0xa3 < local_218) &&
               (local_21c = local_210, local_238 = (wchar_t *)_malloc(local_218 + 0x15d),
               pwVar10 = local_238, pwVar4 = local_238, local_238 == (wchar_t *)0x0)) {
              local_218 = 0xa3;
              pwVar10 = local_210;
              pwVar4 = local_21c;
            }
          }
          local_21c = pwVar4;
          local_258 = *(undefined4 *)pwVar11;
          param_3 = pwVar11 + 4;
          local_254 = *(undefined4 *)(pwVar11 + 2);
          (*(code *)PTR___fptrap_10057850)(&local_258,pwVar10,(int)(char)bVar9,local_218,local_244);
          uVar5 = local_214 & 0x80;
          if ((uVar5 != 0) && (local_218 == 0)) {
            (*(code *)PTR___fptrap_1005785c)(pwVar10);
          }
          if ((bVar9 == 0x67) && (uVar5 == 0)) {
            (*(code *)PTR___fptrap_10057854)(pwVar10);
          }
          pwVar11 = pwVar10;
          pwVar4 = local_21c;
          if ((char)*pwVar10 == '-') {
            local_214 = local_214 | 0x100;
            pwVar11 = (wchar_t *)((int)pwVar10 + 1);
            pwVar4 = (wchar_t *)((int)pwVar10 + 1);
          }
LAB_10042e8b:
          local_21c = pwVar4;
          local_220 = _strlen((char *)pwVar11);
        }
LAB_10043071:
        uVar5 = local_214;
        if (local_23c == 0) {
          if ((local_214 & 0x40) != 0) {
            if ((local_214 & 0x100) == 0) {
              if ((local_214 & 1) == 0) {
                if ((local_214 & 2) == 0) goto LAB_100430a9;
                local_228 = 0x20;
              }
              else {
                local_228 = 0x2b;
              }
            }
            else {
              local_228 = 0x2d;
            }
            local_22c = 1;
          }
LAB_100430a9:
          iVar7 = (local_230 - local_22c) - local_220;
          if ((local_214 & 0xc) == 0) {
            write_multi_char(0x20,iVar7);
          }
          write_string(local_22c);
          if (((uVar5 & 8) != 0) && ((uVar5 & 4) == 0)) {
            write_multi_char(0x30,iVar7);
          }
          if ((local_234 == 0) || ((int)local_220 < 1)) {
            write_string(local_220);
          }
          else {
            local_24c = local_220;
            pwVar11 = local_21c;
            do {
              local_24c = local_24c - 1;
              iVar6 = _wctomb((char *)((int)&local_11 + 1),*pwVar11);
              pwVar11 = pwVar11 + 1;
              if (iVar6 < 1) break;
              write_string(iVar6);
            } while (local_24c != 0);
          }
          if ((local_214 & 4) != 0) {
            write_multi_char(0x20,iVar7);
          }
        }
      }
      else {
        if (bVar9 == 0x69) {
LAB_10042d3f:
          local_214 = local_214 | 0x40;
LAB_10042d43:
          local_220 = 10;
LAB_10042d4a:
          if ((local_214 & 0x8000) == 0) {
            param_3 = pwVar11 + 2;
            if ((local_214 & 0x20) == 0) {
              uVar5 = *(uint *)pwVar11;
              if ((local_214 & 0x40) == 0) {
                uVar8 = 0;
                goto LAB_10042fbb;
              }
            }
            else if ((local_214 & 0x40) == 0) {
              uVar5 = (uint)(ushort)*pwVar11;
            }
            else {
              uVar5 = (uint)*pwVar11;
            }
            uVar8 = (int)uVar5 >> 0x1f;
          }
          else {
            uVar5 = *(uint *)pwVar11;
            uVar8 = *(uint *)(pwVar11 + 2);
            param_3 = pwVar11 + 4;
          }
LAB_10042fbb:
          if ((((local_214 & 0x40) != 0) && ((int)uVar8 < 1)) && ((int)uVar8 < 0)) {
            bVar12 = uVar5 != 0;
            uVar5 = -uVar5;
            uVar8 = -(uVar8 + bVar12);
            local_214 = local_214 | 0x100;
          }
          uVar13 = CONCAT44(uVar8,uVar5);
          if ((local_214 & 0x8000) == 0) {
            uVar8 = 0;
          }
          if (local_218 < 0) {
            local_218 = 1;
          }
          else {
            local_214 = local_214 & 0xfffffff7;
            if (0x200 < local_218) {
              local_218 = 0x200;
            }
          }
          if (uVar5 == 0 && uVar8 == 0) {
            local_22c = 0;
          }
          pwVar11 = &local_11;
          while( true ) {
            uVar5 = (uint)uVar13;
            iVar7 = local_218 + -1;
            if ((local_218 < 1) && (uVar5 == 0 && uVar8 == 0)) break;
            local_218 = iVar7;
            uVar13 = __aulldvrm(uVar5,uVar8,local_220,(int)local_220 >> 0x1f);
            uVar8 = (uint)((ulonglong)uVar13 >> 0x20);
            iVar7 = extraout_ECX + 0x30;
            if (0x39 < iVar7) {
              iVar7 = iVar7 + local_240;
            }
            *(char *)pwVar11 = (char)iVar7;
            pwVar11 = (wchar_t *)((int)pwVar11 + -1);
            local_24c = uVar5;
          }
          local_220 = (int)&local_11 + -(int)pwVar11;
          local_21c = (wchar_t *)((int)pwVar11 + 1);
          local_218 = iVar7;
          if (((local_214 & 0x200) != 0) && ((*(char *)local_21c != '0' || (local_220 == 0)))) {
            *(char *)pwVar11 = '0';
            local_220 = (int)&local_11 + -(int)pwVar11 + 1;
            local_21c = pwVar11;
          }
          goto LAB_10043071;
        }
        if (bVar9 != 0x6e) {
          if (bVar9 == 0x6f) {
            local_220 = 8;
            if ((local_214 & 0x80) != 0) {
              local_214 = local_214 | 0x200;
            }
            goto LAB_10042d4a;
          }
          if (bVar9 == 0x70) {
            local_218 = 8;
            goto LAB_10042f17;
          }
          if (bVar9 == 0x73) {
LAB_10042c7c:
            iVar7 = local_218;
            if (local_218 == -1) {
              iVar7 = 0x7fffffff;
            }
            param_3 = pwVar11 + 2;
            local_21c = *(wchar_t **)pwVar11;
            if ((local_214 & 0x810) == 0) {
              pwVar11 = local_21c;
              if (local_21c == (wchar_t *)0x0) {
                pwVar11 = (wchar_t *)PTR_s__null__10057988;
                local_21c = (wchar_t *)PTR_s__null__10057988;
              }
              for (; (iVar7 != 0 && (iVar7 = iVar7 + -1, (char)*pwVar11 != '\0'));
                  pwVar11 = (wchar_t *)((int)pwVar11 + 1)) {
              }
              local_220 = (int)pwVar11 - (int)local_21c;
            }
            else {
              if (local_21c == (wchar_t *)0x0) {
                local_21c = (wchar_t *)PTR_DAT_1005798c;
              }
              local_234 = 1;
              for (pwVar11 = local_21c; (iVar7 != 0 && (iVar7 = iVar7 + -1, *pwVar11 != L'\0'));
                  pwVar11 = pwVar11 + 1) {
              }
              local_220 = (int)pwVar11 - (int)local_21c >> 1;
            }
            goto LAB_10043071;
          }
          if (bVar9 != 0x75) {
            if (bVar9 != 0x78) goto LAB_10043071;
            local_240 = 0x27;
            goto LAB_10042f1a;
          }
          goto LAB_10042d43;
        }
        param_3 = pwVar11 + 2;
        if ((local_214 & 0x20) == 0) {
          **(int **)pwVar11 = local_224;
        }
        else {
          *(undefined2 *)*(int **)pwVar11 = (undefined2)local_224;
        }
        local_23c = 1;
      }
      if (local_238 != (wchar_t *)0x0) {
        _free(local_238);
        local_238 = (wchar_t *)0x0;
      }
    }
    bVar9 = *param_2;
    iVar7 = local_248;
    pbVar3 = param_2;
    pwVar11 = param_3;
  } while( true );
}



// Library Function - Single Match
//  int __cdecl TypeMatch(struct _s_HandlerType const *,struct _s_CatchableType const *,struct
// _s_ThrowInfo const *)
// 
// Library: Visual Studio 2003 Release

int __cdecl TypeMatch(_s_HandlerType *param_1,_s_CatchableType *param_2,_s_ThrowInfo *param_3)

{
  int iVar1;
  byte *unaff_ESI;
  byte *unaff_EDI;
  
  iVar1 = *(int *)(unaff_ESI + 4);
  if ((iVar1 != 0) && (*(char *)(iVar1 + 8) != '\0')) {
    if ((iVar1 != *(int *)(unaff_EDI + 4)) &&
       (iVar1 = _strcmp((char *)(iVar1 + 8),(char *)(*(int *)(unaff_EDI + 4) + 8)), iVar1 != 0)) {
      return 0;
    }
    if (((((*unaff_EDI & 2) != 0) && ((*unaff_ESI & 8) == 0)) ||
        (((param_1->adjectives & 1) != 0 && ((*unaff_ESI & 1) == 0)))) ||
       (((param_1->adjectives & 2) != 0 && ((*unaff_ESI & 2) == 0)))) {
      return 0;
    }
  }
  return 1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___FrameUnwindToState
// 
// Library: Visual Studio 2003 Release

void __cdecl ___FrameUnwindToState(int param_1,undefined4 param_2,int param_3,int param_4)

{
  _ptiddata p_Var1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = *(int *)(param_1 + 8);
  p_Var1 = __getptd();
  p_Var1->_purecall = (void *)((int)p_Var1->_purecall + 1);
  while (iVar4 != param_4) {
    if ((iVar4 < 0) || (*(int *)(param_3 + 4) <= iVar4)) {
      _inconsistency();
    }
    iVar2 = iVar4 * 8;
    piVar3 = (int *)(*(int *)(param_3 + 8) + iVar2);
    iVar4 = *piVar3;
    if (piVar3[1] != 0) {
      *(int *)(param_1 + 8) = iVar4;
      __CallSettingFrame_12(*(undefined4 *)(*(int *)(param_3 + 8) + 4 + iVar2),param_1,0x103);
    }
  }
  FUN_100432ee();
  if (iVar4 != param_4) {
    _inconsistency();
  }
  *(int *)(param_1 + 8) = iVar4;
  return;
}



void FUN_100432ee(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  if (0 < (int)p_Var1->_purecall) {
    p_Var1 = __getptd();
    p_Var1->_purecall = (void *)((int)p_Var1->_purecall + -1);
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___DestructExceptionObject
// 
// Library: Visual Studio 2003 Release

void __cdecl ___DestructExceptionObject(int param_1)

{
  undefined *UNRECOVERED_JUMPTABLE;
  
  if ((param_1 != 0) &&
     (UNRECOVERED_JUMPTABLE = *(undefined **)(*(int *)(param_1 + 0x1c) + 4),
     UNRECOVERED_JUMPTABLE != (undefined *)0x0)) {
    FID_conflict__CallMemberFunction1(*(undefined4 *)(param_1 + 0x18),UNRECOVERED_JUMPTABLE);
  }
  return;
}



// Library Function - Single Match
//  void * __cdecl AdjustPointer(void *,struct PMD const &)
// 
// Library: Visual Studio 2003 Release

void * __cdecl AdjustPointer(void *param_1,PMD *param_2)

{
  int in_EAX;
  void *pvVar1;
  int *in_ECX;
  
  pvVar1 = (void *)(*in_ECX + in_EAX);
  if (-1 < in_ECX[1]) {
    pvVar1 = (void *)((int)pvVar1 + *(int *)(*(int *)(in_ECX[1] + in_EAX) + in_ECX[2]) + in_ECX[1]);
  }
  return pvVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  void * __cdecl CallCatchBlock(struct EHExceptionRecord *,struct EHRegistrationNode *,struct
// _CONTEXT *,struct _s_FuncInfo const *,void *,int,unsigned long)
// 
// Library: Visual Studio 2003 Release

void * __cdecl
CallCatchBlock(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,
              _s_FuncInfo *param_4,void *param_5,int param_6,ulong param_7)

{
  _ptiddata p_Var1;
  void *in_ECX;
  FrameInfo local_54 [8];
  undefined4 local_4c;
  void *local_48;
  void *local_44;
  FrameInfo *local_40;
  undefined4 local_3c;
  void *local_24;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_100547e0;
  uStack_c = 0x10043379;
  local_4c = 0;
  local_3c = *(undefined4 *)(param_2 + -4);
  local_40 = _CreateFrameInfo(local_54,*(void **)(param_1 + 0x18));
  p_Var1 = __getptd();
  local_44 = p_Var1->_unexpected;
  p_Var1 = __getptd();
  local_48 = p_Var1->_translator;
  p_Var1 = __getptd();
  p_Var1->_unexpected = param_1;
  p_Var1 = __getptd();
  p_Var1->_translator = param_3;
  local_8 = (undefined *)0x1;
  local_24 = _CallCatchBlock2(param_2,param_4,in_ECX,(int)param_5,param_6);
  local_8 = (undefined *)0xffffffff;
  FUN_100434c2();
  return local_24;
}



void FUN_100434c2(void)

{
  _ptiddata p_Var1;
  int iVar2;
  int unaff_EBP;
  int *unaff_ESI;
  int unaff_EDI;
  
  *(undefined4 *)(unaff_EDI + -4) = *(undefined4 *)(unaff_EBP + -0x38);
  _FindAndUnlinkFrame(*(FrameInfo **)(unaff_EBP + -0x3c));
  p_Var1 = __getptd();
  p_Var1->_unexpected = *(void **)(unaff_EBP + -0x40);
  p_Var1 = __getptd();
  p_Var1->_translator = *(void **)(unaff_EBP + -0x44);
  if ((((*unaff_ESI == -0x1f928c9d) && (unaff_ESI[4] == 3)) &&
      ((unaff_ESI[5] == 0x19930520 || (unaff_ESI[5] == 0x19930521)))) &&
     ((*(int *)(unaff_EBP + -0x48) == 0 && (*(int *)(unaff_EBP + -0x20) != 0)))) {
    iVar2 = IsExceptionObjectToBeDestroyed((void *)unaff_ESI[6]);
    if (iVar2 != 0) {
      __abnormal_termination();
      ___DestructExceptionObject((int)unaff_ESI);
    }
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  void __cdecl BuildCatchObject(struct EHExceptionRecord *,void *,struct _s_HandlerType const
// *,struct _s_CatchableType const *)
// 
// Library: Visual Studio 2003 Release

void __cdecl
BuildCatchObject(EHExceptionRecord *param_1,void *param_2,_s_HandlerType *param_3,
                _s_CatchableType *param_4)

{
  int iVar1;
  void *pvVar2;
  void *_Src;
  byte *in_ECX;
  int *in_EDX;
  PMD *unaff_ESI;
  PMD *unaff_EDI;
  
  if (*(int *)((int)param_2 + 4) == 0) {
    return;
  }
  if (*(char *)(*(int *)((int)param_2 + 4) + 8) == '\0') {
    return;
  }
  if ((*(int *)((int)param_2 + 8) == 0) && ((*(byte *)((int)param_2 + 3) & 0x80) == 0)) {
    return;
  }
                    // WARNING: Load size is inaccurate
  if (-1 < (int)*param_2) {
    in_EDX = (int *)(*(int *)((int)param_2 + 8) + 0xc + (int)in_EDX);
  }
  pvVar2 = *(void **)(param_1 + 0x18);
  if ((*param_2 & 8) == 0) {
    if ((*in_ECX & 1) == 0) {
      if (*(int *)(in_ECX + 0x18) == 0) {
        iVar1 = _ValidateRead(pvVar2,1);
        if ((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) {
          pvVar2 = *(void **)(in_ECX + 0x14);
          _Src = AdjustPointer(pvVar2,unaff_EDI);
          _memmove(in_EDX,_Src,(size_t)pvVar2);
          return;
        }
      }
      else {
        iVar1 = _ValidateRead(pvVar2,1);
        if (((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) &&
           (iVar1 = _ValidateExecute(*(_func_int **)(in_ECX + 0x18)), iVar1 != 0)) {
          if ((*in_ECX & 4) != 0) {
            AdjustPointer((void *)0x1,unaff_EDI);
            FID_conflict__CallMemberFunction1(in_EDX,*(undefined **)(in_ECX + 0x18));
            return;
          }
          AdjustPointer(unaff_EDI,unaff_ESI);
          FID_conflict__CallMemberFunction1(in_EDX,*(undefined **)(in_ECX + 0x18));
          return;
        }
      }
    }
    else {
      iVar1 = _ValidateRead(pvVar2,1);
      if ((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) {
        _memmove(in_EDX,*(void **)(param_1 + 0x18),*(size_t *)(in_ECX + 0x14));
        if (*(int *)(in_ECX + 0x14) != 4) {
          return;
        }
        if (*in_EDX == 0) {
          return;
        }
        goto LAB_100435aa;
      }
    }
  }
  else {
    iVar1 = _ValidateRead(pvVar2,1);
    if ((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) {
      *in_EDX = *(int *)(param_1 + 0x18);
LAB_100435aa:
      pvVar2 = AdjustPointer(unaff_EDI,unaff_ESI);
      *in_EDX = (int)pvVar2;
      return;
    }
  }
  _inconsistency();
  return;
}



// Library Function - Single Match
//  void __cdecl CatchIt(struct EHExceptionRecord *,struct EHRegistrationNode *,struct _CONTEXT
// *,void *,struct _s_FuncInfo const *,struct _s_HandlerType const *,struct _s_CatchableType const
// *,struct _s_TryBlockMapEntry const *,int,struct EHRegistrationNode *,unsigned char)
// 
// Library: Visual Studio 2003 Release

void __cdecl
CatchIt(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
       _s_FuncInfo *param_5,_s_HandlerType *param_6,_s_CatchableType *param_7,
       _s_TryBlockMapEntry *param_8,int param_9,EHRegistrationNode *param_10,uchar param_11)

{
  void *pvVar1;
  int in_ECX;
  void *unaff_EBX;
  _s_HandlerType *unaff_EBP;
  _s_HandlerType *unaff_ESI;
  int *unaff_EDI;
  _s_CatchableType *unaff_retaddr;
  _s_HandlerType *p_Var2;
  
  if (in_ECX != 0) {
    BuildCatchObject(param_1,unaff_EBX,unaff_EBP,unaff_retaddr);
  }
  if (param_6 == (_s_HandlerType *)0x0) {
    param_6 = unaff_ESI;
  }
  _UnwindNestedFrames((EHRegistrationNode *)param_6,param_1);
  p_Var2 = unaff_ESI;
  ___FrameUnwindToState((int)unaff_ESI,param_3,(int)param_4,*unaff_EDI);
  unaff_ESI->dispCatchObj = unaff_EDI[1] + 1;
  pvVar1 = CallCatchBlock(param_1,(EHRegistrationNode *)unaff_ESI,(_CONTEXT *)param_2,
                          (_s_FuncInfo *)param_4,param_5,0x100,(ulong)p_Var2);
  if (pvVar1 != (void *)0x0) {
    _JumpToContinuation(pvVar1,(EHRegistrationNode *)unaff_ESI);
  }
  return;
}



// Library Function - Single Match
//  void __cdecl FindHandlerForForeignException(struct EHExceptionRecord *,struct EHRegistrationNode
// *,struct _CONTEXT *,void *,struct _s_FuncInfo const *,int,int,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

void __cdecl
FindHandlerForForeignException
          (EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
          _s_FuncInfo *param_5,int param_6,int param_7,EHRegistrationNode *param_8)

{
  TypeDescriptor *pTVar1;
  _ptiddata p_Var2;
  int iVar3;
  _s_TryBlockMapEntry *p_Var4;
  _s_CatchableType *unaff_EBX;
  int unaff_ESI;
  _s_TryBlockMapEntry *unaff_EDI;
  EHRegistrationNode *extraout_var;
  EHRegistrationNode *pEVar5;
  EHRegistrationNode *extraout_var_00;
  EHRegistrationNode *pEVar6;
  
  if ((*(int *)param_1 != -0x7ffffffd) &&
     (((p_Var2 = __getptd(), pEVar5 = extraout_var, pEVar6 = extraout_var_00,
       p_Var2->_NLG_dwCode == 0 ||
       (iVar3 = _CallSETranslator(param_1,param_2,param_3,param_4,param_5,param_7,param_8),
       iVar3 == 0)) &&
      (p_Var4 = _GetRangeOfTrysToCheck
                          (param_5,param_7,param_6,(uint *)&stack0xfffffff8,(uint *)&stack0xfffffff4
                          ), pEVar6 < pEVar5)))) {
    do {
      if (((p_Var4->tryLow <= param_6) && (param_6 <= p_Var4->tryHigh)) &&
         ((pTVar1 = p_Var4->pHandlerArray[p_Var4->nCatches + -1].pType,
          pTVar1 == (TypeDescriptor *)0x0 || (*(char *)&pTVar1[1].pVFTable == '\0')))) {
        CatchIt(param_1,(EHRegistrationNode *)param_3,(_CONTEXT *)param_4,param_5,
                (_s_FuncInfo *)param_7,(_s_HandlerType *)param_8,unaff_EBX,unaff_EDI,unaff_ESI,
                pEVar5,(uchar)pEVar6);
      }
      pEVar6 = pEVar6 + 1;
      p_Var4 = p_Var4 + 1;
    } while (pEVar6 < pEVar5);
  }
  return;
}



// Library Function - Single Match
//  void __cdecl FindHandler(struct EHExceptionRecord *,struct EHRegistrationNode *,struct _CONTEXT
// *,void *,struct _s_FuncInfo const *,unsigned char,int,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

void __cdecl
FindHandler(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
           _s_FuncInfo *param_5,uchar param_6,int param_7,EHRegistrationNode *param_8)

{
  int iVar1;
  int iVar2;
  _ptiddata p_Var3;
  int iVar4;
  _s_TryBlockMapEntry *p_Var5;
  int iVar6;
  int unaff_EBX;
  _s_TryBlockMapEntry *unaff_ESI;
  _s_CatchableType *unaff_EDI;
  EHRegistrationNode *pEVar7;
  uint in_stack_ffffffdc;
  int *local_14;
  uint local_10;
  _s_TryBlockMapEntry *local_c;
  undefined1 local_5;
  
  iVar1 = *(int *)(param_2 + 8);
  local_5 = 0;
  if ((iVar1 < -1) || (param_5->maxState <= iVar1)) {
    _inconsistency();
  }
  if (*(int *)param_1 == -0x1f928c9d) {
    if ((*(int *)(param_1 + 0x10) == 3) &&
       (((*(int *)(param_1 + 0x14) == 0x19930520 || (*(int *)(param_1 + 0x14) == 0x19930521)) &&
        (*(int *)(param_1 + 0x1c) == 0)))) {
      p_Var3 = __getptd();
      if (p_Var3->_unexpected == (void *)0x0) {
        return;
      }
      p_Var3 = __getptd();
      param_1 = (EHExceptionRecord *)p_Var3->_unexpected;
      p_Var3 = __getptd();
      param_3 = (_CONTEXT *)p_Var3->_translator;
      local_5 = 1;
      iVar4 = _ValidateRead(param_1,1);
      if (iVar4 == 0) {
        _inconsistency();
      }
      if (*(int *)param_1 != -0x1f928c9d) goto LAB_100439ab;
      if (((*(int *)(param_1 + 0x10) == 3) &&
          ((*(int *)(param_1 + 0x14) == 0x19930520 || (*(int *)(param_1 + 0x14) == 0x19930521)))) &&
         (*(int *)(param_1 + 0x1c) == 0)) {
        _inconsistency();
      }
    }
    if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)(param_1 + 0x10) == 3)) &&
       ((*(int *)(param_1 + 0x14) == 0x19930520 || (*(int *)(param_1 + 0x14) == 0x19930521)))) {
      p_Var5 = _GetRangeOfTrysToCheck(param_5,param_7,iVar1,&local_10,(uint *)&stack0xffffffdc);
      local_c = p_Var5;
      if (local_10 < in_stack_ffffffdc) {
        do {
          if ((p_Var5->tryLow <= iVar1) && (iVar1 <= p_Var5->tryHigh)) {
            local_c = p_Var5;
            for (iVar4 = p_Var5->nCatches; 0 < iVar4; iVar4 = iVar4 + -1) {
              local_14 = *(int **)(*(int *)(param_1 + 0x1c) + 0xc);
              for (iVar2 = *local_14; 0 < iVar2; iVar2 = iVar2 + -1) {
                local_14 = local_14 + 1;
                pEVar7 = (EHRegistrationNode *)*local_14;
                iVar6 = TypeMatch(*(_s_HandlerType **)(param_1 + 0x1c),unaff_EDI,
                                  (_s_ThrowInfo *)unaff_ESI);
                p_Var5 = local_c;
                if (iVar6 != 0) {
                  CatchIt(param_1,(EHRegistrationNode *)param_3,(_CONTEXT *)param_4,param_5,
                          (_s_FuncInfo *)param_7,(_s_HandlerType *)param_8,unaff_EDI,unaff_ESI,
                          unaff_EBX,pEVar7,(uchar)in_stack_ffffffdc);
                  goto LAB_1004397e;
                }
              }
            }
          }
LAB_1004397e:
          local_10 = local_10 + 1;
          p_Var5 = p_Var5 + 1;
          local_c = p_Var5;
        } while (local_10 < in_stack_ffffffdc);
      }
      if (param_6 == '\0') {
        return;
      }
      ___DestructExceptionObject((int)param_1);
      return;
    }
  }
LAB_100439ab:
  if (param_6 == '\0') {
    FindHandlerForForeignException(param_1,param_2,param_3,param_4,param_5,iVar1,param_7,param_8);
    return;
  }
  terminate();
  return;
}



// Library Function - Single Match
//  ___InternalCxxFrameHandler
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl
___InternalCxxFrameHandler
          (EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
          _s_FuncInfo *param_5,int param_6,EHRegistrationNode *param_7,uchar param_8)

{
  undefined4 uVar1;
  
  if ((param_5->magicNumber_and_bbtFlags & 0x1fffffff) != 0x19930520) {
    _inconsistency();
  }
  if (((byte)param_1[4] & 0x66) == 0) {
    if (param_5->nTryBlocks != 0) {
      if (((*(int *)param_1 == -0x1f928c9d) && (0x19930520 < *(uint *)(param_1 + 0x14))) &&
         (*(code **)(*(int *)(param_1 + 0x1c) + 8) != (code *)0x0)) {
        uVar1 = (**(code **)(*(int *)(param_1 + 0x1c) + 8))
                          (param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
        return uVar1;
      }
      FindHandler(param_1,param_2,param_3,param_4,param_5,param_8,param_6,param_7);
    }
  }
  else if ((param_5->maxState != 0) && (param_6 == 0)) {
    ___FrameUnwindToState((int)param_2,param_4,(int)param_5,-1);
  }
  return 1;
}



void FUN_10043a78(void)

{
  TlsAlloc();
  return;
}



// Library Function - Single Match
//  __mtterm
// 
// Library: Visual Studio 2003 Release

void __cdecl __mtterm(void)

{
  if (DAT_10057994 != -1) {
    (*DAT_1006902c)(DAT_10057994);
    DAT_10057994 = -1;
  }
  __mtdeletelocks();
  return;
}



// Library Function - Single Match
//  __initptd
// 
// Library: Visual Studio 2003 Release

void __cdecl __initptd(_ptiddata _Ptd,pthreadlocinfo _Locale)

{
  _Ptd->_initaddr = &DAT_100579c8;
  _Ptd->_holdrand = 1;
  return;
}



// Library Function - Single Match
//  __getptd
// 
// Library: Visual Studio 2003 Release

_ptiddata __cdecl __getptd(void)

{
  DWORD dwErrCode;
  _ptiddata p_Var1;
  int iVar2;
  DWORD DVar3;
  
  dwErrCode = GetLastError();
  p_Var1 = (_ptiddata)(*DAT_10069024)(DAT_10057994);
  if (p_Var1 == (_ptiddata)0x0) {
    p_Var1 = (_ptiddata)_calloc(1,0x8c);
    if (p_Var1 != (_ptiddata)0x0) {
      iVar2 = (*DAT_10069028)(DAT_10057994,p_Var1);
      if (iVar2 != 0) {
        p_Var1->_initaddr = &DAT_100579c8;
        p_Var1->_holdrand = 1;
        DVar3 = GetCurrentThreadId();
        p_Var1->_thandle = 0xffffffff;
        p_Var1->_tid = DVar3;
        goto LAB_10043b16;
      }
    }
    __amsg_exit(0x10);
  }
LAB_10043b16:
  SetLastError(dwErrCode);
  return p_Var1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __freefls@4
// 
// Library: Visual Studio 2003 Release

void __freefls_4(void *param_1)

{
  int *piVar1;
  
  if (param_1 != (void *)0x0) {
    if (*(void **)((int)param_1 + 0x24) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x24));
    }
    if (*(void **)((int)param_1 + 0x2c) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x2c));
    }
    if (*(void **)((int)param_1 + 0x34) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x34));
    }
    if (*(void **)((int)param_1 + 0x3c) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x3c));
    }
    if (*(void **)((int)param_1 + 0x44) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x44));
    }
    if (*(void **)((int)param_1 + 0x48) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x48));
    }
    if (*(undefined **)((int)param_1 + 0x54) != &DAT_100579c8) {
      _free(*(undefined **)((int)param_1 + 0x54));
    }
    __lock(0xd);
    piVar1 = *(int **)((int)param_1 + 0x60);
    if (((piVar1 != (int *)0x0) && (*piVar1 = *piVar1 + -1, *piVar1 == 0)) &&
       (piVar1 != DAT_1006938c)) {
      _free(piVar1);
    }
    FUN_10043c54();
    __lock(0xc);
    piVar1 = *(int **)((int)param_1 + 100);
    if (piVar1 != (int *)0x0) {
      *piVar1 = *piVar1 + -1;
      if (piVar1[0xb] != 0) {
        *(int *)piVar1[0xb] = *(int *)piVar1[0xb] + -1;
      }
      if (piVar1[0xd] != 0) {
        *(int *)piVar1[0xd] = *(int *)piVar1[0xd] + -1;
      }
      if (piVar1[0xc] != 0) {
        *(int *)piVar1[0xc] = *(int *)piVar1[0xc] + -1;
      }
      if (piVar1[0x10] != 0) {
        *(int *)piVar1[0x10] = *(int *)piVar1[0x10] + -1;
      }
      *(int *)(piVar1[0x13] + 0xb4) = *(int *)(piVar1[0x13] + 0xb4) + -1;
      if (((piVar1 != (int *)PTR_DAT_10057c5c) && (piVar1 != &DAT_10057c08)) && (*piVar1 == 0)) {
        ___freetlocinfo(piVar1);
      }
    }
    FUN_10043c60();
    _free(param_1);
  }
  return;
}



void FUN_10043c54(void)

{
  FUN_100425f0(0xd);
  return;
}



void FUN_10043c60(void)

{
  FUN_100425f0(0xc);
  return;
}



// Library Function - Single Match
//  __freeptd
// 
// Library: Visual Studio 2003 Release

void __cdecl __freeptd(_ptiddata _Ptd)

{
  if (DAT_10057994 != -1) {
    if (_Ptd == (_ptiddata)0x0) {
      _Ptd = (_ptiddata)(*DAT_10069024)(DAT_10057994);
    }
    __freefls_4(_Ptd);
    (*DAT_10069028)(DAT_10057994,0);
  }
  return;
}



// Library Function - Single Match
//  __mtinit
// 
// Library: Visual Studio 2003 Release

int __cdecl __mtinit(void)

{
  int iVar1;
  HMODULE hModule;
  DWORD *pDVar2;
  DWORD DVar3;
  
  iVar1 = __mtinitlocks();
  if (iVar1 == 0) {
    __mtterm();
    return 0;
  }
  hModule = GetModuleHandleA("kernel32.dll");
  if (hModule != (HMODULE)0x0) {
    DAT_10069020 = GetProcAddress(hModule,"FlsAlloc");
    DAT_10069024 = GetProcAddress(hModule,"FlsGetValue");
    DAT_10069028 = GetProcAddress(hModule,"FlsSetValue");
    DAT_1006902c = GetProcAddress(hModule,"FlsFree");
    if (DAT_10069024 == (FARPROC)0x0) {
      DAT_10069024 = TlsGetValue_exref;
      DAT_10069028 = TlsSetValue_exref;
      DAT_10069020 = FUN_10043a78;
      DAT_1006902c = TlsFree_exref;
    }
  }
  DAT_10057994 = (*DAT_10069020)(__freefls_4);
  if (((DAT_10057994 != -1) && (pDVar2 = (DWORD *)_calloc(1,0x8c), pDVar2 != (DWORD *)0x0)) &&
     (iVar1 = (*DAT_10069028)(DAT_10057994,pDVar2), iVar1 != 0)) {
    pDVar2[0x15] = (DWORD)&DAT_100579c8;
    pDVar2[5] = 1;
    DVar3 = GetCurrentThreadId();
    pDVar2[1] = 0xffffffff;
    *pDVar2 = DVar3;
    return 1;
  }
  __mtterm();
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// Library Function - Single Match
//  void __cdecl terminate(void)
// 
// Library: Visual Studio 2003 Release

void __cdecl terminate(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  if (p_Var1->ptlocinfo != (pthreadlocinfo)0x0) {
    p_Var1 = __getptd();
    (*(code *)p_Var1->ptlocinfo)();
  }
                    // WARNING: Subroutine does not return
  _abort();
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// Library Function - Single Match
//  void __cdecl _inconsistency(void)
// 
// Library: Visual Studio 2003 Release

void __cdecl _inconsistency(void)

{
  if (PTR_terminate_10057998 != (undefined *)0x0) {
    (*(code *)PTR_terminate_10057998)();
  }
  terminate();
  return;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// Library Function - Single Match
//  __CallSettingFrame@12
// 
// Library: Visual Studio 2003 Release

void __CallSettingFrame_12(undefined4 param_1,undefined4 param_2,int param_3)

{
  code *pcVar1;
  
  pcVar1 = (code *)__NLG_Notify1(param_3);
  (*pcVar1)();
  if (param_3 == 0x100) {
    param_3 = 2;
  }
  __NLG_Notify1(param_3);
  return;
}



// Library Function - Single Match
//  ___security_init_cookie
// 
// Library: Visual Studio 2003 Release

void __cdecl ___security_init_cookie(void)

{
  DWORD DVar1;
  DWORD DVar2;
  DWORD DVar3;
  LARGE_INTEGER local_14;
  _FILETIME local_c;
  
  if ((DAT_10057438 == 0) || (DAT_10057438 == 0xbb40e64e)) {
    GetSystemTimeAsFileTime(&local_c);
    DVar1 = GetCurrentProcessId();
    DVar2 = GetCurrentThreadId();
    DVar3 = GetTickCount();
    QueryPerformanceCounter(&local_14);
    DAT_10057438 = local_c.dwHighDateTime ^ local_c.dwLowDateTime ^ DVar1 ^ DVar2 ^ DVar3 ^
                   local_14.s.HighPart ^ local_14.s.LowPart;
    if (DAT_10057438 == 0) {
      DAT_10057438 = 0xbb40e64e;
    }
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// Library Function - Single Match
//  ___security_error_handler
// 
// Library: Visual Studio 2003 Release

void ___security_error_handler(int param_1)

{
  DWORD DVar1;
  size_t sVar2;
  uint *_Str;
  char *pcVar3;
  uint *local_12c;
  uint local_128 [65];
  undefined1 local_24;
  undefined4 local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10054a68;
  uStack_c = 0x10043eb1;
  local_20 = DAT_10057438;
  if (DAT_10069030 == (code *)0x0) {
    if (param_1 == 1) {
      pcVar3 = "Buffer overrun detected!";
      local_12c = (uint *)0x100548d0;
    }
    else {
      pcVar3 = "Unknown security failure detected!";
      local_12c = (uint *)0x10054990;
    }
    local_24 = 0;
    DVar1 = GetModuleFileNameA((HMODULE)0x0,(LPSTR)local_128,0x104);
    if (DVar1 == 0) {
      FUN_10048310(local_128,(uint *)"<program name unknown>");
    }
    _Str = local_128;
    sVar2 = _strlen((char *)_Str);
    if (0x3c < sVar2 + 0xb) {
      sVar2 = _strlen((char *)_Str);
      _Str = (uint *)(&stack0xfffffea7 + sVar2);
      _strncpy((char *)_Str,"...",3);
    }
    _strlen((char *)_Str);
    local_1c = &stack0xfffffec8;
    FUN_10048310((uint *)&stack0xfffffec8,(uint *)pcVar3);
    FUN_10048320((uint *)&stack0xfffffec8,(uint *)&DAT_100548b0);
    FUN_10048320((uint *)&stack0xfffffec8,(uint *)"Program: ");
    FUN_10048320((uint *)&stack0xfffffec8,_Str);
    FUN_10048320((uint *)&stack0xfffffec8,(uint *)&DAT_100548b0);
    FUN_10048320((uint *)&stack0xfffffec8,local_12c);
    ___crtMessageBoxA(&stack0xfffffec8,"Microsoft Visual C++ Runtime Library",0x12010);
  }
  else {
    local_8 = (undefined *)0x0;
    (*DAT_10069030)();
    local_8 = (undefined *)0xffffffff;
  }
                    // WARNING: Subroutine does not return
  __exit(3);
}



// Library Function - Single Match
//  long __stdcall __CxxUnhandledExceptionFilter(struct _EXCEPTION_POINTERS *)
// 
// Library: Visual Studio 2003 Release

long __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *param_1)

{
  PEXCEPTION_RECORD pEVar1;
  int iVar2;
  
  pEVar1 = param_1->ExceptionRecord;
  if (((pEVar1->ExceptionCode == 0xe06d7363) && (pEVar1->NumberParameters == 3)) &&
     ((pEVar1->ExceptionInformation[0] == 0x19930520 ||
      (pEVar1->ExceptionInformation[0] == 0x19930521)))) {
    terminate();
  }
  if ((DAT_10069034 != (_func_int *)0x0) && (iVar2 = _ValidateExecute(DAT_10069034), iVar2 != 0)) {
    iVar2 = (*DAT_10069034)(param_1);
    return iVar2;
  }
  return 0;
}



// Library Function - Single Match
//  ___crtExitProcess
// 
// Library: Visual Studio 2003 Release

void __cdecl ___crtExitProcess(int param_1)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleA("mscoree.dll");
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"CorExitProcess");
    if (pFVar1 != (FARPROC)0x0) {
      (*pFVar1)(param_1);
    }
  }
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_10044088(void)

{
  __lock(8);
  return;
}



void FUN_10044091(void)

{
  FUN_100425f0(8);
  return;
}



// Library Function - Single Match
//  __initterm
// 
// Library: Visual Studio 2003 Release

void __cdecl __initterm(undefined4 *param_1)

{
  undefined4 *in_EAX;
  
  for (; in_EAX < param_1; in_EAX = in_EAX + 1) {
    if ((code *)*in_EAX != (code *)0x0) {
      (*(code *)*in_EAX)();
    }
  }
  return;
}



// Library Function - Single Match
//  __cinit
// 
// Library: Visual Studio 2003 Release

int __cdecl __cinit(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  
  if (PTR___fpmath_10057414 != (undefined *)0x0) {
    (*(code *)PTR___fpmath_10057414)(param_1);
  }
  iVar1 = 0;
  puVar2 = &DAT_1005700c;
  do {
    if (iVar1 != 0) {
      return iVar1;
    }
    if ((code *)*puVar2 != (code *)0x0) {
      iVar1 = (*(code *)*puVar2)();
    }
    puVar2 = puVar2 + 1;
  } while (puVar2 < &DAT_10057020);
  if (iVar1 == 0) {
    _atexit((_func_4879 *)&LAB_1004493f);
    puVar2 = &DAT_10057000;
    do {
      if ((code *)*puVar2 != (code *)0x0) {
        (*(code *)*puVar2)();
      }
      puVar2 = puVar2 + 1;
    } while (puVar2 < &DAT_10057008);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Removing unreachable block (ram,0x100441d0)
// Library Function - Single Match
//  _doexit
// 
// Library: Visual Studio 2003 Release

void __cdecl doexit(UINT param_1,int param_2,int param_3)

{
  HANDLE hProcess;
  UINT uExitCode;
  
  __lock(8);
  if (DAT_1006907c == 1) {
    uExitCode = param_1;
    hProcess = GetCurrentProcess();
    TerminateProcess(hProcess,uExitCode);
  }
  DAT_10069078 = 1;
  DAT_10069074 = (undefined1)param_3;
  if (param_2 == 0) {
    if (DAT_10069708 != (undefined4 *)0x0) {
      while (DAT_10069704 = DAT_10069704 + -1, DAT_10069708 <= DAT_10069704) {
        if ((code *)*DAT_10069704 != (code *)0x0) {
          (*(code *)*DAT_10069704)();
        }
      }
    }
    __initterm((undefined4 *)&DAT_1005702c);
  }
  __initterm((undefined4 *)&DAT_10057038);
  FUN_100441cb();
  if (param_3 != 0) {
    return;
  }
  DAT_1006907c = 1;
  ___crtExitProcess(param_1);
  return;
}



void FUN_100441cb(void)

{
  int unaff_EBP;
  int unaff_EDI;
  
  if (*(int *)(unaff_EBP + 0x10) != unaff_EDI) {
    FUN_100425f0(8);
  }
  return;
}



// Library Function - Single Match
//  __exit
// 
// Library: Visual Studio 2003 Release

void __cdecl __exit(int _Code)

{
  doexit(_Code,1,0);
  return;
}



// Library Function - Single Match
//  __cexit
// 
// Library: Visual Studio 2003 Release

void __cdecl __cexit(void)

{
  doexit(0,0,1);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _calloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl _calloc(size_t _Count,size_t _Size)

{
  int iVar1;
  uint *_Size_00;
  uint *dwBytes;
  int *_Dst;
  
  _Size_00 = (uint *)(_Count * _Size);
  dwBytes = _Size_00;
  if (_Size_00 == (uint *)0x0) {
    dwBytes = (uint *)0x1;
  }
  do {
    _Dst = (int *)0x0;
    if (dwBytes < (uint *)0xffffffe1) {
      if ((DAT_100695e0 == 3) &&
         (dwBytes = (uint *)((int)dwBytes + 0xfU & 0xfffffff0), _Size_00 <= DAT_100695cc)) {
        __lock(4);
        _Dst = ___sbh_alloc_block(_Size_00);
        FUN_100442a9();
        if (_Dst != (int *)0x0) {
          _memset(_Dst,0,(size_t)_Size_00);
          goto LAB_10044274;
        }
      }
      else {
LAB_10044274:
        if (_Dst != (int *)0x0) {
          return _Dst;
        }
      }
      _Dst = (int *)HeapAlloc(DAT_100695dc,8,(SIZE_T)dwBytes);
    }
    if (_Dst != (int *)0x0) {
      return _Dst;
    }
    if (DAT_1006925c == 0) {
      return (void *)0x0;
    }
    iVar1 = __callnewh((size_t)dwBytes);
    if (iVar1 == 0) {
      return (void *)0x0;
    }
  } while( true );
}



void FUN_100442a9(void)

{
  FUN_100425f0(4);
  return;
}



// Library Function - Single Match
//  __ioinit
// 
// Library: Visual Studio 2003 Release

int __cdecl __ioinit(void)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *puVar5;
  DWORD DVar6;
  HANDLE hFile;
  int iVar7;
  uint uVar8;
  UINT *pUVar9;
  UINT UVar10;
  UINT UVar11;
  byte *pbStack_48;
  _STARTUPINFOA local_44;
  
  puVar3 = (undefined4 *)_malloc(0x480);
  if (puVar3 == (undefined4 *)0x0) {
    iVar4 = -1;
  }
  else {
    DAT_100695e4 = 0x20;
    DAT_10069600 = puVar3;
    for (; puVar3 < DAT_10069600 + 0x120; puVar3 = puVar3 + 9) {
      *puVar3 = 0xffffffff;
      puVar3[2] = 0;
      *(undefined1 *)(puVar3 + 1) = 0;
      *(undefined1 *)((int)puVar3 + 5) = 10;
    }
    GetStartupInfoA(&local_44);
    if ((local_44.cbReserved2 != 0) && ((UINT *)local_44.lpReserved2 != (UINT *)0x0)) {
      UVar10 = *(UINT *)local_44.lpReserved2;
      pUVar9 = (UINT *)((int)local_44.lpReserved2 + 4);
      pbStack_48 = (byte *)(UVar10 + (int)pUVar9);
      if (0x7ff < (int)UVar10) {
        UVar10 = 0x800;
      }
      UVar11 = UVar10;
      if ((int)DAT_100695e4 < (int)UVar10) {
        puVar3 = &DAT_10069604;
        do {
          puVar5 = (undefined4 *)_malloc(0x480);
          UVar11 = DAT_100695e4;
          if (puVar5 == (undefined4 *)0x0) break;
          DAT_100695e4 = DAT_100695e4 + 0x20;
          *puVar3 = puVar5;
          puVar2 = puVar5;
          for (; puVar5 < puVar2 + 0x120; puVar5 = puVar5 + 9) {
            *puVar5 = 0xffffffff;
            puVar5[2] = 0;
            *(undefined1 *)(puVar5 + 1) = 0;
            *(undefined1 *)((int)puVar5 + 5) = 10;
            puVar2 = (undefined4 *)*puVar3;
          }
          puVar3 = puVar3 + 1;
          UVar11 = UVar10;
        } while ((int)DAT_100695e4 < (int)UVar10);
      }
      uVar8 = 0;
      if (0 < (int)UVar11) {
        do {
          if (((*(HANDLE *)pbStack_48 != (HANDLE)0xffffffff) && ((*pUVar9 & 1) != 0)) &&
             (((*pUVar9 & 8) != 0 || (DVar6 = GetFileType(*(HANDLE *)pbStack_48), DVar6 != 0)))) {
            puVar3 = (undefined4 *)((int)(&DAT_10069600)[(int)uVar8 >> 5] + (uVar8 & 0x1f) * 0x24);
            *puVar3 = *(undefined4 *)pbStack_48;
            *(byte *)(puVar3 + 1) = (byte)*pUVar9;
            iVar4 = ___crtInitCritSecAndSpinCount(puVar3 + 3,4000);
            if (iVar4 == 0) {
              return -1;
            }
            puVar3[2] = puVar3[2] + 1;
          }
          pbStack_48 = pbStack_48 + 4;
          uVar8 = uVar8 + 1;
          pUVar9 = (UINT *)((int)pUVar9 + 1);
        } while ((int)uVar8 < (int)UVar11);
      }
    }
    iVar4 = 0;
    do {
      piVar1 = DAT_10069600 + iVar4 * 9;
      if (*piVar1 == -1) {
        *(undefined1 *)(piVar1 + 1) = 0x81;
        if (iVar4 == 0) {
          DVar6 = 0xfffffff6;
        }
        else {
          DVar6 = 0xfffffff5 - (iVar4 != 1);
        }
        hFile = GetStdHandle(DVar6);
        if ((hFile == (HANDLE)0xffffffff) || (DVar6 = GetFileType(hFile), DVar6 == 0)) {
          *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 0x40;
        }
        else {
          *piVar1 = (int)hFile;
          if ((DVar6 & 0xff) == 2) {
            *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 0x40;
          }
          else if ((DVar6 & 0xff) == 3) {
            *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 8;
          }
          iVar7 = ___crtInitCritSecAndSpinCount(piVar1 + 3,4000);
          if (iVar7 == 0) {
            return -1;
          }
          piVar1[2] = piVar1[2] + 1;
        }
      }
      else {
        *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 0x80;
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < 3);
    SetHandleCount(DAT_100695e4);
    iVar4 = 0;
  }
  return iVar4;
}



// Library Function - Single Match
//  __ioterm
// 
// Library: Visual Studio 2003 Release

void __cdecl __ioterm(void)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  
  puVar2 = &DAT_10069600;
  do {
    uVar3 = *puVar2;
    uVar1 = uVar3;
    if (uVar3 != 0) {
      for (; uVar3 < uVar1 + 0x480; uVar3 = uVar3 + 0x24) {
        if (*(int *)(uVar3 + 8) != 0) {
          DeleteCriticalSection((LPCRITICAL_SECTION)(uVar3 + 0xc));
        }
        uVar1 = *puVar2;
      }
      _free((void *)*puVar2);
      *puVar2 = 0;
    }
    puVar2 = puVar2 + 1;
  } while ((int)puVar2 < 0x10069700);
  return;
}



// Library Function - Single Match
//  __setenvp
// 
// Library: Visual Studio 2003 Release

int __cdecl __setenvp(void)

{
  undefined4 *puVar1;
  size_t sVar2;
  uint *puVar3;
  uint *puVar4;
  int iVar5;
  
  if (DAT_1006970c == 0) {
    ___initmbctable();
  }
  iVar5 = 0;
  puVar4 = DAT_10068e08;
  if (DAT_10068e08 != (uint *)0x0) {
    for (; (char)*puVar4 != '\0'; puVar4 = (uint *)((int)puVar4 + sVar2 + 1)) {
      if ((char)*puVar4 != '=') {
        iVar5 = iVar5 + 1;
      }
      sVar2 = _strlen((char *)puVar4);
    }
    puVar1 = (undefined4 *)_malloc(iVar5 * 4 + 4);
    puVar4 = DAT_10068e08;
    DAT_1006905c = puVar1;
    if (puVar1 != (undefined4 *)0x0) {
      do {
        if ((char)*puVar4 == '\0') {
          _free(DAT_10068e08);
          DAT_10068e08 = (uint *)0x0;
          *puVar1 = 0;
          DAT_10069700 = 1;
          return 0;
        }
        sVar2 = _strlen((char *)puVar4);
        if ((char)*puVar4 != '=') {
          puVar3 = (uint *)_malloc(sVar2 + 1);
          *puVar1 = puVar3;
          if (puVar3 == (uint *)0x0) {
            _free(DAT_1006905c);
            DAT_1006905c = (undefined4 *)0x0;
            return -1;
          }
          FUN_10048310(puVar3,puVar4);
          puVar1 = puVar1 + 1;
        }
        puVar4 = (uint *)((int)puVar4 + sVar2 + 1);
      } while( true );
    }
  }
  return -1;
}



// Library Function - Single Match
//  _parse_cmdline
// 
// Library: Visual Studio 2003 Release

void __cdecl parse_cmdline(undefined4 *param_1,int *param_2)

{
  bool bVar1;
  bool bVar2;
  byte *in_EAX;
  byte *pbVar3;
  byte *pbVar4;
  byte bVar5;
  byte *in_ECX;
  uint uVar6;
  int *unaff_ESI;
  
  bVar1 = false;
  *unaff_ESI = 0;
  *param_2 = 1;
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = in_ECX;
    param_1 = param_1 + 1;
  }
  do {
    if (*in_EAX == 0x22) {
      bVar1 = !bVar1;
      pbVar3 = in_EAX + 1;
      bVar5 = 0x22;
    }
    else {
      *unaff_ESI = *unaff_ESI + 1;
      if (in_ECX != (byte *)0x0) {
        *in_ECX = *in_EAX;
        in_ECX = in_ECX + 1;
      }
      bVar5 = *in_EAX;
      pbVar3 = in_EAX + 1;
      if (((&DAT_100693a1)[bVar5] & 4) != 0) {
        *unaff_ESI = *unaff_ESI + 1;
        if (in_ECX != (byte *)0x0) {
          *in_ECX = *pbVar3;
          in_ECX = in_ECX + 1;
        }
        pbVar3 = in_EAX + 2;
      }
      if (bVar5 == 0) {
        pbVar3 = pbVar3 + -1;
        goto LAB_10044644;
      }
    }
    in_EAX = pbVar3;
  } while ((bVar1) || ((bVar5 != 0x20 && (bVar5 != 9))));
  if (in_ECX != (byte *)0x0) {
    in_ECX[-1] = 0;
  }
LAB_10044644:
  bVar1 = false;
  while (*pbVar3 != 0) {
    for (; (*pbVar3 == 0x20 || (*pbVar3 == 9)); pbVar3 = pbVar3 + 1) {
    }
    if (*pbVar3 == 0) break;
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = in_ECX;
      param_1 = param_1 + 1;
    }
    *param_2 = *param_2 + 1;
    while( true ) {
      bVar2 = true;
      uVar6 = 0;
      for (; *pbVar3 == 0x5c; pbVar3 = pbVar3 + 1) {
        uVar6 = uVar6 + 1;
      }
      if (*pbVar3 == 0x22) {
        pbVar4 = pbVar3;
        if ((uVar6 & 1) == 0) {
          if ((!bVar1) || (pbVar4 = pbVar3 + 1, *pbVar4 != 0x22)) {
            bVar2 = false;
            pbVar4 = pbVar3;
          }
          bVar1 = !bVar1;
        }
        uVar6 = uVar6 >> 1;
        pbVar3 = pbVar4;
      }
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if (in_ECX != (byte *)0x0) {
          *in_ECX = 0x5c;
          in_ECX = in_ECX + 1;
        }
        *unaff_ESI = *unaff_ESI + 1;
      }
      bVar5 = *pbVar3;
      if ((bVar5 == 0) || ((!bVar1 && ((bVar5 == 0x20 || (bVar5 == 9)))))) break;
      if (bVar2) {
        if (in_ECX == (byte *)0x0) {
          if (((&DAT_100693a1)[bVar5] & 4) != 0) {
            pbVar3 = pbVar3 + 1;
            *unaff_ESI = *unaff_ESI + 1;
          }
        }
        else {
          if (((&DAT_100693a1)[bVar5] & 4) != 0) {
            *in_ECX = bVar5;
            in_ECX = in_ECX + 1;
            pbVar3 = pbVar3 + 1;
            *unaff_ESI = *unaff_ESI + 1;
          }
          *in_ECX = *pbVar3;
          in_ECX = in_ECX + 1;
        }
        *unaff_ESI = *unaff_ESI + 1;
      }
      pbVar3 = pbVar3 + 1;
    }
    if (in_ECX != (byte *)0x0) {
      *in_ECX = 0;
      in_ECX = in_ECX + 1;
    }
    *unaff_ESI = *unaff_ESI + 1;
  }
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = 0;
  }
  *param_2 = *param_2 + 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __setargv
// 
// Library: Visual Studio 2003 Release

int __cdecl __setargv(void)

{
  undefined4 *puVar1;
  int iVar2;
  int in_ECX;
  int local_8;
  
  local_8 = in_ECX;
  if (DAT_1006970c == 0) {
    ___initmbctable();
  }
  DAT_10069184 = 0;
  GetModuleFileNameA((HMODULE)0x0,&DAT_10069080,0x104);
  _DAT_1006906c = &DAT_10069080;
  parse_cmdline((undefined4 *)0x0,&local_8);
  puVar1 = (undefined4 *)_malloc(in_ECX + local_8 * 4);
  if (puVar1 == (undefined4 *)0x0) {
    iVar2 = -1;
  }
  else {
    parse_cmdline(puVar1,&local_8);
    _DAT_10069050 = local_8 + -1;
    iVar2 = 0;
    _DAT_10069054 = puVar1;
  }
  return iVar2;
}



// Library Function - Single Match
//  ___crtGetEnvironmentStringsA
// 
// Library: Visual Studio 2003 Release

LPVOID __cdecl ___crtGetEnvironmentStringsA(void)

{
  char cVar1;
  WCHAR WVar2;
  DWORD DVar3;
  WCHAR *pWVar4;
  int iVar6;
  size_t _Size;
  LPSTR lpMultiByteStr;
  LPCH _Src;
  char *pcVar7;
  void *_Dst;
  LPWCH lpWideCharStr;
  LPSTR local_8;
  WCHAR *pWVar5;
  char *pcVar8;
  
  lpWideCharStr = (LPWCH)0x0;
  if (DAT_10069188 == 0) {
    lpWideCharStr = GetEnvironmentStringsW();
    if (lpWideCharStr != (LPWCH)0x0) {
      DAT_10069188 = 1;
      goto LAB_10044827;
    }
    DVar3 = GetLastError();
    if (DVar3 == 0x78) {
      DAT_10069188 = 2;
    }
  }
  if (DAT_10069188 != 1) {
    if ((DAT_10069188 != 2) && (DAT_10069188 != 0)) {
      return (LPVOID)0x0;
    }
    _Src = GetEnvironmentStrings();
    if (_Src == (LPCH)0x0) {
      return (LPVOID)0x0;
    }
    cVar1 = *_Src;
    pcVar7 = _Src;
    while (cVar1 != '\0') {
      do {
        pcVar8 = pcVar7;
        pcVar7 = pcVar8 + 1;
      } while (*pcVar7 != '\0');
      pcVar7 = pcVar8 + 2;
      cVar1 = *pcVar7;
    }
    _Dst = _malloc((size_t)(pcVar7 + (1 - (int)_Src)));
    if (_Dst == (void *)0x0) {
      _Dst = (void *)0x0;
    }
    else {
      _memcpy(_Dst,_Src,(size_t)(pcVar7 + (1 - (int)_Src)));
    }
    FreeEnvironmentStringsA(_Src);
    return _Dst;
  }
LAB_10044827:
  if ((lpWideCharStr == (LPWCH)0x0) &&
     (lpWideCharStr = GetEnvironmentStringsW(), lpWideCharStr == (LPWCH)0x0)) {
    return (LPVOID)0x0;
  }
  WVar2 = *lpWideCharStr;
  pWVar4 = lpWideCharStr;
  while (WVar2 != L'\0') {
    do {
      pWVar5 = pWVar4;
      pWVar4 = pWVar5 + 1;
    } while (*pWVar4 != L'\0');
    pWVar4 = pWVar5 + 2;
    WVar2 = *pWVar4;
  }
  iVar6 = ((int)pWVar4 - (int)lpWideCharStr >> 1) + 1;
  _Size = WideCharToMultiByte(0,0,lpWideCharStr,iVar6,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
  local_8 = (LPSTR)0x0;
  if (((_Size != 0) && (lpMultiByteStr = (LPSTR)_malloc(_Size), lpMultiByteStr != (LPSTR)0x0)) &&
     (iVar6 = WideCharToMultiByte(0,0,lpWideCharStr,iVar6,lpMultiByteStr,_Size,(LPCSTR)0x0,
                                  (LPBOOL)0x0), local_8 = lpMultiByteStr, iVar6 == 0)) {
    _free(lpMultiByteStr);
    local_8 = (LPSTR)0x0;
  }
  FreeEnvironmentStringsW(lpWideCharStr);
  return local_8;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __RTC_Initialize
// 
// Library: Visual Studio 2003 Release

void __RTC_Initialize(void)

{
  undefined4 *local_20;
  
  for (local_20 = &DAT_10055d50; local_20 < &DAT_10055d50; local_20 = local_20 + 1) {
    if ((code *)*local_20 != (code *)0x0) {
      (*(code *)*local_20)();
    }
  }
  return;
}



// Library Function - Single Match
//  ___heap_select
// 
// Library: Visual Studio 2003 Release

undefined4 ___heap_select(void)

{
  if ((DAT_1006903c == 2) && (4 < DAT_10069048)) {
    return 1;
  }
  return 3;
}



// Library Function - Single Match
//  __heap_init
// 
// Library: Visual Studio 2003 Release

int __cdecl __heap_init(void)

{
  int iVar1;
  int in_stack_00000004;
  
  DAT_100695dc = HeapCreate((uint)(in_stack_00000004 == 0),0x1000,0);
  if (DAT_100695dc == (HANDLE)0x0) {
    return 0;
  }
  DAT_100695e0 = ___heap_select();
  if ((DAT_100695e0 == 3) && (iVar1 = ___sbh_heap_init(0x3f8), iVar1 == 0)) {
    HeapDestroy(DAT_100695dc);
    return 0;
  }
  return 1;
}



// Library Function - Single Match
//  __heap_term
// 
// Library: Visual Studio 2003 Release

void __cdecl __heap_term(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  if (DAT_100695e0 == 3) {
    iVar1 = 0;
    if (0 < DAT_100695c4) {
      puVar2 = (undefined4 *)((int)DAT_100695c8 + 0xc);
      do {
        VirtualFree((LPVOID)*puVar2,0x100000,0x4000);
        VirtualFree((LPVOID)*puVar2,0,0x8000);
        HeapFree(DAT_100695dc,0,(LPVOID)puVar2[1]);
        puVar2 = puVar2 + 5;
        iVar1 = iVar1 + 1;
      } while (iVar1 < DAT_100695c4);
    }
    HeapFree(DAT_100695dc,0,DAT_100695c8);
  }
  HeapDestroy(DAT_100695dc);
  return;
}



// Library Function - Single Match
//  __XcptFilter
// 
// Library: Visual Studio 2003 Release

int __cdecl __XcptFilter(ulong _ExceptionNum,_EXCEPTION_POINTERS *_ExceptionPtr)

{
  ulong *puVar1;
  code *pcVar2;
  void *pvVar3;
  ulong uVar4;
  void *pvVar5;
  _ptiddata p_Var6;
  int iVar7;
  int iVar8;
  ulong *puVar9;
  
  p_Var6 = __getptd();
  puVar1 = (ulong *)p_Var6->_initaddr;
  puVar9 = puVar1;
  do {
    if (*puVar9 == _ExceptionNum) break;
    puVar9 = puVar9 + 3;
  } while (puVar9 < puVar1 + DAT_10057a4c * 3);
  if ((puVar1 + DAT_10057a4c * 3 <= puVar9) || (*puVar9 != _ExceptionNum)) {
    puVar9 = (ulong *)0x0;
  }
  if ((puVar9 == (ulong *)0x0) || (pcVar2 = (code *)puVar9[2], pcVar2 == (code *)0x0)) {
    iVar7 = UnhandledExceptionFilter(_ExceptionPtr);
  }
  else if (pcVar2 == (code *)0x5) {
    puVar9[2] = 0;
    iVar7 = 1;
  }
  else {
    if (pcVar2 != (code *)0x1) {
      pvVar3 = p_Var6->_initarg;
      p_Var6->_initarg = _ExceptionPtr;
      if (puVar9[1] == 8) {
        if (DAT_10057a40 < DAT_10057a44 + DAT_10057a40) {
          iVar8 = DAT_10057a40 * 0xc;
          iVar7 = DAT_10057a40;
          do {
            *(undefined4 *)(iVar8 + 8 + (int)p_Var6->_initaddr) = 0;
            iVar7 = iVar7 + 1;
            iVar8 = iVar8 + 0xc;
          } while (iVar7 < DAT_10057a44 + DAT_10057a40);
        }
        uVar4 = *puVar9;
        pvVar5 = p_Var6->_pxcptacttab;
        if (uVar4 == 0xc000008e) {
          p_Var6->_pxcptacttab = (void *)0x83;
        }
        else if (uVar4 == 0xc0000090) {
          p_Var6->_pxcptacttab = (void *)0x81;
        }
        else if (uVar4 == 0xc0000091) {
          p_Var6->_pxcptacttab = (void *)0x84;
        }
        else if (uVar4 == 0xc0000093) {
          p_Var6->_pxcptacttab = (void *)0x85;
        }
        else if (uVar4 == 0xc000008d) {
          p_Var6->_pxcptacttab = (void *)0x82;
        }
        else if (uVar4 == 0xc000008f) {
          p_Var6->_pxcptacttab = (void *)0x86;
        }
        else if (uVar4 == 0xc0000092) {
          p_Var6->_pxcptacttab = (void *)0x8a;
        }
        (*pcVar2)(8,p_Var6->_pxcptacttab);
        p_Var6->_pxcptacttab = pvVar5;
      }
      else {
        puVar9[2] = 0;
        (*pcVar2)(puVar9[1]);
      }
      p_Var6->_initarg = pvVar3;
    }
    iVar7 = -1;
  }
  return iVar7;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  __NMSG_WRITE
// 
// Library: Visual Studio 2003 Release

void __cdecl __NMSG_WRITE(int param_1)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  size_t sVar4;
  size_t sVar5;
  HANDLE hFile;
  int iVar6;
  uint *_Str;
  undefined1 auStackY_14c [4];
  UINT aUStackY_148 [3];
  undefined4 auStackY_13c [2];
  undefined4 uStackY_134;
  LPCVOID lpBuffer;
  LPDWORD lpNumberOfBytesWritten;
  LPOVERLAPPED lpOverlapped;
  uint local_110 [65];
  undefined1 local_c;
  int local_8;
  
  local_8 = DAT_10057438;
  uVar2 = 0;
  do {
    if (param_1 == (&DAT_10057a50)[uVar2 * 2]) break;
    uVar2 = uVar2 + 1;
  } while (uVar2 < 0x13);
  iVar6 = uVar2 * 8;
  if (param_1 == (&DAT_10057a50)[uVar2 * 2]) {
    if ((DAT_10068e10 == 1) || ((DAT_10068e10 == 0 && (DAT_10068e14 == 1)))) {
      lpOverlapped = (LPOVERLAPPED)0x0;
      lpNumberOfBytesWritten = (LPDWORD)&param_1;
      sVar4 = _strlen(*(char **)(iVar6 + 0x10057a54));
      lpBuffer = *(LPCVOID *)(iVar6 + 0x10057a54);
      uStackY_134 = 0x10044d40;
      hFile = GetStdHandle(0xfffffff4);
      uStackY_134 = 0x10044d47;
      WriteFile(hFile,lpBuffer,sVar4,lpNumberOfBytesWritten,lpOverlapped);
    }
    else if (param_1 != 0xfc) {
      local_c = 0;
      DVar3 = GetModuleFileNameA((HMODULE)0x0,(LPSTR)local_110,0x104);
      if (DVar3 == 0) {
        FUN_10048310(local_110,(uint *)"<program name unknown>");
      }
      _Str = local_110;
      sVar4 = _strlen((char *)_Str);
      if (0x3c < sVar4 + 1) {
        sVar4 = _strlen((char *)_Str);
        _Str = (uint *)(auStackY_14c + sVar4 + 1);
        _strncpy((char *)_Str,"...",3);
      }
      sVar4 = _strlen((char *)_Str);
      sVar5 = _strlen(*(char **)(iVar6 + 0x10057a54));
      iVar1 = -(sVar4 + sVar5 + 0x1f & 0xfffffffc);
      *(char **)((int)local_110 + iVar1 + -0x10) = "Runtime Error!\n\nProgram: ";
      *(int *)((int)local_110 + iVar1 + -0x14) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)local_110 + iVar1 + -0x18) = 0x10044cec;
      FUN_10048310(*(uint **)((int)local_110 + iVar1 + -0x14),
                   *(uint **)((int)local_110 + iVar1 + -0x10));
      *(uint **)((int)local_110 + iVar1 + -0x18) = _Str;
      *(int *)((int)local_110 + iVar1 + -0x1c) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)local_110 + iVar1 + -0x20) = 0x10044cf3;
      FUN_10048320(*(uint **)((int)local_110 + iVar1 + -0x1c),
                   *(uint **)((int)local_110 + iVar1 + -0x18));
      *(undefined **)((int)local_110 + iVar1 + -0x20) = &DAT_100548b0;
      *(int *)((int)&uStackY_134 + iVar1) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)auStackY_13c + iVar1 + 4) = 0x10044cfe;
      FUN_10048320(*(uint **)((int)&uStackY_134 + iVar1),*(uint **)((int)local_110 + iVar1 + -0x20))
      ;
      *(undefined4 *)((int)auStackY_13c + iVar1 + 4) = *(undefined4 *)(iVar6 + 0x10057a54);
      *(int *)((int)auStackY_13c + iVar1) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)aUStackY_148 + iVar1 + 8) = 0x10044d0a;
      FUN_10048320(*(uint **)((int)auStackY_13c + iVar1),*(uint **)((int)auStackY_13c + iVar1 + 4));
      *(undefined4 *)((int)aUStackY_148 + iVar1 + 8) = 0x12010;
      *(char **)((int)aUStackY_148 + iVar1 + 4) = "Microsoft Visual C++ Runtime Library";
      *(int *)((int)aUStackY_148 + iVar1) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)(auStackY_14c + iVar1) = 0x10044d1a;
      ___crtMessageBoxA(*(LPCSTR *)((int)aUStackY_148 + iVar1),
                        *(LPCSTR *)((int)aUStackY_148 + iVar1 + 4),
                        *(UINT *)((int)aUStackY_148 + iVar1 + 8));
    }
  }
  FUN_1003fb09(local_8);
  return;
}



// Library Function - Single Match
//  __FF_MSGBANNER
// 
// Library: Visual Studio 2003 Release

void __cdecl __FF_MSGBANNER(void)

{
  if ((DAT_10068e10 == 1) || ((DAT_10068e10 == 0 && (DAT_10068e14 == 1)))) {
    __NMSG_WRITE(0xfc);
    if (DAT_1006918c != (code *)0x0) {
      (*DAT_1006918c)();
    }
    __NMSG_WRITE(0xff);
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __tzset_lk
// 
// Library: Visual Studio 2003 Release

void __tzset_lk(void)

{
  char cVar1;
  char cVar2;
  UINT CodePage;
  uint *_Str1;
  int iVar3;
  size_t sVar4;
  long lVar5;
  DWORD DVar6;
  uint *_Str;
  int local_20 [3];
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10054ed0;
  uStack_c = 0x10044da8;
  __lock(7);
  CodePage = DAT_100692ec;
  local_8 = (undefined *)0x0;
  DAT_1006923c = 0;
  DAT_10057b8c = 0xffffffff;
  DAT_10057b80 = 0xffffffff;
  _Str1 = (uint *)__getenv_lk("TZ");
  if ((_Str1 == (uint *)0x0) || ((char)*_Str1 == '\0')) {
    if (DAT_10069240 != (uint *)0x0) {
      _free(DAT_10069240);
      DAT_10069240 = (uint *)0x0;
    }
    DVar6 = GetTimeZoneInformation((LPTIME_ZONE_INFORMATION)&DAT_10069190);
    if (DVar6 != 0xffffffff) {
      DAT_1006923c = 1;
      _DAT_10057ae8 = DAT_10069190 * 0x3c;
      if (DAT_100691d6 != 0) {
        _DAT_10057ae8 = _DAT_10057ae8 + DAT_100691e4 * 0x3c;
      }
      if ((DAT_1006922a == 0) || (DAT_10069238 == 0)) {
        DAT_10057aec = 0;
        DAT_10057af0 = 0;
      }
      else {
        DAT_10057aec = 1;
        DAT_10057af0 = (DAT_10069238 - DAT_100691e4) * 0x3c;
      }
      iVar3 = WideCharToMultiByte(CodePage,0,(LPCWSTR)&DAT_10069194,-1,PTR_DAT_10057b78,0x3f,
                                  (LPCSTR)0x0,local_20);
      if ((iVar3 == 0) || (local_20[0] != 0)) {
        *PTR_DAT_10057b78 = 0;
      }
      else {
        PTR_DAT_10057b78[0x3f] = 0;
      }
      iVar3 = WideCharToMultiByte(CodePage,0,(LPCWSTR)&DAT_100691e8,-1,PTR_DAT_10057b7c,0x3f,
                                  (LPCSTR)0x0,local_20);
      if ((iVar3 == 0) || (local_20[0] != 0)) {
        *PTR_DAT_10057b7c = 0;
      }
      else {
        PTR_DAT_10057b7c[0x3f] = 0;
      }
    }
  }
  else {
    if (DAT_10069240 != (uint *)0x0) {
      iVar3 = _strcmp((char *)_Str1,(char *)DAT_10069240);
      if (iVar3 == 0) goto LAB_10044fa0;
      if (DAT_10069240 != (uint *)0x0) {
        _free(DAT_10069240);
      }
    }
    sVar4 = _strlen((char *)_Str1);
    DAT_10069240 = (uint *)_malloc(sVar4 + 1);
    if (DAT_10069240 != (uint *)0x0) {
      FUN_10048310(DAT_10069240,_Str1);
      local_8 = (undefined *)0xffffffff;
      FUN_10044fb7();
      _strncpy(PTR_DAT_10057b78,(char *)_Str1,3);
      PTR_DAT_10057b78[3] = 0;
      _Str = (uint *)((int)_Str1 + 3);
      cVar2 = *(char *)_Str;
      if (cVar2 == '-') {
        _Str = _Str1 + 1;
      }
      lVar5 = _atol((char *)_Str);
      _DAT_10057ae8 = lVar5 * 0xe10;
      for (; (cVar1 = (char)*_Str, cVar1 == '+' || (('/' < cVar1 && (cVar1 < ':'))));
          _Str = (uint *)((int)_Str + 1)) {
      }
      if ((char)*_Str == ':') {
        _Str = (uint *)((int)_Str + 1);
        lVar5 = _atol((char *)_Str);
        _DAT_10057ae8 = _DAT_10057ae8 + lVar5 * 0x3c;
        for (; ('/' < (char)*_Str && ((char)*_Str < ':')); _Str = (uint *)((int)_Str + 1)) {
        }
        if ((char)*_Str == ':') {
          _Str = (uint *)((int)_Str + 1);
          lVar5 = _atol((char *)_Str);
          _DAT_10057ae8 = _DAT_10057ae8 + lVar5;
          for (; ('/' < (char)*_Str && ((char)*_Str < ':')); _Str = (uint *)((int)_Str + 1)) {
          }
        }
      }
      if (cVar2 == '-') {
        _DAT_10057ae8 = -_DAT_10057ae8;
      }
      DAT_10057aec = (int)(char)*_Str;
      if (DAT_10057aec != 0) {
        _strncpy(PTR_DAT_10057b7c,(char *)_Str,3);
        PTR_DAT_10057b7c[3] = 0;
        return;
      }
      *PTR_DAT_10057b7c = 0;
      return;
    }
  }
LAB_10044fa0:
  __local_unwind2((int)local_14,-1);
  return;
}



void FUN_10044fb7(void)

{
  FUN_100425f0(7);
  return;
}



// Library Function - Single Match
//  _cvtdate
// 
// Library: Visual Studio 2003 Release

int __cdecl
cvtdate(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int param_7,
       int param_8,int param_9)

{
  int in_EAX;
  int iVar1;
  int in_ECX;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar2 = param_3 % 4;
  if (param_2 == 1) {
    if (((iVar2 == 0) && (param_3 % 100 != 0)) || ((param_3 + 0x76c) % 400 == 0)) {
      iVar4 = (&DAT_10057b94)[in_EAX];
    }
    else {
      iVar4 = *(int *)(&DAT_10057bc8 + in_EAX * 4);
    }
    iVar5 = iVar4 + 1;
    iVar3 = (param_3 * 0x16d + -0x63db +
            (param_3 + -1) / 4 + iVar5 + ((param_3 + 299) / 400 - (param_3 + -1) / 100)) % 7;
    iVar1 = (param_4 * 7 - iVar3) + param_5;
    if (iVar3 <= param_5) {
      iVar5 = iVar4 + -6;
    }
    iVar5 = iVar5 + iVar1;
    if (param_4 == 5) {
      if (((iVar2 == 0) && (param_3 % 100 != 0)) || ((param_3 + 0x76c) % 400 == 0)) {
        iVar1 = *(int *)(&DAT_10057b98 + in_EAX * 4);
      }
      else {
        iVar1 = (&DAT_10057bcc)[in_EAX];
      }
      if (iVar1 < iVar5) {
        iVar5 = iVar5 + -7;
      }
    }
  }
  else {
    if (((iVar2 == 0) && (iVar1 = param_3 / 100, param_3 % 100 != 0)) ||
       (iVar1 = (param_3 + 0x76c) / 400, (param_3 + 0x76c) % 400 == 0)) {
      iVar5 = (&DAT_10057b94)[in_EAX];
    }
    else {
      iVar5 = *(int *)(&DAT_10057bc8 + in_EAX * 4);
    }
    iVar5 = iVar5 + param_6;
  }
  iVar2 = (in_ECX * 0x3c + param_7) * 0x3c;
  if (param_1 == 1) {
    DAT_10057b88 = (iVar2 + param_8) * 1000 + param_9;
    DAT_10057b80 = param_3;
    DAT_10057b84 = iVar5;
  }
  else {
    DAT_10057b94 = (iVar2 + DAT_10057af0 + param_8) * 1000 + param_9;
    if (DAT_10057b94 < 0) {
      DAT_10057b94 = DAT_10057b94 + 86400000;
      DAT_10057b90 = iVar5 + -1;
    }
    else {
      iVar1 = 86400000;
      DAT_10057b90 = iVar5;
      if (86399999 < DAT_10057b94) {
        DAT_10057b94 = DAT_10057b94 + -86400000;
        DAT_10057b90 = iVar5 + 1;
      }
    }
    DAT_10057b8c = param_3;
  }
  return iVar1;
}



// Library Function - Single Match
//  __isindst_lk
// 
// Library: Visual Studio 2003 Release

bool __isindst_lk(void)

{
  int iVar1;
  bool bVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int *unaff_EBX;
  uint uVar6;
  
  if (DAT_10057aec == 0) {
    return false;
  }
  iVar1 = unaff_EBX[5];
  if ((iVar1 != DAT_10057b80) || (iVar1 != DAT_10057b8c)) {
    if (DAT_1006923c == 0) {
      cvtdate(1,1,iVar1,1,0,0,0,0,0);
      cvtdate(0,1,iVar1,5,0,0,0,0,0);
    }
    else {
      if (DAT_10069228 != 0) {
        uVar6 = (uint)DAT_1006922e;
        uVar3 = 0;
        uVar4 = 0;
      }
      else {
        uVar3 = (uint)DAT_1006922c;
        uVar6 = 0;
        uVar4 = (uint)DAT_1006922e;
      }
      cvtdate(1,(uint)(DAT_10069228 == 0),iVar1,uVar4,uVar3,uVar6,(uint)DAT_10069232,
              (uint)DAT_10069234,(uint)DAT_10069236);
      if (DAT_100691d4 != 0) {
        uVar6 = (uint)DAT_100691da;
        uVar3 = 0;
        uVar4 = 0;
      }
      else {
        uVar3 = (uint)DAT_100691d8;
        uVar6 = 0;
        uVar4 = (uint)DAT_100691da;
      }
      cvtdate(0,(uint)(DAT_100691d4 == 0),iVar1,uVar4,uVar3,uVar6,(uint)DAT_100691de,
              (uint)DAT_100691e0,(uint)DAT_100691e2);
    }
  }
  iVar1 = unaff_EBX[7];
  if (DAT_10057b84 < DAT_10057b90) {
    if ((iVar1 < DAT_10057b84) || (DAT_10057b90 < iVar1)) {
      return false;
    }
    if ((DAT_10057b84 < iVar1) && (iVar1 < DAT_10057b90)) {
      return true;
    }
  }
  else {
    if (iVar1 < DAT_10057b90) {
      return true;
    }
    if (DAT_10057b84 < iVar1) {
      return true;
    }
    if ((DAT_10057b90 < iVar1) && (iVar1 < DAT_10057b84)) {
      return false;
    }
  }
  iVar5 = ((unaff_EBX[2] * 0x3c + unaff_EBX[1]) * 0x3c + *unaff_EBX) * 1000;
  if (iVar1 == DAT_10057b84) {
    bVar2 = DAT_10057b88 <= iVar5;
  }
  else {
    bVar2 = iVar5 < DAT_10057b94;
  }
  return bVar2;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___tzset
// 
// Library: Visual Studio 2003 Release

void __cdecl ___tzset(void)

{
  if (DAT_10069244 == 0) {
    __lock(6);
    if (DAT_10069244 == 0) {
      __tzset_lk();
      DAT_10069244 = DAT_10069244 + 1;
    }
    FUN_100453c6();
  }
  return;
}



void FUN_100453c6(void)

{
  FUN_100425f0(6);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __isindst
// 
// Library: Visual Studio 2003 Release

int __cdecl __isindst(tm *_Time)

{
  bool bVar1;
  undefined3 extraout_var;
  
  __lock(6);
  bVar1 = __isindst_lk();
  FUN_10045404();
  return CONCAT31(extraout_var,bVar1);
}



void FUN_10045404(void)

{
  FUN_100425f0(6);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  ___crtLCMapStringA
// 
// Library: Visual Studio 2003 Release

int __cdecl
___crtLCMapStringA(_locale_t _Plocinfo,LPCWSTR _LocaleName,DWORD _DwMapFlag,LPCSTR _LpSrcStr,
                  int _CchSrc,LPSTR _LpDestStr,int _CchDest,int _Code_page,BOOL _BError)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  DWORD DVar4;
  int iVar5;
  undefined1 *puVar6;
  int iVar7;
  UINT UVar8;
  LPCSTR pCVar9;
  undefined1 *puVar10;
  undefined1 *puVar11;
  undefined1 *puVar12;
  undefined1 *puVar13;
  char *pcVar14;
  undefined4 uStackY_74;
  uint local_4c;
  LPCSTR local_2c;
  size_t local_28;
  undefined1 *local_24;
  undefined1 *local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10054f00;
  uStack_c = 0x10045419;
  if (DAT_10069248 == 0) {
    uStackY_74 = 0x1004543a;
    iVar3 = LCMapStringW(0,0x100,L"",1,(LPWSTR)0x0,0);
    if (iVar3 == 0) {
      DVar4 = GetLastError();
      if (DVar4 == 0x78) {
        DAT_10069248 = 2;
      }
    }
    else {
      DAT_10069248 = 1;
    }
  }
  pcVar14 = (char *)_DwMapFlag;
  pCVar9 = _LpSrcStr;
  if (0 < (int)_LpSrcStr) {
    do {
      pCVar9 = pCVar9 + -1;
      if (*pcVar14 == '\0') goto LAB_10045473;
      pcVar14 = pcVar14 + 1;
    } while (pCVar9 != (LPCSTR)0x0);
    pCVar9 = (LPCSTR)0xffffffff;
LAB_10045473:
    _LpSrcStr = _LpSrcStr + (-1 - (int)pCVar9);
  }
  if ((DAT_10069248 != 2) && (DAT_10069248 != 0)) {
    if (DAT_10069248 == 1) {
      iVar3 = 0;
      bVar2 = false;
      bVar1 = false;
      if (_CchDest == 0) {
        _CchDest = DAT_100692ec;
      }
      uStackY_74 = 0x100454d3;
      iVar5 = MultiByteToWideChar(_CchDest,(uint)(_Code_page != 0) * 8 + 1,(LPCSTR)_DwMapFlag,
                                  (int)_LpSrcStr,(LPWSTR)0x0,0);
      if (iVar5 != 0) {
        puVar6 = (undefined1 *)(iVar5 * 2 + 3U & 0xfffffffc);
        iVar7 = -(int)puVar6;
        local_1c = &stack0xffffffa8 + iVar7;
        local_20 = &stack0xffffffa8 + iVar7;
        local_8 = (undefined *)0xffffffff;
        if (&stack0xffffffa8 == puVar6) {
          *(int *)(&stack0xffffffa4 + iVar7) = iVar5 * 2;
          *(undefined4 *)(&stack0xffffffa0 + iVar7) = 0x1004552c;
          local_20 = (undefined1 *)_malloc(*(size_t *)(&stack0xffffffa4 + iVar7));
          if (local_20 == (undefined1 *)0x0) {
            return 0;
          }
          bVar2 = true;
        }
        *(int *)(&stack0xffffffa4 + iVar7) = iVar5;
        *(undefined1 **)(&stack0xffffffa0 + iVar7) = local_20;
        *(LPCSTR *)(&stack0xffffff9c + iVar7) = _LpSrcStr;
        *(DWORD *)(&stack0xffffff98 + iVar7) = _DwMapFlag;
        *(undefined4 *)(&stack0xffffff94 + iVar7) = 1;
        *(int *)(&stack0xffffff90 + iVar7) = _CchDest;
        puVar10 = (undefined1 *)((int)&uStackY_74 + iVar7);
        *(undefined4 *)((int)&uStackY_74 + iVar7) = 0x10045554;
        iVar7 = MultiByteToWideChar(*(UINT *)(&stack0xffffff90 + iVar7),
                                    *(DWORD *)(&stack0xffffff94 + iVar7),
                                    *(LPCSTR *)(&stack0xffffff98 + iVar7),
                                    *(int *)(&stack0xffffff9c + iVar7),
                                    *(LPWSTR *)(&stack0xffffffa0 + iVar7),
                                    *(int *)(&stack0xffffffa4 + iVar7));
        puVar6 = puVar10;
        if (iVar7 != 0) {
          *(undefined4 *)(puVar10 + -4) = 0;
          *(undefined4 *)(puVar10 + -8) = 0;
          *(int *)(puVar10 + -0xc) = iVar5;
          *(undefined1 **)(puVar10 + -0x10) = local_20;
          *(LPCWSTR *)(puVar10 + -0x14) = _LocaleName;
          *(_locale_t *)(puVar10 + -0x18) = _Plocinfo;
          puVar11 = puVar10 + -0x1c;
          *(undefined4 *)(puVar10 + -0x1c) = 0x1004556e;
          iVar3 = LCMapStringW(*(LCID *)(puVar10 + -0x18),*(DWORD *)(puVar10 + -0x14),
                               *(LPCWSTR *)(puVar10 + -0x10),*(int *)(puVar10 + -0xc),
                               *(LPWSTR *)(puVar10 + -8),*(int *)(puVar10 + -4));
          puVar6 = puVar11;
          if (iVar3 != 0) {
            if (((uint)_LocaleName & 0x400) == 0) {
              puVar6 = (undefined1 *)(iVar3 * 2 + 3U & 0xfffffffc);
              *(undefined4 *)(puVar11 + -4) = 0x100455c3;
              iVar7 = -(int)puVar6;
              local_1c = puVar11 + iVar7;
              local_24 = puVar11 + iVar7;
              local_8 = (undefined *)0xffffffff;
              if (puVar11 == puVar6) {
                *(int *)(puVar11 + iVar7 + -4) = iVar3 * 2;
                *(undefined4 *)(puVar11 + iVar7 + -8) = 0x100455fa;
                local_24 = (undefined1 *)_malloc(*(size_t *)(puVar11 + iVar7 + -4));
                puVar6 = puVar11 + iVar7;
                if (local_24 == (undefined1 *)0x0) goto LAB_10045642;
                bVar1 = true;
              }
              *(int *)(puVar11 + iVar7 + -4) = iVar3;
              *(undefined1 **)(puVar11 + iVar7 + -8) = local_24;
              *(int *)(puVar11 + iVar7 + -0xc) = iVar5;
              *(undefined1 **)(puVar11 + iVar7 + -0x10) = local_20;
              *(LPCWSTR *)(puVar11 + iVar7 + -0x14) = _LocaleName;
              *(_locale_t *)(puVar11 + iVar7 + -0x18) = _Plocinfo;
              puVar13 = puVar11 + iVar7 + -0x1c;
              *(undefined4 *)(puVar11 + iVar7 + -0x1c) = 0x1004561d;
              iVar5 = LCMapStringW(*(LCID *)(puVar11 + iVar7 + -0x18),
                                   *(DWORD *)(puVar11 + iVar7 + -0x14),
                                   *(LPCWSTR *)(puVar11 + iVar7 + -0x10),
                                   *(int *)(puVar11 + iVar7 + -0xc),
                                   *(LPWSTR *)(puVar11 + iVar7 + -8),*(int *)(puVar11 + iVar7 + -4))
              ;
              puVar6 = puVar13;
              if (iVar5 != 0) {
                *(undefined4 *)(puVar13 + -4) = 0;
                *(undefined4 *)(puVar13 + -8) = 0;
                if (_LpDestStr == (LPSTR)0x0) {
                  *(undefined4 *)(puVar13 + -0xc) = 0;
                  *(undefined4 *)(puVar13 + -0x10) = 0;
                }
                else {
                  *(LPSTR *)(puVar13 + -0xc) = _LpDestStr;
                  *(int *)(puVar13 + -0x10) = _CchSrc;
                }
                *(int *)(puVar13 + -0x14) = iVar3;
                *(undefined1 **)(puVar13 + -0x18) = local_24;
                *(undefined4 *)(puVar13 + -0x1c) = 0;
                *(int *)(puVar13 + -0x20) = _CchDest;
                puVar6 = puVar13 + -0x24;
                *(undefined4 *)(puVar13 + -0x24) = 0x10045640;
                iVar3 = WideCharToMultiByte(*(UINT *)(puVar13 + -0x20),*(DWORD *)(puVar13 + -0x1c),
                                            *(LPCWSTR *)(puVar13 + -0x18),*(int *)(puVar13 + -0x14),
                                            *(LPSTR *)(puVar13 + -0x10),*(int *)(puVar13 + -0xc),
                                            *(LPCSTR *)(puVar13 + -8),*(LPBOOL *)(puVar13 + -4));
              }
            }
            else if ((_LpDestStr != (LPSTR)0x0) && (iVar3 <= (int)_LpDestStr)) {
              *(LPSTR *)(puVar11 + -4) = _LpDestStr;
              *(int *)(puVar11 + -8) = _CchSrc;
              *(int *)(puVar11 + -0xc) = iVar5;
              *(undefined1 **)(puVar11 + -0x10) = local_20;
              *(LPCWSTR *)(puVar11 + -0x14) = _LocaleName;
              *(_locale_t *)(puVar11 + -0x18) = _Plocinfo;
              puVar12 = puVar11 + -0x1c;
              *(undefined4 *)(puVar11 + -0x1c) = 0x100455a9;
              LCMapStringW(*(LCID *)(puVar11 + -0x18),*(DWORD *)(puVar11 + -0x14),
                           *(LPCWSTR *)(puVar11 + -0x10),*(int *)(puVar11 + -0xc),
                           *(LPWSTR *)(puVar11 + -8),*(int *)(puVar11 + -4));
              puVar6 = puVar12;
            }
          }
        }
LAB_10045642:
        if (bVar1) {
          *(undefined1 **)(puVar6 + -4) = local_24;
          *(undefined4 *)(puVar6 + -8) = 0x1004564f;
          _free(*(void **)(puVar6 + -4));
        }
        if (bVar2) {
          *(undefined1 **)(puVar6 + -4) = local_20;
          *(undefined4 *)(puVar6 + -8) = 0x1004565d;
          _free(*(void **)(puVar6 + -4));
          return iVar3;
        }
        return iVar3;
      }
    }
    return 0;
  }
  local_2c = (LPCSTR)0x0;
  pcVar14 = (char *)0x0;
  bVar1 = false;
  if (_Plocinfo == (_locale_t)0x0) {
    _Plocinfo = DAT_100692dc;
  }
  if (_CchDest == 0) {
    _CchDest = DAT_100692ec;
  }
  UVar8 = ___ansicp((LCID)_Plocinfo);
  if (UVar8 == 0xffffffff) {
    return 0;
  }
  if (UVar8 == _CchDest) {
    uStackY_74 = 0x100457ae;
    local_4c = LCMapStringA((LCID)_Plocinfo,(DWORD)_LocaleName,(LPCSTR)_DwMapFlag,(int)_LpSrcStr,
                            (LPSTR)_CchSrc,(int)_LpDestStr);
    goto LAB_100457b0;
  }
  uStackY_74 = 0x100456ba;
  local_2c = (LPCSTR)___convertcp(_CchDest,UVar8,(char *)_DwMapFlag,(size_t *)&_LpSrcStr,(LPSTR)0x0,
                                  0);
  if (local_2c == (LPCSTR)0x0) {
    return 0;
  }
  uStackY_74 = 0x100456d6;
  local_28 = LCMapStringA((LCID)_Plocinfo,(DWORD)_LocaleName,local_2c,(int)_LpSrcStr,(LPSTR)0x0,0);
  if (local_28 != 0) {
    local_8 = (undefined *)0x0;
    local_1c = &stack0xffffffa8;
    pcVar14 = &stack0xffffffa8;
    _memset(&stack0xffffffa8,0,local_28);
    local_8 = (undefined *)0xffffffff;
    if (&stack0x00000000 == (undefined1 *)0x58) {
      pcVar14 = (char *)_malloc(local_28);
      if (pcVar14 != (char *)0x0) {
        _memset(pcVar14,0,local_28);
        bVar1 = true;
        goto LAB_10045741;
      }
    }
    else {
LAB_10045741:
      uStackY_74 = 0x10045757;
      local_28 = LCMapStringA((LCID)_Plocinfo,(DWORD)_LocaleName,local_2c,(int)_LpSrcStr,pcVar14,
                              local_28);
      if (local_28 != 0) {
        uStackY_74 = 0x10045778;
        iVar3 = ___convertcp(UVar8,_CchDest,pcVar14,&local_28,(LPSTR)_CchSrc,(int)_LpDestStr);
        local_4c = (uint)(iVar3 != 0);
        goto LAB_10045788;
      }
    }
    local_4c = 0;
  }
LAB_10045788:
  if (bVar1) {
    _free(pcVar14);
  }
LAB_100457b0:
  if (local_2c != (LPCSTR)0x0) {
    _free(local_2c);
    return local_4c;
  }
  return local_4c;
}



// Library Function - Single Match
//  ___isctype_mt
// 
// Library: Visual Studio 2003 Release

uint __thiscall ___isctype_mt(void *this,int param_1,int param_2,uint param_3)

{
  undefined4 uVar1;
  LPCSTR _LpSrcStr;
  BOOL BVar2;
  undefined4 local_8;
  
  if (param_2 + 1U < 0x101) {
    param_2._2_2_ = *(ushort *)(*(int *)(param_1 + 0x48) + param_2 * 2);
  }
  else {
    local_8._2_2_ = (undefined2)((uint)this >> 0x10);
    if ((*(byte *)(*(int *)(param_1 + 0x48) + 1 + (param_2 >> 8 & 0xffU) * 2) & 0x80) == 0) {
      local_8._0_2_ = (ushort)(byte)param_2;
      _LpSrcStr = (LPCSTR)0x1;
    }
    else {
      local_8 = CONCAT31(CONCAT21(local_8._2_2_,(byte)param_2),(char)((uint)param_2 >> 8));
      uVar1 = local_8;
      local_8._3_1_ = (undefined1)((uint)this >> 0x18);
      local_8._0_2_ = (ushort)uVar1;
      local_8._0_3_ = (uint3)(ushort)local_8;
      _LpSrcStr = (LPCSTR)0x2;
    }
    BVar2 = ___crtGetStringTypeA
                      ((_locale_t)0x1,(DWORD)&local_8,_LpSrcStr,(int)&param_2 + 2,
                       *(LPWORD *)(param_1 + 4),*(int *)(param_1 + 0x14),1);
    if (BVar2 == 0) {
      return 0;
    }
  }
  return param_2._2_2_ & param_3;
}



// Library Function - Single Match
//  ___freetlocinfo
// 
// Library: Visual Studio 2003 Release

void __cdecl ___freetlocinfo(void *param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  
  if (((*(int *)((int)param_1 + 0x3c) != DAT_10069300) && (*(int *)((int)param_1 + 0x3c) != 0)) &&
     (**(int **)((int)param_1 + 0x2c) == 0)) {
    piVar1 = *(int **)((int)param_1 + 0x34);
    if (((piVar1 != (int *)0x0) && (*piVar1 == 0)) && (piVar1 != DAT_10069380)) {
      _free(piVar1);
      ___free_lconv_mon(*(int *)((int)param_1 + 0x3c));
    }
    piVar1 = *(int **)((int)param_1 + 0x30);
    if (((piVar1 != (int *)0x0) && (*piVar1 == 0)) && (piVar1 != DAT_10069384)) {
      _free(piVar1);
      ___free_lconv_num(*(undefined4 **)((int)param_1 + 0x3c));
    }
    _free(*(void **)((int)param_1 + 0x2c));
    _free(*(void **)((int)param_1 + 0x3c));
  }
  piVar1 = *(int **)((int)param_1 + 0x40);
  if (((piVar1 != DAT_1006937c) && (piVar1 != (int *)0x0)) && (*piVar1 == 0)) {
    _free(piVar1);
    _free((void *)(*(int *)((int)param_1 + 0x44) + -0xfe));
  }
  puVar2 = *(undefined4 **)((int)param_1 + 0x50);
  if (((puVar2 != DAT_100692fc) && (puVar2 != (undefined4 *)0x0)) && (puVar2[0x2d] == 0)) {
    ___free_lc_time(puVar2);
    _free(*(void **)((int)param_1 + 0x50));
  }
  _free(param_1);
  return;
}



// Library Function - Single Match
//  ___updatetlocinfo_lk
// 
// Library: Visual Studio 2003 Release

int ___updatetlocinfo_lk(void)

{
  int *piVar1;
  int *piVar2;
  _ptiddata p_Var3;
  
  p_Var3 = __getptd();
  piVar1 = (int *)p_Var3->_tfpecode;
  if (piVar1 != (int *)PTR_DAT_10057c5c) {
    if (piVar1 != (int *)0x0) {
      piVar2 = (int *)piVar1[0xb];
      *piVar1 = *piVar1 + -1;
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      piVar2 = (int *)piVar1[0xd];
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      piVar2 = (int *)piVar1[0xc];
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      piVar2 = (int *)piVar1[0x10];
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      *(int *)(piVar1[0x13] + 0xb4) = *(int *)(piVar1[0x13] + 0xb4) + -1;
    }
    p_Var3->_tfpecode = (int)PTR_DAT_10057c5c;
    *(int *)PTR_DAT_10057c5c = *(int *)PTR_DAT_10057c5c + 1;
    if (*(int *)(PTR_DAT_10057c5c + 0x2c) != 0) {
      **(int **)(PTR_DAT_10057c5c + 0x2c) = **(int **)(PTR_DAT_10057c5c + 0x2c) + 1;
    }
    if (*(int *)(PTR_DAT_10057c5c + 0x34) != 0) {
      **(int **)(PTR_DAT_10057c5c + 0x34) = **(int **)(PTR_DAT_10057c5c + 0x34) + 1;
    }
    if (*(int *)(PTR_DAT_10057c5c + 0x30) != 0) {
      **(int **)(PTR_DAT_10057c5c + 0x30) = **(int **)(PTR_DAT_10057c5c + 0x30) + 1;
    }
    if (*(int *)(PTR_DAT_10057c5c + 0x40) != 0) {
      **(int **)(PTR_DAT_10057c5c + 0x40) = **(int **)(PTR_DAT_10057c5c + 0x40) + 1;
    }
    *(int *)(*(int *)(PTR_DAT_10057c5c + 0x4c) + 0xb4) =
         *(int *)(*(int *)(PTR_DAT_10057c5c + 0x4c) + 0xb4) + 1;
    if (((piVar1 != (int *)0x0) && (*piVar1 == 0)) && (piVar1 != &DAT_10057c08)) {
      ___freetlocinfo(piVar1);
    }
  }
  return p_Var3->_tfpecode;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___updatetlocinfo
// 
// Library: Visual Studio 2003 Release

pthreadlocinfo __cdecl ___updatetlocinfo(void)

{
  pthreadlocinfo ptVar1;
  
  __lock(0xc);
  ptVar1 = (pthreadlocinfo)___updatetlocinfo_lk();
  FUN_10045a03();
  return ptVar1;
}



void FUN_10045a03(void)

{
  FUN_100425f0(0xc);
  return;
}



// Library Function - Single Match
//  ___sbh_heap_init
// 
// Library: Visual Studio 2003 Release

undefined4 ___sbh_heap_init(undefined4 param_1)

{
  DAT_100695c8 = HeapAlloc(DAT_100695dc,0,0x140);
  if (DAT_100695c8 == (LPVOID)0x0) {
    return 0;
  }
  DAT_100695c0 = 0;
  DAT_100695c4 = 0;
  DAT_100695d0 = DAT_100695c8;
  DAT_100695cc = param_1;
  DAT_100695d4 = 0x10;
  return 1;
}



// Library Function - Single Match
//  ___sbh_find_block
// 
// Library: Visual Studio 2003 Release

uint __cdecl ___sbh_find_block(int param_1)

{
  uint uVar1;
  
  uVar1 = DAT_100695c8;
  while( true ) {
    if (DAT_100695c8 + DAT_100695c4 * 0x14 <= uVar1) {
      return 0;
    }
    if ((uint)(param_1 - *(int *)(uVar1 + 0xc)) < 0x100000) break;
    uVar1 = uVar1 + 0x14;
  }
  return uVar1;
}



// Library Function - Single Match
//  ___sbh_free_block
// 
// Library: Visual Studio 2003 Release

void __cdecl ___sbh_free_block(uint *param_1,int param_2)

{
  int *piVar1;
  char *pcVar2;
  uint *puVar3;
  int *piVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  byte bVar8;
  uint uVar9;
  uint *puVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  uint uVar14;
  uint local_8;
  
  uVar6 = param_1[4];
  puVar12 = (uint *)(param_2 + -4);
  uVar14 = param_2 - param_1[3] >> 0xf;
  piVar4 = (int *)(uVar14 * 0x204 + 0x144 + uVar6);
  local_8 = *puVar12 - 1;
  if ((local_8 & 1) == 0) {
    puVar10 = (uint *)(local_8 + (int)puVar12);
    uVar13 = *puVar10;
    uVar7 = *(uint *)(param_2 + -8);
    if ((uVar13 & 1) == 0) {
      uVar9 = ((int)uVar13 >> 4) - 1;
      if (0x3f < uVar9) {
        uVar9 = 0x3f;
      }
      if (puVar10[1] == puVar10[2]) {
        if (uVar9 < 0x20) {
          pcVar2 = (char *)(uVar9 + 4 + uVar6);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 & 0x1f));
          puVar11 = (uint *)(uVar6 + 0x44 + uVar14 * 4);
          *puVar11 = *puVar11 & uVar9;
          *pcVar2 = *pcVar2 + -1;
          if (*pcVar2 == '\0') {
            *param_1 = *param_1 & uVar9;
          }
        }
        else {
          pcVar2 = (char *)(uVar9 + 4 + uVar6);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 - 0x20 & 0x1f));
          puVar11 = (uint *)(uVar6 + 0xc4 + uVar14 * 4);
          *puVar11 = *puVar11 & uVar9;
          *pcVar2 = *pcVar2 + -1;
          if (*pcVar2 == '\0') {
            param_1[1] = param_1[1] & uVar9;
          }
        }
      }
      local_8 = local_8 + uVar13;
      *(uint *)(puVar10[2] + 4) = puVar10[1];
      *(uint *)(puVar10[1] + 8) = puVar10[2];
    }
    puVar10 = (uint *)(((int)local_8 >> 4) - 1);
    if ((uint *)0x3f < puVar10) {
      puVar10 = (uint *)0x3f;
    }
    puVar11 = param_1;
    if ((uVar7 & 1) == 0) {
      puVar12 = (uint *)((int)puVar12 - uVar7);
      puVar11 = (uint *)(((int)uVar7 >> 4) - 1);
      if ((uint *)0x3f < puVar11) {
        puVar11 = (uint *)0x3f;
      }
      local_8 = local_8 + uVar7;
      puVar10 = (uint *)(((int)local_8 >> 4) - 1);
      if ((uint *)0x3f < puVar10) {
        puVar10 = (uint *)0x3f;
      }
      if (puVar11 != puVar10) {
        if (puVar12[1] == puVar12[2]) {
          if (puVar11 < (uint *)0x20) {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 & 0x1f));
            puVar3 = (uint *)(uVar6 + 0x44 + uVar14 * 4);
            *puVar3 = *puVar3 & uVar13;
            pcVar2 = (char *)((int)puVar11 + uVar6 + 4);
            *pcVar2 = *pcVar2 + -1;
            if (*pcVar2 == '\0') {
              *param_1 = *param_1 & uVar13;
            }
          }
          else {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 - 0x20 & 0x1f));
            puVar3 = (uint *)(uVar6 + 0xc4 + uVar14 * 4);
            *puVar3 = *puVar3 & uVar13;
            pcVar2 = (char *)((int)puVar11 + uVar6 + 4);
            *pcVar2 = *pcVar2 + -1;
            if (*pcVar2 == '\0') {
              param_1[1] = param_1[1] & uVar13;
            }
          }
        }
        *(uint *)(puVar12[2] + 4) = puVar12[1];
        *(uint *)(puVar12[1] + 8) = puVar12[2];
      }
    }
    if (((uVar7 & 1) != 0) || (puVar11 != puVar10)) {
      piVar1 = piVar4 + (int)puVar10 * 2;
      uVar13 = piVar1[1];
      puVar12[2] = (uint)piVar1;
      puVar12[1] = uVar13;
      piVar1[1] = (int)puVar12;
      *(uint **)(puVar12[1] + 8) = puVar12;
      if (puVar12[1] == puVar12[2]) {
        cVar5 = *(char *)((int)puVar10 + uVar6 + 4);
        *(char *)((int)puVar10 + uVar6 + 4) = cVar5 + '\x01';
        bVar8 = (byte)puVar10;
        if (puVar10 < (uint *)0x20) {
          if (cVar5 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
          }
          puVar10 = (uint *)(uVar6 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 & 0x1f);
        }
        else {
          if (cVar5 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
          }
          puVar10 = (uint *)(uVar6 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
        }
      }
    }
    *puVar12 = local_8;
    *(uint *)((local_8 - 4) + (int)puVar12) = local_8;
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      if (DAT_100695c0 != (uint *)0x0) {
        VirtualFree((LPVOID)(DAT_100695d8 * 0x8000 + DAT_100695c0[3]),0x8000,0x4000);
        DAT_100695c0[2] = DAT_100695c0[2] | 0x80000000U >> ((byte)DAT_100695d8 & 0x1f);
        *(undefined4 *)(DAT_100695c0[4] + 0xc4 + DAT_100695d8 * 4) = 0;
        *(char *)(DAT_100695c0[4] + 0x43) = *(char *)(DAT_100695c0[4] + 0x43) + -1;
        if (*(char *)(DAT_100695c0[4] + 0x43) == '\0') {
          DAT_100695c0[1] = DAT_100695c0[1] & 0xfffffffe;
        }
        if (DAT_100695c0[2] == 0xffffffff) {
          VirtualFree((LPVOID)DAT_100695c0[3],0,0x8000);
          HeapFree(DAT_100695dc,0,(LPVOID)DAT_100695c0[4]);
          _memmove(DAT_100695c0,DAT_100695c0 + 5,
                   (DAT_100695c4 * 0x14 - (int)DAT_100695c0) + -0x14 + DAT_100695c8);
          DAT_100695c4 = DAT_100695c4 + -1;
          if (DAT_100695c0 < param_1) {
            param_1 = param_1 + -5;
          }
          DAT_100695d0 = DAT_100695c8;
        }
      }
      DAT_100695c0 = param_1;
      DAT_100695d8 = uVar14;
    }
  }
  return;
}



// Library Function - Single Match
//  ___sbh_alloc_new_region
// 
// Library: Visual Studio 2003 Release

undefined4 * ___sbh_alloc_new_region(void)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  
  if (DAT_100695c4 == DAT_100695d4) {
    pvVar2 = HeapReAlloc(DAT_100695dc,0,DAT_100695c8,(DAT_100695d4 * 5 + 0x50) * 4);
    if (pvVar2 == (LPVOID)0x0) {
      return (undefined4 *)0x0;
    }
    DAT_100695d4 = DAT_100695d4 + 0x10;
    DAT_100695c8 = pvVar2;
  }
  puVar1 = (undefined4 *)((int)DAT_100695c8 + DAT_100695c4 * 0x14);
  pvVar2 = HeapAlloc(DAT_100695dc,8,0x41c4);
  puVar1[4] = pvVar2;
  if (pvVar2 != (LPVOID)0x0) {
    pvVar2 = VirtualAlloc((LPVOID)0x0,0x100000,0x2000,4);
    puVar1[3] = pvVar2;
    if (pvVar2 != (LPVOID)0x0) {
      puVar1[2] = 0xffffffff;
      *puVar1 = 0;
      puVar1[1] = 0;
      DAT_100695c4 = DAT_100695c4 + 1;
      *(undefined4 *)puVar1[4] = 0xffffffff;
      return puVar1;
    }
    HeapFree(DAT_100695dc,0,(LPVOID)puVar1[4]);
  }
  return (undefined4 *)0x0;
}



// Library Function - Single Match
//  ___sbh_alloc_new_group
// 
// Library: Visual Studio 2003 Release

int __cdecl ___sbh_alloc_new_group(int param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  LPVOID pvVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  LPVOID lpAddress;
  
  iVar2 = *(int *)(param_1 + 0x10);
  iVar8 = 0;
  for (iVar3 = *(int *)(param_1 + 8); -1 < iVar3; iVar3 = iVar3 << 1) {
    iVar8 = iVar8 + 1;
  }
  iVar3 = iVar8 * 0x204 + 0x144 + iVar2;
  iVar7 = 0x3f;
  iVar4 = iVar3;
  do {
    *(int *)(iVar4 + 8) = iVar4;
    *(int *)(iVar4 + 4) = iVar4;
    iVar4 = iVar4 + 8;
    iVar7 = iVar7 + -1;
  } while (iVar7 != 0);
  lpAddress = (LPVOID)(iVar8 * 0x8000 + *(int *)(param_1 + 0xc));
  pvVar5 = VirtualAlloc(lpAddress,0x8000,0x1000,4);
  if (pvVar5 == (LPVOID)0x0) {
    iVar8 = -1;
  }
  else {
    if (lpAddress <= (LPVOID)((int)lpAddress + 0x7000U)) {
      piVar6 = (int *)((int)lpAddress + 0x10);
      iVar7 = ((uint)((int)((int)lpAddress + 0x7000U) - (int)lpAddress) >> 0xc) + 1;
      do {
        piVar6[-2] = -1;
        piVar6[0x3fb] = -1;
        *piVar6 = (int)(piVar6 + 0x3ff);
        piVar6[-1] = 0xff0;
        piVar6[1] = (int)(piVar6 + -0x401);
        piVar6[0x3fa] = 0xff0;
        piVar6 = piVar6 + 0x400;
        iVar7 = iVar7 + -1;
      } while (iVar7 != 0);
    }
    *(int *)(iVar3 + 0x1fc) = (int)lpAddress + 0xc;
    *(int *)((int)lpAddress + 0x14) = iVar3 + 0x1f8;
    *(int *)(iVar3 + 0x200) = (int)lpAddress + 0x700c;
    *(int *)((int)lpAddress + 0x7010) = iVar3 + 0x1f8;
    *(undefined4 *)(iVar2 + 0x44 + iVar8 * 4) = 0;
    *(undefined4 *)(iVar2 + 0xc4 + iVar8 * 4) = 1;
    cVar1 = *(char *)(iVar2 + 0x43);
    *(char *)(iVar2 + 0x43) = cVar1 + '\x01';
    if (cVar1 == '\0') {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 1;
    }
    *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) & ~(0x80000000U >> ((byte)iVar8 & 0x1f));
  }
  return iVar8;
}



// Library Function - Single Match
//  ___sbh_resize_block
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl ___sbh_resize_block(uint *param_1,int param_2,int param_3)

{
  char *pcVar1;
  uint *puVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  char cVar6;
  uint uVar7;
  uint *puVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint local_c;
  
  uVar7 = param_1[4];
  uVar10 = param_2 - param_1[3] >> 0xf;
  iVar5 = uVar10 * 0x204 + 0x144 + uVar7;
  uVar12 = param_3 + 0x17U & 0xfffffff0;
  iVar9 = *(int *)(param_2 + -4) + -1;
  puVar8 = (uint *)(*(int *)(param_2 + -4) + -5 + param_2);
  uVar13 = *puVar8;
  if (iVar9 < (int)uVar12) {
    if (((uVar13 & 1) != 0) || ((int)(uVar13 + iVar9) < (int)uVar12)) {
      return 0;
    }
    local_c = ((int)uVar13 >> 4) - 1;
    if (0x3f < local_c) {
      local_c = 0x3f;
    }
    if (puVar8[1] == puVar8[2]) {
      if (local_c < 0x20) {
        pcVar1 = (char *)(local_c + 4 + uVar7);
        uVar11 = ~(0x80000000U >> ((byte)local_c & 0x1f));
        puVar2 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
        *puVar2 = *puVar2 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar11;
        }
      }
      else {
        pcVar1 = (char *)(local_c + 4 + uVar7);
        uVar11 = ~(0x80000000U >> ((byte)local_c - 0x20 & 0x1f));
        puVar2 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
        *puVar2 = *puVar2 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar11;
        }
      }
    }
    *(uint *)(puVar8[2] + 4) = puVar8[1];
    *(uint *)(puVar8[1] + 8) = puVar8[2];
    iVar9 = uVar13 + (iVar9 - uVar12);
    if (0 < iVar9) {
      uVar13 = (iVar9 >> 4) - 1;
      iVar3 = param_2 + -4 + uVar12;
      if (0x3f < uVar13) {
        uVar13 = 0x3f;
      }
      iVar5 = iVar5 + uVar13 * 8;
      *(undefined4 *)(iVar3 + 4) = *(undefined4 *)(iVar5 + 4);
      *(int *)(iVar3 + 8) = iVar5;
      *(int *)(iVar5 + 4) = iVar3;
      *(int *)(*(int *)(iVar3 + 4) + 8) = iVar3;
      if (*(int *)(iVar3 + 4) == *(int *)(iVar3 + 8)) {
        cVar6 = *(char *)(uVar13 + 4 + uVar7);
        *(char *)(uVar13 + 4 + uVar7) = cVar6 + '\x01';
        if (uVar13 < 0x20) {
          if (cVar6 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> ((byte)uVar13 & 0x1f);
          }
          puVar8 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
        }
        else {
          if (cVar6 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> ((byte)uVar13 - 0x20 & 0x1f);
          }
          puVar8 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
          uVar13 = uVar13 - 0x20;
        }
        *puVar8 = *puVar8 | 0x80000000U >> ((byte)uVar13 & 0x1f);
      }
      piVar4 = (int *)(param_2 + -4 + uVar12);
      *piVar4 = iVar9;
      *(int *)(iVar9 + -4 + (int)piVar4) = iVar9;
    }
    *(uint *)(param_2 + -4) = uVar12 + 1;
    *(uint *)(param_2 + -8 + uVar12) = uVar12 + 1;
  }
  else if ((int)uVar12 < iVar9) {
    param_3 = iVar9 - uVar12;
    *(uint *)(param_2 + -4) = uVar12 + 1;
    piVar4 = (int *)(param_2 + -4 + uVar12);
    uVar11 = (param_3 >> 4) - 1;
    piVar4[-1] = uVar12 + 1;
    if (0x3f < uVar11) {
      uVar11 = 0x3f;
    }
    if ((uVar13 & 1) == 0) {
      uVar12 = ((int)uVar13 >> 4) - 1;
      if (0x3f < uVar12) {
        uVar12 = 0x3f;
      }
      if (puVar8[1] == puVar8[2]) {
        if (uVar12 < 0x20) {
          pcVar1 = (char *)(uVar12 + 4 + uVar7);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 & 0x1f));
          puVar2 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
          *puVar2 = *puVar2 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar12;
          }
        }
        else {
          pcVar1 = (char *)(uVar12 + 4 + uVar7);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 - 0x20 & 0x1f));
          puVar2 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
          *puVar2 = *puVar2 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar12;
          }
        }
      }
      *(uint *)(puVar8[2] + 4) = puVar8[1];
      *(uint *)(puVar8[1] + 8) = puVar8[2];
      param_3 = param_3 + uVar13;
      uVar11 = (param_3 >> 4) - 1;
      if (0x3f < uVar11) {
        uVar11 = 0x3f;
      }
    }
    iVar5 = iVar5 + uVar11 * 8;
    iVar9 = *(int *)(iVar5 + 4);
    piVar4[2] = iVar5;
    piVar4[1] = iVar9;
    *(int **)(iVar5 + 4) = piVar4;
    *(int **)(piVar4[1] + 8) = piVar4;
    if (piVar4[1] == piVar4[2]) {
      cVar6 = *(char *)(uVar11 + 4 + uVar7);
      *(char *)(uVar11 + 4 + uVar7) = cVar6 + '\x01';
      if (uVar11 < 0x20) {
        if (cVar6 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> ((byte)uVar11 & 0x1f);
        }
        puVar8 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
      }
      else {
        if (cVar6 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> ((byte)uVar11 - 0x20 & 0x1f);
        }
        puVar8 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
        uVar11 = uVar11 - 0x20;
      }
      *puVar8 = *puVar8 | 0x80000000U >> ((byte)uVar11 & 0x1f);
    }
    *piVar4 = param_3;
    *(int *)(param_3 + -4 + (int)piVar4) = param_3;
  }
  return 1;
}



// Library Function - Single Match
//  ___sbh_alloc_block
// 
// Library: Visual Studio 2003 Release

int * __cdecl ___sbh_alloc_block(uint *param_1)

{
  int *piVar1;
  char *pcVar2;
  int *piVar3;
  char cVar4;
  int *piVar5;
  byte bVar6;
  uint uVar7;
  int iVar8;
  uint *puVar9;
  int iVar10;
  int *piVar11;
  uint *puVar12;
  uint *puVar13;
  uint uVar14;
  int iVar15;
  bool bVar16;
  uint local_c;
  int local_8;
  
  uVar7 = (int)param_1 + 0x17U & 0xfffffff0;
  iVar8 = ((int)((int)param_1 + 0x17U) >> 4) + -1;
  puVar9 = DAT_100695c8 + DAT_100695c4 * 5;
  bVar6 = (byte)iVar8;
  if (iVar8 < 0x20) {
    uVar14 = 0xffffffff >> (bVar6 & 0x1f);
    local_c = 0xffffffff;
  }
  else {
    uVar14 = 0;
    local_c = 0xffffffff >> (bVar6 - 0x20 & 0x1f);
  }
  bVar16 = DAT_100695d0 < puVar9;
  param_1 = DAT_100695d0;
  while ((bVar16 && ((param_1[1] & local_c) == 0 && (*param_1 & uVar14) == 0))) {
    param_1 = param_1 + 5;
    bVar16 = param_1 < puVar9;
  }
  puVar12 = DAT_100695c8;
  if (param_1 == puVar9) {
    for (; (puVar12 < DAT_100695d0 && ((puVar12[1] & local_c) == 0 && (*puVar12 & uVar14) == 0));
        puVar12 = puVar12 + 5) {
    }
    param_1 = puVar12;
    if (puVar12 == DAT_100695d0) {
      for (; (puVar12 < puVar9 && (puVar12[2] == 0)); puVar12 = puVar12 + 5) {
      }
      puVar13 = DAT_100695c8;
      param_1 = puVar12;
      if (puVar12 == puVar9) {
        for (; (puVar13 < DAT_100695d0 && (puVar13[2] == 0)); puVar13 = puVar13 + 5) {
        }
        param_1 = puVar13;
        if ((puVar13 == DAT_100695d0) &&
           (param_1 = ___sbh_alloc_new_region(), param_1 == (uint *)0x0)) {
          return (int *)0x0;
        }
      }
      iVar8 = ___sbh_alloc_new_group((int)param_1);
      *(int *)param_1[4] = iVar8;
      if (*(int *)param_1[4] == -1) {
        return (int *)0x0;
      }
    }
  }
  piVar5 = (int *)param_1[4];
  local_8 = *piVar5;
  if ((local_8 == -1) ||
     ((piVar5[local_8 + 0x31] & local_c) == 0 && (piVar5[local_8 + 0x11] & uVar14) == 0)) {
    local_8 = 0;
    puVar9 = (uint *)(piVar5 + 0x11);
    if ((piVar5[0x31] & local_c) == 0 && (*puVar9 & uVar14) == 0) {
      do {
        puVar12 = puVar9 + 0x21;
        local_8 = local_8 + 1;
        puVar9 = puVar9 + 1;
      } while ((*puVar12 & local_c) == 0 && (*puVar9 & uVar14) == 0);
    }
  }
  piVar3 = piVar5 + local_8 * 0x81 + 0x51;
  iVar8 = 0;
  uVar14 = piVar5[local_8 + 0x11] & uVar14;
  if (uVar14 == 0) {
    uVar14 = piVar5[local_8 + 0x31] & local_c;
    iVar8 = 0x20;
  }
  for (; -1 < (int)uVar14; uVar14 = uVar14 << 1) {
    iVar8 = iVar8 + 1;
  }
  piVar11 = (int *)piVar3[iVar8 * 2 + 1];
  iVar10 = *piVar11 - uVar7;
  iVar15 = (iVar10 >> 4) + -1;
  if (0x3f < iVar15) {
    iVar15 = 0x3f;
  }
  DAT_100695d0 = param_1;
  if (iVar15 != iVar8) {
    if (piVar11[1] == piVar11[2]) {
      if (iVar8 < 0x20) {
        pcVar2 = (char *)((int)piVar5 + iVar8 + 4);
        uVar14 = ~(0x80000000U >> ((byte)iVar8 & 0x1f));
        piVar5[local_8 + 0x11] = uVar14 & piVar5[local_8 + 0x11];
        *pcVar2 = *pcVar2 + -1;
        if (*pcVar2 == '\0') {
          *param_1 = *param_1 & uVar14;
        }
      }
      else {
        pcVar2 = (char *)((int)piVar5 + iVar8 + 4);
        uVar14 = ~(0x80000000U >> ((byte)iVar8 - 0x20 & 0x1f));
        piVar5[local_8 + 0x31] = piVar5[local_8 + 0x31] & uVar14;
        *pcVar2 = *pcVar2 + -1;
        if (*pcVar2 == '\0') {
          param_1[1] = param_1[1] & uVar14;
        }
      }
    }
    *(int *)(piVar11[2] + 4) = piVar11[1];
    *(int *)(piVar11[1] + 8) = piVar11[2];
    if (iVar10 == 0) goto LAB_100464ec;
    piVar1 = piVar3 + iVar15 * 2;
    iVar8 = piVar1[1];
    piVar11[2] = (int)piVar1;
    piVar11[1] = iVar8;
    piVar1[1] = (int)piVar11;
    *(int **)(piVar11[1] + 8) = piVar11;
    if (piVar11[1] == piVar11[2]) {
      cVar4 = *(char *)(iVar15 + 4 + (int)piVar5);
      *(char *)(iVar15 + 4 + (int)piVar5) = cVar4 + '\x01';
      bVar6 = (byte)iVar15;
      if (iVar15 < 0x20) {
        if (cVar4 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar6 & 0x1f);
        }
        piVar5[local_8 + 0x11] = piVar5[local_8 + 0x11] | 0x80000000U >> (bVar6 & 0x1f);
      }
      else {
        if (cVar4 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar6 - 0x20 & 0x1f);
        }
        piVar5[local_8 + 0x31] = piVar5[local_8 + 0x31] | 0x80000000U >> (bVar6 - 0x20 & 0x1f);
      }
    }
  }
  if (iVar10 != 0) {
    *piVar11 = iVar10;
    *(int *)(iVar10 + -4 + (int)piVar11) = iVar10;
  }
LAB_100464ec:
  piVar11 = (int *)((int)piVar11 + iVar10);
  *piVar11 = uVar7 + 1;
  *(uint *)((int)piVar11 + (uVar7 - 4)) = uVar7 + 1;
  iVar8 = *piVar3;
  *piVar3 = iVar8 + 1;
  if (((iVar8 == 0) && (param_1 == DAT_100695c0)) && (local_8 == DAT_100695d8)) {
    DAT_100695c0 = (uint *)0x0;
  }
  *piVar5 = local_8;
  return piVar11 + 1;
}



// Library Function - Single Match
//  __callnewh
// 
// Library: Visual Studio 2003 Release

int __cdecl __callnewh(size_t _Size)

{
  int iVar1;
  
  if (DAT_10069258 != (code *)0x0) {
    iVar1 = (*DAT_10069258)(_Size);
    if (iVar1 != 0) {
      return 1;
    }
  }
  return 0;
}



// Library Function - Single Match
//  __close_lk
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __close_lk(uint param_1)

{
  intptr_t iVar1;
  intptr_t iVar2;
  HANDLE hObject;
  BOOL BVar3;
  DWORD DVar4;
  undefined4 uVar5;
  
  iVar1 = __get_osfhandle(param_1);
  if (iVar1 != -1) {
    if ((param_1 == 1) || (param_1 == 2)) {
      iVar1 = __get_osfhandle(2);
      iVar2 = __get_osfhandle(1);
      if (iVar2 == iVar1) goto LAB_10046598;
    }
    hObject = (HANDLE)__get_osfhandle(param_1);
    BVar3 = CloseHandle(hObject);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      goto LAB_1004659a;
    }
  }
LAB_10046598:
  DVar4 = 0;
LAB_1004659a:
  __free_osfhnd(param_1);
  *(undefined1 *)((&DAT_10069600)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) = 0;
  if (DVar4 == 0) {
    uVar5 = 0;
  }
  else {
    __dosmaperr(DVar4);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __close
// 
// Library: Visual Studio 2003 Release

int __cdecl __close(int _FileHandle)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  int local_20;
  
  if ((uint)_FileHandle < DAT_100695e4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_10041d35();
        *piVar1 = 9;
        local_20 = -1;
      }
      else {
        local_20 = __close_lk(_FileHandle);
      }
      FUN_10046644();
      return local_20;
    }
  }
  piVar1 = FUN_10041d35();
  *piVar1 = 9;
  puVar2 = FUN_10041d3e();
  *puVar2 = 0;
  return -1;
}



void FUN_10046644(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// Library Function - Single Match
//  __freebuf
// 
// Library: Visual Studio 2003 Release

void __cdecl __freebuf(FILE *_File)

{
  if (((_File->_flag & 0x83U) != 0) && ((_File->_flag & 8U) != 0)) {
    _free(_File->_base);
    *(ushort *)&_File->_flag = (ushort)_File->_flag & 0xfbf7;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_cnt = 0;
  }
  return;
}



// Library Function - Single Match
//  __filbuf
// 
// Library: Visual Studio 2003 Release

int __cdecl __filbuf(FILE *_File)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  undefined *puVar4;
  
  uVar2 = _File->_flag;
  if (((uVar2 & 0x83) != 0) && ((uVar2 & 0x40) == 0)) {
    if ((uVar2 & 2) == 0) {
      _File->_flag = uVar2 | 1;
      if ((uVar2 & 0x10c) == 0) {
        __getbuf(_File);
      }
      else {
        _File->_ptr = _File->_base;
      }
      iVar3 = __read(_File->_file,_File->_base,_File->_bufsiz);
      _File->_cnt = iVar3;
      if ((iVar3 != 0) && (iVar3 != -1)) {
        if ((_File->_flag & 0x82U) == 0) {
          uVar2 = _File->_file;
          if (uVar2 == 0xffffffff) {
            puVar4 = &DAT_100579a0;
          }
          else {
            puVar4 = (undefined *)((&DAT_10069600)[(int)uVar2 >> 5] + (uVar2 & 0x1f) * 0x24);
          }
          if ((puVar4[4] & 0x82) == 0x82) {
            _File->_flag = _File->_flag | 0x2000;
          }
        }
        if (((_File->_bufsiz == 0x200) && ((_File->_flag & 8U) != 0)) &&
           ((_File->_flag & 0x400U) == 0)) {
          _File->_bufsiz = 0x1000;
        }
        _File->_cnt = iVar3 + -1;
        bVar1 = *_File->_ptr;
        _File->_ptr = _File->_ptr + 1;
        return (uint)bVar1;
      }
      _File->_flag = _File->_flag | (-(uint)(iVar3 != 0) & 0x10) + 0x10;
      _File->_cnt = 0;
    }
    else {
      _File->_flag = uVar2 | 0x20;
    }
  }
  return -1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __openfile
// 
// Library: Visual Studio 2003 Release

FILE * __cdecl __openfile(char *_Filename,char *_Mode,int _ShFlag,FILE *_File)

{
  char cVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  int iVar5;
  uint _OpenFlag;
  uint uVar6;
  
  cVar1 = *_Mode;
  bVar4 = false;
  bVar3 = false;
  if (cVar1 == 'a') {
    _OpenFlag = 0x109;
  }
  else {
    if (cVar1 == 'r') {
      _OpenFlag = 0;
      uVar6 = DAT_1006934c | 1;
      goto LAB_100467b5;
    }
    if (cVar1 != 'w') {
      return (FILE *)0x0;
    }
    _OpenFlag = 0x301;
  }
  uVar6 = DAT_1006934c | 2;
LAB_100467b5:
  bVar2 = true;
LAB_10046894:
  _Mode = _Mode + 1;
  cVar1 = *_Mode;
  if ((cVar1 == '\0') || (!bVar2)) {
    iVar5 = __sopen(_Filename,_OpenFlag,_ShFlag,0x1a4);
    if (iVar5 < 0) {
      return (FILE *)0x0;
    }
    _DAT_10068e3c = _DAT_10068e3c + 1;
    _File->_flag = uVar6;
    _File->_cnt = 0;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_tmpfname = (char *)0x0;
    _File->_file = iVar5;
    return _File;
  }
  if (cVar1 < 'U') {
    if (cVar1 == 'T') {
      if ((_OpenFlag & 0x1000) == 0) {
        _OpenFlag = _OpenFlag | 0x1000;
        goto LAB_10046894;
      }
    }
    else if (cVar1 == '+') {
      if ((_OpenFlag & 2) == 0) {
        _OpenFlag = _OpenFlag & 0xfffffffe | 2;
        uVar6 = uVar6 & 0xfffffffc | 0x80;
        goto LAB_10046894;
      }
    }
    else if (cVar1 == 'D') {
      if ((_OpenFlag & 0x40) == 0) {
        _OpenFlag = _OpenFlag | 0x40;
        goto LAB_10046894;
      }
    }
    else if (cVar1 == 'R') {
      if (!bVar3) {
        bVar3 = true;
        _OpenFlag = _OpenFlag | 0x10;
        goto LAB_10046894;
      }
    }
    else if ((cVar1 == 'S') && (!bVar3)) {
      bVar3 = true;
      _OpenFlag = _OpenFlag | 0x20;
      goto LAB_10046894;
    }
  }
  else {
    if (cVar1 == 'b') {
      if ((_OpenFlag & 0xc000) != 0) goto LAB_10046876;
      _OpenFlag = _OpenFlag | 0x8000;
      goto LAB_10046894;
    }
    if (cVar1 == 'c') {
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 | 0x4000;
        goto LAB_10046894;
      }
    }
    else {
      if (cVar1 != 'n') {
        if ((cVar1 != 't') || ((_OpenFlag & 0xc000) != 0)) goto LAB_10046876;
        _OpenFlag = _OpenFlag | 0x4000;
        goto LAB_10046894;
      }
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 & 0xffffbfff;
        goto LAB_10046894;
      }
    }
  }
LAB_10046876:
  bVar2 = false;
  goto LAB_10046894;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __getstream
// 
// Library: Visual Studio 2003 Release

FILE * __cdecl __getstream(void)

{
  int iVar1;
  void *pvVar2;
  int iVar3;
  FILE *pFVar4;
  FILE *_File;
  
  pFVar4 = (FILE *)0x0;
  __lock(1);
  iVar3 = 0;
  do {
    _File = pFVar4;
    if (DAT_1006a720 <= iVar3) {
LAB_100469cb:
      if (_File != (FILE *)0x0) {
        _File->_cnt = 0;
        _File->_flag = 0;
        _File->_base = (char *)0x0;
        _File->_ptr = (char *)0x0;
        _File->_tmpfname = (char *)0x0;
        _File->_file = -1;
      }
      FUN_100469f5();
      return _File;
    }
    iVar1 = *(int *)(DAT_10069710 + iVar3 * 4);
    if (iVar1 == 0) {
      iVar3 = iVar3 * 4;
      pvVar2 = _malloc(0x38);
      *(void **)(iVar3 + DAT_10069710) = pvVar2;
      if (*(int *)(iVar3 + DAT_10069710) != 0) {
        iVar1 = ___crtInitCritSecAndSpinCount(*(int *)(iVar3 + DAT_10069710) + 0x20,4000);
        if (iVar1 == 0) {
          _free(*(void **)(iVar3 + DAT_10069710));
          *(undefined4 *)(iVar3 + DAT_10069710) = 0;
        }
        else {
          EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(iVar3 + DAT_10069710) + 0x20));
          _File = *(FILE **)(iVar3 + DAT_10069710);
        }
      }
      goto LAB_100469cb;
    }
    if ((*(byte *)(iVar1 + 0xc) & 0x83) == 0) {
      if (((2 < iVar3) && (iVar3 < 0x14)) && (iVar1 = __mtinitlocknum(iVar3 + 0x10), iVar1 == 0))
      goto LAB_100469cb;
      __lock_file2(iVar3,*(void **)(DAT_10069710 + iVar3 * 4));
      _File = *(FILE **)(DAT_10069710 + iVar3 * 4);
      if ((_File->_flag & 0x83) == 0) goto LAB_100469cb;
      __unlock_file2(iVar3,_File);
    }
    iVar3 = iVar3 + 1;
  } while( true );
}



void FUN_100469f5(void)

{
  FUN_100425f0(1);
  return;
}



// Library Function - Single Match
//  _memcpy
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

void * __cdecl _memcpy(void *_Dst,void *_Src,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((_Src < _Dst) && (_Dst < (void *)(_Size + (int)_Src))) {
    puVar3 = (undefined4 *)((_Size - 4) + (int)_Src);
    puVar4 = (undefined4 *)((_Size - 4) + (int)_Dst);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = _Size >> 2;
      uVar2 = _Size & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return _Dst;
        case 2:
          goto switchD_10046bbb_caseD_2;
        case 3:
          goto switchD_10046bbb_caseD_3;
        }
        goto switchD_10046bbb_caseD_1;
      }
    }
    else {
      switch(_Size) {
      case 0:
        goto switchD_10046bbb_caseD_0;
      case 1:
        goto switchD_10046bbb_caseD_1;
      case 2:
        goto switchD_10046bbb_caseD_2;
      case 3:
        goto switchD_10046bbb_caseD_3;
      default:
        uVar1 = _Size - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_10046bbb_caseD_2;
            case 3:
              goto switchD_10046bbb_caseD_3;
            }
            goto switchD_10046bbb_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_10046bbb_caseD_2;
            case 3:
              goto switchD_10046bbb_caseD_3;
            }
            goto switchD_10046bbb_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_10046bbb_caseD_2;
            case 3:
              goto switchD_10046bbb_caseD_3;
            }
            goto switchD_10046bbb_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_10046bbb_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return _Dst;
    case 2:
switchD_10046bbb_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return _Dst;
    case 3:
switchD_10046bbb_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return _Dst;
    }
switchD_10046bbb_caseD_0:
    return _Dst;
  }
  puVar3 = (undefined4 *)_Dst;
  if (((uint)_Dst & 3) == 0) {
    uVar1 = _Size >> 2;
    uVar2 = _Size & 3;
    if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *_Src;
        _Src = (undefined4 *)((int)_Src + 4);
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return _Dst;
      case 2:
        goto switchD_10046a35_caseD_2;
      case 3:
        goto switchD_10046a35_caseD_3;
      }
      goto switchD_10046a35_caseD_1;
    }
  }
  else {
    switch(_Size) {
    case 0:
      goto switchD_10046a35_caseD_0;
    case 1:
      goto switchD_10046a35_caseD_1;
    case 2:
      goto switchD_10046a35_caseD_2;
    case 3:
      goto switchD_10046a35_caseD_3;
    default:
      uVar1 = (_Size - 4) + ((uint)_Dst & 3);
      switch((uint)_Dst & 3) {
      case 1:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 2) = *(undefined1 *)((int)_Src + 2);
        _Src = (void *)((int)_Src + 3);
        puVar3 = (undefined4 *)((int)_Dst + 3);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10046a35_caseD_2;
          case 3:
            goto switchD_10046a35_caseD_3;
          }
          goto switchD_10046a35_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        _Src = (void *)((int)_Src + 2);
        puVar3 = (undefined4 *)((int)_Dst + 2);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10046a35_caseD_2;
          case 3:
            goto switchD_10046a35_caseD_3;
          }
          goto switchD_10046a35_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        _Src = (void *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)_Dst + 1);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10046a35_caseD_2;
          case 3:
            goto switchD_10046a35_caseD_3;
          }
          goto switchD_10046a35_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = *(undefined4 *)((int)_Src + (uVar1 - 7) * 4);
  case 6:
    puVar3[uVar1 - 6] = *(undefined4 *)((int)_Src + (uVar1 - 6) * 4);
  case 5:
    puVar3[uVar1 - 5] = *(undefined4 *)((int)_Src + (uVar1 - 5) * 4);
  case 4:
    puVar3[uVar1 - 4] = *(undefined4 *)((int)_Src + (uVar1 - 4) * 4);
  case 3:
    puVar3[uVar1 - 3] = *(undefined4 *)((int)_Src + (uVar1 - 3) * 4);
  case 2:
    puVar3[uVar1 - 2] = *(undefined4 *)((int)_Src + (uVar1 - 2) * 4);
  case 1:
    puVar3[uVar1 - 1] = *(undefined4 *)((int)_Src + (uVar1 - 1) * 4);
    _Src = (void *)((int)_Src + uVar1 * 4);
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_10046a35_caseD_1:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    return _Dst;
  case 2:
switchD_10046a35_caseD_2:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    return _Dst;
  case 3:
switchD_10046a35_caseD_3:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)_Src + 2);
    return _Dst;
  }
switchD_10046a35_caseD_0:
  return _Dst;
}



// Library Function - Single Match
//  __write_lk
// 
// Library: Visual Studio 2003 Release

void __cdecl __write_lk(uint param_1,char *param_2,uint param_3)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  BOOL BVar4;
  int *piVar5;
  ulong *puVar6;
  uint uVar7;
  int iVar8;
  DWORD local_424;
  int local_420;
  DWORD local_41c;
  char *local_418;
  int local_414;
  ulong local_410;
  char local_40c [1028];
  int local_8;
  
  local_8 = DAT_10057438;
  local_41c = 0;
  local_420 = 0;
  if (param_3 == 0) goto LAB_10046ef7;
  piVar5 = &DAT_10069600 + ((int)param_1 >> 5);
  iVar8 = (param_1 & 0x1f) * 0x24;
  if ((*(byte *)(*piVar5 + 4 + iVar8) & 0x20) != 0) {
    __lseeki64_lk(param_1,0,0,2);
  }
  if ((*(byte *)((undefined4 *)(*piVar5 + iVar8) + 1) & 0x80) == 0) {
    BVar4 = WriteFile(*(HANDLE *)(*piVar5 + iVar8),param_2,param_3,&local_424,(LPOVERLAPPED)0x0);
    if (BVar4 == 0) {
      local_410 = GetLastError();
    }
    else {
      local_410 = 0;
      local_41c = local_424;
    }
LAB_10046e59:
    if (local_41c != 0) goto LAB_10046ef7;
    if (local_410 != 0) {
      if (local_410 == 5) {
        piVar5 = FUN_10041d35();
        *piVar5 = 9;
        puVar6 = FUN_10041d3e();
        *puVar6 = 5;
      }
      else {
        __dosmaperr(local_410);
      }
      goto LAB_10046ef7;
    }
  }
  else {
    local_418 = param_2;
    local_410 = 0;
    if (param_3 != 0) {
      do {
        uVar7 = (int)local_418 - (int)param_2;
        pcVar3 = local_40c;
        local_414 = 0;
        do {
          if (param_3 <= uVar7) break;
          pcVar1 = local_418 + 1;
          cVar2 = *local_418;
          uVar7 = uVar7 + 1;
          if (cVar2 == '\n') {
            local_420 = local_420 + 1;
            *pcVar3 = '\r';
            pcVar3 = pcVar3 + 1;
            local_414 = local_414 + 1;
          }
          *pcVar3 = cVar2;
          pcVar3 = pcVar3 + 1;
          local_414 = local_414 + 1;
          local_418 = pcVar1;
        } while (local_414 < 0x400);
        BVar4 = WriteFile(*(HANDLE *)(*piVar5 + iVar8),local_40c,(int)pcVar3 - (int)local_40c,
                          &local_424,(LPOVERLAPPED)0x0);
        if (BVar4 == 0) {
          local_410 = GetLastError();
          goto LAB_10046e59;
        }
        local_41c = local_41c + local_424;
        if (((int)local_424 < (int)pcVar3 - (int)local_40c) ||
           (param_3 <= (uint)((int)local_418 - (int)param_2))) goto LAB_10046e59;
      } while( true );
    }
  }
  if (((*(byte *)(*piVar5 + 4 + iVar8) & 0x40) == 0) || (*param_2 != '\x1a')) {
    piVar5 = FUN_10041d35();
    *piVar5 = 0x1c;
    puVar6 = FUN_10041d3e();
    *puVar6 = 0;
  }
LAB_10046ef7:
  FUN_1003fb09(local_8);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __write
// 
// Library: Visual Studio 2003 Release

int __cdecl __write(int _FileHandle,void *_Buf,uint _MaxCharCount)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  int local_20;
  
  if ((uint)_FileHandle < DAT_100695e4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_10041d35();
        *piVar1 = 9;
        puVar2 = FUN_10041d3e();
        *puVar2 = 0;
        local_20 = -1;
      }
      else {
        local_20 = __write_lk(_FileHandle,(char *)_Buf,_MaxCharCount);
      }
      FUN_10046f92();
      return local_20;
    }
  }
  piVar1 = FUN_10041d35();
  *piVar1 = 9;
  puVar2 = FUN_10041d3e();
  *puVar2 = 0;
  return -1;
}



void FUN_10046f92(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __commit
// 
// Library: Visual Studio 2003 Release

int __cdecl __commit(int _FileHandle)

{
  HANDLE hFile;
  BOOL BVar1;
  ulong *puVar2;
  int *piVar3;
  int iVar4;
  DWORD local_20;
  
  if (DAT_100695e4 <= (uint)_FileHandle) {
LAB_1004705e:
    piVar3 = FUN_10041d35();
    *piVar3 = 9;
    return -1;
  }
  iVar4 = (_FileHandle & 0x1fU) * 0x24;
  if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar4) & 1) == 0) goto LAB_1004705e;
  __lock_fhandle(_FileHandle);
  if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar4) & 1) != 0) {
    hFile = (HANDLE)__get_osfhandle(_FileHandle);
    BVar1 = FlushFileBuffers(hFile);
    if (BVar1 == 0) {
      local_20 = GetLastError();
    }
    else {
      local_20 = 0;
    }
    if (local_20 == 0) goto LAB_10047045;
    puVar2 = FUN_10041d3e();
    *puVar2 = local_20;
  }
  piVar3 = FUN_10041d35();
  *piVar3 = 9;
  local_20 = 0xffffffff;
LAB_10047045:
  FUN_10047056();
  return local_20;
}



void FUN_10047056(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __stbuf
// 
// Library: Visual Studio 2003 Release

int __cdecl __stbuf(FILE *_File)

{
  int *piVar1;
  char *pcVar2;
  int iVar3;
  void *pvVar4;
  
  iVar3 = __isatty(_File->_file);
  if (iVar3 == 0) {
    return 0;
  }
  if (_File == (FILE *)&DAT_10057480) {
    iVar3 = 0;
  }
  else {
    if (_File != (FILE *)&DAT_100574a0) {
      return 0;
    }
    iVar3 = 1;
  }
  _DAT_10068e3c = _DAT_10068e3c + 1;
  if ((_File->_flag & 0x10c) != 0) {
    return 0;
  }
  piVar1 = &DAT_10069260 + iVar3;
  if (*piVar1 == 0) {
    pvVar4 = _malloc(0x1000);
    *piVar1 = (int)pvVar4;
    if (pvVar4 == (void *)0x0) {
      _File->_base = (char *)&_File->_charbuf;
      _File->_ptr = (char *)&_File->_charbuf;
      _File->_bufsiz = 2;
      _File->_cnt = 2;
      goto LAB_10047184;
    }
  }
  pcVar2 = (char *)*piVar1;
  _File->_base = pcVar2;
  _File->_ptr = pcVar2;
  _File->_bufsiz = 0x1000;
  _File->_cnt = 0x1000;
LAB_10047184:
  *(ushort *)&_File->_flag = (ushort)_File->_flag | 0x1102;
  return 1;
}



// Library Function - Single Match
//  __ftbuf
// 
// Library: Visual Studio 2003 Release

void __cdecl __ftbuf(int _Flag,FILE *_File)

{
  byte *pbVar1;
  
  if ((_Flag != 0) && ((_File->_flag & 0x1000) != 0)) {
    __flush(_File);
    pbVar1 = (byte *)((int)&_File->_flag + 1);
    *pbVar1 = *pbVar1 & 0xee;
    _File->_bufsiz = 0;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
  }
  return;
}



// Library Function - Single Match
//  __inc
// 
// Library: Visual Studio 2003 Release

uint __fastcall __inc(undefined4 param_1,FILE *param_2)

{
  int *piVar1;
  byte bVar2;
  uint uVar3;
  
  piVar1 = &param_2->_cnt;
  *piVar1 = *piVar1 + -1;
  if (-1 < *piVar1) {
    bVar2 = *param_2->_ptr;
    param_2->_ptr = param_2->_ptr + 1;
    return (uint)bVar2;
  }
  uVar3 = __filbuf(param_2);
  return uVar3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Removing unreachable block (ram,0x10047f13)
// Library Function - Single Match
//  __input
// 
// Library: Visual Studio 2003 Release

void __cdecl __input(FILE *param_1,byte *param_2,undefined4 *param_3)

{
  uint uVar1;
  byte bVar2;
  undefined1 *puVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  uint extraout_ECX;
  FILE *extraout_ECX_00;
  FILE *extraout_ECX_01;
  FILE *pFVar9;
  FILE *extraout_ECX_02;
  FILE *extraout_ECX_03;
  undefined4 extraout_ECX_04;
  uint extraout_ECX_05;
  byte bVar10;
  byte bVar11;
  wchar_t *pwVar12;
  byte *pbVar13;
  char *pcVar14;
  char *pcVar15;
  wchar_t *pwVar16;
  byte *pbVar17;
  bool bVar18;
  undefined4 *local_1e0;
  uint local_1d8;
  wchar_t local_1d0 [2];
  int local_1cc;
  byte local_1c8;
  undefined1 local_1c7;
  uint local_1c4;
  undefined1 *local_1c0;
  int local_1bc;
  FILE *local_1b8;
  wchar_t *local_1b4;
  undefined8 local_1b0;
  byte local_1a5;
  int local_1a4;
  int local_1a0;
  byte local_19c;
  char local_19b;
  char local_19a;
  char local_199;
  uint local_198;
  char local_192;
  char local_191;
  int local_190;
  char local_189;
  int local_188;
  char local_181;
  char local_180;
  char local_17f [351];
  int local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10055108;
  uStack_c = 0x100471e4;
  local_20 = DAT_10057438;
  local_1c0 = (undefined1 *)0x0;
  local_1b4 = (wchar_t *)0x0;
  local_198 = 0;
  local_199 = '\0';
  local_188 = 0;
  local_1bc = 0;
LAB_10047218:
  while (*param_2 != 0) {
    uVar4 = (uint)*param_2;
    iVar5 = _isspace(uVar4);
    if (iVar5 == 0) {
      if (*param_2 != 0x25) {
        local_188 = local_188 + 1;
        uVar4 = __inc(uVar4,param_1);
        local_198 = uVar4;
        if (*param_2 != uVar4) goto LAB_10047ed1;
        pbVar17 = param_2 + 1;
        if ((PTR_DAT_10057da8[(uVar4 & 0xff) * 2 + 1] & 0x80) != 0) {
          local_188 = local_188 + 1;
          uVar6 = __inc(PTR_DAT_10057da8,param_1);
          if (param_2[1] != uVar6) {
            if (uVar6 != 0xffffffff) {
              __ungetc_lk(uVar6,param_1);
            }
            goto LAB_10047ed1;
          }
          local_188 = local_188 + -1;
          pbVar17 = param_2 + 2;
        }
        goto LAB_10047eeb;
      }
      iVar5 = 0;
      local_1a4 = 0;
      local_19c = 0;
      local_1a0 = 0;
      local_1b8 = (FILE *)0x0;
      local_190 = 0;
      local_1a5 = 0;
      local_19b = '\0';
      local_192 = '\0';
      local_181 = '\0';
      local_19a = '\0';
      local_189 = '\0';
      local_191 = '\x01';
      local_1cc = 0;
      pbVar17 = param_2;
      do {
        pbVar13 = pbVar17 + 1;
        uVar6 = (uint)*pbVar13;
        uVar4 = uVar6;
        iVar7 = _isdigit(uVar6);
        param_2 = pbVar13;
        if (iVar7 == 0) {
          if (uVar6 < 0x4f) {
            if (uVar6 != 0x4e) {
              if (uVar6 == 0x2a) {
                local_192 = local_192 + '\x01';
              }
              else if (uVar6 != 0x46) {
                if (uVar6 == 0x49) {
                  bVar11 = pbVar17[2];
                  uVar4 = CONCAT31((int3)(uVar4 >> 8),bVar11);
                  if ((bVar11 == 0x36) && (pbVar17[3] == 0x34)) {
                    local_1cc = local_1cc + 1;
                    local_1b0 = 0;
                    param_2 = pbVar17 + 3;
                  }
                  else if (((bVar11 != 0x33) || (param_2 = pbVar17 + 3, *param_2 != 0x32)) &&
                          ((((param_2 = pbVar13, bVar11 != 100 && (bVar11 != 0x69)) &&
                            (bVar11 != 0x6f)) && ((bVar11 != 0x78 && (bVar11 != 0x58))))))
                  goto LAB_1004739f;
                }
                else if (uVar6 == 0x4c) {
                  local_191 = local_191 + '\x01';
                }
                else {
LAB_1004739f:
                  local_181 = local_181 + '\x01';
                  param_2 = pbVar13;
                }
              }
            }
          }
          else if (uVar6 == 0x68) {
            local_191 = local_191 + -1;
            local_189 = local_189 + -1;
          }
          else {
            if (uVar6 == 0x6c) {
              local_191 = local_191 + '\x01';
            }
            else if (uVar6 != 0x77) goto LAB_1004739f;
            local_189 = local_189 + '\x01';
          }
        }
        else {
          local_1b8 = (FILE *)((int)&local_1b8->_ptr + 1);
          iVar5 = (uVar6 - 0x30) + iVar5 * 10;
        }
        pbVar17 = param_2;
      } while (local_181 == '\0');
      if (local_192 == '\0') {
        local_1e0 = param_3;
        local_1b4 = (wchar_t *)*param_3;
        param_3 = param_3 + 1;
      }
      pwVar12 = local_1b4;
      local_181 = '\0';
      if ((local_189 == '\0') && ((*param_2 == 0x53 || (local_189 = -1, *param_2 == 0x43)))) {
        local_189 = '\x01';
      }
      uVar6 = *param_2 | 0x20;
      local_1c4 = uVar6;
      uVar8 = local_198;
      local_190 = iVar5;
      if (uVar6 != 0x6e) {
        if ((uVar6 == 99) || (uVar6 == 0x7b)) {
          local_188 = local_188 + 1;
          uVar8 = __inc(uVar4,param_1);
        }
        else {
          do {
            local_188 = local_188 + 1;
            uVar8 = __inc(uVar4,param_1);
            uVar4 = uVar8;
            iVar5 = _isspace(uVar8);
          } while (iVar5 != 0);
        }
      }
      local_198 = uVar8;
      pFVar9 = local_1b8;
      uVar4 = local_198;
      if ((local_1b8 == (FILE *)0x0) || (local_190 != 0)) {
        if (uVar6 < 0x70) {
          if (uVar6 == 0x6f) {
LAB_10047b69:
            if (local_198 == 0x2d) {
              local_19b = '\x01';
            }
            else if (local_198 != 0x2b) goto LAB_10047bac;
            local_190 = local_190 + -1;
            if ((local_190 == 0) && (local_1b8 != (FILE *)0x0)) {
              local_181 = '\x01';
            }
            else {
              local_188 = local_188 + 1;
              local_198 = __inc(local_1b8,param_1);
            }
            goto LAB_10047bac;
          }
          if (uVar6 == 99) {
            if (local_1b8 == (FILE *)0x0) {
              local_1b8 = (FILE *)0x1;
              local_190 = local_190 + 1;
            }
LAB_1004772f:
            if ('\0' < local_189) {
              local_19a = '\x01';
            }
            goto LAB_100478f9;
          }
          if (uVar6 == 100) goto LAB_10047b69;
          if (uVar6 < 0x65) {
LAB_1004776e:
            if (*param_2 != local_198) goto LAB_10047ed1;
            local_199 = local_199 + -1;
            if (local_192 == '\0') {
              param_3 = local_1e0;
            }
            goto LAB_10047e69;
          }
          if (0x67 < uVar6) {
            if (uVar6 == 0x69) {
              uVar6 = 100;
              goto LAB_100474f6;
            }
            if (uVar6 != 0x6e) goto LAB_1004776e;
            iVar5 = local_188;
            if (local_192 != '\0') goto LAB_10047e69;
            goto LAB_10047e3d;
          }
          pcVar14 = &local_180;
          if (local_198 == 0x2d) {
            local_180 = '-';
            pcVar14 = local_17f;
LAB_10047535:
            local_190 = local_190 + -1;
            local_188 = local_188 + 1;
            local_198 = __inc(local_1b8,param_1);
          }
          else if (local_198 == 0x2b) goto LAB_10047535;
          if ((local_1b8 == (FILE *)0x0) || (0x15d < local_190)) {
            local_190 = 0x15d;
          }
          while( true ) {
            uVar4 = local_198;
            uVar6 = local_198;
            iVar5 = _isdigit(local_198);
            if ((iVar5 == 0) ||
               (iVar5 = local_190 + -1, bVar18 = local_190 == 0, local_190 = iVar5, bVar18)) break;
            local_1a0 = local_1a0 + 1;
            *pcVar14 = (char)uVar4;
            pcVar14 = pcVar14 + 1;
            local_188 = local_188 + 1;
            local_198 = __inc(uVar6,param_1);
          }
          if ((DAT_10057e68 == (char)uVar4) &&
             (iVar5 = local_190 + -1, bVar18 = local_190 != 0, local_190 = iVar5, bVar18)) {
            local_188 = local_188 + 1;
            uVar4 = __inc(uVar6,param_1);
            *pcVar14 = DAT_10057e68;
            while( true ) {
              pcVar14 = pcVar14 + 1;
              uVar6 = uVar4;
              local_198 = uVar4;
              iVar5 = _isdigit(uVar4);
              if ((iVar5 == 0) ||
                 (iVar5 = local_190 + -1, bVar18 = local_190 == 0, local_190 = iVar5, bVar18))
              break;
              local_1a0 = local_1a0 + 1;
              *pcVar14 = (char)uVar4;
              local_188 = local_188 + 1;
              uVar4 = __inc(uVar6,param_1);
            }
          }
          pcVar15 = pcVar14;
          if ((local_1a0 != 0) &&
             (((uVar4 == 0x65 || (uVar4 == 0x45)) &&
              (iVar5 = local_190 + -1, bVar18 = local_190 != 0, local_190 = iVar5, bVar18)))) {
            *pcVar14 = 'e';
            pcVar15 = pcVar14 + 1;
            local_188 = local_188 + 1;
            local_198 = __inc(uVar6,param_1);
            if (local_198 == 0x2d) {
              *pcVar15 = '-';
              pcVar15 = pcVar14 + 2;
LAB_1004766f:
              bVar18 = local_190 != 0;
              uVar6 = extraout_ECX;
              local_190 = local_190 + -1;
              if (bVar18) goto LAB_100476a0;
              local_190 = 0;
            }
            else if (local_198 == 0x2b) goto LAB_1004766f;
            while ((uVar4 = local_198, uVar6 = local_198, iVar5 = _isdigit(local_198), iVar5 != 0 &&
                   (iVar5 = local_190 + -1, bVar18 = local_190 != 0, local_190 = iVar5, bVar18))) {
              local_1a0 = local_1a0 + 1;
              *pcVar15 = (char)uVar4;
              pcVar15 = pcVar15 + 1;
LAB_100476a0:
              local_188 = local_188 + 1;
              local_198 = __inc(uVar6,param_1);
            }
          }
          local_188 = local_188 + -1;
          if (uVar4 != 0xffffffff) {
            __ungetc_lk(uVar4,param_1);
          }
          if (local_1a0 != 0) {
            if (local_192 == '\0') {
              local_1bc = local_1bc + 1;
              *pcVar15 = '\0';
              (*(code *)PTR___fptrap_10057858)(local_191 + -1,local_1b4,&local_180);
            }
            goto LAB_10047e69;
          }
        }
        else {
          if (uVar6 == 0x70) {
            local_191 = '\x01';
            goto LAB_10047b69;
          }
          if (uVar6 == 0x73) goto LAB_1004772f;
          if (uVar6 == 0x75) goto LAB_10047b69;
          if (uVar6 != 0x78) {
            if (uVar6 == 0x7b) {
              if ('\0' < local_189) {
                local_19a = '\x01';
              }
              pbVar13 = param_2 + 1;
              pbVar17 = pbVar13;
              if (*pbVar13 == 0x5e) {
                pbVar17 = param_2 + 2;
                local_1a5 = 0xff;
              }
              if (local_1c0 == (undefined1 *)0x0) {
                local_1c = &stack0xfffffe14;
                local_1c0 = &stack0xfffffe14;
                local_8 = (undefined *)0xffffffff;
              }
              puVar3 = local_1c0;
              _memset(local_1c0,0,0x20);
              pFVar9 = extraout_ECX_00;
              bVar11 = local_19c;
              if ((local_1c4 == 0x7b) && (*pbVar17 == 0x5d)) {
                puVar3[0xb] = 0x20;
                pbVar17 = pbVar17 + 1;
                bVar11 = 0x5d;
              }
LAB_100478d3:
              do {
                bVar10 = *pbVar17;
                if (bVar10 == 0x5d) goto code_r0x100478e1;
                if ((bVar10 == 0x2d) && (bVar11 != 0)) {
                  bVar2 = pbVar17[1];
                  pFVar9 = (FILE *)CONCAT31((int3)((uint)pFVar9 >> 8),bVar2);
                  if (bVar2 != 0x5d) {
                    bVar10 = bVar2;
                    if (bVar11 < bVar2) {
                      bVar10 = bVar11;
                      bVar11 = bVar2;
                    }
                    if (bVar10 <= bVar11) {
                      uVar4 = (uint)bVar10;
                      local_1d8 = (uint)(byte)((bVar11 - bVar10) + 1);
                      do {
                        pFVar9 = (FILE *)(uVar4 & 7);
                        puVar3[uVar4 >> 3] = puVar3[uVar4 >> 3] | '\x01' << (sbyte)pFVar9;
                        uVar4 = uVar4 + 1;
                        local_1d8 = local_1d8 - 1;
                      } while (local_1d8 != 0);
                    }
                    pbVar17 = pbVar17 + 2;
                    bVar11 = 0;
                    goto LAB_100478d3;
                  }
                }
                local_19c = bVar10;
                pFVar9 = (FILE *)(bVar10 & 7);
                puVar3[bVar10 >> 3] = puVar3[bVar10 >> 3] | '\x01' << (sbyte)pFVar9;
                pbVar17 = pbVar17 + 1;
                bVar11 = local_19c;
              } while( true );
            }
            goto LAB_1004776e;
          }
LAB_100474f6:
          if (local_198 == 0x2d) {
            local_19b = '\x01';
LAB_10047a1c:
            local_190 = local_190 + -1;
            if ((local_190 == 0) && (local_1b8 != (FILE *)0x0)) {
              local_181 = '\x01';
            }
            else {
              local_188 = local_188 + 1;
              local_198 = __inc(local_1b8,param_1);
              pFVar9 = extraout_ECX_03;
            }
          }
          else if (local_198 == 0x2b) goto LAB_10047a1c;
          if (local_198 == 0x30) {
            local_188 = local_188 + 1;
            local_198 = __inc(pFVar9,param_1);
            if (((char)local_198 == 'x') || ((char)local_198 == 'X')) {
              local_188 = local_188 + 1;
              local_198 = __inc(extraout_ECX_04,param_1);
              if ((local_1b8 != (FILE *)0x0) && (local_190 = local_190 + -2, local_190 < 1)) {
                local_181 = local_181 + '\x01';
              }
              uVar6 = 0x78;
            }
            else {
              local_1a0 = 1;
              if (uVar6 == 0x78) {
                local_188 = local_188 + -1;
                if (local_198 != 0xffffffff) {
                  __ungetc_lk(local_198,param_1);
                }
                local_198 = 0x30;
              }
              else {
                if ((local_1b8 != (FILE *)0x0) && (local_190 = local_190 + -1, local_190 == 0)) {
                  local_181 = local_181 + '\x01';
                }
                uVar6 = 0x6f;
              }
            }
          }
LAB_10047bac:
          uVar4 = local_198;
          if (local_1cc == 0) {
            while (local_181 == '\0') {
              uVar8 = uVar4;
              if ((uVar6 == 0x78) || (uVar6 == 0x70)) {
                iVar5 = _isxdigit(uVar4);
                if (iVar5 != 0) {
                  local_1a4 = local_1a4 << 4;
                  uVar8 = uVar4;
                  iVar5 = _isdigit(uVar4);
                  if (iVar5 == 0) {
                    uVar4 = (uVar4 & 0xffffffdf) - 7;
                  }
                  goto LAB_10047d89;
                }
LAB_10047d83:
                local_181 = local_181 + '\x01';
              }
              else {
                iVar5 = _isdigit(uVar4);
                if (iVar5 == 0) goto LAB_10047d83;
                if (uVar6 == 0x6f) {
                  if (0x37 < (int)uVar4) goto LAB_10047d83;
                  local_1a4 = local_1a4 << 3;
                }
                else {
                  local_1a4 = local_1a4 * 10;
                }
              }
LAB_10047d89:
              if (local_181 == '\0') {
                local_1a0 = local_1a0 + 1;
                local_1a4 = local_1a4 + -0x30 + uVar4;
                if ((local_1b8 == (FILE *)0x0) || (local_190 = local_190 + -1, local_190 != 0)) {
                  local_188 = local_188 + 1;
                  uVar4 = __inc(uVar8,param_1);
                }
                else {
                  local_181 = '\x01';
                }
              }
              else {
                local_188 = local_188 + -1;
                if (uVar4 != 0xffffffff) {
                  __ungetc_lk(uVar4,param_1);
                }
              }
            }
            local_198 = uVar4;
            if (local_19b != '\0') {
              local_1a4 = -local_1a4;
            }
          }
          else {
            while (local_181 == '\0') {
              uVar8 = uVar4;
              if ((uVar6 == 0x78) || (uVar6 == 0x70)) {
                iVar5 = _isxdigit(uVar4);
                if (iVar5 != 0) {
                  local_1b0 = CONCAT44(local_1b0._4_4_ << 4 | (uint)local_1b0 >> 0x1c,
                                       (uint)local_1b0 << 4);
                  uVar8 = uVar4;
                  iVar5 = _isdigit(uVar4);
                  if (iVar5 == 0) {
                    uVar4 = (uVar4 & 0xffffffdf) - 7;
                  }
                  goto LAB_10047c74;
                }
LAB_10047c6e:
                local_181 = local_181 + '\x01';
              }
              else {
                iVar5 = _isdigit(uVar4);
                if (iVar5 == 0) goto LAB_10047c6e;
                if (uVar6 == 0x6f) {
                  if (0x37 < (int)uVar4) goto LAB_10047c6e;
                  uVar8 = local_1b0._4_4_ << 3 | (uint)local_1b0 >> 0x1d;
                  local_1b0 = CONCAT44(uVar8,(uint)local_1b0 << 3);
                }
                else {
                  local_1b0 = __allmul((uint)local_1b0,local_1b0._4_4_,10,0);
                  uVar8 = extraout_ECX_05;
                }
              }
LAB_10047c74:
              if (local_181 == '\0') {
                local_1a0 = local_1a0 + 1;
                uVar1 = uVar4 - 0x30;
                local_1b0 = CONCAT44(local_1b0._4_4_ + ((int)uVar1 >> 0x1f) +
                                     (uint)CARRY4((uint)local_1b0,uVar1),(uint)local_1b0 + uVar1);
                if ((local_1b8 == (FILE *)0x0) || (local_190 = local_190 + -1, local_190 != 0)) {
                  local_188 = local_188 + 1;
                  uVar4 = __inc(uVar8,param_1);
                }
                else {
                  local_181 = '\x01';
                }
              }
              else {
                local_188 = local_188 + -1;
                if (uVar4 != 0xffffffff) {
                  __ungetc_lk(uVar4,param_1);
                }
              }
            }
            local_198 = uVar4;
            if (local_19b != '\0') {
              local_1b0._4_4_ = (int)((ulonglong)local_1b0 >> 0x20);
              local_1b0 = CONCAT44(-(local_1b0._4_4_ + (uint)((uint)local_1b0 != 0)),
                                   -(uint)local_1b0);
            }
          }
          if (uVar6 == 0x46) {
            local_1a0 = 0;
          }
          if (local_1a0 != 0) {
            if (local_192 == '\0') {
              local_1bc = local_1bc + 1;
              iVar5 = local_1a4;
              pwVar12 = local_1b4;
LAB_10047e3d:
              if (local_1cc == 0) {
                if (local_191 == '\0') {
                  *pwVar12 = (wchar_t)iVar5;
                }
                else {
                  *(int *)pwVar12 = iVar5;
                }
              }
              else {
                *(uint *)pwVar12 = (uint)local_1b0;
                *(int *)(pwVar12 + 2) = local_1b0._4_4_;
              }
            }
            goto LAB_10047e69;
          }
        }
      }
      else {
LAB_10047ed1:
        if (uVar4 != 0xffffffff) {
          __ungetc_lk(local_198,param_1);
        }
      }
      break;
    }
    local_188 = local_188 + -1;
    do {
      local_188 = local_188 + 1;
      uVar6 = __inc(uVar4,param_1);
      uVar4 = uVar6;
      iVar5 = _isspace(uVar6);
    } while (iVar5 != 0);
    if (uVar6 != 0xffffffff) {
      __ungetc_lk(uVar6,param_1);
    }
    do {
      param_2 = param_2 + 1;
      iVar5 = _isspace((uint)*param_2);
    } while (iVar5 != 0);
  }
  goto LAB_10047f0a;
code_r0x100478e1:
  pwVar12 = local_1b4;
  uVar6 = local_1c4;
  param_2 = pbVar13;
  if (local_1c4 == 0x7b) {
    param_2 = pbVar17;
  }
LAB_100478f9:
  local_188 = local_188 + -1;
  pwVar16 = pwVar12;
  if (local_198 != 0xffffffff) {
    pFVar9 = param_1;
    __ungetc_lk(local_198,param_1);
  }
  while( true ) {
    if ((local_1b8 != (FILE *)0x0) &&
       (iVar5 = local_190 + -1, bVar18 = local_190 == 0, local_190 = iVar5, bVar18))
    goto LAB_10047b1a;
    local_188 = local_188 + 1;
    local_198 = __inc(pFVar9,param_1);
    if ((local_198 == 0xffffffff) ||
       ((bVar11 = (byte)local_198, pFVar9 = extraout_ECX_01, uVar6 != 99 &&
        (((uVar6 != 0x73 ||
          (((8 < (int)local_198 && ((int)local_198 < 0xe)) || (local_198 == 0x20)))) &&
         ((uVar6 != 0x7b ||
          (pFVar9 = (FILE *)(int)(char)(local_1c0[(int)local_198 >> 3] ^ local_1a5),
          uVar6 = local_1c4, ((uint)pFVar9 & 1 << (bVar11 & 7)) == 0)))))))) break;
    if (local_192 == '\0') {
      if (local_19a == '\0') {
        *(byte *)pwVar12 = bVar11;
        pwVar12 = (wchar_t *)((int)pwVar12 + 1);
        local_1b4 = pwVar12;
      }
      else {
        local_1c8 = bVar11;
        if ((PTR_DAT_10057da8[(local_198 & 0xff) * 2 + 1] & 0x80) != 0) {
          local_188 = local_188 + 1;
          uVar4 = __inc(PTR_DAT_10057da8,param_1);
          local_1c7 = (undefined1)uVar4;
        }
        _mbtowc(local_1d0,(char *)&local_1c8,DAT_10057e64);
        *pwVar12 = local_1d0[0];
        pwVar12 = pwVar12 + 1;
        pFVar9 = extraout_ECX_02;
        local_1b4 = pwVar12;
      }
    }
    else {
      pwVar16 = (wchar_t *)((int)pwVar16 + 1);
    }
  }
  local_188 = local_188 + -1;
  if (local_198 != 0xffffffff) {
    __ungetc_lk(local_198,param_1);
  }
LAB_10047b1a:
  if (pwVar16 == pwVar12) {
LAB_10047f0a:
    FUN_1003fb09(local_20);
    return;
  }
  if ((local_192 == '\0') && (local_1bc = local_1bc + 1, local_1c4 != 99)) {
    if (local_19a == '\0') {
      *(byte *)local_1b4 = 0;
    }
    else {
      *local_1b4 = L'\0';
    }
  }
LAB_10047e69:
  local_199 = local_199 + '\x01';
  pbVar17 = param_2 + 1;
LAB_10047eeb:
  param_2 = pbVar17;
  if ((local_198 == 0xffffffff) && ((*param_2 != 0x25 || (param_2[1] != 0x6e)))) goto LAB_10047f0a;
  goto LAB_10047218;
}



// Library Function - Single Match
//  _strlen
// 
// Library: Visual Studio

size_t __cdecl _strlen(char *_Str)

{
  uint uVar1;
  uint *puVar2;
  uint *puVar3;
  
  uVar1 = (uint)_Str & 3;
  puVar2 = (uint *)_Str;
  while (uVar1 != 0) {
    uVar1 = *puVar2;
    puVar2 = (uint *)((int)puVar2 + 1);
    if ((char)uVar1 == '\0') goto LAB_10047fc3;
    uVar1 = (uint)puVar2 & 3;
  }
  do {
    do {
      puVar3 = puVar2;
      puVar2 = puVar3 + 1;
    } while (((*puVar3 ^ 0xffffffff ^ *puVar3 + 0x7efefeff) & 0x81010100) == 0);
    uVar1 = *puVar3;
    if ((char)uVar1 == '\0') {
      return (int)puVar3 - (int)_Str;
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (size_t)((int)puVar3 + (1 - (int)_Str));
    }
    if ((uVar1 & 0xff0000) == 0) {
      return (size_t)((int)puVar3 + (2 - (int)_Str));
    }
  } while ((uVar1 & 0xff000000) != 0);
LAB_10047fc3:
  return (size_t)((int)puVar2 + (-1 - (int)_Str));
}



// Library Function - Single Match
//  __read_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __read_lk(uint param_1,char *param_2,char *param_3)

{
  byte *pbVar1;
  char *pcVar2;
  byte bVar3;
  char cVar4;
  BOOL BVar5;
  DWORD DVar6;
  int *piVar7;
  ulong *puVar8;
  char *pcVar9;
  int iVar10;
  DWORD local_10;
  char *local_c;
  char local_5;
  
  local_c = (char *)0x0;
  if (param_3 != (char *)0x0) {
    piVar7 = &DAT_10069600 + ((int)param_1 >> 5);
    iVar10 = (param_1 & 0x1f) * 0x24;
    bVar3 = *(byte *)(*piVar7 + iVar10 + 4);
    if ((bVar3 & 2) == 0) {
      pcVar9 = param_2;
      if (((bVar3 & 0x48) != 0) && (*(char *)(*piVar7 + iVar10 + 5) != '\n')) {
        param_3 = param_3 + -1;
        *param_2 = *(char *)(*piVar7 + 5 + iVar10);
        pcVar9 = param_2 + 1;
        local_c = (char *)0x1;
        *(undefined1 *)(*piVar7 + 5 + iVar10) = 10;
      }
      BVar5 = ReadFile(*(HANDLE *)(*piVar7 + iVar10),pcVar9,(DWORD)param_3,&local_10,
                       (LPOVERLAPPED)0x0);
      if (BVar5 == 0) {
        DVar6 = GetLastError();
        if (DVar6 == 5) {
          piVar7 = FUN_10041d35();
          *piVar7 = 9;
          puVar8 = FUN_10041d3e();
          *puVar8 = 5;
        }
        else {
          if (DVar6 == 0x6d) {
            return 0;
          }
          __dosmaperr(DVar6);
        }
        return -1;
      }
      if ((*(byte *)(*piVar7 + 4 + iVar10) & 0x80) == 0) {
        return (int)local_c + local_10;
      }
      if ((local_10 == 0) || (*param_2 != '\n')) {
        pbVar1 = (byte *)(*piVar7 + 4 + iVar10);
        *pbVar1 = *pbVar1 & 0xfb;
      }
      else {
        pbVar1 = (byte *)(*piVar7 + 4 + iVar10);
        *pbVar1 = *pbVar1 | 4;
      }
      local_c = param_2 + (int)local_c + local_10;
      param_3 = param_2;
      pcVar9 = param_2;
      if (param_2 < local_c) {
        do {
          cVar4 = *param_3;
          if (cVar4 == '\x1a') {
            if ((*(byte *)(*piVar7 + 4 + iVar10) & 0x40) == 0) {
              pbVar1 = (byte *)(*piVar7 + 4 + iVar10);
              *pbVar1 = *pbVar1 | 2;
            }
            break;
          }
          if (cVar4 == '\r') {
            if (param_3 < local_c + -1) {
              if (param_3[1] == '\n') {
                pcVar2 = param_3 + 2;
                goto LAB_10048178;
              }
LAB_10048192:
              param_3 = param_3 + 1;
              *pcVar9 = '\r';
            }
            else {
              pcVar2 = param_3 + 1;
              BVar5 = ReadFile(*(HANDLE *)(*piVar7 + iVar10),&local_5,1,&local_10,(LPOVERLAPPED)0x0)
              ;
              if (((BVar5 == 0) && (DVar6 = GetLastError(), DVar6 != 0)) || (local_10 == 0))
              goto LAB_10048192;
              if ((*(byte *)(*piVar7 + 4 + iVar10) & 0x48) == 0) {
                if ((pcVar9 == param_2) && (local_5 == '\n')) goto LAB_10048178;
                __lseek_lk(param_1,-1,1);
                if (local_5 == '\n') goto LAB_10048196;
                goto LAB_10048192;
              }
              if (local_5 == '\n') {
LAB_10048178:
                param_3 = pcVar2;
                *pcVar9 = '\n';
              }
              else {
                *pcVar9 = '\r';
                *(char *)(*piVar7 + 5 + iVar10) = local_5;
                param_3 = pcVar2;
              }
            }
            pcVar9 = pcVar9 + 1;
            pcVar2 = param_3;
          }
          else {
            *pcVar9 = cVar4;
            pcVar9 = pcVar9 + 1;
            pcVar2 = param_3 + 1;
          }
LAB_10048196:
          param_3 = pcVar2;
        } while (param_3 < local_c);
      }
      return (int)pcVar9 - (int)param_2;
    }
  }
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __read
// 
// Library: Visual Studio 2003 Release

int __cdecl __read(int _FileHandle,void *_DstBuf,uint _MaxCharCount)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  int local_20;
  
  if ((uint)_FileHandle < DAT_100695e4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_10041d35();
        *piVar1 = 9;
        puVar2 = FUN_10041d3e();
        *puVar2 = 0;
        local_20 = -1;
      }
      else {
        local_20 = __read_lk(_FileHandle,(char *)_DstBuf,(char *)_MaxCharCount);
      }
      FUN_1004824d();
      return local_20;
    }
  }
  piVar1 = FUN_10041d35();
  *piVar1 = 9;
  puVar2 = FUN_10041d3e();
  *puVar2 = 0;
  return -1;
}



void FUN_1004824d(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// Library Function - Single Match
//  __fltin2
// 
// Library: Visual Studio 2003 Release

FLT __cdecl __fltin2(FLT _Flt,char *_Str,_locale_t _Locale)

{
  uint uVar1;
  INTRNCVT_STATUS IVar2;
  FLT p_Var3;
  uint uVar4;
  char *local_20;
  _CRT_DOUBLE local_1c;
  _LDBL12 local_14;
  int local_8;
  
  local_8 = DAT_10057438;
  uVar4 = 0;
  uVar1 = ___strgtold12(&local_14,&local_20,_Str,0,0,0,0);
  if ((uVar1 & 4) == 0) {
    IVar2 = __ld12tod(&local_14,&local_1c);
    if (((uVar1 & 2) != 0) || (IVar2 == INTRNCVT_OVERFLOW)) {
      uVar4 = 0x80;
    }
    if (((uVar1 & 1) != 0) || (IVar2 == INTRNCVT_UNDERFLOW)) {
      uVar4 = uVar4 | 0x100;
    }
  }
  else {
    uVar4 = 0x200;
    local_1c.x._0_4_ = 0;
    local_1c.x._4_4_ = 0;
  }
  _Flt->flags = uVar4;
  _Flt->nbytes = (int)local_20 - (int)_Str;
  *(undefined4 *)&_Flt->dval = local_1c.x._0_4_;
  *(undefined4 *)((int)&_Flt->dval + 4) = local_1c.x._4_4_;
  p_Var3 = (FLT)FUN_1003fb09(local_8);
  return p_Var3;
}



uint * __cdecl FUN_10048310(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  
  uVar3 = (uint)param_2 & 3;
  puVar4 = param_1;
  while (uVar3 != 0) {
    bVar1 = (byte)*param_2;
    uVar3 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_10048400;
    *(byte *)puVar4 = bVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    uVar3 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar3 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar3 == '\0') {
LAB_10048400:
        *(byte *)puVar4 = (byte)uVar3;
        return param_1;
      }
      if ((char)(uVar3 >> 8) == '\0') {
        *(short *)puVar4 = (short)uVar3;
        return param_1;
      }
      if ((uVar3 & 0xff0000) == 0) {
        *(short *)puVar4 = (short)uVar3;
        *(byte *)((int)puVar4 + 2) = 0;
        return param_1;
      }
      if ((uVar3 & 0xff000000) == 0) {
        *puVar4 = uVar3;
        return param_1;
      }
    }
    *puVar4 = uVar3;
    puVar4 = puVar4 + 1;
  } while( true );
}



uint * __cdecl FUN_10048320(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar4 = (uint)param_1 & 3;
  puVar3 = param_1;
  while (uVar4 != 0) {
    uVar4 = *puVar3;
    puVar3 = (uint *)((int)puVar3 + 1);
    if ((byte)uVar4 == 0) goto LAB_10048373;
    uVar4 = (uint)puVar3 & 3;
  }
  do {
    do {
      puVar5 = puVar3;
      puVar3 = puVar5 + 1;
    } while (((*puVar5 ^ 0xffffffff ^ *puVar5 + 0x7efefeff) & 0x81010100) == 0);
    uVar4 = *puVar5;
    if ((char)uVar4 == '\0') goto LAB_10048385;
    if ((char)(uVar4 >> 8) == '\0') {
      puVar5 = (uint *)((int)puVar5 + 1);
      goto LAB_10048385;
    }
    if ((uVar4 & 0xff0000) == 0) {
      puVar5 = (uint *)((int)puVar5 + 2);
      goto LAB_10048385;
    }
  } while ((uVar4 & 0xff000000) != 0);
LAB_10048373:
  puVar5 = (uint *)((int)puVar3 + -1);
LAB_10048385:
  uVar4 = (uint)param_2 & 3;
  while (uVar4 != 0) {
    bVar1 = (byte)*param_2;
    uVar4 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_10048400;
    *(byte *)puVar5 = bVar1;
    puVar5 = (uint *)((int)puVar5 + 1);
    uVar4 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar4 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar4 == '\0') {
LAB_10048400:
        *(byte *)puVar5 = (byte)uVar4;
        return param_1;
      }
      if ((char)(uVar4 >> 8) == '\0') {
        *(short *)puVar5 = (short)uVar4;
        return param_1;
      }
      if ((uVar4 & 0xff0000) == 0) {
        *(short *)puVar5 = (short)uVar4;
        *(byte *)((int)puVar5 + 2) = 0;
        return param_1;
      }
      if ((uVar4 & 0xff000000) == 0) {
        *puVar5 = uVar4;
        return param_1;
      }
    }
    *puVar5 = uVar4;
    puVar5 = puVar5 + 1;
  } while( true );
}



// Library Function - Single Match
//  __lseek_lk
// 
// Library: Visual Studio 2003 Release

DWORD __cdecl __lseek_lk(uint param_1,LONG param_2,DWORD param_3)

{
  byte *pbVar1;
  HANDLE hFile;
  int *piVar2;
  DWORD DVar3;
  ulong uVar4;
  
  hFile = (HANDLE)__get_osfhandle(param_1);
  if (hFile == (HANDLE)0xffffffff) {
    piVar2 = FUN_10041d35();
    *piVar2 = 9;
    return 0xffffffff;
  }
  DVar3 = SetFilePointer(hFile,param_2,(PLONG)0x0,param_3);
  if (DVar3 == 0xffffffff) {
    uVar4 = GetLastError();
  }
  else {
    uVar4 = 0;
  }
  if (uVar4 == 0) {
    pbVar1 = (byte *)((&DAT_10069600)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
    *pbVar1 = *pbVar1 & 0xfd;
  }
  else {
    __dosmaperr(uVar4);
    DVar3 = 0xffffffff;
  }
  return DVar3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __lseek
// 
// Library: Visual Studio 2003 Release

long __cdecl __lseek(int _FileHandle,long _Offset,int _Origin)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  DWORD local_20;
  
  if ((uint)_FileHandle < DAT_100695e4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_10069600)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_10041d35();
        *piVar1 = 9;
        puVar2 = FUN_10041d3e();
        *puVar2 = 0;
        local_20 = 0xffffffff;
      }
      else {
        local_20 = __lseek_lk(_FileHandle,_Offset,_Origin);
      }
      FUN_10048503();
      return local_20;
    }
  }
  piVar1 = FUN_10041d35();
  *piVar1 = 9;
  puVar2 = FUN_10041d3e();
  *puVar2 = 0;
  return -1;
}



void FUN_10048503(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// Library Function - Single Match
//  __ZeroTail
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __ZeroTail(int param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  
  iVar2 = param_2 / 0x20;
  uVar1 = *(uint *)(param_1 + iVar2 * 4) & ~(-1 << (0x1fU - (char)(param_2 % 0x20) & 0x1f));
  while( true ) {
    if (uVar1 != 0) {
      return 0;
    }
    iVar2 = iVar2 + 1;
    if (2 < iVar2) break;
    uVar1 = *(uint *)(param_1 + iVar2 * 4);
  }
  return 1;
}



// Library Function - Single Match
//  __IncMan
// 
// Library: Visual Studio 2003 Release

void __cdecl __IncMan(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  
  puVar3 = (uint *)(param_1 + (param_2 / 0x20) * 4);
  iVar1 = ___addl(*puVar3,1 << (0x1fU - (char)(param_2 % 0x20) & 0x1f),puVar3);
  iVar2 = param_2 / 0x20 + -1;
  if (-1 < iVar2) {
    puVar3 = (uint *)(param_1 + iVar2 * 4);
    do {
      if (iVar1 == 0) {
        return;
      }
      iVar1 = ___addl(*puVar3,1,puVar3);
      iVar2 = iVar2 + -1;
      puVar3 = puVar3 + -1;
    } while (-1 < iVar2);
  }
  return;
}



// Library Function - Single Match
//  __RoundMan
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __RoundMan(int param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  undefined4 *puVar5;
  undefined4 local_8;
  
  local_8 = 0;
  iVar2 = param_2 / 0x20;
  bVar4 = 0x1f - (char)(param_2 % 0x20);
  if (((*(uint *)(param_1 + iVar2 * 4) & 1 << (bVar4 & 0x1f)) != 0) &&
     (iVar3 = __ZeroTail(param_1,param_2), iVar3 == 0)) {
    local_8 = __IncMan(param_1,param_2 + -1);
  }
  puVar1 = (uint *)(param_1 + iVar2 * 4);
  *puVar1 = *puVar1 & -1 << (bVar4 & 0x1f);
  iVar2 = iVar2 + 1;
  if (iVar2 < 3) {
    puVar5 = (undefined4 *)(param_1 + iVar2 * 4);
    for (iVar3 = 3 - iVar2; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
  }
  return local_8;
}



// Library Function - Single Match
//  __CopyMan
// 
// Library: Visual Studio 2003 Release

void __cdecl __CopyMan(int param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = 3;
  iVar1 = param_1 - (int)param_2;
  do {
    *(undefined4 *)(iVar1 + (int)param_2) = *param_2;
    param_2 = param_2 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



// Library Function - Single Match
//  __IsZeroMan
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __IsZeroMan(int param_1)

{
  int iVar1;
  
  iVar1 = 0;
  do {
    if (*(int *)(param_1 + iVar1 * 4) != 0) {
      return 0;
    }
    iVar1 = iVar1 + 1;
  } while (iVar1 < 3);
  return 1;
}



// Library Function - Single Match
//  __ShrMan
// 
// Library: Visual Studio 2003 Release

void __cdecl __ShrMan(int param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  byte bVar3;
  undefined4 *puVar4;
  uint local_8;
  
  bVar3 = (byte)(param_2 % 0x20);
  iVar2 = 0;
  local_8 = 0;
  do {
    uVar1 = *(uint *)(param_1 + iVar2 * 4);
    *(uint *)(param_1 + iVar2 * 4) = uVar1 >> (bVar3 & 0x1f) | local_8;
    local_8 = (uVar1 & ~(-1 << (bVar3 & 0x1f))) << (0x20 - bVar3 & 0x1f);
    iVar2 = iVar2 + 1;
  } while (iVar2 < 3);
  iVar2 = 2;
  puVar4 = (undefined4 *)(param_1 + (2 - param_2 / 0x20) * 4);
  do {
    if (iVar2 < param_2 / 0x20) {
      *(undefined4 *)(param_1 + iVar2 * 4) = 0;
    }
    else {
      *(undefined4 *)(param_1 + iVar2 * 4) = *puVar4;
    }
    iVar2 = iVar2 + -1;
    puVar4 = puVar4 + -1;
  } while (-1 < iVar2);
  return;
}



// Library Function - Single Match
//  __ld12cvt
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __ld12cvt(ushort *param_1,uint *param_2,int *param_3)

{
  ushort uVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  undefined4 local_1c [3];
  uint local_10;
  uint local_c;
  int local_8;
  
  uVar1 = param_1[5];
  local_10 = *(uint *)(param_1 + 3);
  local_c = *(uint *)(param_1 + 1);
  local_8 = (uint)*param_1 << 0x10;
  uVar4 = uVar1 & 0x7fff;
  iVar5 = uVar4 - 0x3fff;
  if (iVar5 == -0x3fff) {
    iVar5 = 0;
    iVar2 = __IsZeroMan((int)&local_10);
    if (iVar2 != 0) {
LAB_100487df:
      uVar3 = 0;
      goto LAB_100487e1;
    }
    local_10 = 0;
    local_c = 0;
  }
  else {
    __CopyMan((int)local_1c,&local_10);
    iVar2 = __RoundMan((int)&local_10,param_3[2]);
    if (iVar2 != 0) {
      iVar5 = uVar4 - 0x3ffe;
    }
    iVar2 = param_3[1];
    if (iVar5 < iVar2 - param_3[2]) {
      local_10 = 0;
      local_c = 0;
    }
    else {
      if (iVar2 < iVar5) {
        if (*param_3 <= iVar5) {
          local_c = 0;
          local_8 = 0;
          local_10 = 0x80000000;
          __ShrMan((int)&local_10,param_3[3]);
          iVar5 = param_3[5] + *param_3;
          uVar3 = 1;
          goto LAB_100487e1;
        }
        local_10 = local_10 & 0x7fffffff;
        iVar5 = param_3[5] + iVar5;
        __ShrMan((int)&local_10,param_3[3]);
        goto LAB_100487df;
      }
      __CopyMan((int)&local_10,local_1c);
      __ShrMan((int)&local_10,iVar2 - iVar5);
      __RoundMan((int)&local_10,param_3[2]);
      __ShrMan((int)&local_10,param_3[3] + 1);
    }
  }
  iVar5 = 0;
  uVar3 = 2;
LAB_100487e1:
  local_10 = iVar5 << (0x1fU - (char)param_3[3] & 0x1f) |
             -(uint)((uVar1 & 0x8000) != 0) & 0x80000000 | local_10;
  if (param_3[4] == 0x40) {
    param_2[1] = local_10;
    *param_2 = local_c;
  }
  else if (param_3[4] == 0x20) {
    *param_2 = local_10;
  }
  return uVar3;
}



// Library Function - Single Match
//  __ld12tod
// 
// Library: Visual Studio 2003 Release

INTRNCVT_STATUS __cdecl __ld12tod(_LDBL12 *_Ifp,_CRT_DOUBLE *_D)

{
  INTRNCVT_STATUS IVar1;
  
  IVar1 = __ld12cvt((ushort *)_Ifp,(uint *)_D,(int *)&DAT_10057e70);
  return IVar1;
}



// Library Function - Multiple Matches With Different Base Names
//  __ld12tod
//  __ld12tof
// 
// Library: Visual Studio 2003 Release

INTRNCVT_STATUS __cdecl __ld12tof(_LDBL12 *_Ifp,_CRT_FLOAT *_F)

{
  INTRNCVT_STATUS IVar1;
  
  IVar1 = __ld12cvt((ushort *)_Ifp,(uint *)_F,(int *)&DAT_10057e88);
  return IVar1;
}



// Library Function - Multiple Matches With Different Base Names
//  __atodbl
//  __atoflt
// 
// Library: Visual Studio 2003 Release

int __cdecl FID_conflict___atodbl(_CRT_FLOAT *_Result,char *_Str)

{
  int iVar1;
  char *local_18;
  _LDBL12 local_14;
  int local_8;
  
  local_8 = DAT_10057438;
  ___strgtold12(&local_14,&local_18,_Str,0,0,0,0);
  __ld12tod(&local_14,(_CRT_DOUBLE *)_Result);
  iVar1 = FUN_1003fb09(local_8);
  return iVar1;
}



// Library Function - Multiple Matches With Different Base Names
//  __atodbl
//  __atoflt
// 
// Library: Visual Studio 2003 Release

int __cdecl FID_conflict___atodbl(_CRT_FLOAT *_Result,char *_Str)

{
  int iVar1;
  char *local_18;
  _LDBL12 local_14;
  int local_8;
  
  local_8 = DAT_10057438;
  ___strgtold12(&local_14,&local_18,_Str,0,0,0,0);
  __ld12tof(&local_14,_Result);
  iVar1 = FUN_1003fb09(local_8);
  return iVar1;
}



// Library Function - Single Match
//  __fptostr
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl __fptostr(char *_Buf,size_t _SizeInBytes,int _Digits,STRFLT _PtFlt)

{
  char *_Str;
  char *_Dst;
  char *pcVar1;
  size_t sVar2;
  char *pcVar3;
  char cVar4;
  
  _Dst = _Buf;
  pcVar3 = *(char **)(_Digits + 0xc);
  _Str = _Buf + 1;
  *_Buf = '0';
  pcVar1 = _Str;
  if (0 < (int)_SizeInBytes) {
    _Buf = (char *)_SizeInBytes;
    _SizeInBytes = 0;
    do {
      cVar4 = *pcVar3;
      if (cVar4 == '\0') {
        cVar4 = '0';
      }
      else {
        pcVar3 = pcVar3 + 1;
      }
      *pcVar1 = cVar4;
      pcVar1 = pcVar1 + 1;
      _Buf = _Buf + -1;
    } while (_Buf != (char *)0x0);
  }
  *pcVar1 = '\0';
  if ((-1 < (int)_SizeInBytes) && ('4' < *pcVar3)) {
    while (pcVar1 = pcVar1 + -1, *pcVar1 == '9') {
      *pcVar1 = '0';
    }
    *pcVar1 = *pcVar1 + '\x01';
  }
  if (*_Dst == '1') {
    *(int *)(_Digits + 4) = *(int *)(_Digits + 4) + 1;
  }
  else {
    sVar2 = _strlen(_Str);
    pcVar1 = (char *)_memmove(_Dst,_Str,sVar2 + 1);
  }
  return (errno_t)pcVar1;
}



// Library Function - Single Match
//  ___dtold
// 
// Library: Visual Studio 2003 Release

void __cdecl ___dtold(uint *param_1,uint *param_2)

{
  ushort uVar1;
  uint uVar2;
  ushort uVar3;
  ushort uVar4;
  uint local_8;
  
  uVar1 = *(ushort *)((int)param_2 + 6);
  local_8 = 0x80000000;
  uVar3 = uVar1 >> 4;
  uVar4 = uVar3 & 0x7ff;
  uVar2 = *param_2;
  if ((uVar3 & 0x7ff) == 0) {
    if (((param_2[1] & 0xfffff) == 0) && (uVar2 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      *(undefined2 *)(param_1 + 2) = 0;
      return;
    }
    uVar4 = uVar4 + 0x3c01;
    local_8 = 0;
  }
  else if (uVar4 == 0x7ff) {
    uVar4 = 0x7fff;
  }
  else {
    uVar4 = uVar4 + 0x3c00;
  }
  param_1[1] = uVar2 >> 0x15 | (param_2[1] & 0xfffff) << 0xb | local_8;
  *param_1 = uVar2 << 0xb;
  while (local_8 == 0) {
    uVar2 = param_1[1];
    uVar4 = uVar4 - 1;
    param_1[1] = uVar2 << 1 | *param_1 >> 0x1f;
    *param_1 = *param_1 * 2;
    local_8 = uVar2 << 1 & 0x80000000;
  }
  *(ushort *)(param_1 + 2) = uVar1 & 0x8000 | uVar4;
  return;
}



// Library Function - Single Match
//  __fltout2
// 
// Library: Visual Studio 2003 Release

STRFLT __cdecl __fltout2(_CRT_DOUBLE _Dbl,STRFLT _Flt,char *_ResultStr,size_t _SizeInBytes)

{
  int iVar1;
  STRFLT p_Var2;
  undefined4 in_stack_ffffffb8;
  undefined2 uVar3;
  short local_30;
  char local_2e;
  uint local_2c [6];
  uint local_14;
  uint uStack_10;
  undefined2 uStack_c;
  int local_8;
  
  uVar3 = (undefined2)((uint)in_stack_ffffffb8 >> 0x10);
  local_8 = DAT_10057438;
  ___dtold(&local_14,(uint *)&_Dbl);
  iVar1 = _I10_OUTPUT(local_14,uStack_10,CONCAT22(uVar3,uStack_c),0x11,0,&local_30);
  _Flt->flag = iVar1;
  _Flt->sign = (int)local_2e;
  _Flt->decpt = (int)local_30;
  FUN_10048310((uint *)_ResultStr,local_2c);
  _Flt->mantissa = _ResultStr;
  p_Var2 = (STRFLT)FUN_1003fb09(local_8);
  return p_Var2;
}



// Library Function - Single Match
//  _memset
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release, Visual Studio 2019 Release

void * __cdecl _memset(void *_Dst,int _Val,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  
  if (_Size == 0) {
    return _Dst;
  }
  uVar1 = _Val & 0xff;
  puVar4 = (uint *)_Dst;
  if (3 < _Size) {
    uVar2 = -(int)_Dst & 3;
    sVar3 = _Size;
    if (uVar2 != 0) {
      sVar3 = _Size - uVar2;
      do {
        *(undefined1 *)puVar4 = (undefined1)_Val;
        puVar4 = (uint *)((int)puVar4 + 1);
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    uVar1 = uVar1 * 0x1010101;
    _Size = sVar3 & 3;
    uVar2 = sVar3 >> 2;
    if (uVar2 != 0) {
      for (; uVar2 != 0; uVar2 = uVar2 - 1) {
        *puVar4 = uVar1;
        puVar4 = puVar4 + 1;
      }
      if (_Size == 0) {
        return _Dst;
      }
    }
  }
  do {
    *(char *)puVar4 = (char)uVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    _Size = _Size - 1;
  } while (_Size != 0);
  return _Dst;
}



// Library Function - Single Match
//  __fptrap
// 
// Library: Visual Studio 2003 Release

void __cdecl __fptrap(void)

{
  __amsg_exit(2);
  return;
}



// Library Function - Single Match
//  __abstract_cw
// 
// Library: Visual Studio 2003 Release

uint __abstract_cw(void)

{
  uint uVar1;
  ushort uVar2;
  ushort unaff_BX;
  
  uVar1 = 0;
  if ((unaff_BX & 1) != 0) {
    uVar1 = 0x10;
  }
  if ((unaff_BX & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((unaff_BX & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((unaff_BX & 0x10) != 0) {
    uVar1 = uVar1 | 2;
  }
  if ((unaff_BX & 0x20) != 0) {
    uVar1 = uVar1 | 1;
  }
  if ((unaff_BX & 2) != 0) {
    uVar1 = uVar1 | 0x80000;
  }
  uVar2 = unaff_BX & 0xc00;
  if ((unaff_BX & 0xc00) != 0) {
    if (uVar2 == 0x400) {
      uVar1 = uVar1 | 0x100;
    }
    else if (uVar2 == 0x800) {
      uVar1 = uVar1 | 0x200;
    }
    else if (uVar2 == 0xc00) {
      uVar1 = uVar1 | 0x300;
    }
  }
  if ((unaff_BX & 0x300) == 0) {
    uVar1 = uVar1 | 0x20000;
  }
  else if ((unaff_BX & 0x300) == 0x200) {
    uVar1 = uVar1 | 0x10000;
  }
  if ((unaff_BX & 0x1000) != 0) {
    uVar1 = uVar1 | 0x40000;
  }
  return uVar1;
}



// Library Function - Single Match
//  __hw_cw
// 
// Library: Visual Studio 2003 Release

uint __hw_cw(void)

{
  uint uVar1;
  uint uVar2;
  uint unaff_EBX;
  
  uVar1 = (uint)((unaff_EBX & 0x10) != 0);
  if ((unaff_EBX & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((unaff_EBX & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((unaff_EBX & 2) != 0) {
    uVar1 = uVar1 | 0x10;
  }
  if ((unaff_EBX & 1) != 0) {
    uVar1 = uVar1 | 0x20;
  }
  if ((unaff_EBX & 0x80000) != 0) {
    uVar1 = uVar1 | 2;
  }
  uVar2 = unaff_EBX & 0x300;
  if (uVar2 != 0) {
    if (uVar2 == 0x100) {
      uVar1 = uVar1 | 0x400;
    }
    else if (uVar2 == 0x200) {
      uVar1 = uVar1 | 0x800;
    }
    else if (uVar2 == 0x300) {
      uVar1 = uVar1 | 0xc00;
    }
  }
  if ((unaff_EBX & 0x30000) == 0) {
    uVar1 = uVar1 | 0x300;
  }
  else if ((unaff_EBX & 0x30000) == 0x10000) {
    uVar1 = uVar1 | 0x200;
  }
  if ((unaff_EBX & 0x40000) != 0) {
    uVar1 = uVar1 | 0x1000;
  }
  return uVar1;
}



// Library Function - Single Match
//  __control87
// 
// Library: Visual Studio 2003 Release

uint __cdecl __control87(uint _NewValue,uint _Mask)

{
  uint uVar1;
  
  uVar1 = __abstract_cw();
  __hw_cw();
  return uVar1 & ~_Mask | _NewValue & _Mask;
}



// Library Function - Single Match
//  __controlfp
// 
// Library: Visual Studio 2003 Release

uint __cdecl __controlfp(uint _NewValue,uint _Mask)

{
  uint uVar1;
  
  uVar1 = __control87(_NewValue,_Mask & 0xfff7ffff);
  return uVar1;
}



// Library Function - Single Match
//  ___crtInitCritSecNoSpinCount@8
// 
// Library: Visual Studio 2003 Release

undefined4 ___crtInitCritSecNoSpinCount_8(LPCRITICAL_SECTION param_1)

{
  InitializeCriticalSection(param_1);
  return 1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___crtInitCritSecAndSpinCount
// 
// Library: Visual Studio 2003 Release

void __cdecl ___crtInitCritSecAndSpinCount(undefined4 param_1,undefined4 param_2)

{
  HMODULE hModule;
  
  if (DAT_10069268 == (code *)0x0) {
    if (DAT_1006903c != 1) {
      hModule = GetModuleHandleA("kernel32.dll");
      if (hModule != (HMODULE)0x0) {
        DAT_10069268 = GetProcAddress(hModule,"InitializeCriticalSectionAndSpinCount");
        if (DAT_10069268 != (FARPROC)0x0) goto LAB_10048c9d;
      }
    }
    DAT_10069268 = ___crtInitCritSecNoSpinCount_8;
  }
LAB_10048c9d:
  (*DAT_10069268)(param_1,param_2);
  return;
}



// Library Function - Single Match
//  __ValidateEH3RN
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __ValidateEH3RN(void *param_1)

{
  uint *puVar1;
  void *pvVar2;
  uint uVar3;
  void *pvVar4;
  uint *puVar5;
  SIZE_T SVar6;
  int *piVar7;
  LONG LVar8;
  uint *puVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  _MEMORY_BASIC_INFORMATION local_24;
  void *local_8;
  
  pvVar4 = param_1;
  puVar9 = *(uint **)((int)param_1 + 8);
  if ((((uint)puVar9 & 3) != 0) ||
     ((local_8 = StackLimit, StackLimit <= puVar9 && (puVar9 < StackBase)))) {
    return 0;
  }
  puVar1 = (uint *)((int)param_1 + 0xc);
  if (*puVar1 == 0xffffffff) {
    return 1;
  }
  uVar11 = 0;
  param_1 = (void *)0x0;
  puVar5 = puVar9;
  do {
    if ((*puVar5 != 0xffffffff) && (uVar11 <= *puVar5)) {
      return 0;
    }
    if (puVar5[1] != 0) {
      param_1 = (void *)((int)param_1 + 1);
    }
    uVar11 = uVar11 + 1;
    puVar5 = puVar5 + 3;
  } while (uVar11 <= *puVar1);
  if ((param_1 != (void *)0x0) &&
     ((pvVar2 = *(void **)((int)pvVar4 + -8), pvVar2 < StackLimit || (pvVar4 <= pvVar2)))) {
    return 0;
  }
  uVar11 = (uint)puVar9 & 0xfffff000;
  iVar14 = 0;
  if (0 < DAT_10069270) {
    do {
      if ((&DAT_10069278)[iVar14] == uVar11) {
        if (iVar14 < 1) {
          return 1;
        }
        LVar8 = InterlockedExchange((LONG *)&DAT_100692b8,1);
        if (LVar8 != 0) {
          return 1;
        }
        if ((&DAT_10069278)[iVar14] == uVar11) goto LAB_10048ed7;
        iVar14 = DAT_10069270 + -1;
        if (iVar14 < 0) goto LAB_10048ec5;
        goto LAB_10048eb5;
      }
      iVar14 = iVar14 + 1;
    } while (iVar14 < DAT_10069270);
  }
  SVar6 = VirtualQuery(puVar9,&local_24,0x1c);
  if (SVar6 == 0) {
    return 0xffffffff;
  }
  if (local_24.Type != 0x1000000) {
    return 0xffffffff;
  }
  if (((byte)local_24.Protect & 0xcc) != 0) {
                    // WARNING: Load size is inaccurate
    if (((*local_24.AllocationBase != 0x5a4d) ||
        (piVar7 = (int *)(*(int *)((int)local_24.AllocationBase + 0x3c) +
                         (int)local_24.AllocationBase), *piVar7 != 0x4550)) ||
       ((short)piVar7[6] != 0x10b)) {
      return 0xffffffff;
    }
    uVar10 = (uint)*(ushort *)(piVar7 + 5);
    if (*(short *)((int)piVar7 + 6) == 0) {
      return 0xffffffff;
    }
    uVar3 = *(uint *)((int)piVar7 + uVar10 + 0x24);
    if (((uVar3 <= (uint)((int)puVar9 - (int)local_24.AllocationBase)) &&
        ((uint)((int)puVar9 - (int)local_24.AllocationBase) <
         *(int *)((int)piVar7 + uVar10 + 0x20) + uVar3)) &&
       ((*(byte *)((int)piVar7 + uVar10 + 0x3f) & 0x80) != 0)) {
      return 0;
    }
  }
  LVar8 = InterlockedExchange((LONG *)&DAT_100692b8,1);
  iVar14 = DAT_10069270;
  if (LVar8 != 0) {
    return 1;
  }
  iVar12 = DAT_10069270;
  if (0 < DAT_10069270) {
    puVar9 = (uint *)(&DAT_10069274 + DAT_10069270 * 4);
    do {
      if (*puVar9 == uVar11) break;
      iVar12 = iVar12 + -1;
      puVar9 = puVar9 + -1;
    } while (0 < iVar12);
  }
  if (iVar12 == 0) {
    iVar12 = 0xf;
    if (DAT_10069270 < 0x10) {
      iVar12 = DAT_10069270;
    }
    iVar13 = 0;
    if (-1 < iVar12) {
      do {
        puVar9 = &DAT_10069278 + iVar13;
        uVar10 = *puVar9;
        iVar13 = iVar13 + 1;
        *puVar9 = uVar11;
        uVar11 = uVar10;
      } while (iVar13 <= iVar12);
    }
    if (iVar14 < 0x10) {
      DAT_10069270 = iVar14 + 1;
    }
  }
  InterlockedExchange((LONG *)&DAT_100692b8,0);
  return 1;
  while (iVar14 = iVar14 + -1, -1 < iVar14) {
LAB_10048eb5:
    if ((&DAT_10069278)[iVar14] == uVar11) break;
  }
  if (iVar14 < 0) {
LAB_10048ec5:
    if (DAT_10069270 < 0x10) {
      DAT_10069270 = DAT_10069270 + 1;
    }
    iVar14 = DAT_10069270 + -1;
  }
  else if (iVar14 == 0) goto LAB_10048eef;
LAB_10048ed7:
  iVar12 = 0;
  if (-1 < iVar14) {
    do {
      puVar9 = &DAT_10069278 + iVar12;
      uVar10 = *puVar9;
      iVar12 = iVar12 + 1;
      *puVar9 = uVar11;
      uVar11 = uVar10;
    } while (iVar12 <= iVar14);
  }
LAB_10048eef:
  InterlockedExchange((LONG *)&DAT_100692b8,0);
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __getbuf
// 
// Library: Visual Studio 2003 Release

void __cdecl __getbuf(FILE *_File)

{
  char *pcVar1;
  
  _DAT_10068e3c = _DAT_10068e3c + 1;
  pcVar1 = (char *)_malloc(0x1000);
  _File->_base = pcVar1;
  if (pcVar1 == (char *)0x0) {
    _File->_flag = _File->_flag | 4;
    _File->_base = (char *)&_File->_charbuf;
    _File->_bufsiz = 2;
  }
  else {
    _File->_flag = _File->_flag | 8;
    _File->_bufsiz = 0x1000;
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return;
}



// Library Function - Single Match
//  __isatty
// 
// Library: Visual Studio 2003 Release

int __cdecl __isatty(int _FileHandle)

{
  if (DAT_100695e4 <= (uint)_FileHandle) {
    return 0;
  }
  return (int)*(char *)((&DAT_10069600)[_FileHandle >> 5] + 4 + (_FileHandle & 0x1fU) * 0x24) & 0x40
  ;
}



// Library Function - Single Match
//  ___wctomb_mt
// 
// Library: Visual Studio 2003 Release

int __cdecl ___wctomb_mt(int param_1,LPSTR param_2,WCHAR param_3)

{
  LPSTR lpMultiByteStr;
  int iVar1;
  int *piVar2;
  
  lpMultiByteStr = param_2;
  if (param_2 == (LPSTR)0x0) {
    iVar1 = 0;
  }
  else {
    if (*(int *)(param_1 + 0x14) == 0) {
      if ((ushort)param_3 < 0x100) {
        *param_2 = (CHAR)param_3;
        return 1;
      }
    }
    else {
      param_2 = (LPSTR)0x0;
      iVar1 = WideCharToMultiByte(*(UINT *)(param_1 + 4),0,&param_3,1,lpMultiByteStr,
                                  *(int *)(param_1 + 0x28),(LPCSTR)0x0,(LPBOOL)&param_2);
      if ((iVar1 != 0) && (param_2 == (LPSTR)0x0)) {
        return iVar1;
      }
    }
    piVar2 = FUN_10041d35();
    *piVar2 = 0x2a;
    iVar1 = -1;
  }
  return iVar1;
}



// Library Function - Single Match
//  _wctomb
// 
// Library: Visual Studio 2003 Release

int __cdecl _wctomb(char *_MbCh,wchar_t _WCh)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  int iVar3;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
  }
  iVar3 = ___wctomb_mt((int)ptVar2,_MbCh,_WCh);
  return iVar3;
}



// Library Function - Single Match
//  __aulldvrm
// 
// Library: Visual Studio 2003 Release

undefined8 __aulldvrm(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



// Library Function - Single Match
//  int __cdecl _ValidateRead(void const *,unsigned int)
// 
// Library: Visual Studio 2003 Release

int __cdecl _ValidateRead(void *param_1,uint param_2)

{
  BOOL BVar1;
  
  BVar1 = IsBadReadPtr(param_1,param_2);
  return (uint)(BVar1 == 0);
}



// Library Function - Multiple Matches With Different Base Names
//  int __cdecl _ValidateRead(void const *,unsigned int)
//  int __cdecl _ValidateWrite(void *,unsigned int)
// 
// Library: Visual Studio 2003 Release

int __cdecl _ValidateWrite(void *param_1,uint param_2)

{
  BOOL BVar1;
  
  BVar1 = IsBadWritePtr(param_1,param_2);
  return (uint)(BVar1 == 0);
}



// Library Function - Single Match
//  int __cdecl _ValidateExecute(int (__stdcall*)(void))
// 
// Library: Visual Studio 2003 Release

int __cdecl _ValidateExecute(_func_int *param_1)

{
  BOOL BVar1;
  
  BVar1 = IsBadCodePtr((FARPROC)param_1);
  return (uint)(BVar1 == 0);
}



// Library Function - Single Match
//  _CPtoLCID
// 
// Library: Visual Studio 2003 Release

undefined4 _CPtoLCID(void)

{
  int in_EAX;
  
  if (in_EAX == 0x3a4) {
    return 0x411;
  }
  if (in_EAX == 0x3a8) {
    return 0x804;
  }
  if (in_EAX == 0x3b5) {
    return 0x412;
  }
  if (in_EAX != 0x3b6) {
    return 0;
  }
  return 0x404;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _setSBCS
// 
// Library: Visual Studio 2003 Release

void __cdecl setSBCS(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)&DAT_100693a0;
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *(undefined1 *)puVar2 = 0;
  DAT_100694a4 = 0;
  DAT_10069390 = 0;
  DAT_10069388 = 0;
  _DAT_100694b0 = 0;
  DAT_100694b4 = 0;
  DAT_100694b8 = 0;
  return;
}



// Library Function - Single Match
//  _setSBUpLow
// 
// Library: Visual Studio 2003 Release

void __cdecl setSBUpLow(void)

{
  BOOL BVar1;
  uint uVar2;
  undefined1 uVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  BYTE *pBVar7;
  undefined4 *puVar8;
  _locale_t _BError;
  ushort local_51c [256];
  undefined1 local_31c [256];
  undefined1 local_21c [256];
  undefined4 local_11c [64];
  _cpinfo local_1c;
  int local_8;
  
  local_8 = DAT_10057438;
  BVar1 = GetCPInfo((UINT)DAT_100694a4,&local_1c);
  if (BVar1 == 1) {
    uVar2 = 0;
    do {
      *(char *)((int)local_11c + uVar2) = (char)uVar2;
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
    local_11c[0]._0_1_ = 0x20;
    if (local_1c.LeadByte[0] != 0) {
      pBVar7 = local_1c.LeadByte + 1;
      do {
        uVar2 = (uint)local_1c.LeadByte[0];
        if (uVar2 <= *pBVar7) {
          uVar5 = (*pBVar7 - uVar2) + 1;
          puVar8 = (undefined4 *)((int)local_11c + uVar2);
          for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
            *puVar8 = 0x20202020;
            puVar8 = puVar8 + 1;
          }
          for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
            *(undefined1 *)puVar8 = 0x20;
            puVar8 = (undefined4 *)((int)puVar8 + 1);
          }
        }
        local_1c.LeadByte[0] = pBVar7[1];
        pBVar7 = pBVar7 + 2;
      } while (local_1c.LeadByte[0] != 0);
    }
    BVar1 = 1;
    ___crtGetStringTypeA
              ((_locale_t)0x1,(DWORD)local_11c,(LPCSTR)0x100,(int)local_51c,DAT_100694a4,
               (int)DAT_10069388,0);
    _BError = DAT_10069388;
    ___crtLCMapStringA(DAT_10069388,(LPCWSTR)0x100,(DWORD)local_11c,(LPCSTR)0x100,(int)local_21c,
                       (LPSTR)0x100,(int)DAT_100694a4,0,BVar1);
    ___crtLCMapStringA(DAT_10069388,(LPCWSTR)0x200,(DWORD)local_11c,(LPCSTR)0x100,(int)local_31c,
                       (LPSTR)0x100,(int)DAT_100694a4,0,(BOOL)_BError);
    uVar2 = 0;
    do {
      if ((local_51c[uVar2] & 1) == 0) {
        if ((local_51c[uVar2] & 2) != 0) {
          (&DAT_100693a1)[uVar2] = (&DAT_100693a1)[uVar2] | 0x20;
          uVar3 = local_31c[uVar2];
          goto LAB_1004924f;
        }
        (&DAT_100694c0)[uVar2] = 0;
      }
      else {
        (&DAT_100693a1)[uVar2] = (&DAT_100693a1)[uVar2] | 0x10;
        uVar3 = local_21c[uVar2];
LAB_1004924f:
        (&DAT_100694c0)[uVar2] = uVar3;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
  }
  else {
    uVar2 = 0;
    do {
      if ((uVar2 < 0x41) || (0x5a < uVar2)) {
        if ((0x60 < uVar2) && (uVar2 < 0x7b)) {
          (&DAT_100693a1)[uVar2] = (&DAT_100693a1)[uVar2] | 0x20;
          cVar4 = (char)uVar2 + -0x20;
          goto LAB_10049292;
        }
        (&DAT_100694c0)[uVar2] = 0;
      }
      else {
        (&DAT_100693a1)[uVar2] = (&DAT_100693a1)[uVar2] | 0x10;
        cVar4 = (char)uVar2 + ' ';
LAB_10049292:
        (&DAT_100694c0)[uVar2] = cVar4;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
  }
  FUN_1003fb09(local_8);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___updatetmbcinfo
// 
// Library: Visual Studio 2003 Release

pthreadmbcinfo __cdecl ___updatetmbcinfo(void)

{
  _ptiddata p_Var1;
  pthreadmbcinfo _Memory;
  
  __lock(0xd);
  p_Var1 = __getptd();
  _Memory = (pthreadmbcinfo)p_Var1->_tpxcptinfoptrs;
  if (_Memory != DAT_1006938c) {
    if ((_Memory != (pthreadmbcinfo)0x0) &&
       (_Memory->refcount = _Memory->refcount + -1, _Memory->refcount == 0)) {
      _free(_Memory);
    }
    p_Var1->_tpxcptinfoptrs = DAT_1006938c;
    _Memory = DAT_1006938c;
    DAT_1006938c->refcount = DAT_1006938c->refcount + 1;
  }
  FUN_1004932f();
  return _Memory;
}



void FUN_1004932f(void)

{
  FUN_100425f0(0xd);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __setmbcp_lk
// 
// Library: Visual Studio 2003 Release

void __cdecl __setmbcp_lk(UINT param_1)

{
  BYTE *pBVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  BOOL BVar5;
  BYTE *pBVar6;
  int iVar7;
  int extraout_ECX;
  undefined4 extraout_ECX_00;
  int iVar8;
  byte *pbVar9;
  byte *pbVar10;
  undefined4 *puVar11;
  uint local_20;
  _cpinfo local_1c;
  int local_8;
  
  local_8 = DAT_10057438;
  if (param_1 != 0) {
    iVar8 = 0;
    uVar4 = 0;
LAB_1004935a:
    if (*(UINT *)((int)&DAT_10057ea8 + uVar4) != param_1) goto code_r0x10049362;
    puVar11 = (undefined4 *)&DAT_100693a0;
    for (iVar7 = 0x40; iVar7 != 0; iVar7 = iVar7 + -1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    local_20 = 0;
    *(undefined1 *)puVar11 = 0;
    pbVar9 = &DAT_10057eb8 + iVar8 * 0x30;
    do {
      bVar3 = *pbVar9;
      pbVar10 = pbVar9;
      while ((bVar3 != 0 && (bVar2 = pbVar10[1], bVar2 != 0))) {
        uVar4 = (uint)bVar3;
        if (uVar4 <= bVar2) {
          bVar3 = (&DAT_10057ea0)[local_20];
          do {
            (&DAT_100693a1)[uVar4] = (&DAT_100693a1)[uVar4] | bVar3;
            uVar4 = uVar4 + 1;
          } while (uVar4 <= bVar2);
        }
        pbVar10 = pbVar10 + 2;
        bVar3 = *pbVar10;
      }
      local_20 = local_20 + 1;
      pbVar9 = pbVar9 + 8;
    } while (local_20 < 4);
    DAT_100694a4 = param_1;
    DAT_10069390 = 1;
    DAT_10069388 = _CPtoLCID();
    _DAT_100694b0 = *(undefined4 *)(&DAT_10057eac + extraout_ECX);
    DAT_100694b4 = *(undefined4 *)(&DAT_10057eb0 + extraout_ECX);
    DAT_100694b8 = *(undefined4 *)(&DAT_10057eb4 + extraout_ECX);
    goto LAB_100494af;
  }
LAB_100494aa:
  setSBCS();
LAB_100494af:
  setSBUpLow();
LAB_100494bb:
  FUN_1003fb09(local_8);
  return;
code_r0x10049362:
  uVar4 = uVar4 + 0x30;
  iVar8 = iVar8 + 1;
  if (0xef < uVar4) goto code_r0x1004936d;
  goto LAB_1004935a;
code_r0x1004936d:
  BVar5 = GetCPInfo(param_1,&local_1c);
  if (BVar5 != 1) {
    if (DAT_100692bc == 0) goto LAB_100494bb;
    goto LAB_100494aa;
  }
  puVar11 = (undefined4 *)&DAT_100693a0;
  for (iVar8 = 0x40; iVar8 != 0; iVar8 = iVar8 + -1) {
    *puVar11 = 0;
    puVar11 = puVar11 + 1;
  }
  *(undefined1 *)puVar11 = 0;
  DAT_100694a4 = param_1;
  DAT_10069388 = 0;
  if (local_1c.MaxCharSize < 2) {
    DAT_10069390 = 0;
  }
  else {
    if (local_1c.LeadByte[0] != '\0') {
      pBVar6 = local_1c.LeadByte + 1;
      do {
        bVar3 = *pBVar6;
        if (bVar3 == 0) break;
        for (uVar4 = (uint)pBVar6[-1]; uVar4 <= bVar3; uVar4 = uVar4 + 1) {
          (&DAT_100693a1)[uVar4] = (&DAT_100693a1)[uVar4] | 4;
        }
        pBVar1 = pBVar6 + 1;
        pBVar6 = pBVar6 + 2;
      } while (*pBVar1 != 0);
    }
    uVar4 = 1;
    do {
      (&DAT_100693a1)[uVar4] = (&DAT_100693a1)[uVar4] | 8;
      uVar4 = uVar4 + 1;
    } while (uVar4 < 0xff);
    DAT_10069388 = _CPtoLCID();
    DAT_10069390 = extraout_ECX_00;
  }
  _DAT_100694b0 = 0;
  DAT_100694b4 = 0;
  DAT_100694b8 = 0;
  goto LAB_100494af;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __setmbcp
// 
// Library: Visual Studio 2003 Release

int __cdecl __setmbcp(int _CodePage)

{
  int *_Memory;
  int iVar1;
  int local_24;
  
  local_24 = -1;
  __lock(0xd);
  DAT_100692bc = 0;
  if (_CodePage == -2) {
    DAT_100692bc = 1;
    _CodePage = GetOEMCP();
  }
  else if (_CodePage == -3) {
    DAT_100692bc = 1;
    _CodePage = GetACP();
  }
  else if (_CodePage == -4) {
    DAT_100692bc = 1;
    _CodePage = DAT_100692ec;
  }
  if (_CodePage == DAT_100694a4) {
    local_24 = 0;
  }
  else {
    if ((DAT_1006938c == (int *)0x0) || (_Memory = DAT_1006938c, *DAT_1006938c != 0)) {
      _Memory = (int *)_malloc(0x220);
    }
    if ((_Memory != (int *)0x0) && (local_24 = __setmbcp_lk(_CodePage), local_24 == 0)) {
      *_Memory = 0;
      _Memory[1] = DAT_100694a4;
      _Memory[2] = DAT_10069390;
      _Memory[3] = DAT_10069388;
      for (iVar1 = 0; iVar1 < 5; iVar1 = iVar1 + 1) {
        *(undefined2 *)((int)_Memory + iVar1 * 2 + 0x10) = (&DAT_100694b0)[iVar1];
      }
      for (iVar1 = 0; iVar1 < 0x101; iVar1 = iVar1 + 1) {
        *(undefined1 *)(iVar1 + 0x1c + (int)_Memory) = (&DAT_100693a0)[iVar1];
      }
      for (iVar1 = 0; DAT_1006938c = _Memory, iVar1 < 0x100; iVar1 = iVar1 + 1) {
        *(undefined1 *)(iVar1 + 0x11d + (int)_Memory) = (&DAT_100694c0)[iVar1];
      }
    }
    if ((local_24 == -1) && (_Memory != DAT_1006938c)) {
      _free(_Memory);
    }
  }
  FUN_1004960f();
  return local_24;
}



void FUN_1004960f(void)

{
  FUN_100425f0(0xd);
  return;
}



// Library Function - Single Match
//  ___initmbctable
// 
// Library: Visual Studio 2003 Release

undefined4 ___initmbctable(void)

{
  if (DAT_1006970c == 0) {
    __setmbcp(-3);
    DAT_1006970c = 1;
  }
  return 0;
}



// Library Function - Single Match
//  _abort
// 
// Library: Visual Studio 2003 Release

void __cdecl _abort(void)

{
  __NMSG_WRITE(10);
  _raise(0x16);
                    // WARNING: Subroutine does not return
  __exit(3);
}



// Library Function - Single Match
//  ___crtMessageBoxA
// 
// Library: Visual Studio 2003 Release

int __cdecl ___crtMessageBoxA(LPCSTR _LpText,LPCSTR _LpCaption,UINT _UType)

{
  HMODULE hModule;
  int iVar1;
  int iVar2;
  undefined1 local_14 [8];
  byte local_c;
  undefined1 local_8 [4];
  
  iVar2 = 0;
  if (DAT_100692c0 == (FARPROC)0x0) {
    hModule = LoadLibraryA("user32.dll");
    if ((hModule == (HMODULE)0x0) ||
       (DAT_100692c0 = GetProcAddress(hModule,"MessageBoxA"), DAT_100692c0 == (FARPROC)0x0)) {
      return 0;
    }
    DAT_100692c4 = GetProcAddress(hModule,"GetActiveWindow");
    DAT_100692c8 = GetProcAddress(hModule,"GetLastActivePopup");
    if ((DAT_1006903c == 2) &&
       (DAT_100692d0 = GetProcAddress(hModule,"GetUserObjectInformationA"),
       DAT_100692d0 != (FARPROC)0x0)) {
      DAT_100692cc = GetProcAddress(hModule,"GetProcessWindowStation");
    }
  }
  if ((DAT_100692cc == (FARPROC)0x0) ||
     (((iVar1 = (*DAT_100692cc)(), iVar1 != 0 &&
       (iVar1 = (*DAT_100692d0)(iVar1,1,local_14,0xc,local_8), iVar1 != 0)) && ((local_c & 1) != 0))
     )) {
    if (((DAT_100692c4 != (FARPROC)0x0) && (iVar2 = (*DAT_100692c4)(), iVar2 != 0)) &&
       (DAT_100692c8 != (FARPROC)0x0)) {
      iVar2 = (*DAT_100692c8)(iVar2);
    }
  }
  else if (DAT_10069048 < 4) {
    _UType = _UType | 0x40000;
  }
  else {
    _UType = _UType | 0x200000;
  }
  iVar2 = (*DAT_100692c0)(iVar2,_LpText,_LpCaption,_UType);
  return iVar2;
}



// Library Function - Single Match
//  __onexit_lk
// 
// Library: Visual Studio 2003 Release

void __onexit_lk(void)

{
  size_t sVar1;
  void *pvVar2;
  size_t sVar3;
  undefined4 unaff_EDI;
  
  sVar1 = __msize(DAT_10069708);
  if (sVar1 < (uint)((int)DAT_10069704 + (4 - (int)DAT_10069708))) {
    sVar3 = 0x800;
    if (sVar1 < 0x800) {
      sVar3 = sVar1;
    }
    pvVar2 = _realloc(DAT_10069708,sVar3 + sVar1);
    if (pvVar2 == (void *)0x0) {
      pvVar2 = _realloc(DAT_10069708,sVar1 + 0x10);
      if (pvVar2 == (void *)0x0) {
        return;
      }
    }
    DAT_10069704 = (undefined4 *)((int)pvVar2 + ((int)DAT_10069704 - (int)DAT_10069708 >> 2) * 4);
    DAT_10069708 = pvVar2;
  }
  *DAT_10069704 = unaff_EDI;
  DAT_10069704 = DAT_10069704 + 1;
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __onexit
// 
// Library: Visual Studio 2003 Release

_onexit_t __cdecl __onexit(_onexit_t _Func)

{
  _onexit_t p_Var1;
  
  FUN_10044088();
  p_Var1 = (_onexit_t)__onexit_lk();
  FUN_10049821();
  return p_Var1;
}



void FUN_10049821(void)

{
  FUN_10044091();
  return;
}



// Library Function - Single Match
//  _atexit
// 
// Library: Visual Studio 2003 Release

int __cdecl _atexit(_func_4879 *param_1)

{
  _onexit_t p_Var1;
  
  p_Var1 = __onexit((_onexit_t)param_1);
  return (p_Var1 != (_onexit_t)0x0) - 1;
}



// Library Function - Single Match
//  __getenv_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __getenv_lk(uchar *param_1)

{
  int iVar1;
  size_t _MaxCount;
  size_t sVar2;
  int *piVar3;
  
  if (DAT_10069700 == 0) {
    return 0;
  }
  if (((DAT_1006905c != (int *)0x0) ||
      (((DAT_10069064 != 0 && (iVar1 = ___wtomb_environ(), iVar1 == 0)) &&
       (DAT_1006905c != (int *)0x0)))) && (piVar3 = DAT_1006905c, param_1 != (uchar *)0x0)) {
    _MaxCount = _strlen((char *)param_1);
    for (; (char *)*piVar3 != (char *)0x0; piVar3 = piVar3 + 1) {
      sVar2 = _strlen((char *)*piVar3);
      if (((_MaxCount < sVar2) && (((uchar *)*piVar3)[_MaxCount] == '=')) &&
         (iVar1 = __mbsnbicoll((uchar *)*piVar3,param_1,_MaxCount), iVar1 == 0)) {
        return *piVar3 + 1 + _MaxCount;
      }
    }
  }
  return 0;
}



// Library Function - Single Match
//  ___ansicp
// 
// Library: Visual Studio 2003 Release

void __cdecl ___ansicp(LCID param_1)

{
  int iVar1;
  CHAR local_10 [6];
  undefined1 local_a;
  int local_8;
  
  local_8 = DAT_10057438;
  local_a = 0;
  iVar1 = GetLocaleInfoA(param_1,0x1004,local_10,6);
  if (iVar1 != 0) {
    _atol(local_10);
  }
  FUN_1003fb09(local_8);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___convertcp
// 
// Library: Visual Studio 2003 Release

void __cdecl
___convertcp(UINT param_1,UINT param_2,char *param_3,size_t *param_4,LPSTR param_5,int param_6)

{
  size_t cbMultiByte;
  bool bVar1;
  bool bVar2;
  BOOL BVar3;
  int iVar4;
  LPSTR lpMultiByteStr;
  size_t sVar5;
  LPCWSTR local_4c;
  size_t local_3c;
  _cpinfo local_34;
  int local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10055a50;
  uStack_c = 0x10049909;
  local_20 = DAT_10057438;
  bVar2 = false;
  cbMultiByte = *param_4;
  bVar1 = false;
  if (param_1 != param_2) {
    BVar3 = GetCPInfo(param_1,&local_34);
    if ((((BVar3 != 0) && (local_34.MaxCharSize == 1)) &&
        (BVar3 = GetCPInfo(param_2,&local_34), BVar3 != 0)) && (local_34.MaxCharSize == 1)) {
      bVar1 = true;
    }
    if ((bVar1) && (local_3c = cbMultiByte, cbMultiByte == 0xffffffff)) {
      sVar5 = _strlen(param_3);
      local_3c = sVar5 + 1;
    }
    if ((!bVar1) &&
       (local_3c = MultiByteToWideChar(param_1,1,param_3,cbMultiByte,(LPWSTR)0x0,0), local_3c == 0))
    goto LAB_10049ab5;
    local_8 = (undefined *)0x0;
    local_1c = &stack0xffffffa8;
    local_4c = (LPCWSTR)&stack0xffffffa8;
    _memset(&stack0xffffffa8,0,local_3c * 2);
    local_8 = (undefined *)0xffffffff;
    if (&stack0x00000000 == (undefined1 *)0x58) {
      local_4c = (LPCWSTR)_calloc(2,local_3c);
      if (local_4c == (LPCWSTR)0x0) goto LAB_10049ab5;
      bVar2 = true;
    }
    iVar4 = MultiByteToWideChar(param_1,1,param_3,cbMultiByte,local_4c,local_3c);
    if (iVar4 != 0) {
      if (param_5 == (LPSTR)0x0) {
        if (((bVar1) ||
            (local_3c = WideCharToMultiByte(param_2,0,local_4c,local_3c,(LPSTR)0x0,0,(LPCSTR)0x0,
                                            (LPBOOL)0x0), local_3c != 0)) &&
           (lpMultiByteStr = (LPSTR)_calloc(1,local_3c), lpMultiByteStr != (LPSTR)0x0)) {
          sVar5 = WideCharToMultiByte(param_2,0,local_4c,local_3c,lpMultiByteStr,local_3c,
                                      (LPCSTR)0x0,(LPBOOL)0x0);
          if (sVar5 == 0) {
            _free(lpMultiByteStr);
          }
          else if (cbMultiByte != 0xffffffff) {
            *param_4 = sVar5;
          }
        }
      }
      else {
        WideCharToMultiByte(param_2,0,local_4c,local_3c,param_5,param_6,(LPCSTR)0x0,(LPBOOL)0x0);
      }
    }
  }
  if (bVar2) {
    _free(local_4c);
  }
LAB_10049ab5:
  FUN_1003fb09(local_20);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// Library Function - Single Match
//  __resetstkoflw
// 
// Library: Visual Studio 2003 Release

int __cdecl __resetstkoflw(void)

{
  SIZE_T SVar1;
  BOOL BVar2;
  LPCVOID pvVar3;
  LPCVOID pvVar4;
  undefined4 uStack_60;
  _SYSTEM_INFO local_50;
  _MEMORY_BASIC_INFORMATION local_2c;
  DWORD local_10;
  SIZE_T local_c;
  LPCVOID local_8;
  
  uStack_60 = 0x10049ad7;
  SVar1 = VirtualQuery(&uStack_60,&local_2c,0x1c);
  if (SVar1 != 0) {
    GetSystemInfo(&local_50);
    pvVar4 = (LPCVOID)((~(local_50.dwPageSize - 1) & (uint)&uStack_60) - local_50.dwPageSize);
    pvVar3 = (LPCVOID)(((-(uint)(DAT_1006903c != 1) & 0xfffffff1) + 0x11) * local_50.dwPageSize +
                      (int)local_2c.AllocationBase);
    local_c = local_50.dwPageSize;
    if (pvVar3 <= pvVar4) {
      local_8 = pvVar4;
      if (DAT_1006903c != 1) {
        local_8 = local_2c.AllocationBase;
        do {
          SVar1 = VirtualQuery(local_8,&local_2c,0x1c);
          if (SVar1 == 0) {
            return 0;
          }
          local_8 = (LPCVOID)((int)local_8 + local_2c.RegionSize);
        } while ((local_2c.State & 0x1000) == 0);
        local_8 = local_2c.BaseAddress;
        if ((local_2c.Protect._1_1_ & 1) != 0) {
          return 1;
        }
        if (pvVar4 < local_2c.BaseAddress) {
          return 0;
        }
        if (local_2c.BaseAddress < pvVar3) {
          local_8 = pvVar3;
        }
        VirtualAlloc(local_8,local_c,0x1000,4);
      }
      BVar2 = VirtualProtect(local_8,local_c,(-(uint)(DAT_1006903c != 1) & 0x103) + 1,&local_10);
      return BVar2;
    }
  }
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  ___crtGetStringTypeA
// 
// Library: Visual Studio 2003 Release

BOOL __cdecl
___crtGetStringTypeA
          (_locale_t _Plocinfo,DWORD _DWInfoType,LPCSTR _LpSrcStr,int _CchSrc,LPWORD _LpCharType,
          int _Code_page,BOOL _BError)

{
  int iVar1;
  bool bVar2;
  BOOL BVar3;
  DWORD DVar4;
  int iVar5;
  undefined1 *puVar6;
  undefined1 *puVar7;
  LPWORD pWVar8;
  LCID Locale;
  undefined1 *puVar9;
  void *_Memory;
  LPWORD pWVar10;
  undefined4 uStackY_58;
  BOOL local_28;
  WORD local_20 [2];
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10055a60;
  uStack_c = 0x10049bb5;
  _Memory = (void *)0x0;
  if (DAT_100692f4 == 0) {
    BVar3 = GetStringTypeW(1,L"",1,local_20);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      if (DVar4 == 0x78) {
        DAT_100692f4 = 2;
      }
    }
    else {
      DAT_100692f4 = 1;
    }
  }
  if ((DAT_100692f4 == 2) || (DAT_100692f4 == 0)) {
    Locale = _Code_page;
    if (_Code_page == 0) {
      Locale = DAT_100692dc;
    }
    pWVar10 = _LpCharType;
    if (_LpCharType == (LPWORD)0x0) {
      pWVar10 = DAT_100692ec;
    }
    pWVar8 = (LPWORD)___ansicp(Locale);
    if (pWVar8 != (LPWORD)0xffffffff) {
      if (pWVar8 != pWVar10) {
        uStackY_58 = 0x10049d2c;
        _Memory = (void *)___convertcp((UINT)pWVar10,(UINT)pWVar8,(char *)_DWInfoType,
                                       (size_t *)&_LpSrcStr,(LPSTR)0x0,0);
        _DWInfoType = (DWORD)_Memory;
        if (_Memory == (void *)0x0) {
          return 0;
        }
      }
      BVar3 = GetStringTypeA(Locale,(DWORD)_Plocinfo,(LPCSTR)_DWInfoType,(int)_LpSrcStr,
                             (LPWORD)_CchSrc);
      if (_Memory != (void *)0x0) {
        _free(_Memory);
        return BVar3;
      }
      return BVar3;
    }
  }
  else if (DAT_100692f4 == 1) {
    local_28 = 0;
    bVar2 = false;
    if (_LpCharType == (LPWORD)0x0) {
      _LpCharType = DAT_100692ec;
    }
    uStackY_58 = 0x10049c47;
    iVar5 = MultiByteToWideChar((UINT)_LpCharType,(uint)(_BError != 0) * 8 + 1,(LPCSTR)_DWInfoType,
                                (int)_LpSrcStr,(LPWSTR)0x0,0);
    if (iVar5 != 0) {
      local_8 = (undefined *)0x0;
      puVar6 = (undefined1 *)(iVar5 * 2 + 3U & 0xfffffffc);
      iVar1 = -(int)puVar6;
      puVar7 = &stack0xffffffc4 + iVar1;
      local_1c = &stack0xffffffc4 + iVar1;
      *(int *)((int)local_20 + iVar1 + -0x20) = iVar5 * 2;
      *(undefined4 *)(&stack0xffffffbc + iVar1) = 0;
      *(undefined1 **)(&stack0xffffffb8 + iVar1) = &stack0xffffffc4 + iVar1;
      *(undefined4 *)(&stack0xffffffb4 + iVar1) = 0x10049c79;
      _memset(*(void **)(&stack0xffffffb8 + iVar1),*(int *)(&stack0xffffffbc + iVar1),
              *(size_t *)((int)local_20 + iVar1 + -0x20));
      local_8 = (undefined *)0xffffffff;
      if (&stack0xffffffc4 == puVar6) {
        *(int *)((int)local_20 + iVar1 + -0x20) = iVar5;
        *(undefined4 *)(&stack0xffffffbc + iVar1) = 2;
        *(undefined4 *)(&stack0xffffffb8 + iVar1) = 0x10049ca3;
        puVar7 = (undefined1 *)
                 _calloc(*(size_t *)(&stack0xffffffbc + iVar1),
                         *(size_t *)((int)local_20 + iVar1 + -0x20));
        if (puVar7 == (undefined1 *)0x0) {
          return 0;
        }
        bVar2 = true;
      }
      *(int *)((int)local_20 + iVar1 + -0x20) = iVar5;
      *(undefined1 **)(&stack0xffffffbc + iVar1) = puVar7;
      *(LPCSTR *)(&stack0xffffffb8 + iVar1) = _LpSrcStr;
      *(DWORD *)(&stack0xffffffb4 + iVar1) = _DWInfoType;
      *(undefined4 *)(&stack0xffffffb0 + iVar1) = 1;
      *(LPWORD *)(&stack0xffffffac + iVar1) = _LpCharType;
      puVar9 = (undefined1 *)((int)&uStackY_58 + iVar1);
      *(undefined4 *)((int)&uStackY_58 + iVar1) = 0x10049cc5;
      iVar5 = MultiByteToWideChar(*(UINT *)(&stack0xffffffac + iVar1),
                                  *(DWORD *)(&stack0xffffffb0 + iVar1),
                                  *(LPCSTR *)(&stack0xffffffb4 + iVar1),
                                  *(int *)(&stack0xffffffb8 + iVar1),
                                  *(LPWSTR *)(&stack0xffffffbc + iVar1),
                                  *(int *)((int)local_20 + iVar1 + -0x20));
      puVar6 = puVar9;
      if (iVar5 != 0) {
        *(int *)(puVar9 + -4) = _CchSrc;
        *(int *)(puVar9 + -8) = iVar5;
        *(undefined1 **)(puVar9 + -0xc) = puVar7;
        *(_locale_t *)(puVar9 + -0x10) = _Plocinfo;
        puVar6 = puVar9 + -0x14;
        *(undefined4 *)(puVar9 + -0x14) = 0x10049cd7;
        local_28 = GetStringTypeW(*(DWORD *)(puVar9 + -0x10),*(LPCWSTR *)(puVar9 + -0xc),
                                  *(int *)(puVar9 + -8),*(LPWORD *)(puVar9 + -4));
      }
      if (bVar2) {
        *(undefined1 **)(puVar6 + -4) = puVar7;
        *(undefined4 *)(puVar6 + -8) = 0x10049ce6;
        _free(*(void **)(puVar6 + -4));
        return local_28;
      }
      return local_28;
    }
  }
  return 0;
}



// Library Function - Single Match
//  ___free_lc_time
// 
// Library: Visual Studio 2003 Release

void __cdecl ___free_lc_time(undefined4 *param_1)

{
  if (param_1 != (undefined4 *)0x0) {
    _free((void *)param_1[1]);
    _free((void *)param_1[2]);
    _free((void *)param_1[3]);
    _free((void *)param_1[4]);
    _free((void *)param_1[5]);
    _free((void *)param_1[6]);
    _free((void *)*param_1);
    _free((void *)param_1[8]);
    _free((void *)param_1[9]);
    _free((void *)param_1[10]);
    _free((void *)param_1[0xb]);
    _free((void *)param_1[0xc]);
    _free((void *)param_1[0xd]);
    _free((void *)param_1[7]);
    _free((void *)param_1[0xe]);
    _free((void *)param_1[0xf]);
    _free((void *)param_1[0x10]);
    _free((void *)param_1[0x11]);
    _free((void *)param_1[0x12]);
    _free((void *)param_1[0x13]);
    _free((void *)param_1[0x14]);
    _free((void *)param_1[0x15]);
    _free((void *)param_1[0x16]);
    _free((void *)param_1[0x17]);
    _free((void *)param_1[0x18]);
    _free((void *)param_1[0x19]);
    _free((void *)param_1[0x1a]);
    _free((void *)param_1[0x1b]);
    _free((void *)param_1[0x1c]);
    _free((void *)param_1[0x1d]);
    _free((void *)param_1[0x1e]);
    _free((void *)param_1[0x1f]);
    _free((void *)param_1[0x20]);
    _free((void *)param_1[0x21]);
    _free((void *)param_1[0x22]);
    _free((void *)param_1[0x23]);
    _free((void *)param_1[0x24]);
    _free((void *)param_1[0x25]);
    _free((void *)param_1[0x26]);
    _free((void *)param_1[0x27]);
    _free((void *)param_1[0x28]);
    _free((void *)param_1[0x29]);
    _free((void *)param_1[0x2a]);
  }
  return;
}



// Library Function - Single Match
//  ___free_lconv_num
// 
// Library: Visual Studio 2003 Release

void __cdecl ___free_lconv_num(undefined4 *param_1)

{
  undefined *puVar1;
  
  if (param_1 != (undefined4 *)0x0) {
    puVar1 = (undefined *)*param_1;
    if ((puVar1 != *(undefined **)PTR_PTR_DAT_1005808c) && (puVar1 != PTR_DAT_1005805c)) {
      _free(puVar1);
    }
    puVar1 = (undefined *)param_1[1];
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 4)) && (puVar1 != PTR_DAT_10058060)) {
      _free(puVar1);
    }
    puVar1 = (undefined *)param_1[2];
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 8)) && (puVar1 != PTR_DAT_10058064)) {
      _free(puVar1);
    }
  }
  return;
}



// Library Function - Single Match
//  ___free_lconv_mon
// 
// Library: Visual Studio 2003 Release

void __cdecl ___free_lconv_mon(int param_1)

{
  undefined *puVar1;
  
  if (param_1 != 0) {
    puVar1 = *(undefined **)(param_1 + 0xc);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 0xc)) && (puVar1 != PTR_DAT_10058068)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x10);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 0x10)) && (puVar1 != PTR_DAT_1005806c)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x14);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 0x14)) && (puVar1 != PTR_DAT_10058070)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x18);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 0x18)) && (puVar1 != PTR_DAT_10058074)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x1c);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 0x1c)) && (puVar1 != PTR_DAT_10058078)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x20);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 0x20)) && (puVar1 != PTR_DAT_1005807c)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x24);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_1005808c + 0x24)) && (puVar1 != PTR_DAT_10058080)) {
      _free(puVar1);
    }
  }
  return;
}



// Library Function - Single Match
//  _strcspn
// 
// Library: Visual Studio

size_t __cdecl _strcspn(char *_Str,char *_Control)

{
  byte bVar1;
  size_t sVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *_Control;
    if (bVar1 == 0) break;
    _Control = (char *)((byte *)_Control + 1);
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  sVar2 = 0xffffffff;
  do {
    sVar2 = sVar2 + 1;
    bVar1 = *_Str;
    if (bVar1 == 0) {
      return sVar2;
    }
    _Str = (char *)((byte *)_Str + 1);
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return sVar2;
}



// Library Function - Single Match
//  _strpbrk
// 
// Library: Visual Studio 2003 Release

char * __cdecl _strpbrk(char *_Str,char *_Control)

{
  byte bVar1;
  byte *pbVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *_Control;
    if (bVar1 == 0) break;
    _Control = (char *)((byte *)_Control + 1);
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  do {
    pbVar2 = (byte *)_Str;
    bVar1 = *pbVar2;
    if (bVar1 == 0) {
      return (char *)(uint)bVar1;
    }
    _Str = (char *)(pbVar2 + 1);
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return (char *)pbVar2;
}



// Library Function - Single Match
//  __set_osfhnd
// 
// Library: Visual Studio 2003 Release

int __cdecl __set_osfhnd(int param_1,intptr_t param_2)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if ((uint)param_1 < DAT_100695e4) {
    iVar3 = (param_1 & 0x1fU) * 0x24;
    if (*(int *)(iVar3 + (&DAT_10069600)[param_1 >> 5]) == -1) {
      if (DAT_10068e14 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_1004a1d9;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)param_2);
      }
LAB_1004a1d9:
      *(intptr_t *)(iVar3 + (&DAT_10069600)[param_1 >> 5]) = param_2;
      return 0;
    }
  }
  piVar1 = FUN_10041d35();
  *piVar1 = 9;
  puVar2 = FUN_10041d3e();
  *puVar2 = 0;
  return -1;
}



// Library Function - Single Match
//  __free_osfhnd
// 
// Library: Visual Studio 2003 Release

int __cdecl __free_osfhnd(int param_1)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if ((uint)param_1 < DAT_100695e4) {
    iVar3 = (param_1 & 0x1fU) * 0x24;
    piVar1 = (int *)((&DAT_10069600)[param_1 >> 5] + iVar3);
    if (((*(byte *)(piVar1 + 1) & 1) != 0) && (*piVar1 != -1)) {
      if (DAT_10068e14 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_1004a258;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_1004a258:
      *(undefined4 *)(iVar3 + (&DAT_10069600)[param_1 >> 5]) = 0xffffffff;
      return 0;
    }
  }
  piVar1 = FUN_10041d35();
  *piVar1 = 9;
  puVar2 = FUN_10041d3e();
  *puVar2 = 0;
  return -1;
}



// Library Function - Single Match
//  __get_osfhandle
// 
// Library: Visual Studio 2003 Release

intptr_t __cdecl __get_osfhandle(int _FileHandle)

{
  intptr_t *piVar1;
  int *piVar2;
  ulong *puVar3;
  
  if (((uint)_FileHandle < DAT_100695e4) &&
     (piVar1 = (intptr_t *)((&DAT_10069600)[_FileHandle >> 5] + (_FileHandle & 0x1fU) * 0x24),
     (*(byte *)(piVar1 + 1) & 1) != 0)) {
    return *piVar1;
  }
  piVar2 = FUN_10041d35();
  *piVar2 = 9;
  puVar3 = FUN_10041d3e();
  *puVar3 = 0;
  return -1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __lock_fhandle
// 
// Library: Visual Studio 2003 Release

int __cdecl __lock_fhandle(int _Filehandle)

{
  int iVar1;
  int iVar2;
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10055b50;
  uStack_c = 0x1004a2c8;
  iVar1 = (&DAT_10069600)[_Filehandle >> 5] + (_Filehandle & 0x1fU) * 0x24;
  if (*(int *)(iVar1 + 8) == 0) {
    __lock(10);
    local_8 = (undefined *)0x0;
    if (*(int *)(iVar1 + 8) == 0) {
      iVar2 = ___crtInitCritSecAndSpinCount(iVar1 + 0xc,4000);
      if (iVar2 == 0) {
        __local_unwind2((int)local_14,-1);
        return 0;
      }
      *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
    }
    local_8 = (undefined *)0xffffffff;
    FUN_1004a353();
  }
  EnterCriticalSection
            ((LPCRITICAL_SECTION)
             ((&DAT_10069600)[_Filehandle >> 5] + 0xc + (_Filehandle & 0x1fU) * 0x24));
  return 1;
}



void FUN_1004a353(void)

{
  FUN_100425f0(10);
  return;
}



// Library Function - Single Match
//  __unlock_fhandle
// 
// Library: Visual Studio 2003 Release

void __cdecl __unlock_fhandle(int _Filehandle)

{
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((&DAT_10069600)[_Filehandle >> 5] + 0xc + (_Filehandle & 0x1fU) * 0x24));
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __alloc_osfhnd
// 
// Library: Visual Studio 2003 Release

int __cdecl __alloc_osfhnd(void)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int local_20;
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10055b60;
  uStack_c = 0x1004a38a;
  local_20 = -1;
  iVar1 = __mtinitlocknum(0xb);
  if (iVar1 == 0) {
LAB_1004a41f:
    local_20 = -1;
  }
  else {
    __lock(0xb);
    local_8 = (undefined *)0x0;
    for (iVar1 = 0; iVar1 < 0x40; iVar1 = iVar1 + 1) {
      puVar3 = (undefined4 *)(&DAT_10069600)[iVar1];
      if (puVar3 == (undefined4 *)0x0) {
        puVar3 = (undefined4 *)_malloc(0x480);
        if (puVar3 != (undefined4 *)0x0) {
          (&DAT_10069600)[iVar1] = puVar3;
          DAT_100695e4 = DAT_100695e4 + 0x20;
          for (; puVar3 < (undefined4 *)((&DAT_10069600)[iVar1] + 0x480); puVar3 = puVar3 + 9) {
            *(undefined1 *)(puVar3 + 1) = 0;
            *puVar3 = 0xffffffff;
            *(undefined1 *)((int)puVar3 + 5) = 10;
            puVar3[2] = 0;
          }
          local_20 = iVar1 << 5;
          iVar1 = __lock_fhandle(local_20);
          if (iVar1 == 0) {
            local_20 = -1;
          }
        }
        break;
      }
      for (; puVar3 < (undefined4 *)((&DAT_10069600)[iVar1] + 0x480); puVar3 = puVar3 + 9) {
        if ((*(byte *)(puVar3 + 1) & 1) == 0) {
          if (puVar3[2] == 0) {
            __lock(10);
            local_8 = (undefined *)0x1;
            if (puVar3[2] == 0) {
              iVar2 = ___crtInitCritSecAndSpinCount(puVar3 + 3,4000);
              if (iVar2 == 0) {
                __local_unwind2((int)local_14,-1);
                goto LAB_1004a41f;
              }
              puVar3[2] = puVar3[2] + 1;
            }
            local_8 = (undefined *)0x0;
            FUN_1004a457();
          }
          EnterCriticalSection((LPCRITICAL_SECTION)(puVar3 + 3));
          if ((*(byte *)(puVar3 + 1) & 1) == 0) {
            *puVar3 = 0xffffffff;
            local_20 = ((int)puVar3 - (&DAT_10069600)[iVar1]) / 0x24 + iVar1 * 0x20;
            break;
          }
          LeaveCriticalSection((LPCRITICAL_SECTION)(puVar3 + 3));
        }
      }
      if (local_20 != -1) break;
    }
    local_8 = (undefined *)0xffffffff;
    FUN_1004a4f1();
  }
  return local_20;
}



void FUN_1004a457(void)

{
  FUN_100425f0(10);
  return;
}



void FUN_1004a4f1(void)

{
  FUN_100425f0(0xb);
  return;
}



// Library Function - Single Match
//  __tsopen_lk
// 
// Library: Visual Studio 2003 Release

uint __thiscall
__tsopen_lk(void *this,undefined4 *param_1,uint *param_2,LPCSTR param_3,uint param_4,byte param_5)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  int *piVar4;
  ulong *puVar5;
  HANDLE hFile;
  int iVar6;
  DWORD DVar7;
  int iVar8;
  bool bVar9;
  _SECURITY_ATTRIBUTES local_20;
  DWORD local_14;
  DWORD local_10;
  uint local_c;
  char local_6;
  byte local_5;
  
  bVar9 = -1 < (char)param_4;
  local_20.nLength = 0xc;
  local_20.lpSecurityDescriptor = (LPVOID)0x0;
  if (bVar9) {
    local_5 = 0;
  }
  else {
    local_5 = 0x10;
  }
  local_20.bInheritHandle = (BOOL)bVar9;
  if (((param_4 & 0x8000) == 0) && (((param_4 & 0x4000) != 0 || (DAT_1006936c != 0x8000)))) {
    local_5 = local_5 | 0x80;
  }
  uVar3 = param_4 & 3;
  if (uVar3 == 0) {
    local_14 = 0x80000000;
  }
  else if (uVar3 == 1) {
    local_14 = 0x40000000;
  }
  else {
    if (uVar3 != 2) goto LAB_1004a581;
    local_14 = 0xc0000000;
  }
  if (this == (void *)0x10) {
    local_c = 0;
  }
  else if (this == (void *)0x20) {
    local_c = 1;
  }
  else if (this == (void *)0x30) {
    local_c = 2;
  }
  else {
    if (this != (void *)0x40) {
LAB_1004a581:
      piVar4 = FUN_10041d35();
      *piVar4 = 0x16;
      puVar5 = FUN_10041d3e();
      *puVar5 = 0;
      return 0xffffffff;
    }
    local_c = 3;
  }
  uVar3 = param_4 & 0x700;
  if (uVar3 < 0x401) {
    if ((uVar3 == 0x400) || (uVar3 == 0)) {
      local_10 = 3;
    }
    else if (uVar3 == 0x100) {
      local_10 = 4;
    }
    else {
      if (uVar3 == 0x200) goto LAB_1004a628;
      if (uVar3 != 0x300) goto LAB_1004a60e;
      local_10 = 2;
    }
  }
  else {
    if (uVar3 != 0x500) {
      if (uVar3 == 0x600) {
LAB_1004a628:
        local_10 = 5;
        goto LAB_1004a638;
      }
      if (uVar3 != 0x700) {
LAB_1004a60e:
        piVar4 = FUN_10041d35();
        *piVar4 = 0x16;
        puVar5 = FUN_10041d3e();
        *puVar5 = 0;
        return 0xffffffff;
      }
    }
    local_10 = 1;
  }
LAB_1004a638:
  DVar7 = 0x80;
  if (((param_4 & 0x100) != 0) && (-1 < (char)(~(byte)DAT_10069038 & param_5))) {
    DVar7 = 1;
  }
  if ((param_4 & 0x40) != 0) {
    local_14 = CONCAT13(local_14._3_1_,0x10000);
    DVar7 = DVar7 | 0x4000000;
    if (DAT_1006903c == 2) {
      local_c = local_c | 4;
    }
  }
  if ((param_4 & 0x1000) != 0) {
    DVar7 = DVar7 | 0x100;
  }
  if ((param_4 & 0x20) == 0) {
    if ((param_4 & 0x10) != 0) {
      DVar7 = DVar7 | 0x10000000;
    }
  }
  else {
    DVar7 = DVar7 | 0x8000000;
  }
  uVar3 = __alloc_osfhnd();
  if (uVar3 == 0xffffffff) {
    piVar4 = FUN_10041d35();
    *piVar4 = 0x18;
    puVar5 = FUN_10041d3e();
    *puVar5 = 0;
  }
  else {
    *param_1 = 1;
    *param_2 = uVar3;
    hFile = CreateFileA(param_3,local_14,local_c,&local_20,local_10,DVar7,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffff) {
      DVar7 = GetFileType(hFile);
      if (DVar7 != 0) {
        if (DVar7 == 2) {
          local_5 = local_5 | 0x40;
        }
        else if (DVar7 == 3) {
          local_5 = local_5 | 8;
        }
        __set_osfhnd(uVar3,(intptr_t)hFile);
        bVar2 = local_5 | 1;
        iVar8 = (uVar3 & 0x1f) * 0x24;
        local_5 = local_5 & 0x48;
        *(byte *)(iVar8 + 4 + (&DAT_10069600)[(int)uVar3 >> 5]) = bVar2;
        if (((local_5 == 0) && ((char)bVar2 < '\0')) && ((param_4 & 2) != 0)) {
          local_14 = __lseek_lk(uVar3,-1,2);
          if (local_14 == 0xffffffff) {
            puVar5 = FUN_10041d3e();
            if (*puVar5 == 0x83) goto LAB_1004a77a;
          }
          else {
            local_6 = '\0';
            iVar6 = __read_lk(uVar3,&local_6,(char *)0x1);
            if ((((iVar6 != 0) || (local_6 != '\x1a')) ||
                (iVar6 = __chsize_lk(uVar3,local_14), iVar6 != -1)) &&
               (DVar7 = __lseek_lk(uVar3,0,0), DVar7 != 0xffffffff)) goto LAB_1004a77a;
          }
          __close_lk(uVar3);
          return 0xffffffff;
        }
LAB_1004a77a:
        if (local_5 != 0) {
          return uVar3;
        }
        if ((param_4 & 8) == 0) {
          return uVar3;
        }
        pbVar1 = (byte *)(iVar8 + 4 + (&DAT_10069600)[(int)uVar3 >> 5]);
        *pbVar1 = *pbVar1 | 0x20;
        return uVar3;
      }
      CloseHandle(hFile);
    }
    DVar7 = GetLastError();
    __dosmaperr(DVar7);
  }
  return 0xffffffff;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __sopen
// 
// Library: Visual Studio 2003 Release

int __cdecl __sopen(char *_Filename,int _OpenFlag,int _ShareFlag,...)

{
  uint uVar1;
  byte in_stack_00000010;
  uint local_24 [6];
  undefined4 uStack_c;
  undefined4 local_8;
  
  uStack_c = 0x1004a7ed;
  local_24[1] = 0;
  local_8 = 0;
  uVar1 = __tsopen_lk((void *)_ShareFlag,local_24 + 1,local_24,_Filename,_OpenFlag,in_stack_00000010
                     );
  local_8 = 0xffffffff;
  FUN_1004a826();
  return uVar1;
}



void FUN_1004a826(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x1c) != 0) {
    __unlock_fhandle(*(int *)(unaff_EBP + -0x20));
  }
  return;
}



// Library Function - Single Match
//  __lseeki64_lk
// 
// Library: Visual Studio 2003 Release

undefined8 __cdecl __lseeki64_lk(uint param_1,LONG param_2,LONG param_3,DWORD param_4)

{
  byte *pbVar1;
  HANDLE hFile;
  int *piVar2;
  DWORD DVar3;
  DWORD DVar4;
  LONG local_8;
  
  local_8 = param_3;
  hFile = (HANDLE)__get_osfhandle(param_1);
  if (hFile == (HANDLE)0xffffffff) {
    piVar2 = FUN_10041d35();
    *piVar2 = 9;
LAB_1004a890:
    DVar4 = 0xffffffff;
    local_8 = -1;
  }
  else {
    DVar4 = SetFilePointer(hFile,param_2,&local_8,param_4);
    if (DVar4 == 0xffffffff) {
      DVar3 = GetLastError();
      if (DVar3 != 0) {
        __dosmaperr(DVar3);
        goto LAB_1004a890;
      }
    }
    pbVar1 = (byte *)((&DAT_10069600)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
    *pbVar1 = *pbVar1 & 0xfd;
  }
  return CONCAT44(local_8,DVar4);
}



// Library Function - Single Match
//  __ungetc_lk
// 
// Library: Visual Studio 2003 Release

uint __cdecl __ungetc_lk(uint param_1,FILE *param_2)

{
  uint uVar1;
  char *pcVar2;
  
  if (param_1 != 0xffffffff) {
    uVar1 = param_2->_flag;
    if (((uVar1 & 1) != 0) || (((char)uVar1 < '\0' && ((uVar1 & 2) == 0)))) {
      if (param_2->_base == (char *)0x0) {
        __getbuf(param_2);
      }
      if (param_2->_ptr == param_2->_base) {
        if (param_2->_cnt != 0) {
          return 0xffffffff;
        }
        param_2->_ptr = param_2->_ptr + 1;
      }
      param_2->_ptr = param_2->_ptr + -1;
      pcVar2 = param_2->_ptr;
      if ((param_2->_flag & 0x40) == 0) {
        *pcVar2 = (char)param_1;
      }
      else if (*pcVar2 != (char)param_1) {
        param_2->_ptr = pcVar2 + 1;
        return 0xffffffff;
      }
      param_2->_cnt = param_2->_cnt + 1;
      param_2->_flag = param_2->_flag & 0xffffffefU | 1;
      return param_1 & 0xff;
    }
  }
  return 0xffffffff;
}



// Library Function - Single Match
//  ___mbtowc_mt
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl ___mbtowc_mt(int param_1,LPWSTR param_2,byte *param_3,uint param_4)

{
  byte bVar1;
  int iVar2;
  int *piVar3;
  
  if ((param_3 != (byte *)0x0) && (param_4 != 0)) {
    bVar1 = *param_3;
    if (bVar1 != 0) {
      if (*(int *)(param_1 + 0x14) == 0) {
        if (param_2 != (LPWSTR)0x0) {
          *param_2 = (ushort)bVar1;
        }
        return 1;
      }
      if ((*(byte *)(*(int *)(param_1 + 0x48) + 1 + (uint)bVar1 * 2) & 0x80) == 0) {
        iVar2 = MultiByteToWideChar(*(UINT *)(param_1 + 4),9,(LPCSTR)param_3,1,param_2,
                                    (uint)(param_2 != (LPWSTR)0x0));
        if (iVar2 != 0) {
          return 1;
        }
      }
      else {
        iVar2 = *(int *)(param_1 + 0x28);
        if ((((1 < iVar2) && (iVar2 <= (int)param_4)) &&
            (iVar2 = MultiByteToWideChar(*(UINT *)(param_1 + 4),9,(LPCSTR)param_3,iVar2,param_2,
                                         (uint)(param_2 != (LPWSTR)0x0)), iVar2 != 0)) ||
           ((*(uint *)(param_1 + 0x28) <= param_4 && (param_3[1] != 0)))) {
          return *(undefined4 *)(param_1 + 0x28);
        }
      }
      piVar3 = FUN_10041d35();
      *piVar3 = 0x2a;
      return 0xffffffff;
    }
    if (param_2 != (LPWSTR)0x0) {
      *param_2 = L'\0';
    }
  }
  return 0;
}



// Library Function - Single Match
//  _mbtowc
// 
// Library: Visual Studio 2003 Release

int __cdecl _mbtowc(wchar_t *_DstCh,char *_SrcCh,size_t _SrcSizeInBytes)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  int iVar3;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
  }
  iVar3 = ___mbtowc_mt((int)ptVar2,_DstCh,(byte *)_SrcCh,_SrcSizeInBytes);
  return iVar3;
}



// Library Function - Single Match
//  ___strgtold12
// 
// Library: Visual Studio 2003 Release

uint __cdecl
___strgtold12(_LDBL12 *pld12,char **p_end_ptr,char *str,int mult12,int scale,int decpt,
             int implicit_E)

{
  bool bVar1;
  bool bVar2;
  bool bVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  byte bVar7;
  undefined4 uVar8;
  char *pcVar9;
  byte *pbVar10;
  int local_58;
  int local_50;
  byte *local_44;
  int local_40;
  uint local_3c;
  char local_34 [23];
  char local_1d;
  undefined2 local_18;
  undefined2 uStack_16;
  undefined2 uStack_14;
  undefined4 local_12;
  ushort local_e;
  int local_8;
  
  local_8 = DAT_10057438;
  iVar5 = 0;
  pcVar9 = local_34;
  uVar4 = 0;
  local_50 = 1;
  local_3c = 0;
  bVar1 = false;
  bVar3 = false;
  bVar2 = false;
  local_58 = 0;
  local_40 = 0;
  local_44 = (byte *)str;
  for (; (((bVar7 = *str, bVar7 == 0x20 || (bVar7 == 9)) || (bVar7 == 10)) || (bVar7 == 0xd));
      str = (char *)((byte *)str + 1)) {
  }
LAB_1004aa67:
  bVar7 = *str;
  pbVar10 = (byte *)str + 1;
  switch(iVar5) {
  case 0:
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) {
LAB_1004aa84:
      iVar5 = 3;
      goto LAB_1004aca5;
    }
    if (bVar7 == DAT_10057e68) {
LAB_1004aa93:
      iVar5 = 5;
      str = (char *)pbVar10;
      goto LAB_1004aa67;
    }
    if (bVar7 == 0x2b) {
      uVar4 = 0;
      iVar5 = 2;
      str = (char *)pbVar10;
      goto LAB_1004aa67;
    }
    if (bVar7 == 0x2d) {
      iVar5 = 2;
      uVar4 = 0x8000;
      str = (char *)pbVar10;
      goto LAB_1004aa67;
    }
    break;
  case 1:
    iVar5 = 1;
    bVar1 = true;
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1004aa84;
    if (bVar7 == DAT_10057e68) goto LAB_1004aae5;
    if ((bVar7 == 0x2b) || (bVar7 == 0x2d)) goto LAB_1004ab26;
    str = (char *)pbVar10;
    if (bVar7 != 0x30) goto LAB_1004aaff;
    goto LAB_1004aa67;
  case 2:
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1004aa84;
    str = (char *)local_44;
    if (bVar7 == DAT_10057e68) goto LAB_1004aa93;
    break;
  case 3:
    while (iVar5 = _isdigit((uint)bVar7), iVar5 != 0) {
      if (local_3c < 0x19) {
        local_3c = local_3c + 1;
        *pcVar9 = bVar7 - 0x30;
        pcVar9 = pcVar9 + 1;
      }
      else {
        local_40 = local_40 + 1;
      }
      bVar7 = *pbVar10;
      pbVar10 = pbVar10 + 1;
    }
    if (bVar7 != DAT_10057e68) goto LAB_1004abd5;
LAB_1004aae5:
    bVar1 = true;
    iVar5 = 4;
    str = (char *)pbVar10;
    goto LAB_1004aa67;
  case 4:
    bVar3 = true;
    if (local_3c == 0) {
      while (bVar7 == 0x30) {
        local_40 = local_40 + -1;
        bVar7 = *pbVar10;
        pbVar10 = pbVar10 + 1;
      }
    }
    while (iVar5 = _isdigit((uint)bVar7), iVar5 != 0) {
      if (local_3c < 0x19) {
        local_3c = local_3c + 1;
        *pcVar9 = bVar7 - 0x30;
        pcVar9 = pcVar9 + 1;
        local_40 = local_40 + -1;
      }
      bVar7 = *pbVar10;
      pbVar10 = pbVar10 + 1;
    }
LAB_1004abd5:
    if ((bVar7 == 0x2b) || (bVar7 == 0x2d)) {
LAB_1004ab26:
      bVar1 = true;
      iVar5 = 0xb;
      str = (char *)(pbVar10 + -1);
    }
    else {
LAB_1004aaff:
      bVar1 = true;
      if (((char)bVar7 < 'D') ||
         (('E' < (char)bVar7 && (((char)bVar7 < 'd' || ('e' < (char)bVar7)))))) {
LAB_1004ac5f:
        str = (char *)(pbVar10 + -1);
        goto LAB_1004ac63;
      }
      iVar5 = 6;
      str = (char *)pbVar10;
    }
    goto LAB_1004aa67;
  case 5:
    bVar3 = true;
    iVar5 = _isdigit((uint)bVar7);
    str = (char *)local_44;
    if (iVar5 != 0) {
      iVar5 = 4;
      goto LAB_1004aca5;
    }
    goto LAB_1004ac63;
  case 6:
    local_44 = (byte *)str + -1;
    if (((char)bVar7 < '1') || ('9' < (char)bVar7)) {
      if (bVar7 == 0x2b) goto LAB_1004acda;
      if (bVar7 == 0x2d) goto LAB_1004acce;
      str = (char *)local_44;
      if (bVar7 == 0x30) goto LAB_1004ac3d;
      goto LAB_1004ac63;
    }
LAB_1004aca3:
    iVar5 = 9;
LAB_1004aca5:
    str = (char *)(pbVar10 + -1);
    goto LAB_1004aa67;
  case 7:
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1004aca3;
    str = (char *)local_44;
    if (bVar7 != 0x30) goto LAB_1004ac63;
LAB_1004ac3d:
    iVar5 = 8;
    str = (char *)pbVar10;
    goto LAB_1004aa67;
  case 8:
    bVar2 = true;
    while (bVar7 == 0x30) {
      bVar7 = *pbVar10;
      pbVar10 = pbVar10 + 1;
    }
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1004aca3;
    goto LAB_1004ac5f;
  case 9:
    bVar2 = true;
    local_58 = 0;
    goto LAB_1004ad21;
  default:
    goto switchD_1004aa73_caseD_a;
  case 0xb:
    if (implicit_E != 0) {
      local_44 = (byte *)str;
      if (bVar7 == 0x2b) {
LAB_1004acda:
        iVar5 = 7;
        str = (char *)pbVar10;
      }
      else {
        if (bVar7 != 0x2d) goto LAB_1004ac63;
LAB_1004acce:
        local_50 = -1;
        iVar5 = 7;
        str = (char *)pbVar10;
      }
      goto LAB_1004aa67;
    }
    iVar5 = 10;
    pbVar10 = (byte *)str;
switchD_1004aa73_caseD_a:
    str = (char *)pbVar10;
    if (iVar5 != 10) goto LAB_1004aa67;
    goto LAB_1004ac63;
  }
  if (bVar7 != 0x30) goto LAB_1004ac63;
  iVar5 = 1;
  str = (char *)pbVar10;
  goto LAB_1004aa67;
LAB_1004ad21:
  iVar5 = _isdigit((uint)bVar7);
  if (iVar5 == 0) goto LAB_1004ad44;
  local_58 = (char)bVar7 + -0x30 + local_58 * 10;
  if (0x1450 < local_58) {
    local_58 = 0x1451;
    goto LAB_1004ad44;
  }
  bVar7 = *pbVar10;
  pbVar10 = pbVar10 + 1;
  goto LAB_1004ad21;
LAB_1004ad44:
  while( true ) {
    iVar5 = _isdigit((uint)bVar7);
    if (iVar5 == 0) break;
    bVar7 = *pbVar10;
    pbVar10 = pbVar10 + 1;
  }
  str = (char *)(pbVar10 + -1);
LAB_1004ac63:
  *p_end_ptr = str;
  if (bVar1) {
    if (0x18 < local_3c) {
      if ('\x04' < local_1d) {
        local_1d = local_1d + '\x01';
      }
      pcVar9 = pcVar9 + -1;
      local_40 = local_40 + 1;
      local_3c = 0x18;
    }
    if (local_3c != 0) {
      while (pcVar9 = pcVar9 + -1, *pcVar9 == '\0') {
        local_3c = local_3c - 1;
        local_40 = local_40 + 1;
      }
      ___mtold12(local_34,local_3c,(uint *)&local_18);
      if (local_50 < 0) {
        local_58 = -local_58;
      }
      uVar6 = local_58 + local_40;
      if (!bVar2) {
        uVar6 = uVar6 + scale;
      }
      if (!bVar3) {
        uVar6 = uVar6 - decpt;
      }
      if (0x1450 < (int)uVar6) {
        uVar8 = 0;
        local_e = 0x7fff;
        local_12 = 0x80000000;
        local_18 = 0;
        goto LAB_1004adf1;
      }
      if (-0x1451 < (int)uVar6) {
        ___multtenpow12((int *)&local_18,uVar6,mult12);
        uVar8 = CONCAT22(uStack_14,uStack_16);
        goto LAB_1004adf1;
      }
    }
  }
  local_18 = 0;
  local_e = 0;
  local_12 = 0;
  uVar8 = 0;
LAB_1004adf1:
  *(undefined4 *)(pld12->ld12 + 6) = local_12;
  *(undefined4 *)(pld12->ld12 + 2) = uVar8;
  *(ushort *)(pld12->ld12 + 10) = local_e | uVar4;
  *(undefined2 *)pld12->ld12 = local_18;
  uVar6 = FUN_1003fb09(local_8);
  return uVar6;
}



// Library Function - Single Match
//  ___addl
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl ___addl(uint param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  undefined4 uVar2;
  
  uVar1 = param_1 + param_2;
  uVar2 = 0;
  if ((uVar1 < param_1) || (uVar1 < param_2)) {
    uVar2 = 1;
  }
  *param_3 = uVar1;
  return uVar2;
}



// Library Function - Single Match
//  ___add_12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___add_12(uint *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = ___addl(*param_1,*param_2,param_1);
  if (iVar1 != 0) {
    iVar1 = ___addl(param_1[1],1,param_1 + 1);
    if (iVar1 != 0) {
      param_1[2] = param_1[2] + 1;
    }
  }
  iVar1 = ___addl(param_1[1],param_2[1],param_1 + 1);
  if (iVar1 != 0) {
    param_1[2] = param_1[2] + 1;
  }
  ___addl(param_1[2],param_2[2],param_1 + 2);
  return;
}



// Library Function - Single Match
//  ___shl_12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___shl_12(uint *param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *param_1;
  uVar2 = param_1[1];
  *param_1 = uVar1 * 2;
  param_1[1] = uVar2 * 2 | uVar1 >> 0x1f;
  param_1[2] = param_1[2] << 1 | uVar2 >> 0x1f;
  return;
}



// Library Function - Single Match
//  ___shr_12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___shr_12(uint *param_1)

{
  uint uVar1;
  
  uVar1 = param_1[1];
  param_1[1] = uVar1 >> 1 | param_1[2] << 0x1f;
  param_1[2] = param_1[2] >> 1;
  *param_1 = *param_1 >> 1 | uVar1 << 0x1f;
  return;
}



// Library Function - Single Match
//  ___mtold12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___mtold12(char *param_1,int param_2,uint *param_3)

{
  short sVar1;
  uint *puVar2;
  uint uVar3;
  uint local_14;
  uint local_10;
  uint local_c;
  int local_8;
  
  puVar2 = param_3;
  local_8 = DAT_10057438;
  sVar1 = 0x404e;
  *param_3 = 0;
  param_3[1] = 0;
  param_3[2] = 0;
  if (param_2 != 0) {
    param_3 = (uint *)param_2;
    do {
      local_14 = *puVar2;
      local_10 = puVar2[1];
      local_c = puVar2[2];
      ___shl_12(puVar2);
      ___shl_12(puVar2);
      ___add_12(puVar2,&local_14);
      ___shl_12(puVar2);
      local_14 = (uint)*param_1;
      local_10 = 0;
      local_c = 0;
      ___add_12(puVar2,&local_14);
      param_1 = param_1 + 1;
      param_3 = (uint *)((int)param_3 + -1);
    } while (param_3 != (uint *)0x0);
  }
  if (puVar2[2] == 0) {
    do {
      sVar1 = sVar1 + -0x10;
      uVar3 = puVar2[1] >> 0x10;
      puVar2[1] = *puVar2 >> 0x10 | puVar2[1] << 0x10;
      *puVar2 = *puVar2 << 0x10;
    } while (uVar3 == 0);
    puVar2[2] = uVar3;
  }
  while ((puVar2[2] & 0x8000) == 0) {
    ___shl_12(puVar2);
    sVar1 = sVar1 + -1;
  }
  *(short *)((int)puVar2 + 10) = sVar1;
  FUN_1003fb09(local_8);
  return;
}



// Library Function - Single Match
//  _$I10_OUTPUT
// 
// Library: Visual Studio 2003 Release

void __cdecl
_I10_OUTPUT(int param_1,uint param_2,uint param_3,int param_4,byte param_5,short *param_6)

{
  short *psVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  short *psVar5;
  short sVar6;
  int iVar7;
  char *pcVar8;
  short *local_34;
  uint local_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined1 local_20;
  undefined1 local_1f;
  undefined1 local_1e;
  undefined1 local_1d;
  undefined1 local_1c;
  undefined1 local_1b;
  undefined1 local_1a;
  undefined1 local_19;
  undefined1 local_18;
  undefined1 local_17;
  undefined1 local_16;
  undefined1 local_15;
  undefined2 local_14;
  undefined4 local_12;
  undefined4 local_e;
  undefined1 local_a;
  char cStack_9;
  int local_8;
  
  local_8 = DAT_10057438;
  uVar3 = param_3 & 0x7fff;
  local_20 = 0xcc;
  local_1f = 0xcc;
  local_1e = 0xcc;
  local_1d = 0xcc;
  local_1c = 0xcc;
  local_1b = 0xcc;
  local_1a = 0xcc;
  local_19 = 0xcc;
  local_18 = 0xcc;
  local_17 = 0xcc;
  local_16 = 0xfb;
  local_15 = 0x3f;
  if ((param_3 & 0x8000) == 0) {
    *(undefined1 *)(param_6 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_6 + 1) = 0x2d;
  }
  if ((((short)uVar3 == 0) && (param_2 == 0)) && (param_1 == 0)) {
LAB_1004b172:
    *(undefined1 *)(param_6 + 2) = 0x30;
LAB_1004b275:
    *param_6 = 0;
    *(undefined1 *)(param_6 + 1) = 0x20;
    *(undefined1 *)((int)param_6 + 3) = 1;
    *(undefined1 *)((int)param_6 + 5) = 0;
  }
  else {
    if ((short)uVar3 == 0x7fff) {
      *param_6 = 1;
      if (((param_2 == 0x80000000) && (param_1 == 0)) || ((param_2 & 0x40000000) != 0)) {
        if (((param_3 & 0x8000) == 0) || (param_2 != 0xc0000000)) {
          if ((param_2 != 0x80000000) || (param_1 != 0)) goto LAB_1004b0e8;
          pcVar8 = "1#INF";
        }
        else {
          if (param_1 != 0) {
LAB_1004b0e8:
            pcVar8 = "1#QNAN";
            goto LAB_1004b0ed;
          }
          pcVar8 = "1#IND";
        }
        FUN_10048310((uint *)(param_6 + 2),(uint *)pcVar8);
        *(undefined1 *)((int)param_6 + 3) = 5;
      }
      else {
        pcVar8 = "1#SNAN";
LAB_1004b0ed:
        FUN_10048310((uint *)(param_6 + 2),(uint *)pcVar8);
        *(undefined1 *)((int)param_6 + 3) = 6;
      }
      goto LAB_1004b257;
    }
    local_14 = 0;
    sVar6 = (short)(((uVar3 >> 8) + (param_2 >> 0x18) * 2) * 0x4d + -0x134312f4 + uVar3 * 0x4d10 >>
                   0x10);
    local_a = (undefined1)uVar3;
    cStack_9 = (char)(uVar3 >> 8);
    local_12 = param_1;
    local_e = param_2;
    ___multtenpow12((int *)&local_14,-(int)sVar6,1);
    if (0x3ffe < CONCAT11(cStack_9,local_a)) {
      sVar6 = sVar6 + 1;
      ___ld12mul((int *)&local_14,(int *)&local_20);
    }
    *param_6 = sVar6;
    if (((param_5 & 1) != 0) && (param_4 = param_4 + sVar6, param_4 < 1)) goto LAB_1004b172;
    if (0x15 < param_4) {
      param_4 = 0x15;
    }
    iVar7 = CONCAT11(cStack_9,local_a) - 0x3ffe;
    local_a = 0;
    cStack_9 = '\0';
    param_3 = 8;
    do {
      ___shl_12((uint *)&local_14);
      param_3 = param_3 - 1;
    } while (param_3 != 0);
    if (iVar7 < 0) {
      for (uVar3 = -iVar7 & 0xff; uVar3 != 0; uVar3 = uVar3 - 1) {
        ___shr_12((uint *)&local_14);
      }
    }
    param_3 = param_4 + 1;
    psVar4 = param_6 + 2;
    local_34 = psVar4;
    iVar7 = local_12;
    uVar3 = local_e;
    if (0 < (int)param_3) {
      do {
        local_e._2_2_ = (undefined2)(uVar3 >> 0x10);
        local_e._0_2_ = (undefined2)uVar3;
        local_12._2_2_ = (undefined2)((uint)iVar7 >> 0x10);
        local_12._0_2_ = (undefined2)iVar7;
        local_2c = CONCAT22((undefined2)local_12,local_14);
        uStack_28 = CONCAT22((undefined2)local_e,local_12._2_2_);
        uStack_24 = CONCAT13(cStack_9,CONCAT12(local_a,local_e._2_2_));
        local_12 = iVar7;
        local_e = uVar3;
        ___shl_12((uint *)&local_14);
        ___shl_12((uint *)&local_14);
        ___add_12((uint *)&local_14,&local_2c);
        ___shl_12((uint *)&local_14);
        psVar4 = (short *)((int)local_34 + 1);
        param_3 = param_3 - 1;
        *(char *)local_34 = cStack_9 + '0';
        cStack_9 = '\0';
        local_34 = psVar4;
        iVar7 = local_12;
        uVar3 = local_e;
      } while (param_3 != 0);
    }
    psVar5 = psVar4 + -1;
    psVar1 = param_6 + 2;
    if (*(char *)((int)psVar4 + -1) < '5') {
      for (; (psVar1 <= psVar5 && ((char)*psVar5 == '0')); psVar5 = (short *)((int)psVar5 + -1)) {
      }
      if (psVar5 < psVar1) {
        *(char *)psVar1 = '0';
        goto LAB_1004b275;
      }
    }
    else {
      for (; (psVar1 <= psVar5 && ((char)*psVar5 == '9')); psVar5 = (short *)((int)psVar5 + -1)) {
        *(char *)psVar5 = '0';
      }
      if (psVar5 < psVar1) {
        psVar5 = (short *)((int)psVar5 + 1);
        *param_6 = *param_6 + 1;
      }
      *(char *)psVar5 = (char)*psVar5 + '\x01';
    }
    cVar2 = ((char)psVar5 - (char)param_6) + -3;
    *(char *)((int)param_6 + 3) = cVar2;
    *(undefined1 *)(cVar2 + 4 + (int)param_6) = 0;
  }
LAB_1004b257:
  FUN_1003fb09(local_8);
  return;
}



// Library Function - Single Match
//  _siglookup
// 
// Library: Visual Studio 2003 Release

void __cdecl siglookup(void)

{
  uint uVar1;
  uint in_EDX;
  int unaff_ESI;
  
  uVar1 = in_EDX;
  do {
    if (*(int *)(uVar1 + 4) == unaff_ESI) {
      return;
    }
    uVar1 = uVar1 + 0xc;
  } while (uVar1 < in_EDX + DAT_10057a4c * 0xc);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _raise
// 
// Library: Visual Studio 2003 Release

int __cdecl _raise(int _SigNum)

{
  bool bVar1;
  int iVar2;
  undefined4 *puVar3;
  code *pcVar4;
  void *local_34;
  void *local_30;
  _ptiddata local_28;
  
  bVar1 = false;
  if (_SigNum == 2) {
    puVar3 = &DAT_10069350;
    pcVar4 = DAT_10069350;
LAB_1004b345:
    bVar1 = true;
  }
  else {
    if (((_SigNum != 4) && (_SigNum != 8)) && (_SigNum != 0xb)) {
      if (_SigNum == 0xf) {
        puVar3 = &DAT_1006935c;
        pcVar4 = DAT_1006935c;
      }
      else if (_SigNum == 0x15) {
        puVar3 = &DAT_10069354;
        pcVar4 = DAT_10069354;
      }
      else {
        if (_SigNum != 0x16) {
          return -1;
        }
        puVar3 = &DAT_10069358;
        pcVar4 = DAT_10069358;
      }
      goto LAB_1004b345;
    }
    local_28 = __getptd();
    iVar2 = siglookup();
    puVar3 = (undefined4 *)(iVar2 + 8);
    pcVar4 = (code *)*puVar3;
  }
  if (pcVar4 == (code *)0x1) {
    return 0;
  }
  if (pcVar4 == (code *)0x0) {
                    // WARNING: Subroutine does not return
    __exit(3);
  }
  if (bVar1) {
    __lock(0);
  }
  if (((_SigNum == 8) || (_SigNum == 0xb)) || (_SigNum == 4)) {
    local_30 = local_28->_initarg;
    local_28->_initarg = (void *)0x0;
    if (_SigNum == 8) {
      local_34 = local_28->_pxcptacttab;
      local_28->_pxcptacttab = (void *)0x8c;
      goto LAB_1004b3a4;
    }
  }
  else {
LAB_1004b3a4:
    iVar2 = DAT_10057a40;
    if (_SigNum == 8) {
      for (; iVar2 < DAT_10057a44 + DAT_10057a40; iVar2 = iVar2 + 1) {
        *(undefined4 *)((int)local_28->_initaddr + iVar2 * 0xc + 8) = 0;
      }
      goto LAB_1004b3d2;
    }
  }
  *puVar3 = 0;
LAB_1004b3d2:
  FUN_1004b3f3(0);
  if (_SigNum == 8) {
    (*pcVar4)(8,local_28->_pxcptacttab);
  }
  else {
    (*pcVar4)(_SigNum);
    if ((_SigNum != 0xb) && (_SigNum != 4)) {
      return 0;
    }
  }
  local_28->_initarg = local_30;
  if (_SigNum == 8) {
    local_28->_pxcptacttab = local_34;
  }
  return 0;
}



void __fastcall FUN_1004b3f3(int param_1)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x1c) != param_1) {
    FUN_100425f0(param_1);
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __msize
// 
// Library: Visual Studio 2003 Release

size_t __cdecl __msize(void *_Memory)

{
  uint uVar1;
  SIZE_T SVar2;
  size_t local_20;
  
  if (DAT_100695e0 == 3) {
    __lock(4);
    uVar1 = ___sbh_find_block((int)_Memory);
    if (uVar1 != 0) {
      local_20 = *(int *)((int)_Memory + -4) - 9;
    }
    FUN_1004b49e();
    if (uVar1 != 0) {
      return local_20;
    }
  }
  SVar2 = HeapSize(DAT_100695dc,0,_Memory);
  return SVar2;
}



void FUN_1004b49e(void)

{
  FUN_100425f0(4);
  return;
}



// Library Function - Single Match
//  __mbsnbicoll
// 
// Library: Visual Studio 2003 Release

int __cdecl __mbsnbicoll(uchar *_Str1,uchar *_Str2,size_t _MaxCount)

{
  _ptiddata p_Var1;
  pthreadmbcinfo ptVar2;
  int iVar3;
  int unaff_EBP;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadmbcinfo)p_Var1->_tpxcptinfoptrs;
  if (ptVar2 != DAT_1006938c) {
    ptVar2 = ___updatetmbcinfo();
  }
  if (_MaxCount == 0) {
    return 0;
  }
  iVar3 = ___crtCompareStringA
                    (*(_locale_t *)ptVar2->mbulinfo,(LPCWSTR)0x1,(DWORD)_Str1,(LPCSTR)_MaxCount,
                     (int)_Str2,(LPCSTR)_MaxCount,ptVar2->mbcodepage,unaff_EBP);
  if (iVar3 == 0) {
    return 0x7fffffff;
  }
  return iVar3 + -2;
}



// Library Function - Single Match
//  ___wtomb_environ
// 
// Library: Visual Studio 2003 Release

int __cdecl ___wtomb_environ(void)

{
  LPCWSTR lpWideCharStr;
  size_t _Size;
  int iVar1;
  undefined4 *puVar2;
  char *local_8;
  
  local_8 = (LPSTR)0x0;
  lpWideCharStr = (LPCWSTR)*DAT_10069064;
  puVar2 = DAT_10069064;
  while( true ) {
    if (lpWideCharStr == (LPCWSTR)0x0) {
      return 0;
    }
    _Size = WideCharToMultiByte(0,0,lpWideCharStr,-1,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
    if ((_Size == 0) || (local_8 = (char *)_malloc(_Size), local_8 == (LPSTR)0x0)) break;
    iVar1 = WideCharToMultiByte(0,0,(LPCWSTR)*puVar2,-1,local_8,_Size,(LPCSTR)0x0,(LPBOOL)0x0);
    if (iVar1 == 0) {
      _free(local_8);
      return -1;
    }
    iVar1 = ___crtsetenv(&local_8,0);
    if ((iVar1 < 0) && (local_8 != (LPSTR)0x0)) {
      _free(local_8);
      local_8 = (LPSTR)0x0;
    }
    puVar2 = puVar2 + 1;
    lpWideCharStr = (LPCWSTR)*puVar2;
  }
  return -1;
}



// Library Function - Single Match
//  ___ascii_stricmp
// 
// Library: Visual Studio 2003 Release

int __cdecl ___ascii_stricmp(char *_Str1,char *_Str2)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  
  bVar3 = 0xff;
  do {
    do {
      if (bVar3 == 0) goto LAB_1004b5d6;
      bVar3 = *_Str2;
      _Str2 = (char *)((byte *)_Str2 + 1);
      bVar2 = *_Str1;
      _Str1 = (char *)((byte *)_Str1 + 1);
    } while (bVar2 == bVar3);
    bVar1 = bVar3 + 0xbf + (-((byte)(bVar3 + 0xbf) < 0x1a) & 0x20U) + 0x41;
    bVar2 = bVar2 + 0xbf;
    bVar3 = bVar2 + (-(bVar2 < 0x1a) & 0x20U) + 0x41;
  } while (bVar3 == bVar1);
  bVar3 = (bVar3 < bVar1) * -2 + 1;
LAB_1004b5d6:
  return (int)(char)bVar3;
}



// Library Function - Single Match
//  __stricmp
// 
// Library: Visual Studio 2003 Release

int __cdecl __stricmp(char *_Str1,char *_Str2)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  int iVar3;
  void *pvVar4;
  void *this;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this_00;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10057c5c) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (ptVar2->lc_category[0].wlocale == (wchar_t *)0x0) {
    iVar3 = ___ascii_stricmp(_Str1,_Str2);
  }
  else {
    do {
      pvVar4 = (void *)___tolower_mt(this,(int)ptVar2,(uint)(byte)*_Str1);
      _Str1 = (char *)((byte *)_Str1 + 1);
      this = (void *)___tolower_mt(this_00,(int)ptVar2,(uint)(byte)*_Str2);
      _Str2 = (char *)((byte *)_Str2 + 1);
      if (pvVar4 == (void *)0x0) break;
    } while (pvVar4 == this);
    iVar3 = (int)pvVar4 - (int)this;
  }
  return iVar3;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// Library Function - Single Match
//  __chsize_lk
// 
// Library: Visual Studio 2003 Release

void __cdecl __chsize_lk(uint param_1,int param_2)

{
  DWORD DVar1;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  ulong *puVar6;
  int *piVar7;
  HANDLE hFile;
  BOOL BVar8;
  uint uVar9;
  char local_1008 [4096];
  int local_8;
  
  local_8 = DAT_10057438;
  DVar1 = __lseek_lk(param_1,0,1);
  if ((DVar1 != 0xffffffff) && (DVar2 = __lseek_lk(param_1,0,2), DVar2 != 0xffffffff)) {
    uVar9 = param_2 - DVar2;
    if ((int)uVar9 < 1) {
      if ((int)uVar9 < 0) {
        __lseek_lk(param_1,param_2,0);
        hFile = (HANDLE)__get_osfhandle(param_1);
        BVar8 = SetEndOfFile(hFile);
        if (BVar8 == 0) {
          piVar7 = FUN_10041d35();
          *piVar7 = 0xd;
          puVar6 = FUN_10041d3e();
          DVar2 = GetLastError();
          *puVar6 = DVar2;
        }
      }
    }
    else {
      _memset(local_1008,0,0x1000);
      iVar3 = __setmode_lk(param_1,0x8000);
      do {
        uVar4 = 0x1000;
        if ((int)uVar9 < 0x1000) {
          uVar4 = uVar9;
        }
        iVar5 = __write_lk(param_1,local_1008,uVar4);
        if (iVar5 == -1) {
          puVar6 = FUN_10041d3e();
          if (*puVar6 == 5) {
            piVar7 = FUN_10041d35();
            *piVar7 = 0xd;
          }
          break;
        }
        uVar9 = uVar9 - iVar5;
      } while (0 < (int)uVar9);
      __setmode_lk(param_1,iVar3);
    }
    __lseek_lk(param_1,DVar1,0);
  }
  FUN_1003fb09(local_8);
  return;
}



// Library Function - Single Match
//  ___ld12mul
// 
// Library: Visual Studio 2003 Release

void __cdecl ___ld12mul(int *param_1,int *param_2)

{
  int *piVar1;
  short sVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  ushort uVar6;
  uint uVar7;
  int iVar8;
  ushort uVar9;
  uint uVar10;
  ushort uVar11;
  int *local_2c;
  ushort *local_28;
  ushort *local_24;
  int local_20;
  int local_1c;
  short *local_18;
  byte local_14;
  undefined1 uStack_13;
  undefined4 uStack_12;
  undefined4 uStack_e;
  undefined2 uStack_a;
  int local_8;
  
  piVar5 = param_2;
  piVar4 = param_1;
  local_8 = DAT_10057438;
  local_20 = 0;
  local_14 = 0;
  uStack_13 = 0;
  uStack_12._0_2_ = 0;
  uStack_12._2_2_ = 0;
  uStack_e._0_2_ = 0;
  uStack_e._2_2_ = 0;
  uStack_a._0_1_ = 0;
  uStack_a._1_1_ = 0;
  uVar10 = *(ushort *)((int)param_2 + 10) & 0x7fff;
  uVar7 = *(ushort *)((int)param_1 + 10) & 0x7fff;
  uVar11 = (*(ushort *)((int)param_2 + 10) ^ *(ushort *)((int)param_1 + 10)) & 0x8000;
  uVar6 = (ushort)uVar7;
  piVar1 = (int *)(uVar10 + uVar7);
  iVar8 = 0;
  iVar3 = 0;
  sVar2 = 0;
  if (((uVar6 < 0x7fff) && (uVar9 = (ushort)uVar10, iVar8 = 0, iVar3 = 0, sVar2 = 0, uVar9 < 0x7fff)
      ) && (iVar8 = 0, iVar3 = 0, sVar2 = 0, (ushort)piVar1 < 0xbffe)) {
    if ((ushort)piVar1 < 0x3fc0) {
LAB_1004b835:
      piVar4[2] = 0;
      piVar4[1] = 0;
      *piVar4 = 0;
      iVar8 = 0;
      iVar3 = 0;
      sVar2 = 0;
      goto LAB_1004b9ad;
    }
    if (uVar6 == 0) {
      piVar1 = (int *)((int)piVar1 + 1);
      uVar6 = 0;
      if ((((param_1[2] & 0x7fffffffU) != 0) || (param_1[1] != 0)) ||
         (iVar8 = 0, iVar3 = 0, sVar2 = 0, *param_1 != 0)) goto LAB_1004b81f;
    }
    else {
LAB_1004b81f:
      param_1 = piVar1;
      if (((uVar9 == 0) && (param_1 = (int *)((int)param_1 + 1), (param_2[2] & 0x7fffffffU) == 0))
         && ((param_2[1] == 0 && (*param_2 == 0)))) goto LAB_1004b835;
      local_1c = 0;
      local_18 = (short *)((int)&uStack_12 + 2);
      param_2 = (int *)0x5;
      do {
        if (0 < (int)param_2) {
          local_28 = (ushort *)(local_1c * 2 + (int)piVar4);
          local_24 = (ushort *)(piVar5 + 2);
          local_2c = param_2;
          do {
            iVar8 = ___addl(*(uint *)(local_18 + -2),(uint)*local_24 * (uint)*local_28,
                            (uint *)(local_18 + -2));
            if (iVar8 != 0) {
              *local_18 = *local_18 + 1;
            }
            local_28 = local_28 + 1;
            local_24 = local_24 + -1;
            local_2c = (int *)((int)local_2c + -1);
          } while (local_2c != (int *)0x0);
        }
        local_18 = local_18 + 1;
        local_1c = local_1c + 1;
        param_2 = (int *)((int)param_2 + -1);
      } while (0 < (int)param_2);
      param_1 = (int *)((int)param_1 + 0xc002);
      if ((short)(ushort)param_1 < 1) {
LAB_1004b8e9:
        iVar8 = (int)param_1 + 0xffff;
        param_1._0_2_ = (ushort)iVar8;
        if ((short)(ushort)param_1 < 0) {
          uVar7 = -iVar8;
          uVar10 = uVar7 & 0xffff;
          param_1._0_2_ = (ushort)param_1 + (short)uVar7;
          do {
            if ((local_14 & 1) != 0) {
              local_20 = local_20 + 1;
            }
            ___shr_12((uint *)&local_14);
            uVar10 = uVar10 - 1;
          } while (uVar10 != 0);
          if (local_20 != 0) {
            local_14 = local_14 | 1;
          }
        }
      }
      else {
        do {
          if ((uStack_a._1_1_ & 0x80) != 0) break;
          ___shl_12((uint *)&local_14);
          param_1 = (int *)((int)param_1 + 0xffff);
        } while (0 < (short)(ushort)param_1);
        if ((short)(ushort)param_1 < 1) goto LAB_1004b8e9;
      }
      if ((0x8000 < CONCAT11(uStack_13,local_14)) ||
         (sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a),
         iVar3 = CONCAT22(uStack_e._2_2_,(undefined2)uStack_e),
         iVar8 = CONCAT22(uStack_12._2_2_,(undefined2)uStack_12),
         (CONCAT22((undefined2)uStack_12,CONCAT11(uStack_13,local_14)) & 0x1ffff) == 0x18000)) {
        if (CONCAT22(uStack_12._2_2_,(undefined2)uStack_12) == -1) {
          iVar8 = 0;
          if (CONCAT22(uStack_e._2_2_,(undefined2)uStack_e) == -1) {
            if (CONCAT11(uStack_a._1_1_,(undefined1)uStack_a) == -1) {
              param_1._0_2_ = (ushort)param_1 + 1;
              sVar2 = -0x8000;
              iVar3 = 0;
              iVar8 = 0;
            }
            else {
              sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a) + 1;
              iVar3 = 0;
              iVar8 = 0;
            }
          }
          else {
            sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a);
            iVar3 = CONCAT22(uStack_e._2_2_,(undefined2)uStack_e) + 1;
          }
        }
        else {
          iVar8 = CONCAT22(uStack_12._2_2_,(undefined2)uStack_12) + 1;
          sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a);
          iVar3 = CONCAT22(uStack_e._2_2_,(undefined2)uStack_e);
        }
      }
      uStack_12._2_2_ = (undefined2)((uint)iVar8 >> 0x10);
      uStack_12._0_2_ = (undefined2)iVar8;
      uStack_e._2_2_ = (undefined2)((uint)iVar3 >> 0x10);
      uStack_e._0_2_ = (undefined2)iVar3;
      uStack_a._1_1_ = (byte)((ushort)sVar2 >> 8);
      uStack_a._0_1_ = (undefined1)sVar2;
      if (0x7ffe < (ushort)param_1) goto LAB_1004b992;
      *(undefined2 *)piVar4 = (undefined2)uStack_12;
      *(uint *)((int)piVar4 + 2) = CONCAT22((undefined2)uStack_e,uStack_12._2_2_);
      *(uint *)((int)piVar4 + 6) =
           CONCAT13(uStack_a._1_1_,CONCAT12((undefined1)uStack_a,uStack_e._2_2_));
      uVar6 = (ushort)param_1 | uVar11;
    }
    *(ushort *)((int)piVar4 + 10) = uVar6;
  }
  else {
LAB_1004b992:
    piVar4[1] = 0;
    *piVar4 = 0;
    piVar4[2] = (-(uint)(uVar11 != 0) & 0x80000000) + 0x7fff8000;
  }
LAB_1004b9ad:
  uStack_12 = iVar8;
  uStack_e = iVar3;
  uStack_a = sVar2;
  FUN_1003fb09(local_8);
  return;
}



// Library Function - Single Match
//  ___multtenpow12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___multtenpow12(int *param_1,uint param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  undefined **ppuVar3;
  undefined **ppuVar4;
  undefined2 local_14;
  undefined4 local_12;
  undefined2 uStack_e;
  undefined *puStack_c;
  int local_8;
  
  local_8 = DAT_10057438;
  ppuVar3 = &PTR_s_November_10058030;
  if (param_2 != 0) {
    if ((int)param_2 < 0) {
      param_2 = -param_2;
      ppuVar3 = (undefined **)0x10058190;
    }
    if (param_3 == 0) {
      *(undefined2 *)param_1 = 0;
    }
    while (param_2 != 0) {
      uVar1 = (int)param_2 >> 3;
      uVar2 = param_2 & 7;
      ppuVar3 = ppuVar3 + 0x15;
      param_2 = uVar1;
      if (uVar2 != 0) {
        ppuVar4 = ppuVar3 + uVar2 * 3;
        if (0x7fff < *(ushort *)ppuVar4) {
          local_14 = SUB42(*ppuVar4,0);
          local_12._0_2_ = (undefined2)((uint)*ppuVar4 >> 0x10);
          local_12._2_2_ = SUB42(ppuVar4[1],0);
          uStack_e = (undefined2)((uint)ppuVar4[1] >> 0x10);
          puStack_c = ppuVar4[2];
          local_12 = CONCAT22(local_12._2_2_,(undefined2)local_12) + -1;
          ppuVar4 = (undefined **)&local_14;
        }
        ___ld12mul(param_1,(int *)ppuVar4);
      }
    }
  }
  FUN_1003fb09(local_8);
  return;
}



// Library Function - Single Match
//  _strncnt
// 
// Library: Visual Studio 2003 Release

size_t __cdecl _strncnt(char *_String,size_t _Cnt)

{
  char *in_EAX;
  char *pcVar1;
  
  pcVar1 = _String;
  if (_String != (char *)0x0) {
    do {
      pcVar1 = pcVar1 + -1;
      if (*in_EAX == '\0') goto LAB_1004ba54;
      in_EAX = in_EAX + 1;
    } while (pcVar1 != (char *)0x0);
  }
  pcVar1 = pcVar1 + -1;
LAB_1004ba54:
  return (size_t)(_String + (-1 - (int)pcVar1));
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Unable to track spacebase fully for stack
// WARNING: This function may have set the stack pointer
// Library Function - Single Match
//  ___crtCompareStringA
// 
// Library: Visual Studio 2003 Release

int __cdecl
___crtCompareStringA
          (_locale_t _Plocinfo,LPCWSTR _LocaleName,DWORD _DwCmpFlags,LPCSTR _LpString1,
          int _CchCount1,LPCSTR _LpString2,int _CchCount2,int _Code_page)

{
  bool bVar1;
  bool bVar2;
  void *pvVar3;
  int iVar4;
  DWORD DVar5;
  BOOL BVar6;
  BYTE *pBVar7;
  undefined1 *puVar8;
  undefined1 *puVar9;
  int iVar10;
  undefined1 *puVar11;
  undefined1 *puVar12;
  int iVar13;
  UINT UVar14;
  UINT UVar15;
  undefined1 *puVar16;
  undefined1 *puVar17;
  undefined1 *puVar18;
  size_t unaff_EDI;
  void *_Memory;
  undefined4 uStackY_7c;
  void *local_3c;
  _cpinfo local_34;
  int local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10055bc8;
  uStack_c = 0x1004ba68;
  local_20 = DAT_10057438;
  _Memory = (void *)0x0;
  if (DAT_10069370 == 0) {
    uStackY_7c = 0x1004ba8e;
    iVar4 = CompareStringW(0,0,L"",1,L"",1);
    if (iVar4 == 0) {
      DVar5 = GetLastError();
      if (DVar5 == 0x78) {
        DAT_10069370 = 2;
      }
    }
    else {
      DAT_10069370 = 1;
    }
  }
  if (0 < (int)_LpString1) {
    _LpString1 = (LPCSTR)_strncnt(_LpString1,unaff_EDI);
  }
  if (0 < (int)_LpString2) {
    _LpString2 = (LPCSTR)_strncnt(_LpString2,unaff_EDI);
  }
  if ((DAT_10069370 == 2) || (DAT_10069370 == 0)) {
    local_3c = (void *)0x0;
    if (_Plocinfo == (_locale_t)0x0) {
      _Plocinfo = DAT_100692dc;
    }
    UVar15 = _CchCount2;
    if (_CchCount2 == 0) {
      UVar15 = DAT_100692ec;
    }
    UVar14 = ___ansicp((LCID)_Plocinfo);
    if (UVar14 == 0xffffffff) goto LAB_1004bdcf;
    pvVar3 = (void *)_CchCount1;
    if (UVar14 != UVar15) {
      uStackY_7c = 0x1004bd68;
      _Memory = (void *)___convertcp(UVar15,UVar14,(char *)_DwCmpFlags,(size_t *)&_LpString1,
                                     (LPSTR)0x0,0);
      if (_Memory == (void *)0x0) goto LAB_1004bdcf;
      uStackY_7c = 0x1004bd83;
      local_3c = (void *)___convertcp(UVar15,UVar14,(char *)_CchCount1,(size_t *)&_LpString2,
                                      (LPSTR)0x0,0);
      _DwCmpFlags = (DWORD)_Memory;
      pvVar3 = local_3c;
      if (local_3c == (void *)0x0) {
        _free(_Memory);
        goto LAB_1004bdcf;
      }
    }
    _CchCount1 = (int)pvVar3;
    uStackY_7c = 0x1004bdb7;
    CompareStringA((LCID)_Plocinfo,(DWORD)_LocaleName,(PCNZCH)_DwCmpFlags,(int)_LpString1,
                   (PCNZCH)_CchCount1,(int)_LpString2);
    if (_Memory != (void *)0x0) {
      _free(_Memory);
      _free(local_3c);
    }
    goto LAB_1004bdcf;
  }
  if (DAT_10069370 != 1) goto LAB_1004bdcf;
  bVar2 = false;
  bVar1 = false;
  if (_CchCount2 == 0) {
    _CchCount2 = DAT_100692ec;
  }
  if ((_LpString1 == (LPCSTR)0x0) || (_LpString2 == (LPCSTR)0x0)) {
    if ((_LpString1 == _LpString2) ||
       (((1 < (int)_LpString2 || (1 < (int)_LpString1)) ||
        (BVar6 = GetCPInfo(_CchCount2,&local_34), BVar6 == 0)))) goto LAB_1004bdcf;
    if (0 < (int)_LpString1) {
      if (1 < local_34.MaxCharSize) {
        pBVar7 = local_34.LeadByte;
        while (((local_34.LeadByte[0] != 0 && (pBVar7[1] != 0)) &&
               ((*(byte *)_DwCmpFlags < *pBVar7 || (pBVar7[1] < *(byte *)_DwCmpFlags))))) {
          pBVar7 = pBVar7 + 2;
          local_34.LeadByte[0] = *pBVar7;
        }
      }
      goto LAB_1004bdcf;
    }
    if (0 < (int)_LpString2) {
      if (1 < local_34.MaxCharSize) {
        pBVar7 = local_34.LeadByte;
        while (((local_34.LeadByte[0] != 0 && (pBVar7[1] != 0)) &&
               ((*(byte *)_CchCount1 < *pBVar7 || (pBVar7[1] < *(byte *)_CchCount1))))) {
          pBVar7 = pBVar7 + 2;
          local_34.LeadByte[0] = *pBVar7;
        }
      }
      goto LAB_1004bdcf;
    }
  }
  uStackY_7c = 0x1004bbd8;
  iVar4 = MultiByteToWideChar(_CchCount2,9,(LPCSTR)_DwCmpFlags,(int)_LpString1,(LPWSTR)0x0,0);
  if (iVar4 == 0) goto LAB_1004bdcf;
  puVar8 = (undefined1 *)(iVar4 * 2 + 3U & 0xfffffffc);
  iVar10 = -(int)puVar8;
  puVar9 = &stack0xffffffa0 + iVar10;
  local_1c = &stack0xffffffa0 + iVar10;
  local_8 = (undefined *)0xffffffff;
  if (&stack0xffffffa0 == puVar8) {
    *(int *)(&stack0xffffff9c + iVar10) = iVar4 * 2;
    *(undefined4 *)(&stack0xffffff98 + iVar10) = 0x1004bc30;
    puVar9 = (undefined1 *)_malloc(*(size_t *)(&stack0xffffff9c + iVar10));
    if (puVar9 == (undefined1 *)0x0) goto LAB_1004bdcf;
    bVar2 = true;
  }
  *(int *)(&stack0xffffff9c + iVar10) = iVar4;
  *(undefined1 **)(&stack0xffffff98 + iVar10) = puVar9;
  *(LPCSTR *)(&stack0xffffff94 + iVar10) = _LpString1;
  *(DWORD *)(&stack0xffffff90 + iVar10) = _DwCmpFlags;
  *(undefined4 *)(&stack0xffffff8c + iVar10) = 1;
  *(int *)(&stack0xffffff88 + iVar10) = _CchCount2;
  puVar16 = (undefined1 *)((int)&uStackY_7c + iVar10);
  *(undefined4 *)((int)&uStackY_7c + iVar10) = 0x1004bc51;
  iVar10 = MultiByteToWideChar(*(UINT *)(&stack0xffffff88 + iVar10),
                               *(DWORD *)(&stack0xffffff8c + iVar10),
                               *(LPCSTR *)(&stack0xffffff90 + iVar10),
                               *(int *)(&stack0xffffff94 + iVar10),
                               *(LPWSTR *)(&stack0xffffff98 + iVar10),
                               *(int *)(&stack0xffffff9c + iVar10));
  puVar8 = puVar16;
  if (iVar10 != 0) {
    *(undefined4 *)(puVar16 + -4) = 0;
    *(undefined4 *)(puVar16 + -8) = 0;
    *(LPCSTR *)(puVar16 + -0xc) = _LpString2;
    *(int *)(puVar16 + -0x10) = _CchCount1;
    *(undefined4 *)(puVar16 + -0x14) = 9;
    *(int *)(puVar16 + -0x18) = _CchCount2;
    puVar17 = puVar16 + -0x1c;
    *(undefined4 *)(puVar16 + -0x1c) = 0x1004bc6e;
    iVar10 = MultiByteToWideChar(*(UINT *)(puVar16 + -0x18),*(DWORD *)(puVar16 + -0x14),
                                 *(LPCSTR *)(puVar16 + -0x10),*(int *)(puVar16 + -0xc),
                                 *(LPWSTR *)(puVar16 + -8),*(int *)(puVar16 + -4));
    puVar8 = puVar17;
    if (iVar10 != 0) {
      puVar11 = (undefined1 *)(iVar10 * 2 + 3U & 0xfffffffc);
      *(undefined4 *)(puVar17 + -4) = 0x1004bc90;
      iVar13 = -(int)puVar11;
      puVar12 = puVar17 + iVar13;
      puVar8 = puVar17 + iVar13;
      local_1c = puVar17 + iVar13;
      local_8 = (undefined *)0xffffffff;
      if (puVar17 == puVar11) {
        sRamfffffffc = iVar10 * 2;
        uRamfffffff8 = 0x1004bcc3;
        puVar12 = (undefined1 *)_malloc(sRamfffffffc);
        if (puVar12 == (undefined1 *)0x0) goto LAB_1004bd0a;
        bVar1 = true;
      }
      *(int *)(puVar17 + iVar13 + -4) = iVar10;
      *(undefined1 **)(puVar17 + iVar13 + -8) = puVar12;
      *(LPCSTR *)(puVar17 + iVar13 + -0xc) = _LpString2;
      *(int *)(puVar17 + iVar13 + -0x10) = _CchCount1;
      *(undefined4 *)(puVar17 + iVar13 + -0x14) = 1;
      *(int *)(puVar17 + iVar13 + -0x18) = _CchCount2;
      puVar18 = puVar17 + iVar13 + -0x1c;
      *(undefined4 *)(puVar17 + iVar13 + -0x1c) = 0x1004bce4;
      iVar13 = MultiByteToWideChar(*(UINT *)(puVar17 + iVar13 + -0x18),
                                   *(DWORD *)(puVar17 + iVar13 + -0x14),
                                   *(LPCSTR *)(puVar17 + iVar13 + -0x10),
                                   *(int *)(puVar17 + iVar13 + -0xc),
                                   *(LPWSTR *)(puVar17 + iVar13 + -8),
                                   *(int *)(puVar17 + iVar13 + -4));
      puVar8 = puVar18;
      if (iVar13 != 0) {
        *(int *)(puVar18 + -4) = iVar10;
        *(undefined1 **)(puVar18 + -8) = puVar12;
        *(int *)(puVar18 + -0xc) = iVar4;
        *(undefined1 **)(puVar18 + -0x10) = puVar9;
        *(LPCWSTR *)(puVar18 + -0x14) = _LocaleName;
        *(_locale_t *)(puVar18 + -0x18) = _Plocinfo;
        puVar8 = puVar18 + -0x1c;
        *(undefined4 *)(puVar18 + -0x1c) = 0x1004bcfa;
        CompareStringW(*(LCID *)(puVar18 + -0x18),*(DWORD *)(puVar18 + -0x14),
                       *(PCNZWCH *)(puVar18 + -0x10),*(int *)(puVar18 + -0xc),
                       *(PCNZWCH *)(puVar18 + -8),*(int *)(puVar18 + -4));
      }
      if (bVar1) {
        *(undefined1 **)(puVar8 + -4) = puVar12;
        *(undefined4 *)(puVar8 + -8) = 0x1004bd09;
        _free(*(void **)(puVar8 + -4));
      }
    }
  }
LAB_1004bd0a:
  if (bVar2) {
    *(undefined1 **)(puVar8 + -4) = puVar9;
    *(undefined4 *)(puVar8 + -8) = 0x1004bd18;
    _free(*(void **)(puVar8 + -4));
  }
LAB_1004bdcf:
  iVar4 = FUN_1003fb09(local_20);
  return iVar4;
}



// Library Function - Single Match
//  _findenv
// 
// Library: Visual Studio 2003 Release

int __cdecl findenv(uchar *param_1)

{
  int iVar1;
  int *piVar2;
  size_t unaff_EDI;
  
  piVar2 = DAT_1006905c;
  while( true ) {
    if ((uchar *)*piVar2 == (uchar *)0x0) {
      return -((int)piVar2 - (int)DAT_1006905c >> 2);
    }
    iVar1 = __mbsnbicoll(param_1,(uchar *)*piVar2,unaff_EDI);
    if ((iVar1 == 0) &&
       ((*(char *)(unaff_EDI + *piVar2) == '=' || (*(char *)(unaff_EDI + *piVar2) == '\0')))) break;
    piVar2 = piVar2 + 1;
  }
  return (int)piVar2 - (int)DAT_1006905c >> 2;
}



// Library Function - Single Match
//  _copy_environ
// 
// Library: Visual Studio 2003 Release

int * __cdecl copy_environ(void)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  int iVar4;
  int *piVar5;
  int *unaff_EDI;
  
  iVar4 = 0;
  if (unaff_EDI != (int *)0x0) {
    iVar1 = *unaff_EDI;
    piVar2 = unaff_EDI;
    while (iVar1 != 0) {
      piVar2 = piVar2 + 1;
      iVar4 = iVar4 + 1;
      iVar1 = *piVar2;
    }
    piVar2 = (int *)_malloc(iVar4 * 4 + 4);
    if (piVar2 == (int *)0x0) {
      __amsg_exit(9);
    }
    pcVar3 = (char *)*unaff_EDI;
    piVar5 = piVar2;
    while (pcVar3 != (char *)0x0) {
      pcVar3 = __strdup(pcVar3);
      *piVar5 = (int)pcVar3;
      piVar5 = piVar5 + 1;
      unaff_EDI = unaff_EDI + 1;
      pcVar3 = (char *)*unaff_EDI;
    }
    *piVar5 = 0;
    return piVar2;
  }
  return unaff_EDI;
}



// Library Function - Single Match
//  ___crtsetenv
// 
// Library: Visual Studio 2003 Release

int __cdecl ___crtsetenv(char **_POption,int _Primary)

{
  uint *_Str;
  uint *puVar1;
  int iVar2;
  int *piVar3;
  size_t sVar4;
  uint *lpName;
  undefined1 *puVar5;
  BOOL BVar6;
  bool bVar7;
  int local_14;
  
  local_14 = 0;
  if (_POption == (char **)0x0) {
    return -1;
  }
  _Str = (uint *)*_POption;
  if (_Str == (uint *)0x0) {
    return -1;
  }
  puVar1 = (uint *)__mbschr((uchar *)_Str,0x3d);
  if (puVar1 == (uint *)0x0) {
    return -1;
  }
  if (_Str == puVar1) {
    return -1;
  }
  bVar7 = *(char *)((int)puVar1 + 1) == '\0';
  if (DAT_1006905c == DAT_10069060) {
    DAT_1006905c = copy_environ();
  }
  if (DAT_1006905c == (int *)0x0) {
    if ((_Primary != 0) && (DAT_10069064 != (undefined4 *)0x0)) {
      iVar2 = ___wtomb_environ();
      if (iVar2 != 0) {
        return -1;
      }
      goto LAB_1004bf43;
    }
    if (!bVar7) {
      DAT_1006905c = (int *)_malloc(4);
      if (DAT_1006905c == (int *)0x0) {
        return -1;
      }
      *DAT_1006905c = 0;
      if (DAT_10069064 == (undefined4 *)0x0) {
        DAT_10069064 = (undefined4 *)_malloc(4);
        if (DAT_10069064 == (undefined4 *)0x0) {
          return -1;
        }
        *DAT_10069064 = 0;
      }
      goto LAB_1004bf43;
    }
LAB_1004bf11:
    local_14 = 0;
  }
  else {
LAB_1004bf43:
    piVar3 = DAT_1006905c;
    iVar2 = findenv((uchar *)_Str);
    if ((iVar2 < 0) || (*piVar3 == 0)) {
      if (bVar7) {
        _free(_Str);
        *_POption = (char *)0x0;
        goto LAB_1004bf11;
      }
      if (iVar2 < 0) {
        iVar2 = -iVar2;
      }
      piVar3 = (int *)_realloc(DAT_1006905c,iVar2 * 4 + 8);
      if (piVar3 == (int *)0x0) {
        return -1;
      }
      piVar3[iVar2] = (int)_Str;
      (piVar3 + iVar2)[1] = 0;
      *_POption = (char *)0x0;
LAB_1004bfe0:
      DAT_1006905c = piVar3;
    }
    else {
      piVar3 = piVar3 + iVar2;
      _free((void *)*piVar3);
      if (bVar7) {
        for (; *piVar3 != 0; piVar3 = piVar3 + 1) {
          *piVar3 = piVar3[1];
          iVar2 = iVar2 + 1;
        }
        piVar3 = (int *)_realloc(DAT_1006905c,iVar2 << 2);
        if (piVar3 != (int *)0x0) goto LAB_1004bfe0;
      }
      else {
        *piVar3 = (int)_Str;
        *_POption = (char *)0x0;
      }
    }
    if (_Primary != 0) {
      sVar4 = _strlen((char *)_Str);
      lpName = (uint *)_malloc(sVar4 + 2);
      if (lpName != (uint *)0x0) {
        FUN_10048310(lpName,_Str);
        puVar5 = (undefined1 *)(((int)lpName - (int)_Str) + (int)puVar1);
        *puVar5 = 0;
        BVar6 = SetEnvironmentVariableA((LPCSTR)lpName,(LPCSTR)(~-(uint)bVar7 & (uint)(puVar5 + 1)))
        ;
        if (BVar6 == 0) {
          local_14 = -1;
        }
        _free(lpName);
      }
    }
    if (bVar7) {
      _free(_Str);
    }
  }
  return local_14;
}



// Library Function - Single Match
//  ___ascii_strnicmp
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

int __cdecl ___ascii_strnicmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  byte bVar2;
  ushort uVar3;
  uint uVar4;
  bool bVar5;
  
  if (_MaxCount != 0) {
    do {
      bVar2 = *_Str1;
      cVar1 = *_Str2;
      uVar3 = CONCAT11(bVar2,cVar1);
      if (bVar2 == 0) break;
      uVar3 = CONCAT11(bVar2,cVar1);
      uVar4 = (uint)uVar3;
      if (cVar1 == '\0') break;
      _Str1 = (char *)((byte *)_Str1 + 1);
      _Str2 = _Str2 + 1;
      if ((0x40 < bVar2) && (bVar2 < 0x5b)) {
        uVar4 = (uint)CONCAT11(bVar2 + 0x20,cVar1);
      }
      uVar3 = (ushort)uVar4;
      bVar2 = (byte)uVar4;
      if ((0x40 < bVar2) && (bVar2 < 0x5b)) {
        uVar3 = (ushort)CONCAT31((int3)(uVar4 >> 8),bVar2 + 0x20);
      }
      bVar2 = (byte)(uVar3 >> 8);
      bVar5 = bVar2 < (byte)uVar3;
      if (bVar2 != (byte)uVar3) goto LAB_1004c0c1;
      _MaxCount = _MaxCount - 1;
    } while (_MaxCount != 0);
    _MaxCount = 0;
    bVar2 = (byte)(uVar3 >> 8);
    bVar5 = bVar2 < (byte)uVar3;
    if (bVar2 != (byte)uVar3) {
LAB_1004c0c1:
      _MaxCount = 0xffffffff;
      if (!bVar5) {
        _MaxCount = 1;
      }
    }
  }
  return _MaxCount;
}



// Library Function - Single Match
//  __setmode_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __setmode_lk(uint param_1,int param_2)

{
  byte *pbVar1;
  byte bVar2;
  int *piVar3;
  int iVar4;
  
  piVar3 = &DAT_10069600 + ((int)param_1 >> 5);
  iVar4 = (param_1 & 0x1f) * 0x24;
  bVar2 = *(byte *)(*piVar3 + 4 + iVar4);
  if (param_2 == 0x8000) {
    pbVar1 = (byte *)(*piVar3 + 4 + iVar4);
    *pbVar1 = *pbVar1 & 0x7f;
  }
  else {
    if (param_2 != 0x4000) {
      piVar3 = FUN_10041d35();
      *piVar3 = 0x16;
      return -1;
    }
    pbVar1 = (byte *)(*piVar3 + 4 + iVar4);
    *pbVar1 = *pbVar1 | 0x80;
  }
  return (-(uint)((bVar2 & 0x80) != 0) & 0xffffc000) + 0x8000;
}



// Library Function - Single Match
//  __strdup
// 
// Library: Visual Studio 2003 Release

char * __cdecl __strdup(char *_Src)

{
  size_t sVar1;
  uint *puVar2;
  
  if (_Src != (char *)0x0) {
    sVar1 = _strlen(_Src);
    puVar2 = (uint *)_malloc(sVar1 + 1);
    if (puVar2 != (uint *)0x0) {
      puVar2 = FUN_10048310(puVar2,(uint *)_Src);
      return (char *)puVar2;
    }
  }
  return (char *)0x0;
}



// Library Function - Single Match
//  __mbschr
// 
// Library: Visual Studio 2003 Release

uchar * __cdecl __mbschr(uchar *_Str,uint _Ch)

{
  byte bVar1;
  byte bVar2;
  _ptiddata p_Var3;
  pthreadmbcinfo ptVar4;
  uchar *puVar5;
  byte *pbVar6;
  uint uVar7;
  
  p_Var3 = __getptd();
  ptVar4 = (pthreadmbcinfo)p_Var3->_tpxcptinfoptrs;
  if (ptVar4 != DAT_1006938c) {
    ptVar4 = ___updatetmbcinfo();
  }
  if (ptVar4->ismbcodepage == 0) {
    puVar5 = (uchar *)_strchr((char *)_Str,_Ch);
    return puVar5;
  }
  while( true ) {
    bVar2 = *_Str;
    uVar7 = (uint)bVar2;
    if (bVar2 == 0) break;
    if ((ptVar4->mbctype[uVar7 + 5] & 4) == 0) {
      pbVar6 = _Str;
      if (_Ch == uVar7) break;
    }
    else {
      bVar1 = _Str[1];
      if (bVar1 == 0) {
        return (uchar *)0x0;
      }
      pbVar6 = _Str + 1;
      if (_Ch == CONCAT11(bVar2,bVar1)) {
        return _Str;
      }
    }
    _Str = pbVar6 + 1;
  }
  return (uchar *)(~-(uint)(_Ch != uVar7) & (uint)_Str);
}



UCHAR Netbios(PNCB pncb)

{
  UCHAR UVar1;
  
                    // WARNING: Could not recover jumptable at 0x1004c1e4. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = Netbios(pncb);
  return UVar1;
}



void RtlUnwind(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue)

{
                    // WARNING: Could not recover jumptable at 0x1004c1ea. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwind(TargetFrame,TargetIp,ExceptionRecord,ReturnValue);
  return;
}



// Library Function - Single Match
//  __mbsicmp
// 
// Library: Visual Studio 2003 Release

int __cdecl __mbsicmp(uchar *_Str1,uchar *_Str2)

{
  ushort uVar1;
  ushort uVar2;
  _ptiddata p_Var3;
  pthreadmbcinfo ptVar4;
  int iVar5;
  uchar *puVar6;
  BOOL unaff_EDI;
  undefined4 local_8;
  
  p_Var3 = __getptd();
  ptVar4 = (pthreadmbcinfo)p_Var3->_tpxcptinfoptrs;
  if (ptVar4 != DAT_1006938c) {
    ptVar4 = ___updatetmbcinfo();
  }
  if (ptVar4->ismbcodepage == 0) {
    iVar5 = __stricmp((char *)_Str1,(char *)_Str2);
  }
  else {
    do {
      uVar1 = (ushort)*_Str1;
      puVar6 = _Str1 + 1;
      if ((ptVar4->mbctype[uVar1 + 5] & 4) == 0) {
        _Str1 = puVar6;
        if ((ptVar4->mbctype[uVar1 + 5] & 0x10) != 0) {
          uVar1 = (ushort)(char)ptVar4->mbcasemap[uVar1 + 4];
        }
      }
      else if (*puVar6 == '\0') {
        uVar1 = 0;
        _Str1 = puVar6;
      }
      else {
        iVar5 = ___crtLCMapStringA(*(_locale_t *)ptVar4->mbulinfo,(LPCWSTR)0x200,(DWORD)_Str1,
                                   (LPCSTR)0x2,(int)&local_8,(LPSTR)0x2,ptVar4->mbcodepage,1,
                                   unaff_EDI);
        if (iVar5 == 1) {
          uVar1 = (ushort)local_8 & 0xff;
        }
        else {
          if (iVar5 != 2) {
            return 0x7fffffff;
          }
          uVar1 = (ushort)local_8 * 0x100 + ((ushort)((uint)local_8 >> 8) & 0xff);
        }
        _Str1 = _Str1 + 2;
      }
      uVar2 = (ushort)*_Str2;
      puVar6 = _Str2 + 1;
      if ((ptVar4->mbctype[uVar2 + 5] & 4) == 0) {
        _Str2 = puVar6;
        if ((ptVar4->mbctype[uVar2 + 5] & 0x10) != 0) {
          uVar2 = (ushort)(char)ptVar4->mbcasemap[uVar2 + 4];
        }
      }
      else if (*puVar6 == '\0') {
        uVar2 = 0;
        _Str2 = puVar6;
      }
      else {
        iVar5 = ___crtLCMapStringA(*(_locale_t *)ptVar4->mbulinfo,(LPCWSTR)0x200,(DWORD)_Str2,
                                   (LPCSTR)0x2,(int)&local_8,(LPSTR)0x2,ptVar4->mbcodepage,1,
                                   unaff_EDI);
        if (iVar5 == 1) {
          uVar2 = (ushort)local_8 & 0xff;
        }
        else {
          if (iVar5 != 2) {
            return 0x7fffffff;
          }
          uVar2 = (ushort)local_8 * 0x100 + ((ushort)((uint)local_8 >> 8) & 0xff);
        }
        _Str2 = _Str2 + 2;
      }
      if (uVar2 != uVar1) {
        return (-(uint)(uVar2 < uVar1) & 2) - 1;
      }
    } while (uVar1 != 0);
    iVar5 = 0;
  }
  return iVar5;
}



// Library Function - Single Match
//  __mbsrchr
// 
// Library: Visual Studio 2003 Release

uchar * __cdecl __mbsrchr(uchar *_Str,uint _Ch)

{
  byte bVar1;
  ushort uVar2;
  _ptiddata p_Var3;
  pthreadmbcinfo ptVar4;
  uchar *puVar5;
  byte *pbVar6;
  byte bVar7;
  byte *pbVar8;
  bool bVar9;
  
  pbVar8 = (byte *)0x0;
  p_Var3 = __getptd();
  ptVar4 = (pthreadmbcinfo)p_Var3->_tpxcptinfoptrs;
  if (ptVar4 != DAT_1006938c) {
    ptVar4 = ___updatetmbcinfo();
  }
  if (ptVar4->ismbcodepage == 0) {
    puVar5 = (uchar *)_strrchr((char *)_Str,_Ch);
    return puVar5;
  }
  do {
    bVar7 = *_Str;
    if ((ptVar4->mbctype[bVar7 + 5] & 4) == 0) {
      bVar9 = _Ch == bVar7;
LAB_1004c807:
      pbVar6 = _Str;
      if (bVar9) {
        pbVar8 = _Str;
      }
    }
    else {
      pbVar6 = _Str + 1;
      bVar1 = *pbVar6;
      if (bVar1 == 0) {
        bVar9 = pbVar8 == (byte *)0x0;
        _Str = pbVar6;
        bVar7 = bVar1;
        goto LAB_1004c807;
      }
      uVar2 = CONCAT11(bVar7,bVar1);
      bVar7 = bVar1;
      if (_Ch == uVar2) {
        pbVar8 = _Str;
      }
    }
    _Str = pbVar6 + 1;
    if (bVar7 == 0) {
      return pbVar8;
    }
  } while( true );
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  ___loctotime_t
// 
// Library: Visual Studio 2003 Release

int __cdecl
___loctotime_t(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int param_7)

{
  int iVar1;
  int iVar2;
  int iVar3;
  tm local_28;
  
  iVar2 = param_1 + -0x76c;
  if ((iVar2 < 0x46) || (0x8a < iVar2)) {
    iVar1 = -1;
  }
  else {
    iVar3 = *(int *)(&DAT_10057bc8 + param_2 * 4) + param_3;
    if ((((iVar2 % 4 == 0) && (iVar2 % 100 != 0)) || (param_1 % 400 == 0)) && (2 < param_2)) {
      iVar3 = iVar3 + 1;
    }
    ___tzset();
    local_28.tm_min = param_5;
    local_28.tm_mon = param_2 + -1;
    iVar1 = ((param_4 +
             (iVar2 * 0x16d +
             (param_1 + -0x76d) / 4 + iVar3 + ((param_1 + -0x641) / 400 - (param_1 + -0x76d) / 100))
             * 0x18) * 0x3c + param_5) * 0x3c + _DAT_10057ae8 + 0x7c558180 + param_6;
    local_28.tm_hour = param_4;
    local_28.tm_sec = param_6;
    if ((param_7 == 1) ||
       (((param_7 == -1 && (DAT_10057aec != 0)) &&
        (local_28.tm_year = iVar2, local_28.tm_yday = iVar3, iVar2 = __isindst(&local_28),
        iVar2 != 0)))) {
      iVar1 = iVar1 + DAT_10057af0;
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  __fullpath
// 
// Library: Visual Studio 2003 Release

char * __cdecl __fullpath(char *_FullPath,char *_Path,size_t _SizeInBytes)

{
  char *lpBuffer;
  int *piVar1;
  DWORD DVar2;
  char *pcVar3;
  
  pcVar3 = _Path;
  if ((_Path == (char *)0x0) || (*_Path == '\0')) {
    pcVar3 = __getcwd(_FullPath,_SizeInBytes);
    return pcVar3;
  }
  lpBuffer = _FullPath;
  if (_FullPath == (char *)0x0) {
    lpBuffer = (char *)_malloc(0x104);
    if (lpBuffer == (LPSTR)0x0) {
      piVar1 = FUN_10041d35();
      *piVar1 = 0xc;
      return (char *)0x0;
    }
    _SizeInBytes = 0x104;
  }
  DVar2 = GetFullPathNameA(pcVar3,_SizeInBytes,lpBuffer,&_Path);
  if (_SizeInBytes <= DVar2) {
    if (_FullPath == (char *)0x0) {
      _free(lpBuffer);
    }
    piVar1 = FUN_10041d35();
    *piVar1 = 0x22;
    return (char *)0x0;
  }
  if (DVar2 == 0) {
    if (_FullPath == (char *)0x0) {
      _free(lpBuffer);
    }
    DVar2 = GetLastError();
    __dosmaperr(DVar2);
    return (char *)0x0;
  }
  return lpBuffer;
}



// Library Function - Single Match
//  __mbctolower
// 
// Library: Visual Studio 2003 Release

uint __cdecl __mbctolower(uint _Ch)

{
  _ptiddata p_Var1;
  pthreadmbcinfo ptVar2;
  int iVar3;
  BOOL unaff_EBX;
  undefined2 local_c;
  undefined1 local_8;
  undefined1 local_7;
  undefined2 uStack_6;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadmbcinfo)p_Var1->_tpxcptinfoptrs;
  if (ptVar2 != DAT_1006938c) {
    ptVar2 = ___updatetmbcinfo();
  }
  if (_Ch < 0x100) {
    if ((ptVar2->mbctype[_Ch + 5] & 0x10) != 0) {
      _Ch = (uint)(char)ptVar2->mbcasemap[_Ch + 4];
    }
  }
  else {
    _local_8 = CONCAT11((char)_Ch,(char)(_Ch >> 8));
    if (((ptVar2->mbctype[(_Ch >> 8 & 0xff) + 5] & 4) != 0) &&
       (iVar3 = ___crtLCMapStringA(*(_locale_t *)ptVar2->mbulinfo,(LPCWSTR)0x100,(DWORD)&local_8,
                                   (LPCSTR)0x2,(int)&local_c,(LPSTR)0x2,ptVar2->mbcodepage,1,
                                   unaff_EBX), iVar3 != 0)) {
      _Ch = (uint)CONCAT11((undefined1)local_c,local_c._1_1_);
    }
  }
  return _Ch;
}



// Library Function - Single Match
//  ___mbspbrk_mt
// 
// Library: Visual Studio 2003 Release

char * __cdecl ___mbspbrk_mt(int param_1,byte *param_2,byte *param_3)

{
  byte bVar1;
  char *pcVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  if (*(int *)(param_1 + 8) == 0) {
    pcVar2 = _strpbrk((char *)param_2,(char *)param_3);
  }
  else {
    pbVar4 = param_3;
    if (*param_2 != 0) {
LAB_1004cb8c:
      do {
        if (*pbVar4 != 0) {
          bVar1 = *pbVar4;
          if ((*(byte *)(bVar1 + 0x1d + param_1) & 4) == 0) {
            pbVar3 = pbVar4;
            if (bVar1 != *param_2) goto LAB_1004cb8b;
          }
          else if (((bVar1 != *param_2) || (pbVar4[1] != param_2[1])) &&
                  (pbVar3 = pbVar4 + 1, *pbVar3 != 0)) {
LAB_1004cb8b:
            pbVar4 = pbVar3 + 1;
            goto LAB_1004cb8c;
          }
        }
        if (((*pbVar4 != 0) ||
            (((*(byte *)(*param_2 + 0x1d + param_1) & 4) != 0 &&
             (param_2 = param_2 + 1, *param_2 == 0)))) ||
           (param_2 = param_2 + 1, pbVar4 = param_3, *param_2 == 0)) break;
      } while( true );
    }
    pcVar2 = (char *)(-(uint)(*param_2 != 0) & (uint)param_2);
  }
  return pcVar2;
}



// Library Function - Single Match
//  __validdrive
// 
// Library: Visual Studio 2003 Release

int __cdecl __validdrive(uint param_1)

{
  char cVar1;
  UINT UVar2;
  
  if (param_1 != 0) {
    cVar1 = (char)param_1;
    param_1 = (uint)CONCAT12(0x5c,CONCAT11(0x3a,cVar1 + '@'));
    UVar2 = GetDriveTypeA((LPCSTR)&param_1);
    if ((UVar2 == 0) || (UVar2 == 1)) {
      return 0;
    }
  }
  return 1;
}



// Library Function - Single Match
//  __getdcwd_lk
// 
// Library: Visual Studio 2003 Release

void __cdecl __getdcwd_lk(uint param_1,uint *param_2,size_t param_3)

{
  int iVar1;
  ulong *puVar2;
  int *piVar3;
  DWORD DVar4;
  uint uVar5;
  uint *puVar6;
  LPSTR local_110;
  uint local_10c [65];
  int local_8;
  
  uVar5 = param_1;
  local_8 = DAT_10057438;
  if (param_1 == 0) {
    DVar4 = GetCurrentDirectoryA(0x104,(LPSTR)local_10c);
  }
  else {
    iVar1 = __validdrive(param_1);
    if (iVar1 == 0) {
      puVar2 = FUN_10041d3e();
      *puVar2 = 0xf;
      piVar3 = FUN_10041d35();
      *piVar3 = 0xd;
      goto LAB_1004cc4f;
    }
    param_1 = (uint)CONCAT12(0x2e,CONCAT11(0x3a,(char)uVar5 + '@'));
    DVar4 = GetFullPathNameA((LPCSTR)&param_1,0x104,(LPSTR)local_10c,&local_110);
  }
  if ((DVar4 != 0) && (uVar5 = DVar4 + 1, uVar5 < 0x105)) {
    if (param_2 == (uint *)0x0) {
      if ((int)uVar5 <= (int)param_3) {
        uVar5 = param_3;
      }
      puVar6 = (uint *)_malloc(uVar5);
      if (puVar6 == (uint *)0x0) {
        piVar3 = FUN_10041d35();
        *piVar3 = 0xc;
        goto LAB_1004cc4f;
      }
    }
    else {
      puVar6 = param_2;
      if ((int)param_3 < (int)uVar5) {
        piVar3 = FUN_10041d35();
        *piVar3 = 0x22;
        goto LAB_1004cc4f;
      }
    }
    FUN_10048310(puVar6,local_10c);
  }
LAB_1004cc4f:
  FUN_1003fb09(local_8);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __getcwd
// 
// Library: Visual Studio 2003 Release

char * __cdecl __getcwd(char *_DstBuf,int _SizeInBytes)

{
  char *pcVar1;
  
  __lock(7);
  pcVar1 = (char *)__getdcwd_lk(0,(uint *)_DstBuf,_SizeInBytes);
  FUN_1004cd3b();
  return pcVar1;
}



void FUN_1004cd3b(void)

{
  FUN_100425f0(7);
  return;
}



// Library Function - Single Match
//  ___toupper_mt
// 
// Library: Visual Studio 2003 Release

uint __thiscall ___toupper_mt(void *this,int param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  LPCSTR _LpSrcStr;
  int iVar4;
  BOOL unaff_ESI;
  undefined4 local_8;
  
  uVar2 = param_2;
  iVar4 = param_1;
  if ((*(int *)(param_1 + 0x14) == 0) || ((*(int *)(param_1 + 0x24) != 0 && (param_2 < 0x80)))) {
    if ((0x60 < (int)param_2) && ((int)param_2 < 0x7b)) {
      return param_2 - 0x20;
    }
  }
  else {
    local_8 = this;
    if (param_2 < 0x100) {
      if (*(int *)(param_1 + 0x28) < 2) {
        uVar3 = *(byte *)(*(int *)(param_1 + 0x48) + param_2 * 2) & 2;
      }
      else {
        uVar3 = ___isctype_mt(this,param_1,param_2,2);
      }
      if (uVar3 == 0) {
        return uVar2;
      }
    }
    iVar1 = param_1;
    if ((*(byte *)(*(int *)(iVar4 + 0x48) + 1 + ((int)uVar2 >> 8 & 0xffU) * 2) & 0x80) == 0) {
      param_1._0_2_ = (ushort)(byte)uVar2;
      _LpSrcStr = (LPCSTR)0x1;
    }
    else {
      param_1._0_2_ = CONCAT11((byte)uVar2,(char)(uVar2 >> 8));
      param_1._3_1_ = SUB41(iVar1,3);
      param_1._0_3_ = (uint3)(ushort)param_1;
      _LpSrcStr = (LPCSTR)0x2;
    }
    iVar4 = ___crtLCMapStringA(*(_locale_t *)(iVar4 + 0x14),(LPCWSTR)0x200,(DWORD)&param_1,_LpSrcStr
                               ,(int)&local_8,(LPSTR)0x3,*(int *)(iVar4 + 4),1,unaff_ESI);
    if (iVar4 != 0) {
      if (iVar4 != 1) {
        return (uint)CONCAT11((undefined1)local_8,local_8._1_1_);
      }
      return (uint)local_8 & 0xff;
    }
  }
  return uVar2;
}



void Unwind_1004ce40(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_1004ce60(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0x150));
  return;
}



void Unwind_1004ce80(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0x134));
  return;
}



void Unwind_1004cea0(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0xedc));
  return;
}



void Unwind_1004ceae(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0xedc));
  return;
}



void Unwind_1004ced0(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0x1014));
  return;
}



void Unwind_1004cef0(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0x10));
  return;
}



void Unwind_1004cf10(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0x10a0));
  return;
}



void Unwind_1004cf30(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + -0x130));
  return;
}



void Unwind_1004cf50(void)

{
  int unaff_EBP;
  
  FUN_1003dfa0(*(int *)(unaff_EBP + -0x10) + 0x14);
  return;
}



void Unwind_1004cf70(void)

{
  int unaff_EBP;
  
  _free(*(void **)(unaff_EBP + 4));
  return;
}


