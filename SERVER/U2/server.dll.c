#include "server.dll.h"



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void StopServer(void)

{
  float10 fVar1;
  DWORD local_c;
  __time32_t local_8;
  __time32_t local_4;
  
                    // 0x1000  3  StopServer
  if (DAT_100423c8 != (HANDLE)0x0) {
    DAT_100423d8 = 1;
    local_c = 0;
    local_4 = 0;
    local_8 = 0;
    FID_conflict___time32(&local_8);
    do {
      FID_conflict___time32(&local_4);
      GetExitCodeThread(DAT_100423c8,&local_c);
      if (local_c != 0x103) goto LAB_1000109a;
      fVar1 = FUN_1002cee0(local_4,local_8);
    } while (fVar1 < (float10)10.0 != (NAN(fVar1) || NAN((float10)10.0)));
    if (local_c == 0x103) {
      TerminateThread(DAT_100423c8,0);
    }
LAB_1000109a:
    DAT_100423c8 = (HANDLE)0x0;
    _DAT_100423cc = 0;
  }
  return;
}



bool IsServerRunning(void)

{
                    // 0x10b0  1  IsServerRunning
  return DAT_100423c8 != 0;
}



void FUN_100010c0(void)

{
  SOCKET *pSVar1;
  HANDLE hFile;
  uint *puVar2;
  int iVar3;
  byte *pbVar4;
  int *piVar5;
  DWORD DVar6;
  int iVar7;
  uint uVar8;
  undefined4 *puVar9;
  ulonglong uVar10;
  _FILETIME local_1b4;
  _FILETIME local_1ac;
  _SYSTEMTIME local_1a4;
  undefined4 local_194;
  SOCKET *local_190;
  undefined4 local_18c;
  byte *local_188;
  DWORD local_184;
  int *local_180;
  int local_17c;
  CHAR local_178 [256];
  byte local_78;
  undefined4 local_77;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  char local_28;
  undefined4 local_27;
  undefined4 local_23;
  undefined4 local_1f;
  undefined2 local_1b;
  undefined1 local_19;
  undefined4 local_18;
  undefined1 *local_14;
  void *pvStack_10;
  undefined1 *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &LAB_100386d0;
  pvStack_10 = ExceptionList;
  local_14 = &stack0xfffffe40;
  local_18 = DAT_10041558;
  ExceptionList = &pvStack_10;
  GetModuleFileNameA((HMODULE)0x0,local_178,0x100);
  hFile = CreateFileA(local_178,0x80000000,1,(LPSECURITY_ATTRIBUTES)0x0,3,0x80,(HANDLE)0x0);
  GetFileTime(hFile,(LPFILETIME)0x0,(LPFILETIME)0x0,&local_1ac);
  FileTimeToLocalFileTime(&local_1ac,&local_1b4);
  FileTimeToSystemTime(&local_1b4,&local_1a4);
  CloseHandle(hFile);
  local_78 = 0;
  puVar9 = &local_77;
  for (iVar7 = 0xf; iVar7 != 0; iVar7 = iVar7 + -1) {
    *puVar9 = 0;
    puVar9 = puVar9 + 1;
  }
  *(undefined2 *)puVar9 = 0;
  *(undefined1 *)((int)puVar9 + 2) = 0;
  _sprintf((char *)&local_78,"(%s) %04d/%02d/%02d %d:%02d",&DAT_10039264,(uint)local_1a4.wYear,
           (uint)local_1a4.wMonth,(uint)local_1a4.wDay,(uint)local_1a4.wHour,(uint)local_1a4.wMinute
          );
  local_180 = (int *)0x0;
  local_8 = 0;
  puVar2 = FUN_10010e80(&local_78,(byte *)0x0);
  DAT_100423c0 = puVar2;
  if (puVar2 == (uint *)0x0) {
    local_194 = 0xffffffff;
    puVar2 = (uint *)__CxxThrowException_8(&local_194,&DAT_10040348);
  }
  for (iVar7 = 0; (&PTR_FUN_10041040)[iVar7] != (undefined *)0x0; iVar7 = iVar7 + 1) {
    iVar3 = FUN_100102e0((int)puVar2);
    (*(code *)(&PTR_FUN_10041040)[iVar7])(iVar3);
    puVar2 = DAT_100423c0;
  }
  FUN_10010f50((int *)puVar2,"server.cfg","");
  pbVar4 = FUN_10010c00((int)DAT_100423c0,(char *)0x0);
  local_188 = pbVar4;
  FUN_10001710();
  piVar5 = FUN_10001a60();
  local_180 = piVar5;
  if (piVar5 == (int *)0x0) {
    local_18c = 0xffffffff;
    __CxxThrowException_8(&local_18c,&DAT_10040348);
  }
  local_34 = 0x414e32;
  local_30 = 0;
  local_8 = 0xffffffff;
  local_2c = 0;
  if (DAT_100423dc != 0) {
    local_34 = 0x410032;
  }
  local_38 = 0x5553464e;
  iVar7 = 10;
  pbVar4 = FUN_10002000(pbVar4,(byte *)0x1003921c);
  local_17c = FUN_10002e80(pbVar4,iVar7);
  if (local_17c < 1) {
    local_17c = 1;
  }
  else if (1000 < local_17c) {
    local_17c = 1000;
  }
  uVar10 = FUN_1002d548();
  local_190 = (SOCKET *)uVar10;
  local_17c = 0;
  local_180 = (int *)GetTickCount();
  while (DAT_100423d8 == '\0') {
    local_184 = GetTickCount();
    FUN_10001ac0();
    if (DAT_10052ab4 == 0) {
      iVar7 = 0;
    }
    else {
      iVar7 = *(int *)(DAT_10052ab4 + 0x1164fa8) + *(int *)(DAT_10052ab4 + 0x1164fac) +
              *(int *)(DAT_10052ab4 + 0x1164fa0) + *(int *)(DAT_10052ab4 + 0x1164fb0);
    }
    if ((local_17c != iVar7) ||
       (DVar6 = GetTickCount(), uVar8 = (int)(DVar6 - (int)local_180) >> 0x1f,
       3000 < (int)((DVar6 - (int)local_180 ^ uVar8) - uVar8))) {
      local_17c = iVar7;
      local_180 = (int *)GetTickCount();
      iVar3 = 0x26ac;
      pbVar4 = FUN_10002000(local_188,&DAT_10039210);
      uVar8 = FUN_10002e80(pbVar4,iVar3);
      local_27 = 0;
      local_23 = 0;
      local_1f = 0;
      local_1b = 0;
      local_28 = '\0';
      local_19 = 0;
      _sprintf(&local_28,"%d|%d",uVar8 & 0xffff,iVar7);
      FUN_100018d0((int)piVar5,0x61647666,3);
      FUN_10001940(piVar5,(char *)&local_38,s_NFS_Underground_2_LAN_Server_10041054,&local_28);
    }
    do {
      uVar8 = FUN_10010700(DAT_100423c0);
      pSVar1 = local_190;
    } while (0 < (int)uVar8);
    if ((int)uVar8 < 0) break;
    FUN_10010a10((int)DAT_100423c0,local_190);
    DVar6 = GetTickCount();
    uVar8 = (int)(DVar6 - local_184) >> 0x1f;
    iVar7 = (DVar6 - local_184 ^ uVar8) - uVar8;
    if (iVar7 < (int)pSVar1) {
      Sleep((int)pSVar1 - iVar7);
    }
  }
  FUN_10001a40((int)piVar5);
  FUN_10001aa0(piVar5);
  FUN_10001850();
  FUN_10010330(DAT_100423c0);
  DAT_100423c0 = (uint *)0x0;
  if (DAT_100423d8 == '\0') {
    if (DAT_100423d0 != (code *)0x0) {
      (*DAT_100423d0)(0xffffffff);
    }
                    // WARNING: Subroutine does not return
    ExitThread(1);
  }
                    // WARNING: Subroutine does not return
  ExitThread(0);
}



void Catch_100014ad(void)

{
  LPVOID pvVar1;
  int unaff_EBP;
  
  pvVar1 = *(LPVOID *)(unaff_EBP + -0x17c);
  if (pvVar1 != (LPVOID)0x0) {
    FUN_10001a40((int)pvVar1);
    FUN_10001aa0(pvVar1);
    FUN_10001850();
  }
  if (DAT_100423c0 != (void *)0x0) {
    FUN_10010330(DAT_100423c0);
    DAT_100423c0 = (void *)0x0;
  }
  if (DAT_100423d0 != (code *)0x0) {
    (*DAT_100423d0)(*(undefined4 *)(unaff_EBP + -0x180),DAT_100423d4);
  }
                    // WARNING: Subroutine does not return
  ExitThread(1);
}



void __cdecl FUN_10001510(SIZE_T param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  
  dwFlags = 0;
  hHeap = GetProcessHeap();
  HeapAlloc(hHeap,dwFlags,param_1);
  return;
}



void __cdecl FUN_10001530(LPVOID param_1)

{
  HANDLE hHeap;
  DWORD dwFlags;
  
  dwFlags = 0;
  hHeap = GetProcessHeap();
  HeapFree(hHeap,dwFlags,param_1);
  return;
}



undefined4 FUN_10001550(undefined4 param_1,int param_2)

{
  if (param_2 == 0) {
    InterlockedDecrement(&DAT_100423c4);
    if (DAT_100423c4 == 0) {
      StopServer();
    }
    return 1;
  }
  if (param_2 != 1) {
    return 0;
  }
  InterlockedIncrement(&DAT_100423c4);
  return 1;
}



uint __cdecl StartServer(char *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
                    // 0x15a0  2  StartServer
  if (DAT_100423c8 == (HANDLE)0x0) {
    if ((-1 < param_2) && (param_2 < 0xe)) {
      DAT_100423dc = param_2;
      DAT_100423d0 = param_3;
      DAT_100423d4 = param_4;
      if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
        _strncpy(s_NFS_Underground_2_LAN_Server_10041054,param_1,0x1f);
      }
      DAT_100423d8 = 0;
      DAT_100423c8 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,FUN_100010c0,(LPVOID)0x0,0,
                                  (LPDWORD)&DAT_100423cc);
      if (DAT_100423c8 != (HANDLE)0x0) goto LAB_10001633;
      param_2 = FUN_10010330(DAT_100423c0);
      DAT_100423c0 = (void *)0x0;
    }
    return param_2 & 0xffffff00;
  }
LAB_10001633:
  return CONCAT31((int3)((uint)DAT_100423c8 >> 8),1);
}



void __cdecl FUN_10001640(PUCHAR param_1)

{
  _NCB *p_Var1;
  UCHAR UVar2;
  int iVar3;
  undefined4 *puVar4;
  _NCB local_44;
  int local_4;
  
  puVar4 = (undefined4 *)&stack0xffffffb8;
  local_4 = DAT_10041558;
  p_Var1 = &local_44;
  for (iVar3 = 0x10; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined4 *)p_Var1 = 0;
    p_Var1 = (_NCB *)((int)p_Var1 + 4);
  }
  local_44.ncb_command = '2';
  local_44.ncb_lana_num = 0;
  do {
    UVar2 = Netbios(&local_44);
    if (UVar2 == '\0') {
      if (local_44.ncb_lana_num < 10) {
        for (iVar3 = 0x10; puVar4 = puVar4 + 1, iVar3 != 0; iVar3 = iVar3 + -1) {
          *puVar4 = 0;
        }
        builtin_memcpy(local_44.ncb_callname,"*           ",0xc);
        builtin_memcpy(local_44.ncb_callname + 0xc,"    ",4);
        local_44.ncb_command = '3';
        local_44.ncb_name[0] = '\0';
        local_44.ncb_buffer = param_1;
        local_44.ncb_length = 0xf0;
        UVar2 = Netbios(&local_44);
        if (UVar2 == '\0') {
          FUN_1002d447(local_4);
          return;
        }
      }
      break;
    }
    local_44.ncb_lana_num = local_44.ncb_lana_num + 1;
  } while (local_44.ncb_lana_num < 10);
  FUN_1002d447(local_4);
  return;
}



undefined4 FUN_10001710(void)

{
  if (DAT_100423e0 != 0) {
    return 0xffffffff;
  }
  FUN_10003a60(2);
  DAT_100423e0 = 1;
  DAT_100423e4 = 0;
  DAT_100423e8 = 0;
  return 0;
}



void __cdecl FUN_10001750(int param_1,undefined4 *param_2)

{
  undefined4 local_f4;
  undefined2 local_f0;
  int local_4;
  
  local_4 = DAT_10041558;
  if (param_1 == 0x6f70656e) {
    FUN_1002d447(DAT_10041558);
    return;
  }
  if (DAT_100423e0 == 1) {
    if (param_1 == 0x6f6e6c6e) {
      FUN_1002d447(DAT_10041558);
      return;
    }
    if (param_1 == 0x636f6e6e) {
      FUN_1002d447(DAT_10041558);
      return;
    }
    if (param_1 == 0x61646472) {
      FUN_100040a0();
      FUN_1002d447(local_4);
      return;
    }
    if (param_1 == 0x6d616378) {
      FUN_10001640((PUCHAR)&local_f4);
      *param_2 = local_f4;
      *(undefined2 *)(param_2 + 1) = local_f0;
      FUN_1002d447(local_4);
      return;
    }
  }
  FUN_1002d447(DAT_10041558);
  return;
}



undefined4 FUN_10001850(void)

{
  FUN_10001b20();
  FUN_10004050();
  DAT_100423e0 = 0;
  return 0;
}



void __cdecl FUN_10001870(int param_1)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  
  piVar3 = (int *)(param_1 + 0x8c);
  iVar2 = 4;
  do {
    iVar1 = *piVar3;
    if (iVar1 != 0) {
      (**(code **)(iVar1 + 4))(iVar1);
    }
    *piVar3 = 0;
    piVar3 = piVar3 + 3;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  if (*(DWORD **)(param_1 + 0x68) != (DWORD *)0x0) {
    FUN_10004a60(*(DWORD **)(param_1 + 0x68));
    *(undefined4 *)(param_1 + 0x68) = 0;
  }
  if (*(DWORD **)(param_1 + 100) != (DWORD *)0x0) {
    FUN_10004a60(*(DWORD **)(param_1 + 100));
    *(undefined4 *)(param_1 + 100) = 0;
  }
  *(undefined4 *)(param_1 + 0x78) = 0;
  return;
}



void __cdecl FUN_100018d0(int param_1,int param_2,int param_3)

{
  if (param_2 == 0x6d776964) {
    if (param_3 < 0x201) {
      *(int *)(param_1 + 0x7c) = param_3 + 0xe;
      return;
    }
  }
  else {
    if (param_2 == 0x6d696e70) {
      *(int *)(param_1 + 0x84) = param_3;
      return;
    }
    if (param_2 == 0x6d6f7574) {
      *(int *)(param_1 + 0x80) = param_3;
      return;
    }
    if (param_2 == 0x61647666) {
      *(int *)(param_1 + 0x88) = param_3;
    }
  }
  return;
}



void __cdecl FUN_10001940(int *param_1,char *param_2,char *param_3,char *param_4)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  char local_104 [256];
  int local_4;
  
  local_4 = DAT_10041558;
  if (param_1[0x19] == 0) {
    iVar2 = FUN_100048d0(0x10);
    param_1[0x19] = iVar2;
  }
  if ((param_3 == (char *)0x0) || (*param_3 == '\0')) {
    _sprintf(local_104,"Default Name");
    pcVar3 = (char *)*param_1;
    if ((char *)*param_1 == (char *)0x0) {
      pcVar3 = PTR_s_00_e0_98_8f_f8_e4_Greg_s_PC_00_e_10041080;
    }
    pcVar3 = _strstr(pcVar3,local_104);
    if (pcVar3 != (char *)0x0) {
      pcVar4 = _strchr(pcVar3,0x3a);
      cVar1 = pcVar4[1];
      pcVar3 = local_104;
      if ('\x1f' < cVar1) {
        do {
          *pcVar3 = cVar1;
          cVar1 = pcVar3[(int)(pcVar4 + 1 + (1 - (int)local_104))];
          pcVar3 = pcVar3 + 1;
        } while ('\x1f' < cVar1);
      }
      *pcVar3 = '\0';
    }
    param_3 = local_104;
  }
  pcVar3 = param_2;
  do {
    cVar1 = *pcVar3;
    pcVar3[(int)param_1 + (4 - (int)param_2)] = cVar1;
    pcVar3 = pcVar3 + 1;
  } while (cVar1 != '\0');
  FUN_100045e0((void *)param_1[0x19],(DWORD *)param_1[0x19],param_2,param_3,param_4,
               "TCP:~1:1024\tUDP:~1:1024",param_1[0x22]);
  FUN_1002d447(local_4);
  return;
}



void __cdecl FUN_10001a40(int param_1)

{
  if (*(DWORD **)(param_1 + 100) != (DWORD *)0x0) {
    FUN_10004a60(*(DWORD **)(param_1 + 100));
    *(undefined4 *)(param_1 + 100) = 0;
  }
  return;
}



undefined4 * FUN_10001a60(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)FUN_10001510(0xbc);
  if (puVar1 != (undefined4 *)0x0) {
    puVar3 = puVar1;
    for (iVar2 = 0x2f; iVar2 != 0; iVar2 = iVar2 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
  }
  puVar1[0x21] = 0x20;
  puVar1[0x20] = 0x20;
  puVar1[0x1f] = 0xfe;
  return puVar1;
}



void __cdecl FUN_10001aa0(LPVOID param_1)

{
  FUN_10001870((int)param_1);
  FUN_10001530(param_1);
  return;
}



void FUN_10001ac0(void)

{
  int iVar1;
  DWORD DVar2;
  int *piVar3;
  
  iVar1 = FUN_10001750(0x6f70656e,(undefined4 *)0x0);
  if (iVar1 != 0) {
    DVar2 = GetTickCount();
    if (DVar2 < DAT_10042490) {
      return;
    }
    DVar2 = GetTickCount();
    DAT_10042490 = DVar2 + 5;
  }
  piVar3 = &DAT_100423f0;
  do {
    if (*piVar3 != 0) {
      DVar2 = GetTickCount();
      (*(code *)*piVar3)(piVar3[1],DVar2);
    }
    piVar3 = piVar3 + 2;
  } while ((int)piVar3 < 0x10042470);
  return;
}



void FUN_10001b20(void)

{
  int *piVar1;
  
  piVar1 = &DAT_100423f0;
  do {
    if (*piVar1 != 0) {
      *piVar1 = 0;
      piVar1[1] = 0;
    }
    piVar1 = piVar1 + 2;
  } while ((int)piVar1 < 0x10042470);
  return;
}



void __fastcall FUN_10001b40(int param_1)

{
  byte bVar1;
  byte *in_EAX;
  int *unaff_ESI;
  
  if (param_1 < 1) {
    param_1 = 0x100;
  }
  *unaff_ESI = 0;
  bVar1 = *in_EAX;
  for (; (('/' < (char)bVar1 && ((char)bVar1 < ':')) && (0 < param_1)); param_1 = param_1 + -1) {
    in_EAX = in_EAX + 1;
    *unaff_ESI = (bVar1 & 0xf) + *unaff_ESI * 10;
    bVar1 = *in_EAX;
  }
  return;
}



undefined4 * __cdecl FUN_10001b90(undefined4 *param_1)

{
  int iVar1;
  ulonglong uVar2;
  uint in_EAX;
  uint uVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  uint uVar7;
  
  uVar3 = in_EAX / 0x15180;
  uVar2 = ((ulonglong)in_EAX % 0x15180) / 0x3c;
  *param_1 = (int)(((ulonglong)in_EAX % 0x15180) % 0x3c);
  param_1[1] = (int)(uVar2 % 0x3c);
  param_1[2] = (int)(uVar2 / 0x3c);
  uVar7 = 0x7b2;
  while( true ) {
    if (((uVar7 & 3) == 0) && (((int)uVar7 % 100 != 0 || ((int)uVar7 % 400 == 0)))) {
      uVar4 = 0x16e;
    }
    else {
      uVar4 = 0x16d;
    }
    if ((int)uVar3 < (int)uVar4) break;
    uVar4 = (int)uVar3 / 0x16e + uVar7;
    if (uVar4 == uVar7) {
      uVar4 = uVar4 + 1;
    }
    iVar6 = uVar7 - 1;
    iVar1 = uVar4 - 1;
    uVar3 = uVar3 + ((((((uVar7 - uVar4) * 0x16d + iVar6 / 400) - iVar1 / 400) - iVar6 / 100) +
                      iVar1 / 100 + ((int)(iVar6 + (iVar6 >> 0x1f & 3U)) >> 2)) -
                    ((int)(iVar1 + (iVar1 >> 0x1f & 3U)) >> 2));
    uVar7 = uVar4;
  }
  piVar5 = &DAT_10039a28 + (uVar4 & 1) * 0xc;
  param_1[5] = uVar7 - 0x76c;
  param_1[7] = uVar3;
  param_1[4] = 0;
  iVar6 = *piVar5;
  if (iVar6 <= (int)uVar3) {
    do {
      uVar3 = uVar3 - iVar6;
      piVar5 = piVar5 + 1;
      param_1[4] = param_1[4] + 1;
      iVar6 = *piVar5;
    } while (iVar6 <= (int)uVar3);
  }
  param_1[8] = 0;
  param_1[3] = uVar3 + 1;
  return param_1;
}



uint __cdecl FUN_10001ce0(int *param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  int local_14;
  int local_10;
  
  uVar4 = 0;
  uVar2 = 0xffffffff;
  do {
    uVar3 = (uVar2 & uVar4 & 1) + (uVar2 >> 1) + (uVar4 >> 1);
    FUN_10001b90(&local_24);
    iVar1 = local_10 - param_1[5];
    if ((((iVar1 == 0) && (iVar1 = local_14 - param_1[4], iVar1 == 0)) &&
        (iVar1 = local_18 - param_1[3], iVar1 == 0)) &&
       (((iVar1 = local_1c - param_1[2], iVar1 == 0 && (iVar1 = local_20 - param_1[1], iVar1 == 0))
        && (iVar1 = local_24 - *param_1, iVar1 == 0)))) break;
    if (iVar1 < 1) {
      uVar4 = uVar3 + 1;
    }
    else {
      uVar2 = uVar3 - 1;
    }
  } while (uVar4 <= uVar2);
  return (iVar1 != 0) - 1 & uVar3;
}



int __cdecl FUN_10001d70(int param_1)

{
  byte bVar1;
  int iVar2;
  byte *in_EAX;
  int iVar3;
  uint uVar4;
  undefined1 *unaff_EBX;
  undefined1 *puVar5;
  
  bVar1 = *in_EAX;
  uVar4 = 0;
  iVar2 = 0;
  puVar5 = unaff_EBX;
  while ((0x7f < bVar1 && (0 < param_1))) {
    iVar3 = iVar2 + 7;
    uVar4 = uVar4 | (*in_EAX & 0x7f) << ((byte)iVar2 & 0x1f);
    in_EAX = in_EAX + 1;
    if (7 < iVar3) {
      *puVar5 = (char)uVar4;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 >> 8;
      iVar3 = iVar2 + -1;
      param_1 = param_1 + -1;
    }
    bVar1 = *in_EAX;
    iVar2 = iVar3;
  }
  return (int)puVar5 - (int)unaff_EBX;
}



int __cdecl FUN_10001dc0(byte *param_1,int param_2,byte *param_3)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte bVar5;
  uint uVar6;
  byte bVar7;
  int iVar8;
  uint uVar9;
  byte *pbVar10;
  byte *pbVar11;
  bool bVar12;
  
  if (param_1 == (byte *)0x0) {
    return -1;
  }
  if ((param_3 == (byte *)0x0) || (bVar2 = *param_3, bVar2 < 0x21)) {
    return -1;
  }
  pbVar4 = param_1;
  pbVar3 = param_1;
  if (bVar2 == 0x7e) {
    if (*param_1 != 0) {
      do {
        pbVar11 = pbVar3;
        pbVar3 = pbVar11 + 1;
      } while (pbVar11[1] != 0);
      pbVar4 = pbVar3;
      if (((pbVar3 != param_1) && (0x1f < *pbVar11)) &&
         (((uint)*pbVar11 != (int)(char)DAT_10041084 && (pbVar3 < param_1 + param_2 + -1)))) {
        *pbVar3 = DAT_10041084;
        pbVar3 = pbVar11 + 2;
        *pbVar3 = 0;
        pbVar4 = pbVar3;
      }
    }
  }
  else if (*param_1 != 0) {
    do {
      if (0x20 < *pbVar4) {
        pbVar3 = pbVar4;
        if ((&DAT_10039808)[*pbVar4] != '\x01') {
          bVar5 = (&DAT_10039808)[*pbVar4];
          bVar7 = (&DAT_10039808)[(char)bVar2];
          if (bVar5 == bVar7) {
            pbVar11 = param_3;
            do {
              if (bVar5 < 2) break;
              bVar5 = (&DAT_10039808)[pbVar11[(int)(pbVar4 + (1 - (int)param_3))]];
              bVar7 = (&DAT_10039808)[(char)pbVar11[1]];
              pbVar11 = pbVar11 + 1;
            } while (bVar5 == bVar7);
          }
          if ((uint)bVar7 + (uint)bVar5 != 2) {
            do {
              pbVar3 = pbVar4 + 1;
              pbVar4 = pbVar4 + 1;
            } while (0x1f < *pbVar3);
            goto LAB_10001ead;
          }
          bVar2 = *pbVar4;
          while (0x1f < bVar2) {
            pbVar11 = pbVar3 + 1;
            pbVar3 = pbVar3 + 1;
            bVar2 = *pbVar11;
          }
          if (*pbVar3 != 0) {
            pbVar3 = pbVar3 + 1;
          }
        }
        goto LAB_10001f13;
      }
      pbVar4 = pbVar4 + 1;
LAB_10001ead:
    } while (*pbVar4 != 0);
    pbVar3 = pbVar4;
    if ((((pbVar4 != param_1) && (0x1f < pbVar4[-1])) &&
        ((uint)pbVar4[-1] != (int)(char)DAT_10041084)) && (pbVar4 < param_1 + param_2 + -1)) {
      *pbVar4 = DAT_10041084;
      pbVar3 = pbVar4 + 1;
      *pbVar3 = 0;
      pbVar4 = pbVar3;
    }
  }
LAB_10001f13:
  iVar8 = 0;
  bVar2 = *param_3;
  while (0x1f < bVar2) {
    iVar8 = iVar8 + 1;
    bVar2 = param_3[iVar8];
  }
  uVar9 = iVar8 + 1;
  pbVar10 = pbVar4 + (uVar9 - (int)pbVar3);
  bVar2 = *pbVar3;
  pbVar11 = pbVar3;
  while (bVar2 != 0) {
    pbVar1 = pbVar11 + 1;
    pbVar11 = pbVar11 + 1;
    bVar2 = *pbVar1;
  }
  pbVar11 = pbVar11 + 1;
  if ((0 < (int)pbVar10) && ((int)(param_1 + (param_2 - (int)pbVar11)) < (int)pbVar10)) {
    return -1;
  }
  if (pbVar10 == (byte *)0x0) {
    bVar12 = true;
    uVar6 = uVar9;
    pbVar3 = pbVar4;
    pbVar11 = param_3;
    do {
      if (uVar6 == 0) break;
      uVar6 = uVar6 - 1;
      bVar12 = *pbVar3 == *pbVar11;
      pbVar3 = pbVar3 + 1;
      pbVar11 = pbVar11 + 1;
    } while (bVar12);
    if (bVar12) {
      return 0;
    }
  }
  else {
    if (0 < (int)pbVar10) {
      _memmove(pbVar3 + (int)pbVar10,pbVar3,(int)pbVar11 - (int)pbVar3);
    }
    if ((int)pbVar10 < 0) {
      _memmove(pbVar4,pbVar4 + -(int)pbVar10,(size_t)(pbVar11 + ((int)pbVar10 - (int)pbVar4)));
    }
  }
  pbVar3 = pbVar4;
  for (uVar6 = uVar9 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pbVar3 = *(undefined4 *)param_3;
    param_3 = param_3 + 4;
    pbVar3 = pbVar3 + 4;
  }
  for (uVar6 = uVar9 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
    *pbVar3 = *param_3;
    param_3 = param_3 + 1;
    pbVar3 = pbVar3 + 1;
  }
  if ((pbVar4[uVar9] == 0) && (DAT_10041084 != 10)) {
    pbVar4[iVar8] = 0;
    return iVar8;
  }
  pbVar4[iVar8] = DAT_10041084;
  return iVar8;
}



undefined1 __cdecl FUN_10001ff0(undefined1 param_1)

{
  undefined1 uVar1;
  
  uVar1 = DAT_10041084;
  DAT_10041084 = param_1;
  return uVar1;
}



byte * __cdecl FUN_10002000(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  
  if ((((param_1 == (byte *)0x0) || (bVar1 = *param_1, bVar1 == 0)) || (param_2 == (byte *)0x0)) ||
     (pbVar6 = param_2, *param_2 == 0)) {
    return (byte *)0x0;
  }
  do {
    pbVar3 = pbVar6;
    pbVar6 = pbVar3 + 1;
  } while (pbVar3[1] != 0);
  pbVar6 = param_1 + -1;
  pbVar5 = param_1;
  do {
    if ((bVar1 == 0x3d) || (bVar1 == 0x3a)) {
      if ((pbVar6[2] < 0x20) && (*pbVar6 < 0x21)) {
        return (byte *)0x0;
      }
      if (param_1 <= pbVar6) {
        pbVar4 = pbVar3 + (int)(pbVar6 + (1 - (int)pbVar5));
        pbVar2 = pbVar6;
        do {
          if ((pbVar4 < param_2) || ((&DAT_10039708)[*pbVar2] != (&DAT_10039708)[*pbVar4])) break;
          if ((pbVar4 == param_2) && ((pbVar2 == param_1 || (pbVar2[-1] < 0x21)))) {
            if (pbVar5[1] == 0x20) {
              return pbVar5 + 2;
            }
            return pbVar5 + 1;
          }
          pbVar2 = pbVar2 + -1;
          pbVar4 = pbVar4 + -1;
        } while (param_1 <= pbVar2);
      }
    }
    bVar1 = pbVar5[1];
    pbVar5 = pbVar5 + 1;
    pbVar6 = pbVar6 + 1;
    if (bVar1 == 0) {
      return (byte *)0x0;
    }
  } while( true );
}



void __cdecl FUN_100020d0(byte *param_1,byte *param_2,byte *param_3)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  byte *pbVar4;
  uint uVar5;
  uint uVar6;
  byte local_104 [256];
  int local_4;
  
  local_4 = DAT_10041558;
  if (param_2 == (byte *)0x0) {
    FUN_10002000(param_1,param_3);
    FUN_1002d447(local_4);
    return;
  }
  if (param_3 != (byte *)0x0) {
    iVar3 = -(int)param_2;
    do {
      bVar2 = *param_2;
      param_2[(int)(local_104 + iVar3)] = bVar2;
      param_2 = param_2 + 1;
      pbVar4 = param_3;
    } while (bVar2 != 0);
    do {
      bVar2 = *pbVar4;
      pbVar4 = pbVar4 + 1;
    } while (bVar2 != 0);
    uVar5 = (int)pbVar4 - (int)param_3;
    pbVar4 = &stack0xfffffefb;
    do {
      pbVar1 = pbVar4 + 1;
      pbVar4 = pbVar4 + 1;
    } while (*pbVar1 != 0);
    for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)pbVar4 = *(undefined4 *)param_3;
      param_3 = param_3 + 4;
      pbVar4 = pbVar4 + 4;
    }
    for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
      *pbVar4 = *param_3;
      param_3 = param_3 + 1;
      pbVar4 = pbVar4 + 1;
    }
    FUN_10002000(param_1,local_104);
    FUN_1002d447(local_4);
    return;
  }
  FUN_10002000(param_1,param_2);
  FUN_1002d447(local_4);
  return;
}



undefined4 __cdecl FUN_100021b0(byte *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  pbVar3 = FUN_10002000(param_1,param_2);
  pbVar4 = pbVar3;
  if (pbVar3 == (byte *)0x0) {
    return 0xffffffff;
  }
  for (; (pbVar4 != param_1 && (0x20 < pbVar4[-1])); pbVar4 = pbVar4 + -1) {
  }
  bVar2 = *pbVar3;
  while (0x1f < bVar2) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && (bVar2 < 0x20))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar3;
  while (bVar2 != 0) {
    *pbVar4 = bVar2;
    pbVar1 = pbVar3 + 1;
    pbVar4 = pbVar4 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  for (; (pbVar4 != param_1 && (pbVar4[-1] < 0x21)); pbVar4 = pbVar4 + -1) {
  }
  *pbVar4 = 0;
  return 0;
}



int __cdecl FUN_10002230(char *param_1,int param_2,char *param_3)

{
  int iVar1;
  char *pcVar2;
  
  iVar1 = param_2;
  pcVar2 = param_1;
  if (1 < param_2) {
    do {
      pcVar2 = param_1;
      if (*param_3 == '\0') break;
      pcVar2 = param_1 + 1;
      *param_1 = *param_3;
      param_3 = param_3 + 1;
      iVar1 = iVar1 + -1;
      param_1 = pcVar2;
    } while (1 < iVar1);
  }
  if (0 < iVar1) {
    *pcVar2 = '\0';
  }
  return param_2 - iVar1;
}



int __cdecl FUN_10002270(char *param_1,char *param_2,int param_3)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  int iVar4;
  char *pcVar5;
  
  iVar4 = 0;
  if (0 < param_3) {
    *param_2 = '\0';
  }
  if ((param_1 == (char *)0x0) || (cVar1 = *param_1, pcVar5 = param_1, cVar1 == '\0')) {
    return 0;
  }
  while ((cVar1 != '=' && (cVar1 != ':'))) {
    cVar1 = pcVar5[1];
    pcVar5 = pcVar5 + 1;
    if (cVar1 == '\0') {
      return 0;
    }
  }
  if ((0x1f < (byte)pcVar5[1]) || (0x20 < (byte)pcVar5[-1])) {
    pcVar2 = pcVar5;
    if (pcVar5 != param_1) {
      do {
        if ((byte)pcVar2[-1] < 0x21) break;
        pcVar2 = pcVar2 + -1;
      } while (pcVar2 != param_1);
      if (pcVar2 != pcVar5) {
        pcVar3 = param_2;
        do {
          if (param_3 <= (int)(pcVar3 + (1 - (int)param_2))) break;
          iVar4 = iVar4 + 1;
          *pcVar3 = *pcVar2;
          pcVar3 = pcVar3 + 1;
          pcVar2 = pcVar2 + 1;
        } while (pcVar2 != pcVar5);
      }
    }
    param_2[iVar4] = '\0';
  }
  return iVar4;
}



void __cdecl FUN_10002310(byte *param_1,int param_2,byte *param_3,int param_4)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte local_124 [288];
  int local_4;
  
  local_4 = DAT_10041558;
  pbVar3 = local_124;
  if (param_3 == (byte *)0x0) {
    *param_1 = 0;
  }
  else {
    bVar1 = *param_3;
    if (bVar1 != 0) {
      do {
        *pbVar3 = bVar1;
        bVar1 = pbVar3[(int)(param_3 + (1 - (int)local_124))];
        pbVar3 = pbVar3 + 1;
      } while (bVar1 != 0);
    }
    *pbVar3 = 0x3d;
    pbVar3 = pbVar3 + 1;
  }
  if (param_4 < 0) {
    *pbVar3 = 0x2d;
    pbVar3 = pbVar3 + 1;
    param_4 = -param_4;
  }
  pbVar2 = pbVar3 + 0x1f;
  *pbVar2 = 0;
  for (; 0 < param_4; param_4 = param_4 / 10) {
    pbVar2 = pbVar2 + -1;
    *pbVar2 = (char)(param_4 % 10) + 0x30;
  }
  bVar1 = *pbVar2;
  if (bVar1 == 0) {
    pbVar2 = pbVar2 + -1;
    *pbVar2 = 0x30;
    bVar1 = *pbVar2;
    if (bVar1 == 0) goto LAB_100023ae;
  }
  do {
    *pbVar3 = bVar1;
    bVar1 = pbVar2[1];
    pbVar3 = pbVar3 + 1;
    pbVar2 = pbVar2 + 1;
  } while (bVar1 != 0);
LAB_100023ae:
  *pbVar3 = 0;
  FUN_10001dc0(param_1,param_2,local_124);
  FUN_1002d447(local_4);
  return;
}



void __cdecl FUN_100023e0(byte *param_1,int param_2,byte *param_3,uint param_4)

{
  byte *pbVar1;
  byte bVar2;
  char *pcVar3;
  byte local_124 [288];
  int local_4;
  
  local_4 = DAT_10041558;
  pbVar1 = local_124;
  if (param_3 == (byte *)0x0) {
    *param_1 = 0;
  }
  else {
    bVar2 = *param_3;
    if (bVar2 != 0) {
      do {
        *pbVar1 = bVar2;
        bVar2 = pbVar1[(int)(param_3 + (1 - (int)local_124))];
        pbVar1 = pbVar1 + 1;
      } while (bVar2 != 0);
    }
    *pbVar1 = 0x3d;
    pbVar1 = pbVar1 + 1;
  }
  pcVar3 = "@ABCDEFGHIJKLMNOPQRSTUVWXYZ0123";
  if (param_4 != 0) {
    do {
      if (*pcVar3 == 0) break;
      if ((param_4 & 1) != 0) {
        *pbVar1 = *pcVar3;
        pbVar1 = pbVar1 + 1;
      }
      param_4 = (int)param_4 >> 1;
      pcVar3 = (char *)((byte *)pcVar3 + 1);
    } while (param_4 != 0);
  }
  *pbVar1 = 0;
  FUN_10001dc0(param_1,param_2,local_124);
  FUN_1002d447(local_4);
  return;
}



void __cdecl FUN_10002490(byte *param_1,int param_2,byte *param_3,uint param_4)

{
  ulonglong uVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte bVar7;
  byte bVar8;
  uint uVar9;
  byte local_124 [288];
  int local_4;
  
  local_4 = DAT_10041558;
  pbVar5 = local_124;
  if (param_3 == (byte *)0x0) {
    *param_1 = 0;
  }
  else {
    bVar3 = *param_3;
    if (bVar3 != 0) {
      do {
        *pbVar5 = bVar3;
        bVar3 = pbVar5[(int)(param_3 + (1 - (int)local_124))];
        pbVar5 = pbVar5 + 1;
      } while (bVar3 != 0);
    }
    *pbVar5 = 0x3d;
    pbVar5 = pbVar5 + 1;
  }
  bVar8 = (byte)param_4;
  bVar2 = (byte)(param_4 >> 8);
  uVar9 = param_4 >> 0x10;
  bVar7 = (byte)(param_4 >> 0x10);
  uVar4 = param_4 >> 0x18;
  bVar3 = (byte)(param_4 >> 0x18);
  if (9 < bVar3) {
    pbVar6 = pbVar5;
    if (99 < bVar3) {
      uVar1 = (ulonglong)uVar4;
      uVar4 = uVar4 % 100;
      pbVar6 = pbVar5 + 1;
      *pbVar5 = (char)(uVar1 / 100) + 0x30;
    }
    *pbVar6 = (char)((ulonglong)uVar4 / 10) + 0x30;
    bVar3 = (byte)((ulonglong)uVar4 % 10);
    pbVar5 = pbVar6 + 1;
  }
  *pbVar5 = bVar3 + 0x30;
  pbVar5[1] = 0x2e;
  pbVar6 = pbVar5 + 2;
  if (9 < bVar7) {
    if (99 < bVar7) {
      *pbVar6 = (char)((ulonglong)(uVar9 & 0xff) / 100) + 0x30;
      pbVar6 = pbVar5 + 3;
      uVar9 = (uint)(byte)((ulonglong)(uVar9 & 0xff) % 100);
    }
    *pbVar6 = (char)((ulonglong)(uVar9 & 0xff) / 10) + 0x30;
    bVar7 = (byte)((ulonglong)(uVar9 & 0xff) % 10);
    pbVar6 = pbVar6 + 1;
  }
  *pbVar6 = bVar7 + 0x30;
  pbVar6[1] = 0x2e;
  pbVar5 = pbVar6 + 2;
  uVar4 = (uint)bVar2;
  if (9 < bVar2) {
    if (99 < bVar2) {
      uVar4 = (uint)bVar2 % 100;
      *pbVar5 = (char)((ulonglong)(uint)bVar2 / 100) + 0x30;
      pbVar5 = pbVar6 + 3;
    }
    *pbVar5 = (char)((ulonglong)uVar4 / 10) + 0x30;
    pbVar5 = pbVar5 + 1;
    bVar2 = (byte)(uVar4 % 10);
  }
  *pbVar5 = bVar2 + 0x30;
  pbVar5[1] = 0x2e;
  pbVar6 = pbVar5 + 2;
  if (9 < bVar8) {
    if (99 < bVar8) {
      bVar3 = bVar8 / 100;
      bVar8 = bVar8 % 100;
      *pbVar6 = bVar3 + 0x30;
      pbVar6 = pbVar5 + 3;
    }
    bVar3 = bVar8 / 10;
    bVar8 = bVar8 % 10;
    *pbVar6 = bVar3 + 0x30;
    pbVar6 = pbVar6 + 1;
  }
  *pbVar6 = bVar8 + 0x30;
  pbVar6[1] = 0;
  FUN_10001dc0(param_1,param_2,local_124);
  FUN_1002d447(local_4);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_10002620(byte *param_1,int param_2,byte *param_3,byte *param_4)

{
  byte bVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  byte *pbVar5;
  byte bVar6;
  byte *pbVar7;
  int iVar8;
  byte *pbVar9;
  byte local_1204 [4607];
  undefined1 uStack_5;
  int local_4;
  
  iVar4 = DAT_10041558;
  pbVar9 = local_1204;
  pbVar5 = local_1204;
  local_4 = DAT_10041558;
  if (param_4 == (byte *)0x0) {
    FUN_100021b0(param_1,param_3);
    FUN_1002d447(local_4);
    return;
  }
  if (param_3 == (byte *)0x0) {
    *param_1 = 0;
  }
  else {
    bVar6 = *param_3;
    if (bVar6 != 0) {
      pbVar9 = local_1204;
      do {
        *pbVar9 = bVar6;
        bVar6 = pbVar9[(int)(param_3 + (1 - (int)local_1204))];
        pbVar9 = pbVar9 + 1;
      } while (bVar6 != 0);
    }
    *pbVar9 = 0x3d;
    pbVar5 = pbVar9 + 1;
  }
  piVar3 = &local_4;
  bVar1 = *param_4;
  bVar6 = bVar1;
  pbVar9 = param_4;
  while (bVar6 != 0) {
    if (bVar6 == 0x20) goto LAB_100026d5;
    pbVar7 = pbVar9 + 1;
    pbVar9 = pbVar9 + 1;
    bVar6 = *pbVar7;
  }
  pbVar7 = pbVar5;
  if (*pbVar9 == 0x20) {
LAB_100026d5:
    *pbVar5 = 0x22;
    pbVar7 = pbVar5 + 1;
    piVar3 = (int *)&uStack_5;
  }
  iVar8 = (int)piVar3 - (int)pbVar5;
  while (bVar1 != 0) {
    if (iVar8 < 1) goto LAB_10002737;
    bVar6 = *param_4;
    if ((((bVar6 < 0x20) || (bVar6 == 0x7f)) || (bVar6 == 0x3d)) ||
       (((bVar6 == 0x22 || (bVar6 == 0x3a)) || ((bVar6 == 0x25 || (bVar6 == 0x5e)))))) {
      if (2 < iVar8) {
        *pbVar7 = 0x25;
        bVar1 = "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                [bVar6 + 0x110];
        pbVar7[1] = "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                    [bVar6 + 0x10];
        pbVar7[2] = bVar1;
        pbVar7 = pbVar7 + 3;
      }
      iVar2 = -3;
    }
    else {
      *pbVar7 = bVar6;
      pbVar7 = pbVar7 + 1;
      iVar2 = -1;
    }
    iVar8 = iVar8 + iVar2;
    pbVar5 = param_4 + 1;
    param_4 = param_4 + 1;
    bVar1 = *pbVar5;
  }
  if (0 < iVar8) {
    if (*pbVar9 == 0x20) {
      *pbVar7 = 0x22;
      pbVar7 = pbVar7 + 1;
    }
    *pbVar7 = 0;
    FUN_10001dc0(param_1,param_2,local_1204);
    FUN_1002d447(local_4);
    return;
  }
LAB_10002737:
  FUN_1002d447(iVar4);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_100027a0(byte *param_1,int param_2,char *param_3,byte *param_4,int param_5)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  char *pcVar4;
  char cVar5;
  byte local_2104 [8448];
  int local_4;
  
  iVar1 = DAT_10041558;
  pbVar2 = local_2104;
  pbVar3 = local_2104;
  local_4 = DAT_10041558;
  if (param_3 == (char *)0x0) {
    *param_1 = 0;
  }
  else {
    cVar5 = *param_3;
    if (cVar5 != '\0') {
      pbVar2 = local_2104;
      do {
        *pbVar2 = cVar5;
        cVar5 = ((char *)pbVar2)[(int)(param_3 + (1 - (int)local_2104))];
        pbVar2 = (byte *)((char *)pbVar2 + 1);
      } while (cVar5 != '\0');
    }
    *pbVar2 = '=';
    pbVar3 = (byte *)((char *)pbVar2 + 1);
  }
  *pbVar3 = '$';
  pcVar4 = (char *)pbVar3 + 1;
  if ((uint)((int)&local_4 - (int)pcVar4) < param_5 * 2 + 1U) {
    FUN_1002d447(iVar1);
    return;
  }
  if (0 < param_5) {
    do {
      cVar5 = "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
              [*param_4 + 0x110];
      *pcVar4 = "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                [*param_4 + 0x10];
      pcVar4[1] = cVar5;
      pcVar4 = pcVar4 + 2;
      param_4 = param_4 + 1;
      param_5 = param_5 + -1;
    } while (param_5 != 0);
  }
  *pcVar4 = '\0';
  FUN_10001dc0(param_1,param_2,local_2104);
  FUN_1002d447(local_4);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl
FUN_10002880(byte *param_1,int param_2,byte *param_3,uint *param_4,int param_5,byte *param_6)

{
  uint *puVar1;
  byte bVar2;
  uint *puVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  int iVar7;
  uint uVar8;
  byte *pbVar9;
  int iVar10;
  int iVar11;
  uint *local_1210;
  uint *local_1208;
  byte local_1204 [4608];
  int local_4;
  
  local_4 = DAT_10041558;
  uVar8 = 0;
  if (param_5 < 0) {
    puVar3 = param_4 + 0x4000;
  }
  else {
    puVar3 = (uint *)((int)param_4 + param_5);
  }
  pbVar6 = local_1204;
  if (param_3 == (byte *)0x0) {
    *param_1 = 0;
  }
  else {
    bVar2 = *param_3;
    if (bVar2 != 0) {
      do {
        *pbVar6 = bVar2;
        bVar2 = pbVar6[(int)(param_3 + (1 - (int)local_1204))];
        pbVar6 = pbVar6 + 1;
      } while (bVar2 != 0);
    }
    *pbVar6 = 0x3d;
    pbVar6 = pbVar6 + 1;
  }
  bVar2 = *param_6;
  local_1210 = param_4;
  do {
    if ((bVar2 == 0) || (puVar3 <= local_1210)) {
      bVar2 = pbVar6[-1];
      while (bVar2 == 0x2c) {
        pbVar9 = pbVar6 + -2;
        pbVar6 = pbVar6 + -1;
        bVar2 = *pbVar9;
      }
      *pbVar6 = 0;
      FUN_10001dc0(param_1,param_2,local_1204);
      FUN_1002d447(local_4);
      return;
    }
    if (bVar2 == 0x23) {
      param_6 = param_6 + 1;
      do {
        bVar2 = *param_6;
        if (bVar2 == 0) break;
        param_6 = param_6 + 1;
      } while (bVar2 != 0x3d);
    }
    iVar10 = 0;
    bVar2 = *param_6;
    pbVar9 = param_6;
    while (('/' < (char)bVar2 && ((char)bVar2 < ':'))) {
      pbVar9 = pbVar9 + 1;
      iVar10 = (bVar2 & 0xf) + iVar10 * 10;
      bVar2 = *pbVar9;
    }
    bVar2 = *pbVar9;
    iVar11 = 0;
    local_1208 = (uint *)0x0;
    if (bVar2 == 0x61) {
      iVar7 = iVar10;
      if (iVar10 == 0) {
        iVar7 = 1;
      }
      local_1210 = (uint *)((int)local_1210 + iVar7);
    }
    if (bVar2 == 0x62) {
      uVar8 = (uint)(byte)*local_1210;
      local_1210 = (uint *)((int)local_1210 + 1);
      iVar11 = 2;
    }
    if (bVar2 == 0x77) {
      uVar8 = (uint)(ushort)*local_1210;
      local_1210 = (uint *)((int)local_1210 + 2);
      iVar11 = 4;
    }
    if (bVar2 == 0x6c) {
      uVar8 = *local_1210;
      local_1210 = local_1210 + 1;
      iVar11 = 8;
    }
    puVar1 = local_1210;
    if (bVar2 == 0x73) {
      puVar1 = (uint *)((int)local_1210 + iVar10);
      local_1208 = local_1210;
    }
    local_1210 = puVar1;
    if (iVar11 != 0) {
      pbVar5 = pbVar6;
      if (0xffff0000 < uVar8) {
        uVar8 = -uVar8;
        *pbVar6 = 0x2d;
        pbVar5 = pbVar6 + 1;
      }
      pbVar6 = pbVar5 + iVar11;
      *pbVar6 = 0;
      pbVar4 = pbVar6;
      for (; uVar8 != 0; uVar8 = uVar8 >> 4) {
        pbVar4 = pbVar4 + -1;
        *pbVar4 = "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                  [(uVar8 & 0xf) + 0x110];
      }
      if (pbVar5 != pbVar4) {
        bVar2 = *pbVar4;
        while (bVar2 != 0) {
          *pbVar5 = bVar2;
          pbVar6 = pbVar4 + 1;
          pbVar5 = pbVar5 + 1;
          pbVar4 = pbVar4 + 1;
          bVar2 = *pbVar6;
        }
        *pbVar5 = 0x2c;
        pbVar6 = pbVar5 + 1;
      }
    }
    if (local_1208 != (uint *)0x0) {
      bVar2 = (byte)*local_1208;
      while (bVar2 != 0) {
        uVar8 = (uint)bVar2;
        local_1208 = (uint *)((int)local_1208 + 1);
        if ((byte)(&DAT_10039808)[uVar8] < 2) {
          *pbVar6 = 0x25;
          pbVar6[1] = "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                      [uVar8 + 0x10];
          pbVar6 = pbVar6 + 2;
          *pbVar6 = "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                    [uVar8 + 0x110];
        }
        else {
          *pbVar6 = bVar2;
        }
        pbVar6 = pbVar6 + 1;
        bVar2 = *(byte *)local_1208;
      }
      *pbVar6 = 0x2c;
      pbVar6 = pbVar6 + 1;
    }
    param_6 = pbVar9 + 1;
    if (pbVar9[1] == 0x2a) {
      param_6 = pbVar9;
    }
    bVar2 = *param_6;
  } while( true );
}



void __cdecl FUN_10002ad0(byte *param_1,int param_2,byte *param_3,int param_4)

{
  undefined4 *puVar1;
  byte *_Dest;
  byte bVar2;
  undefined4 local_148 [9];
  byte local_124 [288];
  int local_4;
  
  local_4 = DAT_10041558;
  if (param_4 == 0) {
    FUN_10004f60();
  }
  puVar1 = FUN_10001b90(local_148);
  if (puVar1 == (undefined4 *)0x0) {
    FUN_1002d447(local_4);
    return;
  }
  _Dest = local_124;
  if (param_3 == (byte *)0x0) {
    *param_1 = 0;
  }
  else {
    bVar2 = *param_3;
    if (bVar2 != 0) {
      do {
        *_Dest = bVar2;
        bVar2 = _Dest[(int)(param_3 + (1 - (int)local_124))];
        _Dest = _Dest + 1;
      } while (bVar2 != 0);
    }
    *_Dest = 0x3d;
    _Dest = _Dest + 1;
  }
  _sprintf((char *)_Dest,"%d.%d.%d %d:%02d:%02d",puVar1[5] + 0x76c,puVar1[4] + 1,puVar1[3],puVar1[2]
           ,puVar1[1],*puVar1);
  FUN_10001dc0(param_1,param_2,local_124);
  FUN_1002d447(local_4);
  return;
}



void __cdecl FUN_10002bb0(byte *param_1,int param_2,byte *param_3,byte *param_4)

{
  byte *pbVar1;
  
  pbVar1 = FUN_10002000(param_4,param_3);
  if (pbVar1 == (byte *)0x0) {
    return;
  }
  for (; (pbVar1 != param_4 && (0x20 < pbVar1[-1])); pbVar1 = pbVar1 + -1) {
  }
  FUN_10001dc0(param_1,param_2,pbVar1);
  return;
}



int __cdecl FUN_10002bf0(byte *param_1,int param_2,byte *param_3)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  if (*param_3 == 0) {
    return 0;
  }
  do {
    bVar2 = *param_3;
    if (bVar2 < 0x21) {
      param_3 = param_3 + 1;
    }
    else {
      if (bVar2 == 0x3d) {
        return iVar4;
      }
      if (bVar2 == 0x3a) {
        return iVar4;
      }
      iVar3 = FUN_10001dc0(param_1,param_2,param_3);
      if (0 < iVar3) {
        iVar4 = iVar4 + 1;
      }
      bVar2 = *param_3;
      while (0x1f < bVar2) {
        pbVar1 = param_3 + 1;
        param_3 = param_3 + 1;
        bVar2 = *pbVar1;
      }
    }
    if (*param_3 == 0) {
      return iVar4;
    }
  } while( true );
}



int __cdecl FUN_10002c50(byte *param_1,byte *param_2,byte *param_3)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte **ppbVar6;
  byte *pbVar7;
  
  pbVar1 = param_2;
  bVar2 = *param_3;
  param_2 = &DAT_10039247;
  pbVar7 = pbVar1;
  if (bVar2 != 0) {
    ppbVar6 = &param_3;
    do {
      pbVar5 = param_3 + 1;
      if ((int)pbVar7 < 2) break;
      if (bVar2 < 0x21) {
        *param_1 = DAT_10041084;
        param_1 = param_1 + 1;
        pbVar7 = pbVar7 + -1;
        bVar2 = *pbVar5;
        while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
          pbVar4 = pbVar5 + 1;
          pbVar5 = pbVar5 + 1;
          bVar2 = *pbVar4;
        }
      }
      else if (bVar2 == 0x25) {
        bVar2 = *pbVar5;
        if (bVar2 != 0) {
          pbVar5 = param_3 + 2;
          if (param_1[-1] == 0x3d) {
            param_1 = param_1 + -1;
            pbVar7 = pbVar7 + 1;
          }
          *param_1 = 0;
          param_3 = pbVar5;
          if (bVar2 == 0x73) {
            pbVar4 = ppbVar6[1];
LAB_10002ccb:
            iVar3 = FUN_10002620(param_1,(int)pbVar7,&DAT_10039247,pbVar4);
          }
          else if (bVar2 == 100) {
            iVar3 = FUN_10002310(param_1,(int)pbVar7,&DAT_10039247,(int)ppbVar6[1]);
          }
          else if (bVar2 == 0x61) {
            iVar3 = FUN_10002490(param_1,(int)pbVar7,&DAT_10039247,(uint)ppbVar6[1]);
          }
          else if (bVar2 == 0x66) {
            iVar3 = FUN_100023e0(param_1,(int)pbVar7,&DAT_10039247,(uint)ppbVar6[1]);
          }
          else {
            if (bVar2 != 0x65) {
              if (bVar2 == 0x69) {
                param_2 = ppbVar6[1];
                ppbVar6 = ppbVar6 + 1;
              }
              else {
                if (bVar2 == 0x78) {
                  pbVar4 = FUN_10002000(param_2,ppbVar6[1]);
                  if (pbVar4 == (byte *)0x0) {
                    pbVar4 = &DAT_10039247;
                    goto LAB_10002ccb;
                  }
                  iVar3 = FUN_10001dc0(param_1,(int)pbVar7,pbVar4 + -1);
                  goto LAB_10002cda;
                }
                if (bVar2 == 0x72) {
                  pbVar4 = ppbVar6[1];
                  bVar2 = *pbVar4;
                  ppbVar6 = ppbVar6 + 1;
                  for (; (bVar2 != 0 && (0 < (int)pbVar7)); pbVar7 = pbVar7 + -1) {
                    *param_1 = bVar2;
                    bVar2 = pbVar4[1];
                    param_1 = param_1 + 1;
                    pbVar4 = pbVar4 + 1;
                  }
                }
              }
              goto LAB_10002ce2;
            }
            iVar3 = FUN_10002ad0(param_1,(int)pbVar7,&DAT_10039247,(int)ppbVar6[1]);
          }
LAB_10002cda:
          ppbVar6 = ppbVar6 + 1;
          if (0 < iVar3) {
            param_1 = param_1 + iVar3;
            pbVar7 = pbVar7 + -iVar3;
          }
        }
      }
      else {
        *param_1 = bVar2;
        param_1 = param_1 + 1;
        pbVar7 = pbVar7 + -1;
      }
LAB_10002ce2:
      bVar2 = *pbVar5;
      param_3 = pbVar5;
    } while (bVar2 != 0);
  }
  if (0 < (int)pbVar7) {
    *param_1 = 0;
  }
  return (int)pbVar1 - (int)pbVar7;
}



int __cdecl FUN_10002e80(byte *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  
  if (param_1 != (byte *)0x0) {
    iVar3 = 1;
    if (*param_1 == 0x2b) {
      param_1 = param_1 + 1;
    }
    else if (*param_1 == 0x2d) {
      param_1 = param_1 + 1;
      iVar3 = -1;
    }
    iVar2 = 0;
    bVar1 = *param_1;
    while (('/' < (char)bVar1 && ((char)bVar1 < ':'))) {
      param_1 = param_1 + 1;
      iVar2 = (bVar1 & 0xf) + iVar2 * 10;
      bVar1 = *param_1;
    }
    return iVar2 * iVar3;
  }
  return param_2;
}



uint __cdecl FUN_10002ed0(char *param_1,uint param_2)

{
  char *pcVar1;
  byte bVar2;
  uint uVar3;
  
  if (param_1 == (char *)0x0) {
    return param_2;
  }
  uVar3 = 0;
  bVar2 = (&DAT_10039928)[*param_1];
  while (-1 < (char)bVar2) {
    pcVar1 = param_1 + 1;
    uVar3 = uVar3 | 1 << (bVar2 & 0x1f);
    param_1 = param_1 + 1;
    bVar2 = (&DAT_10039928)[*pcVar1];
  }
  return uVar3;
}



uint __cdecl FUN_10002f10(byte *param_1,uint param_2)

{
  byte bVar1;
  
  if (param_1 != (byte *)0x0) {
    param_2 = 0;
    while( true ) {
      while( true ) {
        bVar1 = *param_1;
        if (((char)bVar1 < '0') || ('9' < (char)bVar1)) break;
        param_2 = param_2 & 0xffffff00 | (bVar1 & 0xf) + (param_2 & 0xff) * 10;
        param_1 = param_1 + 1;
      }
      if (bVar1 != 0x2e) break;
      param_2 = param_2 << 8;
      param_1 = param_1 + 1;
    }
  }
  return param_2;
}



int __cdecl
FUN_10002f60(byte *param_1,byte *param_2,int param_3,byte *param_4,int param_5,uint param_6)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  byte *pbVar5;
  byte local_1;
  
  local_1 = 0;
  bVar2 = 0;
  if (param_1 != (byte *)0x0) {
    if (*param_1 == 0x22) {
      bVar2 = 0x22;
      local_1 = 0x22;
      param_1 = param_1 + 1;
    }
    if (0 < param_5) {
      do {
        for (; ((bVar1 = *param_1, bVar1 != local_1 && (0x1f < bVar1)) && (bVar1 != param_6));
            param_1 = param_1 + 1) {
        }
        if ((int)(char)bVar1 != param_6) goto LAB_10002fb5;
        param_1 = param_1 + 1;
        param_5 = param_5 + -1;
      } while (0 < param_5);
    }
    if (param_1 != (byte *)0x0) {
      if (param_2 == (byte *)0x0) {
        iVar4 = 0;
        if (*param_1 != local_1) {
          while ((bVar2 = *param_1, 0x1f < bVar2 && (bVar2 != param_6))) {
            if ((bVar2 == 0x25) && ((0x1f < param_1[1] && (0x1f < param_1[2])))) {
              param_1 = param_1 + 2;
            }
            pbVar5 = param_1 + 1;
            iVar4 = iVar4 + 1;
            param_1 = param_1 + 1;
            if (*pbVar5 == local_1) {
              return iVar4;
            }
          }
        }
      }
      else {
        if (param_3 < 1) {
          return -1;
        }
        iVar4 = 1;
        if (1 < param_3) {
          do {
            bVar1 = *param_1;
            if (((bVar1 == local_1) || (bVar1 < 0x20)) || (bVar1 == param_6)) break;
            if (bVar1 == 0x25) {
              bVar3 = param_1[1];
              if (bVar3 == 0x25) {
                *param_2 = 0x25;
                param_1 = param_1 + 2;
              }
              else {
                if ((bVar3 < 0x20) || (local_1 = bVar2, param_1[2] < 0x20)) goto LAB_100030cd;
                *param_2 = (&DAT_10039608)[param_1[2]] |
                           "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                           [bVar3 + 0x210];
                param_1 = param_1 + 3;
              }
            }
            else {
LAB_100030cd:
              *param_2 = bVar1;
              param_1 = param_1 + 1;
            }
            param_2 = param_2 + 1;
            iVar4 = iVar4 + 1;
          } while (iVar4 < param_3);
        }
        *param_2 = 0;
        iVar4 = iVar4 + -1;
      }
      return iVar4;
    }
  }
LAB_10002fb5:
  if (param_4 == (byte *)0x0) {
    return -1;
  }
  if (param_2 == (byte *)0x0) {
    pbVar5 = param_4 + 1;
    do {
      bVar2 = *param_4;
      param_4 = param_4 + 1;
    } while (bVar2 != 0);
    return (int)param_4 - (int)pbVar5;
  }
  iVar4 = 1;
  pbVar5 = param_2;
  if (1 < param_3) {
    do {
      pbVar5 = param_2;
      if (*param_4 == 0) break;
      pbVar5 = param_2 + 1;
      *param_2 = *param_4;
      param_4 = param_4 + 1;
      iVar4 = iVar4 + 1;
      param_2 = pbVar5;
    } while (iVar4 < param_3);
  }
  *pbVar5 = 0;
  return iVar4 + -1;
}



int __cdecl FUN_100030f0(byte *param_1,byte *param_2,int param_3,byte *param_4)

{
  byte *pbVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  byte *pbVar5;
  
  pbVar5 = param_1;
  if (param_1 != (byte *)0x0) {
    if (*param_1 == 0x5e) {
      if (param_2 == (byte *)0x0) {
        pbVar5 = param_1 + 1;
        bVar2 = param_1[1];
        while (0x7f < bVar2) {
          pbVar1 = pbVar5 + 1;
          pbVar5 = pbVar5 + 1;
          bVar2 = *pbVar1;
        }
        return (int)((int)(pbVar5 + (-1 - (int)param_1)) * 7 +
                    ((int)(pbVar5 + (-1 - (int)param_1)) * 7 >> 0x1f & 7U)) >> 3;
      }
      if (param_3 < 1) {
        return -1;
      }
      iVar4 = FUN_10001d70(param_3 + -1);
      param_2[iVar4] = 0;
      return iVar4;
    }
    if (*param_1 == 0x22) {
      pbVar5 = param_1 + 1;
      param_1._0_1_ = 0x22;
    }
    else {
      param_1._0_1_ = 0;
    }
    if (param_2 == (byte *)0x0) {
      iVar4 = 0;
      if (*pbVar5 != (byte)param_1) {
        while (0x1f < *pbVar5) {
          if (((*pbVar5 == 0x25) && (0x1f < pbVar5[1])) && (0x1f < pbVar5[2])) {
            pbVar5 = pbVar5 + 2;
          }
          pbVar1 = pbVar5 + 1;
          iVar4 = iVar4 + 1;
          pbVar5 = pbVar5 + 1;
          if (*pbVar1 == (byte)param_1) {
            return iVar4;
          }
        }
      }
    }
    else {
      if (param_3 < 1) {
        return -1;
      }
      iVar4 = 1;
      if (1 < param_3) {
        do {
          bVar2 = *pbVar5;
          if ((bVar2 == (byte)param_1) || (bVar2 < 0x20)) break;
          if (bVar2 == 0x25) {
            bVar3 = pbVar5[1];
            if (bVar3 == 0x25) {
              *param_2 = 0x25;
              pbVar5 = pbVar5 + 2;
            }
            else {
              if ((bVar3 < 0x20) || (pbVar5[2] < 0x20)) goto LAB_10003268;
              *param_2 = (&DAT_10039608)[pbVar5[2]] |
                         "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                         [bVar3 + 0x210];
              pbVar5 = pbVar5 + 3;
            }
          }
          else {
LAB_10003268:
            *param_2 = bVar2;
            pbVar5 = pbVar5 + 1;
          }
          param_2 = param_2 + 1;
          iVar4 = iVar4 + 1;
        } while (iVar4 < param_3);
      }
      *param_2 = 0;
      iVar4 = iVar4 + -1;
    }
    return iVar4;
  }
  if (param_4 == (byte *)0x0) {
    return -1;
  }
  if (param_2 == (byte *)0x0) {
    pbVar5 = param_4 + 1;
    do {
      bVar2 = *param_4;
      param_4 = param_4 + 1;
    } while (bVar2 != 0);
    return (int)param_4 - (int)pbVar5;
  }
  iVar4 = 1;
  pbVar5 = param_2;
  if (1 < param_3) {
    do {
      pbVar5 = param_2;
      if (*param_4 == 0) break;
      pbVar5 = param_2 + 1;
      *param_2 = *param_4;
      param_4 = param_4 + 1;
      iVar4 = iVar4 + 1;
      param_2 = pbVar5;
    } while (iVar4 < param_3);
  }
  *pbVar5 = 0;
  return iVar4 + -1;
}



int __cdecl FUN_10003280(char *param_1,int param_2,int param_3)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  byte *pbVar6;
  
  if ((param_1 != (char *)0x0) && ((cVar1 = *param_1, cVar1 == '$' || (cVar1 == '^')))) {
    if (param_2 == 0) {
      iVar3 = 0;
      if (cVar1 != '$') {
        pcVar5 = param_1 + 1;
        bVar2 = param_1[1];
        while (0x7f < bVar2) {
          pbVar6 = (byte *)(pcVar5 + 1);
          pcVar5 = pcVar5 + 1;
          bVar2 = *pbVar6;
        }
        return (int)((int)(pcVar5 + (-1 - (int)param_1)) * 7 +
                    ((int)(pcVar5 + (-1 - (int)param_1)) * 7 >> 0x1f & 7U)) >> 3;
      }
      pcVar5 = param_1 + 1;
      if (0x2f < (byte)param_1[1]) {
        while (0x2f < (byte)pcVar5[1]) {
          pbVar6 = (byte *)(pcVar5 + 2);
          pcVar5 = pcVar5 + 2;
          iVar3 = iVar3 + 1;
          if (*pbVar6 < 0x30) {
            return iVar3;
          }
        }
      }
    }
    else {
      if (0 < param_3) {
        iVar3 = 0;
        if (cVar1 == '$') {
          pbVar6 = (byte *)(param_1 + 1);
          if (0 < param_3) {
            while ((0x2f < *pbVar6 && (0x2f < pbVar6[1]))) {
              iVar4 = iVar3 + 1;
              *(char *)(iVar3 + param_2) =
                   (&DAT_10039608)[pbVar6[1]] |
                   "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
                   [*pbVar6 + 0x210];
              pbVar6 = pbVar6 + 2;
              iVar3 = iVar4;
              if (param_3 <= iVar4) {
                return iVar4;
              }
            }
          }
        }
        else {
          iVar3 = FUN_10001d70(param_3);
        }
        return iVar3;
      }
      iVar3 = -1;
    }
    return iVar3;
  }
  return -1;
}



void __cdecl FUN_10003360(byte *param_1,uint *param_2,int param_3,byte *param_4)

{
  byte *pbVar1;
  byte bVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  int iVar7;
  uint uVar8;
  byte *pbVar9;
  byte *pbVar10;
  uint *local_40c;
  uint *local_408;
  uint local_404 [256];
  int local_4;
  
  local_40c = param_2;
  if (param_3 < 0) {
    local_408 = (uint *)((int)param_2 + 0xffff);
  }
  else {
    local_408 = (uint *)((int)param_2 + param_3);
  }
  if (param_1 == (byte *)0x0) {
    param_1 = &DAT_10039247;
  }
  if (param_2 == (uint *)0x0) {
    local_40c = local_404;
  }
  bVar2 = *param_4;
  local_4 = DAT_10041558;
  while (bVar2 != 0) {
    if (bVar2 == 0x23) {
      param_4 = param_4 + 1;
      do {
        bVar2 = *param_4;
        if (bVar2 == 0) break;
        param_4 = param_4 + 1;
      } while (bVar2 != 0x3d);
    }
    iVar7 = 0;
    bVar2 = *param_4;
    pbVar9 = param_4;
    while (('/' < (char)bVar2 && ((char)bVar2 < ':'))) {
      pbVar9 = pbVar9 + 1;
      iVar7 = (bVar2 & 0xf) + iVar7 * 10;
      bVar2 = *pbVar9;
    }
    bVar2 = *pbVar9;
    iVar5 = 0;
    if (bVar2 == 0x61) {
      iVar3 = iVar7;
      if (iVar7 == 0) {
        iVar3 = 1;
      }
      local_40c = (uint *)((int)local_40c + iVar3);
    }
    if (bVar2 == 0x62) {
      iVar5 = 2;
    }
    if (bVar2 == 0x77) {
      iVar5 = 4;
    }
    if (bVar2 == 0x6c) {
      iVar5 = 8;
LAB_1000346c:
      bVar2 = *param_1;
      if (bVar2 == 0x2d) {
        param_1 = param_1 + 1;
      }
      uVar4 = 0;
      pbVar10 = param_1;
      do {
        param_1 = pbVar10;
        if ((char)*param_1 < '0') {
          if ((iVar5 < 1) || (*param_1 != 0x2c)) goto LAB_100034b6;
          break;
        }
        uVar4 = uVar4 << 4 | (uint)(byte)(&DAT_10039608)[(char)*param_1];
        iVar5 = iVar5 + -1;
        pbVar10 = param_1 + 1;
      } while (0 < iVar5);
      param_1 = param_1 + 1;
LAB_100034b6:
      if (bVar2 == 0x2d) {
        uVar4 = -uVar4;
      }
      if (*pbVar9 == 0x62) {
        *(byte *)local_40c = (byte)uVar4;
        local_40c = (uint *)((int)local_40c + 1);
      }
      if (*pbVar9 == 0x77) {
        *(short *)local_40c = (short)uVar4;
        local_40c = (uint *)((int)local_40c + 2);
      }
      if (*pbVar9 == 0x6c) {
        *local_40c = uVar4;
        local_40c = local_40c + 1;
      }
    }
    else if (iVar5 != 0) goto LAB_1000346c;
    if ((*pbVar9 == 0x73) && (0 < iVar7)) {
      iVar5 = 0;
      puVar6 = local_40c;
      while (((bVar2 = *param_1, '/' < (char)bVar2 || (bVar2 == 0x25)) &&
             ((int)((1 - (int)local_40c) + (int)puVar6) < iVar7))) {
        if (bVar2 == 0x25) {
          pbVar10 = param_1 + 1;
          pbVar1 = param_1 + 2;
          param_1 = param_1 + 3;
          *(char *)puVar6 =
               "0123456789abcdef0000000000000000111111111111111122222222222222223333333333333333444444444444444455555555555555556666666666666666777777777777777788888888888888889999999999999999aaaaaaaaaaaaaaaabbbbbbbbbbbbbbbbccccccccccccccccddddddddddddddddeeeeeeeeeeeeeeeeffffffffffffffff0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
               [(char)*pbVar10 + 0x210] | (&DAT_10039608)[(char)*pbVar1];
          iVar5 = iVar5 + 1;
          puVar6 = (uint *)((int)puVar6 + 1);
        }
        else {
          param_1 = param_1 + 1;
          *(byte *)puVar6 = bVar2;
          iVar5 = iVar5 + 1;
          puVar6 = (uint *)((int)puVar6 + 1);
        }
      }
      if (iVar5 < iVar7) {
        uVar8 = iVar7 - iVar5;
        pbVar10 = (byte *)(iVar5 + (int)local_40c);
        for (uVar4 = uVar8 >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
          pbVar10[0] = 0;
          pbVar10[1] = 0;
          pbVar10[2] = 0;
          pbVar10[3] = 0;
          pbVar10 = pbVar10 + 4;
        }
        for (uVar4 = uVar8 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
          *pbVar10 = 0;
          pbVar10 = pbVar10 + 1;
        }
        iVar5 = iVar5 + uVar8;
      }
      local_40c = (uint *)((int)local_40c + iVar5);
      if (*param_1 == 0x2c) {
        param_1 = param_1 + 1;
      }
    }
    if (local_408 <= local_40c) break;
    param_4 = pbVar9 + 1;
    if (pbVar9[1] == 0x2a) {
      param_4 = pbVar9;
    }
    bVar2 = *param_4;
  }
  FUN_1002d447(local_4);
  return;
}



void __cdecl FUN_100035f0(char *param_1,int param_2)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  int local_24;
  int local_20;
  int local_1c;
  int local_18;
  int local_14;
  int local_10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  int iVar4;
  
  pcVar2 = (char *)0x0;
  if (param_1 == (char *)0x0) goto LAB_100037c6;
  cVar3 = *param_1;
  if (cVar3 == '$') {
    cVar3 = param_1[1];
    pcVar1 = param_1;
    if (cVar3 < '0') goto LAB_100037c6;
    do {
      iVar4 = (int)cVar3;
      cVar3 = pcVar1[2];
      param_1 = (char *)((int)pcVar2 << 4 | (uint)(byte)(&DAT_10039608)[iVar4]);
      pcVar2 = param_1;
      pcVar1 = pcVar1 + 1;
    } while ('/' < cVar3);
  }
  else {
    if ((cVar3 < '0') || ('9' < cVar3)) goto LAB_100037c6;
    pcVar2 = (char *)FUN_10001b40(0);
    if (' ' < *pcVar2) {
      if ('9' < cVar3) goto LAB_100037c6;
      local_24 = 0;
      local_20 = 0;
      local_1c = 0;
      local_18 = 0;
      local_14 = 0;
      local_10 = 0;
      local_c = 0;
      local_8 = 0;
      local_4 = 0xffffffff;
      FUN_10001b40(4);
      FUN_10001b40(2);
      FUN_10001b40(2);
      FUN_10001b40(2);
      FUN_10001b40(2);
      FUN_10001b40(2);
      if ((((local_10 < 0x7b2) || (0x83b < local_10)) || (local_14 < 1)) ||
         (((0xc < local_14 || (local_18 < 1)) || (iVar4 = local_10, 0x1f < local_18)))) {
        iVar4 = 0;
      }
      if (((local_1c < 0) || (0x17 < local_1c)) ||
         (((local_20 < 0 || (((0x3b < local_20 || (local_24 < 0)) || (0x3d < local_24)))) ||
          (iVar4 == 0)))) goto LAB_100037c6;
      local_14 = local_14 + -1;
      local_10 = iVar4 + -0x76c;
      param_1 = (char *)FUN_10001ce0(&local_24);
    }
  }
  if (param_1 != (char *)0x0) {
    return;
  }
LAB_100037c6:
  if (param_2 == 0) {
    FUN_10004f60();
  }
  return;
}



undefined4 __cdecl
FUN_100037e0(char *param_1,int *param_2,int *param_3,undefined4 *param_4,undefined4 *param_5,
            undefined4 *param_6,undefined4 *param_7)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 local_24 [9];
  
  uVar1 = FUN_100035f0(param_1,1);
  if (1 < uVar1) {
    puVar2 = FUN_10001b90(local_24);
    if (puVar2 != (undefined4 *)0x0) {
      if (param_2 != (int *)0x0) {
        *param_2 = puVar2[5] + 0x76c;
      }
      if (param_3 != (int *)0x0) {
        *param_3 = puVar2[4] + 1;
      }
      if (param_4 != (undefined4 *)0x0) {
        *param_4 = puVar2[3];
      }
      if (param_5 != (undefined4 *)0x0) {
        *param_5 = puVar2[2];
      }
      if (param_6 != (undefined4 *)0x0) {
        *param_6 = puVar2[1];
      }
      if (param_7 != (undefined4 *)0x0) {
        *param_7 = *puVar2;
      }
      return 0;
    }
  }
  return 0xffffffff;
}



void FUN_100038f0(void)

{
  uint *puVar1;
  uint uVar2;
  undefined4 *in_EAX;
  uint *puVar3;
  undefined4 *unaff_ESI;
  
  if ((DAT_100424a0 != (uint *)0x0) && (puVar3 = DAT_100424a0, DAT_100424a0[2] != 0)) {
    while (*puVar3 !=
           (puVar3[1] &
           CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(in_EAX + 1),*(undefined1 *)((int)in_EAX + 5)),
                             *(undefined1 *)((int)in_EAX + 6)),*(undefined1 *)((int)in_EAX + 7)))) {
      puVar1 = puVar3 + 5;
      puVar3 = puVar3 + 3;
      if (*puVar1 == 0) {
        return;
      }
    }
    *unaff_ESI = *in_EAX;
    unaff_ESI[1] = in_EAX[1];
    unaff_ESI[2] = in_EAX[2];
    unaff_ESI[3] = in_EAX[3];
    uVar2 = puVar3[2];
    *(char *)((int)unaff_ESI + 7) = (char)uVar2;
    *(char *)((int)unaff_ESI + 6) = (char)(uVar2 >> 8);
    *(char *)((int)unaff_ESI + 5) = (char)(uVar2 >> 0x10);
    *(char *)(unaff_ESI + 1) = (char)(uVar2 >> 0x18);
  }
  return;
}



int FUN_10003970(void)

{
  int in_EAX;
  int iVar1;
  
  if (in_EAX < 0) {
    iVar1 = WSAGetLastError();
    if ((iVar1 != 0x2733) && (iVar1 != 0x2746)) {
      if ((iVar1 != 0x2743) && (iVar1 != 0x2751)) {
        if (iVar1 == 0x2749) {
          return -2;
        }
        return (iVar1 == 0x274d) - 7;
      }
      return -5;
    }
    in_EAX = 0;
  }
  return in_EAX;
}



void FUN_100039c0(undefined4 *param_1)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  DWORD DVar3;
  
  DVar3 = GetTickCount();
  FUN_10004bb0((DWORD *)0x0);
  for (puVar1 = (undefined4 *)*param_1; pvVar2 = DAT_1004249c, puVar1 != (undefined4 *)0x0;
      puVar1 = (undefined4 *)*puVar1) {
    if ((((puVar1[0x11] != 0) && ((code *)puVar1[0x13] != (code *)0x0)) && (puVar1[0x10] != -1)) &&
       ((uint)puVar1[0x11] < DVar3 - puVar1[0x10])) {
      puVar1[0x10] = 0xffffffff;
      (*(code *)puVar1[0x13])(puVar1,0,puVar1[0x12]);
      DVar3 = GetTickCount();
      puVar1[0x10] = DVar3;
    }
  }
  while (pvVar2 != (LPVOID)0x0) {
    DAT_1004249c = *(LPVOID *)((int)pvVar2 + 4);
    FUN_10001530(pvVar2);
    pvVar2 = DAT_1004249c;
  }
  DAT_1004249c = pvVar2;
  FUN_10004c40((undefined4 *)0x0);
  return;
}



void __cdecl FUN_10003a60(int param_1)

{
  int iVar1;
  WSADATA *pWVar2;
  WSADATA local_1a0;
  int local_c;
  
  local_c = DAT_10041558;
  FUN_10004e60(param_1);
  FUN_10004c70(0x100039c0,0x10042498);
  pWVar2 = &local_1a0;
  for (iVar1 = 100; iVar1 != 0; iVar1 = iVar1 + -1) {
    pWVar2->wVersion = 0;
    pWVar2->wHighVersion = 0;
    pWVar2 = (WSADATA *)pWVar2->szDescription;
  }
  DAT_100424a0 = 0;
  WSAStartup(2,&local_1a0);
  DAT_10042494 = (uint)CONCAT11((char)local_1a0.wVersion,(char)(local_1a0.wVersion >> 8));
  FUN_1002d447(local_c);
  return;
}



undefined4 * __cdecl FUN_10003ae0(int param_1,int param_2,int param_3)

{
  SOCKET s;
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  u_long local_4;
  
  local_4 = 1;
  s = socket(param_1,param_2,param_3);
  if (s == 0xffffffff) {
    return (undefined4 *)0x0;
  }
  puVar1 = (undefined4 *)FUN_10001510(0x50);
  puVar3 = puVar1;
  for (iVar2 = 0x14; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar1[6] = s;
  ioctlsocket(s,-0x7ffb9982,&local_4);
  if (param_2 == 2) {
    setsockopt(s,0xffff,0x20,(char *)&local_4,4);
  }
  puVar1[2] = param_1;
  puVar1[3] = param_2;
  puVar1[4] = param_3;
  FUN_10004bb0((DWORD *)0x0);
  *puVar1 = DAT_10042498;
  DAT_10042498 = puVar1;
  FUN_10004c40((undefined4 *)0x0);
  return puVar1;
}



undefined4 __cdecl FUN_10003b90(int *param_1)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  
  FUN_10004bb0((DWORD *)0x0);
  piVar3 = &DAT_10042498;
  iVar2 = DAT_10042498;
  do {
    if (iVar2 == 0) {
LAB_10003bc3:
      FUN_10004c40((undefined4 *)0x0);
      FUN_10004d00();
      shutdown(param_1[6],2);
      closesocket(param_1[6]);
      param_1[6] = -1;
      *(undefined1 *)(param_1 + 5) = 0;
      FUN_10004bb0((DWORD *)0x0);
      param_1[1] = (int)DAT_1004249c;
      DAT_1004249c = param_1;
      FUN_10004c40((undefined4 *)0x0);
      return 0;
    }
    piVar1 = (int *)*piVar3;
    if (piVar1 == param_1) {
      *piVar3 = *param_1;
      goto LAB_10003bc3;
    }
    iVar2 = *piVar1;
    piVar3 = piVar1;
  } while( true );
}



int __cdecl FUN_10003c20(int param_1,sockaddr *param_2,int param_3)

{
  int iVar1;
  
  iVar1 = bind(*(SOCKET *)(param_1 + 0x18),param_2,param_3);
  if (iVar1 < 0) {
    iVar1 = WSAGetLastError();
    if ((iVar1 != 0x2733) && (iVar1 != 0x2746)) {
      if ((iVar1 != 0x2743) && (iVar1 != 0x2751)) {
        if (iVar1 == 0x2749) {
          return -2;
        }
        return (iVar1 == 0x274d) - 7;
      }
      return -5;
    }
    iVar1 = 0;
  }
  return iVar1;
}



void __cdecl
FUN_10003c90(uint param_1,byte *param_2,int param_3,undefined4 param_4,int param_5,int param_6)

{
  SOCKET *pSVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  sockaddr *to;
  int iVar5;
  byte *pbVar6;
  int tolen;
  
  pbVar6 = param_2;
  uVar3 = param_1;
  iVar2 = DAT_10041558;
  iVar5 = param_3;
  if (*(int *)(param_1 + 0xc) == 3) {
    pSVar1 = (SOCKET *)(param_1 + 0x18);
    param_1 = (uint)param_2[8];
    setsockopt(*pSVar1,0,4,(char *)&param_1,4);
    uVar4 = *pbVar6 & 0xf;
    iVar5 = param_3 + uVar4 * -4;
    pbVar6 = pbVar6 + uVar4 * 4;
    if (iVar5 < 0) {
      iVar5 = 0;
    }
  }
  if (param_5 == 0) {
    iVar5 = send(*(SOCKET *)(uVar3 + 0x18),(char *)pbVar6,iVar5,0);
  }
  else {
    tolen = param_6;
    to = (sockaddr *)FUN_100038f0();
    iVar5 = sendto(*(SOCKET *)(uVar3 + 0x18),(char *)pbVar6,iVar5,0,to,tolen);
  }
  if (((iVar5 < 0) && (iVar5 = WSAGetLastError(), iVar5 != 0x2733)) && (iVar5 != 0x2746)) {
    if ((iVar5 != 0x2743) && (iVar5 != 0x2751)) {
      if (iVar5 != 0x2749) {
        FUN_1002d447(iVar2);
        return;
      }
      FUN_1002d447(iVar2);
      return;
    }
    FUN_1002d447(iVar2);
    return;
  }
  FUN_1002d447(iVar2);
  return;
}



int __cdecl
FUN_10003da0(int param_1,char *param_2,int param_3,byte param_4,sockaddr *param_5,int *param_6)

{
  int iVar1;
  DWORD DVar2;
  
  if (param_5 == (sockaddr *)0x0) {
    iVar1 = recv(*(SOCKET *)(param_1 + 0x18),param_2,param_3,0);
  }
  else {
    iVar1 = recvfrom(*(SOCKET *)(param_1 + 0x18),param_2,param_3,0,param_5,param_6);
    if (0 < iVar1) {
      DVar2 = GetTickCount();
      param_5->sa_data[9] = (char)DVar2;
      param_5->sa_data[8] = (char)(DVar2 >> 8);
      param_5->sa_data[7] = (char)(DVar2 >> 0x10);
      param_5->sa_data[6] = (char)(DVar2 >> 0x18);
    }
  }
  if (iVar1 == 0) {
    iVar1 = -1;
  }
  else {
    iVar1 = FUN_10003970();
  }
  if ((param_4 & 0x20) != 0) {
    if (iVar1 == -1) {
      return 0;
    }
    if (iVar1 == 0) {
      iVar1 = -1;
    }
  }
  return iVar1;
}



undefined4 __cdecl
FUN_10003e30(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5
            )

{
  *(undefined4 *)(param_1 + 0x44) = param_3;
  *(undefined4 *)(param_1 + 0x3c) = param_2;
  *(undefined4 *)(param_1 + 0x48) = param_4;
  *(undefined4 *)(param_1 + 0x4c) = param_5;
  return 0;
}



void __cdecl FUN_10003e60(undefined4 *param_1,uint param_2,sockaddr *param_3,uint param_4)

{
  sockaddr *name;
  SOCKET s;
  int iVar1;
  hostent *phVar2;
  uint uVar3;
  sockaddr *psVar4;
  undefined4 *puVar5;
  sockaddr local_114;
  char local_104 [256];
  int local_4;
  
  name = param_3;
  iVar1 = DAT_10041558;
  local_4 = DAT_10041558;
  if (param_2 != param_4) {
    FUN_1002d447(DAT_10041558);
    return;
  }
  if (param_3->sa_family == 2) {
    psVar4 = param_3;
    puVar5 = param_1;
    for (uVar3 = param_2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
      *puVar5 = *(undefined4 *)psVar4;
      psVar4 = (sockaddr *)(psVar4->sa_data + 2);
      puVar5 = puVar5 + 1;
    }
    for (uVar3 = param_2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
      *(char *)puVar5 = (char)psVar4->sa_family;
      psVar4 = (sockaddr *)((int)&psVar4->sa_family + 1);
      puVar5 = (undefined4 *)((int)puVar5 + 1);
    }
    *(undefined1 *)((int)param_1 + 7) = 0;
    *(undefined1 *)((int)param_1 + 6) = 0;
    *(undefined1 *)((int)param_1 + 5) = 0;
    *(undefined1 *)(param_1 + 1) = 0;
    s = socket(2,2,0);
    if (s != 0xffffffff) {
      if (0x1ff < DAT_10042494) {
        local_114.sa_family = 0;
        local_114.sa_data[0] = '\0';
        local_114.sa_data[1] = '\0';
        local_114.sa_data[2] = '\0';
        local_114.sa_data[3] = '\0';
        local_114.sa_data[4] = '\0';
        local_114.sa_data[5] = '\0';
        local_114.sa_data[6] = '\0';
        local_114.sa_data[7] = '\0';
        local_114.sa_data[8] = '\0';
        local_114.sa_data[9] = '\0';
        local_114.sa_data[10] = '\0';
        local_114.sa_data[0xb] = '\0';
        local_114.sa_data[0xc] = '\0';
        local_114.sa_data[0xd] = '\0';
        iVar1 = WSAIoctl(s,0xc8000014,name,param_4,&local_114,0x10,&param_2,0,0);
        if (iVar1 < 0) {
          WSAGetLastError();
        }
        else {
          param_1[1] = local_114.sa_data._2_4_;
        }
        if (CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 1),
                                       *(undefined1 *)((int)param_1 + 5)),
                              *(undefined1 *)((int)param_1 + 6)),*(undefined1 *)((int)param_1 + 7))
            == 0x7f000001) {
          param_1[1] = *(undefined4 *)(name->sa_data + 2);
        }
      }
      if (CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 1),*(undefined1 *)((int)param_1 + 5)),
                   *(undefined1 *)((int)param_1 + 6)) == 0 && *(char *)((int)param_1 + 7) == '\0') {
        iVar1 = connect(s,name,param_4);
        if (iVar1 == 0) {
          iVar1 = getsockname(s,&local_114,(int *)&param_2);
          if (iVar1 == 0) {
            param_1[1] = local_114.sa_data._2_4_;
          }
        }
      }
      if (CONCAT21(CONCAT11(*(undefined1 *)(param_1 + 1),*(undefined1 *)((int)param_1 + 5)),
                   *(undefined1 *)((int)param_1 + 6)) == 0 && *(char *)((int)param_1 + 7) == '\0') {
        gethostname(local_104,0x100);
        phVar2 = gethostbyname(local_104);
        if (phVar2 != (hostent *)0x0) {
          param_1[1] = *(undefined4 *)*phVar2->h_addr_list;
        }
      }
      closesocket(s);
    }
    FUN_1002d447(local_4);
    return;
  }
  for (uVar3 = param_2 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *param_1 = 0;
    param_1 = param_1 + 1;
  }
  for (uVar3 = param_2 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
    *(undefined1 *)param_1 = 0;
    param_1 = (undefined4 *)((int)param_1 + 1);
  }
  FUN_1002d447(iVar1);
  return;
}



void FUN_10004050(void)

{
  FUN_10004ca0(0x100039c0,0x10042498);
  FUN_10004d00();
  while (DAT_10042498 != (int *)0x0) {
    FUN_10003b90(DAT_10042498);
  }
  FUN_100039c0(&DAT_10042498);
  FUN_10004f00();
  WSACleanup();
  return;
}



void FUN_100040a0(void)

{
  sockaddr local_24;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  int local_4;
  
  local_4 = DAT_10041558;
  local_24.sa_data[6] = '\0';
  local_24.sa_data[7] = '\0';
  local_24.sa_data[8] = '\0';
  local_24.sa_data[9] = '\0';
  local_24.sa_data[10] = '\0';
  local_24.sa_data[0xb] = '\0';
  local_24.sa_data[0xc] = '\0';
  local_24.sa_data[0xd] = '\0';
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  local_24.sa_family = 2;
  local_24.sa_data[0] = '\0';
  local_24.sa_data[1] = 'O';
  local_24.sa_data[2] = -0x40;
  local_24.sa_data[3] = -0x58;
  local_24.sa_data[4] = '\x01';
  local_24.sa_data[5] = '\x01';
  local_8 = 0;
  FUN_10003e60(&local_14,0x10,&local_24,0x10);
  FUN_1002d447(local_4);
  return;
}



void __fastcall FUN_10004140(undefined4 param_1,byte *param_2)

{
  byte bVar1;
  byte *in_EAX;
  byte bVar2;
  
  do {
    bVar2 = *in_EAX;
    in_EAX = in_EAX + 1;
    if (('@' < (char)bVar2) && ((char)bVar2 < '[')) {
      bVar2 = bVar2 ^ 0x20;
    }
    bVar1 = *param_2;
    param_2 = param_2 + 1;
    if (('@' < (char)bVar1) && ((char)bVar1 < '[')) {
      bVar1 = bVar1 ^ 0x20;
    }
  } while ((bVar2 != 0) && (bVar2 == bVar1));
  return;
}



void __fastcall FUN_10004180(undefined4 param_1,int param_2)

{
  int iVar1;
  byte *pbVar2;
  byte local_190 [8];
  undefined1 local_188;
  int local_c;
  
  local_c = DAT_10041558;
  pbVar2 = local_190;
  for (iVar1 = 0x60; iVar1 != 0; iVar1 = iVar1 + -1) {
    pbVar2[0] = 0;
    pbVar2[1] = 0;
    pbVar2[2] = 0;
    pbVar2[3] = 0;
    pbVar2 = pbVar2 + 4;
  }
  local_190[0] = 0x67;
  local_190[1] = 0x45;
  local_190[2] = 0x41;
  local_188 = 0x3f;
  FUN_10003c90(*(uint *)(param_2 + 0x38),local_190,0x180,0,param_2 + 0x3c,0x10);
  FUN_1002d447(local_c);
  return;
}



void __cdecl FUN_100041f0(undefined4 param_1,undefined4 param_2,DWORD *param_3)

{
  DWORD *pDVar1;
  char cVar2;
  undefined4 *puVar3;
  byte *pbVar4;
  int iVar5;
  DWORD DVar6;
  char *pcVar7;
  DWORD DVar8;
  char *extraout_ECX;
  char *extraout_ECX_00;
  char *pcVar9;
  char *extraout_ECX_01;
  char *extraout_ECX_02;
  char *extraout_ECX_03;
  char *extraout_ECX_04;
  undefined4 *puVar10;
  undefined4 *puVar11;
  short *psVar12;
  DWORD *pDVar13;
  bool bVar14;
  uint local_1ac;
  int local_1a8;
  sockaddr local_1a4;
  u_short local_194;
  short local_192;
  undefined1 local_190;
  undefined1 local_18f;
  undefined1 local_18e;
  undefined1 local_18d;
  char local_184;
  char local_183;
  char local_182;
  byte local_181;
  char *local_180;
  char local_17c [32];
  char local_15c [32];
  char local_13c [192];
  char local_7c [120];
  int local_4;
  
  local_4 = DAT_10041558;
  iVar5 = FUN_10004b60(param_3);
  if (iVar5 != 0) {
    DVar6 = param_3[0xe];
    pcVar9 = extraout_ECX;
    while (DVar6 != 0) {
      if (0 < (int)param_3[0xc]) {
        param_3[0xc] = 0;
        FUN_10004180(pcVar9,(int)param_3);
      }
      local_17c[0] = '\0';
      local_1a8 = 0x10;
      iVar5 = FUN_10003da0(param_3[0xe],&local_184,0x180,0,&local_1a4,&local_1a8);
      if ((iVar5 < 1) || (local_17c[0] == '\0')) break;
      FUN_10003e60((undefined4 *)&local_194,0x10,&local_1a4,0x10);
      local_1ac = 0;
      pcVar9 = extraout_ECX_00;
      if ((local_194 == local_1a4.sa_family) && (local_1a4.sa_family == 2)) {
        bVar14 = true;
        pcVar9 = (char *)0x3;
        pcVar7 = local_1a4.sa_data;
        psVar12 = &local_192;
        do {
          if (pcVar9 == (char *)0x0) break;
          pcVar9 = pcVar9 + -1;
          bVar14 = *(short *)pcVar7 == *psVar12;
          pcVar7 = pcVar7 + 2;
          psVar12 = psVar12 + 1;
        } while (bVar14);
        local_1ac = (uint)bVar14;
      }
      if (((local_184 == 'g') && (local_183 == 'E')) && (local_182 == 'A')) {
        if ((local_17c[0] == '?') && (local_17c[1] == '\0')) {
          DVar6 = GetTickCount();
          pcVar9 = (char *)param_3[9];
          if (pcVar9 != (char *)0x0) {
            do {
              if (DVar6 + 1000 < *(uint *)(pcVar9 + 0x180)) {
                *(DWORD *)(pcVar9 + 0x180) = DVar6 + 1000;
              }
              pcVar9 = *(char **)(pcVar9 + 0x1a0);
            } while (pcVar9 != (char *)0x0);
            pcVar9 = (char *)0x0;
          }
        }
        else if (local_15c[0] != '\0') {
          puVar11 = (undefined4 *)param_3[10];
          puVar3 = (undefined4 *)param_3[0xb];
          puVar10 = (undefined4 *)0x0;
          if (puVar11 == puVar3) {
LAB_100043a1:
            if (puVar10 != (undefined4 *)0x0) {
              puVar11 = puVar10;
              for (iVar5 = 0x69; iVar5 != 0; iVar5 = iVar5 + -1) {
                *puVar11 = 0;
                puVar11 = puVar11 + 1;
              }
              puVar10[1] = local_180;
              pcVar9 = local_17c;
              iVar5 = 8 - (int)pcVar9;
              do {
                cVar2 = *pcVar9;
                pcVar9[(int)puVar10 + iVar5] = cVar2;
                pcVar9 = pcVar9 + 1;
              } while (cVar2 != '\0');
              pcVar9 = local_15c;
              iVar5 = 0x28 - (int)pcVar9;
              do {
                cVar2 = *pcVar9;
                pcVar9[(int)puVar10 + iVar5] = cVar2;
                pcVar9 = pcVar9 + 1;
              } while (cVar2 != '\0');
              pcVar7 = local_13c;
              iVar5 = 0x48 - (int)pcVar7;
              pcVar9 = pcVar7;
              do {
                cVar2 = *pcVar7;
                pcVar9 = (char *)CONCAT31((int3)((uint)pcVar9 >> 8),cVar2);
                pcVar7[(int)puVar10 + iVar5] = cVar2;
                pcVar7 = pcVar7 + 1;
              } while (cVar2 != '\0');
              param_3[0x13] = param_3[0x13] + 1;
              puVar11 = puVar10;
            }
          }
          else {
            do {
              if ((puVar10 == (undefined4 *)0x0) && (*(char *)(puVar11 + 10) == '\0')) {
                puVar10 = puVar11;
              }
              iVar5 = FUN_10004140(pcVar9,(byte *)(puVar11 + 2));
              pcVar9 = extraout_ECX_01;
            } while (((((iVar5 != 0) ||
                       (iVar5 = FUN_10004140(extraout_ECX_01,(byte *)(puVar11 + 10)),
                       pcVar9 = extraout_ECX_02, iVar5 != 0)) ||
                      (iVar5 = FUN_10004140(extraout_ECX_02,(byte *)(puVar11 + 0x12)),
                      pcVar9 = extraout_ECX_03, iVar5 != 0)) ||
                     (pcVar9 = local_180, local_180 != (char *)puVar11[1])) &&
                    (puVar11 = puVar11 + 0x69, puVar11 != (undefined4 *)param_3[0xb]));
            if (puVar11 == puVar3) goto LAB_100043a1;
          }
          if (puVar11 != (undefined4 *)param_3[0xb]) {
            pcVar9 = local_7c;
            iVar5 = 0x108 - (int)pcVar9;
            do {
              cVar2 = *pcVar9;
              pcVar9[(int)puVar11 + iVar5] = cVar2;
              pcVar9 = pcVar9 + 1;
            } while (cVar2 != '\0');
            DVar6 = GetTickCount();
            puVar11[0x67] = local_1ac;
            puVar11[0x60] = DVar6 + 1000 + (uint)local_181 * 2000;
            puVar11[0x65] =
                 CONCAT31(CONCAT21(CONCAT11(local_1a4.sa_data[2],local_1a4.sa_data[3]),
                                   local_1a4.sa_data[4]),local_1a4.sa_data[5]);
            puVar11[0x66] = CONCAT31(CONCAT21(CONCAT11(local_190,local_18f),local_18e),local_18d);
            FUN_10004f70((int)&local_1a4,(char *)(puVar11 + 0x61),0x10);
            param_3[0x13] = param_3[0x13] + 1;
            pcVar9 = extraout_ECX_04;
          }
        }
      }
      DVar6 = param_3[0xe];
    }
    DVar8 = GetTickCount();
    DVar6 = param_3[10];
    if (DVar6 != param_3[0xb]) {
      do {
        if ((*(char *)(DVar6 + 0x28) != '\0') &&
           (((*(char *)(DVar6 + 0x108) == '\0' || (*(uint *)(DVar6 + 0x180) == 0)) ||
            (*(uint *)(DVar6 + 0x180) < DVar8)))) {
          *(undefined1 *)(DVar6 + 0x28) = 0;
          *(undefined1 *)(DVar6 + 8) = 0;
          param_3[0x13] = param_3[0x13] + 1;
        }
        DVar6 = DVar6 + 0x1a4;
      } while (DVar6 != param_3[0xb]);
    }
    pDVar1 = param_3 + 9;
    DVar6 = *pDVar1;
    pDVar13 = pDVar1;
    while (DVar6 != 0) {
      pbVar4 = (byte *)*pDVar13;
      if (*(int *)(pbVar4 + 0x180) == 0) {
        *pDVar13 = *(DWORD *)(pbVar4 + 0x1a0);
        pbVar4[0x108] = 0;
        FUN_10003c90(param_3[0xe],pbVar4,0x180,0,(int)(param_3 + 0xf),0x10);
        FUN_10001530(pbVar4);
      }
      else {
        pDVar13 = (DWORD *)(pbVar4 + 0x1a0);
      }
      DVar6 = *pDVar13;
    }
    DVar6 = GetTickCount();
    for (pbVar4 = (byte *)*pDVar1; pbVar4 != (byte *)0x0; pbVar4 = *(byte **)(pbVar4 + 0x1a0)) {
      if (*(uint *)(pbVar4 + 0x180) < DVar6) {
        FUN_10003c90(param_3[0xe],pbVar4,0x180,0,(int)(param_3 + 0xf),0x10);
        *(uint *)(pbVar4 + 0x180) = (uint)pbVar4[3] * 1000 + DVar6;
      }
    }
    FUN_10004c40(param_3);
  }
  FUN_1002d447(local_4);
  return;
}



undefined4 __thiscall
FUN_100045e0(void *this,DWORD *param_1,char *param_2,char *param_3,char *param_4,char *param_5,
            int param_6)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  byte *pbVar4;
  DWORD DVar5;
  void *extraout_ECX;
  void *extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar6;
  
  if (param_6 == 0) {
    param_6 = 0x1e;
  }
  else if (param_6 < 2) {
    param_6 = 2;
  }
  else if (0xfa < param_6) {
    param_6 = 0xfa;
  }
  if ((param_2 != (char *)0x0) && (*param_2 != '\0')) {
    pcVar2 = param_2;
    do {
      cVar1 = *pcVar2;
      this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    if ((uint)((int)pcVar2 - (int)(param_2 + 1)) < 0x20) {
      if ((param_3 != (char *)0x0) && (*param_3 != '\0')) {
        pcVar2 = param_3;
        do {
          cVar1 = *pcVar2;
          this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
          pcVar2 = pcVar2 + 1;
        } while (cVar1 != '\0');
        if ((uint)((int)pcVar2 - (int)(param_3 + 1)) < 0x20) {
          if (param_4 != (char *)0x0) {
            pcVar2 = param_4;
            do {
              cVar1 = *pcVar2;
              this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
              pcVar2 = pcVar2 + 1;
            } while (cVar1 != '\0');
            if ((uint)((int)pcVar2 - (int)(param_4 + 1)) < 0xc0) {
              if (param_5 != (char *)0x0) {
                pcVar2 = param_5;
                do {
                  cVar1 = *pcVar2;
                  this = (void *)CONCAT31((int3)((uint)this >> 8),cVar1);
                  pcVar2 = pcVar2 + 1;
                } while (cVar1 != '\0');
                if ((uint)((int)pcVar2 - (int)(param_5 + 1)) < 0x78) {
                  DVar5 = param_1[9];
                  while( true ) {
                    if (DVar5 == 0) {
                      pbVar4 = (byte *)FUN_10001510(0x1a4);
                      pbVar4[3] = (byte)param_6;
                      uVar6 = *(undefined4 *)(pbVar4 + 0x180);
                      pbVar4[6] = (byte)((uint)uVar6 >> 8);
                      pbVar4[5] = (byte)((uint)uVar6 >> 0x10);
                      pbVar4[7] = pbVar4[0x180];
                      *pbVar4 = 0x67;
                      pbVar4[1] = 0x45;
                      pbVar4[2] = 0x41;
                      pbVar4[4] = (byte)((uint)uVar6 >> 0x18);
                      iVar3 = 8 - (int)param_2;
                      do {
                        cVar1 = *param_2;
                        param_2[(int)(pbVar4 + iVar3)] = cVar1;
                        param_2 = param_2 + 1;
                      } while (cVar1 != '\0');
                      iVar3 = 0x28 - (int)param_3;
                      do {
                        cVar1 = *param_3;
                        param_3[(int)(pbVar4 + iVar3)] = cVar1;
                        param_3 = param_3 + 1;
                      } while (cVar1 != '\0');
                      iVar3 = 0x108 - (int)param_5;
                      do {
                        cVar1 = *param_5;
                        param_5[(int)(pbVar4 + iVar3)] = cVar1;
                        param_5 = param_5 + 1;
                      } while (cVar1 != '\0');
                      iVar3 = 0x48 - (int)param_4;
                      do {
                        cVar1 = *param_4;
                        param_4[(int)(pbVar4 + iVar3)] = cVar1;
                        param_4 = param_4 + 1;
                      } while (cVar1 != '\0');
                      FUN_10003c90(param_1[0xe],pbVar4,0x180,0,(int)(param_1 + 0xf),0x10);
                      DVar5 = GetTickCount();
                      *(DWORD *)(pbVar4 + 0x180) = DVar5 + 0xfa;
                      FUN_10004bb0(param_1);
                      *(DWORD *)(pbVar4 + 0x1a0) = param_1[9];
                      param_1[9] = (DWORD)pbVar4;
                      FUN_10004c40(param_1);
                      return 0;
                    }
                    iVar3 = FUN_10004140(this,(byte *)(DVar5 + 8));
                    this = extraout_ECX;
                    if ((iVar3 == 0) &&
                       (iVar3 = FUN_10004140(extraout_ECX,(byte *)(DVar5 + 0x28)),
                       this = extraout_ECX_00, iVar3 == 0)) break;
                    DVar5 = *(DWORD *)(DVar5 + 0x1a0);
                  }
                  iVar3 = FUN_10004140(extraout_ECX_00,(byte *)(DVar5 + 0x108));
                  uVar6 = extraout_ECX_01;
                  if (iVar3 != 0) {
                    iVar3 = (int)(DVar5 + 0x108) - (int)param_5;
                    do {
                      cVar1 = *param_5;
                      uVar6 = CONCAT31((int3)((uint)uVar6 >> 8),cVar1);
                      param_5[iVar3] = cVar1;
                      param_5 = param_5 + 1;
                    } while (cVar1 != '\0');
                    *(undefined4 *)(DVar5 + 0x180) = 0;
                  }
                  iVar3 = FUN_10004140(uVar6,(byte *)(DVar5 + 0x48));
                  if (iVar3 == 0) {
                    return 0;
                  }
                  iVar3 = (int)(DVar5 + 0x48) - (int)param_4;
                  do {
                    cVar1 = *param_4;
                    param_4[iVar3] = cVar1;
                    param_4 = param_4 + 1;
                  } while (cVar1 != '\0');
                  *(undefined4 *)(DVar5 + 0x180) = 0;
                  return 0;
                }
              }
              return 0xfffffffc;
            }
          }
          return 0xfffffffd;
        }
      }
      return 0xfffffffe;
    }
  }
  return 0xffffffff;
}



int __cdecl FUN_10004860(DWORD *param_1,int param_2,int param_3)

{
  DWORD DVar1;
  int iVar2;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  undefined4 extraout_ECX_01;
  undefined4 uVar3;
  
  FUN_10004bb0(param_1);
  DVar1 = param_1[9];
  uVar3 = extraout_ECX;
  do {
    if (DVar1 == 0) {
LAB_100048bc:
      FUN_10004c40(param_1);
      return (DVar1 != 0) - 1;
    }
    if (((param_2 == 0) ||
        (iVar2 = FUN_10004140(uVar3,(byte *)(DVar1 + 8)), uVar3 = extraout_ECX_00, iVar2 == 0)) &&
       ((param_3 == 0 ||
        (iVar2 = FUN_10004140(uVar3,(byte *)(DVar1 + 0x28)), uVar3 = extraout_ECX_01, iVar2 == 0))))
    {
      *(undefined4 *)(DVar1 + 0x180) = 0;
      goto LAB_100048bc;
    }
    DVar1 = *(DWORD *)(DVar1 + 0x1a0);
  } while( true );
}



void __cdecl FUN_100048d0(int param_1)

{
  DWORD *pDVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  undefined4 extraout_ECX;
  DWORD *pDVar6;
  sockaddr local_14;
  int local_4;
  
  local_4 = DAT_10041558;
  if (DAT_100424ac != (DWORD *)0x0) {
    DAT_100424a8 = DAT_100424a8 + 1;
    FUN_1002d447(DAT_10041558);
    return;
  }
  pDVar1 = (DWORD *)FUN_10001510(0x50);
  if (pDVar1 == (DWORD *)0x0) {
LAB_10004a48:
    FUN_1002d447(local_4);
    return;
  }
  pDVar6 = pDVar1;
  for (iVar3 = 0x14; iVar3 != 0; iVar3 = iVar3 + -1) {
    *pDVar6 = 0;
    pDVar6 = pDVar6 + 1;
  }
  if (param_1 < 4) {
    param_1 = 4;
  }
  puVar2 = (undefined4 *)FUN_10001510(param_1 * 0x1a4);
  pDVar1[10] = (DWORD)puVar2;
  if (puVar2 != (undefined4 *)0x0) {
    pDVar1[0xb] = (DWORD)(puVar2 + param_1 * 0x69);
    uVar4 = (int)(puVar2 + param_1 * 0x69) - (int)puVar2;
    for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
      *(undefined1 *)puVar2 = 0;
      puVar2 = (undefined4 *)((int)puVar2 + 1);
    }
    pDVar1[0x13] = 1;
    puVar2 = FUN_10003ae0(2,2,0);
    if (puVar2 != (undefined4 *)0x0) {
      DAT_100424a8 = 1;
      DAT_100424ac = pDVar1;
      FUN_10004b10(pDVar1);
      FUN_10004bb0(pDVar1);
      local_14.sa_family = 2;
      local_14.sa_data[2] = '\0';
      local_14.sa_data[3] = '\0';
      local_14.sa_data[4] = '\0';
      local_14.sa_data[5] = '\0';
      local_14.sa_data[6] = '\0';
      local_14.sa_data[7] = '\0';
      local_14.sa_data[8] = '\0';
      local_14.sa_data[9] = '\0';
      local_14.sa_data[10] = '\0';
      local_14.sa_data[0xb] = '\0';
      local_14.sa_data[0xc] = '\0';
      local_14.sa_data[0xd] = '\0';
      local_14.sa_data[0] = '\'';
      local_14.sa_data[1] = '\x0f';
      FUN_10003c20((int)puVar2,&local_14,0x10);
      pDVar1[0xf] = 0xf270002;
      pDVar1[0x10] = 0xffffffff;
      pDVar1[0x11] = 0;
      pDVar1[0x12] = 0;
      pDVar1[0xc] = 1;
      pDVar1[0xe] = (DWORD)puVar2;
      FUN_10003e30((int)puVar2,2,100,pDVar1,FUN_100041f0);
      FUN_10004c40(pDVar1);
      FUN_10004180(extraout_ECX,(int)pDVar1);
      goto LAB_10004a48;
    }
  }
  FUN_10001530(pDVar1);
  FUN_1002d447(local_4);
  return;
}



void __cdecl FUN_10004a60(DWORD *param_1)

{
  DWORD DVar1;
  int *piVar2;
  
  if (param_1 != (DWORD *)0x0) {
    if (1 < DAT_100424a8) {
      DAT_100424a8 = DAT_100424a8 + -1;
      return;
    }
    DVar1 = param_1[9];
    DAT_100424ac = 0;
    DAT_100424a8 = 0;
    while (DVar1 != 0) {
      FUN_10004860(param_1,param_1[9] + 8,param_1[9] + 0x28);
      FUN_100041f0(param_1[0xe],0,param_1);
      DVar1 = param_1[9];
    }
    FUN_10004bb0(param_1);
    piVar2 = (int *)param_1[0xe];
    param_1[0xe] = 0;
    FUN_10003b90(piVar2);
    FUN_10004c40(param_1);
    FUN_10004b40(param_1);
    FUN_10001530((LPVOID)param_1[10]);
    FUN_10001530(param_1);
  }
  return;
}



DWORD GetTickCount(void)

{
  DWORD DVar1;
  
                    // WARNING: Could not recover jumptable at 0x10004b00. Too many branches
                    // WARNING: Treating indirect jump as call
  DVar1 = GetTickCount();
  return DVar1;
}



void __cdecl FUN_10004b10(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    param_1 = &DAT_10042930;
  }
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return;
}



void __cdecl FUN_10004b40(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    param_1 = &DAT_10042930;
  }
  param_1[2] = 0;
  DeleteCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return;
}



undefined4 __cdecl FUN_10004b60(DWORD *param_1)

{
  DWORD DVar1;
  LONG LVar2;
  
  if (param_1 == (DWORD *)0x0) {
    param_1 = &DAT_10042930;
  }
  DVar1 = GetCurrentThreadId();
  if (*param_1 != DVar1) {
    LVar2 = InterlockedExchange((LONG *)(param_1 + 2),1);
    if (LVar2 != 0) {
      return 0;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
    DVar1 = GetCurrentThreadId();
    *param_1 = DVar1;
  }
  param_1[1] = param_1[1] + 1;
  return 1;
}



void __cdecl FUN_10004bb0(DWORD *param_1)

{
  DWORD DVar1;
  LONG LVar2;
  DWORD *pDVar3;
  DWORD *pDVar4;
  
  pDVar4 = param_1;
  if (param_1 == (DWORD *)0x0) {
    pDVar4 = &DAT_10042930;
  }
  while( true ) {
    pDVar3 = param_1;
    if (param_1 == (DWORD *)0x0) {
      pDVar3 = &DAT_10042930;
    }
    DVar1 = GetCurrentThreadId();
    if (*pDVar3 == DVar1) break;
    LVar2 = InterlockedExchange((LONG *)(pDVar3 + 2),1);
    if (LVar2 == 0) {
      EnterCriticalSection((LPCRITICAL_SECTION)(pDVar3 + 3));
      DVar1 = GetCurrentThreadId();
      *pDVar3 = DVar1;
      break;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)(pDVar4 + 3));
    LVar2 = InterlockedExchange((LONG *)(pDVar4 + 2),1);
    if (LVar2 == 0) {
      DVar1 = GetCurrentThreadId();
      *pDVar4 = DVar1;
      pDVar4[1] = pDVar4[1] + 1;
      return;
    }
    LeaveCriticalSection((LPCRITICAL_SECTION)(pDVar4 + 3));
  }
  pDVar3[1] = pDVar3[1] + 1;
  return;
}



void __cdecl FUN_10004c40(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    param_1 = &DAT_10042930;
  }
  if (1 < (uint)param_1[1]) {
    param_1[1] = param_1[1] - 1;
    return;
  }
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 3));
  return;
}



void __cdecl FUN_10004c70(int param_1,int param_2)

{
  if ((param_1 != 0) && (param_2 != 0)) {
    (&DAT_10042958)[DAT_10042a7c * 2] = param_1;
    (&DAT_1004295c)[DAT_10042a7c * 2] = param_2;
    DAT_10042a7c = DAT_10042a7c + 1;
  }
  return;
}



void __cdecl FUN_10004ca0(int param_1,int param_2)

{
  int iVar1;
  
  if (((param_1 != 0) && (param_2 != 0)) && (iVar1 = 0, 0 < DAT_10042a7c)) {
    while (((&DAT_10042958)[iVar1 * 2] != param_1 || ((&DAT_1004295c)[iVar1 * 2] != param_2))) {
      iVar1 = iVar1 + 1;
      if (DAT_10042a7c <= iVar1) {
        return;
      }
    }
    (&DAT_10042958)[iVar1 * 2] = 0;
    (&DAT_1004295c)[iVar1 * 2] = 0;
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_10004d00(void)

{
  FUN_10004bb0(&DAT_10042a58);
  if (1 < DAT_10042a5c) {
    DAT_10042a5c = DAT_10042a5c - 1;
    return;
  }
  DAT_10042a58 = 0;
  DAT_10042a5c = 0;
  _DAT_10042a60 = 0;
  LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_10042a64);
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_10004d40(void)

{
  DWORD DVar1;
  LONG LVar2;
  int iVar3;
  
  DVar1 = GetCurrentThreadId();
  if (DAT_10042a58 != DVar1) {
    LVar2 = InterlockedExchange((LONG *)&DAT_10042a60,1);
    if (LVar2 != 0) {
      return;
    }
    EnterCriticalSection((LPCRITICAL_SECTION)&DAT_10042a64);
    DAT_10042a58 = GetCurrentThreadId();
  }
  DAT_10042a5c = DAT_10042a5c + 1;
  iVar3 = 0;
  if (0 < DAT_10042a7c) {
    do {
      if (((code *)(&DAT_10042958)[iVar3 * 2] == (code *)0x0) || ((&DAT_1004295c)[iVar3 * 2] == 0))
      {
        (&DAT_10042958)[iVar3 * 2] = *(undefined4 *)(&DAT_10042950 + DAT_10042a7c * 8);
        (&DAT_1004295c)[iVar3 * 2] = *(undefined4 *)(&DAT_10042954 + DAT_10042a7c * 8);
        *(undefined4 *)(&DAT_10042950 + DAT_10042a7c * 8) = 0;
        *(undefined4 *)(&DAT_10042954 + DAT_10042a7c * 8) = 0;
        DAT_10042a7c = DAT_10042a7c + -1;
        iVar3 = iVar3 + -1;
      }
      else {
        (*(code *)(&DAT_10042958)[iVar3 * 2])((&DAT_1004295c)[iVar3 * 2]);
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < DAT_10042a7c);
  }
  if (DAT_10042a5c < 2) {
    DAT_10042a58 = 0;
    DAT_10042a5c = 0;
    _DAT_10042a60 = 0;
    LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_10042a64);
    return;
  }
  DAT_10042a5c = DAT_10042a5c - 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __cdecl FUN_10004e60(int param_1)

{
  DWORD local_4;
  
  DAT_10042a7c = 0;
  DAT_1004108c = 0xffffffff;
  DAT_10042930 = 0;
  DAT_10042934 = 0;
  DAT_10042938 = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&DAT_1004293c);
  DAT_10042a58 = 0;
  DAT_10042a5c = 0;
  _DAT_10042a60 = 0;
  InitializeCriticalSection((LPCRITICAL_SECTION)&DAT_10042a64);
  DAT_10042a80 = (HANDLE)0x1;
  DAT_10042a80 = CreateThread((LPSECURITY_ATTRIBUTES)0x0,0,(LPTHREAD_START_ROUTINE)&LAB_10004e20,
                              (LPVOID)0x0,0,&local_4);
  if (DAT_10042a80 != (HANDLE)0x0) {
    SetThreadPriority(DAT_10042a80,param_1);
    CloseHandle(DAT_10042a80);
  }
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void FUN_10004f00(void)

{
  DAT_10042a80 = 0;
  if (0 < DAT_1004108c) {
    do {
      Sleep(1);
    } while (0 < DAT_1004108c);
  }
  DAT_10042938 = 0;
  DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_1004293c);
  _DAT_10042a60 = 0;
  DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_10042a64);
  return;
}



void FUN_10004f60(void)

{
  FID_conflict___time32((__time32_t *)0x0);
  return;
}



char * __cdecl FUN_10004f70(int param_1,char *param_2,int param_3)

{
  ulonglong uVar1;
  uint uVar2;
  uint uVar3;
  char *pcVar4;
  char *pcVar5;
  
  if (0 < param_3) {
    if (0xf < param_3) {
      uVar2 = (uint)*(byte *)(param_1 + 4);
      pcVar4 = param_2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *param_2 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        param_2[1] = (char)(uVar1 / 10) + '0';
        pcVar4 = param_2 + 2;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar4 = (char)uVar3 + '0';
        pcVar4 = pcVar4 + 1;
      }
      *pcVar4 = (char)uVar2 + '0';
      pcVar4[1] = '.';
      uVar2 = (uint)*(byte *)(param_1 + 5);
      pcVar5 = pcVar4 + 2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *pcVar5 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        pcVar4[3] = (char)(uVar1 / 10) + '0';
        pcVar5 = pcVar4 + 4;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar5 = (char)uVar3 + '0';
        pcVar5 = pcVar5 + 1;
      }
      *pcVar5 = (char)uVar2 + '0';
      pcVar5[1] = '.';
      uVar2 = (uint)*(byte *)(param_1 + 6);
      pcVar4 = pcVar5 + 2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *pcVar4 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        pcVar5[3] = (char)(uVar1 / 10) + '0';
        pcVar4 = pcVar5 + 4;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar4 = (char)uVar3 + '0';
        pcVar4 = pcVar4 + 1;
      }
      *pcVar4 = (char)uVar2 + '0';
      pcVar4[1] = '.';
      uVar2 = (uint)*(byte *)(param_1 + 7);
      pcVar5 = pcVar4 + 2;
      if (99 < uVar2) {
        uVar1 = (ulonglong)uVar2 % 100;
        *pcVar5 = (char)((ulonglong)uVar2 / 100) + '0';
        uVar2 = (uint)(uVar1 % 10);
        pcVar4[3] = (char)(uVar1 / 10) + '0';
        pcVar5 = pcVar4 + 4;
      }
      if (9 < uVar2) {
        uVar3 = uVar2 / 10;
        uVar2 = uVar2 % 10;
        *pcVar5 = (char)uVar3 + '0';
        pcVar5 = pcVar5 + 1;
      }
      *pcVar5 = (char)uVar2 + '0';
      pcVar5[1] = '\0';
      return param_2;
    }
    *param_2 = '\0';
  }
  return (char *)0x0;
}



undefined4 __cdecl FUN_10005110(undefined4 param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte local_14 [20];
  
  pbVar4 = &DAT_10039247;
  iVar3 = 0x14;
  pbVar2 = local_14;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar1,pbVar2,iVar3,pbVar4);
  if (local_14[0] == 0) {
    pbVar4 = &DAT_10039247;
    iVar3 = 0x14;
    pbVar2 = local_14;
    pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b58);
    FUN_100030f0(pbVar1,pbVar2,iVar3,pbVar4);
  }
  **(undefined1 **)(param_2 + 0x58) = 0;
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b60,local_14);
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b58,local_14);
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"PERSONAS",local_14);
  FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b44,
               *(byte **)(param_2 + 0x74));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b40,1);
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"SHARE",1);
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x4c) = 0;
  return 0;
}



undefined4 __cdecl FUN_10005210(undefined4 param_1,int param_2)

{
  FUN_10002230(*(char **)(param_2 + 0x58),*(int *)(param_2 + 0x54),*(char **)(param_2 + 0x74));
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x4c) = 0;
  return 0;
}



undefined4 __cdecl FUN_10005360(undefined4 *param_1,int param_2)

{
  byte *pbVar1;
  int iVar2;
  byte local_34 [20];
  byte local_20 [32];
  
  iVar2 = 0;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"BSLOT");
  FUN_10002e80(pbVar1,iVar2);
  iVar2 = 0;
  while( true ) {
    _sprintf((char *)local_20,"PERS%d",iVar2);
    pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),local_20);
    if (pbVar1 == (byte *)0x0) break;
    FUN_100030f0(pbVar1,local_34,0x11,&DAT_10039247);
    FUN_10002c50(*(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),
                 (byte *)"BSLOT=%d BIDX=%d PERS=%s");
    FUN_10010a30(*param_1,param_2,0x21626174,0,*(char **)(param_2 + 0x58),(char *)0xffffffff);
    iVar2 = iVar2 + 1;
  }
  *(undefined4 *)(param_2 + 0x50) = 0;
  *(undefined4 *)(param_2 + 0x4c) = 0;
  return 0;
}



void FUN_10005420(void)

{
  return;
}



void FUN_10005570(void)

{
  int in_EAX;
  undefined4 *puVar1;
  int iVar2;
  
  puVar1 = (undefined4 *)(in_EAX + 900);
  iVar2 = 8;
  do {
    if ((void *)*puVar1 != (void *)0x0) {
      FUN_100119c0((void *)*puVar1);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 0x1f7;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



int __cdecl FUN_100055b0(char *param_1)

{
  int iVar1;
  int unaff_EBX;
  uint uVar2;
  char *_Str1;
  
  uVar2 = 0;
  _Str1 = (char *)(unaff_EBX + 0x164);
  do {
    if (*(int *)(_Str1 + 0x220) != 0) {
      iVar1 = __stricmp(_Str1,param_1);
      if (iVar1 == 0) {
        return uVar2 * 0x7dc + 0x164 + unaff_EBX;
      }
    }
    uVar2 = uVar2 + 1;
    _Str1 = _Str1 + 0x7dc;
  } while (uVar2 < 8);
  return 0;
}



undefined4 __cdecl FUN_10005600(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  
  if ((param_2 == (byte *)0x0) || (bVar1 = *param_2, bVar1 == 0)) {
    return 0xffffffff;
  }
  bVar2 = *param_1;
  if (bVar2 == 0) {
    return 0;
  }
  iVar5 = (int)param_1 - (int)param_2;
  do {
    if (bVar2 == bVar1) {
      iVar4 = 0;
      pbVar3 = param_2;
      bVar2 = bVar1;
      do {
        if (('`' < (char)bVar2) && ((char)bVar2 < '{')) {
          bVar2 = bVar2 ^ 0x20;
        }
        if ((pbVar3[iVar5] != 0x3f) && (pbVar3[iVar5] != bVar2)) break;
        bVar2 = pbVar3[1];
        iVar4 = iVar4 + 1;
        pbVar3 = pbVar3 + 1;
      } while (bVar2 != 0);
      if (param_2[iVar4] == 0) {
        return 1;
      }
    }
    bVar2 = param_1[1];
    param_1 = param_1 + 1;
    iVar5 = iVar5 + 1;
    if (bVar2 == 0) {
      return 0;
    }
  } while( true );
}



void __cdecl FUN_100056f0(void *param_1)

{
  FUN_100120c0(*(undefined4 **)((int)param_1 + 0x4068));
  FUN_10005570();
  _free(param_1);
  return;
}



undefined4 __cdecl FUN_100060e0(int param_1,int param_2,int *param_3)

{
  bool bVar1;
  byte *pbVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  char *pcVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  char *pcVar11;
  int iVar12;
  int iVar13;
  char *pcVar14;
  byte *pbVar15;
  byte local_20 [32];
  
  pbVar15 = &DAT_10039247;
  iVar12 = 0x20;
  pbVar3 = local_20;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"LOBBY");
  FUN_100030f0(pbVar2,pbVar3,iVar12,pbVar15);
  iVar12 = 0x26ac;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039210);
  iVar12 = FUN_10002e80(pbVar3,iVar12);
  uVar4 = *(uint *)(param_2 + 0xc);
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039d3c);
  uVar4 = FUN_10002f10(pbVar3,uVar4);
  iVar5 = FUN_100055b0((char *)local_20);
  if (iVar5 == 0) {
    FUN_100123b0(*(char **)(param_1 + 4),"~slave sent invalid ident: %s",local_20);
    return 0;
  }
  iVar13 = 0x20;
  iVar6 = iVar5 + 0x7bc;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"SECRET");
  iVar6 = FUN_10003280((char *)pbVar3,iVar6,iVar13);
  *(bool *)(param_1 + 0x4064) = 0 < iVar6;
  FUN_10005420();
  uVar10 = *(undefined4 *)(param_1 + 0x110);
  uVar9 = *(undefined4 *)(param_2 + 4);
  pcVar14 = (char *)0x0;
  pcVar11 = (char *)0x0;
  pcVar8 = (char *)0x0;
  uVar7 = 0;
  iVar6 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"LIMIT");
  iVar6 = FUN_10002e80(pbVar3,iVar6);
  iVar13 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"COUNT");
  iVar13 = FUN_10002e80(pbVar3,iVar13);
  bVar1 = FUN_100119f0(*(int *)(iVar5 + 0x220),*param_3,uVar4,iVar12,iVar13,iVar6,uVar7,pcVar8,uVar9
                       ,uVar10,pcVar11,pcVar14);
  if (bVar1) {
    FUN_100123b0(*(char **)(param_1 + 4),"~slave update (seqn=%d, addr=%u.%u.%u.%u:%hu): %s",
                 (byte *)*param_3);
  }
  return 0;
}



undefined4 FUN_100064c0(void)

{
  int in_EAX;
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  char *pcVar4;
  bool bVar5;
  
  pcVar2 = *(char **)(in_EAX + 0x74);
  pcVar1 = _strchr(pcVar2,0x2b);
  if (pcVar1 == (char *)0x0) {
    return 0xffffffff;
  }
  iVar3 = 4;
  bVar5 = true;
  *pcVar1 = '\0';
  pcVar4 = "RC4";
  do {
    if (iVar3 == 0) break;
    iVar3 = iVar3 + -1;
    bVar5 = *pcVar2 == *pcVar4;
    pcVar2 = pcVar2 + 1;
    pcVar4 = pcVar4 + 1;
  } while (bVar5);
  if (bVar5) {
    pcVar2 = _strchr(pcVar1 + 1,0x2d);
    if (pcVar2 != (char *)0x0) {
      iVar3 = 4;
      bVar5 = true;
      *pcVar2 = '\0';
      pcVar1 = pcVar1 + 1;
      pcVar4 = "MD5";
      do {
        if (iVar3 == 0) break;
        iVar3 = iVar3 + -1;
        bVar5 = *pcVar1 == *pcVar4;
        pcVar1 = pcVar1 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if ((bVar5) && (pcVar2[1] == 'V')) {
        if ((pcVar2[2] == '1') && (pcVar2[3] == '\0')) {
          return 0;
        }
        if ((pcVar2[2] == '2') && (pcVar2[3] == '\0')) {
          return 1;
        }
      }
    }
  }
  return 0xffffffff;
}



void __cdecl FUN_100065e0(int *param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x2c) = 0;
  *(int **)(param_2 + 0x24) = param_1;
  if (*(int *)(param_2 + 100) == 0x40646972) {
    *(undefined1 **)(param_2 + 0x20) = &LAB_10005a70;
  }
  else if (*(int *)(param_2 + 100) == 0x40746963) {
    *(undefined1 **)(param_2 + 0x20) = &LAB_10006550;
  }
  if ((*(uint *)(param_2 + 0xc) == 0x7f000001) ||
     ((param_1[0x58] & *(uint *)(param_2 + 0xc)) == (*(uint *)(param_2 + 0x1c) & param_1[0x58]))) {
    if (param_3 == 0) {
      piVar2 = FUN_100105b0(*param_1,param_2,(int)param_1);
      if (piVar2 == (int *)0x0) {
        return;
      }
      iVar1 = param_1[0x43];
      param_1[0x43] = iVar1 + 1;
      *piVar2 = iVar1 + 1;
    }
    if (*(int *)(param_2 + 100) == 0x40636e74) {
      *(code **)(param_2 + 0x20) = FUN_100060e0;
    }
    if (*(int *)(param_2 + 100) == 0x40616c76) {
      *(undefined1 **)(param_2 + 0x20) = &LAB_10006280;
    }
  }
  return;
}



void __cdecl FUN_10006690(int param_1,int param_2,int *param_3)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  byte *unaff_EDI;
  byte *pbVar4;
  
  piVar1 = param_3;
  if (*param_3 != 0) {
    piVar3 = (int *)(param_1 + 0x388);
    param_3 = (int *)0x8;
    do {
      if (piVar3[-1] != 0) {
        if ((*piVar1 == *piVar3) && (*(int *)(param_2 + 0xc) == piVar3[1])) {
          piVar3[1] = 0;
          *piVar3 = 0;
          FUN_100123b0(*(char **)(param_1 + 4),"~got master shutdown",unaff_EDI);
        }
        iVar2 = FUN_10011c50(piVar3[-1],*piVar1,*(int *)(param_2 + 0xc));
        if (-1 < iVar2) {
          pbVar4 = (byte *)piVar3[-1];
          FUN_10011ca0((int)pbVar4,iVar2);
          FUN_100123b0(*(char **)(param_1 + 4),"~got slave shutdown",pbVar4);
        }
      }
      piVar3 = piVar3 + 0x1f7;
      param_3 = (int *)((int)param_3 + -1);
    } while (param_3 != (int *)0x0);
  }
  return;
}



char __cdecl FUN_10006840(int param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  int iVar5;
  int iVar6;
  
  piVar2 = (int *)(param_1 + 0x3800);
  iVar6 = -1;
  iVar5 = -1;
  cVar4 = '\0';
  iVar3 = 0;
  if (*(int *)(param_1 + 0x3800) != 0) {
    do {
      if (cVar4 != '\0') goto LAB_100068c2;
      if (*piVar2 == *(int *)(param_2 + 100)) {
        cVar4 = '\x01';
        iVar6 = iVar3;
      }
      piVar1 = piVar2 + 2;
      piVar2 = piVar2 + 2;
      iVar3 = iVar3 + 1;
    } while (*piVar1 != 0);
    if (cVar4 != '\0') goto LAB_100068c2;
  }
  piVar2 = (int *)(*(code *)PTR_FUN_100410cc)();
  if (piVar2 == (int *)0x0) {
    return cVar4;
  }
  if (*piVar2 == 0) {
    return cVar4;
  }
  iVar3 = 0;
  do {
    if (cVar4 != '\0') goto LAB_100068c2;
    if (*piVar2 == *(int *)(param_2 + 100)) {
      cVar4 = '\x01';
      iVar5 = iVar3;
    }
    piVar1 = piVar2 + 3;
    piVar2 = piVar2 + 3;
    iVar3 = iVar3 + 1;
  } while (*piVar1 != 0);
  if (cVar4 == '\0') {
    return '\0';
  }
LAB_100068c2:
  if (*(int *)(param_3 + 0xa4c) == 0) {
    if (*(int *)(param_3 + 0xa48) == 0) {
      *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
      *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
      return cVar4;
    }
  }
  else if (*(int *)(param_3 + 0xa48) == 0) {
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x70617574;
    return cVar4;
  }
  if (iVar6 == -1) {
    *(code **)(param_2 + 0x20) = FUN_100151b0;
    *(undefined4 *)(param_2 + 0x2c) = 0xf;
    *(int *)(param_3 + 0xad0) = iVar5;
  }
  else {
    *(code **)(param_2 + 0x20) = FUN_10014ca0;
    *(undefined4 *)(param_2 + 0x2c) = 0x1e;
    *(int *)(param_3 + 0xad0) = iVar6;
  }
  if (*(int *)(param_1 + 0x2aa524) != 0) {
    *(int *)(param_3 + 0xacc) = *(int *)(param_1 + 0x4038) + *(int *)(param_1 + 0x2aa524);
  }
  return cVar4;
}



void FUN_10006960(void)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  int unaff_EBX;
  byte *pbVar5;
  bool bVar6;
  byte *local_4;
  
  FUN_10018a80(*(int *)(unaff_EBX + 0x4304));
  pbVar2 = (byte *)FUN_10018a90(*(int *)(unaff_EBX + 0x4304),&local_4);
  do {
    if (pbVar2 == (byte *)0x0) {
      return;
    }
    _printf("Stats VIEW %s",local_4);
    pbVar3 = local_4;
    pbVar5 = pbVar2;
    do {
      bVar1 = *pbVar3;
      bVar6 = bVar1 < *pbVar5;
      if (bVar1 != *pbVar5) {
LAB_100069cc:
        iVar4 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_100069d1;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar6 = bVar1 < pbVar5[1];
      if (bVar1 != pbVar5[1]) goto LAB_100069cc;
      pbVar3 = pbVar3 + 2;
      pbVar5 = pbVar5 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_100069d1:
    if (iVar4 == 0) {
      _printf("\n");
    }
    else {
      _printf(" CNAME %s\n",pbVar2);
    }
    iVar4 = 0;
    if (*(int *)(pbVar2 + 0x1b00c) != 0) {
      pbVar3 = pbVar2 + 0xc;
      do {
        _printf("  stat %s(%s) param %d\n",pbVar3 + 0x30,pbVar3,*(undefined4 *)(pbVar3 + 100));
        iVar4 = iVar4 + 1;
        pbVar3 = pbVar3 + 0x6c;
      } while (iVar4 != *(int *)(pbVar2 + 0x1b00c));
    }
    pbVar2 = (byte *)FUN_10018a90(*(int *)(unaff_EBX + 0x4304),&local_4);
  } while( true );
}



undefined4 __cdecl FUN_10006a50(int param_1)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *unaff_EDI;
  int iVar5;
  byte *pbVar6;
  int iVar7;
  
  iVar2 = *(int *)(param_1 + 0x10);
  if ((iVar2 != 1) && (iVar2 != 2)) {
    _printf("%s:%d NAME is not valid in this state %d\n",*(undefined4 *)(param_1 + 4),
            *(undefined4 *)(param_1 + 8),iVar2);
    return 0;
  }
  iVar2 = *(int *)(param_1 + 0xc);
  if (*(int *)(iVar2 + 0x1b00c) == 0x400) {
    _printf("%s:%d too many rows, only %d rows per view\n",*(undefined4 *)(param_1 + 4),
            *(undefined4 *)(param_1 + 8),0x400);
    return 0;
  }
  pbVar6 = &DAT_10039247;
  iVar5 = 0x30;
  pbVar1 = (byte *)(*(int *)(iVar2 + 0x1b00c) * 0x6c + 0xc + iVar2);
  pbVar4 = pbVar1;
  pbVar3 = FUN_10002000(unaff_EDI,&DAT_10039b60);
  FUN_100030f0(pbVar3,pbVar4,iVar5,pbVar6);
  pbVar6 = &DAT_10039247;
  iVar5 = 0x30;
  pbVar4 = pbVar1 + 0x30;
  pbVar3 = FUN_10002000(unaff_EDI,&DAT_1003a1b0);
  FUN_100030f0(pbVar3,pbVar4,iVar5,pbVar6);
  iVar5 = 0;
  pbVar4 = FUN_10002000(unaff_EDI,(byte *)"WIDTH");
  iVar5 = FUN_10002e80(pbVar4,iVar5);
  iVar7 = 0;
  *(int *)(pbVar1 + 0x60) = iVar5;
  pbVar4 = FUN_10002000(unaff_EDI,(byte *)"PARAM");
  iVar5 = FUN_10002e80(pbVar4,iVar7);
  *(int *)(pbVar1 + 100) = iVar5;
  pbVar4 = FUN_10002000(unaff_EDI,(byte *)"INDEX");
  iVar5 = FUN_10002e80(pbVar4,iVar5);
  *(int *)(pbVar1 + 0x68) = iVar5;
  *(int *)(iVar2 + 0x1b00c) = *(int *)(iVar2 + 0x1b00c) + 1;
  *(undefined4 *)(param_1 + 0x10) = 2;
  return 1;
}



undefined4 __cdecl FUN_10006b70(int *param_1)

{
  byte *in_EAX;
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  void *this;
  void *this_00;
  int iVar4;
  byte *pbVar5;
  
  iVar4 = param_1[4];
  if ((iVar4 != 0) && (iVar4 != 2)) {
    _printf("%s:%d VIEW is not valid in this state %d\n",param_1[1],param_1[2],iVar4);
    return 0;
  }
  pbVar1 = (byte *)_malloc(0x1b058);
  if (pbVar1 != (byte *)0x0) {
    pbVar5 = &DAT_10039247;
    iVar4 = 0xc;
    pbVar3 = pbVar1;
    pbVar2 = FUN_10002000(in_EAX,&DAT_1003a2a8);
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar5);
    pbVar1[0x1b00c] = 0;
    pbVar1[0x1b00d] = 0;
    pbVar1[0x1b00e] = 0;
    pbVar1[0x1b00f] = 0;
    pbVar1[0x1b010] = 1;
    pbVar1[0x1b011] = 0;
    pbVar1[0x1b012] = 0;
    pbVar1[0x1b013] = 0;
    pbVar1[0x1b014] = 0;
    pbVar1[0x1b015] = 0;
    pbVar1[0x1b016] = 0;
    pbVar1[0x1b017] = 0;
    iVar4 = FUN_10018890(this,*(int *)(*param_1 + 0x4304),pbVar1);
    if (iVar4 == 0) {
      iVar4 = FUN_10018820(*(void **)(*param_1 + 0x4304),(int *)*(void **)(*param_1 + 0x4304),pbVar1
                           ,(int)pbVar1);
      if (iVar4 < 0) {
        _printf("%s:%d VIEW %s could not be added\n",param_1[1],param_1[2],pbVar1);
        return 0;
      }
      pbVar5 = &DAT_10039247;
      pbVar3 = pbVar1 + 0x1b048;
      iVar4 = 0x10;
      *pbVar3 = 0;
      pbVar2 = FUN_10002000(in_EAX,&DAT_1003a25c);
      FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar5);
      iVar4 = *(int *)(pbVar1 + 0x1b014);
      while( true ) {
        if ((iVar4 == 4) || (pbVar3 = FUN_10002000(in_EAX,(byte *)"ALIAS"), pbVar3 == (byte *)0x0))
        {
          param_1[3] = (int)pbVar1;
          param_1[4] = 1;
          return 1;
        }
        pbVar2 = pbVar1 + (*(int *)(pbVar1 + 0x1b014) + 0x2402) * 0xc;
        FUN_100030f0(pbVar3,pbVar2,0xc,&DAT_10039247);
        iVar4 = FUN_10018890(this_00,*(int *)(*param_1 + 0x4304),pbVar2);
        if (iVar4 != 0) {
          _printf("%s:%d ALIAS %s already defined\n",param_1[1],param_1[2],pbVar2);
          return 0;
        }
        iVar4 = FUN_10018820((void *)*param_1,*(int **)(*param_1 + 0x4304),pbVar2,(int)pbVar1);
        if (iVar4 < 0) break;
        iVar4 = *(int *)(pbVar1 + 0x1b014) + 1;
        in_EAX = pbVar3 + 1;
        *(int *)(pbVar1 + 0x1b010) = *(int *)(pbVar1 + 0x1b010) + 1;
        *(int *)(pbVar1 + 0x1b014) = iVar4;
      }
      _printf("%s:%d ALIAS %s could not be added\n",param_1[1],param_1[2],pbVar2);
      return 0;
    }
    _printf("%s:%d VIEW %s already defined\n",param_1[1],param_1[2]);
  }
  return 0;
}



undefined4 __cdecl FUN_10006d70(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  char *unaff_EBX;
  char *pcVar3;
  char *pcVar4;
  bool bVar5;
  char local_64 [100];
  
  if (*unaff_EBX != '#') {
    iVar1 = FUN_10002270(unaff_EBX,local_64,100);
    if (iVar1 != 0) {
      iVar1 = 5;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "NAME";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_10006a50((int)param_1);
        return uVar2;
      }
      iVar1 = 5;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "VIEW";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_10006b70(param_1);
        return uVar2;
      }
      _printf("%s:%d invalid configuration \'%s\'\n",param_1[1],param_1[2],local_64);
      return 0;
    }
  }
  return 1;
}



int __cdecl FUN_10006e20(int param_1)

{
  FILE *_File;
  char *pcVar1;
  int iVar2;
  char *unaff_EDI;
  int local_114;
  char local_100 [256];
  
  iVar2 = 0;
  _printf("Loading stats configuration from \'%s\'\n");
  _File = (FILE *)FUN_1002e478(unaff_EDI,"r");
  if (_File == (FILE *)0x0) {
    _printf("could not open status configuration %s\n");
    return 0;
  }
  local_114 = param_1;
  pcVar1 = _fgets(local_100,0x100,_File);
  if (pcVar1 == (char *)0x0) {
LAB_10006ee6:
    _printf("Loading stats configuration from \'%s\' failed\n");
  }
  else {
    do {
      iVar2 = FUN_10006d70(&local_114);
      if (iVar2 == 0) goto LAB_10006ee6;
      pcVar1 = _fgets(local_100,0x100,_File);
    } while (pcVar1 != (char *)0x0);
    _printf("Loaded stats configuration from \'%s\'\n");
    FUN_10006960();
  }
  _fclose(_File);
  return iVar2;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

undefined4 * __cdecl
FUN_10006f10(int param_1,undefined4 param_2,undefined4 param_3,byte *param_4,byte *param_5)

{
  char cVar1;
  undefined4 *_Memory;
  undefined4 *puVar2;
  byte *pbVar3;
  int *piVar4;
  byte *pbVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  undefined4 *puVar11;
  uint uVar12;
  u_short uVar13;
  char *pcVar14;
  byte *pbVar15;
  undefined **local_1004;
  byte local_1000 [4092];
  undefined4 uStack_4;
  
  uStack_4 = 0x10006f1a;
  _Memory = (undefined4 *)_malloc(0x2aac2c);
  puVar2 = _Memory;
  for (iVar8 = 0xaab0b; iVar8 != 0; iVar8 = iVar8 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  _Memory[0x100b] = param_2;
  puVar2 = FUN_1001bef0();
  pcVar14 = "libslvcust.so";
  iVar8 = 0x100;
  pbVar5 = (byte *)(_Memory + 0xaaab8);
  _Memory[0x100c] = puVar2;
  pbVar3 = FUN_10002000(param_4,(byte *)"SLVCUST");
  FUN_100030f0(pbVar3,pbVar5,iVar8,(byte *)pcVar14);
  piVar4 = FUN_10011f70("localize.csv");
  _Memory[0xaaafa] = piVar4;
  cVar1 = FUN_10013080();
  if (cVar1 != '\0') {
    puVar2 = FUN_10018b00(3,10);
    pbVar15 = &DAT_10039247;
    iVar8 = 0x1000;
    pbVar5 = local_1000;
    _Memory[0x10c1] = puVar2;
    pbVar3 = FUN_10002000(param_4,(byte *)"STATSFILE");
    FUN_100030f0(pbVar3,pbVar5,iVar8,pbVar15);
    if ((local_1000[0] != 0) && (iVar8 = FUN_10006e20((int)_Memory), iVar8 == 0)) {
      _printf("_SlaveCreate: fatal stats file error, shutting down.\n");
      FUN_10010510(param_1);
      _free(_Memory);
      return (undefined4 *)0x0;
    }
    pbVar15 = &DAT_10039247;
    iVar8 = 0x80;
    pbVar5 = (byte *)(_Memory + 0xaa8cb);
    _Memory[0x1008] = param_1;
    pbVar3 = FUN_10002000(param_5,(byte *)"VERSION");
    FUN_100030f0(pbVar3,pbVar5,iVar8,pbVar15);
    iVar8 = 0;
    pbVar5 = FUN_10002000(param_5,&DAT_10039210);
    iVar8 = FUN_10002e80(pbVar5,iVar8);
    _Memory[0x100f] = iVar8;
    puVar2 = FUN_10017d30(0x10000);
    iVar8 = 0x26ac;
    _Memory[0x1009] = puVar2;
    pbVar5 = FUN_10002000(param_4,&DAT_10039210);
    iVar8 = FUN_10002e80(pbVar5,iVar8);
    pbVar5 = FUN_10002000(param_4,(byte *)"MPORT");
    iVar8 = FUN_10002e80(pbVar5,iVar8);
    uVar13 = (u_short)iVar8;
    uVar12 = 0x7f000001;
    pbVar5 = FUN_10002000(param_4,&DAT_10039d3c);
    uVar12 = FUN_10002f10(pbVar5,uVar12);
    pbVar5 = FUN_10002000(param_4,(byte *)"MADDR");
    uVar12 = FUN_10002f10(pbVar5,uVar12);
    FUN_10017e90((int *)_Memory[0x1009],uVar12,uVar13);
    puVar2 = FUN_10017d30(0x10000);
    _Memory[0x100a] = puVar2;
    puVar2 = FUN_10017d30(0x10000);
    iVar8 = 0x26ac;
    _Memory[0x1010] = puVar2;
    pbVar5 = FUN_10002000(param_4,&DAT_10039210);
    iVar8 = FUN_10002e80(pbVar5,iVar8);
    pbVar5 = FUN_10002000(param_4,(byte *)"RPORT");
    iVar8 = FUN_10002e80(pbVar5,iVar8);
    uVar13 = (u_short)iVar8;
    uVar12 = 0x7f000001;
    pbVar5 = FUN_10002000(param_4,&DAT_10039d3c);
    uVar12 = FUN_10002f10(pbVar5,uVar12);
    pbVar5 = FUN_10002000(param_4,(byte *)"RADDR");
    uVar12 = FUN_10002f10(pbVar5,uVar12);
    FUN_10017e90((int *)_Memory[0x1010],uVar12,uVar13);
    puVar2 = FUN_10018b00(100,1000);
    _Memory[0x1034] = puVar2;
    puVar2 = FUN_10019e90(100,1000);
    _Memory[0x1035] = puVar2;
    puVar2 = FUN_10019e90(100,1000);
    _Memory[0x1036] = puVar2;
    puVar2 = FUN_10018b00(500,5000);
    _Memory[0x1037] = puVar2;
    FUN_1002c1c0((int)puVar2,FUN_10019c70);
    puVar2 = FUN_10018b00(500,5000);
    _Memory[0x1038] = puVar2;
    FUN_1002c1c0((int)puVar2,FUN_10019c70);
    puVar2 = FUN_10019e90(500,5000);
    _Memory[0x1039] = puVar2;
    puVar2 = FUN_10018b00(500,5000);
    _Memory[0x103a] = puVar2;
    puVar2 = FUN_10019e90(500,5000);
    _Memory[0x103b] = puVar2;
    uVar6 = FUN_10019a50(0);
    _Memory[0x103c] = uVar6;
    puVar2 = FUN_10018b00(500,5000);
    _Memory[0x103d] = puVar2;
    puVar2 = FUN_10019e90(500,5000);
    _Memory[0x103e] = puVar2;
    puVar2 = FUN_10018b00(3,10);
    _Memory[0x10c0] = puVar2;
    _Memory[0x10c2] = 1;
    _Memory[0x10c3] = 0x800;
    _Memory[0x878c4] = 1;
    _Memory[0x878c5] = 0x800;
    piVar4 = FUN_10019930(0x1000);
    _Memory[0xaa994] = piVar4;
    iVar8 = 0;
    if (PTR_DAT_10041098 != (undefined *)0x0) {
      local_1004 = &PTR_DAT_10041098;
      puVar2 = (undefined4 *)PTR_DAT_10041098;
      do {
        if (puVar2[0xd] != 0) {
          iVar10 = 0;
          puVar7 = _Memory + iVar8 * 0xe;
          do {
            puVar11 = puVar7;
            for (iVar9 = 0xe; iVar9 != 0; iVar9 = iVar9 + -1) {
              *puVar11 = *puVar2;
              puVar2 = puVar2 + 1;
              puVar11 = puVar11 + 1;
            }
            iVar10 = iVar10 + 0x38;
            puVar2 = (undefined4 *)(*local_1004 + iVar10);
            iVar8 = iVar8 + 1;
            puVar7 = puVar7 + 0xe;
          } while (puVar2[0xd] != 0);
        }
        puVar2 = (undefined4 *)local_1004[1];
        local_1004 = local_1004 + 1;
      } while (puVar2 != (undefined4 *)0x0);
    }
    puVar2 = FUN_10019900();
    _Memory[0xaa8c7] = puVar2;
    puVar2 = FUN_10019900();
    _Memory[0xaa8c8] = puVar2;
    puVar2 = FUN_10018b00(10,100);
    _Memory[0xaa995] = puVar2;
    FUN_1002c1c0((int)puVar2,_strcmp);
    uVar6 = (*(code *)PTR_FUN_100410ac)(_Memory);
    _Memory[0xaaaf8] = uVar6;
    return _Memory;
  }
  _fprintf((FILE *)&DAT_100415c0,"SlaveCreate: failed to load slv-cust module.\n");
  FUN_10010510(param_1);
  _free(_Memory);
  return (undefined4 *)0x0;
}



void __cdecl FUN_100073b0(void *param_1)

{
  int *piVar1;
  void *pvVar2;
  int iVar3;
  undefined4 *puVar4;
  
  (*(code *)PTR_FUN_100410bc)(*(undefined4 *)((int)param_1 + 0x2aabe0));
  FUN_10019990(*(int **)((int)param_1 + 0x2aa650));
  FUN_10019210(*(void **)((int)param_1 + 0x2aa31c));
  FUN_10019210(*(void **)((int)param_1 + 0x2aa320));
  pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x4304));
  while (pvVar2 != (void *)0x0) {
    piVar1 = (int *)((int)pvVar2 + 0x1b010);
    *piVar1 = *piVar1 + -1;
    if (*piVar1 == 0) {
      _free(pvVar2);
    }
    pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x4304));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x4304));
  pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x4300));
  while (pvVar2 != (void *)0x0) {
    FUN_1001de90(pvVar2);
    pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x4300));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x4300));
  iVar3 = FUN_10018720(*(int **)((int)param_1 + 0x40e8));
  while (iVar3 != 0) {
    FUN_1001dce0(*(int *)((int)param_1 + 0x40f0),iVar3);
    iVar3 = FUN_10018720(*(int **)((int)param_1 + 0x40e8));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x40e8));
  FUN_10019f20(*(void **)((int)param_1 + 0x40ec));
  FUN_10019a80(*(void **)((int)param_1 + 0x40f0),'\0');
  pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x40d0));
  while (pvVar2 != (void *)0x0) {
    FUN_10019f20(*(void **)((int)pvVar2 + 0xf4));
    FUN_10019f20(*(void **)((int)pvVar2 + 0xf8));
    _free(pvVar2);
    pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x40d0));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x40d0));
  FUN_10019f20(*(void **)((int)param_1 + 0x40d4));
  FUN_10019f20(*(void **)((int)param_1 + 0x40d8));
  pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x40e0));
  while (pvVar2 != (void *)0x0) {
    _free(pvVar2);
    pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x40e0));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x40e0));
  FUN_10018680(*(void **)((int)param_1 + 0x40dc));
  FUN_10019f20(*(void **)((int)param_1 + 0x40e4));
  pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x40f4));
  while (pvVar2 != (void *)0x0) {
    FUN_1001d220(pvVar2);
    pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x40f4));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x40f4));
  FUN_10019f20(*(void **)((int)param_1 + 0x40f8));
  puVar4 = (undefined4 *)((int)param_1 + 0x4100);
  iVar3 = 0x80;
  do {
    if ((void *)*puVar4 != (void *)0x0) {
      FUN_1001c510((void *)*puVar4);
    }
    puVar4 = puVar4 + 1;
    iVar3 = iVar3 + -1;
  } while (iVar3 != 0);
  FUN_10017da0(*(SOCKET **)((int)param_1 + 0x4024));
  FUN_10017da0(*(SOCKET **)((int)param_1 + 0x4040));
  FUN_10017da0(*(SOCKET **)((int)param_1 + 0x4028));
  pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x2aa654));
  while (pvVar2 != (void *)0x0) {
    FUN_100119c0(pvVar2);
    pvVar2 = (void *)FUN_10018720(*(int **)((int)param_1 + 0x2aa654));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x2aa654));
  FUN_100120c0(*(undefined4 **)((int)param_1 + 0x2aabe8));
  FUN_1001c2f0(*(uint **)((int)param_1 + 0x4030));
  _free(param_1);
  return;
}



void __cdecl FUN_10007680(int param_1,undefined4 param_2,byte *param_3)

{
  byte *pbVar1;
  uint *puVar2;
  uint *puVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  byte local_40 [64];
  
  if (param_3 != (byte *)0x0) {
    iVar4 = 0;
    pbVar1 = FUN_10002000(param_3,(byte *)"OFFLINE");
    iVar4 = FUN_10002e80(pbVar1,iVar4);
    iVar5 = 1;
    *(int *)(param_1 + 0x2aa4cc) = iVar4;
    pbVar1 = FUN_10002000(param_3,(byte *)"RDIR_REGISTER");
    iVar4 = FUN_10002e80(pbVar1,iVar5);
    uVar6 = 0xffffff00;
    *(bool *)(param_1 + 0x4048) = iVar4 != 0;
    pbVar1 = FUN_10002000(param_3,(byte *)"TRUST");
    uVar6 = FUN_10002f10(pbVar1,uVar6);
    *(uint *)(param_1 + 0x404c) = uVar6;
    puVar2 = (uint *)(param_1 + 0x4050);
    puVar3 = puVar2;
    for (iVar4 = 0x20; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
    pbVar1 = FUN_10002000(param_3,(byte *)"TRUST_MATCH");
    if (pbVar1 != (byte *)0x0) {
      iVar4 = 0;
      do {
        FUN_10002f60(pbVar1,local_40,0x40,&DAT_10039247,iVar4,0x2c);
        if (local_40[0] == 0) break;
        uVar6 = FUN_10002f10(local_40,0);
        *puVar2 = uVar6;
        iVar4 = iVar4 + 1;
        puVar2 = puVar2 + 1;
      } while (iVar4 < 0x20);
    }
    (*(code *)PTR_FUN_100410b4)(*(undefined4 *)(param_1 + 0x2aabe0),param_3);
  }
  return;
}



undefined4 __cdecl
FUN_10007a20(int param_1,int param_2,int param_3,int *param_4,int *param_5,undefined4 *param_6,
            undefined4 param_7,undefined4 *param_8,undefined4 param_9,undefined4 param_10)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  void *this;
  int iVar6;
  byte *pbVar7;
  undefined4 local_8;
  byte *local_4;
  
  iVar3 = param_2;
  iVar2 = param_1;
  iVar1 = *(int *)(param_1 + 0x4100 + *(int *)(param_2 + 0xa0) * 4);
  iVar6 = 0;
  pbVar7 = (byte *)0x0;
  iVar4 = param_3;
  if (*(char *)(param_2 + 0xa5) == '\0') {
    if (*(char *)(param_2 + 0xa4) == '\0') goto LAB_10007a81;
    iVar4 = *(int *)(param_2 + 0x6f0 + param_3 * 8);
  }
  pbVar7 = (byte *)(iVar4 * 0x10 + 0xac + param_2);
  param_2 = iVar1;
  iVar4 = FUN_1001d090(iVar1,(char *)pbVar7);
  iVar1 = param_2;
LAB_10007a81:
  param_2 = iVar1;
  local_4 = (byte *)FUN_1001cde0(param_2,iVar4,&local_8,&param_1);
  if (local_4 != (byte *)0x0) {
    pbVar7 = local_4;
  }
  if (pbVar7 == (byte *)0x0) {
    if (*(int *)(iVar3 + 0xa8) != 0) {
      iVar6 = FUN_1001a190(*(int *)(iVar2 + 0x40e4),*(int *)(iVar3 + 0xa48));
      pbVar7 = (byte *)(iVar6 + 0x20);
    }
  }
  else {
    iVar6 = FUN_10018890(this,*(int *)(iVar2 + 0x40e0),pbVar7);
  }
  if (local_4 == (byte *)0x0) {
    if (*(int *)(iVar3 + 0xa8) == 0) {
      return 0;
    }
    param_1 = FUN_1001cda0(param_2);
    local_8 = 0;
    uVar5 = (*(code *)PTR_FUN_10041104)
                      (*(undefined4 *)(iVar2 + 0x2aabe0),pbVar7,param_1 + 1,0,iVar6 != 0,
                       *(undefined2 *)(*(int *)(iVar3 + 0xa8) + 0xce4),param_9,param_10);
  }
  else {
    uVar5 = (*(code *)PTR_FUN_100410e4)
                      (*(undefined4 *)(iVar2 + 0x2aabe0),*(undefined4 *)(iVar3 + 0xa0),pbVar7,
                       param_1 + 1,local_8,iVar6 != 0,local_4 + 0x20,param_9,param_10);
  }
  *param_4 = (int)pbVar7;
  *param_5 = param_1 + 1;
  *param_6 = local_8;
  *(bool *)param_7 = iVar6 != 0;
  *param_8 = uVar5;
  return 1;
}



void __cdecl FUN_10007bc0(int param_1)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *unaff_EBX;
  uint uVar4;
  byte *pbVar5;
  int iVar6;
  int iVar7;
  byte local_10 [16];
  
  iVar6 = 0;
  pbVar1 = FUN_10002000(unaff_EBX,&DAT_1003a574);
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  iVar7 = 0;
  *(short *)(param_1 + 0xce4) = (short)iVar6;
  pbVar1 = FUN_10002000(unaff_EBX,&DAT_1003a570);
  iVar6 = FUN_10002e80(pbVar1,iVar7);
  uVar4 = 0;
  *(short *)(param_1 + 0xce6) = (short)iVar6;
  if (*(short *)(param_1 + 0xce4) != 0) {
    pbVar1 = (byte *)(param_1 + 0x84);
    do {
      _sprintf((char *)local_10,"COLNAME%d",uVar4);
      pbVar5 = &DAT_10039247;
      iVar6 = 0x20;
      pbVar3 = pbVar1 + -0x40;
      pbVar2 = FUN_10002000(unaff_EBX,local_10);
      FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar5);
      _sprintf((char *)local_10,"COLDESC%d",uVar4);
      pbVar5 = &DAT_10039247;
      iVar6 = 0x20;
      pbVar3 = pbVar1 + -0x20;
      pbVar2 = FUN_10002000(unaff_EBX,local_10);
      FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar5);
      _sprintf((char *)local_10,"COLPARAM%d",uVar4);
      pbVar5 = &DAT_10039247;
      iVar6 = 0x20;
      pbVar3 = pbVar1;
      pbVar2 = FUN_10002000(unaff_EBX,local_10);
      FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar5);
      _sprintf((char *)local_10,"COLWIDTH%d",uVar4);
      iVar6 = 0x38;
      pbVar3 = FUN_10002000(unaff_EBX,local_10);
      iVar6 = FUN_10002e80(pbVar3,iVar6);
      *(int *)(pbVar1 + 0x20) = iVar6;
      uVar4 = uVar4 + 1;
      pbVar1 = pbVar1 + 100;
    } while (uVar4 != *(ushort *)(param_1 + 0xce4));
  }
  return;
}



void __cdecl FUN_10007d00(int param_1,byte *param_2,undefined2 param_3)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  void *pvVar6;
  long lVar7;
  void *this;
  uint uVar8;
  byte *pbVar9;
  int iVar10;
  undefined4 *puVar11;
  char *pcVar12;
  int iVar13;
  byte *pbVar14;
  byte *pbVar15;
  byte *pbVar16;
  int iVar17;
  byte local_18 [12];
  byte local_c [12];
  
  iVar13 = 0;
  pbVar1 = FUN_10002000(param_2,&DAT_1003a610);
  uVar2 = FUN_10002e80(pbVar1,iVar13);
  iVar13 = 0;
  pbVar1 = FUN_10002000(param_2,&DAT_1003a60c);
  uVar3 = FUN_10002e80(pbVar1,iVar13);
  iVar13 = 0;
  pbVar1 = FUN_10002000(param_2,&DAT_1003a608);
  uVar4 = FUN_10002e80(pbVar1,iVar13);
  pbVar14 = &DAT_10039247;
  iVar13 = 0xc;
  pbVar1 = local_18;
  pbVar5 = FUN_10002000(param_2,&DAT_1003a2a8);
  FUN_100030f0(pbVar5,pbVar1,iVar13,pbVar14);
  pbVar1 = (byte *)FUN_10018890(local_18,*(int *)(param_1 + 0x4300),local_18);
  if (pbVar1 == (byte *)0x0) {
    pbVar1 = (byte *)_malloc(0x24);
    _strncpy((char *)pbVar1,(char *)local_18,0xc);
    pbVar1[0xc] = 0;
    pbVar1[0xd] = 0;
    pbVar1[0xe] = 0;
    pbVar1[0xf] = 0;
    pbVar1[0x10] = 0;
    pbVar1[0x11] = 0;
    pbVar1[0x12] = 0;
    pbVar1[0x13] = 0;
    pbVar1[0x14] = 0;
    pbVar1[0x15] = 0;
    pbVar1[0x16] = 0;
    pbVar1[0x17] = 0;
    pbVar1[0x18] = 0;
    pbVar1[0x19] = 0;
    pbVar1[0x1a] = 0;
    pbVar1[0x1b] = 0;
    pbVar1[0x1c] = 0;
    pbVar1[0x1d] = 0;
    pbVar1[0x1e] = 0;
    pbVar1[0x1f] = 0;
    pbVar1[0x20] = 0;
    pbVar1[0x21] = 0;
    pbVar1[0x22] = 0;
    pbVar1[0x23] = 0;
    FUN_10018820(this,*(int **)(param_1 + 0x4300),pbVar1,(int)pbVar1);
  }
  *(int *)(pbVar1 + 0x20) = *(int *)(pbVar1 + 0x20) + 1;
  if (*(uint *)(pbVar1 + 0x14) <= uVar2) {
    pbVar5 = (byte *)(uVar2 + 2);
    pvVar6 = _realloc(*(void **)(pbVar1 + 0xc),(int)pbVar5 * 0x30);
    if (pvVar6 == (void *)0x0) {
      pcVar12 = "~failed to create %d categories";
      goto LAB_10007eb0;
    }
    puVar11 = (undefined4 *)(uVar2 * 0x30 + (int)pvVar6);
    for (uVar8 = (uint)(((int)pbVar5 - *(int *)(pbVar1 + 0x14)) * 0x30) >> 2; uVar8 != 0;
        uVar8 = uVar8 - 1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    for (iVar13 = 0; iVar13 != 0; iVar13 = iVar13 + -1) {
      *(undefined1 *)puVar11 = 0;
      puVar11 = (undefined4 *)((int)puVar11 + 1);
    }
    *(void **)(pbVar1 + 0xc) = pvVar6;
    *(byte **)(pbVar1 + 0x14) = pbVar5;
  }
  pbVar15 = &DAT_10039247;
  iVar13 = 0x20;
  pbVar9 = (byte *)(uVar2 * 0x30 + *(int *)(pbVar1 + 0xc));
  pbVar5 = pbVar9;
  pbVar14 = FUN_10002000(param_2,&DAT_1003a5e4);
  FUN_100030f0(pbVar14,pbVar5,iVar13,pbVar15);
  if (*(uint *)(pbVar1 + 0x10) < uVar2 + 1) {
    *(uint *)(pbVar1 + 0x10) = uVar2 + 1;
  }
  *(uint *)(pbVar9 + 0x20) = uVar2;
  if (*(uint *)(pbVar9 + 0x2c) <= uVar4) {
    pbVar5 = (byte *)(uVar4 + 2);
    pvVar6 = _realloc(*(void **)(pbVar9 + 0x24),(int)pbVar5 * 0x30);
    if (pvVar6 == (void *)0x0) {
      pcVar12 = "~failed to create %d indices";
LAB_10007eb0:
      FUN_100123b0(*(char **)(param_1 + 0x402c),pcVar12,pbVar5);
      return;
    }
    puVar11 = (undefined4 *)(uVar4 * 0x30 + (int)pvVar6);
    for (uVar2 = (uint)(((int)pbVar5 - *(int *)(pbVar9 + 0x2c)) * 0x30) >> 2; uVar2 != 0;
        uVar2 = uVar2 - 1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    for (iVar13 = 0; iVar13 != 0; iVar13 = iVar13 + -1) {
      *(undefined1 *)puVar11 = 0;
      puVar11 = (undefined4 *)((int)puVar11 + 1);
    }
    *(void **)(pbVar9 + 0x24) = pvVar6;
    *(byte **)(pbVar9 + 0x2c) = pbVar5;
  }
  pbVar16 = &DAT_10039247;
  iVar13 = 0x20;
  pbVar15 = (byte *)(uVar4 * 0x30 + *(int *)(pbVar9 + 0x24));
  pbVar5 = pbVar15;
  pbVar14 = FUN_10002000(param_2,&DAT_1003a5c0);
  FUN_100030f0(pbVar14,pbVar5,iVar13,pbVar16);
  if (*(uint *)(pbVar9 + 0x28) < uVar4 + 1) {
    *(uint *)(pbVar9 + 0x28) = uVar4 + 1;
    *(int *)(pbVar1 + 0x18) = *(int *)(pbVar1 + 0x18) + 1;
  }
  *(uint *)(pbVar15 + 0x20) = uVar4;
  if (*(uint *)(pbVar15 + 0x2c) <= uVar3) {
    pbVar5 = (byte *)(uVar3 + 2);
    pvVar6 = _realloc(*(void **)(pbVar15 + 0x24),(int)pbVar5 * 0xcf0);
    if (pvVar6 == (void *)0x0) {
      FUN_100123b0(*(char **)(param_1 + 0x402c),"~failed to create %d variations",pbVar5);
      return;
    }
    *(byte **)(pbVar15 + 0x2c) = pbVar5;
    *(void **)(pbVar15 + 0x24) = pvVar6;
  }
  pbVar16 = &DAT_10039247;
  pbVar9 = (byte *)(uVar3 * 0xcf0 + *(int *)(pbVar15 + 0x24));
  iVar13 = 0x20;
  pbVar5 = pbVar9;
  pbVar14 = FUN_10002000(param_2,&DAT_1003a59c);
  FUN_100030f0(pbVar14,pbVar5,iVar13,pbVar16);
  *(uint *)(pbVar9 + 0x40) = uVar3;
  if (*(uint *)(pbVar15 + 0x28) < uVar3 + 1) {
    *(uint *)(pbVar15 + 0x28) = uVar3 + 1;
    *(int *)(pbVar1 + 0x1c) = *(int *)(pbVar1 + 0x1c) + 1;
  }
  pbVar14 = &DAT_10039247;
  iVar13 = 0x20;
  pbVar1 = pbVar9 + 0x20;
  *(undefined2 *)(pbVar9 + 0xce8) = param_3;
  pbVar5 = FUN_10002000(param_2,&DAT_1003a1b0);
  FUN_100030f0(pbVar5,pbVar1,iVar13,pbVar14);
  iVar13 = 100;
  pbVar1 = FUN_10002000(param_2,(byte *)"RANGE");
  iVar13 = FUN_10002e80(pbVar1,iVar13);
  iVar10 = 0;
  iVar17 = 0;
  *(short *)(pbVar9 + 0xcec) = (short)iVar13;
  pbVar9[0xcee] = 0;
  pbVar9[0xcef] = 0;
  pbVar1 = FUN_10002000(param_2,(byte *)"CENTERED");
  iVar13 = FUN_10002e80(pbVar1,iVar17);
  if (iVar13 != 0) {
    pbVar9[0xcee] = pbVar9[0xcee] | 1;
  }
  iVar13 = 0;
  pbVar1 = FUN_10002000(param_2,(byte *)"BUDDIES");
  iVar13 = FUN_10002e80(pbVar1,iVar13);
  if (iVar13 != 0) {
    pbVar9[0xcee] = pbVar9[0xcee] | 2;
  }
  pbVar1 = FUN_10002000(param_2,(byte *)"PARAMS");
  if (pbVar1 != (byte *)0x0) {
    pbVar5 = pbVar9 + 0xcc4;
    do {
      iVar13 = FUN_10002f60(pbVar1,local_c,0xc,&DAT_10039247,iVar10,0x2c);
      if ((iVar13 < 1) || (local_c[0] == 0)) break;
      lVar7 = _atol((char *)local_c);
      *(long *)pbVar5 = lVar7;
      iVar10 = iVar10 + 1;
      pbVar5 = pbVar5 + 4;
    } while (iVar10 != 8);
  }
  *(short *)(pbVar9 + 0xcea) = (short)iVar10;
  FUN_10007bc0((int)pbVar9);
  return;
}



void __cdecl FUN_10008100(int param_1)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  byte *unaff_ESI;
  int iVar6;
  
  iVar6 = 0;
  pbVar1 = FUN_10002000(unaff_ESI,&DAT_1003a614);
  iVar2 = FUN_10002e80(pbVar1,iVar6);
  iVar6 = 0;
  pbVar1 = FUN_10002000(unaff_ESI,&DAT_1003a61c);
  iVar3 = FUN_10002e80(pbVar1,iVar6);
  iVar6 = 0;
  pbVar1 = FUN_10002000(unaff_ESI,&DAT_1003a618);
  iVar4 = FUN_10002e80(pbVar1,iVar6);
  iVar6 = iVar3;
  if (999 < iVar3) {
    iVar6 = 1000;
  }
  puVar5 = FUN_1001c350(iVar3,iVar6,500,iVar4,0,0x10);
  *(undefined4 **)(param_1 + 0x4100 + iVar2 * 4) = puVar5;
  return;
}



void __cdecl FUN_10008190(byte *param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  uint uVar2;
  byte *in_EAX;
  byte *pbVar3;
  byte *pbVar4;
  undefined4 *puVar5;
  long lVar6;
  int *piVar7;
  uint *puVar8;
  uint *puVar9;
  int *piVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  void *this;
  void *this_00;
  void *this_01;
  void *this_02;
  bool bVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  u_short uVar18;
  byte *pbVar19;
  uint uVar20;
  int iVar21;
  uint local_e14;
  int local_e10;
  int local_e0c;
  int local_e08;
  byte local_e04 [64];
  byte local_dc4 [64];
  byte local_d84 [64];
  byte local_d44 [64];
  byte local_d04 [260];
  byte local_c00 [1024];
  byte local_800 [32];
  byte local_7e0 [2016];
  
  if (param_2 == 0x534c4156) {
    _printf("Slave got authorization\n");
    pbVar19 = &DAT_10039247;
    iVar15 = 0x80;
    pbVar4 = param_1 + 0x2aa3ac;
    pbVar3 = FUN_10002000(in_EAX,&DAT_10039e58);
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    uVar20 = 0;
    pbVar4 = FUN_10002000(in_EAX,&DAT_1003a854);
    uVar20 = FUN_10002f10(pbVar4,uVar20);
    iVar15 = 1;
    *(uint *)(param_1 + 0x4034) = uVar20;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"RANKINGS");
    iVar15 = FUN_10002e80(pbVar4,iVar15);
    pbVar19 = &DAT_10039247;
    iVar16 = 0x20;
    pbVar4 = param_1 + 0x2aa4ac;
    *(int *)(param_1 + 0x40fc) = iVar15;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"WEBPASS");
    FUN_100030f0(pbVar3,pbVar4,iVar16,pbVar19);
    pbVar19 = &DAT_10039247;
    iVar15 = 0x40;
    pbVar4 = local_d44;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"START");
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar4 = param_1 + 0x2aa42c;
    if (param_1[0x2aa42c] == 0) {
      pbVar3 = local_d44;
      iVar15 = (int)pbVar4 - (int)pbVar3;
      do {
        bVar1 = *pbVar3;
        pbVar3[iVar15] = bVar1;
        pbVar3 = pbVar3 + 1;
      } while (bVar1 != 0);
    }
    pbVar3 = local_d44;
    do {
      bVar1 = *pbVar4;
      bVar14 = bVar1 < *pbVar3;
      if (bVar1 != *pbVar3) {
LAB_100082c6:
        iVar15 = (1 - (uint)bVar14) - (uint)(bVar14 != 0);
        goto LAB_100082cb;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar4[1];
      bVar14 = bVar1 < pbVar3[1];
      if (bVar1 != pbVar3[1]) goto LAB_100082c6;
      pbVar4 = pbVar4 + 2;
      pbVar3 = pbVar3 + 2;
    } while (bVar1 != 0);
    iVar15 = 0;
LAB_100082cb:
    if (iVar15 != 0) {
      FUN_10010510(*(int *)(param_1 + 0x4020));
    }
  }
  if (param_3 == -1) {
    local_dc4[0] = 0;
    FUN_100023e0(local_dc4,0x20,(byte *)"UPDATES",0x3c28a2);
    FUN_10018470(*(SOCKET **)(param_1 + 0x4024),0x534c4156,0,(char *)local_dc4,(char *)0xffffffff);
    *(int *)(param_1 + 0x2aa56c) = *(int *)(param_1 + 0x2aa56c) + 1;
    return;
  }
  if ((((param_2 < 0) && (uVar20 = FUN_100106a0(*(uint **)(param_1 + 0x4020),-param_2), uVar20 != 0)
       ) && (*(int *)(uVar20 + 0x20) != 0)) && (uVar20 != 0xffffff74)) {
    puVar5 = FUN_100199e0(*(int **)(param_1 + 0x2aa650),param_4 + 1);
    *(undefined4 **)(uVar20 + 0xb50) = puVar5;
    pbVar4 = (byte *)puVar5[3];
    pbVar3 = in_EAX;
    do {
      bVar1 = *pbVar3;
      pbVar3 = pbVar3 + 1;
      *pbVar4 = bVar1;
      pbVar4 = pbVar4 + 1;
    } while (bVar1 != 0);
    **(int **)(uVar20 + 0xb50) = param_2;
    *(int *)(*(int *)(uVar20 + 0xb50) + 4) = param_3;
    *(undefined4 *)(uVar20 + 0x28) = 0;
  }
  if (param_2 == 0x2b736563) {
    pbVar4 = in_EAX;
    do {
      bVar1 = *pbVar4;
      pbVar4 = pbVar4 + 1;
    } while (bVar1 != 0);
    pbVar4 = in_EAX + (int)(pbVar4 + (1 - (int)(in_EAX + 1)));
    FUN_1001c270(*(int *)(param_1 + 0x4030),(char *)in_EAX,(char *)pbVar4);
    iVar15 = __stricmp((char *)in_EAX,"FILTER");
    if ((iVar15 == 0) || (iVar15 = __stricmp((char *)in_EAX,"FILTER-TEXT"), iVar15 == 0)) {
      FUN_100192a0(*(undefined4 **)(param_1 + 0x2aa31c),pbVar4);
    }
    iVar15 = __stricmp((char *)in_EAX,"FILTER");
    if ((iVar15 != 0) && (iVar15 = __stricmp((char *)in_EAX,"FILTER-NAME"), iVar15 != 0)) {
      return;
    }
    FUN_100192a0(*(undefined4 **)(param_1 + 0x2aa320),pbVar4);
    return;
  }
  if (param_2 == 0x2b636667) {
    FUN_1001c270(*(int *)(param_1 + 0x4030),"",(char *)in_EAX);
    pbVar19 = &DAT_10039247;
    iVar15 = 0x20;
    pbVar4 = param_1 + 0x4000;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"LOBBY_IDENT");
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    iVar15 = 0x3c;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"PINGTIME");
    iVar15 = FUN_10002e80(pbVar4,iVar15);
    iVar16 = 0x1e;
    *(int *)(param_1 + 0x2aa518) = iVar15;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"PINGWAIT");
    iVar15 = FUN_10002e80(pbVar4,iVar16);
    iVar16 = 0;
    *(int *)(param_1 + 0x2aa51c) = iVar15;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"TIMEMAXM");
    iVar15 = FUN_10002e80(pbVar4,iVar16);
    iVar16 = 0;
    *(int *)(param_1 + 0x2aa520) = iVar15 * 60000;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"TIMEIDLE");
    iVar15 = FUN_10002e80(pbVar4,iVar16);
    iVar16 = 0x9c4;
    *(int *)(param_1 + 0x2aa524) = iVar15 * 60000;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"TIMEPOPL");
    iVar15 = FUN_10002e80(pbVar4,iVar16);
    iVar16 = 0;
    *(int *)(param_1 + 0x2aa528) = iVar15;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"FORCE_LOCAL");
    iVar15 = FUN_10002e80(pbVar4,iVar16);
    pbVar19 = &DAT_1003a7cc;
    iVar16 = 0x10;
    pbVar4 = param_1 + 0x2aa530;
    *(int *)(param_1 + 0x2aa52c) = iVar15;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"MESG_ECHO");
    FUN_100030f0(pbVar3,pbVar4,iVar16,pbVar19);
    pbVar19 = &DAT_10039247;
    iVar15 = 0x80;
    pbVar4 = param_1 + 0x2aa658;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"CHEAT_PAT");
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar19 = &DAT_10039247;
    iVar15 = 0x84;
    pbVar4 = param_1 + 0x2aa6d8;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"CHEAT_HIT");
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar19 = &DAT_10039247;
    iVar15 = 0x100;
    pbVar4 = param_1 + 0x2aa75c;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"GFIDS");
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar19 = &DAT_10039247;
    iVar15 = 0x10;
    pbVar4 = param_1 + 0x2aa540;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"MESG_ECHO");
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    iVar15 = 0x20;
    pbVar4 = param_1 + 0x2aac08;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"SECRET");
    iVar15 = FUN_10003280((char *)pbVar3,(int)pbVar4,iVar15);
    param_1[0x2aac28] = 0 < iVar15;
    if (0 < iVar15) {
      FUN_10005420();
    }
    pbVar19 = &DAT_10039247;
    iVar15 = 0x400;
    pbVar4 = local_c00;
    pbVar3 = FUN_10002000(in_EAX,(byte *)"CUSTCMDS");
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    param_1[0x3800] = 0;
    param_1[0x3801] = 0;
    param_1[0x3802] = 0;
    param_1[0x3803] = 0;
    if (local_c00[0] != 0) {
      iVar15 = 0;
      FUN_10002f60(local_c00,local_e04,0x40,&DAT_10039247,0,0x3a);
      if (local_e04[0] != 0) {
        pbVar4 = param_1 + 0x3804;
        do {
          FUN_10002f60(local_e04,local_d84,0x40,&DAT_10039247,0,0x2c);
          uVar20 = _atol((char *)local_d84);
          *(uint *)(pbVar4 + -4) = uVar20 ^ 0x20202020;
          FUN_10002f60(local_e04,local_d84,0x40,&DAT_10039247,1,0x2c);
          lVar6 = _atol((char *)local_d84);
          iVar15 = iVar15 + 1;
          *(long *)pbVar4 = lVar6;
          pbVar4 = pbVar4 + 8;
          FUN_10002f60(local_c00,local_e04,0x40,&DAT_10039247,iVar15,0x3a);
        } while (local_e04[0] != 0);
      }
      pbVar4 = param_1 + iVar15 * 8 + 0x3800;
      pbVar4[0] = 0;
      pbVar4[1] = 0;
      pbVar4[2] = 0;
      pbVar4[3] = 0;
    }
    FUN_10010420(*(int *)(param_1 + 0x4020),param_1);
    _printf("slave has received new config values\n");
    return;
  }
  if (param_2 == 0x2b726f6d) {
    iVar15 = 0;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"IDENT");
    iVar15 = FUN_10002e80(pbVar4,iVar15);
    piVar7 = (int *)FUN_1001a190(*(int *)(param_1 + 0x40d4),iVar15);
    pbVar4 = FUN_10002000(in_EAX,&DAT_10039b60);
    if (pbVar4 == (byte *)0x0) {
      if (piVar7 == (int *)0x0) {
        return;
      }
      FUN_1001a0d0(*(int *)(param_1 + 0x40d8),*piVar7);
      FUN_1001a0d0(*(int *)(param_1 + 0x40d4),*piVar7);
      FUN_100188e0(*(void **)(param_1 + 0x40d0),(int *)*(void **)(param_1 + 0x40d0),
                   (byte *)(piVar7 + 2));
      FUN_10019f20((void *)piVar7[0x3d]);
      FUN_10019f20((void *)piVar7[0x3e]);
      _free(piVar7);
      return;
    }
    if (piVar7 == (int *)0x0) {
      piVar7 = (int *)_malloc(0x1ac);
      piVar10 = piVar7;
      for (iVar16 = 0x6b; iVar16 != 0; iVar16 = iVar16 + -1) {
        *piVar10 = 0;
        piVar10 = piVar10 + 1;
      }
      puVar5 = FUN_10019e90(10,100);
      piVar7[0x3d] = (int)puVar5;
      puVar5 = FUN_10019e90(10,100);
      pbVar19 = (byte *)0x0;
      iVar16 = 0x24;
      piVar7[0x3e] = (int)puVar5;
      *piVar7 = iVar15;
      pbVar4 = (byte *)(piVar7 + 2);
      pbVar3 = FUN_10002000(in_EAX,&DAT_10039b60);
      FUN_100030f0(pbVar3,pbVar4,iVar16,pbVar19);
      FUN_10018820(this,*(int **)(param_1 + 0x40d0),(byte *)(piVar7 + 2),(int)piVar7);
      FUN_10019f50(*(int **)(param_1 + 0x40d4),*piVar7,piVar7);
      FUN_10019f50(*(int **)(param_1 + 0x40d8),*piVar7,piVar7);
    }
    else {
      FUN_1001a010(*(int *)(param_1 + 0x40d4),*piVar7);
    }
    uVar20 = 0;
    pbVar4 = FUN_10002000(in_EAX,&DAT_10039d3c);
    uVar20 = FUN_10002f10(pbVar4,uVar20);
    pbVar19 = (byte *)0x0;
    iVar15 = 0x10;
    pbVar4 = (byte *)(piVar7 + 0xb);
    piVar7[0x3c] = uVar20;
    pbVar3 = FUN_10002000(in_EAX,&DAT_1003a75c);
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar19 = (byte *)0x0;
    iVar15 = 0x84;
    pbVar4 = (byte *)(piVar7 + 0x18);
    pbVar3 = FUN_10002000(in_EAX,&DAT_1003a1b0);
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar19 = (byte *)0x0;
    iVar15 = 0x10;
    pbVar4 = (byte *)(piVar7 + 0xf);
    pbVar3 = FUN_10002000(in_EAX,&DAT_1003a754);
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar19 = (byte *)0x0;
    iVar15 = 0x14;
    pbVar4 = (byte *)(piVar7 + 0x13);
    pbVar3 = FUN_10002000(in_EAX,&DAT_1003a74c);
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    pbVar19 = &DAT_10039247;
    iVar15 = 0x80;
    pbVar4 = (byte *)(piVar7 + 0x3f);
    pbVar3 = FUN_10002000(in_EAX,&DAT_1003a744);
    FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
    uVar20 = piVar7[1];
    pbVar4 = FUN_10002000(in_EAX,(byte *)"FLAGS");
    uVar20 = FUN_10002ed0((char *)pbVar4,uVar20);
    iVar15 = piVar7[0x39];
    piVar7[1] = uVar20;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"LIMIT");
    iVar15 = FUN_10002e80(pbVar4,iVar15);
    pbVar4 = &DAT_1003a738;
    piVar7[0x39] = iVar15;
    iVar15 = 0x2c;
    puVar8 = (uint *)(piVar7 + 0x60);
    pbVar3 = &DAT_1003a730;
  }
  else {
    if (param_2 != 0x2b757374) {
      if (param_2 == 0x2b757372) {
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,(byte *)"IDENT");
        iVar15 = FUN_10002e80(pbVar4,iVar15);
        piVar7 = (int *)FUN_1001a190(*(int *)(param_1 + 0x40e4),iVar15);
        pbVar4 = FUN_10002000(in_EAX,&DAT_10039b60);
        if (pbVar4 != (byte *)0x0) {
          iVar16 = 0;
          pbVar4 = FUN_10002000(in_EAX,&DAT_10039d1c);
          uVar20 = FUN_10002e80(pbVar4,iVar16);
          uVar20 = FUN_100106d0(*(uint **)(param_1 + 0x4020),uVar20);
          if (uVar20 == 0) {
            pbVar4 = FUN_10002000(in_EAX,&DAT_10039d1c);
            if (pbVar4 != (byte *)0x0) {
              uVar12 = 0;
              pbVar4 = FUN_10002000(in_EAX,&DAT_10039d3c);
              uVar12 = FUN_10002f10(pbVar4,uVar12);
              if (uVar12 != 0) {
                FUN_10018470(*(SOCKET **)(param_1 + 0x4024),0x5445524d,iVar15,"",(char *)0xffffffff)
                ;
                *(int *)(param_1 + 0x2aa568) = *(int *)(param_1 + 0x2aa568) + 1;
                return;
              }
            }
          }
          else {
            *(int *)(uVar20 + 0xad4) = iVar15;
            if (*(int *)(uVar20 + 0xab4) == 0) {
              *(undefined4 *)(uVar20 + 0xab4) = *(undefined4 *)(param_1 + 0x4038);
            }
          }
          if (piVar7 == (int *)0x0) {
            piVar7 = (int *)_malloc(0x524);
            pbVar4 = (byte *)0x0;
            piVar10 = piVar7;
            for (iVar16 = 0x149; iVar16 != 0; iVar16 = iVar16 + -1) {
              *piVar10 = 0;
              piVar10 = piVar10 + 1;
            }
            iVar16 = 0x14;
            *piVar7 = iVar15;
            pbVar3 = (byte *)(piVar7 + 3);
            pbVar19 = FUN_10002000(in_EAX,&DAT_10039b60);
            FUN_100030f0(pbVar19,pbVar3,iVar16,pbVar4);
            pbVar19 = (byte *)0x0;
            iVar16 = 0x10;
            pbVar4 = (byte *)(piVar7 + 8);
            pbVar3 = FUN_10002000(in_EAX,&DAT_10039b70);
            FUN_100030f0(pbVar3,pbVar4,iVar16,pbVar19);
            FUN_10018820(*(void **)(param_1 + 0x40dc),(int *)*(void **)(param_1 + 0x40dc),
                         (byte *)(piVar7 + 3),(int)piVar7);
            FUN_10018820(this_00,*(int **)(param_1 + 0x40e0),(byte *)(piVar7 + 8),(int)piVar7);
            FUN_10019f50(*(int **)(param_1 + 0x40e4),iVar15,piVar7);
          }
          else {
            FUN_1001a010(*(int *)(param_1 + 0x40e4),*piVar7);
          }
          iVar15 = piVar7[0xc];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a71c);
          iVar16 = FUN_10002e80(pbVar4,iVar15);
          iVar15 = piVar7[0xc];
          if (iVar16 == iVar15) {
            if ((iVar15 != 0) &&
               (iVar15 = FUN_1001a190(*(int *)(param_1 + 0x40d4),iVar15), iVar15 != 0)) {
              FUN_1001a010(*(int *)(iVar15 + 0xf4),*piVar7);
            }
          }
          else {
            if ((iVar15 != 0) &&
               (piVar10 = (int *)FUN_1001a190(*(int *)(param_1 + 0x40d4),iVar15),
               piVar10 != (int *)0x0)) {
              FUN_1001a0d0(piVar10[0x3d],*piVar7);
              iVar15 = FUN_1001a1d0(piVar10[0x3d]);
              piVar10[0x3a] = iVar15;
              FUN_1001a010(*(int *)(param_1 + 0x40d8),*piVar10);
            }
            if ((iVar16 != 0) &&
               (piVar10 = (int *)FUN_1001a190(*(int *)(param_1 + 0x40d4),iVar16),
               piVar10 != (int *)0x0)) {
              FUN_10019f50((int *)piVar10[0x3d],*piVar7,piVar7);
              iVar15 = FUN_1001a1d0(piVar10[0x3d]);
              piVar10[0x3a] = iVar15;
              FUN_1001a010(*(int *)(param_1 + 0x40d8),*piVar10);
            }
            piVar7[0xc] = iVar16;
          }
          iVar15 = piVar7[0xd];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a714);
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          pbVar19 = &DAT_10039247;
          iVar16 = 0x104;
          pbVar4 = (byte *)(piVar7 + 0x34);
          piVar7[0xd] = iVar15;
          pbVar3 = FUN_10002000(in_EAX,&DAT_1003a70c);
          FUN_100030f0(pbVar3,pbVar4,iVar16,pbVar19);
          pbVar19 = &DAT_10039247;
          iVar15 = 0x204;
          pbVar4 = (byte *)(piVar7 + 0x75);
          pbVar3 = FUN_10002000(in_EAX,&DAT_1003a708);
          FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
          pbVar19 = &DAT_10039247;
          iVar15 = 0x10;
          pbVar4 = (byte *)(piVar7 + 8);
          pbVar3 = FUN_10002000(in_EAX,&DAT_10039b70);
          FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
          iVar15 = piVar7[0xfe];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a704);
          iVar16 = FUN_10002e80(pbVar4,iVar15);
          iVar15 = piVar7[0x113];
          piVar7[0xfe] = iVar16;
          pbVar4 = FUN_10002000(in_EAX,(byte *)"LEVEL");
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          piVar7[0x113] = iVar15;
          iVar15 = piVar7[0x114];
          pbVar4 = FUN_10002000(in_EAX,(byte *)"MEDALS");
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          uVar12 = piVar7[0x101];
          piVar7[0x114] = iVar15;
          pbVar4 = FUN_10002000(in_EAX,&DAT_10039d3c);
          uVar11 = FUN_10002f10(pbVar4,uVar12);
          uVar12 = piVar7[0x102];
          piVar7[0x101] = uVar11;
          pbVar4 = FUN_10002000(in_EAX,(byte *)"LADDR");
          uVar12 = FUN_10002f10(pbVar4,uVar12);
          piVar7[0x102] = uVar12;
          uVar12 = piVar7[0x103];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a854);
          uVar12 = FUN_10002f10(pbVar4,uVar12);
          iVar15 = piVar7[0x104];
          piVar7[0x103] = uVar12;
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a6e4);
          iVar16 = FUN_10002e80(pbVar4,iVar15);
          iVar15 = piVar7[0xfd];
          piVar7[0x104] = iVar16;
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a6dc);
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          piVar7[0xfd] = iVar15;
          iVar15 = piVar7[0xff];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a6d4);
          iVar16 = FUN_10002e80(pbVar4,iVar15);
          iVar15 = piVar7[0x100];
          piVar7[0xff] = iVar16;
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a6cc);
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          uVar12 = piVar7[2];
          piVar7[0x100] = iVar15;
          uVar11 = uVar12;
          pbVar4 = FUN_10002000(in_EAX,(byte *)"FLAGS");
          uVar11 = FUN_10002ed0((char *)pbVar4,uVar11);
          piVar7[2] = uVar11;
          if ((uVar20 != 0) && (((uVar11 ^ uVar12) & 0x2000000) != 0)) {
            FUN_10010c30(uVar20,(byte)(uVar11 >> 0x19) & 1);
          }
          iVar15 = piVar7[1];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a6c4);
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          pbVar19 = &DAT_10039247;
          iVar16 = 0x20;
          pbVar4 = (byte *)(piVar7 + 0x107);
          piVar7[1] = iVar15;
          pbVar3 = FUN_10002000(in_EAX,&DAT_1003a6c0);
          FUN_100030f0(pbVar3,pbVar4,iVar16,pbVar19);
          pbVar19 = &DAT_10039247;
          iVar15 = 0x1c;
          pbVar4 = (byte *)(piVar7 + 0xf6);
          pbVar3 = FUN_10002000(in_EAX,(byte *)"MADDR");
          FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
          iVar15 = piVar7[0x10f];
          pbVar4 = FUN_10002000(in_EAX,(byte *)"GFIDS");
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          pbVar3 = &DAT_1003a738;
          iVar16 = 0x2c;
          puVar8 = (uint *)(piVar7 + 0x129);
          piVar7[0x10f] = iVar15;
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a730);
          FUN_10003360(pbVar4,puVar8,iVar16,pbVar3);
          uVar20 = piVar7[0x112];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a6b8);
          uVar20 = FUN_10002ed0((char *)pbVar4,uVar20);
          iVar15 = piVar7[0x110];
          piVar7[0x112] = uVar20;
          pbVar4 = FUN_10002000(in_EAX,(byte *)"HWFLAG");
          iVar16 = FUN_10002e80(pbVar4,iVar15);
          iVar15 = piVar7[0x111];
          piVar7[0x110] = iVar16;
          pbVar4 = FUN_10002000(in_EAX,(byte *)"HWMASK");
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          pbVar19 = &DAT_10039247;
          piVar7[0x111] = iVar15;
          iVar15 = 4;
          pbVar4 = (byte *)(piVar7 + 0x147);
          pbVar3 = FUN_10002000(in_EAX,&DAT_10039e4c);
          FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
          pbVar19 = &DAT_10039247;
          iVar15 = 4;
          pbVar4 = (byte *)(piVar7 + 0x146);
          pbVar3 = FUN_10002000(in_EAX,&DAT_10039e34);
          FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
          iVar15 = 0;
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a6a4);
          iVar15 = FUN_10002e80(pbVar4,iVar15);
          piVar7[0x148] = iVar15;
          puVar8 = (uint *)(piVar7 + 0x115);
          local_e14 = *puVar8;
          local_e10 = piVar7[0x116];
          pbVar3 = &DAT_1003a738;
          iVar15 = 0x10;
          local_e0c = piVar7[0x117];
          local_e08 = piVar7[0x118];
          pbVar4 = FUN_10002000(in_EAX,&DAT_1003a69c);
          FUN_10003360(pbVar4,puVar8,iVar15,pbVar3);
          FUN_1001d320(*(int *)(param_1 + 0x40f8),(int)&local_e14,piVar7);
          return;
        }
        if (piVar7 == (int *)0x0) {
          return;
        }
        if ((piVar7[0xc] != 0) &&
           (piVar10 = (int *)FUN_1001a190(*(int *)(param_1 + 0x40d4),piVar7[0xc]),
           piVar10 != (int *)0x0)) {
          FUN_1001a0d0(piVar10[0x3d],*piVar7);
          iVar15 = FUN_1001a1d0(piVar10[0x3d]);
          piVar10[0x3a] = iVar15;
          FUN_1001a010(*(int *)(param_1 + 0x40d8),*piVar10);
        }
        FUN_1001d550(*(int *)(param_1 + 0x40f8),*(int **)(param_1 + 0x40f4),piVar7);
        FUN_1001a0d0(*(int *)(param_1 + 0x40e4),*piVar7);
        FUN_100188e0(*(void **)(param_1 + 0x40e0),(int *)*(void **)(param_1 + 0x40e0),
                     (byte *)(piVar7 + 8));
        FUN_100188e0(this_01,*(int **)(param_1 + 0x40dc),(byte *)(piVar7 + 3));
        _free(piVar7);
        return;
      }
      if (param_2 == 0x2b67616d) {
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,(byte *)"IDENT");
        iVar15 = FUN_10002e80(pbVar4,iVar15);
        puVar8 = (uint *)FUN_1001a190(*(int *)(param_1 + 0x40ec),iVar15);
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a714);
        if (pbVar4 == (byte *)0x0) {
          if (puVar8 == (uint *)0x0) {
            return;
          }
          if ((puVar8[0x23] != 0) &&
             (iVar15 = FUN_1001a190(*(int *)(param_1 + 0x40d4),puVar8[0x23]), iVar15 != 0)) {
            FUN_1001a0d0(*(int *)(iVar15 + 0xf8),*puVar8);
          }
          FUN_1001a0d0(*(int *)(param_1 + 0x40ec),*puVar8);
          FUN_100188e0(*(void **)(param_1 + 0x40e8),(int *)*(void **)(param_1 + 0x40e8),
                       (byte *)(puVar8 + 0xc));
          FUN_10019be0(*(int **)(param_1 + 0x40f0),(int)puVar8,'\0');
          FUN_1001dce0(*(int *)(param_1 + 0x40f0),(int)puVar8);
          return;
        }
        if (puVar8 == (uint *)0x0) {
          puVar8 = (uint *)FUN_1001dcc0(*(undefined4 *)(param_1 + 0x40f0));
          puVar9 = puVar8;
          for (iVar15 = 0x13e; iVar15 != 0; iVar15 = iVar15 + -1) {
            *puVar9 = 0;
            puVar9 = puVar9 + 1;
          }
          FUN_1001db40(in_EAX,puVar8);
          FUN_10018820(this_02,*(int **)(param_1 + 0x40e8),(byte *)(puVar8 + 0xc),(int)puVar8);
          FUN_10019f50(*(int **)(param_1 + 0x40ec),*puVar8,puVar8);
          FUN_10019b30(*(int **)(param_1 + 0x40f0),(int)puVar8);
          uVar20 = 0;
        }
        else {
          FUN_1001a010(*(int *)(param_1 + 0x40ec),*puVar8);
          uVar20 = puVar8[0x23];
          FUN_1001db40(in_EAX,puVar8);
        }
        uVar12 = puVar8[0x23];
        if (uVar20 != uVar12) {
          if ((uVar20 != 0) &&
             (iVar15 = FUN_1001a190(*(int *)(param_1 + 0x40d4),uVar20), iVar15 != 0)) {
            FUN_1001a0d0(*(int *)(iVar15 + 0xf8),*puVar8);
          }
          if (puVar8[0x23] == 0) {
            return;
          }
          iVar15 = FUN_1001a190(*(int *)(param_1 + 0x40d4),puVar8[0x23]);
          if (iVar15 == 0) {
            return;
          }
          FUN_10019f50(*(int **)(iVar15 + 0xf8),*puVar8,puVar8);
          return;
        }
        if (uVar12 == 0) {
          return;
        }
        iVar15 = FUN_1001a190(*(int *)(param_1 + 0x40d4),uVar12);
        if (iVar15 == 0) {
          return;
        }
        FUN_1001a010(*(int *)(iVar15 + 0xf8),*puVar8);
        return;
      }
      if (param_2 == 0x2b766172) {
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a614);
        iVar15 = FUN_10002e80(pbVar4,iVar15);
        if (0x7f < iVar15) {
          return;
        }
        FUN_10007d00((int)param_1,in_EAX,(short)iVar15);
        return;
      }
      if (param_2 == 0x2b726b61) {
        FUN_10008100((int)param_1);
        return;
      }
      if (param_2 == 0x2b726e6b) {
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a614);
        iVar15 = FUN_10002e80(pbVar4,iVar15);
        iVar16 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a698);
        iVar16 = FUN_10002e80(pbVar4,iVar16);
        iVar21 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a694);
        iVar21 = FUN_10002e80(pbVar4,iVar21);
        pbVar19 = &DAT_10039247;
        iVar17 = 0x800;
        pbVar4 = local_800;
        pbVar3 = FUN_10002000(in_EAX,&DAT_10039b60);
        FUN_100030f0(pbVar3,pbVar4,iVar17,pbVar19);
        pbVar19 = &DAT_10039247;
        iVar17 = 0x7e0;
        pbVar4 = local_7e0;
        pbVar3 = FUN_10002000(in_EAX,&DAT_1003a70c);
        FUN_100030f0(pbVar3,pbVar4,iVar17,pbVar19);
        FUN_1001c690(*(int **)(param_1 + iVar15 * 4 + 0x4100),iVar21,iVar16,(int *)local_800);
        return;
      }
      if (param_2 == 0x2b6d7367) {
        uVar20 = 0;
        puVar9 = (uint *)(param_1 +
                         (*(uint *)(param_1 + 0x4308) % *(uint *)(param_1 + 0x430c)) * 0x434 +
                         0x4310);
        *puVar9 = *(uint *)(param_1 + 0x4308);
        puVar9[0x10b] = 1;
        pbVar4 = FUN_10002000(in_EAX,(byte *)"FLAGS");
        uVar20 = FUN_10002ed0((char *)pbVar4,uVar20);
        iVar15 = 0;
        puVar9[0x106] = uVar20;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a68c);
        uVar20 = FUN_10002e80(pbVar4,iVar15);
        iVar15 = 0;
        puVar9[0x107] = uVar20;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a72c);
        uVar20 = FUN_10002e80(pbVar4,iVar15);
        iVar15 = 0;
        puVar9[0x109] = uVar20;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a714);
        uVar20 = FUN_10002e80(pbVar4,iVar15);
        iVar15 = 0;
        puVar9[0x10a] = uVar20;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a71c);
        uVar20 = FUN_10002e80(pbVar4,iVar15);
        pbVar3 = &DAT_10039247;
        puVar9[0x108] = uVar20;
        iVar15 = 0x10;
        puVar8 = puVar9 + 1;
        pbVar4 = FUN_10002000(in_EAX,&DAT_10039b60);
        FUN_100030f0(pbVar4,(byte *)puVar8,iVar15,pbVar3);
        pbVar3 = &DAT_10039247;
        iVar15 = 0x404;
        puVar9 = puVar9 + 5;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a684);
        FUN_100030f0(pbVar4,(byte *)puVar9,iVar15,pbVar3);
        *(int *)(param_1 + 0x4308) = *(int *)(param_1 + 0x4308) + 1;
        return;
      }
      if (param_2 == 0x2b617379) {
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a67c);
        uVar20 = FUN_10002e80(pbVar4,iVar15);
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a674);
        uVar12 = FUN_10002e80(pbVar4,iVar15);
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a66c);
        uVar11 = FUN_10002e80(pbVar4,iVar15);
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,&DAT_1003a664);
        uVar13 = FUN_10002e80(pbVar4,iVar15);
        pbVar4 = &DAT_10039247;
        iVar15 = 0x104;
        if (uVar20 != 2) {
          uVar2 = *(uint *)(param_1 + 0x21e310);
          puVar8 = (uint *)(param_1 + (uVar2 % *(uint *)(param_1 + 0x21e314)) * 0x118 + 0x21e318);
          puVar8[0x44] = uVar20;
          *puVar8 = uVar2;
          puVar8[0x45] = -(uint)(uVar20 != 0) & uVar12;
          puVar8[1] = uVar11;
          puVar8[2] = uVar13;
          puVar8 = puVar8 + 3;
          pbVar3 = FUN_10002000(in_EAX,&DAT_1003a65c);
          FUN_100030f0(pbVar3,(byte *)puVar8,iVar15,pbVar4);
          *(int *)(param_1 + 0x21e310) = *(int *)(param_1 + 0x21e310) + 1;
          return;
        }
        pbVar3 = local_d04;
        pbVar19 = FUN_10002000(in_EAX,&DAT_1003a65c);
        FUN_100030f0(pbVar19,pbVar3,iVar15,pbVar4);
        (*(code *)PTR_FUN_100410d4)(*(undefined4 *)(param_1 + 0x2aabe0),uVar11,uVar13,local_d04);
        return;
      }
      if (param_2 == 0x2b657874) {
        FUN_1001f130(*(int **)(param_1 + 0x2aa654),in_EAX,0,*(undefined4 *)(param_1 + 0x4038));
        return;
      }
      if (param_2 == 0x2b73796e) {
        if (0 < *(int *)(param_1 + 0x2aa318)) {
          return;
        }
        pbVar19 = &DAT_10039247;
        iVar15 = 0x80;
        pbVar4 = param_1 + 0x2aaa5c;
        pbVar3 = FUN_10002000(in_EAX,(byte *)"CONTEXT");
        FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar19);
        pbVar4 = param_1 + 0x2aa85c;
        FUN_10002230((char *)pbVar4,0x200,(char *)(param_1 + 0x2aaa5c));
        FUN_10002620(pbVar4,0x200,&DAT_10039e58,param_1 + 0x2aa32c);
        uVar20 = FUN_10017df0(*(int *)(param_1 + 0x4040),0x706f7274);
        uVar12 = FUN_10010520(*(uint **)(param_1 + 0x4020),0x706f7274);
        _sprintf((char *)local_dc4,"slav/%d/%d",uVar12,uVar20);
        FUN_10002620(pbVar4,0x200,&DAT_1003a1b0,local_dc4);
        iVar15 = 0;
        pbVar4 = FUN_10002000(in_EAX,(byte *)"APORT");
        iVar15 = FUN_10002e80(pbVar4,iVar15);
        uVar18 = (u_short)iVar15;
        uVar20 = 0x7f000001;
        pbVar4 = FUN_10002000(in_EAX,(byte *)"AADDR");
        uVar20 = FUN_10002f10(pbVar4,uVar20);
        FUN_10017e90(*(int **)(param_1 + 0x4028),uVar20,uVar18);
        param_1[0x2aa318] = 1;
        param_1[0x2aa319] = 0;
        param_1[0x2aa31a] = 0;
        param_1[0x2aa31b] = 0;
        return;
      }
      if (param_2 == 0x2b736874) {
        FUN_10010510(*(int *)(param_1 + 0x4020));
        return;
      }
      if (param_2 != 0x2b737374) {
        return;
      }
      *(int *)(param_1 + 0x2aac04) = *(int *)(param_1 + 0x2aac04) + 1;
      iVar15 = *(int *)(param_1 + 0x2aabec);
      pbVar4 = FUN_10002000(in_EAX,&DAT_1003a634);
      iVar16 = FUN_10002e80(pbVar4,iVar15);
      iVar15 = *(int *)(param_1 + 0x2aabf0);
      *(int *)(param_1 + 0x2aabec) = iVar16;
      pbVar4 = FUN_10002000(in_EAX,&DAT_1003a630);
      iVar16 = FUN_10002e80(pbVar4,iVar15);
      iVar15 = *(int *)(param_1 + 0x2aabf4);
      *(int *)(param_1 + 0x2aabf0) = iVar16;
      pbVar4 = FUN_10002000(in_EAX,&DAT_1003a62c);
      iVar15 = FUN_10002e80(pbVar4,iVar15);
      *(int *)(param_1 + 0x2aabf4) = iVar15;
      iVar15 = *(int *)(param_1 + 0x2aabf8);
      pbVar4 = FUN_10002000(in_EAX,&DAT_1003a628);
      iVar16 = FUN_10002e80(pbVar4,iVar15);
      iVar15 = *(int *)(param_1 + 0x2aabfc);
      *(int *)(param_1 + 0x2aabf8) = iVar16;
      pbVar4 = FUN_10002000(in_EAX,&DAT_1003a624);
      iVar16 = FUN_10002e80(pbVar4,iVar15);
      iVar15 = *(int *)(param_1 + 0x2aac00);
      *(int *)(param_1 + 0x2aabfc) = iVar16;
      pbVar4 = FUN_10002000(in_EAX,&DAT_1003a620);
      iVar15 = FUN_10002e80(pbVar4,iVar15);
      *(int *)(param_1 + 0x2aac00) = iVar15;
      return;
    }
    iVar15 = 0;
    pbVar4 = FUN_10002000(in_EAX,(byte *)"IDENT");
    iVar15 = FUN_10002e80(pbVar4,iVar15);
    puVar8 = (uint *)FUN_1001a190(*(int *)(param_1 + 0x40f8),iVar15);
    pbVar4 = FUN_10002000(in_EAX,&DAT_1003a72c);
    if (pbVar4 == (byte *)0x0) {
      if (puVar8 == (uint *)0x0) {
        return;
      }
      FUN_1001a0d0(*(int *)(param_1 + 0x40f8),*puVar8);
      FUN_100188e0(puVar8 + 9,*(int **)(param_1 + 0x40f4),(byte *)(puVar8 + 9));
      FUN_1001d220(puVar8);
      return;
    }
    if (puVar8 == (uint *)0x0) {
      iVar15 = 0;
      pbVar4 = FUN_10002000(in_EAX,&DAT_1003a724);
      iVar15 = FUN_10002e80(pbVar4,iVar15);
      puVar9 = FUN_1001d1c0(iVar15);
      pbVar4 = FUN_1001d190();
      iVar15 = 0xdc;
      puVar8 = puVar9;
      pbVar3 = FUN_10002000(in_EAX,&DAT_1003a72c);
      FUN_10003360(pbVar3,puVar8,iVar15,pbVar4);
      FUN_10018820(puVar9 + 9,*(int **)(param_1 + 0x40f4),(byte *)(puVar9 + 9),(int)puVar9);
      FUN_10019f50(*(int **)(param_1 + 0x40f8),*puVar9,puVar9);
      return;
    }
    FUN_1001a010(*(int *)(param_1 + 0x40f8),*puVar8);
    pbVar4 = FUN_1001d190();
    iVar15 = 0xdc;
    pbVar3 = &DAT_1003a72c;
  }
  pbVar3 = FUN_10002000(in_EAX,pbVar3);
  FUN_10003360(pbVar3,puVar8,iVar15,pbVar4);
  return;
}



void __cdecl FUN_10009ad0(int param_1,int param_2,char *param_3,int param_4)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  char *pcVar4;
  int unaff_EDI;
  
  if (param_2 != -1) {
    if ((((param_1 < 0) &&
         (uVar2 = FUN_100106a0(*(uint **)(unaff_EDI + 0x4020),-param_1), uVar2 != 0)) &&
        (*(int *)(uVar2 + 0x20) != 0)) && (uVar2 != 0xffffff74)) {
      puVar3 = FUN_100199e0(*(int **)(unaff_EDI + 0x2aa650),param_4 + 1);
      *(undefined4 **)(uVar2 + 0xb50) = puVar3;
      pcVar4 = (char *)puVar3[3];
      do {
        cVar1 = *param_3;
        param_3 = param_3 + 1;
        *pcVar4 = cVar1;
        pcVar4 = pcVar4 + 1;
      } while (cVar1 != '\0');
      **(int **)(uVar2 + 0xb50) = param_1;
      *(int *)(*(int *)(uVar2 + 0xb50) + 4) = param_2;
      *(undefined4 *)(uVar2 + 0x28) = 0;
    }
    return;
  }
  FUN_10018470(*(SOCKET **)(unaff_EDI + 0x4028),0x2a636f6e,0,(char *)(unaff_EDI + 0x2aa85c),
               (char *)0xffffffff);
  return;
}



void __cdecl FUN_10009fd0(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  
  if (*(int *)(param_2 + 0x7c) == 0) {
    iVar1 = FUN_10002c50(*(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),
                         (byte *)
                         "I=%d N=%s M=%s F=%f A=%a P=%d S=%s X=%s G=%d AT=%f CL=%d LV=%d MD=%d LA=%a HW=%d RP=%d MA=%s"
                        );
    if (param_4 != 0) {
      FUN_10002c50((byte *)(*(int *)(param_2 + 0x58) + iVar1),
                   (byte *)(*(int *)(param_2 + 0x54) - iVar1),(byte *)" RM=%s RI=%d RF=%f RT=%d");
    }
    FUN_1001d4d0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),param_3);
    iVar1 = FUN_1001d140(*(int *)(param_1 + 0x4100),(char *)(param_3 + 0x20));
    if (-1 < iVar1) {
      FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a878,iVar1 + 1);
    }
  }
  return;
}



void __cdecl FUN_1000a130(int param_1,int param_2)

{
  uint uVar1;
  bool bVar2;
  uint *puVar3;
  
  uVar1 = *(uint *)(param_1 + 0x4050);
  puVar3 = (uint *)(param_1 + 0x4050);
  bVar2 = false;
  while ((uVar1 != 0 && (!bVar2))) {
    if ((*(uint *)(param_2 + 0xc) == *puVar3) ||
       ((*(uint *)(param_1 + 0x404c) & *(uint *)(param_2 + 0xc)) == *puVar3)) {
      bVar2 = true;
    }
    uVar1 = puVar3[1];
    puVar3 = puVar3 + 1;
  }
  return;
}



void __cdecl FUN_1000a180(byte *param_1,int param_2,undefined4 *param_3)

{
  byte bVar1;
  code *pcVar2;
  int iVar3;
  char cVar4;
  byte *pbVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  char *pcVar9;
  byte *pbVar10;
  char *pcVar11;
  bool bVar12;
  int iVar13;
  byte *pbVar14;
  byte local_40 [32];
  byte local_20 [32];
  
  iVar3 = param_2;
  pcVar11 = *(char **)(param_2 + 0x58);
  pbVar14 = &DAT_10039247;
  iVar13 = 0x20;
  pbVar10 = local_40;
  pbVar5 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a96c);
  FUN_100030f0(pbVar5,pbVar10,iVar13,pbVar14);
  pbVar14 = &DAT_10039247;
  iVar13 = 0x20;
  pbVar10 = local_20;
  pbVar5 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a74c);
  FUN_100030f0(pbVar5,pbVar10,iVar13,pbVar14);
  cVar4 = FUN_1000a130((int)param_1,param_2);
  if (cVar4 != '\0') {
    iVar13 = *(int *)(param_1 + 0x34);
    param_2 = 0;
    pbVar10 = param_1;
    while (iVar13 != 0) {
      pbVar5 = local_40;
      pbVar14 = pbVar10;
      do {
        bVar1 = *pbVar5;
        bVar12 = bVar1 < *pbVar14;
        if (bVar1 != *pbVar14) {
LAB_1000a234:
          iVar13 = (1 - (uint)bVar12) - (uint)(bVar12 != 0);
          goto LAB_1000a239;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar5[1];
        bVar12 = bVar1 < pbVar14[1];
        if (bVar1 != pbVar14[1]) goto LAB_1000a234;
        pbVar5 = pbVar5 + 2;
        pbVar14 = pbVar14 + 2;
      } while (bVar1 != 0);
      iVar13 = 0;
LAB_1000a239:
      if (iVar13 == 0) {
        if ((param_3 == (undefined4 *)0x0) &&
           (param_3 = FUN_100105b0(*(int *)(param_1 + 0x4020),iVar3,(int)param_1),
           param_3 == (undefined4 *)0x0)) {
          return;
        }
        pbVar10 = param_1 + param_2 * 0x38;
        *(undefined4 *)(iVar3 + 100) = *(undefined4 *)(param_1 + param_2 * 0x38 + 0x20);
        *(byte **)(iVar3 + 0x80) = pbVar10;
        pcVar2 = *(code **)(pbVar10 + 0x34);
        *(code **)(iVar3 + 0x20) = pcVar2;
        *(undefined4 *)(iVar3 + 0x2c) = *(undefined4 *)(pbVar10 + 0x24);
        *(byte **)(iVar3 + 0x24) = param_1;
        (*pcVar2)(param_1,iVar3,param_3);
        return;
      }
      pbVar5 = pbVar10 + 0x6c;
      pbVar10 = pbVar10 + 0x38;
      param_2 = param_2 + 1;
      iVar13 = *(int *)pbVar5;
    }
  }
  iVar13 = __stricmp((char *)local_40,"ONLINE");
  if (((iVar13 == 0) && (param_1[0x2aa4ac] != 0)) &&
     (iVar13 = __stricmp((char *)local_20,(char *)(param_1 + 0x2aa4ac)), iVar13 == 0)) {
    param_1[0x2aa4cc] = 0;
    param_1[0x2aa4cd] = 0;
    param_1[0x2aa4ce] = 0;
    param_1[0x2aa4cf] = 0;
  }
  iVar13 = __stricmp((char *)local_40,"OFFLINE");
  if (((iVar13 == 0) && (param_1[0x2aa4ac] != 0)) &&
     (iVar13 = __stricmp((char *)local_20,(char *)(param_1 + 0x2aa4ac)), iVar13 == 0)) {
    param_1[0x2aa4cc] = 1;
    param_1[0x2aa4cd] = 0;
    param_1[0x2aa4ce] = 0;
    param_1[0x2aa4cf] = 0;
  }
  iVar13 = _sprintf(pcVar11,"Slave information:\r\n");
  pcVar11 = pcVar11 + iVar13;
  uVar6 = FUN_10017df0(*(int *)(param_1 + 0x4024),0x6f627566);
  uVar7 = FUN_10017df0(*(int *)(param_1 + 0x4024),0x69627566);
  uVar8 = FUN_10017df0(*(int *)(param_1 + 0x4024),0x73746174);
  iVar13 = _sprintf(pcVar11,"Master connection: state=%d, inpbuf=%d, outbuf=%d\r\n",uVar8,uVar7,
                    uVar6);
  pcVar9 = "offline";
  if (*(int *)(param_1 + 0x2aa4cc) == 0) {
    pcVar9 = "online";
  }
  _sprintf(pcVar11 + iVar13,"Slave is %s\r\n",pcVar9);
  *(undefined4 *)(iVar3 + 0x50) = 0xffffffff;
  *(undefined4 *)(iVar3 + 0x48) = 0x48545450;
  *(undefined4 *)(iVar3 + 0x4c) = 0x48545450;
  return;
}



void __cdecl FUN_1000b920(int param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  int local_20;
  int local_1c;
  int local_18;
  int local_10;
  int local_c;
  int local_8;
  
  FUN_10018a80(*(int *)(param_1 + 0x1934));
  iVar1 = FUN_10018a90(*(int *)(param_1 + 0x1934),(undefined4 *)0x0);
  while (iVar1 != 0) {
    _printf("View %s\n",iVar1);
    local_8 = 0;
    if (*(int *)(iVar1 + 0x10) != 0) {
      local_18 = 0;
      do {
        iVar5 = *(int *)(iVar1 + 0xc) + local_18;
        _printf("  Category %d %s\n",*(undefined4 *)(*(int *)(iVar1 + 0xc) + 0x20 + local_18),iVar5)
        ;
        local_c = 0;
        if (*(int *)(iVar5 + 0x28) != 0) {
          local_1c = 0;
          do {
            iVar3 = *(int *)(iVar5 + 0x24) + local_1c;
            _printf("    Index %d %s\n",*(undefined4 *)(iVar3 + 0x20),iVar3);
            local_10 = 0;
            if (*(int *)(iVar3 + 0x28) != 0) {
              local_20 = 0;
              do {
                uVar2 = 0;
                iVar4 = *(int *)(iVar3 + 0x24) + local_20;
                _printf("      Variation %d \'%s\' \'%s\' %d\n",*(undefined4 *)(iVar4 + 0x40),iVar4,
                        iVar4 + 0x20,(uint)*(ushort *)(*(int *)(iVar3 + 0x24) + 0xce8 + local_20));
                if (*(short *)(iVar4 + 0xce4) != 0) {
                  puVar6 = (undefined4 *)(iVar4 + 0xa4);
                  do {
                    _printf("        Column %s \'%s\' %d %s\n",puVar6 + -0x18,puVar6 + -0x10,*puVar6
                            ,puVar6 + -8);
                    uVar2 = uVar2 + 1;
                    puVar6 = puVar6 + 0x19;
                  } while (uVar2 != *(ushort *)(iVar4 + 0xce4));
                }
                local_10 = local_10 + 1;
                local_20 = local_20 + 0xcf0;
              } while (local_10 != *(int *)(iVar3 + 0x28));
            }
            local_c = local_c + 1;
            local_1c = local_1c + 0x30;
          } while (local_c != *(int *)(iVar5 + 0x28));
        }
        local_8 = local_8 + 1;
        local_18 = local_18 + 0x30;
      } while (local_8 != *(int *)(iVar1 + 0x10));
    }
    iVar1 = FUN_10018a90(*(int *)(param_1 + 0x1934),(undefined4 *)0x0);
  }
  return;
}



undefined4 __thiscall FUN_1000bae0(void *this,byte *param_1)

{
  int iVar1;
  void *pvVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  int unaff_EBX;
  int iVar6;
  undefined4 *puVar7;
  byte *pbVar8;
  byte *pbVar9;
  byte *pbVar10;
  
  iVar1 = *(int *)(unaff_EBX + 0x20);
  if ((iVar1 != 1) && (iVar1 != 5)) {
    _printf("%s:%d CATEGORY is not valid in this state %d\n",*(undefined4 *)(unaff_EBX + 4),
            *(undefined4 *)(unaff_EBX + 8),iVar1,this);
    return 0;
  }
  iVar1 = *(int *)(unaff_EBX + 0xc);
  iVar5 = *(int *)(iVar1 + 0x14);
  if (*(int *)(iVar1 + 0x10) == iVar5) {
    iVar6 = 2;
    if (iVar5 != 0) {
      iVar6 = iVar5 * 2;
    }
    pvVar2 = _realloc(*(void **)(iVar1 + 0xc),iVar6 * 0x30);
    if (pvVar2 == (void *)0x0) {
      _printf("%s:%d too many categories, capping at %d\n",*(undefined4 *)(unaff_EBX + 4),
              *(undefined4 *)(unaff_EBX + 8),*(undefined4 *)(iVar1 + 0x10));
      return 0;
    }
    puVar7 = (undefined4 *)(*(int *)(iVar1 + 0x10) * 0x30 + (int)pvVar2);
    for (uVar4 = (uint)((iVar6 - *(int *)(iVar1 + 0x14)) * 0x30) >> 2; uVar4 != 0; uVar4 = uVar4 - 1
        ) {
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    }
    for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
      *(undefined1 *)puVar7 = 0;
      puVar7 = (undefined4 *)((int)puVar7 + 1);
    }
    *(void **)(iVar1 + 0xc) = pvVar2;
    *(int *)(iVar1 + 0x14) = iVar6;
  }
  pbVar10 = &DAT_10039247;
  pbVar8 = (byte *)(*(int *)(iVar1 + 0x10) * 0x30 + *(int *)(iVar1 + 0xc));
  iVar5 = 0x20;
  pbVar9 = pbVar8;
  pbVar3 = FUN_10002000(param_1,(byte *)"CATEGORY");
  FUN_100030f0(pbVar3,pbVar9,iVar5,pbVar10);
  *(undefined4 *)(pbVar8 + 0x20) = *(undefined4 *)(iVar1 + 0x10);
  *(int *)(iVar1 + 0x10) = *(int *)(iVar1 + 0x10) + 1;
  pbVar8[0x28] = 0;
  pbVar8[0x29] = 0;
  pbVar8[0x2a] = 0;
  pbVar8[0x2b] = 0;
  *(byte **)(unaff_EBX + 0x10) = pbVar8;
  *(undefined4 *)(unaff_EBX + 0x20) = 2;
  return 1;
}



undefined4 __cdecl FUN_1000bbf0(int param_1)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *unaff_EBX;
  int iVar5;
  byte *pbVar6;
  
  iVar2 = *(int *)(param_1 + 0x20);
  if ((iVar2 != 5) && (iVar2 != 4)) {
    _printf("%s:%d COLUMN is not valid in this state %d\n",*(undefined4 *)(param_1 + 4),
            *(undefined4 *)(param_1 + 8),iVar2);
    return 0;
  }
  iVar2 = *(int *)(param_1 + 0x18);
  if (*(ushort *)(iVar2 + 0xce4) == 0x20) {
    _printf("%s:%d too many columns, only %d allowed\n",*(undefined4 *)(param_1 + 4),
            *(undefined4 *)(param_1 + 8),0x20);
    return 0;
  }
  pbVar6 = &DAT_10039247;
  iVar5 = 0x20;
  pbVar1 = (byte *)((uint)*(ushort *)(iVar2 + 0xce4) * 100 + 0x44 + iVar2);
  pbVar4 = pbVar1;
  pbVar3 = FUN_10002000(unaff_EBX,(byte *)"COLUMN");
  FUN_100030f0(pbVar3,pbVar4,iVar5,pbVar6);
  pbVar6 = &DAT_10039247;
  iVar5 = 0x20;
  pbVar4 = pbVar1 + 0x20;
  pbVar3 = FUN_10002000(unaff_EBX,&DAT_1003a1b0);
  FUN_100030f0(pbVar3,pbVar4,iVar5,pbVar6);
  pbVar6 = &DAT_10039247;
  iVar5 = 0x20;
  pbVar4 = pbVar1 + 0x40;
  pbVar3 = FUN_10002000(unaff_EBX,(byte *)"PARAM");
  FUN_100030f0(pbVar3,pbVar4,iVar5,pbVar6);
  iVar5 = 0x38;
  pbVar4 = FUN_10002000(unaff_EBX,(byte *)"WIDTH");
  iVar5 = FUN_10002e80(pbVar4,iVar5);
  *(int *)(pbVar1 + 0x60) = iVar5;
  *(short *)(iVar2 + 0xce4) = *(short *)(iVar2 + 0xce4) + 1;
  *(undefined4 *)(param_1 + 0x20) = 5;
  return 1;
}



undefined4 __cdecl FUN_1000bcf0(int param_1,byte *param_2)

{
  int iVar1;
  void *pvVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  undefined4 *puVar7;
  byte *pbVar8;
  byte *pbVar9;
  byte *pbVar10;
  
  iVar1 = *(int *)(param_1 + 0x20);
  if ((iVar1 != 2) && (iVar1 != 5)) {
    _printf("%s:%d INDEX is not valid in this state %d\n",*(undefined4 *)(param_1 + 4),
            *(undefined4 *)(param_1 + 8),iVar1);
    return 0;
  }
  iVar1 = *(int *)(param_1 + 0x10);
  iVar5 = *(int *)(iVar1 + 0x2c);
  if (*(int *)(iVar1 + 0x28) == iVar5) {
    iVar6 = 2;
    if (iVar5 != 0) {
      iVar6 = iVar5 * 2;
    }
    pvVar2 = _realloc(*(void **)(iVar1 + 0x24),iVar6 * 0x30);
    if (pvVar2 == (void *)0x0) {
      _printf("%s:%d too many indices, capping at %d\n",*(undefined4 *)(param_1 + 4),
              *(undefined4 *)(param_1 + 8),*(undefined4 *)(iVar1 + 0x28));
      return 0;
    }
    puVar7 = (undefined4 *)(*(int *)(iVar1 + 0x28) * 0x30 + (int)pvVar2);
    for (uVar4 = (uint)((iVar6 - *(int *)(iVar1 + 0x2c)) * 0x30) >> 2; uVar4 != 0; uVar4 = uVar4 - 1
        ) {
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    }
    for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
      *(undefined1 *)puVar7 = 0;
      puVar7 = (undefined4 *)((int)puVar7 + 1);
    }
    *(void **)(iVar1 + 0x24) = pvVar2;
    *(int *)(iVar1 + 0x2c) = iVar6;
  }
  pbVar10 = &DAT_10039247;
  pbVar8 = (byte *)(*(int *)(iVar1 + 0x28) * 0x30 + *(int *)(iVar1 + 0x24));
  iVar5 = 0x20;
  pbVar9 = pbVar8;
  pbVar3 = FUN_10002000(param_2,(byte *)"INDEX");
  FUN_100030f0(pbVar3,pbVar9,iVar5,pbVar10);
  *(undefined4 *)(pbVar8 + 0x20) = *(undefined4 *)(iVar1 + 0x28);
  *(int *)(iVar1 + 0x28) = *(int *)(iVar1 + 0x28) + 1;
  pbVar8[0x28] = 0;
  pbVar8[0x29] = 0;
  pbVar8[0x2a] = 0;
  pbVar8[0x2b] = 0;
  *(byte **)(param_1 + 0x14) = pbVar8;
  *(undefined4 *)(param_1 + 0x20) = 3;
  return 1;
}



undefined4 __cdecl FUN_1000be00(int *param_1)

{
  int iVar1;
  byte *in_EAX;
  void *pvVar2;
  byte *pbVar3;
  byte *pbVar4;
  long lVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  undefined4 *puVar10;
  byte *pbVar11;
  byte local_c [12];
  
  iVar1 = param_1[8];
  if ((iVar1 != 3) && (iVar1 != 5)) {
    _printf("%s:%d VARIATION is not valid in this state %d\n",param_1[1],param_1[2],iVar1);
    return 0;
  }
  iVar1 = param_1[5];
  iVar7 = *(int *)(iVar1 + 0x2c);
  if (*(int *)(iVar1 + 0x28) == iVar7) {
    iVar8 = 2;
    if (iVar7 != 0) {
      iVar8 = iVar7 * 2;
    }
    pvVar2 = _realloc(*(void **)(iVar1 + 0x24),iVar8 * 0xcf0);
    if (pvVar2 == (void *)0x0) {
      _printf("%s:%d too many variations, capping at %d\n",param_1[1],param_1[2],
              *(undefined4 *)(iVar1 + 0x28));
      return 0;
    }
    puVar10 = (undefined4 *)(*(int *)(iVar1 + 0x28) * 0xcf0 + (int)pvVar2);
    for (uVar6 = (uint)((iVar8 - *(int *)(iVar1 + 0x28)) * 0xcf0) >> 2; uVar6 != 0;
        uVar6 = uVar6 - 1) {
      *puVar10 = 0;
      puVar10 = puVar10 + 1;
    }
    for (iVar7 = 0; iVar7 != 0; iVar7 = iVar7 + -1) {
      *(undefined1 *)puVar10 = 0;
      puVar10 = (undefined4 *)((int)puVar10 + 1);
    }
    *(int *)(iVar1 + 0x2c) = iVar8;
    *(void **)(iVar1 + 0x24) = pvVar2;
  }
  pbVar11 = &DAT_10039247;
  iVar7 = 0x20;
  pbVar9 = (byte *)(*(int *)(iVar1 + 0x28) * 0xcf0 + *(int *)(iVar1 + 0x24));
  pbVar4 = pbVar9;
  pbVar3 = FUN_10002000(in_EAX,(byte *)"VARIATION");
  FUN_100030f0(pbVar3,pbVar4,iVar7,pbVar11);
  pbVar11 = &DAT_10039247;
  iVar7 = 0x20;
  pbVar4 = pbVar9 + 0x20;
  pbVar3 = FUN_10002000(in_EAX,&DAT_10039b60);
  FUN_100030f0(pbVar3,pbVar4,iVar7,pbVar11);
  iVar7 = 0;
  pbVar4 = FUN_10002000(in_EAX,(byte *)"FIXED");
  iVar7 = FUN_10002e80(pbVar4,iVar7);
  iVar8 = 100;
  *(short *)(pbVar9 + 0xce6) = (short)iVar7;
  pbVar4 = FUN_10002000(in_EAX,(byte *)"RANGE");
  iVar7 = FUN_10002e80(pbVar4,iVar8);
  iVar8 = 0;
  *(short *)(pbVar9 + 0xcec) = (short)iVar7;
  pbVar9[0xcee] = 0;
  pbVar9[0xcef] = 0;
  pbVar4 = FUN_10002000(in_EAX,(byte *)"CENTERED");
  iVar7 = FUN_10002e80(pbVar4,iVar8);
  if (iVar7 != 0) {
    pbVar9[0xcee] = pbVar9[0xcee] | 1;
  }
  iVar7 = 0;
  pbVar4 = FUN_10002000(in_EAX,(byte *)"BUDDIES");
  iVar7 = FUN_10002e80(pbVar4,iVar7);
  if (iVar7 != 0) {
    pbVar9[0xcee] = pbVar9[0xcee] | 2;
  }
  iVar7 = -1;
  pbVar4 = FUN_10002000(in_EAX,&DAT_1003ad40);
  iVar7 = FUN_10002e80(pbVar4,iVar7);
  if (iVar7 < 0) {
    if (*(int *)(*param_1 + 0x1938) == 0x80) {
      _printf("%s:%d too many ranking lists, only %d allowed in total\n",param_1[1],param_1[2],0x80)
      ;
      return 0;
    }
    *(undefined2 *)(pbVar9 + 0xce8) = *(undefined2 *)(*param_1 + 0x1938);
    *(int *)(*param_1 + 0x1938) = *(int *)(*param_1 + 0x1938) + 1;
    *(int *)(param_1[3] + 0x20) = *(int *)(param_1[3] + 0x20) + 1;
  }
  else {
    *(short *)(pbVar9 + 0xce8) = (short)iVar7;
  }
  pbVar4 = FUN_10002000(in_EAX,(byte *)"PARAMS");
  if (pbVar4 == (byte *)0x0) {
    pbVar9[0xcea] = 0;
    pbVar9[0xceb] = 0;
  }
  else {
    iVar7 = 0;
    pbVar3 = pbVar9 + 0xcc4;
    do {
      iVar8 = FUN_10002f60(pbVar4,local_c,0xc,&DAT_10039247,iVar7,0x2c);
      if ((iVar8 < 1) || (local_c[0] == 0)) break;
      lVar5 = _atol((char *)local_c);
      *(long *)pbVar3 = lVar5;
      iVar7 = iVar7 + 1;
      pbVar3 = pbVar3 + 4;
    } while (iVar7 != 8);
    *(short *)(pbVar9 + 0xcea) = (short)iVar7;
  }
  *(undefined4 *)(pbVar9 + 0x40) = *(undefined4 *)(iVar1 + 0x28);
  *(int *)(iVar1 + 0x28) = *(int *)(iVar1 + 0x28) + 1;
  pbVar9[0xce4] = 0;
  pbVar9[0xce5] = 0;
  param_1[6] = (int)pbVar9;
  param_1[8] = 4;
  return 1;
}



undefined4 FUN_1000c0c0(void)

{
  byte *pbVar1;
  byte *pbVar2;
  void *this;
  byte *unaff_EBX;
  int *unaff_EDI;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  
  iVar4 = unaff_EDI[8];
  if ((iVar4 != 0) && (iVar4 != 5)) {
    _printf("%s:%d VIEW is not valid in this state %d\n",unaff_EDI[1],unaff_EDI[2],iVar4);
    return 0;
  }
  pbVar1 = (byte *)_malloc(0x24);
  if (pbVar1 != (byte *)0x0) {
    pbVar5 = &DAT_10039247;
    iVar4 = 0xc;
    pbVar3 = pbVar1;
    pbVar2 = FUN_10002000(unaff_EBX,&DAT_1003a2a8);
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar5);
    pbVar1[0xc] = 0;
    pbVar1[0xd] = 0;
    pbVar1[0xe] = 0;
    pbVar1[0xf] = 0;
    pbVar1[0x10] = 0;
    pbVar1[0x11] = 0;
    pbVar1[0x12] = 0;
    pbVar1[0x13] = 0;
    pbVar1[0x14] = 0;
    pbVar1[0x15] = 0;
    pbVar1[0x16] = 0;
    pbVar1[0x17] = 0;
    pbVar1[0x20] = 0;
    pbVar1[0x21] = 0;
    pbVar1[0x22] = 0;
    pbVar1[0x23] = 0;
    iVar4 = FUN_10018820(this,*(int **)(*unaff_EDI + 0x1934),pbVar1,(int)pbVar1);
    if (-1 < iVar4) {
      iVar4 = -1;
      unaff_EDI[3] = (int)pbVar1;
      unaff_EDI[8] = 1;
      pbVar1 = FUN_10002000(unaff_EBX,(byte *)"RESET");
      iVar4 = FUN_10002e80(pbVar1,iVar4);
      if (0 < iVar4) {
        *(undefined4 *)(*unaff_EDI + 0x1938) = 0;
      }
      return 1;
    }
  }
  return 0;
}



undefined4 __cdecl FUN_1000c180(int *param_1)

{
  byte *in_EAX;
  int iVar1;
  undefined4 uVar2;
  void *this;
  char *pcVar3;
  char *pcVar4;
  bool bVar5;
  char local_64 [100];
  
  if (*in_EAX != 0x23) {
    iVar1 = FUN_10002270((char *)in_EAX,local_64,100);
    if (iVar1 != 0) {
      this = (void *)0x9;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "CATEGORY";
      do {
        if (this == (void *)0x0) break;
        this = (void *)((int)this + -1);
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000bae0(this,in_EAX);
        return uVar2;
      }
      iVar1 = 7;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "COLUMN";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000bbf0((int)param_1);
        return uVar2;
      }
      iVar1 = 6;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "INDEX";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000bcf0((int)param_1,in_EAX);
        return uVar2;
      }
      iVar1 = 10;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "VARIATION";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000be00(param_1);
        return uVar2;
      }
      iVar1 = 5;
      bVar5 = true;
      pcVar3 = local_64;
      pcVar4 = "VIEW";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar5 = *pcVar3 == *pcVar4;
        pcVar3 = pcVar3 + 1;
        pcVar4 = pcVar4 + 1;
      } while (bVar5);
      if (bVar5) {
        uVar2 = FUN_1000c0c0();
        return uVar2;
      }
      _printf("%s:%d invalid configuration \'%s\'\n",param_1[1],param_1[2],local_64);
      return 0;
    }
  }
  return 1;
}



int FUN_1000c2a0(void)

{
  FILE *_File;
  char *pcVar1;
  int unaff_EBX;
  int iVar2;
  char *unaff_EDI;
  char local_100 [256];
  
  iVar2 = 0;
  *(undefined4 *)(unaff_EBX + 0x1938) = 0;
  _printf("Loading ranking lists from \'%s\'\n");
  _File = (FILE *)FUN_1002e478(unaff_EDI,"r");
  if (_File == (FILE *)0x0) {
    _printf("could not open ranking configuration %s\n");
    return 0;
  }
  pcVar1 = _fgets(local_100,0x100,_File);
  if (pcVar1 != (char *)0x0) {
    while( true ) {
      iVar2 = FUN_1000c180((int *)&stack0xfffffedc);
      if (iVar2 == 0) break;
      pcVar1 = _fgets(local_100,0x100,_File);
      if (pcVar1 == (char *)0x0) {
        _printf("Loaded %d ranking lists from \'%s\'\n",*(undefined4 *)(unaff_EBX + 0x1938));
        FUN_1000b920(unaff_EBX);
        _fclose(_File);
        return iVar2;
      }
    }
  }
  _printf("Loaded ranking lists from \'%s\' failed\n");
  _fclose(_File);
  return iVar2;
}



void __cdecl FUN_1000c3b0(int param_1)

{
  byte *pbVar1;
  int iVar2;
  int in_EAX;
  uint uVar3;
  byte *pbVar4;
  byte local_10 [16];
  
  pbVar1 = *(byte **)(in_EAX + 0x58);
  iVar2 = *(int *)(in_EAX + 0x54);
  uVar3 = 0;
  if (*(short *)(param_1 + 0xce4) != 0) {
    pbVar4 = (byte *)(param_1 + 0x84);
    do {
      _sprintf((char *)local_10,"COLNAME%d",uVar3);
      FUN_10002620(pbVar1,iVar2,local_10,pbVar4 + -0x40);
      _sprintf((char *)local_10,"COLDESC%d",uVar3);
      FUN_10002620(pbVar1,iVar2,local_10,pbVar4 + -0x20);
      _sprintf((char *)local_10,"COLPARAM%d",uVar3);
      FUN_10002620(pbVar1,iVar2,local_10,pbVar4);
      _sprintf((char *)local_10,"COLWIDTH%d",uVar3);
      FUN_10002310(pbVar1,iVar2,local_10,*(int *)(pbVar4 + 0x20));
      uVar3 = uVar3 + 1;
      pbVar4 = pbVar4 + 100;
    } while (uVar3 != *(ushort *)(param_1 + 0xce4));
  }
  return;
}



undefined4 __cdecl FUN_1000c480(undefined4 param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int in_EAX;
  int iVar3;
  int iVar4;
  char *local_7c;
  uint local_78;
  undefined4 *local_74;
  char local_60 [96];
  
  pbVar1 = *(byte **)(param_2 + 0x58);
  pbVar2 = *(byte **)(param_2 + 0x54);
  iVar4 = *(int *)(in_EAX + 0x44c) * 0xcf0 +
          *(int *)(*(int *)(in_EAX + 0x448) * 0x30 + 0x24 +
                  *(int *)(*(int *)(in_EAX + 0x444) * 0x30 +
                           *(int *)(*(int *)(in_EAX + 0x43c) + 0xc) + 0x24));
  local_60[0] = '\0';
  local_7c = local_60;
  local_78 = 0;
  if (*(short *)(iVar4 + 0xcea) != 0) {
    local_74 = (undefined4 *)(iVar4 + 0xcc4);
    do {
      if (local_78 != 0) {
        *local_7c = ',';
        local_7c = local_7c + 1;
      }
      iVar3 = _sprintf(local_7c,"%d",*local_74);
      local_7c = local_7c + iVar3;
      local_74 = local_74 + 1;
      local_78 = local_78 + 1;
    } while (local_78 != *(ushort *)(iVar4 + 0xcea));
  }
  FUN_10002c50(pbVar1,pbVar2,
               (byte *)
               "IDX=%d VIEW=%s CN=%s CI=%d IN=%s II=%d VN=%s VI=%d CC=%d FC=%d DESC=%s RANGE=%d CENTERED=%d BUDDIES=%d PARAMS=%s"
              );
  FUN_1000c3b0(iVar4);
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x48) = 0x2b766172;
  return 1;
}



undefined4 __cdecl FUN_1000c5f0(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int unaff_ESI;
  
  iVar1 = *(int *)(unaff_ESI + 0x43c);
  if (iVar1 == 0) {
    FUN_10018a80(*(int *)(param_1 + 0x1934));
    iVar1 = FUN_10018a90(*(int *)(param_1 + 0x1934),(undefined4 *)0x0);
    if (iVar1 == 0) {
      *(undefined4 *)(unaff_ESI + 0x438) = 1;
    }
    else {
      *(int *)(unaff_ESI + 0x43c) = iVar1;
    }
  }
  else {
    iVar2 = *(int *)(unaff_ESI + 0x444) * 0x30 + *(int *)(iVar1 + 0xc);
    iVar3 = *(int *)(iVar2 + 0x24);
    iVar5 = *(int *)(unaff_ESI + 0x44c) + 1;
    *(int *)(unaff_ESI + 0x44c) = iVar5;
    if (iVar5 == *(int *)(*(int *)(unaff_ESI + 0x448) * 0x30 + iVar3 + 0x28)) {
      iVar3 = *(int *)(unaff_ESI + 0x448) + 1;
      *(undefined4 *)(unaff_ESI + 0x44c) = 0;
      *(int *)(unaff_ESI + 0x448) = iVar3;
      if (iVar3 == *(int *)(iVar2 + 0x28)) {
        iVar3 = *(int *)(unaff_ESI + 0x444) + 1;
        *(undefined4 *)(unaff_ESI + 0x448) = 0;
        *(int *)(unaff_ESI + 0x444) = iVar3;
        if (iVar3 == *(int *)(iVar1 + 0x10)) {
          *(undefined4 *)(unaff_ESI + 0x444) = 0;
          iVar1 = FUN_10018780(*(undefined4 **)(param_1 + 0x1934));
          iVar3 = *(int *)(unaff_ESI + 0x440) + 1;
          *(int *)(unaff_ESI + 0x440) = iVar3;
          if (iVar3 == iVar1) {
            *(undefined4 *)(unaff_ESI + 0x438) = 1;
          }
          else {
            FUN_10018a80(*(int *)(param_1 + 0x1934));
            uVar4 = 0;
            do {
              iVar1 = FUN_10018a90(*(int *)(param_1 + 0x1934),(undefined4 *)0x0);
              if (iVar1 == 0) {
                *(undefined4 *)(unaff_ESI + 0x438) = 1;
                *(undefined4 *)(unaff_ESI + 0x43c) = 0;
                goto LAB_1000c72e;
              }
              uVar4 = uVar4 + 1;
            } while (uVar4 <= *(uint *)(unaff_ESI + 0x440));
            *(int *)(unaff_ESI + 0x43c) = iVar1;
          }
        }
      }
    }
  }
LAB_1000c72e:
  if (*(int *)(unaff_ESI + 0x438) == 0) {
    FUN_1000c480(param_1,param_2);
  }
  return 1;
}



undefined4 __cdecl FUN_1000c9b0(int param_1)

{
  *(undefined4 *)(param_1 + 0x4c) = 0;
  *(undefined4 *)(param_1 + 0x20) = 0;
  return 0;
}



void __cdecl
FUN_1000ca40(int param_1,uint param_2,uint param_3,uint param_4,char *param_5,char *param_6)

{
  uint *puVar1;
  char cVar2;
  int iVar3;
  
  puVar1 = (uint *)((*(uint *)(param_1 + 0x8d80) % *(uint *)(param_1 + 0x8d84)) * 0x434 + 0x8d88 +
                   param_1);
  *puVar1 = *(uint *)(param_1 + 0x8d80);
  *(int *)(param_1 + 0x8d80) = *(int *)(param_1 + 0x8d80) + 1;
  puVar1[0x107] = param_2;
  puVar1[0x106] = param_4;
  puVar1[0x10b] = 0;
  puVar1[0x10c] = 0;
  puVar1[0x108] = param_3;
  iVar3 = 4 - (int)param_5;
  do {
    cVar2 = *param_5;
    param_5[(int)puVar1 + iVar3] = cVar2;
    param_5 = param_5 + 1;
  } while (cVar2 != '\0');
  iVar3 = 0x14 - (int)param_6;
  do {
    cVar2 = *param_6;
    param_6[(int)puVar1 + iVar3] = cVar2;
    param_6 = param_6 + 1;
  } while (cVar2 != '\0');
  return;
}



void __cdecl FUN_1000cb40(int param_1,int param_2)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  
  puVar1 = (undefined4 *)_malloc(param_2 * 300);
  *(undefined4 **)(param_1 + 0x8cf4) = puVar1;
  for (uVar3 = (uint)(param_2 * 300) >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar1 = 0;
    puVar1 = puVar1 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar1 = 0;
    puVar1 = (undefined4 *)((int)puVar1 + 1);
  }
  uVar3 = 0;
  *(int *)(param_1 + 0x8cf0) = param_2;
  if (param_2 != 0) {
    iVar4 = 0;
    do {
      iVar2 = *(int *)(param_1 + 0x8cf4) + iVar4;
      *(int *)(iVar2 + 0x28) = iVar2 + 0x2c;
      uVar3 = uVar3 + 1;
      iVar4 = iVar4 + 300;
    } while (uVar3 < *(uint *)(param_1 + 0x8cf0));
  }
  *(undefined4 *)(param_1 + 0x8d78) = 0;
  return;
}



void __cdecl FUN_1000cbb0(int param_1,undefined4 param_2,char *param_3,int param_4,int param_5)

{
  char *pcVar1;
  
  if (*(uint *)(param_1 + 0x8d78) < 0x10) {
    *(undefined4 *)(param_1 + 0x8cf8 + *(uint *)(param_1 + 0x8d78) * 8) = param_2;
    pcVar1 = FUN_10012190(param_3,param_4,param_5);
    *(char **)(param_1 + 0x8cfc + *(int *)(param_1 + 0x8d78) * 8) = pcVar1;
    *(int *)(param_1 + 0x8d78) = *(int *)(param_1 + 0x8d78) + 1;
  }
  return;
}



void __cdecl FUN_1000cc00(int param_1)

{
  uint uVar1;
  undefined4 *puVar2;
  
  uVar1 = 0;
  if (*(int *)(param_1 + 0x8d78) != 0) {
    puVar2 = (undefined4 *)(param_1 + 0x8cfc);
    do {
      FUN_10012570((char *)*puVar2);
      uVar1 = uVar1 + 1;
      puVar2 = puVar2 + 2;
    } while (uVar1 < *(uint *)(param_1 + 0x8d78));
  }
  *(undefined4 *)(param_1 + 0x8d78) = 0;
  return;
}



void __cdecl FUN_1000cc90(int param_1,uint param_2,char *param_3,byte *param_4)

{
  byte bVar1;
  byte *pbVar2;
  void *pvVar3;
  byte *pbVar4;
  uint uVar5;
  uint *puVar6;
  undefined4 *puVar7;
  char *pcVar8;
  char *pcVar9;
  
  puVar6 = (uint *)((*(uint *)(param_1 + 0x8cec) % *(uint *)(param_1 + 0x8cf0)) * 300 +
                   *(int *)(param_1 + 0x8cf4));
  *puVar6 = *(uint *)(param_1 + 0x8cec);
  *(int *)(param_1 + 0x8cec) = *(int *)(param_1 + 0x8cec) + 1;
  puVar6[1] = param_2;
  if (param_3 == (char *)0x0) {
    param_3 = "";
  }
  FUN_10002230((char *)(puVar6 + 2),0x20,param_3);
  if ((uint *)puVar6[10] != puVar6 + 0xb) {
    _free((uint *)puVar6[10]);
    puVar6[10] = (uint)(puVar6 + 0xb);
  }
  pbVar2 = param_4;
  do {
    bVar1 = *pbVar2;
    pbVar2 = pbVar2 + 1;
  } while (bVar1 != 0);
  if (0xff < (int)pbVar2 - (int)(param_4 + 1)) {
    pvVar3 = _malloc(((int)pbVar2 - (int)(param_4 + 1)) + 1);
    puVar6[10] = (uint)pvVar3;
  }
  pbVar2 = (byte *)puVar6[10];
  pbVar4 = param_4;
  do {
    bVar1 = *pbVar4;
    pbVar4 = pbVar4 + 1;
    *pbVar2 = bVar1;
    pbVar2 = pbVar2 + 1;
  } while (bVar1 != 0);
  uVar5 = 0;
  if (*(int *)(param_1 + 0x8d78) != 0) {
    puVar7 = (undefined4 *)(param_1 + 0x8cfc);
    do {
      if ((param_2 & puVar7[-1]) != 0) {
        if ((puVar7[-1] & 0x40000000) == 0) {
          pcVar8 = (char *)*puVar7;
          pcVar9 = "~%s";
        }
        else {
          pcVar8 = (char *)*puVar7;
          pcVar9 = "%s";
        }
        FUN_100123b0(pcVar8,pcVar9,param_4);
      }
      uVar5 = uVar5 + 1;
      puVar7 = puVar7 + 2;
    } while (uVar5 < *(uint *)(param_1 + 0x8d78));
  }
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_1000cd80(int param_1,uint param_2,char *param_3,char *param_4)

{
  byte local_2000 [8188];
  uint uStack_4;
  
  uStack_4 = 0x1000cd8a;
  local_2000[0] = 0;
  __vsnprintf((char *)local_2000,0x2000,param_4,&stack0x00000014);
  uStack_4 = uStack_4 & 0xffffff;
  FUN_1000cc90(param_1,param_2,param_3,local_2000);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_1000cde0(int param_1,uint param_2,char *param_3)

{
  byte *pbVar1;
  char local_2000 [8188];
  undefined4 uStack_4;
  
  uStack_4 = 0x1000cdea;
  pbVar1 = (byte *)FUN_1001ec70(local_2000,0x2000,param_3,(int)&stack0x00000010);
  FUN_1000cc90(param_1,param_2,(char *)0x0,pbVar1);
  return;
}



int * __cdecl FUN_1000ce30(int param_1,uint *param_2,uint param_3)

{
  int *piVar1;
  uint uVar2;
  
  if (*param_2 != *(uint *)(param_1 + 0x8cec)) {
    do {
      piVar1 = (int *)((*param_2 % *(uint *)(param_1 + 0x8cf0)) * 300 + *(int *)(param_1 + 0x8cf4));
      uVar2 = *param_2 + 1;
      *param_2 = uVar2;
      if ((*piVar1 + 1U == uVar2) && ((piVar1[1] & param_3) != 0)) {
        return piVar1;
      }
    } while (*param_2 != *(uint *)(param_1 + 0x8cec));
  }
  return (int *)0x0;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

int * __cdecl FUN_1000cf40(int param_1,int param_2,undefined4 param_3,byte *param_4,byte *param_5)

{
  int *piVar1;
  char cVar2;
  int *_Memory;
  byte *pbVar3;
  int *piVar4;
  undefined4 *puVar5;
  byte *pbVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  u_short uVar10;
  byte *pbVar11;
  char *pcVar12;
  undefined **local_1004;
  byte local_1000 [4092];
  undefined4 uStack_4;
  
  uStack_4 = 0x1000cf4a;
  _Memory = (int *)_malloc(0x11651e0);
  pcVar12 = "libmascust.so";
  piVar4 = _Memory;
  for (iVar7 = 0x459478; iVar7 != 0; iVar7 = iVar7 + -1) {
    *piVar4 = 0;
    piVar4 = piVar4 + 1;
  }
  iVar7 = 0x100;
  pbVar6 = (byte *)(_Memory + 0x459366);
  pbVar3 = FUN_10002000(param_4,(byte *)"MASCUST");
  FUN_100030f0(pbVar3,pbVar6,iVar7,(byte *)pcVar12);
  piVar4 = FUN_10011f70("localize.csv");
  _Memory[0x4593e7] = (int)piVar4;
  cVar2 = FUN_10013080();
  if (cVar2 == '\0') {
    _fprintf((FILE *)&DAT_100415c0,"_MasterCreate: failed to load mas-cust module.\n");
    FUN_10010510(param_1);
    _free(_Memory);
    return (int *)0x0;
  }
  FUN_1001a3f0(0x1000c3a0,(int)_Memory);
  pbVar11 = &DAT_10039247;
  iVar7 = 0x80;
  pbVar6 = (byte *)(_Memory + 0x50a);
  _Memory[0x235f] = param_2;
  pbVar3 = FUN_10002000(param_5,(byte *)"VERSION");
  FUN_100030f0(pbVar3,pbVar6,iVar7,pbVar11);
  pbVar6 = (byte *)(_Memory + 0x55a);
  _Memory[0x500] = param_1;
  FUN_10002c50(pbVar6,(byte *)0x80,(byte *)"DP=%s PLATFORM=%s");
  FUN_10002bb0(pbVar6,0x80,&DAT_1003afe0,param_4);
  FUN_10002bb0(pbVar6,0x80,&DAT_1003afd8,param_4);
  FUN_10002bb0(pbVar6,0x80,&DAT_1003afd0,param_4);
  FUN_10002bb0(pbVar6,0x80,(byte *)"PLATFORM",param_4);
  _printf("ref->context=\'%s\'\n",pbVar6);
  puVar5 = FUN_10017d30(0x10000);
  iVar7 = 0x26ac;
  _Memory[0x656] = (int)puVar5;
  pbVar6 = FUN_10002000(param_4,&DAT_10039210);
  iVar7 = FUN_10002e80(pbVar6,iVar7);
  pbVar6 = FUN_10002000(param_4,(byte *)"RPORT");
  iVar7 = FUN_10002e80(pbVar6,iVar7);
  uVar10 = (u_short)iVar7;
  uVar9 = 0x7f000001;
  pbVar6 = FUN_10002000(param_4,&DAT_10039d3c);
  uVar9 = FUN_10002f10(pbVar6,uVar9);
  pbVar6 = FUN_10002000(param_4,(byte *)"RADDR");
  uVar9 = FUN_10002f10(pbVar6,uVar9);
  FUN_10017e90((int *)_Memory[0x656],uVar9,uVar10);
  puVar5 = FUN_10017d30(0x10000);
  iVar7 = 0x26ac;
  _Memory[0x658] = (int)puVar5;
  pbVar6 = FUN_10002000(param_4,&DAT_10039210);
  iVar7 = FUN_10002e80(pbVar6,iVar7);
  pbVar6 = FUN_10002000(param_4,(byte *)"APORT");
  iVar7 = FUN_10002e80(pbVar6,iVar7);
  uVar10 = (u_short)iVar7;
  uVar9 = 0x7f000001;
  pbVar6 = FUN_10002000(param_4,&DAT_10039d3c);
  uVar9 = FUN_10002f10(pbVar6,uVar9);
  pbVar6 = FUN_10002000(param_4,(byte *)"AADDR");
  uVar9 = FUN_10002f10(pbVar6,uVar9);
  FUN_10017e90((int *)_Memory[0x658],uVar9,uVar10);
  puVar5 = FUN_10018b00(100,1000);
  _Memory[0x57d] = (int)puVar5;
  puVar5 = FUN_10019e90(100,1000);
  _Memory[0x57e] = (int)puVar5;
  puVar5 = FUN_10018b00(500,5000);
  _Memory[0x580] = (int)puVar5;
  FUN_1002c1c0((int)puVar5,FUN_10019c70);
  puVar5 = FUN_10018b00(500,5000);
  _Memory[0x581] = (int)puVar5;
  FUN_1002c1c0((int)puVar5,FUN_10019c70);
  puVar5 = FUN_10019e90(500,5000);
  _Memory[0x582] = (int)puVar5;
  puVar5 = FUN_10018b00(500,5000);
  _Memory[0x5c6] = (int)puVar5;
  puVar5 = FUN_10019e90(500,5000);
  _Memory[0x5c7] = (int)puVar5;
  iVar7 = FUN_10019a50(0);
  _Memory[0x5c8] = iVar7;
  puVar5 = FUN_10018b00(500,5000);
  _Memory[0x5c9] = (int)puVar5;
  puVar5 = FUN_10019e90(500,5000);
  _Memory[0x5ca] = (int)puVar5;
  _Memory[0x2360] = 1;
  _Memory[0x2361] = 0x4000;
  _Memory[0x436362] = 1;
  _Memory[0x436363] = 0x800;
  puVar5 = FUN_10018b00(3,10);
  _Memory[0x64d] = (int)puVar5;
  FUN_1000cb40((int)_Memory,0x100);
  pbVar11 = &DAT_10039247;
  iVar7 = 0x1000;
  pbVar6 = local_1000;
  pbVar3 = FUN_10002000(param_4,(byte *)"RANKFILE");
  FUN_100030f0(pbVar3,pbVar6,iVar7,pbVar11);
  if ((local_1000[0] != 0) && (iVar7 = FUN_1000c2a0(), iVar7 == 0)) {
    _printf("_MasterCreate: fatal ranking file error, shutting down.\n");
    FUN_10010510(param_1);
    _free(_Memory);
    return (int *)0x0;
  }
  if (PTR_DAT_10041118 != (undefined *)0x0) {
    local_1004 = &PTR_DAT_10041118;
    iVar7 = 0;
    piVar4 = (int *)PTR_DAT_10041118;
    do {
      if (*piVar4 != 0) {
        iVar8 = 0;
        piVar4 = _Memory + iVar7 * 5 + 2;
        do {
          piVar4[-2] = *(int *)(*local_1004 + iVar8);
          piVar4[-1] = *(int *)(*local_1004 + iVar8 + 4);
          *piVar4 = *(int *)(*local_1004 + iVar8 + 8);
          piVar4[1] = (int)*local_1004;
          piVar4[2] = 0;
          iVar8 = iVar8 + 0x14;
          iVar7 = iVar7 + 1;
          piVar4 = piVar4 + 5;
        } while (*(int *)(*local_1004 + iVar8) != 0);
      }
      piVar4 = (int *)local_1004[1];
      local_1004 = local_1004 + 1;
    } while (piVar4 != (int *)0x0);
  }
  iVar7 = *_Memory;
  piVar4 = _Memory;
  while (iVar7 != 0) {
    if (*piVar4 == 0x3e3e3e3e) {
      (*(code *)piVar4[2])(_Memory,param_4,0);
    }
    piVar1 = piVar4 + 5;
    piVar4 = piVar4 + 5;
    iVar7 = *piVar1;
  }
  local_1000[0] = 0;
  FUN_10002ad0(local_1000,0x1000,(byte *)"STAMP",0);
  pbVar11 = &DAT_10039247;
  iVar7 = 0x80;
  pbVar6 = (byte *)(_Memory + 0x52a);
  pbVar3 = FUN_10002000(local_1000,(byte *)"STAMP");
  FUN_100030f0(pbVar3,pbVar6,iVar7,pbVar11);
  piVar4 = FUN_10019930(0x1000);
  _Memory[0x976] = (int)piVar4;
  puVar5 = FUN_1002a040();
  _Memory[0x977] = (int)puVar5;
  puVar5 = FUN_10018b00(10,100);
  _Memory[0x978] = (int)puVar5;
  FUN_1002c1c0((int)puVar5,_strcmp);
  _Memory[0x979] = 1;
  _Memory[0x97a] = 0x40;
  puVar5 = FUN_10019900();
  _Memory[0x71e] = (int)puVar5;
  puVar5 = FUN_10019900();
  _Memory[0x71f] = (int)puVar5;
  puVar5 = FUN_100299f0();
  _Memory[0x5cc] = (int)puVar5;
  uVar9 = FUN_100035f0((char *)0x0,0);
  _Memory[0x459477] = (0xe10 - uVar9 % 0xe10) * 1000 + _Memory[0x651];
  return _Memory;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_1000d4d0(int *param_1,int param_2,byte *param_3)

{
  int *piVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  byte *pbVar7;
  char *pcVar8;
  uint uVar9;
  byte local_1000 [4092];
  undefined4 uStack_4;
  
  uStack_4 = 0x1000d4da;
  param_1[0x57b] = param_2;
  if (param_3 != (byte *)0x0) {
    local_1000[0] = 0;
    FUN_10002ad0(local_1000,0x1000,(byte *)"STAMP",0);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x40;
    pbVar3 = (byte *)(param_1 + 0x54a);
    pbVar2 = FUN_10002000(local_1000,(byte *)"STAMP");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    FUN_1000cc00((int)param_1);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x1000;
    pbVar3 = local_1000;
    pbVar2 = FUN_10002000(param_3,(byte *)"DIAGLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 0;
    pbVar3 = FUN_10002000(param_3,(byte *)"DIAGLIM");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    if (local_1000[0] != 0) {
      FUN_1000cbb0((int)param_1,0x40080000,(char *)local_1000,0x4000,iVar4);
    }
    pbVar7 = &DAT_10039247;
    iVar4 = 0x1000;
    pbVar3 = local_1000;
    pbVar2 = FUN_10002000(param_3,(byte *)"STATLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 0;
    pbVar3 = FUN_10002000(param_3,(byte *)"STATLIM");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    if (local_1000[0] != 0) {
      FUN_1000cbb0((int)param_1,0x40002000,(char *)local_1000,0x4000,iVar4);
    }
    pbVar7 = &DAT_10039247;
    iVar4 = 0x1000;
    pbVar3 = local_1000;
    pbVar2 = FUN_10002000(param_3,(byte *)"GAMELOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 0;
    pbVar3 = FUN_10002000(param_3,(byte *)"GAMELIM");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    if (local_1000[0] != 0) {
      FUN_1000cbb0((int)param_1,0x80,(char *)local_1000,0x4000,iVar4);
    }
    pbVar7 = &DAT_10039247;
    iVar4 = 0x1000;
    pbVar3 = local_1000;
    pbVar2 = FUN_10002000(param_3,(byte *)"REPTLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 0;
    pbVar3 = FUN_10002000(param_3,(byte *)"REPTLIM");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    if (local_1000[0] != 0) {
      FUN_1000cbb0((int)param_1,2,(char *)local_1000,0x4000,iVar4);
    }
    pbVar7 = &DAT_10039247;
    iVar4 = 0x1000;
    pbVar3 = local_1000;
    pbVar2 = FUN_10002000(param_3,(byte *)"RANKLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 0;
    pbVar3 = FUN_10002000(param_3,(byte *)"RANKLIM");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    if (local_1000[0] != 0) {
      FUN_1000cbb0((int)param_1,0x40000,(char *)local_1000,0x4000,iVar4);
    }
    pbVar7 = &DAT_10039247;
    iVar4 = 0x1000;
    pbVar3 = local_1000;
    pbVar2 = FUN_10002000(param_3,(byte *)"XMLLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 0;
    pbVar3 = FUN_10002000(param_3,(byte *)"XMLLIM");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    if (local_1000[0] != 0) {
      FUN_1000cbb0((int)param_1,0x41000000,(char *)local_1000,0x4000,iVar4);
    }
    pbVar7 = &DAT_10039247;
    iVar4 = 0x1000;
    pbVar3 = local_1000;
    pbVar2 = FUN_10002000(param_3,(byte *)"CUSTLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 0;
    pbVar3 = FUN_10002000(param_3,(byte *)"CUSTLIM");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    if (local_1000[0] != 0) {
      FUN_1000cbb0((int)param_1,8,(char *)local_1000,0x4000,iVar4);
    }
    if (param_1[0x57a] == 0) {
      FUN_1000cde0((int)param_1,0x80000,"<NOTICE time=%e>%s</>");
    }
    pbVar7 = &DAT_10039247;
    iVar4 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x69e);
    pbVar2 = FUN_10002000(param_3,(byte *)"PATHLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x6de);
    pbVar2 = FUN_10002000(param_3,(byte *)"ARCHLOG");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    pcVar8 = "Crypt %d";
    iVar4 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x720);
    pbVar2 = FUN_10002000(param_3,(byte *)"CRYPT");
    FUN_100030f0(pbVar2,pbVar3,iVar4,(byte *)pcVar8);
    iVar4 = 0x20;
    piVar5 = param_1 + 0x760;
    pbVar3 = FUN_10002000(param_3,(byte *)"SECRET");
    iVar4 = FUN_10003280((char *)pbVar3,(int)piVar5,iVar4);
    uVar9 = 0xffffff00;
    *(bool *)(param_1 + 0x768) = 0 < iVar4;
    pbVar3 = FUN_10002000(param_3,(byte *)"TRUST");
    uVar9 = FUN_10002f10(pbVar3,uVar9);
    pcVar8 = "ober4icer";
    iVar4 = 0x20;
    pbVar3 = (byte *)(param_1 + 0x96e);
    param_1[0x96d] = uVar9;
    pbVar2 = FUN_10002000(param_3,(byte *)"WEBPASS");
    FUN_100030f0(pbVar2,pbVar3,iVar4,(byte *)pcVar8);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x20;
    pbVar3 = (byte *)(param_1 + 0x501);
    pbVar2 = FUN_10002000(param_3,(byte *)"LOBBY_IDENT");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x400;
    pbVar3 = (byte *)((int)param_1 + 0x1da1);
    pbVar2 = FUN_10002000(param_3,(byte *)"ADMIN_LIST");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x400;
    pbVar3 = (byte *)((int)param_1 + 0x21a1);
    pbVar2 = FUN_10002000(param_3,(byte *)"ADMIN_FILT");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x10;
    pbVar3 = (byte *)((int)param_1 + 0x25a1);
    pbVar2 = FUN_10002000(param_3,(byte *)"ADMIN_BUDDY");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    pbVar7 = &DAT_10039247;
    iVar4 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x4593f1);
    pbVar2 = FUN_10002000(param_3,(byte *)"AUDIT_LIST");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    pbVar3 = FUN_10010c00(param_1[0x500],"FILTER-TEXT");
    FUN_100192a0((undefined4 *)param_1[0x71e],pbVar3);
    pbVar3 = FUN_10010c00(param_1[0x500],"FILTER-NAME");
    FUN_100192a0((undefined4 *)param_1[0x71f],pbVar3);
    pcVar8 = FUN_10010c00(param_1[0x500],"FILTER");
    if (*pcVar8 != '\0') {
      pbVar3 = FUN_10010c00(param_1[0x500],"FILTER");
      FUN_100192a0((undefined4 *)param_1[0x71e],pbVar3);
      pbVar3 = FUN_10010c00(param_1[0x500],"FILTER");
      FUN_100192a0((undefined4 *)param_1[0x71f],pbVar3);
    }
    FUN_10029a10((int *)param_1[0x5cc],param_3);
    iVar4 = 1000;
    pbVar3 = FUN_10002000(param_3,(byte *)"ROOMMAX");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    iVar6 = 0x3c;
    param_1[0x57c] = iVar4;
    pbVar3 = FUN_10002000(param_3,(byte *)"GAMETIMEOUT");
    iVar4 = FUN_10002e80(pbVar3,iVar6);
    iVar6 = 0;
    param_1[0x650] = iVar4;
    pbVar3 = FUN_10002000(param_3,(byte *)"ROOM_DOOR_MESG");
    iVar4 = FUN_10002e80(pbVar3,iVar6);
    iVar6 = 0x1ff;
    param_1[0x57f] = iVar4;
    pbVar3 = FUN_10002000(param_3,(byte *)"DEFAULT_USER_COLOR");
    iVar4 = FUN_10002e80(pbVar3,iVar6);
    pbVar7 = &DAT_10039247;
    param_1[0x4593a6] = iVar4;
    iVar4 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x4593a7);
    pbVar2 = FUN_10002000(param_3,(byte *)"ALERTS_DCR_URL");
    FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar7);
    iVar4 = 5;
    pbVar3 = FUN_10002000(param_3,(byte *)"SERVER_STAT_REFRESH");
    iVar4 = FUN_10002e80(pbVar3,iVar4);
    param_1[0x4593ef] = iVar4 * 1000;
    iVar4 = *param_1;
    piVar5 = param_1;
    while (iVar4 != 0) {
      if (*piVar5 == 0x26262626) {
        (*(code *)piVar5[2])(param_1,param_3,0);
      }
      piVar1 = piVar5 + 5;
      piVar5 = piVar5 + 5;
      iVar4 = *piVar1;
    }
    pcVar8 = "STAT,INFO";
    iVar4 = 0x100;
    pbVar3 = (byte *)(param_1 + 0x459431);
    pbVar2 = FUN_10002000(param_3,(byte *)"UNRANKALL_FIELDS");
    FUN_100030f0(pbVar2,pbVar3,iVar4,(byte *)pcVar8);
    pcVar8 = "........................";
    iVar4 = 0x18;
    pbVar3 = (byte *)(param_1 + 0x459471);
    pbVar2 = FUN_10002000(param_3,(byte *)"CONFIG_RELOAD_SCHEDULE");
    FUN_100030f0(pbVar2,pbVar3,iVar4,(byte *)pcVar8);
    param_1[0x57a] = param_1[0x57a] + 1;
    FUN_1000cde0((int)param_1,0x80000,"<NOTICE time=%e rev=%d>%s</>");
    _printf("Master server is setup\n");
  }
  return;
}



void __cdecl FUN_1000f020(uint param_1)

{
  void *pvVar1;
  int *piVar2;
  void *_Memory;
  uint uVar3;
  int iVar4;
  int iVar5;
  
  uVar3 = param_1;
  FUN_1000cc00(param_1);
  piVar2 = (int *)(param_1 + 0x8cf0);
  iVar4 = 0;
  param_1 = 0;
  if (*piVar2 != 0) {
    do {
      _Memory = *(void **)(*(int *)(uVar3 + 0x8cf4) + 0x28 + iVar4);
      iVar5 = *(int *)(uVar3 + 0x8cf4) + iVar4;
      pvVar1 = (void *)(iVar5 + 0x2c);
      if (_Memory != pvVar1) {
        _free(_Memory);
        *(void **)(iVar5 + 0x28) = pvVar1;
      }
      param_1 = param_1 + 1;
      iVar4 = iVar4 + 300;
    } while (param_1 < *(uint *)(uVar3 + 0x8cf0));
  }
  _free(*(void **)(uVar3 + 0x8cf4));
  return;
}



void __cdecl FUN_1000f090(int *param_1)

{
  int *piVar1;
  void *pvVar2;
  int iVar3;
  int *piVar4;
  
  FUN_1000cde0((int)param_1,0x80000,"<NOTICE time=%e>%s</>");
  FUN_10019990((int *)param_1[0x976]);
  FUN_1002a070((void *)param_1[0x977]);
  iVar3 = *param_1;
  piVar4 = param_1;
  while (iVar3 != 0) {
    if (*piVar4 == 0x3c3c3c3c) {
      (*(code *)piVar4[2])(param_1,0,0);
    }
    piVar1 = piVar4 + 5;
    piVar4 = piVar4 + 5;
    iVar3 = *piVar1;
  }
  FUN_1000f020((uint)param_1);
  pvVar2 = (void *)FUN_10018720((int *)param_1[0x64d]);
  while (pvVar2 != (void *)0x0) {
    FUN_1001de90(pvVar2);
    pvVar2 = (void *)FUN_10018720((int *)param_1[0x64d]);
  }
  FUN_10018680((void *)param_1[0x64d]);
  iVar3 = FUN_10018720((int *)param_1[0x5c6]);
  while (iVar3 != 0) {
    FUN_1001dce0(param_1[0x5c8],iVar3);
    iVar3 = FUN_10018720((int *)param_1[0x5c6]);
  }
  FUN_10018680((void *)param_1[0x5c6]);
  FUN_10019f20((void *)param_1[0x5c7]);
  FUN_10019a80((void *)param_1[0x5c8],'\0');
  pvVar2 = (void *)FUN_10018720((int *)param_1[0x5c9]);
  while (pvVar2 != (void *)0x0) {
    FUN_1001d220(pvVar2);
    pvVar2 = (void *)FUN_10018720((int *)param_1[0x5c9]);
  }
  FUN_10018680((void *)param_1[0x5c9]);
  FUN_10019f20((void *)param_1[0x5ca]);
  pvVar2 = (void *)FUN_10018720((int *)param_1[0x581]);
  while (pvVar2 != (void *)0x0) {
    _free(pvVar2);
    pvVar2 = (void *)FUN_10018720((int *)param_1[0x581]);
  }
  FUN_10018680((void *)param_1[0x581]);
  FUN_10018680((void *)param_1[0x580]);
  FUN_10019f20((void *)param_1[0x582]);
  pvVar2 = (void *)FUN_10018720((int *)param_1[0x57d]);
  while (pvVar2 != (void *)0x0) {
    _free(pvVar2);
    pvVar2 = (void *)FUN_10018720((int *)param_1[0x57d]);
  }
  FUN_10018680((void *)param_1[0x57d]);
  FUN_10019f20((void *)param_1[0x57e]);
  FUN_10029b90((void *)param_1[0x5cc]);
  FUN_10019210((void *)param_1[0x71e]);
  FUN_10019210((void *)param_1[0x71f]);
  FUN_10017da0((SOCKET *)param_1[0x656]);
  FUN_10017da0((SOCKET *)param_1[0x658]);
  pvVar2 = (void *)FUN_10018720((int *)param_1[0x978]);
  while (pvVar2 != (void *)0x0) {
    FUN_100119c0(pvVar2);
    pvVar2 = (void *)FUN_10018720((int *)param_1[0x978]);
  }
  FUN_10018680((void *)param_1[0x978]);
  FUN_100120c0((undefined4 *)param_1[0x4593e7]);
  _free(param_1);
  return;
}



void __cdecl FUN_1000f300(int param_1)

{
  *(undefined4 *)(param_1 + 0x1c) = 0x41000000;
  *(undefined4 *)(param_1 + 0x20) = 0x5fffffff;
  *(undefined4 *)(param_1 + 0x18) = 0x48c;
  *(undefined4 *)(param_1 + 4) = 1;
  *(undefined4 *)(param_1 + 0x14) = 5;
  *(undefined4 *)(param_1 + 0xc) = 0x2000;
  *(undefined4 *)(param_1 + 0x10) = 0x4000;
  builtin_strncpy((char *)(param_1 + 0x24),"mast",4);
  *(undefined2 *)(param_1 + 0x28) = 0x7265;
  *(undefined1 *)(param_1 + 0x2a) = 0;
  *(undefined4 *)(param_1 + 0x44) = 0x20544547;
  *(undefined4 *)(param_1 + 0x48) = 0x2f736d2f;
  *(undefined1 *)(param_1 + 0x4c) = 0;
  *(code **)(param_1 + 0x54) = FUN_1000cf40;
  *(code **)(param_1 + 0x58) = FUN_1000d4d0;
  *(code **)(param_1 + 0x5c) = FUN_1000f090;
  *(undefined1 **)(param_1 + 0x60) = &LAB_1000dbe0;
  *(undefined1 **)(param_1 + 100) = &LAB_1000c880;
  *(undefined1 **)(param_1 + 0x68) = &LAB_1000c750;
  *(undefined1 **)(param_1 + 0x6c) = &LAB_1000e240;
  *(undefined1 **)(param_1 + 0x70) = &LAB_1000ee40;
  return;
}



void __fastcall FUN_1000f3b0(int param_1)

{
  byte *in_EAX;
  byte *pbVar1;
  int iVar2;
  uint *puVar3;
  uint uVar4;
  byte local_20 [32];
  
  uVar4 = 0xffffffff;
  pbVar1 = FUN_10002000(in_EAX,(byte *)"AUDIT_MASK");
  uVar4 = FUN_10002f10(pbVar1,uVar4);
  *(uint *)(param_1 + 0xd30) = uVar4;
  puVar3 = (uint *)(param_1 + 0xd10);
  *puVar3 = 0;
  *(undefined4 *)(param_1 + 0xd14) = 0;
  *(undefined4 *)(param_1 + 0xd18) = 0;
  *(undefined4 *)(param_1 + 0xd1c) = 0;
  *(undefined4 *)(param_1 + 0xd20) = 0;
  *(undefined4 *)(param_1 + 0xd24) = 0;
  *(undefined4 *)(param_1 + 0xd28) = 0;
  *(undefined4 *)(param_1 + 0xd2c) = 0;
  pbVar1 = FUN_10002000(in_EAX,(byte *)"AUDIT");
  if (pbVar1 != (byte *)0x0) {
    iVar2 = 0;
    do {
      FUN_10002f60(pbVar1,local_20,0x20,&DAT_10039247,iVar2,0x2c);
      if (local_20[0] == 0) {
        return;
      }
      uVar4 = FUN_10002f10(local_20,0);
      *puVar3 = uVar4;
      iVar2 = iVar2 + 1;
      puVar3 = puVar3 + 1;
    } while (iVar2 < 8);
  }
  return;
}



void __fastcall FUN_1000f460(int param_1)

{
  int in_EAX;
  int unaff_EBX;
  int unaff_ESI;
  char local_20 [16];
  char local_10 [16];
  
  if (in_EAX < 0) {
    _sprintf(local_10,"%x");
  }
  else {
    _sprintf(local_10,"%c%c%c%c",in_EAX >> 0x18,in_EAX >> 0x10,in_EAX >> 8);
  }
  if (param_1 == 0) {
    _sprintf(local_20,"0");
  }
  else {
    _sprintf(local_20,"%c%c%c%c",param_1 >> 0x18,param_1 >> 0x10,param_1 >> 8,param_1);
  }
  FUN_100123b0(*(char **)(unaff_EBX + 0xce4),"~%x %d.%d.%d.%d/%d %c %s %s %s",
               *(byte **)(unaff_ESI + 4));
  FUN_100122c0(*(char **)(unaff_EBX + 0xce4));
  return;
}



void __fastcall FUN_1000f550(undefined4 param_1,int param_2)

{
  FUN_1000f460(CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(param_2 + 4),*(undefined1 *)(param_2 + 5))
                                 ,*(undefined1 *)(param_2 + 6)),*(undefined1 *)(param_2 + 7)));
  return;
}



undefined4 FUN_1000f5d0(void)

{
  byte *pbVar1;
  byte *pbVar2;
  int unaff_EDI;
  int iVar3;
  int local_4;
  
  pbVar1 = FUN_1001c1e0(*(uint **)(unaff_EDI + 0xcdc),"");
  iVar3 = 0x32;
  pbVar2 = FUN_10002000(pbVar1,(byte *)"SLOWIDLE");
  iVar3 = FUN_10002e80(pbVar2,iVar3);
  *(int *)(unaff_EDI + 0xce8) = iVar3;
  FUN_1000f3b0(unaff_EDI);
  pbVar2 = (byte *)(unaff_EDI + 0x460);
  local_4 = 8;
  do {
    if ((*(int *)(pbVar2 + -0x24) != 0) && (*(int *)(pbVar2 + 0x34) != 0)) {
      if (*(int *)(pbVar2 + -0x1c) < 1) {
        FUN_100123b0(*(char **)(unaff_EDI + 0xce4),"~Refreshing %s",pbVar2);
        (**(code **)(pbVar2 + 0x34))
                  (*(undefined4 *)(pbVar2 + -0x24),*(undefined4 *)(unaff_EDI + 0xcdc),0,0);
      }
      else {
        FUN_100123b0(*(char **)(unaff_EDI + 0xce4),"~Reconfiguring %s",pbVar2);
        (**(code **)(pbVar2 + 0x34))
                  (*(undefined4 *)(pbVar2 + -0x24),*(undefined4 *)(unaff_EDI + 0xcdc),pbVar1,
                   unaff_EDI + 0x10);
        pbVar2[-0xffffffff0000001c] = 0;
        pbVar2[-0xffffffff0000001b] = 0;
        pbVar2[-0xffffffff0000001a] = 0;
        pbVar2[-0xffffffff00000019] = 0;
      }
    }
    pbVar2 = pbVar2 + 0x74;
    local_4 = local_4 + -1;
  } while (local_4 != 0);
  return 0;
}



undefined4 __cdecl FUN_1000f6a0(uint *param_1,uint *param_2)

{
  char cVar1;
  char cVar2;
  char cVar3;
  char cVar4;
  uint *puVar5;
  undefined2 uVar6;
  undefined4 uVar7;
  undefined2 extraout_var;
  u_long uVar8;
  uint *puVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  undefined4 *unaff_ESI;
  undefined4 *puVar15;
  char *_Str1;
  
  puVar5 = param_2;
  uVar13 = *param_2;
  if ((uVar13 & 0x12) != 0) {
    if ((((uVar13 & 2) == 0) && (unaff_ESI[3] != -1)) &&
       ((unaff_ESI[0x16] != 0 || ((int)unaff_ESI[0xd] < (int)unaff_ESI[0xe])))) {
      *param_2 = 0;
      unaff_ESI[3] = 0xfffffffe;
      return 1;
    }
    *param_2 = 0;
    FUN_1002a7e0((int *)param_1[0x104],param_2[1]);
    if ((void *)unaff_ESI[0x1e] != (void *)0x0) {
      _free((void *)unaff_ESI[0x1e]);
    }
    if ((void *)unaff_ESI[0x16] != (void *)0x0) {
      _free((void *)unaff_ESI[0x16]);
    }
    if ((void *)unaff_ESI[0x10] != (void *)0x0) {
      _free((void *)unaff_ESI[0x10]);
    }
    puVar15 = (undefined4 *)unaff_ESI[0x21];
    if ((puVar15 != (undefined4 *)0x0) && ((code *)puVar15[0x1c] != (code *)0x0)) {
      (*(code *)puVar15[0x1c])(*puVar15);
    }
    uVar13 = *param_1;
    uVar14 = unaff_ESI[1] + uVar13;
    if (0x7effffff < uVar14) {
      uVar14 = uVar14 % uVar13 + uVar13;
    }
    uVar12 = unaff_ESI[2] + uVar13;
    if (0x7effffff < uVar12) {
      uVar12 = uVar12 % uVar13 + uVar13;
    }
    uVar7 = *unaff_ESI;
    puVar15 = unaff_ESI;
    for (iVar11 = 0x23; iVar11 != 0; iVar11 = iVar11 + -1) {
      *puVar15 = 0;
      puVar15 = puVar15 + 1;
    }
    *unaff_ESI = uVar7;
    unaff_ESI[1] = uVar14;
    unaff_ESI[2] = uVar12;
    return 0;
  }
  if ((uVar13 & 1) != 0) {
    *param_2 = uVar13 ^ 1;
    uVar13 = *param_1;
    uVar14 = unaff_ESI[1] + uVar13;
    if (0x7effffff < uVar14) {
      uVar14 = uVar14 % uVar13 + uVar13;
    }
    uVar12 = unaff_ESI[2] + uVar13;
    if (0x7effffff < uVar12) {
      uVar12 = uVar12 % uVar13 + uVar13;
    }
    uVar7 = *unaff_ESI;
    puVar15 = unaff_ESI;
    for (iVar11 = 0x23; iVar11 != 0; iVar11 = iVar11 + -1) {
      *puVar15 = 0;
      puVar15 = puVar15 + 1;
    }
    unaff_ESI[1] = uVar14;
    *unaff_ESI = uVar7;
    unaff_ESI[2] = uVar12;
    FUN_1002a870((int *)param_1[0x104],param_2[1],0xc,1);
    param_2[9] = 0x3c;
    uVar7 = FUN_1002aa10((int *)param_1[0x104],param_2[1]);
    unaff_ESI[3] = uVar7;
    uVar6 = FUN_1002aa40((int *)param_1[0x104],param_2[1]);
    unaff_ESI[4] = CONCAT22(extraout_var,uVar6);
    uVar8 = FUN_1002aa70((int *)param_1[0x104],param_2[1]);
    unaff_ESI[7] = uVar8;
    puVar9 = param_1 + 0x344;
    if (param_1[0x344] != 0) {
      uVar13 = 0;
      do {
        if ((*puVar9 == unaff_ESI[3]) || ((param_1[0x34c] & unaff_ESI[3]) == *puVar9)) {
          *(undefined1 *)(unaff_ESI + 0x22) = 1;
          break;
        }
        uVar13 = uVar13 + 1;
        puVar9 = puVar9 + 1;
      } while (uVar13 < 8);
    }
  }
  if ((*param_2 & 4) != 0) {
    if (unaff_ESI[0x1d] == 0) {
      uVar13 = param_2[2];
      uVar14 = param_2[5];
      _Str1 = (char *)(uVar14 + uVar13);
      uVar12 = 0;
      param_2 = (uint *)CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)(uVar14 + 8 + uVar13),_Str1[9]),
                                          *(undefined1 *)(uVar14 + 10 + uVar13)),_Str1[0xb]);
      if (((int)param_2 < 0xc) ||
         (uVar13 = FUN_1002a3e0((uint *)param_1[0x104],0x72786275), (int)uVar13 < (int)param_2)) {
        param_2 = (uint *)0x0;
        puVar9 = param_1 + 0x10f;
        while ((*puVar9 == 0 || (iVar11 = _strncmp(_Str1,(char *)(puVar9 + 0x11),8), iVar11 != 0)))
        {
          param_2 = (uint *)((int)param_2 + 1);
          puVar9 = puVar9 + 0x1d;
          if ((uint *)0x7 < param_2) {
            *puVar5 = *puVar5 | 0x10;
            return 0;
          }
        }
        uVar12 = puVar9[7];
        if (uVar12 == 0) {
          *puVar5 = *puVar5 | 0x10;
          return 0;
        }
        *_Str1 = (char)(uVar12 >> 0x18);
        _Str1[1] = (char)(uVar12 >> 0x10);
        _Str1[2] = (char)(uVar12 >> 8);
        _Str1[4] = _Str1[8];
        param_2 = (uint *)0x40c;
        _Str1[3] = (char)uVar12;
        _Str1[5] = _Str1[9];
        _Str1[6] = _Str1[10];
        _Str1[7] = _Str1[0xb];
      }
      unaff_ESI[0x1b] = 0;
      unaff_ESI[0x1c] = param_2 + -3;
      unaff_ESI[0x19] = CONCAT31(CONCAT21(CONCAT11(*_Str1,_Str1[1]),_Str1[2]),_Str1[3]);
      cVar3 = _Str1[6];
      cVar4 = _Str1[7];
      cVar1 = _Str1[4];
      cVar2 = _Str1[5];
      unaff_ESI[0x18] = uVar12;
      unaff_ESI[0x1d] = &DAT_10039247;
      unaff_ESI[0x1a] = CONCAT31(CONCAT21(CONCAT11(cVar1,cVar2),cVar3),cVar4);
      *puVar5 = *puVar5 ^ 4;
      iVar11 = 0x40;
      if (unaff_ESI[0x18] == 0) {
        iVar11 = unaff_ESI[0x1c];
      }
      FUN_1002a870((int *)param_1[0x104],puVar5[1],iVar11,0);
    }
    if ((*puVar5 & 4) != 0) {
LAB_1000fa27:
      *puVar5 = *puVar5 ^ 4;
      unaff_ESI[0x1d] = puVar5[2] + 0xc + puVar5[5];
      uVar13 = puVar5[4];
      if ((int)puVar5[3] <= (int)puVar5[4]) {
        uVar13 = puVar5[3];
      }
      iVar11 = (uVar13 - puVar5[2]) + -0xc;
      unaff_ESI[0x1b] = iVar11;
      if (unaff_ESI[0x18] != 0) {
        iVar10 = 0;
        if (0 < iVar11) {
          do {
            if (*(char *)(unaff_ESI[0x1d] + iVar10) < ' ') {
              *(undefined1 *)(unaff_ESI[0x1d] + iVar10) = 0;
              unaff_ESI[0x1c] = unaff_ESI[0x1b];
              unaff_ESI[0x18] = 0;
              if ((((9 < iVar10) &&
                   (iVar10 = iVar10 + unaff_ESI[0x1d], *(char *)(iVar10 + -9) == ' ')) &&
                  (*(char *)(iVar10 + -8) == 'H')) &&
                 (((*(char *)(iVar10 + -7) == 'T' && (*(char *)(iVar10 + -6) == 'T')) &&
                  (*(char *)(iVar10 + -5) == 'P')))) {
                *(undefined1 *)(iVar10 + -9) = 0;
              }
              *(undefined1 *)unaff_ESI[0x1d] = 9;
              iVar11 = 1;
              if (1 < (int)unaff_ESI[0x1c]) goto LAB_1000fad0;
              break;
            }
            iVar10 = iVar10 + 1;
          } while (iVar10 < (int)unaff_ESI[0x1b]);
        }
        goto LAB_1000faeb;
      }
      goto LAB_1000fb09;
    }
LAB_1000fb13:
    if (unaff_ESI[0x1b] == unaff_ESI[0x1c]) {
      unaff_ESI[0x1b] = unaff_ESI[0x1c];
      puVar5[9] = 0;
      if (unaff_ESI[0x1b] == 0) {
        unaff_ESI[0x1d] = &DAT_10039247;
        return 1;
      }
      *(undefined1 *)(unaff_ESI[0x1b] + -1 + unaff_ESI[0x1d]) = 0;
    }
  }
  return 1;
  while( true ) {
    if (cVar1 == '&') {
      *(char *)(iVar11 + unaff_ESI[0x1d]) = '\t';
    }
    iVar11 = iVar11 + 1;
    if ((int)unaff_ESI[0x1c] <= iVar11) break;
LAB_1000fad0:
    cVar1 = *(char *)(iVar11 + unaff_ESI[0x1d]);
    if (cVar1 < ' ') break;
  }
LAB_1000faeb:
  if (unaff_ESI[0x18] != 0) {
    FUN_1002a870((int *)param_1[0x104],puVar5[1],0x40,0);
  }
LAB_1000fb09:
  if ((*puVar5 & 4) == 0) goto LAB_1000fb13;
  goto LAB_1000fa27;
}



char __cdecl FUN_1000fb50(int param_1,int *param_2,uint param_3)

{
  char *pcVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  char *pcVar6;
  undefined4 *puVar7;
  char *pcVar8;
  uint uVar9;
  uint _Size;
  undefined4 *puVar10;
  int *piVar11;
  
  param_2[0x16] = (int)&DAT_10042ab4;
  param_2[0x15] = 0xfff4;
  param_2[0x12] = 0;
  param_2[0x13] = 0;
  param_2[0x14] = 0;
  if (param_2[8] == 0) {
    iVar4 = param_2[0x19];
    if (iVar4 == 0x7e706e67) {
      param_2[0x1a] = param_3 - param_2[0x1a];
    }
    puVar10 = (undefined4 *)param_2[0x21];
    param_2[0x18] = 0;
    if (((puVar10 == (undefined4 *)0x0) || (iVar3 = puVar10[7], iVar4 < iVar3)) ||
       ((int)puVar10[8] < iVar4)) {
      uVar9 = 0;
      piVar11 = (int *)(param_1 + 0x43c);
      do {
        if (((*piVar11 != 0) && (piVar11[7] <= iVar4)) && (iVar4 <= piVar11[8])) {
          if (iVar4 != piVar11[7]) {
            if (piVar11[0x19] != 0) {
              param_2[0x1f] = 0;
              if ((char)param_2[0x22] != '\0') {
                FUN_1000f460(param_2[0x1a]);
              }
              (*(code *)piVar11[0x19])(*piVar11,param_2,0);
              break;
            }
            if (iVar4 != piVar11[7]) break;
          }
          if (piVar11[0x1a] != 0) {
            param_2[0x19] = param_2[0x1a];
            param_2[0x1a] = 0;
            param_2[0x1f] = 1;
            (*(code *)piVar11[0x1a])(*piVar11,param_2,0);
          }
          break;
        }
        uVar9 = uVar9 + 1;
        piVar11 = piVar11 + 0x1d;
      } while (uVar9 < 8);
    }
    else {
      if (iVar4 != iVar3) {
        if (puVar10[0x19] != 0) {
          param_2[0x1f] = 0;
          if ((char)param_2[0x22] != '\0') {
            FUN_1000f460(param_2[0x1a]);
          }
          (*(code *)((undefined4 *)param_2[0x21])[0x19])
                    (*(undefined4 *)param_2[0x21],param_2,param_2 + 0x23);
          goto LAB_1000fca9;
        }
        if (iVar4 != iVar3) goto LAB_1000fca9;
      }
      if (puVar10[0x1a] != 0) {
        param_2[0x19] = param_2[0x1a];
        param_2[0x1a] = 0;
        param_2[0x1f] = 1;
        (*(code *)puVar10[0x1a])(*puVar10,param_2,param_2 + 0x23);
      }
    }
  }
LAB_1000fca9:
  if ((code *)param_2[8] != (code *)0x0) {
    if (param_2[10] == 0) {
      if (((int *)param_2[0x21] == (int *)0x0) ||
         (iVar4 = param_2[9], *(int *)param_2[0x21] != iVar4)) {
        iVar4 = param_2[9];
        piVar11 = (int *)0x0;
      }
      else {
        piVar11 = param_2 + 0x23;
      }
      (*(code *)param_2[8])(iVar4,param_2,piVar11);
    }
    uVar9 = param_2[0xb];
    if (uVar9 == 0) {
      param_2[8] = 0;
    }
    else if (uVar9 < 0x79) {
      param_2[0xb] = uVar9 * 1000 + param_3;
    }
    else if (param_3 != uVar9 && -1 < (int)(param_3 - uVar9)) {
      param_2[0xb] = -1;
      param_2[10] = 0;
    }
  }
  if (param_2[8] == 0) {
    if ((void *)param_2[0x1e] != (void *)0x0) {
      _free((void *)param_2[0x1e]);
    }
    param_2[0x1e] = 0;
    param_2[0x1d] = 0;
    FUN_1002a870(*(int **)(param_1 + 0x410),*param_2,0xc,1);
  }
  if (param_2[0x12] != 0) {
    if (param_2[0x18] != 0) {
      param_2[0x12] = param_2[0x18];
    }
    iVar4 = param_2[0x12];
    if (iVar4 == 0x48545450) {
      pcVar8 = (char *)0x0;
      if (param_2[0x13] == 0x48545450) {
        pcVar8 = PTR_s_HTTP_1_0_200_OK_Connection__clos_10041174;
      }
      if (param_2[0x13] == 0x584d4c21) {
        pcVar8 = PTR_s_HTTP_1_0_200_OK_Connection__clos_10041178;
      }
      if (pcVar8 != (char *)0x0) {
        pcVar5 = pcVar8;
        do {
          cVar2 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        } while (cVar2 != '\0');
        pcVar6 = (char *)param_2[0x16];
        pcVar1 = pcVar6 + 1;
        do {
          cVar2 = *pcVar6;
          pcVar6 = pcVar6 + 1;
        } while (cVar2 != '\0');
        param_2[0x15] = (int)(pcVar5 + (int)(pcVar6 + (-(int)pcVar1 - (int)(pcVar8 + 1))));
        pcVar5 = (char *)_malloc((size_t)(pcVar5 + (int)(pcVar6 + (-(int)pcVar1 - (int)(pcVar8 + 1))
                                                        ) + 1));
        param_2[0x16] = (int)pcVar5;
        do {
          cVar2 = *pcVar8;
          pcVar8 = pcVar8 + 1;
          *pcVar5 = cVar2;
          pcVar5 = pcVar5 + 1;
        } while (cVar2 != '\0');
        pcVar8 = &DAT_10042ab4;
        do {
          pcVar5 = pcVar8;
          pcVar8 = pcVar5 + 1;
        } while (*pcVar5 != '\0');
        puVar10 = (undefined4 *)(param_2[0x16] + -1);
        do {
          pcVar8 = (char *)((int)puVar10 + 1);
          puVar10 = (undefined4 *)((int)puVar10 + 1);
        } while (*pcVar8 != '\0');
        puVar7 = (undefined4 *)&DAT_10042ab4;
        for (uVar9 = (uint)(pcVar5 + -0x10042ab3) >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
          *puVar10 = *puVar7;
          puVar7 = puVar7 + 1;
          puVar10 = puVar10 + 1;
        }
        for (uVar9 = (uint)(pcVar5 + -0x10042ab3) & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(undefined1 *)puVar10 = *(undefined1 *)puVar7;
          puVar7 = (undefined4 *)((int)puVar7 + 1);
          puVar10 = (undefined4 *)((int)puVar10 + 1);
        }
        param_2[0x14] = 0;
        return '\0';
      }
    }
    if ((param_2[0x14] == 0) && (iVar4 == 0x7e706e67)) {
      param_2[0x13] = param_3;
    }
    DAT_10042aa8 = (undefined1)((uint)iVar4 >> 0x18);
    DAT_10042aa9 = *(undefined1 *)((int)param_2 + 0x4a);
    DAT_10042aaa = (undefined1)((uint)param_2[0x12] >> 8);
    DAT_10042aab = (undefined1)param_2[0x12];
    DAT_10042aac = *(undefined1 *)((int)param_2 + 0x4f);
    DAT_10042aad = *(undefined1 *)((int)param_2 + 0x4e);
    DAT_10042aae = (undefined1)((uint)param_2[0x13] >> 8);
    DAT_10042aaf = (undefined1)param_2[0x13];
    pcVar8 = (char *)param_2[0x14];
    if ((int)pcVar8 < 0) {
      pcVar8 = (char *)param_2[0x16];
      pcVar5 = pcVar8 + 1;
      do {
        cVar2 = *pcVar8;
        pcVar8 = pcVar8 + 1;
      } while (cVar2 != '\0');
      pcVar8 = pcVar8 + (1 - (int)pcVar5);
    }
    pcVar8 = pcVar8 + 0xc;
    DAT_10042ab0 = (undefined1)((uint)pcVar8 >> 0x18);
    DAT_10042ab1 = (undefined1)((uint)pcVar8 >> 0x10);
    DAT_10042ab2 = (undefined1)((uint)pcVar8 >> 8);
    DAT_10042ab3 = SUB41(pcVar8,0);
    if ((char)param_2[0x22] != '\0') {
      FUN_1000f550((int)pcVar8 >> 0x18,0x10042aa8);
    }
    pcVar5 = (char *)FUN_1002a950(*(int **)(param_1 + 0x410),*param_2,&DAT_10042aa8,(int)pcVar8);
    if ((int)pcVar5 < 0) {
      pcVar5 = (char *)0x0;
    }
    if (pcVar5 != pcVar8) {
      _Size = (int)pcVar8 - (int)pcVar5;
      puVar7 = (undefined4 *)_malloc(_Size);
      param_2[0x16] = (int)puVar7;
      puVar10 = (undefined4 *)(&DAT_10042aa8 + (int)pcVar5);
      for (uVar9 = _Size >> 2; uVar9 != 0; uVar9 = uVar9 - 1) {
        *puVar7 = *puVar10;
        puVar10 = puVar10 + 1;
        puVar7 = puVar7 + 1;
      }
      for (uVar9 = _Size & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
        *(undefined1 *)puVar7 = *(undefined1 *)puVar10;
        puVar10 = (undefined4 *)((int)puVar10 + 1);
        puVar7 = (undefined4 *)((int)puVar7 + 1);
      }
      param_2[0x15] = _Size;
      param_2[0x14] = 0;
      return '\0';
    }
  }
  param_2[0x16] = 0;
  return (param_2[8] == 0) + '\x01';
}



undefined4 __cdecl FUN_1000ff40(int param_1,int *param_2,int param_3)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  
  uVar3 = 0;
  iVar2 = FUN_1002a950(*(int **)(param_1 + 0x410),*param_2,(char *)(param_2[0x16] + param_2[0x14]),
                       param_2[0x15] - param_2[0x14]);
  if (iVar2 < 1) {
    if (param_2[0x17] == 0) {
      param_2[0x17] = param_3 + 10000;
    }
    if (param_3 != param_2[0x17] && -1 < param_3 - param_2[0x17]) {
      param_2[3] = -1;
      return 0xffffffff;
    }
  }
  else {
    iVar1 = param_2[0x14];
    param_2[0x14] = iVar1 + iVar2;
    param_2[0x17] = param_3 + 120000;
    if (iVar1 + iVar2 == param_2[0x15]) {
      uVar3 = 1;
      _free((void *)param_2[0x16]);
      param_2[0x16] = 0;
      param_2[0x17] = 0;
      if ((param_2[0x12] == 0x48545450) &&
         ((param_2[0x13] == 0x48545450 || (param_2[0x13] == 0x584d4c21)))) {
        FUN_1002a7a0(*(int **)(param_1 + 0x410),*param_2);
        return 0xffffffff;
      }
    }
  }
  return uVar3;
}



undefined4 __thiscall FUN_10010010(void *this,int param_1,int *param_2,int param_3)

{
  int iVar1;
  int iVar2;
  
  if ((param_2[0x11] == 0) && ((char)param_2[0x22] != '\0')) {
    FUN_1000f550(this,param_2[0x10]);
  }
  iVar2 = FUN_1002a950(*(int **)(param_1 + 0x410),*param_2,(char *)(param_2[0x10] + param_2[0xd]),
                       param_2[0xe] - param_2[0xd]);
  if (iVar2 < 1) {
    if (param_2[0x11] == 0) {
      param_2[0x11] = param_3 + 10000;
    }
    if (param_3 != param_2[0x11] && -1 < param_3 - param_2[0x11]) {
      param_2[3] = -1;
      return 0xffffffff;
    }
  }
  else {
    iVar1 = param_2[0xd];
    param_2[0xd] = iVar1 + iVar2;
    param_2[0x11] = param_3 + 120000;
    if (iVar1 + iVar2 == param_2[0xe]) {
      return 1;
    }
  }
  return 0;
}



undefined4 __cdecl FUN_100100c0(int param_1,int *param_2,int param_3)

{
  char *pcVar1;
  char cVar2;
  int *piVar3;
  char *pcVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  uint _Size;
  undefined4 *puVar8;
  undefined4 *puVar9;
  int local_c;
  undefined4 *local_8;
  
  piVar3 = param_2;
  local_8 = (undefined4 *)0x0;
  if (param_3 - param_2[0xc] < 1) {
    return 0;
  }
  param_2[0x16] = (int)&DAT_10042ab4;
  param_2[0x15] = 0xfff4;
  local_c = *(int *)(param_2[0x21] + 0x10);
  param_2 = (int *)0x0;
  do {
    piVar3[0x12] = 0;
    piVar3[0x13] = 0;
    piVar3[0x14] = 0;
    (*(code *)((undefined4 *)piVar3[0x21])[0x1b])
              (*(undefined4 *)piVar3[0x21],piVar3,piVar3 + 0x23,param_3,param_2);
    iVar7 = piVar3[0x12];
    if (iVar7 != 0) {
      if (iVar7 == 0x7e706e67) {
        piVar3[0x13] = param_3;
      }
      iVar5 = piVar3[0x16];
      *(undefined1 *)(iVar5 + -0xc) = (char)((uint)iVar7 >> 0x18);
      *(undefined1 *)(iVar5 + -0xb) = *(undefined1 *)((int)piVar3 + 0x4a);
      *(char *)(iVar5 + -10) = (char)((uint)piVar3[0x12] >> 8);
      *(char *)(iVar5 + -9) = (char)piVar3[0x12];
      *(undefined1 *)(iVar5 + -8) = *(undefined1 *)((int)piVar3 + 0x4f);
      *(undefined1 *)(iVar5 + -7) = *(undefined1 *)((int)piVar3 + 0x4e);
      *(char *)(iVar5 + -6) = (char)((uint)piVar3[0x13] >> 8);
      *(char *)(iVar5 + -5) = (char)piVar3[0x13];
      pcVar4 = (char *)piVar3[0x14];
      if ((int)pcVar4 < 0) {
        pcVar4 = (char *)piVar3[0x16];
        pcVar1 = pcVar4 + 1;
        do {
          cVar2 = *pcVar4;
          pcVar4 = pcVar4 + 1;
        } while (cVar2 != '\0');
        pcVar4 = pcVar4 + (1 - (int)pcVar1);
      }
      pcVar4 = pcVar4 + 0xc;
      *(char *)(iVar5 + -4) = (char)((uint)pcVar4 >> 0x18);
      *(char *)(iVar5 + -3) = (char)((uint)pcVar4 >> 0x10);
      *(char *)(iVar5 + -2) = (char)((uint)pcVar4 >> 8);
      *(char *)(iVar5 + -1) = (char)pcVar4;
      if ((char)piVar3[0x22] != '\0') {
        FUN_1000f550(CONCAT31((int3)(short)((uint)pcVar4 >> 0x10),(char)piVar3[0x22]),iVar5 + -0xc);
      }
      piVar3[0x16] = (int)(pcVar4 + piVar3[0x16]);
      piVar3[0x15] = piVar3[0x15] - (int)pcVar4;
    }
    iVar7 = piVar3[0x16] + -0x10042ab4;
    if ((piVar3[0x12] == 0) || (*(int *)(piVar3[0x21] + 0xc) < iVar7)) {
      if (iVar7 == 0) {
        if (param_2 == (int *)0x0) {
          piVar3[0xc] = *(int *)(piVar3[0x21] + 0x14) + param_3;
          piVar3[0x16] = 0;
          return 0;
        }
        goto LAB_100102c4;
      }
      iVar5 = FUN_1002a950(*(int **)(param_1 + 0x410),*piVar3,&DAT_10042aa8,iVar7);
      if (iVar5 < 0) {
        iVar5 = 0;
      }
      if (iVar5 != iVar7) {
        _Size = iVar7 - iVar5;
        local_8 = (undefined4 *)_malloc(_Size);
        puVar8 = (undefined4 *)(&DAT_10042aa8 + iVar5);
        puVar9 = local_8;
        for (uVar6 = _Size >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
          *puVar9 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar9 = puVar9 + 1;
        }
        for (uVar6 = _Size & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
          *(undefined1 *)puVar9 = *(undefined1 *)puVar8;
          puVar8 = (undefined4 *)((int)puVar8 + 1);
          puVar9 = (undefined4 *)((int)puVar9 + 1);
        }
        piVar3[0x16] = (int)local_8;
        piVar3[0x14] = 0;
        piVar3[0x15] = _Size;
LAB_100102c4:
        piVar3[0x16] = (int)local_8;
        return 0;
      }
      local_c = local_c - iVar7;
      if ((piVar3[0x12] == 0) || (local_c < 0)) goto LAB_100102c4;
      piVar3[0x16] = (int)&DAT_10042ab4;
      piVar3[0x15] = 0xfff4;
    }
    param_2 = (int *)((int)param_2 + 1);
  } while( true );
}



int __cdecl FUN_100102e0(int param_1)

{
  int iVar1;
  uint uVar2;
  char *pcVar3;
  
  uVar2 = 0;
  pcVar3 = (char *)(param_1 + 0x460);
  do {
    if (*pcVar3 == '\0') {
      iVar1 = uVar2 * 0x74 + 0x43c + param_1;
      *(undefined1 *)(iVar1 + 0x24) = 0x2a;
      *(undefined1 *)(iVar1 + 0x25) = 0;
      *(undefined4 *)(iVar1 + 0x1c) = 1;
      *(undefined4 *)(iVar1 + 0x20) = 0;
      return iVar1;
    }
    uVar2 = uVar2 + 1;
    pcVar3 = pcVar3 + 0x74;
  } while (uVar2 < 8);
  return 0;
}



void FUN_10010330(void *param_1)

{
  int iVar1;
  int *piVar2;
  byte *unaff_EDI;
  uint *puVar3;
  
  FUN_100123b0(*(char **)((int)param_1 + 0xce4),"~Server beginning shutdown",unaff_EDI);
  piVar2 = (int *)((int)param_1 + 0x498);
  iVar1 = 8;
  do {
    if ((piVar2[-0x17] != 0) && (*piVar2 != 0)) {
      FUN_100123b0(*(char **)((int)param_1 + 0xce4),"~Destroying %s",(byte *)(piVar2 + -0xe));
      (*(code *)*piVar2)(piVar2[-0x17]);
    }
    piVar2 = piVar2 + 0x1d;
    iVar1 = iVar1 + -1;
  } while (iVar1 != 0);
  _free(*(void **)((int)param_1 + 0xd0c));
  if (*(void **)((int)param_1 + 0x410) != (void *)0x0) {
    FUN_1002a370(*(void **)((int)param_1 + 0x410));
    *(undefined4 *)((int)param_1 + 0x410) = 0;
  }
  if (*(void **)((int)param_1 + 0xc) != (void *)0x0) {
    _free(*(void **)((int)param_1 + 0xc));
    *(undefined4 *)((int)param_1 + 0xc) = 0;
  }
  FUN_1001c2f0(*(uint **)((int)param_1 + 0xce0));
  puVar3 = *(uint **)((int)param_1 + 0xcdc);
  FUN_1001c2f0(puVar3);
  FUN_100123b0(*(char **)((int)param_1 + 0xce4),"~Shutdown complete",(byte *)puVar3);
  FUN_10012570(*(char **)((int)param_1 + 0xce4));
  FUN_1001a340();
  _free(param_1);
  _fflush((FILE *)&DAT_100415a0);
  return;
}



void __cdecl FUN_10010420(int param_1,byte *param_2)

{
  uint *puVar1;
  
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x43c))) {
    *(undefined4 *)(param_1 + 0x444) = 1;
  }
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x4b0))) {
    *(undefined4 *)(param_1 + 0x4b8) = 1;
  }
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x524))) {
    *(undefined4 *)(param_1 + 0x52c) = 1;
  }
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x598))) {
    *(undefined4 *)(param_1 + 0x5a0) = 1;
  }
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x60c))) {
    *(undefined4 *)(param_1 + 0x614) = 1;
  }
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x680))) {
    *(undefined4 *)(param_1 + 0x688) = 1;
  }
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x6f4))) {
    *(undefined4 *)(param_1 + 0x6fc) = 1;
  }
  if ((param_2 == (byte *)0x0) || (param_2 == *(byte **)(param_1 + 0x768))) {
    *(undefined4 *)(param_1 + 0x770) = 1;
  }
  FUN_1001c2f0(*(uint **)(param_1 + 0xce0));
  puVar1 = FUN_1001bef0();
  *(uint **)(param_1 + 0xce0) = puVar1;
  FUN_1001c000(puVar1,param_1 + 0x7dc,(char *)(param_1 + 0x8dc));
  FUN_100123b0(*(char **)(param_1 + 0xce4),"~Server starting reload of service %08x",param_2);
  return;
}



void __cdecl FUN_10010510(int param_1)

{
  *(undefined4 *)(param_1 + 0x414) = 0xffffffff;
  return;
}



uint __cdecl FUN_10010520(uint *param_1,int param_2)

{
  uint uVar1;
  int *piVar2;
  int iVar3;
  
  uVar1 = 0;
  if (param_2 == 0x63757272) {
    iVar3 = 0;
    if (0 < (int)param_1[2]) {
      piVar2 = (int *)(param_1[3] + 0xc);
      do {
        if (*piVar2 != 0) {
          uVar1 = uVar1 + 1;
        }
        iVar3 = iVar3 + param_1[1];
        piVar2 = (int *)((int)piVar2 + param_1[1]);
      } while (iVar3 < (int)param_1[2]);
    }
  }
  else {
    if (param_2 == 0x6d61786d) {
      return *param_1;
    }
    if (param_2 == 0x61646472) {
      uVar1 = FUN_1002a3e0((uint *)param_1[0x104],0x61646472);
      return uVar1;
    }
    if (param_2 == 0x706f7274) {
      uVar1 = FUN_1002a3e0((uint *)param_1[0x104],0x706f7274);
      return uVar1;
    }
  }
  return uVar1;
}



undefined4 * __cdecl FUN_100105b0(int param_1,int param_2,int param_3)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int *piVar3;
  uint uVar4;
  uint uVar5;
  undefined4 *puVar6;
  
  puVar1 = (undefined4 *)0x0;
  if (param_3 == 0) {
    *(undefined4 *)(param_2 + 0x84) = 0;
    return puVar1;
  }
  uVar5 = 0;
  piVar3 = (int *)(param_1 + 0x43c);
  do {
    if (*piVar3 == param_3) {
      if ((*(int **)(param_2 + 0x84) == (int *)0x0) || (*(int **)(param_2 + 0x84) == piVar3)) {
        *(int **)(param_2 + 0x84) = piVar3;
        uVar2 = FUN_1002ab30(*(int *)(param_1 + 0x410));
        *(undefined4 *)(param_2 + 0x30) = uVar2;
        uVar4 = *(int *)(param_1 + 4) - 0x8c;
        puVar1 = (undefined4 *)(param_2 + 0x8c);
        puVar6 = puVar1;
        for (uVar5 = uVar4 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        }
        for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
          *(undefined1 *)puVar6 = 0;
          puVar6 = (undefined4 *)((int)puVar6 + 1);
        }
      }
      return puVar1;
    }
    uVar5 = uVar5 + 1;
    piVar3 = piVar3 + 0x1d;
  } while (uVar5 < 8);
  return puVar1;
}



void __cdecl FUN_10010640(int param_1,int param_2,int param_3)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = (int *)(param_1 + 0x43c);
  do {
    if (*piVar2 == param_2) {
      piVar2[1] = param_3;
      return;
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 0x1d;
  } while (uVar1 < 8);
  return;
}



void __cdecl FUN_10010670(uint *param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *param_1;
  uVar2 = *(int *)(param_2 + 8) + uVar1;
  if (0x7effffff < uVar2) {
    uVar2 = uVar2 % uVar1 + uVar1;
  }
  *(uint *)(param_2 + 8) = uVar2;
  return;
}



uint __cdecl FUN_100106a0(uint *param_1,uint param_2)

{
  int iVar1;
  
  iVar1 = (param_2 % *param_1) * param_1[1];
  return (param_2 != *(uint *)(iVar1 + 8 + param_1[3])) - 1 & iVar1 + param_1[3];
}



uint __cdecl FUN_100106d0(uint *param_1,uint param_2)

{
  int iVar1;
  
  iVar1 = (param_2 % *param_1) * param_1[1];
  return (param_2 != *(uint *)(iVar1 + 4 + param_1[3])) - 1 & iVar1 + param_1[3];
}



uint __cdecl FUN_10010700(uint *param_1)

{
  bool bVar1;
  char cVar2;
  uint uVar3;
  undefined4 uVar4;
  uint uVar5;
  uint *puVar6;
  undefined3 extraout_var;
  int iVar7;
  byte *pbVar8;
  int *piVar9;
  byte *unaff_EDI;
  uint local_8;
  
  local_8 = 0;
  bVar1 = false;
  FUN_10005420();
  if (param_1[0x104] == 0) {
    if ((char *)param_1[0x339] != (char *)0x0) {
      FUN_100123b0((char *)param_1[0x339],"~ServerUpdate: network startup failed",unaff_EDI);
    }
    _fprintf((FILE *)&DAT_100415c0,"ServerUpdate: network startup failed\n");
    return 0xffffffff;
  }
  uVar3 = FUN_1002ab30(param_1[0x104]);
  uVar4 = FUN_1002aae0(param_1[0x104]);
  puVar6 = param_1 + 0x10f;
  iVar7 = 8;
  do {
    if ((*puVar6 != 0) && ((code *)puVar6[0x18] != (code *)0x0)) {
      (*(code *)puVar6[0x18])(*puVar6,uVar3,uVar4);
    }
    puVar6 = puVar6 + 0x1d;
    iVar7 = iVar7 + -1;
  } while (iVar7 != 0);
  if (uVar3 != param_1[0x106] && -1 < (int)(uVar3 - param_1[0x106])) {
    param_1[0x106] = param_1[0x33a] + uVar3;
    bVar1 = true;
    if (((uint *)param_1[0x338] != (uint *)0x0) &&
       (uVar5 = FUN_1001c250((uint *)param_1[0x338]), uVar5 != 1)) {
      uVar5 = FUN_1001c250((uint *)param_1[0x337]);
      if (uVar5 == 0) {
        FUN_1001c2f0((uint *)param_1[0x337]);
        param_1[0x337] = param_1[0x338];
        param_1[0x338] = 0;
        FUN_1000f5d0();
      }
      else {
        puVar6 = FUN_1001c190((uint *)param_1[0x338]);
        FUN_100123b0((char *)param_1[0x339],"~ServerReconfig: config load failed [%s]",
                     (byte *)puVar6);
        uVar5 = FUN_1001c2f0((uint *)param_1[0x338]);
        param_1[0x338] = uVar5;
      }
    }
    FUN_100122c0((char *)param_1[0x339]);
    if (param_1[0x105] != 0) {
      return param_1[0x105];
    }
  }
  pbVar8 = (byte *)0x0;
  if (0 < (int)*param_1) {
    do {
      piVar9 = (int *)(param_1[1] * (int)pbVar8 + param_1[3]);
      if (*(byte **)(param_1[1] * (int)pbVar8 + param_1[3]) != pbVar8) {
        FUN_100123b0((char *)param_1[0x339],"~%d: index field corrupted\n",pbVar8);
      }
      if ((piVar9[3] != 0) || (bVar1)) {
        puVar6 = (uint *)FUN_1002a6f0((int *)param_1[0x104],(int)pbVar8,0xffff);
        if (puVar6 != (uint *)0x0) {
          local_8 = local_8 + 1;
          iVar7 = FUN_1000f6a0(param_1,puVar6);
          if (iVar7 < 1) goto LAB_100109ec;
        }
        if ((piVar9[3] == -1) ||
           (((piVar9[3] == -2 && (piVar9[0x16] == 0)) && (piVar9[0xe] <= piVar9[0xd])))) {
          FUN_1002a7a0((int *)param_1[0x104],(int)pbVar8);
          piVar9[3] = 0;
        }
        if (piVar9[3] != 0) {
          iVar7 = 0;
          if (piVar9[0xd] < piVar9[0xe]) {
LAB_100109a1:
            if (piVar9[0x16] != 0) goto LAB_100109a8;
LAB_100109be:
            if (piVar9[0xd] < piVar9[0xe]) {
              FUN_10010010((void *)piVar9[0xd],(int)param_1,piVar9,uVar3);
            }
          }
          else {
            if (piVar9[0x16] == 0) {
              if (((piVar9[0x1d] != 0) && (piVar9[0x1b] == piVar9[0x1c])) &&
                 ((piVar9[0x21] == 0 || (-1 < *(int *)(piVar9[0x21] + 4))))) {
                cVar2 = FUN_1000fb50((int)param_1,piVar9,uVar3);
                iVar7 = CONCAT31(extraout_var,cVar2);
              }
              if (piVar9[8] == 0) {
                if (piVar9[0x16] != 0) goto LAB_100109a8;
                if ((piVar9[0x21] != 0) && (*(int *)(piVar9[0x21] + 0x6c) != 0)) {
                  FUN_100100c0((int)param_1,piVar9,uVar3);
                }
              }
              goto LAB_100109a1;
            }
LAB_100109a8:
            FUN_1000ff40((int)param_1,piVar9,uVar3);
            if (piVar9[0x16] == 0) goto LAB_100109be;
          }
          if (((1 < iVar7) && (piVar9[0x21] != 0)) && (0 < *(int *)(piVar9[0x21] + 4))) {
            pbVar8 = pbVar8 + -1;
          }
        }
      }
LAB_100109ec:
      pbVar8 = pbVar8 + 1;
    } while ((int)pbVar8 < (int)*param_1);
  }
  return local_8;
}



void FUN_10010a10(int param_1,SOCKET *param_2)

{
  FUN_1002ada0(*(int *)(param_1 + 0x410),param_2);
  return;
}



char * __cdecl
FUN_10010a30(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4,char *param_5,
            char *param_6)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  char *pcVar10;
  undefined4 local_c;
  undefined4 local_8;
  undefined4 local_4;
  
  if ((int)param_6 < 0) {
    pcVar3 = param_5;
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    param_6 = pcVar3 + (1 - (int)(param_5 + 1));
  }
  pcVar3 = (char *)0x0;
  if (param_2 != 0) {
    pcVar3 = param_6 + 0xc;
    if (*(int *)(param_2 + 0x38) <= *(int *)(param_2 + 0x34)) {
      *(undefined4 *)(param_2 + 0x38) = 0;
      *(undefined4 *)(param_2 + 0x34) = 0;
    }
    iVar7 = *(int *)(param_2 + 0x3c) - *(int *)(param_2 + 0x38);
    if ((iVar7 < (int)pcVar3) && (iVar2 = *(int *)(param_2 + 0x34), (int)pcVar3 <= iVar7 + iVar2)) {
      uVar5 = *(int *)(param_2 + 0x38) - iVar2;
      puVar4 = (undefined4 *)((int)*(undefined4 **)(param_2 + 0x40) + iVar2);
      puVar8 = *(undefined4 **)(param_2 + 0x40);
      for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *puVar8 = *puVar4;
        puVar4 = puVar4 + 1;
        puVar8 = puVar8 + 1;
      }
      for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
        *(undefined1 *)puVar8 = *(undefined1 *)puVar4;
        puVar4 = (undefined4 *)((int)puVar4 + 1);
        puVar8 = (undefined4 *)((int)puVar8 + 1);
      }
      *(int *)(param_2 + 0x38) = *(int *)(param_2 + 0x38) - *(int *)(param_2 + 0x34);
      *(undefined4 *)(param_2 + 0x34) = 0;
    }
    iVar7 = *(int *)(param_2 + 0x38);
    if (*(int *)(param_2 + 0x3c) - iVar7 < (int)pcVar3) {
      iVar2 = *(int *)(param_2 + 0x34);
      puVar4 = (undefined4 *)_malloc((size_t)(pcVar3 + (iVar7 - iVar2) + 0x8000));
      if (puVar4 == (undefined4 *)0x0) {
        return (char *)0xffffffff;
      }
      if (0 < *(int *)(param_2 + 0x38)) {
        uVar5 = *(int *)(param_2 + 0x38) - *(int *)(param_2 + 0x34);
        puVar8 = (undefined4 *)(*(int *)(param_2 + 0x40) + *(int *)(param_2 + 0x34));
        puVar9 = puVar4;
        for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
          *puVar9 = *puVar8;
          puVar8 = puVar8 + 1;
          puVar9 = puVar9 + 1;
        }
        for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
          *(undefined1 *)puVar9 = *(undefined1 *)puVar8;
          puVar8 = (undefined4 *)((int)puVar8 + 1);
          puVar9 = (undefined4 *)((int)puVar9 + 1);
        }
        *(int *)(param_2 + 0x38) = *(int *)(param_2 + 0x38) - *(int *)(param_2 + 0x34);
        *(undefined4 *)(param_2 + 0x34) = 0;
      }
      if (*(void **)(param_2 + 0x40) != (void *)0x0) {
        _free(*(void **)(param_2 + 0x40));
        *(undefined4 *)(param_2 + 0x40) = 0;
      }
      *(undefined4 **)(param_2 + 0x40) = puVar4;
      *(char **)(param_2 + 0x3c) = pcVar3 + (iVar7 - iVar2) + 0x8000;
    }
    local_c = CONCAT13((char)param_3,
                       CONCAT12((char)((uint)param_3 >> 8),
                                CONCAT11((char)((uint)param_3 >> 0x10),(char)((uint)param_3 >> 0x18)
                                        )));
    local_8._0_2_ = CONCAT11((char)((uint)param_4 >> 0x10),(char)((uint)param_4 >> 0x18));
    local_8 = CONCAT13((char)param_4,CONCAT12((char)((uint)param_4 >> 8),(undefined2)local_8));
    puVar4 = (undefined4 *)(*(int *)(param_2 + 0x40) + *(int *)(param_2 + 0x38));
    local_4._0_2_ = CONCAT11((char)((uint)pcVar3 >> 0x10),(char)((uint)pcVar3 >> 0x18));
    *puVar4 = local_c;
    puVar4[1] = local_8;
    local_4 = CONCAT13((char)pcVar3,CONCAT12((char)((uint)pcVar3 >> 8),(undefined2)local_4));
    puVar4[2] = local_4;
    pcVar10 = (char *)(*(int *)(param_2 + 0x40) + 0xc + *(int *)(param_2 + 0x38));
    for (uVar6 = (uint)param_6 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)pcVar10 = *(undefined4 *)param_5;
      param_5 = param_5 + 4;
      pcVar10 = pcVar10 + 4;
    }
    for (uVar6 = (uint)param_6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
      *pcVar10 = *param_5;
      param_5 = param_5 + 1;
      pcVar10 = pcVar10 + 1;
    }
    *(int *)(param_2 + 0x38) = (int)(pcVar3 + *(int *)(param_2 + 0x38));
    *(undefined4 *)(param_2 + 0x44) = 0;
  }
  return pcVar3;
}



undefined1 * __cdecl FUN_10010c00(int param_1,char *param_2)

{
  undefined1 *puVar1;
  
  puVar1 = FUN_1001c1e0(*(uint **)(param_1 + 0xcdc),param_2);
  if (puVar1 == (undefined1 *)0x0) {
    puVar1 = &DAT_10039247;
  }
  return puVar1;
}



void __cdecl FUN_10010c30(int param_1,undefined1 param_2)

{
  *(undefined1 *)(param_1 + 0x88) = param_2;
  return;
}



undefined4 * __cdecl FUN_10010e80(byte *param_1,byte *param_2)

{
  char *pcVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  
  FUN_10001ff0(9);
  puVar2 = (undefined4 *)_malloc(0xd34);
  puVar3 = puVar2;
  for (iVar4 = 0x34d; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  if (param_1 != (byte *)0x0) {
    FUN_10002620((byte *)(puVar2 + 4),0x400,(byte *)"VERSION",param_1);
  }
  if (param_2 != (byte *)0x0) {
    FUN_10002620((byte *)(puVar2 + 4),0x400,(byte *)"PARAM",param_2);
  }
  puVar3 = (undefined4 *)FUN_100102e0((int)puVar2);
  *puVar3 = puVar2;
  puVar3[8] = 1;
  puVar3[7] = 1;
  pcVar1 = (char *)(puVar3 + 9);
  pcVar1[0] = 's';
  pcVar1[1] = 'e';
  pcVar1[2] = 'r';
  pcVar1[3] = 'v';
  *(undefined2 *)(puVar3 + 10) = 0x7265;
  *(undefined1 *)((int)puVar3 + 0x2a) = 0;
  puVar3[0x11] = 0x20544547;
  puVar3[0x12] = 0x2f76732f;
  *(undefined1 *)(puVar3 + 0x13) = 0;
  puVar3[0x1a] = &LAB_10010e60;
  FUN_1001a300();
  return puVar2;
}



undefined4 __cdecl FUN_10010f50(int *param_1,char *param_2,char *param_3)

{
  char cVar1;
  char *pcVar2;
  uint *puVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  int *piVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  void *pvVar10;
  uint uVar11;
  byte *unaff_EDI;
  uint uVar12;
  undefined2 uVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  char local_200 [256];
  byte local_100 [256];
  
  pcVar2 = param_2;
  do {
    cVar1 = *pcVar2;
    pcVar2[(int)(param_1 + 0x1f7) - (int)param_2] = cVar1;
    pcVar2 = pcVar2 + 1;
  } while (cVar1 != '\0');
  FUN_10002230((char *)(param_1 + 0x237),0x400,param_3);
  puVar3 = FUN_1001bef0();
  param_1[0x337] = (int)puVar3;
  FUN_1001c000(puVar3,param_1 + 0x1f7,(char *)(param_1 + 0x237));
  FUN_1001c0e0((uint *)param_1[0x337]);
  pbVar4 = FUN_1001c1e0((uint *)param_1[0x337],"");
  if ((pbVar4 == (byte *)0x0) || (*pbVar4 == 0)) {
    puVar3 = FUN_1001c190((uint *)param_1[0x337]);
    __snprintf(local_200,0x100,"ServerConfig: config load failed: %s [%s]",param_2,puVar3);
    _fprintf((FILE *)&DAT_100415c0,"%s\n",local_200);
    MessageBoxA((HWND)0x0,local_200,"Config Load Error",0);
    uVar9 = 1;
  }
  else {
    iVar17 = 0x2000;
    pbVar5 = FUN_10002000(pbVar4,(byte *)"LOGBUFFERSIZE");
    iVar17 = FUN_10002e80(pbVar5,iVar17);
    iVar18 = 0x100000;
    pbVar5 = FUN_10002000(pbVar4,(byte *)"LOGSIZE");
    iVar18 = FUN_10002e80(pbVar5,iVar18);
    pcVar2 = "$stderr;";
    iVar16 = 0x100;
    pbVar5 = local_100;
    pbVar6 = FUN_10002000(pbVar4,(byte *)"LOGFILE");
    FUN_100030f0(pbVar6,pbVar5,iVar16,(byte *)pcVar2);
    pbVar5 = local_100;
    pcVar2 = FUN_10012190((char *)pbVar5,iVar17,iVar18);
    param_1[0x339] = (int)pcVar2;
    FUN_100123b0(pcVar2,"~Server performing startup",pbVar5);
    iVar17 = 0x1130;
    pbVar5 = FUN_10002000(pbVar4,(byte *)"RXLEN");
    iVar17 = FUN_10002e80(pbVar5,iVar17);
    if (iVar17 < 0x1130) {
      iVar17 = 0x1130;
    }
    iVar18 = 10;
    pbVar5 = FUN_10002000(pbVar4,(byte *)"RXDEL");
    iVar18 = FUN_10002e80(pbVar5,iVar18);
    iVar16 = 8;
    pbVar5 = FUN_10002000(pbVar4,(byte *)"PERIP");
    iVar16 = FUN_10002e80(pbVar5,iVar16);
    iVar15 = 0x80;
    pbVar5 = FUN_10002000(pbVar4,(byte *)"SIMUL");
    iVar15 = FUN_10002e80(pbVar5,iVar15);
    iVar14 = 0x26ac;
    pbVar5 = FUN_10002000(pbVar4,&DAT_10039210);
    iVar14 = FUN_10002e80(pbVar5,iVar14);
    uVar13 = (undefined2)iVar14;
    uVar12 = 0;
    pbVar5 = FUN_10002000(pbVar4,&DAT_10039d3c);
    uVar12 = FUN_10002f10(pbVar5,uVar12);
    piVar7 = FUN_1002ab70(uVar12,uVar13,iVar15,iVar17,iVar16,iVar18);
    param_1[0x104] = (int)piVar7;
    if (piVar7 == (int *)0x0) {
      FUN_100123b0((char *)param_1[0x339],"~ServerConfig: network startup failed",unaff_EDI);
      _fprintf((FILE *)&DAT_100415c0,"ServerConfig: network startup failed\n");
      return 2;
    }
    iVar17 = 0x32;
    pbVar5 = FUN_10002000(pbVar4,(byte *)"SLOWIDLE");
    iVar17 = FUN_10002e80(pbVar5,iVar17);
    param_1[0x33a] = iVar17;
    pbVar5 = (byte *)(param_1 + 4);
    uVar12 = FUN_1002a3e0((uint *)param_1[0x104],0x61646472);
    FUN_10002490(pbVar5,0x400,&DAT_10039d3c,uVar12);
    uVar12 = FUN_1002a3e0((uint *)param_1[0x104],0x706f7274);
    FUN_10002310(pbVar5,0x400,&DAT_10039210,uVar12);
    uVar12 = FUN_1002a3e0((uint *)param_1[0x104],0x73696d75);
    FUN_10002310(pbVar5,0x400,(byte *)"SIMUL",uVar12);
    uVar12 = FUN_1002a3e0((uint *)param_1[0x104],0x70657269);
    FUN_10002310(pbVar5,0x400,(byte *)"PERIP",uVar12);
    iVar17 = FUN_1002ab30(param_1[0x104]);
    FUN_10002310(pbVar5,0x400,(byte *)"STARTUP",iVar17);
    iVar17 = 0;
    if (0 < param_1[0x115]) {
      iVar17 = param_1[0x115];
    }
    if (iVar17 < param_1[0x132]) {
      iVar17 = param_1[0x132];
    }
    if (iVar17 < param_1[0x14f]) {
      iVar17 = param_1[0x14f];
    }
    if (iVar17 < param_1[0x16c]) {
      iVar17 = param_1[0x16c];
    }
    if (iVar17 < param_1[0x189]) {
      iVar17 = param_1[0x189];
    }
    if (iVar17 < param_1[0x1a6]) {
      iVar17 = param_1[0x1a6];
    }
    if (iVar17 < param_1[0x1c3]) {
      iVar17 = param_1[0x1c3];
    }
    if (iVar17 < param_1[0x1e0]) {
      iVar17 = param_1[0x1e0];
    }
    pbVar5 = (byte *)FUN_1002a3e0((uint *)param_1[0x104],0x73696d75);
    *param_1 = (int)pbVar5;
    param_1[1] = iVar17 + 0x8c;
    param_1[2] = (iVar17 + 0x8c) * (int)pbVar5;
    FUN_100123b0((char *)param_1[0x339],"~ServerConfig: Allocating %d sessions (%d bytes each)",
                 pbVar5);
    puVar8 = (undefined4 *)_malloc(param_1[1] * *param_1);
    param_1[3] = (int)puVar8;
    if (puVar8 != (undefined4 *)0x0) {
      uVar11 = param_1[1] * *param_1;
      for (uVar12 = uVar11 >> 2; uVar12 != 0; uVar12 = uVar12 - 1) {
        *puVar8 = 0;
        puVar8 = puVar8 + 1;
      }
      for (uVar11 = uVar11 & 3; uVar11 != 0; uVar11 = uVar11 - 1) {
        *(undefined1 *)puVar8 = 0;
        puVar8 = (undefined4 *)((int)puVar8 + 1);
      }
      iVar17 = 0;
      if (0 < param_1[2]) {
        iVar18 = param_1[1];
        do {
          piVar7 = (int *)(param_1[3] + iVar17);
          *piVar7 = iVar17 / iVar18;
          iVar18 = iVar17 / iVar18 + *param_1;
          piVar7[1] = iVar18;
          piVar7[2] = iVar18;
          iVar18 = param_1[1];
          iVar17 = iVar17 + iVar18;
        } while (iVar17 < param_1[2]);
      }
      pvVar10 = _malloc(*param_1 * 0x20c);
      param_1[0x343] = (int)pvVar10;
      iVar17 = 0;
      pbVar5 = (byte *)(param_1 + 0x118);
      do {
        if (param_1[0x105] != 0) break;
        if (*pbVar5 != 0) {
          iVar18 = 0;
          pbVar6 = FUN_10002000(pbVar4,pbVar5);
          iVar18 = FUN_10002e80(pbVar6,iVar18);
          if (iVar18 != 0) {
            if (*(int *)(pbVar5 + 0x30) != 0) {
              FUN_100123b0((char *)param_1[0x339],"~Creating %s",pbVar5);
              uVar9 = (**(code **)(pbVar5 + 0x30))
                                (param_1,param_1[0x339],param_1[0x337],pbVar4,param_1 + 4);
              *(undefined4 *)(pbVar5 + -0x24) = uVar9;
            }
            if ((*(int *)(pbVar5 + 0x34) != 0) && (*(int *)(pbVar5 + -0x24) != 0)) {
              FUN_100123b0((char *)param_1[0x339],"~Configuring %s",pbVar5);
              (**(code **)(pbVar5 + 0x34))
                        (*(undefined4 *)(pbVar5 + -0x24),param_1[0x337],pbVar4,param_1 + 4);
            }
            if (*(int *)(pbVar5 + -0x18) == 0) {
              pbVar5[-0xffffffff00000018] = 0;
              pbVar5[-0xffffffff00000017] = 0x10;
              pbVar5[-0xffffffff00000016] = 0;
              pbVar5[-0xffffffff00000015] = 0;
            }
            if (*(int *)(pbVar5 + -0x14) == 0) {
              pbVar5[-0xffffffff00000014] = 0;
              pbVar5[-0xffffffff00000013] = 0x20;
              pbVar5[-0xffffffff00000012] = 0;
              pbVar5[-0xffffffff00000011] = 0;
            }
            if (*(int *)(pbVar5 + -0x10) == 0) {
              pbVar5[-0xffffffff00000010] = 0x19;
              pbVar5[-0xffffffff0000000f] = 0;
              pbVar5[-0xffffffff0000000e] = 0;
              pbVar5[-0xffffffff0000000d] = 0;
            }
          }
        }
        iVar17 = iVar17 + 1;
        pbVar5 = pbVar5 + 0x74;
      } while (iVar17 < 8);
      pbVar6 = &DAT_10039247;
      iVar17 = 0x20;
      pbVar5 = (byte *)(param_1 + 0x107);
      pbVar4 = FUN_10002000(pbVar4,(byte *)"CRASH");
      FUN_100030f0(pbVar4,pbVar5,iVar17,pbVar6);
      if (param_1[0x105] == 0) {
        FUN_100123b0((char *)param_1[0x339],"~Server ready for %d connections",(byte *)*param_1);
      }
      FUN_1000f3b0((int)param_1);
      return 0;
    }
    _fprintf((FILE *)&DAT_100415c0,"ServerConfig: failed to allocate session memory (%d*%d)\n",
             *param_1,param_1[1]);
    uVar9 = 3;
  }
  param_1[0x105] = -1;
  return uVar9;
}



undefined4 * __cdecl FUN_10011500(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)_malloc(0xf8);
  puVar2 = puVar1;
  for (iVar3 = 0x3e; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *puVar1 = param_1;
  puVar2 = FUN_1001c350(1,1,1000,0x20,0,0x10);
  puVar1[1] = puVar2;
  DAT_10052ab4 = param_1;
  return puVar1;
}



void __cdecl FUN_10011550(void *param_1)

{
  FUN_1001c510(*(void **)((int)param_1 + 4));
  _free(param_1);
  DAT_10052ab4 = 0;
  return;
}



undefined4 __cdecl FUN_10011580(int param_1,int param_2)

{
  undefined4 uVar1;
  
  uVar1 = 0;
  if ((-1 < param_2) && (param_2 < 1)) {
    uVar1 = *(undefined4 *)(param_1 + 4 + param_2 * 4);
  }
  return uVar1;
}



undefined4 FUN_100115d0(void)

{
  return 1;
}



undefined4 FUN_100116e0(void)

{
  return 0xffffffff;
}



undefined * FUN_100116f0(void)

{
  return &DAT_1003bb0c;
}



void __cdecl FUN_10011700(undefined4 param_1,byte *param_2,undefined4 param_3,int param_4)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar3 = -1;
  pbVar1 = FUN_10002000(param_2,&DAT_1003bb28);
  iVar3 = FUN_10002e80(pbVar1,iVar3);
  iVar4 = 1000;
  pbVar1 = FUN_10002000(param_2,(byte *)"RRANGE");
  iVar4 = FUN_10002e80(pbVar1,iVar4);
  iVar5 = 100;
  pbVar1 = FUN_10002000(param_2,&DAT_1003bb1c);
  iVar5 = FUN_10002e80(pbVar1,iVar5);
  *(undefined4 *)(param_4 + 0x180) = 0;
  *(undefined4 *)(param_4 + 0x188) = 3;
  if (iVar3 == -1) {
    *(undefined4 *)(param_4 + 0x18c) = 3;
    *(undefined4 *)(param_4 + 400) = 3;
  }
  else {
    iVar2 = iVar3 - iVar4;
    if (iVar2 < 1) {
      iVar2 = 1;
    }
    *(uint *)(param_4 + 0x18c) = iVar2 << 3 | 3;
    *(uint *)(param_4 + 400) = (iVar4 + iVar3) * 8 | 2;
  }
  if (-1 < iVar5) {
    if (100 < iVar5) {
      iVar5 = 100;
    }
    *(uint *)(param_4 + 0x194) = iVar5 << 3 | 2;
  }
  return;
}



undefined4 FUN_100117d0(void)

{
  return 0;
}



undefined1 FUN_100117e0(void)

{
  return 0;
}



void __fastcall FUN_10011870(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  
  iVar2 = *(int *)(param_2 + 0x28);
  if ((*(int *)(iVar2 + 0x18) != 0) && (iVar3 = 0, *(int *)(iVar2 + 0x19c) != 0)) {
    iVar1 = 0;
    do {
      iVar4 = *(int *)(iVar1 + iVar2);
      if (*(int *)(*(int *)(param_2 + 0x28) + 8 + iVar1) <=
          *(int *)(*(int *)(param_2 + 0x28) + iVar1)) {
        iVar4 = iVar4 + 999999;
      }
      iVar2 = *(int *)(iVar1 + 0x184 + iVar2);
      if (*(int *)(*(int *)(param_2 + 0x28) + iVar1 + 0x18c) <=
          *(int *)(*(int *)(param_2 + 0x28) + 0x184 + iVar1)) {
        iVar2 = iVar2 + 999999;
      }
      if (iVar2 < iVar4) {
        puVar6 = (undefined4 *)(iVar1 + *(int *)(param_2 + 0x28));
        puVar5 = (undefined4 *)
                 (*(int *)(param_2 + 0x20) * 0x184 + -0x184 + *(int *)(param_2 + 0x28));
        for (iVar2 = 0x61; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar5 = *puVar6;
          puVar6 = puVar6 + 1;
          puVar5 = puVar5 + 1;
        }
        puVar6 = (undefined4 *)(iVar1 + *(int *)(param_2 + 0x28));
        puVar5 = puVar6 + 0x61;
        for (iVar2 = 0x61; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar6 = *puVar5;
          puVar5 = puVar5 + 1;
          puVar6 = puVar6 + 1;
        }
        puVar6 = (undefined4 *)
                 (*(int *)(param_2 + 0x20) * 0x184 + -0x184 + *(int *)(param_2 + 0x28));
        puVar5 = (undefined4 *)(iVar1 + 0x184 + *(int *)(param_2 + 0x28));
        for (iVar2 = 0x61; iVar2 != 0; iVar2 = iVar2 + -1) {
          *puVar5 = *puVar6;
          puVar6 = puVar6 + 1;
          puVar5 = puVar5 + 1;
        }
        if ((0 < iVar3) &&
           (*(int *)(*(int *)(param_2 + 0x28) + iVar1) <
            *(int *)(*(int *)(param_2 + 0x28) + -0x184 + iVar1))) {
          iVar3 = iVar3 + -2;
          iVar1 = iVar1 + -0x308;
        }
      }
      iVar2 = *(int *)(param_2 + 0x28);
      iVar4 = iVar1 + 800;
      iVar1 = iVar1 + 0x184;
      iVar3 = iVar3 + 1;
    } while (*(int *)(iVar4 + iVar2) != 0);
  }
  return;
}



char * __cdecl FUN_10011960(char *param_1,int param_2)

{
  char *_Dest;
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  
  _Dest = (char *)_malloc(0x2c);
  _strncpy(_Dest,param_1,0x20);
  uVar3 = (param_2 + 1) * 0x184;
  _Dest[0x1f] = '\0';
  *(int *)(_Dest + 0x20) = param_2;
  puVar1 = (undefined4 *)_malloc(uVar3);
  *(undefined4 **)(_Dest + 0x28) = puVar1;
  for (uVar3 = uVar3 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar1 = 0;
    puVar1 = puVar1 + 1;
  }
  for (iVar2 = 0; iVar2 != 0; iVar2 = iVar2 + -1) {
    *(undefined1 *)puVar1 = 0;
    puVar1 = (undefined4 *)((int)puVar1 + 1);
  }
  return _Dest;
}



void __cdecl FUN_100119c0(void *param_1)

{
  if (param_1 != (void *)0x0) {
    _free(*(void **)((int)param_1 + 0x28));
  }
  _free(param_1);
  return;
}



undefined4 __cdecl FUN_100119e0(undefined4 param_1)

{
  return param_1;
}



bool __cdecl
FUN_100119f0(int param_1,int param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5,
            undefined4 param_6,undefined4 param_7,char *param_8,undefined4 param_9,
            undefined4 param_10,char *param_11,char *param_12)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  bool bVar4;
  
  iVar1 = *(int *)(param_1 + 0x20);
  iVar3 = 0;
  if (0 < iVar1) {
    piVar2 = (int *)(*(int *)(param_1 + 0x28) + 0x1c);
    do {
      if ((piVar2[-1] == 0) || (*piVar2 == param_2)) break;
      iVar3 = iVar3 + 1;
      piVar2 = piVar2 + 0x61;
    } while (iVar3 < iVar1);
  }
  if (iVar1 <= iVar3) {
    _printf("LoadBalUpdate: No room in load balancing table.  Ignoring.\n");
    return false;
  }
  iVar3 = iVar3 * 0x184;
  bVar4 = *(int *)(iVar3 + 0x18 + *(int *)(param_1 + 0x28)) == 0;
  if (bVar4) {
    *(int *)(iVar3 + 0x1c + *(int *)(param_1 + 0x28)) = param_2;
    *(undefined4 *)(iVar3 + 0x18 + *(int *)(param_1 + 0x28)) = param_3;
    *(undefined4 *)(iVar3 + 0xc + *(int *)(param_1 + 0x28)) = param_4;
    *(undefined4 *)(iVar3 + 0x19c + *(int *)(param_1 + 0x28)) = 0;
  }
  *(undefined4 *)(iVar3 + 4 + *(int *)(param_1 + 0x28)) = param_5;
  *(undefined4 *)(iVar3 + 8 + *(int *)(param_1 + 0x28)) = param_6;
  *(undefined4 *)(iVar3 + 0x14 + *(int *)(param_1 + 0x28)) = param_7;
  if (param_8 == (char *)0x0) {
    *(undefined1 *)(iVar3 + 0x24 + *(int *)(param_1 + 0x28)) = 0;
  }
  else {
    _strncpy((char *)(iVar3 + 0x24 + *(int *)(param_1 + 0x28)),param_8,0x20);
  }
  if (param_11 == (char *)0x0) {
    *(undefined1 *)(iVar3 + 0x44 + *(int *)(param_1 + 0x28)) = 0;
  }
  else {
    _strncpy((char *)(iVar3 + 0x44 + *(int *)(param_1 + 0x28)),param_11,0x100);
  }
  if (param_12 == (char *)0x0) {
    *(undefined1 *)(iVar3 + 0x144 + *(int *)(param_1 + 0x28)) = 0;
  }
  else {
    _strncpy((char *)(iVar3 + 0x144 + *(int *)(param_1 + 0x28)),param_12,0x40);
  }
  *(undefined4 *)(iVar3 + 0x10 + *(int *)(param_1 + 0x28)) = param_9;
  *(undefined4 *)(iVar3 + 0x20 + *(int *)(param_1 + 0x28)) = param_10;
  if (*(int *)(iVar3 + 8 + *(int *)(param_1 + 0x28)) < 1) {
    *(undefined4 *)(iVar3 + 8 + *(int *)(param_1 + 0x28)) = 5000;
  }
  iVar1 = *(int *)(param_1 + 0x28);
  *(undefined4 *)(iVar3 + iVar1) = *(undefined4 *)(iVar3 + 4 + iVar1);
  FUN_10011870(iVar1,param_1);
  return bVar4;
}



char * __cdecl FUN_10011b60(int param_1,undefined4 param_2,int param_3,char *param_4)

{
  uint uVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  
  if (*(int *)(*(int *)(param_1 + 0x28) + 0x18) != 0) {
    iVar4 = 0;
    do {
      puVar3 = (undefined4 *)(*(int *)(param_1 + 0x28) + iVar4);
      uVar1 = puVar3[6];
      iVar2 = _sprintf(param_4,"%s %d.%d.%d.%d/%d - %d/%d/%d - %d\r\n",param_2,uVar1 >> 0x18,
                       uVar1 >> 0x10 & 0xff,uVar1 >> 8 & 0xff,(uint)*(byte *)(puVar3 + 6),puVar3[3],
                       puVar3[1],*puVar3,puVar3[2],
                       (uint)(param_3 - *(int *)(*(int *)(param_1 + 0x28) + 0x20 + iVar4)) / 1000);
      param_4 = param_4 + iVar2;
      iVar2 = iVar4 + 0x19c;
      iVar4 = iVar4 + 0x184;
    } while (*(int *)(iVar2 + *(int *)(param_1 + 0x28)) != 0);
    return param_4;
  }
  return param_4;
}



bool __cdecl FUN_10011c00(int param_1)

{
  return *(int *)(*(int *)(param_1 + 0x28) + 0x18) != 0;
}



undefined4 __cdecl FUN_10011c20(int param_1)

{
  return *(undefined4 *)(param_1 + 0x28);
}



void __cdecl FUN_10011c30(int param_1,int param_2)

{
  **(int **)(param_1 + 0x28) = **(int **)(param_1 + 0x28) + param_2;
  FUN_10011870(param_2,param_1);
  return;
}



void __cdecl FUN_10011c50(int param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar1 = -1;
  iVar3 = 0;
  if (0 < *(int *)(param_1 + 0x20)) {
    iVar4 = 0;
    do {
      if (-1 < iVar1) {
        return;
      }
      iVar2 = *(int *)(param_1 + 0x28) + iVar4;
      if ((param_2 == *(int *)(iVar2 + 0x1c)) && (param_3 == *(int *)(iVar2 + 0x18))) {
        iVar1 = iVar3;
      }
      iVar3 = iVar3 + 1;
      iVar4 = iVar4 + 0x184;
    } while (iVar3 < *(int *)(param_1 + 0x20));
  }
  return;
}



void __cdecl FUN_10011ca0(int param_1,int param_2)

{
  void *_Dst;
  
  _Dst = (void *)(param_2 * 0x184 + *(int *)(param_1 + 0x28));
  _memmove(_Dst,(void *)((int)_Dst + 0x184),(*(int *)(param_1 + 0x20) - param_2) * 0x184 - 0x184);
  return;
}



void __cdecl FUN_10011ce0(int param_1,int param_2,uint param_3)

{
  void *_Dst;
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = *(int *)(param_1 + 0x28);
  if (*(int *)(iVar1 + 0x18) != 0) {
    iVar3 = 0;
    iVar2 = 0;
    do {
      if (param_3 < (uint)(param_2 - *(int *)(iVar3 + 0x20 + iVar1))) {
        _Dst = (void *)(*(int *)(param_1 + 0x28) + iVar3);
        _memmove(_Dst,(void *)((int)_Dst + 0x184),(*(int *)(param_1 + 0x20) - iVar2) * 0x184);
      }
      else {
        iVar2 = iVar2 + 1;
        iVar3 = iVar3 + 0x184;
      }
      iVar1 = *(int *)(param_1 + 0x28);
    } while (*(int *)(iVar3 + 0x18 + iVar1) != 0);
  }
  return;
}



void __cdecl FUN_10011d90(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  if (param_1 != (undefined4 *)0x0) {
    do {
      puVar1 = (undefined4 *)param_1[3];
      do {
        puVar2 = (undefined4 *)param_1[2];
        _free((void *)*param_1);
        _free(param_1);
        param_1 = puVar2;
      } while (puVar2 != (undefined4 *)0x0);
      param_1 = puVar1;
    } while (puVar1 != (undefined4 *)0x0);
  }
  return;
}



undefined4 __cdecl FUN_10011dd0(char *param_1,char *param_2,char *param_3)

{
  char *pcVar1;
  
  pcVar1 = (char *)0x0;
  if (param_1 != (char *)0x0) {
    do {
      if ((param_1[3] == *param_2) && (param_1[4] == param_2[1])) {
        if (pcVar1 == (char *)0x0) {
          pcVar1 = param_1;
        }
        if ((*param_1 == *param_3) && (param_1[1] == param_3[1])) {
          return *(undefined4 *)(param_1 + 8);
        }
      }
      param_1 = *(char **)(param_1 + 0xc);
    } while (param_1 != (char *)0x0);
    if (pcVar1 != (char *)0x0) {
      return *(undefined4 *)(pcVar1 + 8);
    }
  }
  return 0;
}



void __cdecl FUN_10011e30(int *param_1,undefined1 *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 *puVar4;
  int iVar5;
  
  iVar5 = 0;
  iVar3 = *param_1;
  iVar2 = 0;
  while (iVar1 = iVar3, iVar1 != 0) {
    iVar5 = iVar5 + 1;
    iVar2 = iVar1;
    iVar3 = *(int *)(iVar1 + 0xc);
  }
  puVar4 = (undefined4 *)_malloc(0x10);
  if (*param_1 == 0) {
    *param_1 = (int)puVar4;
  }
  else {
    *(undefined4 **)(iVar2 + 0xc) = puVar4;
  }
  *puVar4 = 0;
  puVar4[1] = 0;
  puVar4[2] = 0;
  puVar4[3] = 0;
  puVar4[2] = iVar5;
  *(undefined1 *)((int)puVar4 + 3) = *param_2;
  *(undefined1 *)(puVar4 + 1) = param_2[1];
  *(undefined1 *)((int)puVar4 + 5) = 0;
  *(undefined1 *)puVar4 = param_2[3];
  *(undefined1 *)((int)puVar4 + 1) = param_2[4];
  *(undefined1 *)((int)puVar4 + 2) = 0;
  puVar4[3] = 0;
  return;
}



void __cdecl FUN_10011eb0(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  void *pvVar4;
  int iVar5;
  int iVar6;
  
  iVar5 = *(int *)(param_1 + 4);
  iVar6 = 0;
  if (iVar5 != 0) {
    iVar1 = *(int *)(iVar5 + 0xc);
    while (iVar1 != 0) {
      iVar5 = *(int *)(iVar5 + 0xc);
      iVar1 = *(int *)(iVar5 + 0xc);
    }
  }
  iVar1 = 0;
  for (iVar2 = iVar5; iVar2 != 0; iVar2 = *(int *)(iVar2 + 8)) {
    iVar6 = iVar6 + 1;
    iVar1 = iVar2;
  }
  piVar3 = (int *)_malloc(0x10);
  if (*(int *)(param_1 + 4) == 0) {
    iVar6 = 0;
    *(int **)(param_1 + 4) = piVar3;
  }
  else if (param_4 == 1) {
    iVar6 = 0;
    *(int **)(iVar5 + 0xc) = piVar3;
  }
  else {
    *(int **)(iVar1 + 8) = piVar3;
  }
  *piVar3 = 0;
  piVar3[1] = 0;
  piVar3[2] = 0;
  piVar3[3] = 0;
  piVar3[1] = iVar6;
  pvVar4 = _malloc(param_3 + 1);
  *piVar3 = (int)pvVar4;
  iVar5 = 0;
  if (0 < param_3) {
    do {
      *(undefined1 *)(iVar5 + *piVar3) = *(undefined1 *)(iVar5 + param_2);
      iVar5 = iVar5 + 1;
    } while (iVar5 < param_3);
  }
  *(undefined1 *)(param_3 + *piVar3) = 0;
  piVar3[3] = 0;
  piVar3[2] = 0;
  return;
}



int * __cdecl FUN_10011f70(undefined4 param_1)

{
  char cVar1;
  bool bVar2;
  char *pcVar3;
  int *piVar4;
  char *pcVar5;
  char *pcVar6;
  int iVar7;
  char *pcVar8;
  bool bVar9;
  int local_40c;
  char local_400 [1024];
  
  bVar2 = true;
  local_40c = 1;
  piVar4 = (int *)_malloc(8);
  *piVar4 = 0;
  piVar4[1] = 0;
  *piVar4 = 0;
  piVar4[1] = 0;
  pcVar5 = (char *)FUN_1002aee0(0,param_1,0);
  if (pcVar5 != (char *)0x0) {
    pcVar8 = pcVar5;
    if (*pcVar5 != '\0') {
LAB_10011fc7:
      cVar1 = *pcVar8;
      iVar7 = 0;
      if ('\x1f' < cVar1) {
        bVar9 = cVar1 == '\"';
        pcVar6 = pcVar8;
        if (bVar9) {
          pcVar8 = pcVar8 + 1;
          pcVar6 = pcVar8;
        }
        do {
          if (bVar9) {
            if ((bVar9) && (*pcVar8 == '\"')) {
              if (pcVar8[1] != '\"') goto LAB_10012006;
              pcVar8 = pcVar8 + 1;
            }
          }
          else if ((*pcVar8 < ' ') || (*pcVar8 == ',')) goto LAB_10012006;
          pcVar8 = pcVar8 + 1;
        } while( true );
      }
      if (cVar1 == '\n') {
        bVar2 = false;
        local_40c = 1;
      }
      goto LAB_10012097;
    }
LAB_100120a7:
    FUN_1002afa0(0,pcVar5);
  }
  return piVar4;
LAB_10012006:
  if ((int)pcVar8 - (int)pcVar6 < 0x400) {
    pcVar3 = local_400;
    for (; pcVar6 != pcVar8; pcVar6 = pcVar6 + 1) {
      if (((bVar9) && (*pcVar6 == '\"')) && (pcVar6[1] == '\"')) {
        pcVar6 = pcVar6 + 1;
      }
      *pcVar3 = *pcVar6;
      iVar7 = iVar7 + 1;
      pcVar3 = pcVar3 + 1;
    }
    *pcVar3 = '\0';
    if (bVar2) {
      FUN_10011e30(piVar4,local_400);
    }
    else {
      FUN_10011eb0((int)piVar4,(int)local_400,iVar7,local_40c);
      local_40c = 0;
    }
    if ((bVar9) && (*pcVar8 == '\"')) {
      pcVar8 = pcVar8 + 1;
    }
    if (*pcVar8 == ',') {
LAB_10012097:
      pcVar8 = pcVar8 + 1;
    }
  }
  if (*pcVar8 == '\0') goto LAB_100120a7;
  goto LAB_10011fc7;
}



void __cdecl FUN_100120c0(undefined4 *param_1)

{
  void *pvVar1;
  void *_Memory;
  
  _Memory = (void *)*param_1;
  while (_Memory != (void *)0x0) {
    pvVar1 = *(void **)((int)_Memory + 0xc);
    _free(_Memory);
    _Memory = pvVar1;
  }
  FUN_10011d90((undefined4 *)param_1[1]);
  _free(param_1);
  return;
}



byte * __cdecl FUN_10012100(undefined4 *param_1,byte *param_2,char *param_3,char *param_4)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  undefined4 *puVar5;
  byte *pbVar6;
  bool bVar7;
  
  puVar5 = (undefined4 *)param_1[1];
  iVar2 = FUN_10011dd0((char *)*param_1,param_3,param_4);
  do {
    if (puVar5 == (undefined4 *)0x0) {
      return param_2;
    }
    pbVar6 = (byte *)*puVar5;
    pbVar3 = param_2;
    do {
      bVar1 = *pbVar3;
      bVar7 = bVar1 < *pbVar6;
      if (bVar1 != *pbVar6) {
LAB_10012154:
        iVar4 = (1 - (uint)bVar7) - (uint)(bVar7 != 0);
        goto LAB_10012159;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar7 = bVar1 < pbVar6[1];
      if (bVar1 != pbVar6[1]) goto LAB_10012154;
      pbVar3 = pbVar3 + 2;
      pbVar6 = pbVar6 + 2;
    } while (bVar1 != 0);
    iVar4 = 0;
LAB_10012159:
    if (iVar4 == 0) {
      while (puVar5[1] != iVar2) {
        puVar5 = (undefined4 *)puVar5[2];
        if (puVar5 == (undefined4 *)0x0) {
          return param_2;
        }
      }
      if (puVar5 == (undefined4 *)0x0) {
        return param_2;
      }
      return (byte *)*puVar5;
    }
    puVar5 = (undefined4 *)puVar5[3];
  } while( true );
}



char * __cdecl FUN_10012190(char *param_1,int param_2,int param_3)

{
  char cVar1;
  char *_Str;
  char *pcVar2;
  int iVar3;
  
  if (param_2 < 0x400) {
    param_2 = 0x400;
  }
  if (param_3 < 0x400) {
    param_3 = 0x400;
  }
  _Str = (char *)_malloc(param_2 + 0x118);
  pcVar2 = _Str;
  for (iVar3 = 0x46; iVar3 != 0; iVar3 = iVar3 + -1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2 = pcVar2 + 4;
  }
  *(int *)(_Str + 0x108) = param_2;
  *(char **)(_Str + 0x10c) = _Str + 0x118;
  iVar3 = (int)_Str - (int)param_1;
  do {
    cVar1 = *param_1;
    param_1[iVar3] = cVar1;
    param_1 = param_1 + 1;
  } while (cVar1 != '\0');
  cVar1 = *_Str;
  *(int *)(_Str + 0x100) = param_3;
  while ((cVar1 == '$' && (pcVar2 = _strchr(_Str,0x3b), pcVar2 != (char *)0x0))) {
    iVar3 = _strncmp(_Str,"$stdout;",8);
    if (iVar3 == 0) {
      _Str[0x110] = '\x01';
      _Str[0x111] = '\0';
      _Str[0x112] = '\0';
      _Str[0x113] = '\0';
    }
    else {
      iVar3 = _strncmp(_Str,"$stdout+time;",0xd);
      if (iVar3 == 0) {
        _Str[0x110] = '\x02';
        _Str[0x111] = '\0';
        _Str[0x112] = '\0';
        _Str[0x113] = '\0';
      }
      else {
        iVar3 = _strncmp(_Str,"$stderr;",8);
        if (iVar3 == 0) {
          _Str[0x114] = '\x01';
          _Str[0x115] = '\0';
          _Str[0x116] = '\0';
          _Str[0x117] = '\0';
        }
        else {
          iVar3 = _strncmp(_Str,"$stderr+time;",0xd);
          if (iVar3 == 0) {
            _Str[0x114] = '\x02';
            _Str[0x115] = '\0';
            _Str[0x116] = '\0';
            _Str[0x117] = '\0';
          }
        }
      }
    }
    pcVar2 = _strchr(_Str,0x3b);
    pcVar2 = pcVar2 + 1;
    iVar3 = (int)_Str - (int)pcVar2;
    do {
      cVar1 = *pcVar2;
      pcVar2[iVar3] = cVar1;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    cVar1 = *_Str;
  }
  return _Str;
}



void __cdecl FUN_100122c0(char *param_1)

{
  if ((param_1 != (char *)0x0) && (0 < (int)*(size_t *)(param_1 + 0x104))) {
    FUN_1002afb0(0,param_1,*(char **)(param_1 + 0x10c),*(size_t *)(param_1 + 0x104),
                 *(int *)(param_1 + 0x100));
    param_1[0x104] = '\0';
    param_1[0x105] = '\0';
    param_1[0x106] = '\0';
    param_1[0x107] = '\0';
  }
  return;
}



void __cdecl FUN_10012300(char *param_1,char *param_2,uint param_3)

{
  char cVar1;
  char *pcVar2;
  uint uVar3;
  
  if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
    if ((int)param_3 < 0) {
      pcVar2 = param_2;
      do {
        cVar1 = *pcVar2;
        pcVar2 = pcVar2 + 1;
      } while (cVar1 != '\0');
      param_3 = (int)pcVar2 - (int)(param_2 + 1);
    }
    if (*(int *)(param_1 + 0x108) - *(int *)(param_1 + 0x104) < (int)param_3) {
      FUN_100122c0(param_1);
    }
    if ((int)param_3 <= *(int *)(param_1 + 0x108) - *(int *)(param_1 + 0x104)) {
      pcVar2 = (char *)(*(int *)(param_1 + 0x10c) + *(int *)(param_1 + 0x104));
      for (uVar3 = param_3 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
        *(undefined4 *)pcVar2 = *(undefined4 *)param_2;
        param_2 = param_2 + 4;
        pcVar2 = pcVar2 + 4;
      }
      for (uVar3 = param_3 & 3; uVar3 != 0; uVar3 = uVar3 - 1) {
        *pcVar2 = *param_2;
        param_2 = param_2 + 1;
        pcVar2 = pcVar2 + 1;
      }
      *(uint *)(param_1 + 0x104) = *(int *)(param_1 + 0x104) + param_3;
      return;
    }
    FUN_1002afb0(0,param_1,param_2,param_3,*(int *)(param_1 + 0x100));
  }
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_100123b0(char *param_1,char *param_2,byte *param_3)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  uint uVar4;
  uint uVar5;
  byte local_1020 [4124];
  uint uStack_4;
  
  uStack_4 = 0x100123ba;
  local_1020[1] = 0;
  local_1020[2] = 0;
  local_1020[3] = 0;
  local_1020[4] = 0;
  local_1020[5] = 0;
  local_1020[6] = 0;
  local_1020[7] = 0;
  local_1020[8] = 0;
  local_1020[9] = 0;
  local_1020[10] = 0;
  local_1020[0xb] = 0;
  local_1020[0xc] = 0;
  local_1020[0xd] = 0;
  local_1020[0xe] = 0;
  local_1020[0xf] = 0;
  local_1020[0x10] = 0;
  local_1020[0x11] = 0;
  local_1020[0x12] = 0;
  local_1020[0x13] = 0;
  local_1020[0x14] = 0;
  local_1020[0x15] = 0;
  local_1020[0x16] = 0;
  local_1020[0x17] = 0;
  local_1020[0x18] = 0;
  local_1020[0x19] = 0;
  local_1020[0x1a] = 0;
  local_1020[0x1b] = 0;
  local_1020[0x1c] = 0;
  local_1020[0x1d] = 0;
  local_1020[0x1e] = 0;
  local_1020[0x1f] = 0;
  local_1020[0] = 0;
  uVar5 = 0;
  if (*param_2 == '~') {
    local_1020[0] = 0;
    iVar2 = FUN_10002ad0(local_1020,0x20,(byte *)0x0,0);
    local_1020[iVar2] = 0x3a;
    local_1020[iVar2 + 1] = 0x20;
    uVar5 = iVar2 + 2;
    param_2 = param_2 + 1;
    local_1020[iVar2 + 2] = 0;
  }
  if (((*param_2 == '%') && (param_2[1] == 's')) && (param_2[2] == '\0')) {
    pbVar3 = param_3;
    do {
      bVar1 = *pbVar3;
      pbVar3 = pbVar3 + 1;
    } while (bVar1 != 0);
    uVar4 = (int)pbVar3 - (int)(param_3 + 1);
    pbVar3 = param_3;
  }
  else {
    local_1020[0x20] = 0;
    uVar4 = __vsnprintf((char *)(local_1020 + 0x20),0x1000,param_2,(va_list)&param_3);
    uStack_4 = uStack_4 & 0xffffff;
    pbVar3 = local_1020 + 0x20;
  }
  if (param_1 != (char *)0x0) {
    if (local_1020[0] != 0) {
      FUN_10012300(param_1,(char *)local_1020,uVar5);
    }
    FUN_10012300(param_1,(char *)pbVar3,uVar4);
    FUN_10012300(param_1,&DAT_10041180,2);
    if (*(int *)(param_1 + 0x110) == 1) {
      _puts((char *)pbVar3);
    }
    else if (*(int *)(param_1 + 0x110) == 2) {
      _fputs((char *)local_1020,(FILE *)&DAT_100415a0);
      _puts((char *)pbVar3);
    }
    if (*(int *)(param_1 + 0x114) == 1) {
      _fputs((char *)pbVar3,(FILE *)&DAT_100415c0);
      _fputs(&DAT_10041180,(FILE *)&DAT_100415c0);
      return;
    }
    if (*(int *)(param_1 + 0x114) == 2) {
      _fputs((char *)local_1020,(FILE *)&DAT_100415c0);
      _fputs((char *)pbVar3,(FILE *)&DAT_100415c0);
      _fputs(&DAT_10041180,(FILE *)&DAT_100415c0);
    }
  }
  return;
}



void __cdecl FUN_10012570(char *param_1)

{
  if ((param_1 != (char *)0x0) && (0 < (int)*(size_t *)(param_1 + 0x104))) {
    FUN_1002afb0(0,param_1,*(char **)(param_1 + 0x10c),*(size_t *)(param_1 + 0x104),
                 *(int *)(param_1 + 0x100));
    param_1[0x104] = '\0';
    param_1[0x105] = '\0';
    param_1[0x106] = '\0';
    param_1[0x107] = '\0';
  }
  _free(param_1);
  return;
}



void __cdecl FUN_100125c0(int param_1)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int local_40 [16];
  
  iVar5 = param_1 + 0x54;
  iVar8 = 0x10;
  do {
    piVar1 = (int *)(iVar5 + -4);
    iVar5 = iVar5 + -4;
    iVar8 = iVar8 + -1;
    local_40[iVar8] = *piVar1;
  } while (iVar8 != 0);
  uVar7 = *(uint *)(param_1 + 0xc);
  uVar6 = *(uint *)(param_1 + 0x10);
  uVar3 = *(uint *)(param_1 + 8);
  uVar2 = ((uVar6 ^ uVar7) & uVar3 ^ uVar6) + *(int *)(param_1 + 4) + -0x28955b88 + local_40[0];
  uVar4 = (uVar2 >> 0x19 | uVar2 * 0x80) + uVar3;
  uVar2 = uVar6 + 0xe8c7b756 + ((uVar7 ^ uVar3) & uVar4 ^ uVar7) + local_40[1];
  uVar6 = (uVar2 >> 0x14 | uVar2 * 0x1000) + uVar4;
  uVar2 = uVar7 + 0x242070db + ((uVar3 ^ uVar4) & uVar6 ^ uVar3) + local_40[2];
  uVar7 = (uVar2 >> 0xf | uVar2 * 0x20000) + uVar6;
  uVar2 = uVar3 + 0xc1bdceee + ((uVar6 ^ uVar4) & uVar7 ^ uVar4) + local_40[3];
  uVar7 = (uVar2 * 0x400000 | uVar2 >> 10) + uVar7;
  uVar2 = uVar4 + 0xf57c0faf + ((uVar6 ^ uVar7) & uVar7 ^ uVar6) + local_40[4];
  uVar7 = (uVar2 >> 0x19 | uVar2 * 0x80) + uVar7;
  uVar2 = uVar6 + 0x4787c62a + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[5];
  uVar7 = (uVar2 >> 0x14 | uVar2 * 0x1000) + uVar7;
  uVar2 = uVar7 + 0xa8304613 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[6];
  uVar7 = (uVar2 >> 0xf | uVar2 * 0x20000) + uVar7;
  uVar2 = uVar7 + 0xfd469501 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[7];
  uVar7 = (uVar2 * 0x400000 | uVar2 >> 10) + uVar7;
  uVar2 = uVar7 + 0x698098d8 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[8];
  uVar7 = (uVar2 >> 0x19 | uVar2 * 0x80) + uVar7;
  uVar2 = uVar7 + 0x8b44f7af + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[9];
  uVar7 = (uVar2 >> 0x14 | uVar2 * 0x1000) + uVar7;
  uVar2 = (uVar7 - 0xa44f) + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[10];
  uVar7 = (uVar2 >> 0xf | uVar2 * 0x20000) + uVar7;
  uVar2 = uVar7 + 0x895cd7be + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xb];
  uVar7 = (uVar2 * 0x400000 | uVar2 >> 10) + uVar7;
  uVar2 = uVar7 + 0x6b901122 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xc];
  uVar7 = (uVar2 >> 0x19 | uVar2 * 0x80) + uVar7;
  uVar2 = uVar7 + 0xfd987193 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xd];
  uVar7 = (uVar2 >> 0x14 | uVar2 * 0x1000) + uVar7;
  uVar2 = uVar7 + 0xa679438e + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xe];
  uVar7 = (uVar2 >> 0xf | uVar2 * 0x20000) + uVar7;
  uVar2 = uVar7 + 0x49b40821 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xf];
  uVar7 = (uVar2 * 0x400000 | uVar2 >> 10) + uVar7;
  uVar2 = uVar7 + 0xf61e2562 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[1];
  uVar7 = (uVar2 >> 0x1b | uVar2 * 0x20) + uVar7;
  uVar2 = uVar7 + 0xc040b340 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[6];
  uVar7 = (uVar2 >> 0x17 | uVar2 * 0x200) + uVar7;
  uVar2 = uVar7 + 0x265e5a51 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xb];
  uVar7 = (uVar2 >> 0x12 | uVar2 * 0x4000) + uVar7;
  uVar2 = uVar7 + 0xe9b6c7aa + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0];
  uVar7 = (uVar2 * 0x100000 | uVar2 >> 0xc) + uVar7;
  uVar2 = uVar7 + 0xd62f105d + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[5];
  uVar7 = (uVar2 >> 0x1b | uVar2 * 0x20) + uVar7;
  uVar2 = uVar7 + 0x2441453 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[10];
  uVar7 = (uVar2 >> 0x17 | uVar2 * 0x200) + uVar7;
  uVar2 = uVar7 + 0xd8a1e681 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xf];
  uVar7 = (uVar2 >> 0x12 | uVar2 * 0x4000) + uVar7;
  uVar2 = uVar7 + 0xe7d3fbc8 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[4];
  uVar7 = (uVar2 * 0x100000 | uVar2 >> 0xc) + uVar7;
  uVar2 = uVar7 + 0x21e1cde6 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[9];
  uVar7 = (uVar2 >> 0x1b | uVar2 * 0x20) + uVar7;
  uVar2 = uVar7 + 0xc33707d6 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xe];
  uVar7 = (uVar2 >> 0x17 | uVar2 * 0x200) + uVar7;
  uVar2 = uVar7 + 0xf4d50d87 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[3];
  uVar7 = (uVar2 >> 0x12 | uVar2 * 0x4000) + uVar7;
  uVar2 = uVar7 + 0x455a14ed + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[8];
  uVar7 = (uVar2 * 0x100000 | uVar2 >> 0xc) + uVar7;
  uVar2 = uVar7 + 0xa9e3e905 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xd];
  uVar7 = (uVar2 >> 0x1b | uVar2 * 0x20) + uVar7;
  uVar2 = uVar7 + 0xfcefa3f8 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[2];
  uVar7 = (uVar2 >> 0x17 | uVar2 * 0x200) + uVar7;
  uVar2 = uVar7 + 0x676f02d9 + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[7];
  uVar7 = (uVar2 >> 0x12 | uVar2 * 0x4000) + uVar7;
  uVar2 = uVar7 + 0x8d2a4c8a + ((uVar7 ^ uVar7) & uVar7 ^ uVar7) + local_40[0xc];
  uVar7 = (uVar2 * 0x100000 | uVar2 >> 0xc) + uVar7;
  uVar2 = (uVar7 - 0x5c6be) + (uVar7 ^ uVar7 ^ uVar7) + local_40[5];
  uVar7 = (uVar2 >> 0x1c | uVar2 * 0x10) + uVar7;
  uVar2 = uVar7 + 0x8771f681 + (uVar7 ^ uVar7 ^ uVar7) + local_40[8];
  uVar7 = (uVar2 >> 0x15 | uVar2 * 0x800) + uVar7;
  uVar2 = uVar7 + 0x6d9d6122 + (uVar7 ^ uVar7 ^ uVar7) + local_40[0xb];
  uVar7 = (uVar2 >> 0x10 | uVar2 * 0x10000) + uVar7;
  uVar2 = uVar7 + 0xfde5380c + (uVar7 ^ uVar7 ^ uVar7) + local_40[0xe];
  uVar7 = (uVar2 * 0x800000 | uVar2 >> 9) + uVar7;
  uVar2 = uVar7 + 0xa4beea44 + (uVar7 ^ uVar7 ^ uVar7) + local_40[1];
  uVar7 = (uVar2 >> 0x1c | uVar2 * 0x10) + uVar7;
  uVar2 = uVar7 + 0x4bdecfa9 + (uVar7 ^ uVar7 ^ uVar7) + local_40[4];
  uVar7 = (uVar2 >> 0x15 | uVar2 * 0x800) + uVar7;
  uVar2 = uVar7 + 0xf6bb4b60 + (uVar7 ^ uVar7 ^ uVar7) + local_40[7];
  uVar7 = (uVar2 >> 0x10 | uVar2 * 0x10000) + uVar7;
  uVar2 = uVar7 + 0xbebfbc70 + (uVar7 ^ uVar7 ^ uVar7) + local_40[10];
  uVar7 = (uVar2 * 0x800000 | uVar2 >> 9) + uVar7;
  uVar2 = uVar7 + 0x289b7ec6 + (uVar7 ^ uVar7 ^ uVar7) + local_40[0xd];
  uVar7 = (uVar2 >> 0x1c | uVar2 * 0x10) + uVar7;
  uVar2 = uVar7 + 0xeaa127fa + (uVar7 ^ uVar7 ^ uVar7) + local_40[0];
  uVar7 = (uVar2 >> 0x15 | uVar2 * 0x800) + uVar7;
  uVar2 = uVar7 + 0xd4ef3085 + (uVar7 ^ uVar7 ^ uVar7) + local_40[3];
  uVar7 = (uVar2 >> 0x10 | uVar2 * 0x10000) + uVar7;
  uVar2 = uVar7 + 0x4881d05 + (uVar7 ^ uVar7 ^ uVar7) + local_40[6];
  uVar7 = (uVar2 * 0x800000 | uVar2 >> 9) + uVar7;
  uVar2 = uVar7 + 0xd9d4d039 + (uVar7 ^ uVar7 ^ uVar7) + local_40[9];
  uVar7 = (uVar2 >> 0x1c | uVar2 * 0x10) + uVar7;
  uVar2 = uVar7 + 0xe6db99e5 + (uVar7 ^ uVar7 ^ uVar7) + local_40[0xc];
  uVar7 = (uVar2 >> 0x15 | uVar2 * 0x800) + uVar7;
  uVar2 = uVar7 + 0x1fa27cf8 + (uVar7 ^ uVar7 ^ uVar7) + local_40[0xf];
  uVar7 = (uVar2 >> 0x10 | uVar2 * 0x10000) + uVar7;
  uVar2 = uVar7 + 0xc4ac5665 + (uVar7 ^ uVar7 ^ uVar7) + local_40[2];
  uVar7 = (uVar2 * 0x800000 | uVar2 >> 9) + uVar7;
  uVar2 = uVar7 + 0xf4292244 + ((~uVar7 | uVar7) ^ uVar7) + local_40[0];
  uVar7 = (uVar2 >> 0x1a | uVar2 * 0x40) + uVar7;
  uVar2 = uVar7 + 0x432aff97 + ((~uVar7 | uVar7) ^ uVar7) + local_40[7];
  uVar7 = (uVar2 >> 0x16 | uVar2 * 0x400) + uVar7;
  uVar2 = uVar7 + 0xab9423a7 + ((~uVar7 | uVar7) ^ uVar7) + local_40[0xe];
  uVar7 = (uVar2 >> 0x11 | uVar2 * 0x8000) + uVar7;
  uVar2 = uVar7 + 0xfc93a039 + ((~uVar7 | uVar7) ^ uVar7) + local_40[5];
  uVar7 = (uVar2 * 0x200000 | uVar2 >> 0xb) + uVar7;
  uVar2 = uVar7 + 0x655b59c3 + ((~uVar7 | uVar7) ^ uVar7) + local_40[0xc];
  uVar7 = (uVar2 >> 0x1a | uVar2 * 0x40) + uVar7;
  uVar2 = uVar7 + 0x8f0ccc92 + ((~uVar7 | uVar7) ^ uVar7) + local_40[3];
  uVar7 = (uVar2 >> 0x16 | uVar2 * 0x400) + uVar7;
  uVar2 = (uVar7 - 0x100b83) + ((~uVar7 | uVar7) ^ uVar7) + local_40[10];
  uVar7 = (uVar2 >> 0x11 | uVar2 * 0x8000) + uVar7;
  uVar2 = uVar7 + 0x85845dd1 + ((~uVar7 | uVar7) ^ uVar7) + local_40[1];
  uVar7 = (uVar2 * 0x200000 | uVar2 >> 0xb) + uVar7;
  uVar2 = uVar7 + 0x6fa87e4f + ((~uVar7 | uVar7) ^ uVar7) + local_40[8];
  uVar7 = (uVar2 >> 0x1a | uVar2 * 0x40) + uVar7;
  uVar2 = uVar7 + 0xfe2ce6e0 + ((~uVar7 | uVar7) ^ uVar7) + local_40[0xf];
  uVar7 = (uVar2 >> 0x16 | uVar2 * 0x400) + uVar7;
  uVar2 = uVar7 + 0xa3014314 + ((~uVar7 | uVar7) ^ uVar7) + local_40[6];
  uVar7 = (uVar2 >> 0x11 | uVar2 * 0x8000) + uVar7;
  uVar2 = uVar7 + 0x4e0811a1 + ((~uVar7 | uVar7) ^ uVar7) + local_40[0xd];
  uVar7 = (uVar2 * 0x200000 | uVar2 >> 0xb) + uVar7;
  uVar2 = uVar7 + 0xf7537e82 + ((~uVar7 | uVar7) ^ uVar7) + local_40[4];
  uVar7 = (uVar2 >> 0x1a | uVar2 * 0x40) + uVar7;
  uVar2 = uVar7 + 0xbd3af235 + ((~uVar7 | uVar7) ^ uVar7) + local_40[0xb];
  uVar7 = (uVar2 >> 0x16 | uVar2 * 0x400) + uVar7;
  uVar2 = uVar7 + 0x2ad7d2bb + ((~uVar7 | uVar7) ^ uVar7) + local_40[2];
  uVar7 = (uVar2 >> 0x11 | uVar2 * 0x8000) + uVar7;
  uVar2 = uVar7 + 0xeb86d391 + ((~uVar7 | uVar7) ^ uVar7) + local_40[9];
  *(uint *)(param_1 + 8) = (uVar2 * 0x200000 | uVar2 >> 0xb) + uVar3 + uVar7;
  *(uint *)(param_1 + 0xc) = *(int *)(param_1 + 0xc) + uVar7;
  *(uint *)(param_1 + 4) = *(int *)(param_1 + 4) + uVar7;
  *(uint *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + uVar7;
  return;
}



void __cdecl FUN_10012e70(undefined4 *param_1)

{
  *param_1 = 0;
  param_1[1] = 0x67452301;
  param_1[2] = 0xefcdab89;
  param_1[3] = 0x98badcfe;
  param_1[4] = 0x10325476;
  return;
}



void __cdecl FUN_10012ea0(uint *param_1,char *param_2,int param_3)

{
  char cVar1;
  int iVar2;
  uint uVar3;
  
  if (param_3 < 0) {
    param_3 = 0;
    cVar1 = *param_2;
    while (cVar1 != '\0') {
      iVar2 = param_3 + 1;
      param_3 = param_3 + 1;
      cVar1 = param_2[iVar2];
    }
  }
  uVar3 = *param_1 & 0x3f;
  if (0 < param_3) {
    do {
      *(char *)((int)param_1 + uVar3 + 0x14) = *param_2;
      uVar3 = uVar3 + 1;
      param_2 = param_2 + 1;
      *param_1 = *param_1 + 1;
      if (uVar3 == 0x40) {
        FUN_100125c0((int)param_1);
        uVar3 = 0;
      }
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  return;
}



void __cdecl FUN_10012f00(uint *param_1,undefined1 *param_2,int param_3)

{
  undefined *puVar1;
  uint uVar2;
  undefined1 uVar3;
  uint local_4;
  
  local_4 = 0;
  uVar3 = 0x80;
  uVar2 = *param_1 & 0x3f;
  do {
    while( true ) {
      *(undefined1 *)((int)param_1 + uVar2 + 0x14) = uVar3;
      uVar2 = uVar2 + 1;
      uVar3 = 0;
      if (uVar2 != 0x40) break;
      FUN_100125c0((int)param_1);
      uVar2 = 0;
    }
  } while (uVar2 != 0x38);
  *(char *)(param_1 + 0x13) = (char)*param_1 << 3;
  uVar2 = *param_1;
  *(char *)((int)param_1 + 0x4d) = (char)(uVar2 >> 5);
  *(char *)((int)param_1 + 0x4e) = (char)(uVar2 >> 0xd);
  *(char *)((int)param_1 + 0x4f) = (char)(uVar2 >> 0x15);
  *(byte *)(param_1 + 0x14) = (byte)(uVar2 >> 0x1d);
  *(undefined1 *)((int)param_1 + 0x51) = 0;
  *(undefined1 *)((int)param_1 + 0x52) = 0;
  *(undefined1 *)((int)param_1 + 0x53) = 0;
  FUN_100125c0((int)param_1);
  puVar1 = PTR_s_0123456789abcdef_10041184;
  uVar2 = 0;
  do {
    if ((uVar2 & 3) == 0) {
      local_4 = param_1[((int)uVar2 >> 2) + 1];
    }
    if (param_3 < 0x21) {
      if ((int)uVar2 < param_3) {
        *param_2 = (char)local_4;
        goto LAB_10012fc0;
      }
    }
    else {
      *param_2 = puVar1[local_4 >> 4 & 0xf];
      param_2 = param_2 + 1;
      *param_2 = puVar1[local_4 & 0xf];
LAB_10012fc0:
      param_2 = param_2 + 1;
    }
    local_4 = local_4 >> 8;
    uVar2 = uVar2 + 1;
    if (0xf < (int)uVar2) {
      if (0x20 < param_3) {
        *param_2 = 0;
      }
      return;
    }
  } while( true );
}



undefined4 * __cdecl FUN_10012fe0(undefined4 param_1)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0xf4);
  puVar3 = puVar1;
  for (iVar2 = 0x3d; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  *puVar1 = param_1;
  return puVar1;
}



undefined * FUN_10013010(void)

{
  return &DAT_1003bbd0;
}



undefined4 FUN_10013040(void)

{
  undefined4 in_stack_0000001c;
  
  return in_stack_0000001c;
}



undefined1 * FUN_10013050(void)

{
  undefined1 *puVar1;
  int iVar2;
  int in_stack_00000018;
  
  iVar2 = 0;
  puVar1 = &DAT_10052ab8;
  if (in_stack_00000018 != 0) {
    do {
      if (iVar2 != 0) {
        *puVar1 = 0x2c;
        puVar1 = puVar1 + 1;
      }
      *puVar1 = 0x2d;
      puVar1 = puVar1 + 1;
      iVar2 = iVar2 + 1;
    } while (iVar2 != in_stack_00000018);
  }
  *puVar1 = 0;
  return &DAT_10052ab8;
}



undefined1 FUN_10013080(void)

{
  return 1;
}



void __cdecl FUN_10013090(undefined4 param_1,undefined4 *param_2,int param_3,byte *param_4)

{
  FUN_10012100(param_2,param_4,(char *)(param_3 + 0x51c),(char *)(param_3 + 0x518));
  return;
}



int __cdecl FUN_100130c0(char *param_1)

{
  byte bVar1;
  int in_EAX;
  byte *pbVar2;
  int iVar3;
  uint3 uVar5;
  byte *pbVar4;
  byte *unaff_EBX;
  byte *pbVar6;
  int iVar7;
  bool bVar8;
  char *pcVar9;
  byte local_28 [40];
  
  pcVar9 = "MONITOR_ACCOUNTS";
  pbVar2 = FUN_1001c1e0(*(uint **)(in_EAX + 0x4030),(char *)0x0);
  pbVar2 = FUN_10002000(pbVar2,(byte *)pcVar9);
  iVar7 = 0;
  iVar3 = FUN_10002f60(pbVar2,local_28,0x26,&DAT_10039247,0,0x2c);
  uVar5 = (uint3)((uint)iVar3 >> 8);
  do {
    if (local_28[0] == 0) {
      return (uint)uVar5 << 8;
    }
    pcVar9 = _strchr((char *)local_28,0x2f);
    if (pcVar9 != (char *)0x0) {
      *pcVar9 = '\0';
      iVar3 = FUN_10019c70(param_1,(char *)local_28);
      if (iVar3 == 0) {
        pbVar6 = (byte *)(pcVar9 + 1);
        pbVar4 = unaff_EBX;
        do {
          bVar1 = *pbVar4;
          bVar8 = bVar1 < *pbVar6;
          if (bVar1 != *pbVar6) {
LAB_1001315b:
            iVar3 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
            goto LAB_10013160;
          }
          if (bVar1 == 0) break;
          bVar1 = pbVar4[1];
          bVar8 = bVar1 < pbVar6[1];
          if (bVar1 != pbVar6[1]) goto LAB_1001315b;
          pbVar4 = pbVar4 + 2;
          pbVar6 = pbVar6 + 2;
        } while (bVar1 != 0);
        iVar3 = 0;
LAB_10013160:
        if (iVar3 == 0) {
          return 1;
        }
      }
    }
    iVar7 = iVar7 + 1;
    iVar3 = FUN_10002f60(pbVar2,local_28,0x26,&DAT_10039247,iVar7,0x2c);
    uVar5 = (uint3)((uint)iVar3 >> 8);
  } while( true );
}



void __thiscall
FUN_100131a0(void *this,undefined4 *param_1,int param_2,undefined4 param_3,undefined4 *param_4)

{
  char cVar1;
  int in_EAX;
  int iVar2;
  int unaff_EBX;
  char *pcVar3;
  undefined4 *puVar5;
  char local_110 [16];
  char local_100 [256];
  char *pcVar4;
  
  cVar1 = *(char *)(unaff_EBX + 0x144);
  pcVar4 = (char *)(unaff_EBX + 0x144);
  if (cVar1 == '\0') {
    *(undefined1 *)this = 0;
    return;
  }
  do {
    pcVar3 = pcVar4 + 1;
    if (in_EAX < 2) {
      return;
    }
    if (cVar1 != '%') {
switchD_100131fa_caseD_62:
      *(char *)this = cVar1;
      this = (void *)((int)this + 1);
      in_EAX = in_EAX + -1;
      goto LAB_10013302;
    }
    cVar1 = *pcVar3;
    if (cVar1 == '\0') goto LAB_10013302;
    pcVar3 = pcVar4 + 2;
    switch(cVar1) {
    case 'a':
      iVar2 = _sprintf((char *)this,"%ld.%ld.%ld.%ld",(uint)*(byte *)(unaff_EBX + 0x1b),
                       (uint)*(byte *)(unaff_EBX + 0x1a),(uint)*(byte *)(unaff_EBX + 0x19),
                       *(uint *)(unaff_EBX + 0x18) & 0xff);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    default:
      goto switchD_100131fa_caseD_62;
    case 'c':
      puVar5 = (undefined4 *)(unaff_EBX + 0x44);
      goto LAB_100132cc;
    case 'i':
      iVar2 = _sprintf((char *)this,"%u",*param_1);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    case 'l':
      puVar5 = param_4;
      goto LAB_100132cc;
    case 'p':
      iVar2 = _sprintf((char *)this,"%d",*(undefined4 *)(unaff_EBX + 0xc));
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    case 's':
      _sprintf(local_110,"%08x",param_3);
      FUN_1002b0c0(local_100,0x100,(char *)(param_1 + 8),*(undefined4 *)(param_2 + 0xc),local_110,
                   (char *)(unaff_EBX + 0x24));
      iVar2 = _sprintf((char *)this,"%s",local_100);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
      break;
    case 'u':
      puVar5 = param_1 + 0x107;
LAB_100132cc:
      iVar2 = _sprintf((char *)this,"%s",puVar5);
      this = (void *)((int)this + iVar2);
      in_EAX = in_EAX - iVar2;
    }
LAB_10013302:
    cVar1 = *pcVar3;
    pcVar4 = pcVar3;
    if (cVar1 == '\0') {
      return;
    }
  } while( true );
}



int * __cdecl FUN_10013350(undefined4 param_1,int param_2,int param_3)

{
  int *piVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_10 [16];
  
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x50) = 0;
  *(int *)(param_2 + 0x48) = *(int *)(param_2 + 100);
  piVar1 = *(int **)(param_2 + 0xb50);
  if (piVar1 == (int *)0x0) {
    *(undefined4 *)(param_2 + 0x4c) = 0x74696d65;
    return piVar1;
  }
  if (*piVar1 != -*(int *)(param_2 + 0xb4c)) {
    *(undefined4 *)(param_2 + 0x4c) = 0x6f766572;
    return (int *)0x0;
  }
  *(int *)(param_2 + 0x4c) = piVar1[1];
  if (*(int *)(param_2 + 100) == 0x72616e6b) {
    iVar4 = 0;
    pbVar2 = FUN_10002000(*(byte **)(*(int *)(param_3 + 0xac4) + 0xc),&DAT_1003c200);
    iVar4 = FUN_10002e80(pbVar2,iVar4);
    *(int *)(param_3 + 0xa2c) = iVar4;
  }
  if ((*(int *)(param_2 + 100) == 0x7175696b) && (*(byte *)(param_3 + 0xa25) < 0xfa)) {
    pbVar5 = &DAT_10039247;
    iVar4 = 0x10;
    pbVar2 = local_10;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a66c);
    FUN_100030f0(pbVar3,pbVar2,iVar4,pbVar5);
    if (local_10[0] != 0x2a) {
      *(char *)(param_3 + 0xa25) = *(char *)(param_3 + 0xa25) + '\x01';
    }
  }
  FUN_10002230(*(char **)(param_2 + 0x58),*(int *)(param_2 + 0x54),
               *(char **)(*(int *)(param_3 + 0xac4) + 0xc));
  FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"TITLE",
               *(byte **)(param_2 + 0x74));
  *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  return (int *)0xffffffff;
}



undefined4 __cdecl FUN_10013510(int param_1,int param_2,int param_3)

{
  int *piVar1;
  byte *pbVar2;
  byte *pbVar3;
  void *pvVar4;
  int iVar5;
  undefined4 *puVar6;
  char *pcVar7;
  int iVar8;
  uint uVar9;
  byte *pbVar10;
  byte *pbVar11;
  byte local_1f4 [20];
  byte local_1e0 [32];
  byte local_1c0 [32];
  byte local_1a0 [32];
  byte local_180 [32];
  byte local_160 [32];
  byte local_140 [4];
  byte local_13c [264];
  int local_34;
  int local_30;
  byte local_2c [40];
  
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x50) = 0;
  *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
  piVar1 = *(int **)(param_2 + 0xb50);
  if (piVar1 == (int *)0x0) {
    *(undefined4 *)(param_2 + 0x4c) = 0x74696d65;
LAB_10013541:
    FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth lobbyaccount error",*(byte **)(param_2 + 4))
    ;
    return 0;
  }
  if (*piVar1 != -*(int *)(param_2 + 0xb4c)) {
    *(undefined4 *)(param_2 + 0x4c) = 0x6f766572;
    goto LAB_10013541;
  }
  iVar8 = piVar1[1];
  *(int *)(param_2 + 0x4c) = iVar8;
  if (iVar8 != 0) {
    FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth error %x",*(byte **)(param_2 + 4));
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    return 0;
  }
  iVar8 = 0;
  pbVar2 = FUN_10002000(*(byte **)(*(int *)(param_3 + 0xac4) + 0xc),&DAT_10039b40);
  iVar8 = FUN_10002e80(pbVar2,iVar8);
  if (iVar8 < 1) {
    FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth did not agree to TOS",
                 *(byte **)(param_2 + 4));
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x746f7361;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    return 0;
  }
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b58);
  if (pbVar2 != (byte *)0x0) {
    iVar8 = 0;
    pbVar2 = FUN_10002000(*(byte **)(*(int *)(param_3 + 0xac4) + 0xc),(byte *)"SHARE");
    iVar8 = FUN_10002e80(pbVar2,iVar8);
    if (iVar8 < 1) {
      FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth did not agree to SHARE",
                   *(byte **)(param_2 + 4));
      *(undefined4 *)(param_2 + 0x4c) = 0x73686172;
      goto LAB_10013a62;
    }
  }
  uVar9 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x58),(byte *)"FLAGS");
  uVar9 = FUN_10002ed0((char *)pbVar2,uVar9);
  if ((uVar9 & 0x1000) != 0) {
    FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth is locked",*(byte **)(param_2 + 4));
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6c6f636b;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    return 0;
  }
  pbVar10 = &DAT_10039247;
  iVar8 = 0x12;
  pbVar2 = local_1f4;
  pbVar3 = FUN_10002000(*(byte **)(*(int *)(param_3 + 0xac4) + 0xc),&DAT_10039b60);
  FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
  iVar8 = FUN_100195a0(*(int **)(param_1 + 0x2aa320),local_1f4);
  if (iVar8 < 1) {
    iVar8 = *(int *)(param_3 + 0xac4);
    pbVar3 = &DAT_10039247;
    pbVar2 = local_1e0;
    for (iVar5 = 0x75; iVar5 != 0; iVar5 = iVar5 + -1) {
      pbVar2[0] = 0;
      pbVar2[1] = 0;
      pbVar2[2] = 0;
      pbVar2[3] = 0;
      pbVar2 = pbVar2 + 4;
    }
    iVar5 = 0x20;
    pbVar2 = local_1e0;
    pbVar10 = FUN_10002000(*(byte **)(iVar8 + 0xc),&DAT_10039b60);
    FUN_100030f0(pbVar10,pbVar2,iVar5,pbVar3);
    pbVar10 = &DAT_10039247;
    iVar8 = 0x20;
    pbVar2 = local_1c0;
    pbVar3 = FUN_10002000(*(byte **)(*(int *)(param_3 + 0xac4) + 0xc),&DAT_1003a6c0);
    FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    pbVar11 = &DAT_10039247;
    iVar8 = 0x20;
    pbVar2 = (byte *)(param_3 + 0xaa0);
    pbVar3 = pbVar2;
    pbVar10 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e40);
    FUN_100030f0(pbVar10,pbVar3,iVar8,pbVar11);
    iVar8 = 0x20;
    pbVar3 = pbVar2;
    pbVar10 = pbVar2;
    pbVar11 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003c304);
    FUN_100030f0(pbVar11,pbVar3,iVar8,pbVar10);
    iVar8 = 0x50;
    pbVar3 = (byte *)(param_3 + 0xa50);
    pbVar10 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e40);
    FUN_100030f0(pbVar10,pbVar3,iVar8,pbVar2);
    pbVar10 = &DAT_10039247;
    iVar8 = 0x20;
    pbVar2 = local_1a0;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e58);
    FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    pbVar10 = &DAT_10039247;
    iVar8 = 0x20;
    pbVar2 = local_180;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e44);
    FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    pbVar10 = &DAT_10039247;
    iVar8 = 0x20;
    pbVar2 = local_160;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e3c);
    FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    pbVar10 = &DAT_10039247;
    iVar8 = 4;
    pbVar2 = local_140;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e4c);
    FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    pbVar10 = &DAT_10039247;
    iVar8 = 4;
    pbVar2 = local_13c;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e34);
    FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    if (local_13c[0] == 0) {
      pbVar10 = &DAT_10039247;
      iVar8 = 4;
      pbVar2 = local_13c;
      pbVar3 = FUN_10002000(*(byte **)(*(int *)(param_3 + 0xac4) + 0xc),&DAT_10039e34);
      FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    }
    pbVar10 = &DAT_10039247;
    iVar8 = 0x20;
    pbVar2 = local_2c;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b44);
    FUN_100030f0(pbVar3,pbVar2,iVar8,pbVar10);
    pbVar2 = local_2c;
    iVar8 = 0x20;
    pbVar3 = pbVar2;
    pbVar10 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"MADDR");
    FUN_100030f0(pbVar10,pbVar2,iVar8,pbVar3);
    iVar8 = 0;
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"HWFLAG");
    local_34 = FUN_10002e80(pbVar2,iVar8);
    iVar8 = 0;
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"HWMASK");
    local_30 = FUN_10002e80(pbVar2,iVar8);
    if (local_1a0[0] == 0) {
      pbVar2 = *(byte **)(param_2 + 4);
      pcVar7 = "~%x auth missing VERS";
    }
    else {
      if (local_180[0] == 0) {
        FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth missing SLUS",*(byte **)(param_2 + 4));
        *(undefined4 *)(param_2 + 0x20) = 0;
        *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
        *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
        *(undefined4 *)(param_2 + 0x50) = 0;
        return 0;
      }
      if (local_160[0] == 0) {
        FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth missing SKU",*(byte **)(param_2 + 4));
        *(undefined4 *)(param_2 + 0x20) = 0;
        *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
        *(undefined4 *)(param_2 + 0x50) = 0;
        *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
        return 0;
      }
      if (local_140[0] != 0) {
        if (*(int *)(param_3 + 0xa4c) == 0) {
          pvVar4 = _malloc(0x1d4);
          *(void **)(param_3 + 0xa4c) = pvVar4;
        }
        pbVar2 = local_1e0;
        puVar6 = *(undefined4 **)(param_3 + 0xa4c);
        for (iVar8 = 0x75; iVar8 != 0; iVar8 = iVar8 + -1) {
          *puVar6 = *(undefined4 *)pbVar2;
          pbVar2 = pbVar2 + 4;
          puVar6 = puVar6 + 1;
        }
        FUN_100123b0(*(char **)(param_1 + 0x402c),
                     "~%x auth NAME \'%s\' UID \'%s\' MID \'%s\' MAC \'%s\' VERS \'%s\' SLUS \'%s\' SKU \'%s\' LANG \'%s\' HWFLAG %x HWMASK %x"
                     ,*(byte **)(param_2 + 4));
        FUN_10002230(*(char **)(param_2 + 0x58),*(int *)(param_2 + 0x54),
                     *(char **)(*(int *)(param_3 + 0xac4) + 0xc));
        FUN_10002490(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039d3c,
                     *(uint *)(param_2 + 0xc));
        if (*(char *)(param_1 + 0x2aa658) != '\0') {
          FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003c230,
                       (byte *)(param_1 + 0x2aa658));
          pbVar10 = &DAT_10039247;
          iVar8 = 0x80;
          pbVar3 = (byte *)(*(int *)(param_3 + 0xa4c) + 0xa8);
          pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x58),&DAT_1003c230);
          FUN_100030f0(pbVar2,pbVar3,iVar8,pbVar10);
          FUN_10002230((char *)(*(int *)(param_3 + 0xa4c) + 0x128),0x84,(char *)(param_1 + 0x2aa6d8)
                      );
        }
        *(undefined4 *)(param_2 + 0x20) = 0;
        *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
        *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
        return 0xffffffff;
      }
      pbVar2 = *(byte **)(param_2 + 4);
      pcVar7 = "~%x auth missing LANG";
    }
    FUN_100123b0(*(char **)(param_1 + 0x402c),pcVar7,pbVar2);
    *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
  }
  else {
    FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x auth profane",*(byte **)(param_2 + 4));
    *(undefined4 *)(param_2 + 0x4c) = 0x66696c74;
  }
LAB_10013a62:
  *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x50) = 0;
  return 0;
}



undefined4 __cdecl FUN_10014510(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  undefined4 local_24;
  byte local_20 [16];
  byte local_10 [16];
  
  local_24 = 0x2a706174;
  if (*(int *)(param_3 + 0xa48) != 0) {
    FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x pers already logged in",*(byte **)(param_2 + 4));
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x70736574;
    return 0;
  }
  if (*(int *)(param_3 + 0xa4c) == 0) {
    FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x pers no auth",*(byte **)(param_2 + 4));
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  pbVar5 = &DAT_10039247;
  iVar4 = 0x10;
  pbVar3 = local_10;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b70);
  FUN_100030f0(pbVar1,pbVar3,iVar4,pbVar5);
  pbVar5 = &DAT_10039247;
  iVar4 = 0x10;
  pbVar3 = local_20;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b58);
  FUN_100030f0(pbVar1,pbVar3,iVar4,pbVar5);
  pbVar3 = (byte *)(param_3 + 0xa50);
  iVar4 = 0x50;
  pbVar1 = pbVar3;
  pbVar5 = pbVar3;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e40);
  FUN_100030f0(pbVar2,pbVar1,iVar4,pbVar5);
  pbVar1 = (byte *)(param_3 + 0xaa0);
  iVar4 = 0x20;
  pbVar5 = pbVar1;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003c304);
  FUN_100030f0(pbVar2,pbVar1,iVar4,pbVar5);
  if ((local_20[0] != 0) && (*(char *)(*(int *)(param_3 + 0xa4c) + 0x1b4) != '$')) {
    iVar4 = FUN_100130c0((char *)local_20);
    if ((char)iVar4 == '\0') {
      *(undefined4 *)(param_2 + 0x20) = 0;
      *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
      *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    iVar4 = 0;
    do {
      pbVar1 = local_20 + iVar4;
      local_10[iVar4] = *pbVar1;
      iVar4 = iVar4 + 1;
    } while (*pbVar1 != 0);
    local_24 = 0x2a676574;
  }
  **(undefined1 **)(param_2 + 0x58) = 0;
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b60,
               *(byte **)(param_3 + 0xa4c));
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b70,local_10);
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b58,local_20);
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b44,
               (byte *)(*(int *)(param_3 + 0xa4c) + 0x1b4));
  FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"PURCHBAN",
               *(byte **)(param_2 + 0x74));
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039e40,pbVar3);
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003c304,
               (byte *)(param_3 + 0xaa0));
  FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"GFIDS",
               (byte *)(param_1 + 0x2aa75c));
  FUN_10002490(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039d3c,
               *(uint *)(param_2 + 0xc));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039210,
               *(int *)(param_2 + 0x10));
  iVar4 = FUN_10010670(*(uint **)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xac0) = iVar4;
  FUN_10018470(*(SOCKET **)(param_1 + 0x4028),local_24,-iVar4,*(char **)(param_2 + 0x58),
               (char *)0xffffffff);
  *(undefined4 *)(param_2 + 0xb50) = 0;
  *(undefined1 **)(param_2 + 0x20) = &LAB_10014300;
  *(undefined4 *)(param_2 + 0x28) = 1;
  return 0;
}



undefined4 __cdecl FUN_10014ca0(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_30 [16];
  byte local_20 [32];
  
  if (*(int *)(param_1 + 0x3804 + *(int *)(param_3 + 0xad0) * 8) == 0) {
    FUN_10002c50(*(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),
                 (byte *)"CALLUSER=%d CALLPING=%d CALLADDR=%a %r");
    iVar1 = FUN_10010670(*(uint **)(param_1 + 0x4020),param_2);
    *(int *)(param_3 + 0xac0) = iVar1;
    FUN_10018470(*(SOCKET **)(param_1 + 0x4024),*(uint *)(param_2 + 100) ^ 0x20202020,-iVar1,
                 *(char **)(param_2 + 0x58),(char *)0xffffffff);
    *(undefined4 *)(param_2 + 0x48) = 0;
    *(undefined4 *)(param_2 + 0xb50) = 0;
    *(undefined1 **)(param_2 + 0x20) = &LAB_10014b00;
    *(undefined4 *)(param_2 + 0x28) = 1;
    return 0;
  }
  iVar1 = FUN_1001a190(*(int *)(param_1 + 0x40e4),*(int *)(param_3 + 0xa48));
  if (iVar1 == 0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  **(undefined1 **)(param_2 + 0x58) = 0;
  iVar4 = *(int *)(param_1 + 0x3804 + *(int *)(param_3 + 0xad0) * 8);
  if (iVar4 == 1) {
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b70);
    if (pbVar2 != (byte *)0x0) {
      FUN_100030f0(pbVar2,local_30,0x10,&DAT_10039247);
      FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b70,local_30);
      goto LAB_10014d97;
    }
    iVar4 = *(int *)(param_2 + 0x54);
    pbVar2 = *(byte **)(param_2 + 0x58);
    pbVar3 = (byte *)(iVar1 + 0x20);
    pbVar5 = &DAT_10039b70;
  }
  else {
    if (iVar4 != 2) {
      *(undefined4 *)(param_2 + 0x20) = 0;
      *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
      *(undefined4 *)(param_2 + 0x4c) = 0x696e7670;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    iVar4 = *(int *)(param_2 + 0x54);
    pbVar2 = *(byte **)(param_2 + 0x58);
    pbVar3 = (byte *)(iVar1 + 0xc);
    pbVar5 = &DAT_10039b60;
  }
  FUN_10002620(pbVar2,iVar4,pbVar5,pbVar3);
LAB_10014d97:
  pbVar5 = &DAT_10039247;
  iVar1 = 0x20;
  pbVar2 = local_20;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a25c);
  FUN_100030f0(pbVar3,pbVar2,iVar1,pbVar5);
  if (local_20[0] != 0) {
    FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a25c,local_20);
  }
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003c564,1);
  iVar1 = FUN_10010670(*(uint **)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xac0) = iVar1;
  FUN_10018470(*(SOCKET **)(param_1 + 0x4028),0x2a676574,-iVar1,*(char **)(param_2 + 0x58),
               (char *)0xffffffff);
  *(undefined4 *)(param_2 + 0xb50) = 0;
  *(undefined1 **)(param_2 + 0x20) = &LAB_10014ba0;
  *(undefined4 *)(param_2 + 0x28) = 1;
  return 0;
}



undefined4 __cdecl FUN_100151b0(int param_1,int param_2,int param_3)

{
  char cVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte abStack_30 [16];
  byte abStack_20 [32];
  
  iVar2 = (*(code *)PTR_FUN_100410cc)();
  if (iVar2 == 0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x62616463;
    return 0;
  }
  if (*(int *)(iVar2 + 4 + *(int *)(param_3 + 0xad0) * 0xc) == 0) {
    *(undefined4 *)(param_2 + 0x4c) = 0;
    **(undefined1 **)(param_2 + 0x58) = 0;
    (**(code **)(iVar2 + 8 + *(int *)(param_3 + 0xad0) * 0xc))
              (*(undefined4 *)(param_1 + 0x2aabe0),*(undefined4 *)(param_2 + 0x74),
               *(undefined4 *)(param_2 + 0x58),*(undefined4 *)(param_2 + 0x54),param_2 + 0x4c,0,0);
    cVar1 = **(char **)(param_2 + 0x58);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (cVar1 == '\0') {
      *(undefined4 *)(param_2 + 0x50) = 0;
      *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
      return 0;
    }
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
    return 0;
  }
  iVar3 = FUN_1001a190(*(int *)(param_1 + 0x40e4),*(int *)(param_3 + 0xa48));
  if (iVar3 == 0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  **(undefined1 **)(param_2 + 0x58) = 0;
  iVar2 = *(int *)(iVar2 + 4 + *(int *)(param_3 + 0xad0) * 0xc);
  if (iVar2 == 1) {
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b70);
    if (pbVar4 != (byte *)0x0) {
      FUN_100030f0(pbVar4,abStack_30,0x10,&DAT_10039247);
      FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b70,abStack_30);
      goto LAB_100152d0;
    }
    iVar2 = *(int *)(param_2 + 0x54);
    pbVar4 = *(byte **)(param_2 + 0x58);
    pbVar5 = (byte *)(iVar3 + 0x20);
    pbVar6 = &DAT_10039b70;
  }
  else {
    if (iVar2 != 2) {
      *(undefined4 *)(param_2 + 0x20) = 0;
      *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
      *(undefined4 *)(param_2 + 0x4c) = 0x696e7670;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    iVar2 = *(int *)(param_2 + 0x54);
    pbVar4 = *(byte **)(param_2 + 0x58);
    pbVar5 = (byte *)(iVar3 + 0xc);
    pbVar6 = &DAT_10039b60;
  }
  FUN_10002620(pbVar4,iVar2,pbVar6,pbVar5);
LAB_100152d0:
  pbVar6 = &DAT_10039247;
  iVar2 = 0x20;
  pbVar4 = abStack_20;
  pbVar5 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a25c);
  FUN_100030f0(pbVar5,pbVar4,iVar2,pbVar6);
  if (abStack_20[0] != 0) {
    FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a25c,abStack_20);
  }
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003c564,1);
  iVar2 = FUN_10010670(*(uint **)(param_1 + 0x4020),param_2);
  *(int *)(param_3 + 0xac0) = iVar2;
  FUN_10018470(*(SOCKET **)(param_1 + 0x4028),0x2a676574,-iVar2,*(char **)(param_2 + 0x58),
               (char *)0xffffffff);
  *(undefined4 *)(param_2 + 0xb50) = 0;
  *(undefined1 **)(param_2 + 0x20) = &LAB_10014ef0;
  *(undefined4 *)(param_2 + 0x28) = 1;
  return 0;
}



undefined4 __cdecl FUN_10015530(int param_1,int param_2)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  
  uVar3 = 0;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039d3c);
  uVar3 = FUN_10002f10(pbVar1,uVar3);
  iVar4 = 0;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039210);
  uVar2 = FUN_10002e80(pbVar1,iVar4);
  FUN_100123b0(*(char **)(param_1 + 0x402c),"~%x addr %u.%u.%u.%u:%hu",*(byte **)(param_2 + 4));
  if ((uVar3 != 0) && (*(int *)(param_1 + 0x2aa52c) != 0)) {
    *(uint *)(param_2 + 0xc) = uVar3;
  }
  *(uint *)(param_2 + 0x14) = uVar3;
  *(uint *)(param_2 + 0x18) = uVar2 & 0xffff;
  **(undefined1 **)(param_2 + 0x58) = 0;
  FUN_10002ad0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003aadc,0);
  *(undefined4 *)(param_2 + 0x48) = 0x7e706e67;
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  return 0;
}



undefined4 __cdecl FUN_10015600(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = *(int *)(param_2 + 0x68);
  *(undefined1 *)(param_3 + 0xa32) = 0;
  if (iVar3 < 1) {
    iVar3 = 1;
  }
  else if (1000 < iVar3) {
    iVar3 = 1000;
  }
  iVar4 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003c200);
  iVar4 = FUN_10002e80(pbVar1,iVar4);
  if ((0 < iVar4) && (iVar4 < iVar3)) {
    iVar3 = iVar4;
  }
  if ((0 < *(short *)(param_3 + 0xa30)) &&
     (iVar4 = *(short *)(param_3 + 0xa30) + 0x19, iVar4 < iVar3)) {
    iVar3 = iVar4;
  }
  *(short *)(param_3 + 0xa30) = (short)iVar3;
  if ((short)iVar3 < 100) {
    *(undefined1 *)(param_3 + 0xa33) = 0;
  }
  if (*(char *)(param_3 + 0xa33) < '\x01') {
    *(int *)(param_3 + 0xa34) = *(int *)(param_1 + 0x2aa518) * 1000 + *(int *)(param_1 + 0x4038);
  }
  else {
    *(char *)(param_3 + 0xa33) = *(char *)(param_3 + 0xa33) + -1;
    *(int *)(param_3 + 0xa34) = *(int *)(param_1 + 0x4038) + 2000;
  }
  piVar2 = (int *)FUN_1001a190(*(int *)(param_1 + 0x40e4),*(int *)(param_3 + 0xa48));
  if ((piVar2 != (int *)0x0) && (piVar2[0xfd] != (int)*(short *)(param_3 + 0xa30))) {
    if (piVar2[0xfd] == 0) {
      **(undefined1 **)(param_2 + 0x58) = 0;
      FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"IDENT",*piVar2);
      FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a6dc,
                   (int)*(short *)(param_3 + 0xa30));
      FUN_10018470(*(SOCKET **)(param_1 + 0x4024),0x50494e47,0,*(char **)(param_2 + 0x58),
                   (char *)0xffffffff);
      *(int *)(param_1 + 0x2aa550) = *(int *)(param_1 + 0x2aa550) + 1;
    }
    piVar2[0xfd] = (int)*(short *)(param_3 + 0xa30);
  }
  if ((*(int *)(param_1 + 0x2aa520) != 0) && (*(int *)(param_3 + 0xac8) == 0)) {
    *(int *)(param_3 + 0xac8) = *(int *)(param_1 + 0x4038) + *(int *)(param_1 + 0x2aa520);
  }
  if ((*(int *)(param_1 + 0x2aa524) != 0) && (*(int *)(param_3 + 0xacc) == 0)) {
    *(int *)(param_3 + 0xacc) = *(int *)(param_1 + 0x4038) + *(int *)(param_1 + 0x2aa524);
  }
  **(undefined1 **)(param_2 + 0x58) = 0;
  FUN_10002ad0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003aadc,0);
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  return 0;
}



void __cdecl FUN_100157e0(void *param_1,int param_2,int param_3)

{
  byte *pbVar1;
  int *piVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  byte local_30 [16];
  byte local_20 [32];
  
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"USERS");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  iVar4 = 0;
  if ((iVar6 < 1) || (*(int *)(param_3 + 0x18) != 0)) {
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0x1c) = 0;
      *(undefined4 *)(param_3 + 0x18) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x1c) = 1;
    *(undefined4 *)(param_3 + 0x18) = 1;
  }
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"USERSETS");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  if ((iVar6 < 1) || (*(int *)(param_3 + 0x84) != 0)) {
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0x88) = 0;
      *(undefined4 *)(param_3 + 0x84) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x88) = 1;
    *(undefined4 *)(param_3 + 0x84) = 1;
  }
  piVar5 = (int *)(param_3 + 100);
  do {
    _sprintf((char *)local_20,"USERSET%d",iVar4);
    pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),local_20);
    if (pbVar1 != (byte *)0x0) {
      FUN_100030f0(pbVar1,local_30,0x10,&DAT_10039247);
      if (local_30[0] == 0) {
        iVar6 = 0;
        piVar5[-4] = 0;
        *piVar5 = 0;
      }
      else {
        if ((*piVar5 != 0) ||
           (piVar2 = (int *)FUN_10018890(param_1,*(int *)((int)param_1 + 0x40f4),local_30),
           piVar2 == (int *)0x0)) goto LAB_1001590c;
        piVar5[-4] = *piVar2;
        *piVar5 = 1;
        iVar6 = FUN_1001a1e0(piVar2[0x35]);
      }
      piVar5[4] = iVar6;
    }
LAB_1001590c:
    iVar4 = iVar4 + 1;
    piVar5 = piVar5 + 1;
  } while (iVar4 < 4);
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"GAMES");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  iVar4 = 0;
  if ((iVar6 < 1) || (*(int *)(param_3 + 0x30) != 0)) {
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0x34) = 0;
      *(undefined4 *)(param_3 + 0x30) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x34) = 1;
    *(undefined4 *)(param_3 + 0x30) = 1;
  }
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"MYGAME");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  if ((iVar6 < 1) || (*(int *)(param_3 + 0x4c) != 0)) {
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0x4c) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x4c) = 1;
  }
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"ROOMS");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  if (iVar6 == 2) {
    *(undefined4 *)(param_3 + 0x20) = 0;
LAB_100159b7:
    if (*(int *)(param_3 + 0x20) != 0) goto LAB_100159e8;
    *(undefined4 *)(param_3 + 0x20) = 1;
    uVar3 = FUN_1001a1e0(*(int *)((int)param_1 + 0x40d4));
    *(undefined4 *)(param_3 + 0x24) = uVar3;
    uVar3 = FUN_1001a1e0(*(int *)((int)param_1 + 0x40d8));
    *(undefined4 *)(param_3 + 0x28) = uVar3;
  }
  else {
    if (0 < iVar6) goto LAB_100159b7;
LAB_100159e8:
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0x24) = 0;
      *(undefined4 *)(param_3 + 0x20) = 0;
    }
  }
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"RANKS");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  if (*(int *)((int)param_1 + 0x4100) != 0) {
    if (((1 < iVar6) && (iVar6 < 0xfb)) && (*(int *)(param_3 + 0x90) < 1000)) {
      *(int *)(param_3 + 0x90) = *(int *)(param_3 + 0x90) + iVar6;
      goto LAB_10015a9a;
    }
    if ((0 < iVar6) && (*(int *)(param_3 + 0x90) == 0)) {
      *(undefined4 *)(param_3 + 0x8c) = 0;
      if ((iVar6 < 3) || (0x32 < iVar6)) {
        iVar6 = 0x32;
      }
      *(int *)(param_3 + 0x90) = iVar6;
      uVar3 = FUN_10011c20(*(int *)((int)param_1 + 0x4100));
      *(undefined4 *)(param_3 + 0x94) = uVar3;
      *(char *)(param_3 + 0xa21) = *(char *)(param_3 + 0xa21) + '\x01';
      goto LAB_10015a9a;
    }
    if (iVar6 != 0) goto LAB_10015a9a;
  }
  *(undefined4 *)(param_3 + 0x90) = 0;
  *(undefined4 *)(param_3 + 0x8c) = 0;
LAB_10015a9a:
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"MESGS");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  if ((iVar6 < 1) || (*(int *)(param_3 + 0x40) != 0)) {
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0x40) = 0;
    }
  }
  else {
    *(undefined4 *)(param_3 + 0x40) = *(undefined4 *)((int)param_1 + 0x4308);
  }
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"ASYNC");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  if ((iVar6 < 1) || (*(int *)(param_3 + 0x44) != 0)) {
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0x44) = 0;
    }
  }
  else if (*(int *)(param_3 + 0x48) == 0) {
    *(undefined4 *)(param_3 + 0x44) = *(undefined4 *)((int)param_1 + 0x21e310);
  }
  else {
    *(int *)(param_3 + 0x44) = *(int *)(param_3 + 0x48);
    *(undefined4 *)(param_3 + 0x48) = 0;
  }
  iVar6 = -1;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"STATS");
  iVar6 = FUN_10002e80(pbVar1,iVar6);
  if ((iVar6 < 1) || (*(int *)(param_3 + 0xcb0) != 0)) {
    if (iVar6 == 0) {
      *(undefined4 *)(param_3 + 0xcb0) = 0;
      *(undefined4 *)(param_3 + 0xcb4) = 0;
    }
  }
  else {
    *(int *)(param_3 + 0xcb0) = *(int *)((int)param_1 + 0x2aac04) + -1;
    *(int *)(param_3 + 0xcb4) = iVar6;
    *(undefined4 *)(param_3 + 0xcb8) = *(undefined4 *)((int)param_1 + 0x4038);
  }
  **(undefined1 **)(param_2 + 0x58) = 0;
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"GAMES",
               (uint)(0 < *(int *)(param_3 + 0x30)));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"MYGAME",
               (uint)(0 < *(int *)(param_3 + 0x4c)));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"ROOMS",
               (uint)(0 < *(int *)(param_3 + 0x20)));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"USERS",
               (uint)(0 < *(int *)(param_3 + 0x18)));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"USERSETS",
               (uint)(0 < *(int *)(param_3 + 0x84)));
  piVar5 = (int *)(param_3 + 0x54);
  do {
    _sprintf((char *)local_20,"USERSET%d",iVar4);
    iVar6 = FUN_1001a190(*(int *)((int)param_1 + 0x40f8),*piVar5);
    if (iVar6 != 0) {
      FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),local_20,
                   (byte *)(iVar6 + 0x24));
    }
    iVar4 = iVar4 + 1;
    piVar5 = piVar5 + 1;
  } while (iVar4 < 4);
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"MESGS",
               (uint)(*(int *)(param_3 + 0x40) != 0));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"ASYNC",
               (uint)(*(int *)(param_3 + 0x44) != 0));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"RANKS",
               *(int *)(param_3 + 0x90));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"STATS",
               *(int *)(param_3 + 0xcb4));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003c8ec,
               (uint)(*(int *)(param_3 + 0x90) < 1000));
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"SLOTS",
               *(int *)((int)param_1 + 0x40fc));
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x4c) = 0;
  *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  return;
}



undefined4 __cdecl FUN_10016500(int param_1,int param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  int *piVar3;
  void *this;
  byte *pbVar4;
  byte *pbVar5;
  byte local_20 [32];
  
  iVar1 = FUN_1001a190(*(int *)(param_1 + 0x40e4),*(int *)(param_3 + 0xa48));
  if (iVar1 == 0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  if (*(int *)(iVar1 + 0x30) != 0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x726f6f6d;
    return 0;
  }
  pbVar5 = &DAT_10039247;
  iVar1 = 0x20;
  pbVar4 = local_20;
  *(undefined4 *)(param_3 + 4) = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar2,pbVar4,iVar1,pbVar5);
  if (local_20[0] == 0) {
    *(undefined4 *)(param_2 + 0x4c) = 0;
  }
  else {
    piVar3 = (int *)FUN_10018890(this,*(int *)(param_1 + 0x40d0),local_20);
    if ((piVar3 != (int *)0x0) && ((piVar3[1] & 0x200U) == 0)) {
      *(int *)(param_3 + 4) = *piVar3;
      *(undefined4 *)(param_3 + 0xc) = 0;
      **(undefined1 **)(param_2 + 0x58) = 0;
      FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"IDENT",*piVar3);
      FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b60,
                   (byte *)(piVar3 + 2));
      FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"COUNT",piVar3[0x3a])
      ;
      FUN_100023e0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"FLAGS",piVar3[1]);
      *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
      *(undefined4 *)(param_2 + 0x4c) = 0;
      *(undefined4 *)(param_2 + 0x20) = 0;
      *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
      return 0xffffffff;
    }
    *(undefined4 *)(param_2 + 0x4c) = 0x75726f6d;
  }
  *(undefined4 *)(param_2 + 0x50) = 0;
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
  return 0;
}



undefined4 __cdecl FUN_10016b00(void *param_1,int param_2)

{
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte local_40 [64];
  
  iVar1 = param_2;
  pbVar5 = &DAT_10039247;
  iVar4 = 0x40;
  pbVar3 = local_40;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a67c);
  FUN_100030f0(pbVar2,pbVar3,iVar4,pbVar5);
  iVar4 = FUN_1001f0d0(param_1,*(int *)((int)param_1 + 0x2aa654),local_40,1,&param_2);
  if (iVar4 != 0) {
    *(undefined4 *)(iVar1 + 0x50) = 0;
    *(undefined4 *)(iVar1 + 0x20) = 0;
    *(int *)(iVar1 + 0x4c) = iVar4;
    *(undefined4 *)(iVar1 + 0x48) = *(undefined4 *)(iVar1 + 100);
    return 0;
  }
  FUN_10002c50(*(byte **)(iVar1 + 0x58),*(byte **)(iVar1 + 0x54),
               (byte *)"ADDR=%a PORT=%d FLAGS=%f SECRET=%s");
  *(undefined4 *)(iVar1 + 0x48) = *(undefined4 *)(iVar1 + 100);
  *(undefined4 *)(iVar1 + 0x4c) = 0;
  *(undefined4 *)(iVar1 + 0x20) = 0;
  *(undefined4 *)(iVar1 + 0x50) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl FUN_100174a0(int param_1,int param_2,int param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  undefined4 extraout_ECX;
  int iVar4;
  byte *pbVar5;
  byte local_24 [36];
  
  pbVar5 = &DAT_10039247;
  iVar4 = 0x24;
  pbVar2 = local_24;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar1,pbVar2,iVar4,pbVar5);
  iVar4 = -1;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"IDENT");
  iVar4 = FUN_10002e80(pbVar2,iVar4);
  if (local_24[0] == 0) {
    if (iVar4 == -1) {
      *(undefined4 *)(param_2 + 0x20) = 0;
      *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
      *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    pbVar2 = (byte *)FUN_1001a190(*(int *)(param_1 + 0x40ec),iVar4);
  }
  else {
    pbVar2 = (byte *)FUN_10018890((void *)CONCAT31((int3)((uint)extraout_ECX >> 8),local_24[0]),
                                  *(int *)(param_1 + 0x40e8),local_24);
  }
  if (pbVar2 == (byte *)0x0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x7567616d;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar4 = FUN_1001a190(*(int *)(param_1 + 0x40e4),*(int *)(param_3 + 0xa48));
  if (iVar4 == 0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x75757372;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    return 0;
  }
  iVar3 = (*(code *)PTR_FUN_100410ec)(*(undefined4 *)(param_1 + 0x2aabe0),pbVar2,iVar4,1);
  if (iVar3 != 0) {
    *(int *)(param_2 + 0x4c) = iVar3;
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  FUN_1001d690(*(int *)(param_1 + 0x40e0),*(undefined4 *)(param_1 + 0x40d4),pbVar2,iVar4,
               *(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),PTR_FUN_100410f4,
               *(undefined4 *)(param_1 + 0x2aabe0),'\0');
  *(undefined4 *)(param_2 + 0x20) = 0;
  *(undefined4 *)(param_2 + 0x4c) = 0;
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
  return 0xffffffff;
}



undefined4 __cdecl FUN_10017620(int param_1,int param_2,int param_3)

{
  int iVar1;
  char cVar2;
  byte *pbVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  byte *pbVar14;
  int local_3c;
  byte local_24 [36];
  
  iVar1 = param_2;
  iVar11 = 0;
  iVar12 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"START");
  iVar12 = FUN_10002e80(pbVar3,iVar12);
  iVar13 = 0x32;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"COUNT");
  local_3c = FUN_10002e80(pbVar3,iVar13);
  if (100 < local_3c) {
    local_3c = 100;
  }
  iVar13 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CUSTFLAGS");
  uVar4 = FUN_10002e80(pbVar3,iVar13);
  iVar13 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CUSTMASK");
  uVar5 = FUN_10002e80(pbVar3,iVar13);
  iVar13 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"SYSFLAGS");
  uVar6 = FUN_10002e80(pbVar3,iVar13);
  iVar13 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"SYSMASK");
  uVar7 = FUN_10002e80(pbVar3,iVar13);
  pbVar14 = &DAT_10039247;
  iVar13 = 0x24;
  pbVar3 = local_24;
  pbVar8 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar8,pbVar3,iVar13,pbVar14);
  iVar13 = FUN_1001a190(*(int *)(param_1 + 0x40e4),*(int *)(param_3 + 0xa48));
  if (iVar13 == 0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x48) = *(undefined4 *)(param_2 + 100);
    *(undefined4 *)(param_2 + 0x4c) = 0x75757372;
    return 0;
  }
  FUN_10018a80(*(int *)(param_1 + 0x40f4));
  param_2 = 0;
  if (0 < local_3c) {
    do {
      iVar9 = FUN_10018a90(*(int *)(param_1 + 0x40f4),(undefined4 *)0x0);
      if (iVar9 == 0) break;
      if (((iVar12 <= param_2) && ((*(uint *)(iVar9 + 0xc) & uVar5) == uVar4)) &&
         ((*(uint *)(iVar9 + 8) & uVar7) == uVar6)) {
        iVar10 = FUN_10019cc0((char *)(iVar9 + 0x24),(char *)local_24);
        if (iVar10 != 0) {
          cVar2 = (*(code *)PTR_FUN_100410fc)(*(undefined4 *)(param_1 + 0x2aabe0),iVar9,iVar13);
          if (cVar2 != '\0') {
            FUN_1001d490(*(byte **)(iVar1 + 0x58),*(byte **)(iVar1 + 0x54));
            FUN_10010a30(*(undefined4 *)(param_1 + 0x4020),iVar1,0x2b757373,0,
                         *(char **)(iVar1 + 0x58),(char *)0xffffffff);
            iVar11 = iVar11 + 1;
          }
        }
      }
      param_2 = param_2 + 1;
    } while (iVar11 < local_3c);
  }
  FUN_10002c50(*(byte **)(iVar1 + 0x58),*(byte **)(iVar1 + 0x54),(byte *)"COUNT=%d");
  *(undefined4 *)(iVar1 + 0x20) = 0;
  *(undefined4 *)(iVar1 + 0x4c) = 0;
  *(undefined4 *)(iVar1 + 0x48) = *(undefined4 *)(iVar1 + 100);
  *(undefined4 *)(iVar1 + 0x50) = 0xffffffff;
  return 0xffffffff;
}



undefined4 __cdecl
FUN_10017870(int param_1,int param_2,uint param_3,uint param_4,uint param_5,uint param_6,int param_7
            ,int param_8,int param_9,char *param_10,undefined4 param_11)

{
  int iVar1;
  undefined4 uVar2;
  
  if (((((*(uint *)(param_2 + 8) & param_4) == param_3) &&
       ((*(uint *)(param_2 + 4) & param_6) == param_5)) && (param_7 <= *(int *)(param_2 + 0x98))) &&
     ((*(int *)(param_2 + 0x94) <= param_8 &&
      ((param_9 == 0 || (param_9 == *(int *)(param_2 + 0x8c))))))) {
    iVar1 = FUN_10019cc0((char *)(param_2 + 0xc),param_10);
    if (iVar1 != 0) {
      uVar2 = (*(code *)PTR_FUN_100410ec)(*(undefined4 *)(param_1 + 0x2aabe0),param_2,param_11,0);
      return uVar2;
    }
  }
  return 0x66696c74;
}



void FUN_10017d20(void)

{
  GetTickCount();
  return;
}



undefined4 * __cdecl FUN_10017d30(undefined4 param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  WSADATA local_190;
  
  iVar1 = WSAStartup(2,&local_190);
  if (iVar1 != 0) {
    return (undefined4 *)0x0;
  }
  if (DAT_10052afc == 0) {
    DAT_10052afc = GetTickCount();
  }
  puVar2 = (undefined4 *)_malloc(0x50);
  puVar3 = puVar2;
  for (iVar1 = 0x14; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar2[7] = 0;
  puVar2[0xd] = param_1;
  *puVar2 = 0xffffffff;
  return puVar2;
}



void __cdecl FUN_10017da0(SOCKET *param_1)

{
  if (*param_1 != 0xffffffff) {
    closesocket(*param_1);
  }
  Sleep(0x32);
  WSACleanup();
  if ((void *)param_1[0x10] != (void *)0x0) {
    _free((void *)param_1[0x10]);
  }
  if ((void *)param_1[0xc] != (void *)0x0) {
    _free((void *)param_1[0xc]);
  }
  _free(param_1);
  return;
}



uint __cdecl FUN_10017df0(int param_1,int param_2)

{
  u_short uVar1;
  u_long uVar2;
  
  if (param_2 == 0x706f7274) {
    uVar1 = ntohs(*(u_short *)(param_1 + 6));
    return (uint)uVar1;
  }
  if (param_2 == 0x61646472) {
    uVar2 = ntohl(*(u_long *)(param_1 + 8));
    return uVar2;
  }
  if (param_2 == 0x6c616472) {
    return *(uint *)(param_1 + 0x14);
  }
  if (param_2 == 0x6c707274) {
    return *(uint *)(param_1 + 0x18);
  }
  if (param_2 == 0x6f627566) {
    return *(int *)(param_1 + 0x24) - *(int *)(param_1 + 0x28);
  }
  if (param_2 == 0x69627566) {
    if (*(int *)(param_1 + 0x40) != 0) {
      return *(int *)(param_1 + 0x38) - *(int *)(param_1 + 0x3c);
    }
  }
  else if (param_2 == 0x73746174) {
    return *(uint *)(param_1 + 0x1c);
  }
  return 0;
}



undefined4 __cdecl FUN_10017e90(int *param_1,u_long param_2,u_short param_3)

{
  u_short uVar1;
  u_long uVar2;
  
  if (*param_1 != -1) {
    return 0xffffffff;
  }
  if ((void *)param_1[0x10] != (void *)0x0) {
    _free((void *)param_1[0x10]);
    param_1[0x10] = 0;
  }
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  *(undefined2 *)(param_1 + 1) = 2;
  uVar2 = htonl(param_2);
  param_1[2] = uVar2;
  uVar1 = htons(param_3);
  *(u_short *)((int)param_1 + 6) = uVar1;
  param_1[7] = 1;
  param_1[8] = 0;
  return 0;
}



void __cdecl FUN_10017f00(SOCKET *param_1)

{
  u_short uVar1;
  undefined1 *puVar2;
  DWORD DVar3;
  SOCKET SVar4;
  int iVar5;
  u_long uVar6;
  SOCKET *pSVar7;
  uint uVar8;
  uint uVar9;
  SOCKET *pSVar10;
  bool bVar11;
  u_long uStack_124;
  int iStack_120;
  timeval tStack_11c;
  sockaddr sStack_114;
  fd_set fStack_104;
  
  if ((param_1[7] == 2) && (*param_1 == 0xffffffff)) {
    if ((void *)param_1[0x10] != (void *)0x0) {
      _free((void *)param_1[0x10]);
    }
    param_1[0xe] = 0xc;
    param_1[0xf] = 0xc;
    puVar2 = (undefined1 *)_malloc(0xd);
    param_1[0x10] = (SOCKET)puVar2;
    puVar2[3] = 0xff;
    puVar2[2] = 0xff;
    puVar2[1] = 0xff;
    *puVar2 = 0xff;
    puVar2[7] = 0xfe;
    puVar2[6] = 0xfe;
    puVar2[5] = 0xfe;
    puVar2[4] = 0xfe;
    puVar2[10] = 0;
    puVar2[9] = 0;
    puVar2[8] = 0;
    puVar2[0xb] = 0xc;
    param_1[7] = 3;
  }
  if ((param_1[7] == 3) && (param_1[0xc] != 0)) {
    param_1[7] = 1;
    param_1[8] = 0;
  }
  if (param_1[7] == 1) {
    DVar3 = GetTickCount();
    if (param_1[8] < DVar3) {
      if (*param_1 != 0xffffffff) {
        closesocket(*param_1);
      }
      SVar4 = socket(2,1,0);
      *param_1 = SVar4;
      if (SVar4 == 0xffffffff) {
        iStack_120 = WSAGetLastError();
      }
      uStack_124 = 1;
      ioctlsocket(*param_1,-0x7ffb9982,&uStack_124);
      connect(*param_1,(sockaddr *)(param_1 + 1),0x10);
      DVar3 = GetTickCount();
      param_1[8] = DVar3 + 30000;
    }
    fStack_104.fd_array[0] = *param_1;
    if (fStack_104.fd_array[0] == 0xffffffff) {
      return;
    }
    tStack_11c.tv_usec = 0;
    tStack_11c.tv_sec = 0;
    fStack_104.fd_count = 1;
    iVar5 = select(1,(fd_set *)0x0,&fStack_104,&fStack_104,&tStack_11c);
    if (iVar5 == 0) {
      return;
    }
    uStack_124 = 4;
    uStack_124 = getsockopt(*param_1,0xffff,0x1007,(char *)&iStack_120,(int *)&uStack_124);
    if ((uStack_124 != 0) || (iStack_120 != 0)) {
      param_1[8] = (DAT_10052afc & 0xfff) + 1000;
      DVar3 = GetTickCount();
      param_1[8] = param_1[8] + DVar3;
      DAT_10052afc = DAT_10052afc * 0x19660d + 0x3c6ef35f;
      goto LAB_100181ad;
    }
    uStack_124 = 0x10;
    getsockname(*param_1,&sStack_114,(int *)&uStack_124);
    uVar6 = ntohl(CONCAT22(sStack_114.sa_data._4_2_,sStack_114.sa_data._2_2_));
    param_1[5] = uVar6;
    uVar1 = ntohs(sStack_114.sa_data._0_2_);
    param_1[6] = (uint)uVar1;
    param_1[7] = 2;
    param_1[10] = 0;
    if ((void *)param_1[0x10] != (void *)0x0) {
      _free((void *)param_1[0x10]);
    }
    param_1[0xe] = 0xc;
    param_1[0xf] = 0xc;
    puVar2 = (undefined1 *)_malloc(0xd);
    param_1[0x10] = (SOCKET)puVar2;
    puVar2[3] = 0xff;
    puVar2[2] = 0xff;
    puVar2[1] = 0xff;
    *puVar2 = 0xff;
    puVar2[7] = 0xff;
    puVar2[6] = 0xff;
    puVar2[5] = 0xff;
    puVar2[4] = 0xff;
    puVar2[10] = 0;
    puVar2[9] = 0;
    puVar2[8] = 0;
    puVar2[0xb] = 0xc;
  }
  if (*param_1 != 0xffffffff) {
    if (param_1[0xc] != 0) {
      SVar4 = param_1[10];
      if (SVar4 != param_1[9]) {
        uStack_124 = send(*param_1,(char *)(SVar4 + param_1[0xc]),param_1[9] - SVar4,0);
        bVar11 = (int)uStack_124 < 0;
        if (bVar11) {
          iVar5 = WSAGetLastError();
          if (iVar5 != 0x2733) goto LAB_10018162;
          bVar11 = (int)uStack_124 < 0;
        }
        if (uStack_124 != 0 && !bVar11) {
          param_1[10] = param_1[10] + uStack_124;
        }
        if (param_1[10] == param_1[9]) {
          _free((void *)param_1[0xc]);
          param_1[0xc] = 0;
        }
      }
    }
    if (param_1[0x10] == 0) {
      if (param_1[0xe] == param_1[0xf]) {
        param_1[0xe] = 0xc;
        param_1[0xf] = 0;
      }
      uStack_124 = recv(*param_1,(char *)(param_1[0xf] + 0x44 + (int)param_1),
                        param_1[0xe] - param_1[0xf],0);
      if (((int)uStack_124 < 0) && (iVar5 = WSAGetLastError(), iVar5 != 0x2733)) {
        closesocket(*param_1);
        *param_1 = 0xffffffff;
        return;
      }
      if (uStack_124 == 0) goto LAB_100181ad;
      if (0 < (int)uStack_124) {
        param_1[0xf] = param_1[0xf] + uStack_124;
      }
      if (param_1[0xf] == param_1[0xe]) {
        SVar4 = CONCAT31(CONCAT21(CONCAT11((char)param_1[0x13],*(undefined1 *)((int)param_1 + 0x4d))
                                  ,*(undefined1 *)((int)param_1 + 0x4e)),
                         *(undefined1 *)((int)param_1 + 0x4f));
        param_1[0xe] = SVar4;
        if (((int)SVar4 < 0xc) || ((int)param_1[0xd] < (int)SVar4)) goto LAB_10018162;
        pSVar7 = (SOCKET *)_malloc(SVar4 + 1);
        uVar9 = param_1[0xf];
        param_1[0x10] = (SOCKET)pSVar7;
        pSVar10 = param_1 + 0x11;
        for (uVar8 = uVar9 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
          *pSVar7 = *pSVar10;
          pSVar10 = pSVar10 + 1;
          pSVar7 = pSVar7 + 1;
        }
        for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
          *(char *)pSVar7 = (char)*pSVar10;
          pSVar10 = (SOCKET *)((int)pSVar10 + 1);
          pSVar7 = (SOCKET *)((int)pSVar7 + 1);
        }
        if (((param_1[0xf] == param_1[0xe]) && ((void *)param_1[0xc] != (void *)0x0)) &&
           (param_1[10] == param_1[9])) {
          _free((void *)param_1[0xc]);
          param_1[0xc] = 0;
        }
      }
    }
    if (param_1[0x10] != 0) {
      SVar4 = param_1[0xf];
      if ((int)SVar4 < (int)param_1[0xe]) {
        uStack_124 = recv(*param_1,(char *)(SVar4 + param_1[0x10]),param_1[0xe] - SVar4,0);
        if (((int)uStack_124 < 0) && (iVar5 = WSAGetLastError(), iVar5 != 0x2733)) {
LAB_100181ad:
          closesocket(*param_1);
          *param_1 = 0xffffffff;
          return;
        }
        if (uStack_124 == 0) {
LAB_10018162:
          closesocket(*param_1);
          *param_1 = 0xffffffff;
          return;
        }
        if (0 < (int)uStack_124) {
          param_1[0xf] = param_1[0xf] + uStack_124;
        }
        if (((param_1[0xf] == param_1[0xe]) && ((void *)param_1[0xc] != (void *)0x0)) &&
           (param_1[10] == param_1[9])) {
          _free((void *)param_1[0xc]);
          param_1[0xc] = 0;
        }
      }
    }
  }
  return;
}



int __cdecl FUN_10018370(int param_1,size_t param_2,int param_3)

{
  int iVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  
  pvVar2 = *(void **)(param_1 + 0x30);
  iVar4 = 0;
  if (pvVar2 == (void *)0x0) {
    *(undefined4 *)(param_1 + 0x24) = 0;
    *(undefined4 *)(param_1 + 0x28) = 0;
    *(size_t *)(param_1 + 0x2c) = param_2;
    pvVar2 = _malloc(param_2);
    *(void **)(param_1 + 0x30) = pvVar2;
    return *(int *)(param_1 + 0x2c) - *(int *)(param_1 + 0x24);
  }
  iVar1 = *(int *)(param_1 + 0x28);
  iVar7 = 0;
  if (0 < iVar1) {
    do {
      iVar4 = CONCAT31(CONCAT21(CONCAT11(*(undefined1 *)((int)pvVar2 + iVar7 + 8),
                                         *(undefined1 *)((int)pvVar2 + iVar7 + 9)),
                                *(undefined1 *)((int)pvVar2 + iVar7 + 10)),
                       *(undefined1 *)((int)pvVar2 + iVar7 + 0xb));
      iVar7 = iVar7 + iVar4;
    } while (iVar7 < iVar1);
  }
  if (iVar1 < iVar7) {
    iVar7 = iVar7 - iVar4;
  }
  if (0 < iVar7) {
    _memmove(pvVar2,(void *)((int)pvVar2 + iVar7),*(int *)(param_1 + 0x24) - iVar7);
    *(int *)(param_1 + 0x24) = *(int *)(param_1 + 0x24) - iVar7;
    *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) - iVar7;
  }
  iVar4 = *(int *)(param_1 + 0x24);
  if (*(int *)(param_1 + 0x2c) - iVar4 < (int)param_2) {
    puVar3 = (undefined4 *)_malloc(iVar4 + param_2 + param_3);
    if (puVar3 == (undefined4 *)0x0) {
      return 0;
    }
    uVar6 = *(uint *)(param_1 + 0x24);
    puVar8 = *(undefined4 **)(param_1 + 0x30);
    puVar9 = puVar3;
    for (uVar5 = uVar6 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar9 = *puVar8;
      puVar8 = puVar8 + 1;
      puVar9 = puVar9 + 1;
    }
    for (uVar6 = uVar6 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined1 *)puVar9 = *(undefined1 *)puVar8;
      puVar8 = (undefined4 *)((int)puVar8 + 1);
      puVar9 = (undefined4 *)((int)puVar9 + 1);
    }
    _free(*(void **)(param_1 + 0x30));
    iVar4 = *(int *)(param_1 + 0x24);
    *(undefined4 **)(param_1 + 0x30) = puVar3;
    *(size_t *)(param_1 + 0x2c) = iVar4 + param_2 + param_3;
  }
  return *(int *)(param_1 + 0x2c) - iVar4;
}



undefined4 __cdecl
FUN_10018470(SOCKET *param_1,undefined4 param_2,undefined4 param_3,char *param_4,char *param_5)

{
  char cVar1;
  char *pcVar2;
  int iVar3;
  undefined1 *puVar4;
  uint uVar5;
  char *pcVar6;
  
  FUN_10017f00(param_1);
  if ((int)param_5 < 0) {
    pcVar2 = param_4;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    param_5 = pcVar2 + (1 - (int)(param_4 + 1));
  }
  pcVar2 = param_5 + 0xc;
  iVar3 = FUN_10018370((int)param_1,(size_t)pcVar2,0x40000);
  if ((int)pcVar2 <= iVar3) {
    puVar4 = (undefined1 *)(param_1[0xc] + param_1[9]);
    if (0xc < (int)pcVar2) {
      pcVar6 = puVar4 + 0xc;
      for (uVar5 = (uint)param_5 >> 2; uVar5 != 0; uVar5 = uVar5 - 1) {
        *(undefined4 *)pcVar6 = *(undefined4 *)param_4;
        param_4 = param_4 + 4;
        pcVar6 = pcVar6 + 4;
      }
      for (uVar5 = (uint)param_5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
        *pcVar6 = *param_4;
        param_4 = param_4 + 1;
        pcVar6 = pcVar6 + 1;
      }
    }
    param_1[9] = (SOCKET)(pcVar2 + param_1[9]);
    puVar4[8] = (char)((uint)pcVar2 >> 0x18);
    puVar4[9] = (char)((uint)pcVar2 >> 0x10);
    puVar4[10] = (char)((uint)pcVar2 >> 8);
    *puVar4 = (char)((uint)param_2 >> 0x18);
    puVar4[1] = (char)((uint)param_2 >> 0x10);
    puVar4[2] = (char)((uint)param_2 >> 8);
    puVar4[3] = (char)param_2;
    puVar4[4] = (char)((uint)param_3 >> 0x18);
    puVar4[5] = (char)((uint)param_3 >> 0x10);
    puVar4[0xb] = (char)pcVar2;
    puVar4[6] = (char)((uint)param_3 >> 8);
    puVar4[7] = (char)param_3;
    FUN_10017f00(param_1);
    return 0;
  }
  return 0xffffffff;
}



int __cdecl
FUN_10018550(SOCKET *param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4)

{
  undefined1 *puVar1;
  SOCKET SVar2;
  int iVar3;
  undefined1 *puVar4;
  
  if ((param_1[0x10] == 0) || (SVar2 = param_1[0xe], param_1[0xf] != SVar2)) {
    if ((param_2 != (undefined4 *)0x0) ||
       ((param_3 != (undefined4 *)0x0 || (param_4 != (undefined4 *)0x0)))) {
      FUN_10017f00(param_1);
      if ((param_1[0x10] != 0) && (SVar2 = param_1[0xe], param_1[0xf] == SVar2)) goto LAB_1001859b;
    }
    iVar3 = -1;
  }
  else {
LAB_1001859b:
    puVar1 = (undefined1 *)param_1[0x10];
    iVar3 = SVar2 - 0xc;
    puVar4 = puVar1 + 0xc;
    if (iVar3 < 1) {
      puVar4 = &DAT_10039247;
    }
    else {
      puVar4[iVar3] = 0;
    }
    if (param_2 != (undefined4 *)0x0) {
      *param_2 = CONCAT31(CONCAT21(CONCAT11(*puVar1,puVar1[1]),puVar1[2]),puVar1[3]);
    }
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = CONCAT31(CONCAT21(CONCAT11(puVar1[4],puVar1[5]),puVar1[6]),puVar1[7]);
    }
    if (param_4 != (undefined4 *)0x0) {
      *param_4 = puVar4;
      return iVar3;
    }
  }
  return iVar3;
}



uint __cdecl
FUN_10018610(SOCKET *param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4,
            uint param_5)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  
  uVar1 = FUN_10018550(param_1,param_2,param_3,(undefined4 *)0x0);
  if (-1 < (int)uVar1) {
    if ((int)uVar1 < (int)param_5) {
      param_5 = uVar1;
    }
    if (param_4 != (undefined4 *)0x0) {
      puVar3 = (undefined4 *)(param_1[0x10] + 0xc);
      for (uVar2 = param_5 >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
        *param_4 = *puVar3;
        puVar3 = puVar3 + 1;
        param_4 = param_4 + 1;
      }
      for (uVar2 = param_5 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
        *(undefined1 *)param_4 = *(undefined1 *)puVar3;
        puVar3 = (undefined4 *)((int)puVar3 + 1);
        param_4 = (undefined4 *)((int)param_4 + 1);
      }
    }
    _free((void *)param_1[0x10]);
    param_1[0x10] = 0;
  }
  return uVar1;
}



void __cdecl FUN_10018680(void *param_1)

{
  int iVar1;
  undefined4 *_Memory;
  
  iVar1 = *(int *)((int)param_1 + 0x18);
  while (iVar1 != 0) {
    _Memory = *(undefined4 **)((int)param_1 + 0x18);
    *(undefined4 *)((int)param_1 + 0x18) = *_Memory;
    _free(_Memory);
    iVar1 = *(int *)((int)param_1 + 0x18);
  }
  _free(*(void **)((int)param_1 + 0x14));
  _free(param_1);
  return;
}



int __cdecl FUN_100186c0(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  if (param_2 < 1) {
    param_2 = 1;
  }
  puVar1 = (undefined4 *)_malloc((param_2 + 1) * 0xc);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = *(undefined4 *)(param_1 + 0x18);
    *(undefined4 **)(param_1 + 0x18) = puVar1;
    puVar2 = puVar1 + (param_2 + 1) * 3;
    while (puVar1 = puVar1 + 3, puVar1 != puVar2) {
      *puVar1 = *(undefined4 *)(param_1 + 0x1c);
      *(undefined4 **)(param_1 + 0x1c) = puVar1;
    }
    return param_2;
  }
  return -1;
}



int __cdecl FUN_10018720(int *param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  if (*param_1 == 0) {
    return 0;
  }
  iVar1 = param_1[5];
  if (*(int *)(iVar1 + param_1[1] * 4) == 0) {
    do {
      iVar3 = (param_1[1] + 1) % param_1[4];
      param_1[1] = iVar3;
    } while (*(int *)(param_1[5] + iVar3 * 4) == 0);
  }
  piVar2 = *(int **)(iVar1 + param_1[1] * 4);
  *(int *)(iVar1 + param_1[1] * 4) = *piVar2;
  *piVar2 = param_1[7];
  param_1[7] = (int)piVar2;
  *param_1 = *param_1 + -1;
  return piVar2[1];
}



undefined4 __cdecl FUN_10018780(undefined4 *param_1)

{
  return *param_1;
}



undefined4 __fastcall FUN_10018790(undefined4 param_1,byte *param_2,int param_3)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  
  uVar3 = 0;
  bVar2 = *param_2;
  while (bVar2 != 0) {
    if (' ' < (char)bVar2) {
      uVar3 = (bVar2 & 0x5f) + uVar3 * 0x83;
    }
    pbVar1 = param_2 + 1;
    param_2 = param_2 + 1;
    bVar2 = *pbVar1;
  }
  return (int)((longlong)(ulonglong)(uVar3 & 0x7fffffff) % (longlong)*(int *)(param_3 + 0x10));
}



undefined4 __thiscall FUN_10018820(void *this,int *param_1,byte *param_2,int param_3)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = FUN_10018790(this,param_2,(int)param_1);
  if (param_1[7] == 0) {
    iVar3 = FUN_100186c0((int)param_1,(*param_1 * 3 + 10) / 2);
    if (iVar3 < 1) {
      return 0xffffffff;
    }
  }
  piVar1 = (int *)param_1[7];
  param_1[7] = *piVar1;
  piVar1[2] = (int)param_2;
  piVar1[1] = param_3;
  *piVar1 = *(int *)(param_1[5] + iVar2 * 4);
  *(int **)(param_1[5] + iVar2 * 4) = piVar1;
  *param_1 = *param_1 + 1;
  return 1;
}



undefined4 __thiscall FUN_10018890(void *this,int param_1,byte *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = FUN_10018790(this,param_2,param_1);
  puVar1 = *(undefined4 **)(*(int *)(param_1 + 0x14) + iVar2 * 4);
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 0;
    }
    iVar2 = (**(code **)(param_1 + 0x20))(puVar1[2],param_2);
    if (iVar2 == 0) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return puVar1[1];
}



int __thiscall FUN_100188e0(void *this,int *param_1,byte *param_2)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  
  iVar3 = FUN_10018790(this,param_2,(int)param_1);
  piVar2 = *(int **)(param_1[5] + iVar3 * 4);
  piVar1 = (int *)(param_1[5] + iVar3 * 4);
  while( true ) {
    if (piVar2 == (int *)0x0) {
      return 0;
    }
    iVar3 = (*(code *)param_1[8])(*(undefined4 *)(*piVar1 + 8),param_2);
    if (iVar3 == 0) break;
    piVar1 = (int *)*piVar1;
    piVar2 = (int *)*piVar1;
  }
  *piVar1 = *piVar2;
  *piVar2 = param_1[7];
  param_1[7] = (int)piVar2;
  *param_1 = *param_1 + -1;
  return piVar2[1];
}



undefined4 __cdecl FUN_10018940(int *param_1,int param_2,int param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = param_2;
  if (param_2 < 0) {
    iVar3 = -param_2;
  }
  iVar1 = param_1[4];
  if (param_1[7] == 0) {
    iVar4 = FUN_100186c0((int)param_1,(*param_1 * 3 + 10) / 2);
    if (iVar4 < 1) {
      return 0xffffffff;
    }
  }
  piVar2 = (int *)param_1[7];
  param_1[7] = *piVar2;
  piVar2[2] = param_2;
  piVar2[1] = param_3;
  *piVar2 = *(int *)(param_1[5] + (iVar3 % iVar1) * 4);
  *(int **)(param_1[5] + (iVar3 % iVar1) * 4) = piVar2;
  *param_1 = *param_1 + 1;
  return 1;
}



undefined4 __cdecl FUN_100189b0(int param_1,int param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  int iVar3;
  
  iVar3 = param_2;
  if (param_2 < 0) {
    iVar3 = -param_2;
  }
  puVar1 = *(undefined4 **)(*(int *)(param_1 + 0x14) + (iVar3 % *(int *)(param_1 + 0x10)) * 4);
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 0;
    }
    if (puVar1[2] == param_2) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  uVar2 = puVar1[1];
  puVar1[1] = param_3;
  return uVar2;
}



undefined4 __cdecl FUN_100189f0(int param_1,int param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  iVar2 = param_2;
  if (param_2 < 0) {
    iVar2 = -param_2;
  }
  puVar1 = *(undefined4 **)(*(int *)(param_1 + 0x14) + (iVar2 % *(int *)(param_1 + 0x10)) * 4);
  while( true ) {
    if (puVar1 == (undefined4 *)0x0) {
      return 0;
    }
    if (puVar1[2] == param_2) break;
    puVar1 = (undefined4 *)*puVar1;
  }
  return puVar1[1];
}



int __cdecl FUN_10018a30(int *param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = param_2;
  if (param_2 < 0) {
    iVar4 = -param_2;
  }
  piVar1 = *(int **)(param_1[5] + (iVar4 % param_1[4]) * 4);
  piVar3 = (int *)(param_1[5] + (iVar4 % param_1[4]) * 4);
  while( true ) {
    if (piVar1 == (int *)0x0) {
      return 0;
    }
    piVar2 = (int *)*piVar3;
    if (piVar2[2] == param_2) break;
    piVar1 = (int *)*piVar2;
    piVar3 = piVar2;
  }
  *piVar3 = *piVar1;
  *piVar1 = param_1[7];
  param_1[7] = (int)piVar1;
  *param_1 = *param_1 + -1;
  return piVar1[1];
}



void __cdecl FUN_10018a80(int param_1)

{
  *(undefined4 *)(param_1 + 8) = 0;
  *(undefined4 *)(param_1 + 0xc) = 0;
  return;
}



undefined4 __cdecl FUN_10018a90(int param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  if (*(int *)(param_1 + 0xc) == 0) {
    if (*(int *)(param_1 + 8) < *(int *)(param_1 + 0x10)) {
      do {
        if (*(int *)(*(int *)(param_1 + 0x14) + *(int *)(param_1 + 8) * 4) != 0) break;
        iVar2 = *(int *)(param_1 + 8) + 1;
        *(int *)(param_1 + 8) = iVar2;
      } while (iVar2 < *(int *)(param_1 + 0x10));
    }
    iVar2 = *(int *)(param_1 + 8);
    if (*(int *)(param_1 + 0x10) <= iVar2) {
      return 0;
    }
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(*(int *)(param_1 + 0x14) + iVar2 * 4);
    *(int *)(param_1 + 8) = iVar2 + 1;
  }
  puVar1 = *(undefined4 **)(param_1 + 0xc);
  *(undefined4 *)(param_1 + 0xc) = *puVar1;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = puVar1[2];
  }
  return puVar1[1];
}



undefined4 * __cdecl FUN_10018b00(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  
  if (param_1 < 1) {
    param_1 = 1;
  }
  if (param_2 < 0x10) {
    param_2 = 0x10;
  }
  puVar1 = (undefined4 *)_malloc(0x24);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[4] = 0;
  puVar1[5] = 0;
  puVar1[6] = 0;
  puVar1[7] = 0;
  puVar1[8] = 0;
  puVar1[4] = param_2;
  puVar2 = (undefined4 *)_malloc(param_2 * 4);
  puVar1[5] = puVar2;
  for (uVar3 = puVar1[4] & 0x3fffffff; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  puVar1[8] = &LAB_100187d0;
  if (0 < param_1) {
    FUN_100186c0((int)puVar1,param_1);
  }
  return puVar1;
}



undefined4 * __cdecl FUN_10018b90(int param_1)

{
  byte *pbVar1;
  int in_EAX;
  undefined4 *puVar2;
  undefined4 *puVar3;
  byte bVar4;
  int iVar5;
  uint uVar6;
  
  puVar2 = (undefined4 *)_malloc(0x31c);
  puVar3 = puVar2;
  for (iVar5 = 199; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  *puVar2 = 1;
  puVar2[1] = in_EAX;
  puVar3 = (undefined4 *)_malloc(in_EAX * 0x50);
  puVar2[2] = puVar3;
  for (uVar6 = (uint)(puVar2[1] * 0x50) >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  puVar2[3] = 1;
  puVar2[4] = param_1;
  puVar3 = (undefined4 *)_malloc(param_1 * 4);
  puVar2[5] = puVar3;
  for (uVar6 = puVar2[4] & 0x3fffffff; uVar6 != 0; uVar6 = uVar6 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  puVar3 = (undefined4 *)((int)puVar2 + 0x1d);
  for (iVar5 = 0x3f; iVar5 != 0; iVar5 = iVar5 + -1) {
    *puVar3 = 0x27272727;
    puVar3 = puVar3 + 1;
  }
  *(undefined2 *)puVar3 = 0x2727;
  *(undefined1 *)((int)puVar3 + 2) = 0x27;
  uVar6 = 0x41;
  do {
    bVar4 = (byte)uVar6 & 0x1f;
    pbVar1 = (byte *)((int)(puVar2 + 0xf) + uVar6);
    pbVar1[(int)puVar2 + (0x1c - (int)(puVar2 + 0xf))] = bVar4;
    *pbVar1 = bVar4;
    *(byte *)((uVar6 & 0x1f) + 0x11c + (int)puVar2) = (byte)uVar6;
    uVar6 = uVar6 + 1;
  } while ((int)uVar6 < 0x5b);
  puVar2[6] = 0x1b;
  return puVar2;
}



int * __cdecl FUN_10018c70(int *param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  int *piVar5;
  undefined4 *puVar6;
  int *piVar7;
  
  piVar1 = (int *)_malloc(0x31c);
  piVar5 = param_1;
  piVar7 = piVar1;
  for (iVar3 = 199; iVar3 != 0; iVar3 = iVar3 + -1) {
    *piVar7 = *piVar5;
    piVar5 = piVar5 + 1;
    piVar7 = piVar7 + 1;
  }
  iVar3 = *param_1;
  *piVar1 = iVar3;
  piVar1[1] = iVar3;
  puVar2 = (undefined4 *)_malloc(iVar3 * 0x50);
  piVar1[2] = (int)puVar2;
  puVar6 = (undefined4 *)param_1[2];
  for (uVar4 = (uint)(piVar1[1] * 0x50) >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = *puVar6;
    puVar6 = puVar6 + 1;
    puVar2 = puVar2 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar2 = *(undefined1 *)puVar6;
    puVar6 = (undefined4 *)((int)puVar6 + 1);
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  iVar3 = param_1[3];
  piVar1[3] = iVar3;
  piVar1[4] = iVar3;
  puVar2 = (undefined4 *)_malloc(iVar3 << 2);
  piVar1[5] = (int)puVar2;
  puVar6 = (undefined4 *)param_1[5];
  for (uVar4 = piVar1[4] & 0x3fffffff; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = *puVar6;
    puVar6 = puVar6 + 1;
    puVar2 = puVar2 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar2 = *(undefined1 *)puVar6;
    puVar6 = (undefined4 *)((int)puVar6 + 1);
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  return piVar1;
}



void __cdecl FUN_10018d00(byte param_1)

{
  byte *pbVar1;
  byte bVar2;
  int *in_EAX;
  byte *pbVar3;
  byte *unaff_EBX;
  ushort uVar4;
  uint uVar5;
  
  uVar5 = 0;
  uVar4 = 0;
  bVar2 = *unaff_EBX;
  pbVar3 = unaff_EBX;
  while (bVar2 != 0) {
    uVar4 = *(ushort *)(in_EAX[2] + ((uint)*pbVar3 + uVar5 * 0x28) * 2);
    if (uVar4 == 0) {
      uVar4 = *(ushort *)(in_EAX + 3);
      in_EAX[3] = in_EAX[3] + 1;
      *(ushort *)(in_EAX[2] + ((uint)*pbVar3 + uVar5 * 0x28) * 2) = uVar4;
    }
    if ((pbVar3[1] != 0) && (*(short *)(in_EAX[5] + (uint)uVar4 * 4) == 0)) {
      *(short *)(in_EAX[5] + (uint)uVar4 * 4) = (short)*in_EAX;
      *in_EAX = *in_EAX + 1;
    }
    uVar5 = (uint)*(ushort *)(in_EAX[5] + (uint)uVar4 * 4);
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  if ((param_1 & 4) == 0) {
    *(char *)(in_EAX[5] + 3 + (uint)uVar4 * 4) = (char)pbVar3 - (char)unaff_EBX;
    *(byte *)(in_EAX[5] + 2 + (uint)uVar4 * 4) = param_1;
  }
  return;
}



void __cdecl FUN_10018da0(int param_1,int param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  short *psVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  
  uVar3 = (uint)*(ushort *)
                 (*(int *)(param_1 + 0x14) +
                 (uint)*(ushort *)(*(int *)(param_1 + 8) + (param_5 + param_3 * 0x28) * 2) * 4);
  uVar5 = (uint)*(ushort *)
                 (*(int *)(param_2 + 0x14) +
                 (uint)*(ushort *)(*(int *)(param_2 + 8) + (param_5 + param_4 * 0x28) * 2) * 4);
  if ((uVar3 != 0) && (uVar5 != 0)) {
    iVar4 = 0;
    iVar1 = uVar3 * 0x50;
    do {
      psVar2 = (short *)(iVar1 + *(int *)(param_1 + 8));
      if (*psVar2 == 0) {
        *psVar2 = *(short *)(*(int *)(param_2 + 8) + (iVar4 + uVar5 * 0x28) * 2);
      }
      else {
        FUN_10018da0(param_1,param_2,uVar3,uVar5,iVar4);
      }
      iVar4 = iVar4 + 1;
      iVar1 = iVar1 + 2;
    } while (iVar4 < 0x28);
  }
  return;
}



void __cdecl FUN_10018e50(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  iVar3 = 0;
  iVar1 = param_4 * 0x50;
  do {
    uVar2 = (uint)*(ushort *)
                   (*(int *)(param_2 + 0x14) + (uint)*(ushort *)(iVar1 + *(int *)(param_2 + 8)) * 4)
    ;
    if (uVar2 != 0) {
      if (0 < param_3) {
        FUN_10018da0(param_1,param_2,param_4,0,iVar3);
      }
      FUN_10018e50(param_1,param_2,param_3 + 1,uVar2);
    }
    iVar3 = iVar3 + 1;
    iVar1 = iVar1 + 2;
  } while (iVar3 < 0x28);
  return;
}



void __fastcall FUN_10018ec0(undefined4 param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 1;
  if (1 < *param_2) {
    iVar2 = 0x50;
    do {
      iVar3 = 6;
      do {
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + iVar1) == 0) && (*(short *)(iVar3 + -6 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + iVar1) = *(undefined2 *)(iVar3 + -6 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 2 + iVar1) == 0) && (*(short *)(iVar3 + -4 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 2 + iVar1) = *(undefined2 *)(iVar3 + -4 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 4 + iVar1) == 0) && (*(short *)(iVar3 + -2 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 4 + iVar1) = *(undefined2 *)(iVar3 + -2 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 6 + iVar1) == 0) && (*(short *)(iVar3 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 6 + iVar1) = *(undefined2 *)(iVar3 + iVar1);
        }
        iVar1 = param_2[2];
        if ((*(short *)(iVar2 + 8 + iVar1) == 0) && (*(short *)(iVar3 + 2 + iVar1) != 0)) {
          *(undefined2 *)(iVar2 + 8 + iVar1) = *(undefined2 *)(iVar3 + 2 + iVar1);
        }
        iVar3 = iVar3 + 10;
        iVar2 = iVar2 + 10;
      } while (iVar3 < 0x56);
      iVar4 = iVar4 + 1;
    } while (iVar4 < *param_2);
  }
  return;
}



void __cdecl FUN_10018f90(int param_1,int param_2)

{
  ushort *puVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  
  iVar4 = 0;
  iVar3 = param_2 * 0x50;
  do {
    uVar2 = *(ushort *)(iVar3 + *(int *)(param_1 + 8));
    uVar5 = (uint)*(ushort *)(*(int *)(param_1 + 0x14) + (uint)uVar2 * 4);
    if (uVar5 != 0) {
      FUN_10018f90(param_1,uVar5);
      puVar1 = (ushort *)(*(int *)(param_1 + 8) + (iVar4 + uVar5 * 0x28) * 2);
      if (*puVar1 == 0) {
        *puVar1 = uVar2;
      }
    }
    iVar4 = iVar4 + 1;
    iVar3 = iVar3 + 2;
  } while (iVar4 < 0x28);
  return;
}



void FUN_10018ff0(void)

{
  int iVar1;
  int *in_EAX;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  int local_8;
  int local_4;
  
  iVar2 = 0;
  local_4 = 0;
  if (0 < *in_EAX) {
    do {
      pbVar3 = (byte *)(in_EAX + 0x87);
      local_8 = 0x40;
      do {
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(*pbVar3 + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x200] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(pbVar3[1] + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x1ff] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(pbVar3[2] + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x1fe] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        iVar1 = in_EAX[2];
        iVar4 = ((uint)*(byte *)(pbVar3[3] + 0x1c + (int)in_EAX) + iVar2) * 2;
        if ((*(short *)(iVar4 + iVar1) != 0) &&
           (iVar5 = ((uint)pbVar3[-0x1fd] + iVar2) * 2,
           *(ushort *)(iVar5 + iVar1) < *(ushort *)(iVar1 + iVar4))) {
          *(undefined2 *)(iVar1 + iVar5) = *(undefined2 *)(iVar1 + iVar4);
        }
        pbVar3 = pbVar3 + 4;
        local_8 = local_8 + -1;
      } while (local_8 != 0);
      local_4 = local_4 + 1;
      iVar2 = iVar2 + 0x28;
    } while (local_4 < *in_EAX);
  }
  return;
}



void __fastcall FUN_10019120(undefined4 param_1,int param_2)

{
  ushort *puVar1;
  uint uVar2;
  int iVar3;
  short *psVar4;
  int iVar5;
  int iVar6;
  
  iVar6 = 0;
  if (0 < *(int *)(param_2 + 0xc)) {
    do {
      puVar1 = (ushort *)(*(int *)(param_2 + 0x14) + iVar6 * 4);
      uVar2 = (uint)*puVar1;
      if ((uVar2 != 0) && (*(char *)((int)puVar1 + 3) == '\0')) {
        iVar3 = uVar2 * 0x50 + 0x36;
        iVar5 = 0xd;
        do {
          psVar4 = (short *)(*(int *)(param_2 + 8) + iVar3);
          if (*psVar4 == 0) {
            *psVar4 = (short)iVar6;
          }
          iVar3 = iVar3 + 2;
          iVar5 = iVar5 + -1;
        } while (iVar5 != 0);
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < *(int *)(param_2 + 0xc));
  }
  return;
}



void FUN_10019180(void)

{
  byte *in_EAX;
  byte bVar1;
  uint uVar2;
  uint uVar3;
  undefined1 *unaff_ESI;
  
  *unaff_ESI = 0;
  bVar1 = *in_EAX;
  if (0x1f < bVar1) {
    while (bVar1 != 0x24) {
      if (0x20 < bVar1) goto LAB_100191ff;
      bVar1 = in_EAX[1];
      in_EAX = in_EAX + 1;
      if (bVar1 < 0x20) {
        return;
      }
    }
    if ((0x20 < in_EAX[1]) && (0x20 < in_EAX[2])) {
      uVar3 = 0x100;
      do {
        in_EAX = in_EAX + 1;
        bVar1 = *in_EAX;
        if ((bVar1 < 0x30) || (0x39 < bVar1)) {
          if ((bVar1 < 0x61) || (0x66 < bVar1)) {
            if ((bVar1 < 0x41) || (0x46 < bVar1)) goto LAB_10019202;
            uVar2 = bVar1 - 0x37;
          }
          else {
            uVar2 = bVar1 - 0x57;
          }
          uVar3 = uVar3 << 4 | uVar2;
        }
        else {
          uVar3 = bVar1 & 0xf | uVar3 << 4;
        }
        if (0xffff < (int)uVar3) {
          *unaff_ESI = (char)uVar3;
          return;
        }
      } while( true );
    }
LAB_100191ff:
    uVar3 = (uint)*in_EAX;
LAB_10019202:
    *unaff_ESI = (char)uVar3;
  }
  return;
}



void __cdecl FUN_10019210(void *param_1)

{
  void *_Memory;
  
  _Memory = *(void **)((int)param_1 + 0x108);
  if (_Memory != (void *)0x0) {
    _free(*(void **)((int)_Memory + 8));
    _free(*(void **)((int)_Memory + 0x14));
    _free(_Memory);
  }
  _free(param_1);
  return;
}



void __cdecl FUN_10019250(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  int iVar2;
  
  iVar2 = 0;
  if (*param_2 < 0x20) {
    *param_1 = 0;
    param_1[1] = 0;
    return;
  }
  do {
    if (0xfe < iVar2) break;
    if (*param_2 != 0x20) {
      *(byte *)(iVar2 + 8 + (int)param_1) = *param_2;
      iVar2 = iVar2 + 1;
    }
    pbVar1 = param_2 + 1;
    param_2 = param_2 + 1;
  } while (0x1f < *pbVar1);
  *param_1 = 0;
  param_1[1] = iVar2;
  return;
}



int __cdecl FUN_100192a0(undefined4 *param_1,byte *param_2)

{
  undefined1 *puVar1;
  byte bVar2;
  void *_Memory;
  int iVar3;
  int *_Memory_00;
  char *pcVar4;
  char *pcVar5;
  int *piVar6;
  byte *pbVar7;
  undefined4 extraout_ECX;
  undefined4 extraout_ECX_00;
  uint uVar8;
  byte *pbVar9;
  int iVar10;
  byte bVar11;
  int local_104;
  byte local_100 [256];
  
  local_104 = 0;
  if (param_2 == (byte *)0x0) {
    param_2 = PTR_s_ass_ass___bitch_cunt_dildo_fuck_j_10041190;
  }
  _Memory_00 = FUN_10018b90(0x2000);
  pcVar4 = _strstr((char *)param_2,"~repl:");
  if (pcVar4 != (char *)0x0) {
    FUN_10019250(param_1,(byte *)(pcVar4 + 6));
  }
  bVar11 = *PTR_DAT_10041188;
  pbVar7 = PTR_DAT_10041188;
  while (bVar11 != 0) {
    bVar11 = pbVar7[1];
    bVar2 = *pbVar7;
    uVar8 = (uint)bVar11;
    if (*(char *)(uVar8 + 0x1c + (int)_Memory_00) == '\'') {
      puVar1 = (undefined1 *)(bVar2 + 0x1c + (int)_Memory_00);
      *(undefined1 *)((int)_Memory_00 + uVar8 + 0x1c) = *puVar1;
      if (bVar2 == bVar11) {
        *puVar1 = (char)_Memory_00[6];
        *(byte *)(_Memory_00[6] + 0x11c + (int)_Memory_00) = bVar2;
        _Memory_00[6] = _Memory_00[6] + 1;
      }
    }
    pbVar7 = pbVar7 + 2;
    *(byte *)((int)_Memory_00 + uVar8 + 0x21c) = bVar2;
    bVar11 = *pbVar7;
  }
  pcVar4 = _strstr((char *)param_2,"~equiv:");
  pcVar5 = PTR_DAT_1004118c;
  if (pcVar4 != (char *)0x0) goto LAB_10019380;
  while (pcVar4 = pcVar5, pcVar4 != (char *)0x0) {
LAB_10019380:
    pbVar7 = (byte *)(pcVar4 + 7);
    bVar11 = pcVar4[7];
    while (0x1f < bVar11) {
      FUN_10019180();
      pbVar7 = (byte *)FUN_10019180();
      if ((0x20 < local_100[0]) && (0x20 < local_100[1])) {
        uVar8 = (uint)local_100[1];
        if (*(char *)(uVar8 + 0x1c + (int)_Memory_00) == '\'') {
          *(undefined1 *)(uVar8 + 0x1c + (int)_Memory_00) =
               *(undefined1 *)(local_100[0] + 0x1c + (int)_Memory_00);
          if (local_100[0] == local_100[1]) {
            *(char *)(local_100[0] + 0x1c + (int)_Memory_00) = (char)_Memory_00[6];
            *(byte *)(_Memory_00[6] + 0x11c + (int)_Memory_00) = local_100[0];
            _Memory_00[6] = _Memory_00[6] + 1;
          }
        }
        *(byte *)(uVar8 + 0x21c + (int)_Memory_00) = local_100[0];
      }
      bVar11 = *pbVar7;
    }
    pcVar5 = _strstr((char *)pbVar7,"~equiv:");
  }
  bVar11 = *param_2;
  while (bVar11 != 0) {
    bVar11 = *param_2;
    if (bVar11 < 0x21) {
      pbVar7 = param_2 + 1;
    }
    else {
      pbVar7 = param_2;
      if ((bVar11 == 0x23) || (bVar11 == 0x7e)) {
        do {
          pbVar9 = pbVar7 + 1;
          pbVar7 = pbVar7 + 1;
        } while (0x1f < *pbVar9);
      }
      else {
        bVar11 = bVar11 == 0x2a;
        if ((bool)bVar11) {
          param_2 = param_2 + 1;
        }
        bVar2 = *param_2;
        pbVar7 = param_2;
        while (((0x20 < bVar2 && (bVar2 != 0x2a)) && (bVar2 != 0x2e))) {
          pbVar9 = pbVar7 + 1;
          pbVar7 = pbVar7 + 1;
          bVar2 = *pbVar9;
        }
        if ((int)pbVar7 - (int)param_2 < 0x100) {
          pbVar9 = local_100;
          while (param_2 < pbVar7) {
            param_2 = (byte *)FUN_10019180();
            *pbVar9 = *(byte *)(*pbVar9 + 0x1c + (int)_Memory_00);
            pbVar9 = pbVar9 + 1;
          }
          bVar2 = *pbVar7;
          *pbVar9 = 0;
          if (bVar2 == 0x2a) {
            bVar11 = bVar11 | 2;
            pbVar7 = pbVar7 + 1;
          }
          if (*pbVar7 == 0x2e) {
            bVar11 = bVar11 | 4;
            pbVar7 = pbVar7 + 1;
          }
          FUN_10018d00(bVar11);
          local_104 = local_104 + 1;
        }
      }
    }
    param_2 = pbVar7;
    bVar11 = *pbVar7;
  }
  _Memory = (void *)param_1[0x42];
  if (_Memory != (void *)0x0) {
    _free(*(void **)((int)_Memory + 8));
    _free(*(void **)((int)_Memory + 0x14));
    _free(_Memory);
  }
  piVar6 = FUN_10018c70(_Memory_00);
  param_1[0x42] = piVar6;
  FUN_10018f90((int)piVar6,0);
  FUN_10018ff0();
  iVar3 = param_1[0x42];
  iVar10 = 0;
  do {
    uVar8 = (uint)*(ushort *)(_Memory_00[5] + (uint)*(ushort *)(iVar10 + _Memory_00[2]) * 4);
    if (uVar8 != 0) {
      FUN_10018e50(iVar3,(int)_Memory_00,1,uVar8);
    }
    iVar10 = iVar10 + 2;
  } while (iVar10 < 0x50);
  _free((void *)_Memory_00[2]);
  _free((void *)_Memory_00[5]);
  _free(_Memory_00);
  FUN_10018ec0(extraout_ECX,(int *)param_1[0x42]);
  FUN_10019120(extraout_ECX_00,param_1[0x42]);
  return local_104;
}



int __cdecl FUN_100195a0(int *param_1,byte *param_2)

{
  ushort *puVar1;
  byte bVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  int iVar11;
  uint uVar12;
  int local_2c;
  byte abStack_20 [32];
  
  uVar10 = 0;
  local_2c = 0;
  if (param_1 == (int *)0x0) {
    return 0;
  }
  if ((param_2 != (byte *)0x0) && (*param_2 != 0)) {
    iVar4 = param_1[0x42];
    uVar7 = 0;
    if (iVar4 != 0) {
      bVar2 = *(byte *)(*param_2 + 0x1c + iVar4);
      while (bVar2 != 0) {
        iVar5 = *(int *)(iVar4 + 8);
        iVar11 = uVar7 * 0x28;
        uVar8 = (uint)*(ushort *)(iVar5 + ((uint)bVar2 + iVar11) * 2);
        puVar1 = (ushort *)(*(int *)(iVar4 + 0x14) + uVar8 * 4);
        uVar9 = (uint)*(byte *)((int)puVar1 + 3);
        uVar12 = uVar10 & 0x1f;
        uVar10 = uVar10 + 1;
        abStack_20[uVar12] = uVar7 != *puVar1;
        uVar7 = uVar10;
        if (uVar9 != 0) {
          while ((0 < (int)uVar7 && (0 < (int)uVar9))) {
            uVar9 = uVar9 - abStack_20[uVar7 - 1 & 0x1f];
            uVar7 = uVar7 - 1;
          }
          bVar2 = *(byte *)(*(int *)(iVar4 + 0x14) + 2 + uVar8 * 4);
          if ((bVar2 & 1) == 0) {
            if ((0 < (int)uVar7) && ((&DAT_1003cd08)[param_2[uVar7 - 1]] == '\0')) {
              cVar3 = *(char *)(param_2[uVar7] + 0x1c + iVar4);
              uVar9 = uVar7;
              if (*(char *)(param_2[uVar7 + 1] + 0x1c + iVar4) == cVar3) {
                do {
                  iVar6 = uVar9 + 2;
                  uVar9 = uVar9 + 1;
                } while (*(char *)(param_1[0x42] + 0x1c + (uint)param_2[iVar6]) == cVar3);
              }
              while (((int)uVar9 < (int)uVar10 && ((&DAT_1003cd08)[param_2[uVar9 + 1]] != '\0'))) {
                uVar9 = uVar9 + 1;
              }
              if (*(char *)(param_2[uVar9 + 1] + 0x1c + iVar4) == cVar3) {
                uVar7 = uVar9 + 1;
              }
            }
          }
          else {
            while ((0 < (int)uVar7 && ((&DAT_1003cd08)[param_2[uVar7 - 1]] == '\0'))) {
              uVar7 = uVar7 - 1;
            }
          }
          uVar9 = uVar10;
          if (*(ushort *)(iVar5 + ((uint)*(byte *)(param_2[uVar10] + 0x1c + iVar4) + iVar11) * 2) ==
              uVar8) {
            do {
              iVar4 = uVar9 + 1;
              uVar9 = uVar9 + 1;
            } while (*(ushort *)
                      (*(int *)(param_1[0x42] + 8) +
                      ((uint)*(byte *)(param_2[iVar4] + 0x1c + param_1[0x42]) + iVar11) * 2) ==
                     uVar8);
          }
          if ((bVar2 & 2) != 0) {
            bVar2 = param_2[uVar9];
            while ((bVar2 != 0 && ((&DAT_1003cd08)[bVar2] == '\0'))) {
              iVar4 = uVar9 + 1;
              uVar9 = uVar9 + 1;
              bVar2 = param_2[iVar4];
            }
          }
          if (((uVar7 == 0) || ((&DAT_1003cd08)[param_2[uVar7 - 1]] != '\0')) &&
             ((param_2[uVar9] == 0 || ((&DAT_1003cd08)[param_2[uVar9]] != '\0')))) {
            cVar3 = (&DAT_1003cd08)[param_2[uVar7]];
            while (cVar3 != '\0') {
              iVar4 = uVar7 + 1;
              uVar7 = uVar7 + 1;
              cVar3 = (&DAT_1003cd08)[param_2[iVar4]];
            }
            cVar3 = (&DAT_1003cd08)[param_2[uVar9 - 1]];
            while (cVar3 != '\0') {
              iVar4 = uVar9 - 2;
              uVar9 = uVar9 - 1;
              cVar3 = (&DAT_1003cd08)[param_2[iVar4]];
            }
            for (; (int)uVar7 < (int)uVar9; uVar7 = uVar7 + 1) {
              iVar4 = *param_1;
              *param_1 = iVar4 + 1;
              param_2[uVar7] = *(byte *)((iVar4 + 1) % param_1[1] + 8 + (int)param_1);
            }
            for (; (int)uVar10 < (int)uVar9; uVar10 = uVar10 + 1) {
              abStack_20[uVar10 & 0x1f] = 0;
            }
            local_2c = local_2c + 1;
          }
        }
        iVar4 = param_1[0x42];
        uVar7 = (uint)*(ushort *)(*(int *)(iVar4 + 0x14) + uVar8 * 4);
        bVar2 = *(byte *)(param_2[uVar10] + 0x1c + iVar4);
      }
      return local_2c;
    }
  }
  return 0;
}



int __cdecl FUN_10019870(undefined4 param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  
  bVar1 = *param_2;
  iVar3 = 0;
  pbVar5 = param_2;
  while ((bVar1 != 0 && (iVar2 = _isspace((uint)*pbVar5), iVar2 != 0))) {
    bVar1 = pbVar5[1];
    iVar3 = iVar3 + 1;
    pbVar5 = pbVar5 + 1;
  }
  bVar1 = *pbVar5;
  pbVar4 = param_2;
  if (bVar1 != 0) {
    do {
      if ((((bVar1 == 0x20) && (param_2 + 3 < pbVar4)) && (pbVar4[-1] == 0x20)) &&
         ((pbVar4[-2] == 0x20 && (pbVar4[-3] == 0x20)))) {
        iVar3 = iVar3 + 1;
      }
      else {
        *pbVar4 = bVar1;
        pbVar4 = pbVar4 + 1;
      }
      bVar1 = pbVar5[1];
      pbVar5 = pbVar5 + 1;
    } while (bVar1 != 0);
    while ((pbVar4 != param_2 && (iVar2 = _isspace((uint)pbVar4[-1]), iVar2 != 0))) {
      iVar3 = iVar3 + 1;
      pbVar4 = pbVar4 + -1;
    }
  }
  *pbVar4 = 0;
  return iVar3;
}



undefined4 * FUN_10019900(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0x10c);
  puVar3 = puVar1;
  for (iVar2 = 0x43; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  FUN_10019250(puVar1,&DAT_1003ce18);
  return puVar1;
}



int * __cdecl FUN_10019930(int param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  
  piVar1 = (int *)_malloc(0xc);
  *piVar1 = 0;
  piVar1[1] = 0;
  piVar1[2] = 0;
  if (param_1 < 6) {
    param_1 = 0x10;
  }
  *piVar1 = param_1;
  puVar2 = (undefined4 *)_malloc(param_1 << 4);
  piVar1[2] = (int)puVar2;
  for (uVar3 = (uint)(*piVar1 << 4) >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  return piVar1;
}



void __cdecl FUN_10019990(int *param_1)

{
  void *_Memory;
  int iVar1;
  int iVar2;
  
  iVar1 = 0;
  if (0 < *param_1) {
    iVar2 = 0;
    do {
      _Memory = *(void **)(iVar2 + 0xc + param_1[2]);
      if (_Memory != (void *)0x0) {
        _free(_Memory);
      }
      iVar1 = iVar1 + 1;
      iVar2 = iVar2 + 0x10;
    } while (iVar1 < *param_1);
  }
  _free((void *)param_1[2]);
  _free(param_1);
  return;
}



undefined4 * __cdecl FUN_100199e0(int *param_1,size_t param_2)

{
  void *pvVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)(param_1[1] * 0x10 + param_1[2]);
  param_1[1] = (param_1[1] + 1) % *param_1;
  if ((0 < (int)puVar2[2]) && ((int)puVar2[2] < (int)param_2)) {
    _free((void *)puVar2[3]);
    puVar2[3] = &DAT_10039247;
    puVar2[2] = 0;
  }
  if ((puVar2[2] == 0) && (0 < (int)param_2)) {
    pvVar1 = _malloc(param_2);
    puVar2[3] = pvVar1;
    puVar2[2] = param_2;
  }
  puVar2[1] = 0;
  *puVar2 = 0;
  return puVar2;
}



void __cdecl FUN_10019a50(undefined4 param_1)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)_malloc(0x10);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[3] = param_1;
  return;
}



void __cdecl FUN_10019a80(void *param_1,char param_2)

{
  void *pvVar1;
  void *_Memory;
  
  if (param_1 != (void *)0x0) {
    if (param_2 != '\0') {
      _Memory = *(void **)((int)param_1 + 4);
      while (_Memory != (void *)0x0) {
        if (*(code **)((int)param_1 + 0xc) != (code *)0x0) {
          (**(code **)((int)param_1 + 0xc))((int)_Memory + 0xc);
        }
        pvVar1 = *(void **)((int)_Memory + 8);
        _free(_Memory);
        _Memory = pvVar1;
      }
    }
    _free(param_1);
  }
  return;
}



undefined4 * __cdecl FUN_10019ad0(undefined4 param_1,int param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)_malloc(param_2 + 0xc);
  *puVar1 = param_1;
  puVar1[1] = 0;
  puVar1[2] = 0;
  return puVar1 + 3;
}



void __cdecl FUN_10019b00(int param_1,int param_2)

{
  if (param_2 != 0) {
    if (*(code **)(param_1 + 0xc) != (code *)0x0) {
      (**(code **)(param_1 + 0xc))(param_2);
    }
    _free((void *)(param_2 + -0xc));
  }
  return;
}



void __cdecl FUN_10019b30(int *param_1,int param_2)

{
  int iVar1;
  
  iVar1 = param_2 + -0xc;
  *(int *)(param_2 + -8) = param_1[2];
  *(undefined4 *)(param_2 + -4) = 0;
  if (param_1[2] != 0) {
    *(int *)(param_1[2] + 8) = iVar1;
  }
  param_1[2] = iVar1;
  if (param_1[1] == 0) {
    param_1[1] = iVar1;
  }
  *param_1 = *param_1 + 1;
  return;
}



int __cdecl FUN_10019b70(int param_1)

{
  if (*(int *)(param_1 + 4) != 0) {
    return *(int *)(param_1 + 4) + 0xc;
  }
  return 0;
}



void __cdecl FUN_10019b90(int *param_1)

{
  void *_Memory;
  int iVar1;
  
  _Memory = (void *)param_1[1];
  if (_Memory != (void *)0x0) {
    iVar1 = *(int *)((int)_Memory + 8);
    param_1[1] = iVar1;
    if (iVar1 != 0) {
      *(undefined4 *)(iVar1 + 4) = 0;
    }
    if ((void *)param_1[2] == _Memory) {
      param_1[2] = param_1[1];
    }
    *param_1 = *param_1 + -1;
    if ((code *)param_1[3] != (code *)0x0) {
      (*(code *)param_1[3])((int)_Memory + 0xc);
    }
    _free(_Memory);
  }
  return;
}



void __cdecl FUN_10019be0(int *param_1,int param_2,char param_3)

{
  void *_Memory;
  
  _Memory = (void *)(param_2 + -0xc);
  if (*(int *)(param_2 + -8) != 0) {
    *(undefined4 *)(*(int *)(param_2 + -8) + 8) = *(undefined4 *)(param_2 + -4);
  }
  if (*(int *)(param_2 + -4) != 0) {
    *(undefined4 *)(*(int *)(param_2 + -4) + 4) = *(undefined4 *)(param_2 + -8);
  }
  if (_Memory == (void *)param_1[1]) {
    param_1[1] = *(int *)(param_2 + -4);
  }
  if (_Memory == (void *)param_1[2]) {
    param_1[2] = *(int *)(param_2 + -8);
  }
  *param_1 = *param_1 + -1;
  if (param_3 != '\0') {
    if ((code *)param_1[3] != (code *)0x0) {
      (*(code *)param_1[3])(param_2);
    }
    _free(_Memory);
  }
  return;
}



undefined4 * __cdecl FUN_10019c50(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    return param_1;
  }
  return (undefined4 *)*param_1;
}



int __cdecl FUN_10019c60(undefined4 param_1,int param_2)

{
  int iVar1;
  
  iVar1 = *(int *)(param_2 + -4);
  if (iVar1 == 0) {
    return iVar1;
  }
  return iVar1 + 0xc;
}



int __cdecl FUN_10019c70(char *param_1,char *param_2)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  
  while( true ) {
    do {
      bVar1 = (&DAT_1003ce20)[*param_1];
      param_1 = param_1 + 1;
    } while (bVar1 == 1);
    do {
      cVar2 = *param_2;
      param_2 = param_2 + 1;
    } while ((&DAT_1003ce20)[cVar2] == 1);
    iVar3 = (uint)bVar1 - (uint)(byte)(&DAT_1003ce20)[cVar2];
    if (iVar3 != 0) break;
    if (bVar1 == 0) {
      return 0;
    }
  }
  return iVar3;
}



undefined4 __cdecl FUN_10019cc0(char *param_1,char *param_2)

{
  char cVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  if ((param_2 == (char *)0x0) || (*param_2 == '\0')) {
    return 1;
  }
  if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
    iVar4 = 0;
    do {
      iVar3 = 0;
      iVar5 = iVar4;
      do {
        do {
          cVar1 = (&DAT_1003ce20)[param_1[iVar5]];
          iVar5 = iVar5 + 1;
        } while (cVar1 == '\x01');
        do {
          cVar2 = (&DAT_1003ce20)[param_2[iVar3]];
          iVar3 = iVar3 + 1;
        } while (cVar2 == '\x01');
        if (cVar2 == '\0') {
          return 1;
        }
      } while ((cVar1 != '\0') && (cVar1 == cVar2));
      iVar5 = iVar4 + 1;
      iVar4 = iVar4 + 1;
      if (param_1[iVar5] == '\0') {
        return 0;
      }
    } while( true );
  }
  return 0;
}



int FUN_10019d40(void)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  uint uVar4;
  int unaff_EBX;
  int iVar5;
  int iVar6;
  undefined4 *puVar7;
  
  puVar2 = *(undefined4 **)(unaff_EBX + 0x1c);
  puVar3 = puVar2;
  if (puVar2 != puVar2 + *(int *)(unaff_EBX + 0x14) * 4) {
    do {
      if (puVar2[1] != 0) {
        if ((puVar2[3] == 0) && (*(int *)(unaff_EBX + 0x2c) < *(int *)(unaff_EBX + 0x28))) {
          puVar2[1] = 0;
          *(int *)(unaff_EBX + 0x28) = *(int *)(unaff_EBX + 0x28) + -1;
        }
        else {
          *puVar3 = *puVar2;
          puVar3[1] = puVar2[1];
          puVar3[2] = puVar2[2];
          puVar3[3] = puVar2[3];
          puVar3 = puVar3 + 4;
        }
      }
      puVar2 = puVar2 + 4;
    } while (puVar2 != (undefined4 *)
                       (*(int *)(unaff_EBX + 0x14) * 0x10 + *(int *)(unaff_EBX + 0x1c)));
  }
  iVar5 = *(int *)(unaff_EBX + 0x18);
  iVar6 = *(int *)(unaff_EBX + 0x14) - ((int)puVar2 - (int)puVar3 >> 4);
  iVar1 = iVar6 * 100;
  *(int *)(unaff_EBX + 0x14) = iVar6;
  if (iVar1 + iVar5 * -0x55 != 0 && iVar5 * 0x55 <= iVar1) {
    iVar5 = (iVar5 * 3) / 2;
    puVar2 = (undefined4 *)_malloc(iVar5 << 4);
    if (puVar2 != (undefined4 *)0x0) {
      puVar3 = *(undefined4 **)(unaff_EBX + 0x1c);
      puVar7 = puVar2;
      for (uVar4 = (uint)(*(int *)(unaff_EBX + 0x14) << 4) >> 2; uVar4 != 0; uVar4 = uVar4 - 1) {
        *puVar7 = *puVar3;
        puVar3 = puVar3 + 1;
        puVar7 = puVar7 + 1;
      }
      for (iVar1 = 0; iVar1 != 0; iVar1 = iVar1 + -1) {
        *(undefined1 *)puVar7 = *(undefined1 *)puVar3;
        puVar3 = (undefined4 *)((int)puVar3 + 1);
        puVar7 = (undefined4 *)((int)puVar7 + 1);
      }
      *(int *)(unaff_EBX + 0x18) = iVar5;
      _free(*(void **)(unaff_EBX + 0x1c));
      *(undefined4 **)(unaff_EBX + 0x1c) = puVar2;
    }
  }
  puVar2 = *(undefined4 **)(unaff_EBX + 0x10);
  for (uVar4 = *(uint *)(unaff_EBX + 0xc) & 0x3fffffff; uVar4 != 0; uVar4 = uVar4 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar5 = 0; iVar5 != 0; iVar5 = iVar5 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  puVar2 = *(undefined4 **)(unaff_EBX + 0x1c);
  if (puVar2 != puVar2 + *(int *)(unaff_EBX + 0x14) * 4) {
    do {
      if (puVar2[3] != 0) {
        iVar5 = (int)puVar2[1] % *(int *)(unaff_EBX + 0xc);
        *puVar2 = *(undefined4 *)(*(int *)(unaff_EBX + 0x10) + iVar5 * 4);
        *(undefined4 **)(*(int *)(unaff_EBX + 0x10) + iVar5 * 4) = puVar2;
      }
      puVar2 = puVar2 + 4;
    } while (puVar2 != (undefined4 *)
                       (*(int *)(unaff_EBX + 0x14) * 0x10 + *(int *)(unaff_EBX + 0x1c)));
  }
  *(undefined4 *)(unaff_EBX + 0x24) = 0;
  return *(int *)(unaff_EBX + 0x18) - *(int *)(unaff_EBX + 0x14);
}



undefined4 * __cdecl FUN_10019e90(int param_1,int param_2)

{
  undefined4 *puVar1;
  void *pvVar2;
  undefined4 *puVar3;
  int iVar4;
  uint uVar5;
  
  puVar1 = (undefined4 *)_malloc(0x30);
  puVar3 = puVar1;
  for (iVar4 = 0xc; iVar4 != 0; iVar4 = iVar4 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  if (param_1 < 2) {
    param_1 = 2;
  }
  if (param_2 < 2) {
    param_2 = 2;
  }
  puVar1[6] = param_1;
  pvVar2 = _malloc(param_1 << 4);
  puVar1[7] = pvVar2;
  puVar1[0xb] = param_2;
  puVar1[3] = 0x400;
  puVar3 = (undefined4 *)_malloc(0x1000);
  puVar1[4] = puVar3;
  for (uVar5 = puVar1[3] & 0x3fffffff; uVar5 != 0; uVar5 = uVar5 - 1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar3 = 0;
    puVar3 = (undefined4 *)((int)puVar3 + 1);
  }
  *puVar1 = 1;
  puVar1[1] = 1;
  return puVar1;
}



void __cdecl FUN_10019f20(void *param_1)

{
  _free(*(void **)((int)param_1 + 0x10));
  _free(*(void **)((int)param_1 + 0x1c));
  _free(param_1);
  return;
}



int __cdecl FUN_10019f50(int *param_1,int param_2,undefined4 param_3)

{
  undefined4 *puVar1;
  int iVar2;
  
  if (param_2 == 0) {
    param_2 = *param_1;
    *param_1 = param_2 + 1;
  }
  if ((param_1[5] == param_1[6]) && (iVar2 = FUN_10019d40(), iVar2 < 1)) {
    return 0;
  }
  if (0 < param_2) {
    for (puVar1 = *(undefined4 **)(param_1[4] + (param_2 % param_1[3]) * 4);
        (puVar1 != (undefined4 *)0x0 && (puVar1[1] != param_2)); puVar1 = (undefined4 *)*puVar1) {
    }
  }
  param_1[1] = param_1[1] + 1;
  *(int *)(param_1[5] * 0x10 + 4 + param_1[7]) = param_2;
  *(undefined4 *)(param_1[5] * 0x10 + 0xc + param_1[7]) = param_3;
  *(int *)(param_1[5] * 0x10 + 8 + param_1[7]) = param_1[1];
  iVar2 = param_1[3];
  *(undefined4 *)(param_1[5] * 0x10 + param_1[7]) =
       *(undefined4 *)(param_1[4] + (param_2 % iVar2) * 4);
  *(int *)(param_1[4] + (param_2 % iVar2) * 4) = param_1[5] * 0x10 + param_1[7];
  param_1[2] = param_1[2] + 1;
  param_1[5] = param_1[5] + 1;
  return param_2;
}



undefined4 __cdecl FUN_1001a010(int param_1,int param_2)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  
  if (param_2 == 0) {
    return 0;
  }
  if ((*(int *)(param_1 + 0x14) != *(int *)(param_1 + 0x18)) || (iVar4 = FUN_10019d40(), 0 < iVar4))
  {
    piVar1 = (int *)(*(int *)(param_1 + 0x10) + (param_2 % *(int *)(param_1 + 0xc)) * 4);
    puVar2 = (undefined4 *)*piVar1;
    while (puVar2 != (undefined4 *)0x0) {
      if (puVar2[1] == param_2) {
        *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + 1;
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 4 + *(int *)(param_1 + 0x1c)) = puVar2[1];
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 8 + *(int *)(param_1 + 0x1c)) =
             *(undefined4 *)(param_1 + 4);
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 0xc + *(int *)(param_1 + 0x1c)) =
             puVar2[3];
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + *(int *)(param_1 + 0x1c)) = *puVar2;
        *piVar1 = *(int *)(param_1 + 0x14) * 0x10 + *(int *)(param_1 + 0x1c);
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        uVar3 = puVar2[3];
        puVar2[1] = 0;
        puVar2[3] = 0;
        return uVar3;
      }
      piVar1 = (int *)*piVar1;
      puVar2 = (undefined4 *)*piVar1;
    }
  }
  return 0;
}



undefined4 __cdecl FUN_1001a0d0(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  
  if (param_2 == 0) {
    return 0;
  }
  if ((*(int *)(param_1 + 0x14) != *(int *)(param_1 + 0x18)) || (iVar4 = FUN_10019d40(), 0 < iVar4))
  {
    puVar1 = (undefined4 *)(*(int *)(param_1 + 0x10) + (param_2 % *(int *)(param_1 + 0xc)) * 4);
    puVar2 = (undefined4 *)*puVar1;
    while (puVar2 != (undefined4 *)0x0) {
      if (puVar2[1] == param_2) {
        *puVar1 = *puVar2;
        *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + 1;
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 4 + *(int *)(param_1 + 0x1c)) = puVar2[1];
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 8 + *(int *)(param_1 + 0x1c)) =
             *(undefined4 *)(param_1 + 4);
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + 0xc + *(int *)(param_1 + 0x1c)) = 0;
        *(undefined4 *)(*(int *)(param_1 + 0x14) * 0x10 + *(int *)(param_1 + 0x1c)) = 0;
        *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        uVar3 = puVar2[3];
        puVar2[1] = 0;
        puVar2[3] = 0;
        *puVar2 = 0;
        *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
        *(int *)(param_1 + 0x28) = *(int *)(param_1 + 0x28) + 1;
        return uVar3;
      }
      puVar1 = (undefined4 *)*puVar1;
      puVar2 = (undefined4 *)*puVar1;
    }
  }
  return 0;
}



undefined4 __cdecl FUN_1001a190(int param_1,int param_2)

{
  undefined4 *puVar1;
  
  if (0 < param_2) {
    for (puVar1 = *(undefined4 **)
                   (*(int *)(param_1 + 0x10) + (param_2 % *(int *)(param_1 + 0xc)) * 4);
        puVar1 != (undefined4 *)0x0; puVar1 = (undefined4 *)*puVar1) {
      if (puVar1[1] == param_2) {
        return puVar1[3];
      }
    }
  }
  return 0;
}



undefined4 __cdecl FUN_1001a1d0(int param_1)

{
  return *(undefined4 *)(param_1 + 8);
}



undefined4 __cdecl FUN_1001a1e0(int param_1)

{
  return *(undefined4 *)(param_1 + 4);
}



undefined4 __cdecl FUN_1001a1f0(int param_1,int *param_2,undefined4 *param_3)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  
  if (param_3 != (undefined4 *)0x0) {
    *param_3 = 0;
  }
  if (*param_2 < 1) {
    *param_2 = 1;
  }
  iVar1 = *param_2;
  if (*(int *)(param_1 + 4) <= iVar1) {
    return 0;
  }
  iVar4 = *(int *)(param_1 + 0x20) + 1;
  if (iVar1 != *(int *)(param_1 + 0x24)) {
    iVar8 = 0;
    iVar7 = *(int *)(param_1 + 0x14) + -1;
    iVar6 = iVar1 + 1;
    if (-1 < iVar7) {
      do {
        iVar4 = (iVar7 + iVar8) / 2;
        iVar2 = *(int *)(iVar4 * 0x10 + 8 + *(int *)(param_1 + 0x1c));
        if (iVar2 == iVar6) break;
        if (iVar2 == iVar6 || iVar2 - iVar6 < 0) {
          iVar8 = iVar4 + 1;
        }
        else {
          iVar7 = iVar4 + -1;
        }
      } while (iVar8 <= iVar7);
    }
  }
  if (iVar4 < *(int *)(param_1 + 0x14)) {
    piVar5 = (int *)(iVar4 * 0x10 + 8 + *(int *)(param_1 + 0x1c));
    do {
      if (iVar1 <= *piVar5) break;
      iVar4 = iVar4 + 1;
      piVar5 = piVar5 + 4;
    } while (iVar4 < *(int *)(param_1 + 0x14));
    if (iVar4 < *(int *)(param_1 + 0x14)) {
      piVar5 = (int *)(iVar4 * 0x10 + 4 + *(int *)(param_1 + 0x1c));
      do {
        if (*piVar5 != 0) break;
        iVar4 = iVar4 + 1;
        piVar5 = piVar5 + 4;
      } while (iVar4 < *(int *)(param_1 + 0x14));
    }
  }
  iVar6 = iVar4 * 0x10;
  iVar7 = *(int *)(*(int *)(param_1 + 0x1c) + 8 + iVar6) + -1;
  if (iVar1 < iVar7) {
    *param_2 = iVar7;
  }
  if (iVar4 < *(int *)(param_1 + 0x14)) {
    uVar3 = *(undefined4 *)(*(int *)(param_1 + 0x1c) + 8 + iVar6);
    *(int *)(param_1 + 0x20) = iVar4;
    *(undefined4 *)(param_1 + 0x24) = uVar3;
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = *(undefined4 *)(*(int *)(param_1 + 0x1c) + iVar6 + 0xc);
    }
    return *(undefined4 *)(*(int *)(param_1 + 0x1c) + 4 + iVar6);
  }
  return 0;
}



void FUN_1001a300(void)

{
  undefined4 *puVar1;
  int iVar2;
  
  DAT_10052b00 = (undefined4 *)_malloc(0x88);
  puVar1 = DAT_10052b00;
  for (iVar2 = 0x22; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar1 = 0;
    puVar1 = puVar1 + 1;
  }
  puVar1 = FUN_10018b00(10,100);
  DAT_10052b00[1] = puVar1;
  FUN_1002c1c0((int)puVar1,_strcmp);
  return;
}



void FUN_1001a340(void)

{
  void *_Memory;
  
  if (DAT_10052b00 != (void *)0x0) {
    _Memory = (void *)FUN_10018720(*(int **)((int)DAT_10052b00 + 4));
    while (_Memory != (void *)0x0) {
      _free(_Memory);
      _Memory = (void *)FUN_10018720(*(int **)((int)DAT_10052b00 + 4));
    }
    FUN_10018680(*(void **)((int)DAT_10052b00 + 4));
    _free(DAT_10052b00);
    DAT_10052b00 = (void *)0x0;
  }
  return;
}



void __cdecl FUN_1001a3b0(int param_1,int param_2)

{
  bool bVar1;
  int *piVar2;
  int iVar3;
  
  bVar1 = false;
  if (DAT_10052b00 != 0) {
    iVar3 = 0;
    piVar2 = (int *)(DAT_10052b00 + 8);
    do {
      if (bVar1) {
        return;
      }
      if (*piVar2 == 0) {
        *piVar2 = param_1;
        piVar2[8] = param_2;
        bVar1 = true;
      }
      iVar3 = iVar3 + 1;
      piVar2 = piVar2 + 1;
    } while (iVar3 < 8);
  }
  return;
}



void __cdecl FUN_1001a3f0(int param_1,int param_2)

{
  bool bVar1;
  int *piVar2;
  int iVar3;
  
  bVar1 = false;
  if (DAT_10052b00 != 0) {
    iVar3 = 0;
    piVar2 = (int *)(DAT_10052b00 + 0x48);
    do {
      if (bVar1) {
        return;
      }
      if (*piVar2 == 0) {
        *piVar2 = param_1;
        piVar2[8] = param_2;
        bVar1 = true;
      }
      iVar3 = iVar3 + 1;
      piVar2 = piVar2 + 1;
    } while (iVar3 < 8);
  }
  return;
}



u_long __cdecl FUN_1001a430(u_long param_1)

{
  SOCKET s;
  int iVar1;
  hostent *phVar2;
  u_long uVar3;
  u_long netlong;
  undefined4 uStack_124;
  undefined4 uStack_120;
  u_long uStack_11c;
  undefined4 uStack_118;
  undefined4 uStack_114;
  undefined4 uStack_110;
  u_long uStack_10c;
  undefined4 uStack_108;
  undefined4 uStack_104;
  char acStack_100 [256];
  
  uVar3 = 0;
  s = socket(2,2,0);
  if (s == 0xffffffff) {
    return 0;
  }
  uStack_11c = 0;
  uStack_118 = 0;
  uStack_114 = 0;
  uStack_120 = 2;
  uStack_11c = htonl(param_1);
  uStack_110 = 0;
  uStack_10c = 0;
  uStack_108 = 0;
  uStack_104 = 0;
  uStack_124 = 0x10;
  iVar1 = WSAIoctl(s,0xc8000014,&uStack_120,0x10,&uStack_110,0x10,&uStack_124,0,0);
  netlong = uStack_10c;
  if (iVar1 < 0) {
    gethostname(acStack_100,0x100);
    phVar2 = gethostbyname(acStack_100);
    if (phVar2 == (hostent *)0x0) goto LAB_1001a4f0;
    netlong = *(u_long *)*phVar2->h_addr_list;
  }
  uVar3 = ntohl(netlong);
LAB_1001a4f0:
  closesocket(s);
  return uVar3;
}



u_long FUN_1001a510(void)

{
  byte bVar1;
  hostent *phVar2;
  byte *pbVar3;
  u_long uVar4;
  byte *unaff_EDI;
  
  bVar1 = *unaff_EDI;
  uVar4 = 0;
  pbVar3 = unaff_EDI;
  if (bVar1 != 0) {
    do {
      if (((char)bVar1 < '0') || ('9' < (char)bVar1)) {
        if (bVar1 != 0x2e) break;
        uVar4 = uVar4 << 8;
      }
      else {
        uVar4 = uVar4 & 0xffffff00 | (bVar1 & 0xf) + (uVar4 & 0xff) * 10;
      }
      bVar1 = pbVar3[1];
      pbVar3 = pbVar3 + 1;
    } while (bVar1 != 0);
    if (uVar4 != 0) {
      return uVar4;
    }
  }
  phVar2 = gethostbyname((char *)unaff_EDI);
  if (phVar2 == (hostent *)0x0) {
    WSAGetLastError();
  }
  else if ((u_long *)*phVar2->h_addr_list != (u_long *)0x0) {
    uVar4 = ntohl(*(u_long *)*phVar2->h_addr_list);
    return uVar4;
  }
  return uVar4;
}



void __cdecl FUN_1001a590(undefined4 *param_1)

{
  byte *pbVar1;
  char cVar2;
  byte bVar3;
  u_short uVar4;
  char *in_EAX;
  SOCKET *pSVar5;
  SOCKET SVar6;
  u_long hostlong;
  __time32_t _Var7;
  int iVar8;
  byte *pbVar9;
  SOCKET *pSVar10;
  char *pcVar11;
  int local_118;
  u_long uStack_114;
  sockaddr sStack_110;
  byte local_100 [256];
  
  pSVar5 = (SOCKET *)param_1[0x88];
  local_118 = 0x50;
  if (pSVar5 == (SOCKET *)0x0) {
    pSVar5 = (SOCKET *)_malloc(0x250);
    pSVar10 = pSVar5;
    for (iVar8 = 0x94; iVar8 != 0; iVar8 = iVar8 + -1) {
      *pSVar10 = 0;
      pSVar10 = pSVar10 + 1;
    }
    *pSVar5 = 0xffffffff;
    pSVar5[2] = 0;
    param_1[0x88] = pSVar5;
  }
  else if (*pSVar5 != 0xffffffff) {
    shutdown(*pSVar5,2);
    closesocket(*pSVar5);
  }
  cVar2 = *in_EAX;
  while ((cVar2 != '\0' && (cVar2 < '!'))) {
    pcVar11 = in_EAX + 1;
    in_EAX = in_EAX + 1;
    cVar2 = *pcVar11;
  }
  iVar8 = _strncmp(in_EAX,"http:",5);
  if (iVar8 == 0) {
    in_EAX = in_EAX + 5;
  }
  cVar2 = *in_EAX;
  while ((cVar2 != '\0' && (cVar2 < '!'))) {
    pcVar11 = in_EAX + 1;
    in_EAX = in_EAX + 1;
    cVar2 = *pcVar11;
  }
  if ((*in_EAX == '/') && (in_EAX[1] == '/')) {
    pbVar9 = (byte *)(in_EAX + 2);
    iVar8 = 0;
    do {
      bVar3 = *pbVar9;
      if (((((char)bVar3 < '!') || (bVar3 == 0x2f)) || (bVar3 == 0x3f)) || (bVar3 == 0x3a)) break;
      pbVar9 = pbVar9 + 1;
      local_100[iVar8] = bVar3;
      iVar8 = iVar8 + 1;
    } while (iVar8 < 0xff);
    bVar3 = *pbVar9;
    local_100[iVar8] = 0;
    if (bVar3 == 0x3a) {
      bVar3 = pbVar9[1];
      pbVar9 = pbVar9 + 1;
      local_118 = 0;
      while (('/' < (char)bVar3 && ((char)bVar3 < ':'))) {
        pbVar9 = pbVar9 + 1;
        local_118 = (bVar3 & 0xf) + local_118 * 10;
        bVar3 = *pbVar9;
      }
    }
    bVar3 = *pbVar9;
    while ((bVar3 != 0 && ((char)bVar3 < '!'))) {
      pbVar1 = pbVar9 + 1;
      pbVar9 = pbVar9 + 1;
      bVar3 = *pbVar1;
    }
    if ((local_100[0] == 0) || (local_118 == 0)) {
      param_1[2] = 0xffffffff;
      __snprintf((char *)(param_1 + 0x489),0x80,"HTTP server (%s) or port (%d) incorrect: %s",
                 local_100,local_118,param_1[1] + 0x14);
      return;
    }
    iVar8 = 0;
    do {
      bVar3 = *pbVar9;
      if ((bVar3 == 0) || (bVar3 == 0x3a)) break;
      *(byte *)(iVar8 + 0x150 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[1];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 1;
        pbVar9 = pbVar9 + 1;
        break;
      }
      *(byte *)(iVar8 + 0x151 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[2];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 2;
        pbVar9 = pbVar9 + 2;
        break;
      }
      *(byte *)(iVar8 + 0x152 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[3];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 3;
        pbVar9 = pbVar9 + 3;
        break;
      }
      *(byte *)(iVar8 + 0x153 + (int)pSVar5) = bVar3;
      bVar3 = pbVar9[4];
      if ((bVar3 == 0) || (bVar3 == 0x3a)) {
        iVar8 = iVar8 + 4;
        pbVar9 = pbVar9 + 4;
        break;
      }
      *(byte *)(iVar8 + 0x154 + (int)pSVar5) = bVar3;
      iVar8 = iVar8 + 5;
      pbVar9 = pbVar9 + 5;
    } while (iVar8 < 0xff);
    *(undefined1 *)(iVar8 + 0x150 + (int)pSVar5) = 0;
    if (*pbVar9 == 0x3a) {
      pbVar9 = pbVar9 + 1;
      iVar8 = 0;
      do {
        if (*pbVar9 == 0) break;
        *(byte *)(iVar8 + 0x10 + (int)pSVar5) = *pbVar9;
        if (pbVar9[1] == 0) {
          iVar8 = iVar8 + 1;
          break;
        }
        *(byte *)(iVar8 + 0x11 + (int)pSVar5) = pbVar9[1];
        if (pbVar9[2] == 0) {
          iVar8 = iVar8 + 2;
          break;
        }
        *(byte *)(iVar8 + 0x12 + (int)pSVar5) = pbVar9[2];
        iVar8 = iVar8 + 3;
        pbVar9 = pbVar9 + 3;
      } while (iVar8 < 0x3f);
      *(undefined1 *)(iVar8 + 0x10 + (int)pSVar5) = 0;
    }
    SVar6 = socket(2,1,0);
    *pSVar5 = SVar6;
    if (SVar6 != 0xffffffff) {
      sStack_110.sa_data[2] = '\0';
      sStack_110.sa_data[3] = '\0';
      sStack_110.sa_data[4] = '\0';
      sStack_110.sa_data[5] = '\0';
      sStack_110.sa_data[6] = '\0';
      sStack_110.sa_data[7] = '\0';
      sStack_110.sa_data[8] = '\0';
      sStack_110.sa_data[9] = '\0';
      sStack_110.sa_data[10] = '\0';
      sStack_110.sa_data[0xb] = '\0';
      sStack_110.sa_data[0xc] = '\0';
      sStack_110.sa_data[0xd] = '\0';
      sStack_110.sa_family = 2;
      sStack_110.sa_data[0] = '\0';
      sStack_110.sa_data[1] = '\0';
      hostlong = FUN_1001a510();
      sStack_110.sa_data._2_4_ = htonl(hostlong);
      uVar4 = htons((u_short)local_118);
      sStack_110.sa_data._0_2_ = uVar4;
      uStack_114 = 1;
      ioctlsocket(*pSVar5,-0x7ffb9982,&uStack_114);
      connect(*pSVar5,&sStack_110,0x10);
      pSVar5[2] = 1;
      _Var7 = FID_conflict___time32((__time32_t *)0x0);
      pSVar5[1] = _Var7 + 0x1e;
      pSVar5[3] = 0;
      *param_1 = 1;
      return;
    }
    iVar8 = param_1[1];
    pcVar11 = "Socket create failed: %s";
  }
  else {
    iVar8 = param_1[1];
    pcVar11 = "Not full URL (must start with //): %s";
  }
  param_1[2] = 0xffffffff;
  __snprintf((char *)(param_1 + 0x489),0x80,pcVar11,iVar8 + 0x14);
  return;
}



undefined4 __cdecl FUN_1001a8d0(int param_1)

{
  char *in_EAX;
  int iVar1;
  char *unaff_EBX;
  uint *unaff_EDI;
  
  iVar1 = __stricmp(in_EAX,"#md5");
  if (iVar1 == 0) {
    if (param_1 == -1) {
      FUN_10012e70(unaff_EDI);
      return 0;
    }
    if (param_1 == -2) {
      FUN_10012f00(unaff_EDI,unaff_EBX,0x21);
      return 0x21;
    }
    FUN_10012ea0(unaff_EDI,unaff_EBX,param_1);
  }
  return 0;
}



int __cdecl FUN_1001a930(char *param_1)

{
  char cVar1;
  int in_EAX;
  char *pcVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte bVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  char *_SubStr;
  undefined **ppuVar9;
  int iVar10;
  int local_18;
  int local_14;
  
  _SubStr = (char *)(in_EAX + 1);
  local_14 = 0;
  local_18 = 0;
  pcVar2 = _strstr(param_1,_SubStr);
  if (pcVar2 == (char *)0x0) {
    return 0;
  }
  do {
    cVar1 = *_SubStr;
    _SubStr = _SubStr + 1;
  } while (cVar1 != '\0');
  pbVar3 = (byte *)(pcVar2 + ((int)_SubStr - (in_EAX + 2)));
  bVar5 = *pbVar3;
  while (bVar5 == 0x20) {
    pbVar4 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar5 = *pbVar4;
  }
  if (PTR_DAT_100411c8 != (undefined *)0x0) {
    bVar5 = *pbVar3;
    ppuVar9 = &PTR_DAT_100411c8;
    pbVar4 = PTR_DAT_100411c8;
    do {
      if (((bVar5 == *pbVar4) && (pbVar3[1] == pbVar4[1])) && (pbVar3[2] == pbVar4[2])) {
        pbVar4 = pbVar3;
        if (bVar5 != 0x2c) goto LAB_1001aa10;
        goto LAB_1001aa23;
      }
      pbVar4 = ppuVar9[1];
      ppuVar9 = ppuVar9 + 1;
    } while (pbVar4 != (byte *)0x0);
  }
  goto LAB_1001a9be;
  while( true ) {
    bVar5 = pbVar3[1];
    pbVar3 = pbVar3 + 1;
    if (bVar5 == 0) break;
LAB_1001aa40:
    if (('/' < (char)bVar5) && ((char)bVar5 < ':')) break;
  }
LAB_1001aa52:
  local_18 = 0;
  bVar5 = *pbVar3;
  while (('/' < (char)bVar5 && ((char)bVar5 < ':'))) {
    pbVar3 = pbVar3 + 1;
    local_18 = (bVar5 & 0xf) + local_18 * 10;
    bVar5 = *pbVar3;
  }
  if (local_14 == 0) goto LAB_1001aa83;
  goto LAB_1001ab1e;
LAB_1001aafa:
  pbVar4 = (&PTR_DAT_10041198)[iVar10];
  iVar10 = iVar10 + 1;
  if (pbVar4 == (byte *)0x0) goto LAB_1001ab1e;
  goto LAB_1001aae6;
  while( true ) {
    bVar5 = pbVar3[1];
    pbVar4 = pbVar3 + 1;
    if (bVar5 == 0x2c) break;
LAB_1001aa10:
    pbVar3 = pbVar4;
    if ((bVar5 == 0x20) || (bVar5 == 0)) goto LAB_1001aa23;
  }
  pbVar3 = pbVar3 + 2;
LAB_1001aa23:
  for (; (*pbVar3 == 0x2c || (*pbVar3 == 0x20)); pbVar3 = pbVar3 + 1) {
  }
LAB_1001a9be:
  bVar5 = *pbVar3;
  if (((char)bVar5 < '0') || ('9' < (char)bVar5)) {
    iVar10 = 0;
    pbVar4 = PTR_DAT_10041194;
    while (pbVar4 != (byte *)0x0) {
      if (((bVar5 == *pbVar4) && (pbVar3[1] == pbVar4[1])) && (pbVar3[2] == pbVar4[2])) {
        local_14 = iVar10 + 1;
        if (bVar5 != 0) goto LAB_1001aa40;
        goto LAB_1001aa52;
      }
      ppuVar9 = &PTR_DAT_10041198 + iVar10;
      iVar10 = iVar10 + 1;
      pbVar4 = *ppuVar9;
    }
  }
LAB_1001aa83:
  bVar5 = *pbVar3;
  if ((char)bVar5 < '0') {
LAB_1001ab90:
    bVar5 = *pbVar3;
    while ((bVar5 != 0 && (((char)bVar5 < '0' || ('9' < (char)bVar5))))) {
      pbVar4 = pbVar3 + 1;
      pbVar3 = pbVar3 + 1;
      bVar5 = *pbVar4;
    }
  }
  else {
    if (((char)bVar5 < ':') &&
       ((('@' < (char)pbVar3[1] || ('@' < (char)pbVar3[2])) || ('@' < (char)pbVar3[3])))) {
      local_18 = 0;
      do {
        if ('9' < (char)bVar5) break;
        local_18 = (bVar5 & 0xf) + local_18 * 10;
        pbVar3 = pbVar3 + 1;
        bVar5 = *pbVar3;
      } while ('/' < (char)bVar5);
      bVar5 = *pbVar3;
      while ((char)bVar5 < '@') {
        pbVar4 = pbVar3 + 1;
        pbVar3 = pbVar3 + 1;
        bVar5 = *pbVar4;
      }
      iVar10 = 0;
      if (PTR_DAT_10041194 != (undefined *)0x0) {
        bVar5 = *pbVar3;
        pbVar4 = PTR_DAT_10041194;
LAB_1001aae6:
        if (((bVar5 != *pbVar4) || (pbVar3[1] != pbVar4[1])) || (pbVar3[2] != pbVar4[2]))
        goto LAB_1001aafa;
        local_14 = iVar10 + 1;
        while ((bVar5 != 0 && (bVar5 != 0x20))) {
          pbVar4 = pbVar3 + 1;
          pbVar3 = pbVar3 + 1;
          bVar5 = *pbVar4;
        }
      }
    }
LAB_1001ab1e:
    bVar5 = *pbVar3;
    if ((((char)bVar5 < '0') || ('9' < (char)bVar5)) || (local_14 != 0)) goto LAB_1001ab90;
    local_14 = 0;
    do {
      if ('9' < (char)bVar5) break;
      pbVar3 = pbVar3 + 1;
      local_14 = (bVar5 & 0xf) + local_14 * 10;
      bVar5 = *pbVar3;
    } while ('/' < (char)bVar5);
    if (*pbVar3 != 0) {
      pbVar3 = pbVar3 + 1;
    }
    bVar5 = *pbVar3;
    local_18 = 0;
    while (('/' < (char)bVar5 && ((char)bVar5 < ':'))) {
      local_18 = (bVar5 & 0xf) + local_18 * 10;
      pbVar3 = pbVar3 + 1;
      bVar5 = *pbVar3;
    }
    if (*pbVar3 != 0) {
      pbVar3 = pbVar3 + 1;
      goto LAB_1001ab90;
    }
  }
  bVar5 = *pbVar3;
  if ((char)bVar5 < '0') {
    uVar8 = 0;
    uVar7 = 0;
    uVar6 = 0;
    pbVar4 = pbVar3;
  }
  else {
    if ((((char)bVar5 < ':') && (pbVar3[1] != 0x3a)) && (pbVar3[2] != 0x3a)) {
      iVar10 = 0;
      do {
        if ('9' < (char)bVar5) break;
        pbVar3 = pbVar3 + 1;
        iVar10 = (bVar5 & 0xf) + iVar10 * 10;
        bVar5 = *pbVar3;
      } while ('/' < (char)bVar5);
      if (iVar10 < 1000) {
        if (iVar10 < 0x32) {
          iVar10 = iVar10 + 2000;
        }
        else {
          iVar10 = iVar10 + 0x76c;
        }
      }
      bVar5 = *pbVar3;
      while ((bVar5 != 0 && (((char)bVar5 < '0' || ('9' < (char)bVar5))))) {
        pbVar4 = pbVar3 + 1;
        pbVar3 = pbVar3 + 1;
        bVar5 = *pbVar4;
      }
    }
    else {
      iVar10 = 0;
    }
    bVar5 = *pbVar3;
    if ((char)bVar5 < '0') {
      uVar6 = 0;
      pbVar4 = pbVar3;
LAB_1001acbd:
      uVar7 = 0;
LAB_1001acc1:
      uVar8 = 0;
    }
    else {
      if ((char)bVar5 < ':') {
        uVar6 = bVar5 & 0xf;
        pbVar4 = pbVar3 + 1;
        bVar5 = *pbVar4;
        if (('/' < (char)bVar5) && ((char)bVar5 < ':')) {
          uVar6 = (bVar5 & 0xf) + uVar6 * 10;
          pbVar4 = pbVar3 + 2;
        }
        pbVar3 = pbVar4;
        if (*pbVar3 == 0x3a) {
          pbVar3 = pbVar3 + 1;
        }
      }
      else {
        uVar6 = 0;
      }
      bVar5 = *pbVar3;
      pbVar4 = pbVar3;
      if ((char)bVar5 < '0') goto LAB_1001acbd;
      if ((char)bVar5 < ':') {
        uVar7 = bVar5 & 0xf;
        pbVar4 = pbVar3 + 1;
        bVar5 = *pbVar4;
        if (('/' < (char)bVar5) && ((char)bVar5 < ':')) {
          uVar7 = (bVar5 & 0xf) + uVar7 * 10;
          pbVar4 = pbVar3 + 2;
        }
        pbVar3 = pbVar4;
        if (*pbVar3 == 0x3a) {
          pbVar3 = pbVar3 + 1;
        }
      }
      else {
        uVar7 = 0;
      }
      bVar5 = *pbVar3;
      pbVar4 = pbVar3;
      if (((char)bVar5 < '0') || ('9' < (char)bVar5)) goto LAB_1001acc1;
      uVar8 = bVar5 & 0xf;
      pbVar4 = pbVar3 + 1;
      bVar5 = *pbVar4;
      if (('/' < (char)bVar5) && ((char)bVar5 < ':')) {
        uVar8 = (bVar5 & 0xf) + uVar8 * 10;
        pbVar4 = pbVar3 + 2;
      }
    }
    if (iVar10 != 0) goto LAB_1001ad16;
  }
  bVar5 = *pbVar4;
  while (((bVar5 != 0 && ((char)bVar5 < '0')) && ('9' < (char)bVar5))) {
    pbVar3 = pbVar4 + 1;
    pbVar4 = pbVar4 + 1;
    bVar5 = *pbVar3;
  }
  iVar10 = 0;
  bVar5 = *pbVar4;
  while (('/' < (char)bVar5 && ((char)bVar5 < ':'))) {
    pbVar4 = pbVar4 + 1;
    iVar10 = (bVar5 & 0xf) + iVar10 * 10;
    bVar5 = *pbVar4;
  }
LAB_1001ad16:
  iVar10 = _sprintf(param_1,"%d.%d.%d_%d:%02d:%02d",iVar10,local_14,local_18,uVar6,uVar7,uVar8);
  return iVar10;
}



int FUN_1001ad40(void)

{
  char cVar1;
  int in_EAX;
  char *pcVar2;
  char *unaff_EBX;
  char *pcVar3;
  int iVar4;
  
  iVar4 = 0;
  pcVar3 = (char *)(in_EAX + 1);
  pcVar2 = _strstr(unaff_EBX,pcVar3);
  if (pcVar2 != (char *)0x0) {
    do {
      cVar1 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar1 != '\0');
    pcVar2 = pcVar2 + ((int)pcVar3 - (in_EAX + 2));
    cVar1 = *pcVar2;
    while ((cVar1 != '\0' && (cVar1 < '!'))) {
      pcVar3 = pcVar2 + 1;
      pcVar2 = pcVar2 + 1;
      cVar1 = *pcVar3;
    }
    cVar1 = *pcVar2;
    while ('\x1f' < cVar1) {
      unaff_EBX[iVar4] = cVar1;
      pcVar3 = pcVar2 + 1;
      iVar4 = iVar4 + 1;
      pcVar2 = pcVar2 + 1;
      cVar1 = *pcVar3;
    }
  }
  return iVar4;
}



void __cdecl FUN_1001ada0(undefined4 *param_1)

{
  byte *pbVar1;
  size_t _Size;
  char cVar2;
  SOCKET *pSVar3;
  undefined1 *puVar4;
  byte bVar5;
  uint uVar6;
  undefined *puVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  SOCKET SVar11;
  char *pcVar12;
  byte *_Str1;
  undefined4 uVar13;
  char *pcVar14;
  
  pSVar3 = (SOCKET *)param_1[0x88];
  SVar11 = pSVar3[2];
  if ((((SVar11 == 1) || (SVar11 == 2)) || (SVar11 == 3)) &&
     (uVar6 = FID_conflict___time32((__time32_t *)0x0), pSVar3[1] < uVar6)) {
    __snprintf((char *)(param_1 + 0x489),0x80,"Got network timeout: %s",param_1[1] + 0x14);
    pSVar3[2] = 5;
  }
  if (pSVar3[2] == 1) {
    if (((char)pSVar3[4] == '$') || (puVar7 = &DAT_1003d118, (char)pSVar3[4] == '@')) {
      puVar7 = &DAT_1003d110;
    }
    iVar8 = _sprintf(*(char **)(param_1[1] + 4),
                     "%s %s HTTP/1.0\r\nAccept: */*\r\nContent-Length: 0\r\n\r\n",puVar7,
                     pSVar3 + 0x54);
    iVar9 = send(*pSVar3,*(char **)(param_1[1] + 4),iVar8,0);
    iVar10 = WSAGetLastError();
    if (((iVar9 != -1) || ((iVar10 != 0x2749 && (iVar10 != 0x2733)))) &&
       (SVar11 = ((iVar9 == iVar8) - 1 & 3) + 2, pSVar3[2] = SVar11, SVar11 == 5)) {
      __snprintf((char *)(param_1 + 0x489),0x80,"Got connect error (%d/%d): %s",iVar9,iVar10,
                 param_1[1] + 0x14);
    }
  }
  if (pSVar3[2] == 2) {
    iVar8 = recv(*pSVar3,(char *)(*(int *)(param_1[1] + 4) + pSVar3[3]),
                 *(int *)(param_1[1] + 8) - pSVar3[3],0);
    if (iVar8 == -1) {
      iVar9 = WSAGetLastError();
      if (iVar9 != 0x2733) {
LAB_1001aee2:
        __snprintf((char *)(param_1 + 0x489),0x80,"Got receive error (%d): %s",iVar8,
                   param_1[1] + 0x14);
        pSVar3[2] = 5;
      }
    }
    else {
      if (iVar8 < 0) goto LAB_1001aee2;
      pSVar3[3] = pSVar3[3] + iVar8;
    }
    if ((pSVar3[2] == 2) && (4 < (int)pSVar3[3])) {
      pcVar12 = *(char **)(param_1[1] + 4);
      pcVar14 = pcVar12 + (pSVar3[3] - 3);
      if (pcVar12 == pcVar14) {
        return;
      }
      while ((((*pcVar12 != '\r' || (pcVar12[1] != '\n')) || (pcVar12[2] != '\r')) ||
             (pcVar12[3] != '\n'))) {
        pcVar12 = pcVar12 + 1;
        if (pcVar12 == pcVar14) {
          return;
        }
      }
      if (pcVar12 == pcVar14) {
        return;
      }
      pcVar12[3] = '\0';
      pcVar12[2] = '\0';
      _Str1 = *(byte **)(param_1[1] + 4);
      iVar8 = _strncmp((char *)_Str1,"HTTP",4);
      if (iVar8 != 0) {
        iVar8 = param_1[1];
        pcVar14 = "Got non-HTTP response: %s";
        goto LAB_1001afe0;
      }
      bVar5 = *_Str1;
      while (bVar5 != 0) {
        if (bVar5 < 0x21) {
          bVar5 = *_Str1;
          if (bVar5 != 0) goto LAB_1001afb4;
          break;
        }
        pbVar1 = _Str1 + 1;
        _Str1 = _Str1 + 1;
        bVar5 = *pbVar1;
      }
      goto LAB_1001afc0;
    }
  }
  goto LAB_1001b0d1;
  while( true ) {
    bVar5 = _Str1[1];
    _Str1 = _Str1 + 1;
    if (bVar5 == 0) break;
LAB_1001afb4:
    if (0x20 < bVar5) break;
  }
LAB_1001afc0:
  iVar8 = _strncmp((char *)_Str1,"200",3);
  if (iVar8 != 0) {
    iVar8 = param_1[1];
    pcVar14 = "Got non-200 HTTP response: %s";
LAB_1001afe0:
    __snprintf((char *)(param_1 + 0x489),0x80,pcVar14,iVar8 + 0x14);
    pSVar3[2] = 5;
    return;
  }
  _Size = (*(int *)(param_1[1] + 4) - (int)pcVar12) + -4 + pSVar3[3];
  cVar2 = (char)pSVar3[4];
  SVar11 = pSVar3[3] - _Size;
  pSVar3[3] = SVar11;
  if (cVar2 == '$') {
    iVar8 = FUN_1001ad40();
    *(int *)(param_1[1] + 0xc) = iVar8;
    pSVar3[2] = 4;
    *param_1 = 3;
  }
  else if (cVar2 == '@') {
    iVar8 = FUN_1001a930(*(char **)(param_1[1] + 4));
    *(int *)(param_1[1] + 0xc) = iVar8;
    pSVar3[2] = 4;
    *param_1 = 3;
  }
  else {
    if (cVar2 == '#') {
      iVar8 = __stricmp((char *)(pSVar3 + 4),"#md5");
      if (iVar8 == 0) {
        FUN_10012e70(pSVar3 + 0x14);
      }
      FUN_1001a8d0(_Size);
    }
    else {
      _memmove(*(void **)(param_1[1] + 4),(void *)((int)*(void **)(param_1[1] + 4) + SVar11),_Size);
      *(size_t *)(param_1[1] + 0xc) = _Size;
    }
    pSVar3[2] = 3;
  }
LAB_1001b0d1:
  if (pSVar3[2] != 3) goto LAB_1001b175;
  iVar8 = param_1[1];
  iVar8 = recv(*pSVar3,(char *)(*(int *)(iVar8 + 4) + *(int *)(iVar8 + 0xc)),
               *(int *)(iVar8 + 8) - *(int *)(iVar8 + 0xc),0);
  if (iVar8 == -1) {
    iVar8 = WSAGetLastError();
    if (iVar8 == 0x2733) goto LAB_1001b175;
LAB_1001b10e:
    pSVar3[2] = 5;
    param_1[2] = 0xffffffff;
    __snprintf((char *)(param_1 + 0x489),0x80,"Network error downloading: %s",param_1[1] + 0x14);
  }
  else if (iVar8 < 1) {
    if (iVar8 != 0) goto LAB_1001b10e;
    if ((char)pSVar3[4] == '#') {
      puVar4 = *(undefined1 **)(param_1[1] + 4);
      uVar13 = 0;
      iVar8 = __stricmp((char *)(pSVar3 + 4),"#md5");
      if (iVar8 == 0) {
        FUN_10012f00(pSVar3 + 0x14,puVar4,0x21);
        uVar13 = 0x21;
      }
      *(undefined4 *)(param_1[1] + 0xc) = uVar13;
    }
    pSVar3[2] = 4;
    *param_1 = 3;
  }
  else if ((char)pSVar3[4] == '#') {
    FUN_1001a8d0(iVar8);
  }
  else {
    *(int *)(param_1[1] + 0xc) = *(int *)(param_1[1] + 0xc) + iVar8;
  }
  if (*(int *)(param_1[1] + 8) <= *(int *)(param_1[1] + 0xc)) {
    pSVar3[2] = 5;
    param_1[2] = 0xfffffffc;
    __snprintf((char *)(param_1 + 0x489),0x80,"Buffer overrun loading: %s",param_1[1] + 0x14);
  }
LAB_1001b175:
  if ((pSVar3[2] == 5) || (pSVar3[2] == 4)) {
    if (*pSVar3 != 0xffffffff) {
      shutdown(*pSVar3,2);
      closesocket(*pSVar3);
    }
    *pSVar3 = 0xffffffff;
    *(undefined1 *)(*(int *)(param_1[1] + 0xc) + *(int *)(param_1[1] + 4)) = 0;
  }
  if ((pSVar3[2] == 5) && (param_1[2] == 1)) {
    param_1[2] = 0xffffffff;
    if (*(char *)(param_1 + 0x489) == '\0') {
      __snprintf((char *)(param_1 + 0x489),0x80,"HTTP transfer error: %s",param_1[1] + 0x14);
    }
  }
  return;
}



void __fastcall FUN_1001b280(int param_1)

{
  char *in_EAX;
  FILE *_File;
  size_t sVar1;
  
  if ((in_EAX != (char *)0x0) && (*in_EAX != '\0')) {
    _File = (FILE *)FUN_1002e478(in_EAX,"rb");
    if (_File != (FILE *)0x0) {
      sVar1 = _fread(*(void **)(*(int *)(param_1 + 4) + 4),1,*(size_t *)(*(int *)(param_1 + 4) + 8),
                     _File);
      *(size_t *)(*(int *)(param_1 + 4) + 0xc) = sVar1;
      _fclose(_File);
      if (*(int *)(*(int *)(param_1 + 4) + 0xc) < 0) {
        *(undefined4 *)(param_1 + 8) = 0xfffffffd;
        __snprintf((char *)(param_1 + 0x1224),0x80,"File read error: %s",
                   *(int *)(param_1 + 4) + 0x14);
        *(undefined4 *)(*(int *)(param_1 + 4) + 0xc) = 0;
      }
      return;
    }
    *(undefined4 *)(param_1 + 8) = 0xfffffffe;
    __snprintf((char *)(param_1 + 0x1224),0x80,"File not found: %s",*(int *)(param_1 + 4) + 0x14);
    return;
  }
  *(undefined4 *)(param_1 + 8) = 0xfffffffe;
  __snprintf((char *)(param_1 + 0x1224),0x80,"File not found: <null filename>");
  return;
}



undefined4 __cdecl FUN_1001b360(int param_1,char *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  
  if ((param_2 != (char *)0x0) && (*param_2 != '\0')) {
    iVar2 = 0;
    if (0 < *(int *)(param_1 + 0xc)) {
      puVar3 = (undefined4 *)(param_1 + 0x14);
      do {
        iVar1 = __stricmp(param_2,(char *)*puVar3);
        if (iVar1 == 0) {
          return *(undefined4 *)(param_1 + 0x14 + iVar2 * 4);
        }
        iVar2 = iVar2 + 1;
        puVar3 = puVar3 + 1;
      } while (iVar2 < *(int *)(param_1 + 0xc));
    }
    return 0;
  }
  return *(undefined4 *)(param_1 + 0x14);
}



undefined4 * __cdecl FUN_1001b3c0(int param_1,char *param_2)

{
  char cVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined4 *puVar4;
  
  puVar2 = (undefined4 *)0x0;
  if (param_2 == (char *)0x0) {
    param_2 = "";
  }
  if (*(int *)(param_1 + 0xc) < *(int *)(param_1 + 0x10)) {
    puVar2 = (undefined4 *)_malloc(0x4c);
    puVar4 = puVar2;
    for (iVar3 = 0x13; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    }
    iVar3 = (int)puVar2 - (int)param_2;
    do {
      cVar1 = *param_2;
      param_2[iVar3] = cVar1;
      param_2 = param_2 + 1;
    } while (cVar1 != '\0');
    puVar2[0x10] = &DAT_10039247;
    *(undefined4 **)(param_1 + 0x14 + *(int *)(param_1 + 0xc) * 4) = puVar2;
    *(int *)(param_1 + 0xc) = *(int *)(param_1 + 0xc) + 1;
  }
  return puVar2;
}



void __cdecl FUN_1001b430(int param_1)

{
  void *_Memory;
  int iVar1;
  undefined4 *puVar2;
  
  iVar1 = 0;
  if (0 < *(int *)(param_1 + 0xc)) {
    puVar2 = (undefined4 *)(param_1 + 0x14);
    do {
      _Memory = (void *)*puVar2;
      if (0 < *(int *)((int)_Memory + 0x44)) {
        _free(*(void **)((int)_Memory + 0x40));
      }
      _free(_Memory);
      *puVar2 = 0;
      iVar1 = iVar1 + 1;
      puVar2 = puVar2 + 1;
    } while (iVar1 < *(int *)(param_1 + 0xc));
    *(undefined4 *)(param_1 + 0xc) = 0;
    return;
  }
  *(undefined4 *)(param_1 + 0xc) = 0;
  return;
}



void __cdecl FUN_1001b490(int param_1,undefined1 param_2)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  
  if (param_1 != 0) {
    if (*(int *)(param_1 + 0x44) <= *(int *)(param_1 + 0x48)) {
      iVar2 = ((0x1fff < *(int *)(param_1 + 0x48)) - 1 & 0xffffe400) + 0x2000 +
              *(int *)(param_1 + 0x44);
      puVar1 = (undefined4 *)_malloc(iVar2 + 1);
      uVar4 = *(uint *)(param_1 + 0x48);
      if (0 < (int)uVar4) {
        puVar5 = *(undefined4 **)(param_1 + 0x40);
        puVar6 = puVar1;
        for (uVar3 = uVar4 >> 2; uVar3 != 0; uVar3 = uVar3 - 1) {
          *puVar6 = *puVar5;
          puVar5 = puVar5 + 1;
          puVar6 = puVar6 + 1;
        }
        for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
          *(undefined1 *)puVar6 = *(undefined1 *)puVar5;
          puVar5 = (undefined4 *)((int)puVar5 + 1);
          puVar6 = (undefined4 *)((int)puVar6 + 1);
        }
      }
      if (0 < *(int *)(param_1 + 0x44)) {
        _free(*(void **)(param_1 + 0x40));
      }
      *(int *)(param_1 + 0x44) = iVar2;
      *(undefined4 **)(param_1 + 0x40) = puVar1;
    }
    *(undefined1 *)(*(int *)(param_1 + 0x48) + *(int *)(param_1 + 0x40)) = param_2;
    iVar2 = *(int *)(param_1 + 0x48) + 1;
    *(int *)(param_1 + 0x48) = iVar2;
    *(undefined1 *)(iVar2 + *(int *)(param_1 + 0x40)) = 0;
  }
  return;
}



void __cdecl FUN_1001b530(int param_1,char *param_2)

{
  char *pcVar1;
  char cVar2;
  
  cVar2 = *param_2;
  while (cVar2 != '\0') {
    FUN_1001b490(param_1,cVar2);
    pcVar1 = param_2 + 1;
    param_2 = param_2 + 1;
    cVar2 = *pcVar1;
  }
  return;
}



void FUN_1001b560(void)

{
  undefined4 *puVar1;
  int iVar2;
  char *unaff_EBX;
  undefined4 *unaff_ESI;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0x10094);
  puVar3 = puVar1;
  for (iVar2 = 0x4025; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar1[1] = puVar1 + 0x25;
  puVar1[2] = 0x10000;
  *puVar1 = unaff_ESI[1];
  unaff_ESI[1] = puVar1;
  *unaff_ESI = 3;
  FUN_10002230((char *)(puVar1 + 5),0x80,unaff_EBX);
  iVar2 = _strncmp(unaff_EBX,"http:",5);
  if (iVar2 == 0) {
    FUN_1001a590(unaff_ESI);
    return;
  }
  _strncmp(unaff_EBX,"file:",5);
  FUN_1001b280((int)unaff_ESI);
  return;
}



int FUN_1001b5f0(void)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  byte *unaff_EDI;
  
  bVar2 = *unaff_EDI;
  pbVar5 = unaff_EDI;
  pbVar4 = unaff_EDI;
  while (bVar2 != 0) {
    bVar2 = *pbVar5;
    if (bVar2 == 9) {
      *pbVar4 = 0x20;
LAB_1001b615:
      pbVar4 = pbVar4 + 1;
    }
    else if ((bVar2 == 10) || (0x1f < bVar2)) {
      *pbVar4 = bVar2;
      goto LAB_1001b615;
    }
    pbVar3 = pbVar5 + 1;
    pbVar5 = pbVar5 + 1;
    bVar2 = *pbVar3;
  }
  *pbVar4 = 0;
  bVar2 = *unaff_EDI;
  pbVar5 = unaff_EDI;
  pbVar4 = unaff_EDI;
  pbVar3 = unaff_EDI;
  while (bVar2 != 0) {
    bVar2 = *pbVar5;
    if ((bVar2 == 0x23) && (pbVar3 != (byte *)0x0)) {
      do {
        pbVar1 = pbVar5 + 1;
        pbVar5 = pbVar5 + 1;
      } while (0x1f < *pbVar1);
      pbVar4 = pbVar3;
      if (*pbVar1 == 0) break;
    }
    else if (bVar2 == 10) {
      *pbVar4 = 10;
      pbVar3 = pbVar4 + 1;
      pbVar4 = pbVar3;
    }
    else if (bVar2 == 0x20) {
      *pbVar4 = 0x20;
      pbVar4 = pbVar4 + 1;
    }
    else {
      *pbVar4 = bVar2;
      pbVar3 = (byte *)0x0;
      pbVar4 = pbVar4 + 1;
    }
    pbVar1 = pbVar5 + 1;
    pbVar5 = pbVar5 + 1;
    bVar2 = *pbVar1;
  }
  *pbVar4 = 0;
  return (int)pbVar4 - (int)unaff_EDI;
}



int __cdecl FUN_1001b680(byte *param_1,int param_2,int param_3)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  
  iVar4 = 0;
  if (0x40 < *param_1) {
    pbVar3 = param_1;
    do {
      if (param_3 + -1 <= iVar4) break;
      iVar2 = _tolower((uint)*pbVar3);
      pbVar3[param_2 - (int)param_1] = (byte)iVar2;
      pbVar1 = pbVar3 + 1;
      iVar4 = iVar4 + 1;
      pbVar3 = pbVar3 + 1;
    } while (0x40 < *pbVar1);
  }
  *(undefined1 *)(iVar4 + param_2) = 0;
  if (param_1[iVar4] == 0x20) {
    iVar4 = iVar4 + 1;
  }
  return iVar4;
}



int __cdecl FUN_1001b6e0(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  char *unaff_EBX;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  bool bVar6;
  int local_48;
  char local_40 [64];
  
  iVar3 = 0;
  local_48 = 1;
  if (*unaff_EBX == '\0') {
    return 0;
  }
  do {
    iVar1 = iVar3;
    if ((unaff_EBX[iVar3] == '%') && (unaff_EBX[iVar3 + 1] == '%')) {
      iVar1 = FUN_1001b680((byte *)(unaff_EBX + iVar3 + 2),(int)local_40,0x40);
      iVar1 = iVar3 + 2 + iVar1;
      iVar2 = 3;
      bVar6 = true;
      pcVar4 = local_40;
      pcVar5 = "if";
      do {
        if (iVar2 == 0) break;
        iVar2 = iVar2 + -1;
        bVar6 = *pcVar4 == *pcVar5;
        pcVar4 = pcVar4 + 1;
        pcVar5 = pcVar5 + 1;
      } while (bVar6);
      if (bVar6) {
        local_48 = local_48 + 1;
      }
      else {
        iVar2 = 5;
        bVar6 = true;
        pcVar4 = local_40;
        pcVar5 = "else";
        do {
          if (iVar2 == 0) break;
          iVar2 = iVar2 + -1;
          bVar6 = *pcVar4 == *pcVar5;
          pcVar4 = pcVar4 + 1;
          pcVar5 = pcVar5 + 1;
        } while (bVar6);
        if (!bVar6) {
          iVar2 = 5;
          bVar6 = true;
          pcVar4 = local_40;
          pcVar5 = "elif";
          do {
            if (iVar2 == 0) break;
            iVar2 = iVar2 + -1;
            bVar6 = *pcVar4 == *pcVar5;
            pcVar4 = pcVar4 + 1;
            pcVar5 = pcVar5 + 1;
          } while (bVar6);
          if (!bVar6) {
            iVar2 = 6;
            bVar6 = true;
            pcVar4 = local_40;
            pcVar5 = "endif";
            do {
              if (iVar2 == 0) break;
              iVar2 = iVar2 + -1;
              bVar6 = *pcVar4 == *pcVar5;
              pcVar4 = pcVar4 + 1;
              pcVar5 = pcVar5 + 1;
            } while (bVar6);
            if ((bVar6) && (local_48 = local_48 + -1, local_48 < 1)) {
              return iVar3;
            }
            goto LAB_1001b7af;
          }
        }
        if ((local_48 == 1) && (param_2 == 0)) {
          return iVar3;
        }
      }
    }
LAB_1001b7af:
    iVar3 = iVar1 + 1;
    if (unaff_EBX[iVar1 + 1] == '\0') {
      return iVar3;
    }
  } while( true );
}



int __cdecl FUN_1001b7d0(int param_1,char *param_2)

{
  int iVar1;
  long lVar2;
  u_long uVar3;
  hostent *phVar4;
  int iVar5;
  undefined4 *puVar6;
  int iVar7;
  char *pcVar8;
  char *pcVar9;
  bool bVar10;
  undefined4 uVar11;
  char local_440 [64];
  char local_400 [1024];
  
  if ((*param_2 != '%') || (param_2[1] != '%')) {
    return 1;
  }
  iVar1 = FUN_1001b680((byte *)(param_2 + 2),(int)local_440,0x40);
  iVar1 = iVar1 + 2;
  iVar7 = 5;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "else";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
LAB_1001be67:
    iVar7 = FUN_1001b6e0(param_1,1);
    return iVar1 + iVar7;
  }
  iVar7 = 5;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "elif";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) goto LAB_1001be67;
  iVar7 = 3;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "if";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    iVar7 = FUN_1002c090(param_1 + 0x224,0x1000,(byte *)(param_2 + iVar1),local_400,0x400);
    iVar1 = iVar1 + iVar7;
    lVar2 = _atol(local_400);
    if (lVar2 != 0) {
      return iVar1;
    }
    do {
      iVar7 = FUN_1001b6e0(param_1,0);
      iVar1 = iVar1 + iVar7;
      if (param_2[iVar1] != '%') {
        return iVar1;
      }
      if (param_2[iVar1 + 1] != '%') {
        return iVar1;
      }
      iVar7 = FUN_1001b680((byte *)(param_2 + iVar1 + 2),(int)local_440,0x40);
      iVar7 = iVar1 + 2 + iVar7;
      iVar1 = 5;
      bVar10 = true;
      pcVar8 = local_440;
      pcVar9 = "elif";
      do {
        if (iVar1 == 0) break;
        iVar1 = iVar1 + -1;
        bVar10 = *pcVar8 == *pcVar9;
        pcVar8 = pcVar8 + 1;
        pcVar9 = pcVar9 + 1;
      } while (bVar10);
      if (!bVar10) {
        return iVar7;
      }
      iVar1 = FUN_1002c090(param_1 + 0x224,0x1000,(byte *)(param_2 + iVar7),local_400,0x400);
      iVar1 = iVar7 + iVar1;
      lVar2 = _atol(local_400);
      if (lVar2 != 0) {
        return iVar1;
      }
    } while( true );
  }
  iVar7 = 6;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "endif";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    return iVar1;
  }
  iVar7 = 8;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "include";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    iVar7 = FUN_1002c090(param_1 + 0x224,0x1000,(byte *)(param_2 + iVar1),local_400,0x400);
    if (local_400[0] == '\0') {
      return iVar1 + iVar7;
    }
    FUN_1001b560();
    return iVar1 + iVar7;
  }
  iVar7 = 4;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "env";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (bVar10) {
    iVar7 = FUN_1002c090(param_1 + 0x224,0x1000,(byte *)(param_2 + iVar1),local_400,0x400);
    return iVar1 + iVar7;
  }
  iVar7 = 5;
  bVar10 = true;
  pcVar8 = local_440;
  pcVar9 = "expr";
  do {
    if (iVar7 == 0) break;
    iVar7 = iVar7 + -1;
    bVar10 = *pcVar8 == *pcVar9;
    pcVar8 = pcVar8 + 1;
    pcVar9 = pcVar9 + 1;
  } while (bVar10);
  if (!bVar10) {
    iVar7 = 4;
    bVar10 = true;
    pcVar8 = local_440;
    pcVar9 = "var";
    do {
      if (iVar7 == 0) break;
      iVar7 = iVar7 + -1;
      bVar10 = *pcVar8 == *pcVar9;
      pcVar8 = pcVar8 + 1;
      pcVar9 = pcVar9 + 1;
    } while (bVar10);
    if (!bVar10) {
      iVar7 = 5;
      bVar10 = true;
      pcVar8 = local_440;
      pcVar9 = "parm";
      do {
        if (iVar7 == 0) break;
        iVar7 = iVar7 + -1;
        bVar10 = *pcVar8 == *pcVar9;
        pcVar8 = pcVar8 + 1;
        pcVar9 = pcVar9 + 1;
      } while (bVar10);
      if (!bVar10) {
        iVar7 = 4;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "dns";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          iVar7 = FUN_1002c090(param_1 + 0x224,0x1000,(byte *)(param_2 + iVar1),local_400,0x400);
          uVar3 = FUN_1001a510();
          _sprintf(local_400,"%d.%d.%d.%d",uVar3 >> 0x18,uVar3 >> 0x10 & 0xff,uVar3 >> 8 & 0xff,
                   uVar3 & 0xff);
          FUN_1001b530(*(int *)(param_1 + 0x214),local_400);
          return iVar1 + iVar7;
        }
        iVar7 = 5;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "bind";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          iVar7 = FUN_1002c090(param_1 + 0x224,0x1000,(byte *)(param_2 + iVar1),local_400,0x400);
          uVar3 = FUN_1001a510();
          uVar3 = FUN_1001a430(uVar3);
          _sprintf(local_400,"%d.%d.%d.%d",uVar3 >> 0x18,uVar3 >> 0x10 & 0xff,uVar3 >> 8 & 0xff,
                   uVar3 & 0xff);
          FUN_1001b530(*(int *)(param_1 + 0x214),local_400);
          return iVar1 + iVar7;
        }
        iVar7 = 9;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "hostname";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          gethostname(local_400,0x400);
          phVar4 = gethostbyname(local_400);
          if (phVar4 == (hostent *)0x0) {
            return iVar1;
          }
          FUN_1001b530(*(int *)(param_1 + 0x214),phVar4->h_name);
          return iVar1;
        }
        iVar7 = 8;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "section";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          iVar7 = FUN_1002c090(param_1 + 0x224,0x1000,(byte *)(param_2 + iVar1),local_400,0x400);
          iVar5 = FUN_1001b360(param_1,local_400);
          *(int *)(param_1 + 0x214) = iVar5;
          if (iVar5 != 0) {
            return iVar1 + iVar7;
          }
          puVar6 = FUN_1001b3c0(param_1,local_400);
          *(undefined4 **)(param_1 + 0x214) = puVar6;
          return iVar1 + iVar7;
        }
        iVar7 = 0xb;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "endsection";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if (bVar10) {
          uVar11 = FUN_1001b360(param_1,"");
          *(undefined4 *)(param_1 + 0x214) = uVar11;
          return iVar1;
        }
        iVar7 = 2;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "{";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if ((bVar10) && (*(int *)(param_1 + 0x218) == 0)) {
          *(undefined4 *)(param_1 + 0x218) = *(undefined4 *)(param_1 + 0x214);
          *(undefined4 *)(param_1 + 0x214) = *(undefined4 *)(param_1 + 0x21c);
          return iVar1;
        }
        iVar7 = 2;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "*";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if ((bVar10) && (*(int *)(param_1 + 0x218) != 0)) {
          FUN_10002bf0((byte *)(param_1 + 0x224),0x1000,*(byte **)(*(int *)(param_1 + 0x21c) + 0x40)
                      );
          if (*(int *)(*(int *)(param_1 + 0x21c) + 0x48) < 1) {
            return iVar1;
          }
          *(undefined4 *)(*(int *)(param_1 + 0x21c) + 0x48) = 0;
          **(undefined1 **)(*(int *)(param_1 + 0x21c) + 0x40) = 0;
          return iVar1;
        }
        iVar7 = 2;
        bVar10 = true;
        pcVar8 = local_440;
        pcVar9 = "}";
        do {
          if (iVar7 == 0) break;
          iVar7 = iVar7 + -1;
          bVar10 = *pcVar8 == *pcVar9;
          pcVar8 = pcVar8 + 1;
          pcVar9 = pcVar9 + 1;
        } while (bVar10);
        if ((bVar10) && (*(int *)(param_1 + 0x218) != 0)) {
          FUN_10002bf0((byte *)(param_1 + 0x224),0x1000,*(byte **)(*(int *)(param_1 + 0x21c) + 0x40)
                      );
          if (0 < *(int *)(*(int *)(param_1 + 0x21c) + 0x48)) {
            *(undefined4 *)(*(int *)(param_1 + 0x21c) + 0x48) = 0;
            **(undefined1 **)(*(int *)(param_1 + 0x21c) + 0x40) = 0;
          }
          *(undefined4 *)(param_1 + 0x214) = *(undefined4 *)(param_1 + 0x218);
          *(undefined4 *)(param_1 + 0x218) = 0;
          return iVar1;
        }
        FUN_1001b490(*(int *)(param_1 + 0x214),*param_2);
        FUN_1001b490(*(int *)(param_1 + 0x214),*param_2);
        return 2;
      }
      iVar7 = *(int *)(param_1 + 0x218);
      if (iVar7 == 0) {
        iVar7 = *(int *)(param_1 + 0x214);
      }
      iVar7 = *(int *)(iVar7 + 0x40);
      uVar11 = 0;
      goto LAB_1001be3e;
    }
  }
  uVar11 = 0x1000;
  iVar7 = param_1 + 0x224;
LAB_1001be3e:
  iVar7 = FUN_1002c090(iVar7,uVar11,(byte *)(param_2 + iVar1),local_400,0x400);
  FUN_1001b530(*(int *)(param_1 + 0x214),local_400);
  return iVar1 + iVar7;
}



int __cdecl FUN_1001bea0(int param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  char *unaff_EDI;
  
  cVar1 = *unaff_EDI;
  iVar3 = 0;
  if (cVar1 != '\0') {
    while ((cVar1 != '%' || (unaff_EDI[iVar3 + 1] != '%'))) {
      FUN_1001b490(*(int *)(param_1 + 0x214),cVar1);
      cVar1 = unaff_EDI[iVar3 + 1];
      iVar3 = iVar3 + 1;
      if (cVar1 == '\0') {
        return iVar3;
      }
    }
    iVar2 = FUN_1001b7d0(param_1,unaff_EDI + iVar3);
    iVar3 = iVar3 + iVar2;
  }
  return iVar3;
}



undefined4 * FUN_1001bef0(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  WSADATA local_190;
  
  puVar1 = (undefined4 *)_malloc(0x12a4);
  puVar3 = puVar1;
  for (iVar2 = 0x4a9; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar1[4] = 0x80;
  WSAStartup(2,&local_190);
  return puVar1;
}



void __cdecl FUN_1001bf40(uint *param_1)

{
  SOCKET s;
  uint *_Memory;
  undefined4 *puVar1;
  
  if ((SOCKET *)param_1[0x88] != (SOCKET *)0x0) {
    s = *(SOCKET *)param_1[0x88];
    if (s != 0xffffffff) {
      shutdown(s,2);
      closesocket(*(SOCKET *)param_1[0x88]);
    }
    _free((void *)param_1[0x88]);
    param_1[0x88] = 0;
  }
  _Memory = (uint *)param_1[1];
  while (_Memory != (uint *)0x0) {
    if (_Memory != (uint *)0x0) {
      param_1[1] = *_Memory;
      _free(_Memory);
    }
    _Memory = (uint *)param_1[1];
    *param_1 = -(uint)(_Memory != (uint *)0x0) & 3;
  }
  FUN_1001b430((int)param_1);
  puVar1 = FUN_1001b3c0((int)param_1,"");
  param_1[0x85] = (uint)puVar1;
  puVar1 = FUN_1001b3c0((int)param_1,"$");
  param_1[0x86] = 0;
  *(undefined1 *)(param_1 + 0x89) = 0;
  *(undefined1 *)(param_1 + 0x489) = 0;
  param_1[2] = 0;
  param_1[0x87] = (uint)puVar1;
  return;
}



void __cdecl FUN_1001c000(uint *param_1,undefined4 param_2,char *param_3)

{
  FUN_1001bf40(param_1);
  FUN_10002230((char *)(param_1 + 0x89),0x1000,param_3);
  param_1[2] = 1;
  FUN_1001b560();
  return;
}



void __cdecl FUN_1001c040(uint *param_1)

{
  uint uVar1;
  uint *_Memory;
  int iVar2;
  
  while( true ) {
    if (*param_1 == 1) {
      FUN_1001ada0(param_1);
    }
    if ((int)param_1[2] < 0) {
      *param_1 = 3;
    }
    if (param_1[2] != 1) {
      return;
    }
    if (*param_1 == 0) {
      param_1[2] = 0;
      return;
    }
    if (*param_1 != 3) break;
    uVar1 = param_1[1];
    if (*(int *)(uVar1 + 0x10) == 0) {
      iVar2 = FUN_1001b5f0();
      *(int *)(uVar1 + 0xc) = iVar2;
    }
    iVar2 = FUN_1001bea0((int)param_1);
    iVar2 = *(int *)(uVar1 + 0x10) + iVar2;
    *(int *)(uVar1 + 0x10) = iVar2;
    if (*(int *)(uVar1 + 0xc) <= iVar2) {
      _Memory = (uint *)param_1[1];
      if (_Memory != (uint *)0x0) {
        param_1[1] = *_Memory;
        _free(_Memory);
      }
      *param_1 = -(uint)(param_1[1] != 0) & 3;
    }
  }
  return;
}



void __cdecl FUN_1001c0e0(uint *param_1)

{
  uint *_Memory;
  uint uVar1;
  int iVar2;
  
  uVar1 = param_1[2];
  while (uVar1 == 1) {
    if (*param_1 == 1) {
      FUN_1001ada0(param_1);
    }
    if ((int)param_1[2] < 0) {
      *param_1 = 3;
    }
    if (param_1[2] == 1) {
      if (*param_1 == 0) {
        param_1[2] = 0;
      }
      else if (*param_1 == 3) {
        uVar1 = param_1[1];
        if (*(int *)(uVar1 + 0x10) == 0) {
          iVar2 = FUN_1001b5f0();
          *(int *)(uVar1 + 0xc) = iVar2;
        }
        iVar2 = FUN_1001bea0((int)param_1);
        iVar2 = *(int *)(uVar1 + 0x10) + iVar2;
        *(int *)(uVar1 + 0x10) = iVar2;
        if (*(int *)(uVar1 + 0xc) <= iVar2) {
          _Memory = (uint *)param_1[1];
          if (_Memory != (uint *)0x0) {
            param_1[1] = *_Memory;
            _free(_Memory);
          }
          *param_1 = -(uint)(param_1[1] != 0) & 3;
        }
      }
    }
    uVar1 = param_1[2];
  }
  return;
}



uint * __cdecl FUN_1001c190(uint *param_1)

{
  uint *puVar1;
  
  FUN_1001c040(param_1);
  if (param_1[2] == 0) {
    return (uint *)&DAT_10039247;
  }
  if (param_1[2] == 1) {
    puVar1 = (uint *)0x0;
  }
  else {
    puVar1 = param_1 + 0x489;
    if ((char)param_1[0x489] == '\0') {
      return (uint *)"Misc Error";
    }
  }
  return puVar1;
}



undefined1 * __cdecl FUN_1001c1e0(uint *param_1,char *param_2)

{
  int iVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  
  puVar3 = (undefined1 *)0x0;
  FUN_1001c040(param_1);
  if (*param_1 == 0) {
    iVar1 = FUN_1001b360((int)param_1,param_2);
    if (iVar1 != 0) {
      puVar3 = *(undefined1 **)(iVar1 + 0x40);
    }
  }
  puVar2 = &DAT_10039247;
  if (param_1[2] == 0) {
    puVar2 = puVar3;
  }
  return puVar2;
}



undefined1 * __cdecl FUN_1001c220(uint *param_1,int param_2,undefined4 *param_3)

{
  char *pcVar1;
  undefined1 *puVar2;
  
  puVar2 = (undefined1 *)0x0;
  if ((-1 < param_2) && (param_2 < (int)param_1[3])) {
    pcVar1 = (char *)param_1[param_2 + 5];
    if (param_3 != (undefined4 *)0x0) {
      *param_3 = pcVar1;
    }
    puVar2 = FUN_1001c1e0(param_1,pcVar1);
  }
  return puVar2;
}



uint __cdecl FUN_1001c250(uint *param_1)

{
  if (param_1[2] == 1) {
    FUN_1001c040(param_1);
  }
  return param_1[2];
}



void __cdecl FUN_1001c270(int param_1,char *param_2,char *param_3)

{
  char *pcVar1;
  char cVar2;
  undefined4 *puVar3;
  
  puVar3 = (undefined4 *)FUN_1001b360(param_1,param_2);
  if ((puVar3 != (undefined4 *)0x0) ||
     (puVar3 = FUN_1001b3c0(param_1,param_2), puVar3 != (undefined4 *)0x0)) {
    if (0 < (int)puVar3[0x11]) {
      _free((void *)puVar3[0x10]);
      puVar3[0x11] = 0;
      puVar3[0x12] = 0;
      puVar3[0x10] = &DAT_10039247;
    }
    cVar2 = *param_3;
    while (cVar2 != '\0') {
      FUN_1001b490((int)puVar3,cVar2);
      pcVar1 = param_3 + 1;
      param_3 = param_3 + 1;
      cVar2 = *pcVar1;
    }
  }
  return;
}



undefined4 __cdecl FUN_1001c2f0(uint *param_1)

{
  if (param_1 != (uint *)0x0) {
    FUN_1001bf40(param_1);
    FUN_1001b430((int)param_1);
    _free(param_1);
    WSACleanup();
  }
  return 0;
}



void __fastcall FUN_1001c320(undefined4 param_1,byte *param_2)

{
  byte bVar1;
  char cVar2;
  char *in_EAX;
  
  do {
    do {
      bVar1 = (&DAT_1003d210)[*param_2];
      param_2 = param_2 + 1;
    } while (bVar1 == 1);
    cVar2 = *in_EAX;
    in_EAX = in_EAX + 1;
  } while (((uint)bVar1 == (int)cVar2) && (bVar1 != 0));
  return;
}



undefined4 * __cdecl
FUN_1001c350(int param_1,int param_2,int param_3,int param_4,undefined4 param_5,int param_6)

{
  void *_Memory;
  undefined4 *_Memory_00;
  uint uVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  
  _Memory_00 = (undefined4 *)_malloc(0x238);
  puVar2 = _Memory_00;
  for (iVar3 = 0x8e; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  _Memory_00[1] = param_5;
  if (param_1 < 2) {
    param_1 = 2;
  }
  if (param_2 < 1) {
    param_2 = 1;
  }
  _Memory_00[5] = param_1;
  _Memory_00[4] = param_2 + param_1;
  if (param_3 < 2) {
    param_3 = 2;
  }
  _Memory_00[6] = param_3;
  uVar1 = param_4 + 3U & 0x7ffc;
  _Memory_00[7] = uVar1;
  puVar2 = (undefined4 *)_malloc(uVar1 * (param_2 + param_1));
  iVar3 = _Memory_00[4];
  iVar5 = _Memory_00[7];
  _Memory_00[9] = puVar2;
  for (uVar1 = (uint)(iVar3 * iVar5) >> 2; uVar1 != 0; uVar1 = uVar1 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (uVar1 = iVar3 * iVar5 & 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  puVar2 = (undefined4 *)_malloc((_Memory_00[4] + 1) * 0xc);
  _Memory_00[8] = puVar2;
  for (uVar1 = (_Memory_00[4] + 1) * 3 & 0x3fffffff; uVar1 != 0; uVar1 = uVar1 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  puVar2 = (undefined4 *)_malloc((_Memory_00[7] + 0x14) * _Memory_00[4]);
  uVar4 = (_Memory_00[7] + 0x14) * _Memory_00[4];
  _Memory_00[0xb] = puVar2;
  for (uVar1 = uVar4 >> 2; uVar1 != 0; uVar1 = uVar1 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  _Memory = (void *)_Memory_00[9];
  if (_Memory != (void *)0x0) {
    if ((_Memory_00[8] != 0) && (_Memory_00[0xb] != 0)) {
      iVar3 = 0;
      if (0 < (int)_Memory_00[4]) {
        iVar5 = 0;
        do {
          *(int *)(iVar5 + 4 + _Memory_00[8]) = iVar3;
          iVar3 = iVar3 + 1;
          iVar5 = iVar5 + 0xc;
        } while (iVar3 < (int)_Memory_00[4]);
      }
      if (param_6 < 1) {
        param_6 = 0x10;
      }
      puVar2 = FUN_1002c800(param_6 + 1,4);
      _Memory_00[0xc] = puVar2;
      if (puVar2 == (undefined4 *)0x0) {
        _free((void *)_Memory_00[9]);
        _free((void *)_Memory_00[8]);
        _free((void *)_Memory_00[0xb]);
        _free(_Memory_00);
        return (undefined4 *)0x0;
      }
      FUN_1002c1c0((int)puVar2,FUN_10019c70);
      return _Memory_00;
    }
    if (_Memory != (void *)0x0) {
      _free(_Memory);
    }
  }
  if ((void *)_Memory_00[8] != (void *)0x0) {
    _free((void *)_Memory_00[8]);
  }
  if ((void *)_Memory_00[0xb] != (void *)0x0) {
    _free((void *)_Memory_00[0xb]);
  }
  _free(_Memory_00);
  return (undefined4 *)0x0;
}



void __cdecl FUN_1001c510(void *param_1)

{
  FUN_1002c1d0(*(int **)((int)param_1 + 0x30));
  _free(*(void **)((int)param_1 + 0x20));
  _free(*(void **)((int)param_1 + 0x24));
  _free(*(void **)((int)param_1 + 0x2c));
  _free(param_1);
  return;
}



void FUN_1001c550(int *param_1)

{
  uint uVar1;
  uint uVar2;
  int *piVar3;
  undefined4 *puVar4;
  
  uVar1 = (param_1[7] + 0x14) * param_1[4];
  *param_1 = 0;
  param_1[3] = 0;
  puVar4 = (undefined4 *)param_1[0xb];
  for (uVar2 = uVar1 >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  for (uVar1 = uVar1 & 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    *(undefined1 *)puVar4 = 0;
    puVar4 = (undefined4 *)((int)puVar4 + 1);
  }
  piVar3 = (int *)((param_1[10] % param_1[4]) * (param_1[7] + 0x14) + param_1[0xb]);
  *piVar3 = param_1[10];
  piVar3[2] = 0;
  piVar3[3] = 0;
  piVar3[4] = 0;
  piVar3[1] = -2;
  uVar2 = param_1[7];
  piVar3 = piVar3 + 5;
  for (uVar1 = uVar2 >> 2; uVar1 != 0; uVar1 = uVar1 - 1) {
    *piVar3 = 0;
    piVar3 = piVar3 + 1;
  }
  for (uVar2 = uVar2 & 3; uVar2 != 0; uVar2 = uVar2 - 1) {
    *(undefined1 *)piVar3 = 0;
    piVar3 = (int *)((int)piVar3 + 1);
  }
  *param_1 = *param_1 + 1;
  param_1[10] = param_1[10] + 1;
  FUN_1002c870((int *)param_1[0xc]);
  return;
}



int __cdecl FUN_1001c5e0(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  
  iVar4 = *(int *)(param_1 + 0xc);
  if (iVar4 < 1) {
    return -1;
  }
  piVar3 = *(int **)(param_1 + 0x20);
  if (*piVar3 < param_2) {
    return -1;
  }
  if (param_2 == *piVar3) {
    return 0;
  }
  if ((param_2 < piVar3[iVar4 * 3 + -3]) ||
     ((*(int *)(param_1 + 0x14) <= iVar4 && (param_2 < piVar3[*(int *)(param_1 + 0x14) * 3])))) {
    return -1;
  }
  iVar4 = iVar4 + -1;
  iVar5 = 1;
  iVar2 = 0;
  if (0 < iVar4) {
    do {
      iVar2 = (iVar4 + iVar5) / 2;
      iVar1 = piVar3[iVar2 * 3];
      if (param_2 == iVar1) break;
      if (param_2 == iVar1 || param_2 - iVar1 < 0) {
        iVar5 = iVar2 + 1;
      }
      else {
        iVar4 = iVar2 + -1;
      }
    } while (iVar5 <= iVar4);
    if (0 < iVar2) {
      piVar3 = piVar3 + iVar2 * 3 + -3;
      do {
        if (param_2 != *piVar3) {
          return iVar2;
        }
        iVar2 = iVar2 + -1;
        piVar3 = piVar3 + -3;
      } while (0 < iVar2);
    }
  }
  return iVar2;
}



int __cdecl FUN_1001c690(int *param_1,int param_2,int param_3,int *param_4)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  void *pvVar5;
  undefined4 *puVar6;
  byte *pbVar7;
  uint uVar8;
  uint uVar9;
  int iVar10;
  int *piVar11;
  int iVar12;
  int *piVar13;
  ushort uVar14;
  int *piVar15;
  undefined4 *puVar16;
  int local_90;
  ushort local_8c;
  int local_88;
  byte local_80 [128];
  
  iVar12 = -1;
  local_90 = -1;
  if (param_2 == -2) {
    FUN_1001c550(param_1);
    return 0;
  }
  if ((param_4 == (int *)0x0) || ((char)*param_4 == '\0')) {
    return -10;
  }
  bVar1 = (&DAT_1003d210)[(char)*param_4];
  uVar14 = 0;
  pbVar7 = local_80;
  local_8c = 0;
  iVar10 = 0x7f;
  piVar13 = param_4;
  while (bVar1 != 0) {
    piVar13 = (int *)((int)piVar13 + 1);
    if (bVar1 != 1) {
      *pbVar7 = bVar1;
      local_8c = uVar14 * 3 ^ (ushort)bVar1;
      pbVar7 = pbVar7 + 1;
      iVar10 = iVar10 + -1;
      uVar14 = local_8c;
      if (iVar10 == 0) break;
    }
    bVar1 = (&DAT_1003d210)[*(char *)piVar13];
  }
  iVar10 = param_1[1];
  *pbVar7 = 0;
  if (iVar10 == 1) {
    if (50000 < param_1[2]) {
      iVar10 = param_1[3];
      param_1[2] = 0;
      if (-1 < iVar10 + -1) {
        iVar2 = (iVar10 + -1) * 0xc;
        do {
          iVar3 = param_1[2];
          param_1[2] = iVar3 + 1;
          *(int *)(iVar2 + param_1[8]) = iVar3 + 1;
          iVar2 = iVar2 + -0xc;
          iVar10 = iVar10 + -1;
        } while (iVar10 != 0);
      }
    }
    param_3 = param_1[2] + 1;
    param_1[2] = param_3;
    param_2 = 0;
  }
  piVar13 = (int *)FUN_1002c7c0(param_1[0xc],param_4);
  if (piVar13 == (int *)0x0) {
    if (param_2 == -1) {
      return -0xb;
    }
  }
  else {
    param_2 = *piVar13;
  }
  iVar10 = local_90;
  if ((((0 < param_2) && (iVar2 = param_1[3], 0 < iVar2)) && (param_2 <= *(int *)param_1[8])) &&
     (((int *)param_1[8])[iVar2 * 3 + -3] <= param_2)) {
    iVar2 = iVar2 + -1;
    local_88 = 0;
    if (-1 < iVar2) {
      do {
        iVar10 = (local_88 + iVar2) / 2;
        piVar15 = (int *)(param_1[8] + iVar10 * 0xc);
        iVar3 = param_2 - *piVar15;
        if ((iVar3 == 0) &&
           (iVar3 = FUN_1001c320(piVar15,(byte *)(piVar15[1] * param_1[7] + param_1[9])), iVar3 == 0
           )) break;
        if (iVar3 < 1) {
          local_88 = iVar10 + 1;
        }
        else {
          iVar2 = iVar10 + -1;
        }
        iVar10 = local_90;
      } while (local_88 <= iVar2);
    }
  }
  local_90 = iVar10;
  if (param_1[1] == 2) {
    if (0 < param_3) {
      if (param_3 < param_2) {
        return -1;
      }
      goto LAB_1001c883;
    }
  }
  else {
LAB_1001c883:
    if (0 < param_3) {
      iVar10 = param_1[3];
      if ((0 < iVar10) && (*(int *)(param_1[8] + -0xc + iVar10 * 0xc) <= param_3)) {
        iVar10 = iVar10 + -1;
        iVar2 = 0;
        iVar12 = 0;
        if (-1 < iVar10) {
          do {
            iVar12 = (iVar10 + iVar2) / 2;
            iVar3 = param_1[8] + iVar12 * 0xc;
            iVar4 = param_3 - *(int *)(param_1[8] + iVar12 * 0xc);
            if ((iVar4 == 0) &&
               (iVar4 = FUN_1001c320(iVar3,(byte *)(*(int *)(iVar3 + 4) * param_1[7] + param_1[9])),
               iVar4 == 0)) goto LAB_1001c8f2;
            if (iVar4 < 1) {
              iVar2 = iVar12 + 1;
            }
            else {
              iVar10 = iVar12 + -1;
            }
          } while (iVar2 <= iVar10);
          if (iVar4 < 0) {
            iVar12 = iVar12 + 1;
          }
        }
      }
LAB_1001c8f2:
      if ((param_1[3] < param_1[4]) && (iVar12 < 0)) {
        iVar12 = param_1[3];
      }
    }
  }
  if ((local_90 < 0) && (iVar12 < 0)) {
    return -2;
  }
  if (iVar12 < param_1[4]) {
    if (-1 < local_90) goto LAB_1001c93b;
  }
  else {
    if (local_90 < 0) {
      return -3;
    }
LAB_1001c93b:
    if (local_90 < iVar12) {
      iVar12 = iVar12 + -1;
    }
  }
  piVar11 = (int *)((param_1[10] % param_1[4]) * (param_1[7] + 0x14) + param_1[0xb]);
  *piVar11 = param_1[10];
  piVar11[1] = param_2;
  piVar11[3] = local_90;
  piVar11[2] = param_3;
  piVar11[4] = iVar12;
  uVar9 = param_1[7];
  piVar15 = param_4;
  piVar11 = piVar11 + 5;
  for (uVar8 = uVar9 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
    *piVar11 = *piVar15;
    piVar15 = piVar15 + 1;
    piVar11 = piVar11 + 1;
  }
  for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
    *(char *)piVar11 = (char)*piVar15;
    piVar15 = (int *)((int)piVar15 + 1);
    piVar11 = (int *)((int)piVar11 + 1);
  }
  *param_1 = *param_1 + 1;
  param_1[10] = param_1[10] + 1;
  if (iVar12 == local_90) {
    iVar10 = iVar12 * 0xc;
    *(int *)(iVar10 + param_1[8]) = param_3;
    *(ushort *)(iVar10 + 8 + param_1[8]) = local_8c;
    uVar9 = param_1[7];
    piVar15 = (int *)(*(int *)(iVar10 + 4 + param_1[8]) * uVar9 + param_1[9]);
    for (uVar8 = uVar9 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
      *piVar15 = *param_4;
      param_4 = param_4 + 1;
      piVar15 = piVar15 + 1;
    }
    for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
      *(char *)piVar15 = (char)*param_4;
      param_4 = (int *)((int)param_4 + 1);
      piVar15 = (int *)((int)piVar15 + 1);
    }
    if (piVar13 == (int *)0x0) {
      return iVar12;
    }
    *piVar13 = param_3;
    return iVar12;
  }
  if (iVar12 < 0) {
LAB_1001cb3c:
    if (-1 < local_90) {
      if (-1 < iVar12) goto LAB_1001cbd8;
      puVar16 = (undefined4 *)(local_90 * 0xc + param_1[8]);
      puVar6 = (undefined4 *)(param_1[8] + param_1[4] * 0xc);
      *puVar6 = *puVar16;
      puVar6[1] = puVar16[1];
      puVar6[2] = puVar16[2];
      pvVar5 = (void *)(param_1[8] + local_90 * 0xc);
      _memmove(pvVar5,(void *)((int)pvVar5 + 0xc),((param_1[3] - local_90) + -1) * 0xc);
      puVar16 = (undefined4 *)(param_1[8] + param_1[4] * 0xc);
      puVar6 = (undefined4 *)(param_1[8] + -0xc + param_1[3] * 0xc);
      *puVar6 = *puVar16;
      puVar6[1] = puVar16[1];
      puVar6[2] = puVar16[2];
      param_1[3] = param_1[3] + -1;
      FUN_1002c550(param_1[0xc],param_4);
    }
  }
  else if (-1 < local_90) {
    if (iVar12 < local_90) {
      puVar16 = (undefined4 *)(param_1[8] + local_90 * 0xc);
      puVar6 = (undefined4 *)(param_1[8] + param_1[4] * 0xc);
      *puVar6 = *puVar16;
      puVar6[1] = puVar16[1];
      puVar6[2] = puVar16[2];
      pvVar5 = (void *)(param_1[8] + iVar12 * 0xc);
      _memmove((void *)((int)pvVar5 + 0xc),pvVar5,(local_90 - iVar12) * 0xc);
      puVar16 = (undefined4 *)(param_1[8] + param_1[4] * 0xc);
      puVar6 = (undefined4 *)(iVar12 * 0xc + param_1[8]);
      *puVar6 = *puVar16;
      puVar6[1] = puVar16[1];
      puVar6[2] = puVar16[2];
    }
    else {
      puVar16 = (undefined4 *)(local_90 * 0xc + param_1[8]);
      puVar6 = (undefined4 *)(param_1[8] + param_1[4] * 0xc);
      *puVar6 = *puVar16;
      puVar6[1] = puVar16[1];
      puVar6[2] = puVar16[2];
      pvVar5 = (void *)(param_1[8] + local_90 * 0xc);
      _memmove(pvVar5,(void *)((int)pvVar5 + 0xc),(iVar12 - local_90) * 0xc);
      puVar16 = (undefined4 *)(param_1[8] + param_1[4] * 0xc);
      puVar6 = (undefined4 *)(param_1[8] + iVar12 * 0xc);
      *puVar6 = *puVar16;
      puVar6[1] = puVar16[1];
      puVar6[2] = puVar16[2];
    }
    iVar10 = iVar12 * 0xc;
    *(int *)(iVar10 + param_1[8]) = param_3;
    *(ushort *)(iVar10 + 8 + param_1[8]) = local_8c;
    uVar9 = param_1[7];
    piVar15 = param_4;
    piVar11 = (int *)(*(int *)(iVar10 + 4 + param_1[8]) * uVar9 + param_1[9]);
    for (uVar8 = uVar9 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
      *piVar11 = *piVar15;
      piVar15 = piVar15 + 1;
      piVar11 = piVar11 + 1;
    }
    for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
      *(char *)piVar11 = (char)*piVar15;
      piVar15 = (int *)((int)piVar15 + 1);
      piVar11 = (int *)((int)piVar11 + 1);
    }
    if (piVar13 != (int *)0x0) {
      *piVar13 = param_3;
    }
    goto LAB_1001cb3c;
  }
  if (iVar12 < 0) {
    return iVar12;
  }
LAB_1001cbd8:
  if (local_90 < 0) {
    if (param_1[3] == param_1[4]) {
      param_1[3] = param_1[3] + -1;
      iVar10 = param_1[0xb];
      iVar2 = (param_1[10] % param_1[4]) * (param_1[7] + 0x14);
      *(int *)(iVar2 + iVar10) = param_1[10];
      iVar2 = iVar2 + iVar10;
      *(undefined4 *)(iVar2 + 4) = *(undefined4 *)(param_1[8] + param_1[3] * 0xc);
      *(undefined4 *)(iVar2 + 8) = 0;
      iVar10 = param_1[3];
      *(undefined4 *)(iVar2 + 0x10) = 0xffffffff;
      *(int *)(iVar2 + 0xc) = iVar10 + -1;
      uVar9 = param_1[7];
      puVar16 = (undefined4 *)(*(int *)(param_1[8] + 4 + param_1[3] * 0xc) * uVar9 + param_1[9]);
      puVar6 = (undefined4 *)(iVar2 + 0x14);
      for (uVar8 = uVar9 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
        *puVar6 = *puVar16;
        puVar16 = puVar16 + 1;
        puVar6 = puVar6 + 1;
      }
      for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
        *(undefined1 *)puVar6 = *(undefined1 *)puVar16;
        puVar16 = (undefined4 *)((int)puVar16 + 1);
        puVar6 = (undefined4 *)((int)puVar6 + 1);
      }
      FUN_1002c550(param_1[0xc],(undefined4 *)(iVar2 + 0x14));
      param_1[10] = param_1[10] + 1;
    }
    if (0 < param_1[3]) {
      puVar16 = (undefined4 *)(param_1[8] + param_1[3] * 0xc);
      puVar6 = (undefined4 *)(param_1[8] + param_1[4] * 0xc);
      *puVar6 = *puVar16;
      puVar6[1] = puVar16[1];
      puVar6[2] = puVar16[2];
      pvVar5 = (void *)(iVar12 * 0xc + param_1[8]);
      _memmove((void *)((int)pvVar5 + 0xc),pvVar5,(param_1[3] - iVar12) * 0xc);
      *(undefined4 *)(iVar12 * 0xc + 4 + param_1[8]) =
           *(undefined4 *)(param_1[8] + 4 + param_1[4] * 0xc);
    }
    iVar10 = iVar12 * 0xc;
    *(int *)(iVar10 + param_1[8]) = param_3;
    *(ushort *)(iVar10 + 8 + param_1[8]) = local_8c;
    uVar9 = param_1[7];
    piVar13 = param_4;
    piVar15 = (int *)(*(int *)(iVar10 + 4 + param_1[8]) * uVar9 + param_1[9]);
    for (uVar8 = uVar9 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
      *piVar15 = *piVar13;
      piVar13 = piVar13 + 1;
      piVar15 = piVar15 + 1;
    }
    for (uVar9 = uVar9 & 3; uVar9 != 0; uVar9 = uVar9 - 1) {
      *(char *)piVar15 = (char)*piVar13;
      piVar13 = (int *)((int)piVar13 + 1);
      piVar15 = (int *)((int)piVar15 + 1);
    }
    param_1[3] = param_1[3] + 1;
    iVar10 = FUN_1002c280(param_1[0xc],(char *)param_4,(char *)0xffffffff,(char *)&param_3,4);
    if (iVar10 < 1) {
      _printf("error updating user %s - %d\n",param_4,iVar10);
      return iVar12;
    }
  }
  return iVar12;
}



void __cdecl FUN_1001cd80(int *param_1,int *param_2)

{
  FUN_1001c690(param_1,-3,0,param_2);
  return;
}



int __cdecl FUN_1001cda0(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + 0xc);
  if (*(int *)(param_1 + 0x14) <= *(int *)(param_1 + 0xc)) {
    iVar1 = *(int *)(param_1 + 0x14);
  }
  return iVar1;
}



undefined4 __cdecl FUN_1001cdc0(int param_1)

{
  return *(undefined4 *)(param_1 + 0x14);
}



undefined4 __cdecl FUN_1001cdd0(int param_1)

{
  return *(undefined4 *)(param_1 + 0x1c);
}



int __cdecl FUN_1001cde0(int param_1,int param_2,undefined4 *param_3,int *param_4)

{
  int iVar1;
  
  if ((param_2 < 0) || (*(int *)(param_1 + 0xc) <= param_2)) {
    return 0;
  }
  if (param_3 != (undefined4 *)0x0) {
    *param_3 = *(undefined4 *)(*(int *)(param_1 + 0x20) + param_2 * 0xc);
  }
  if ((param_4 != (int *)0x0) && (*param_4 = param_2, 0 < param_2)) {
    do {
      if (*(int *)(*(int *)(param_1 + 0x20) + param_2 * 0xc) !=
          *(int *)(*(int *)(param_1 + 0x20) + -0xc + *param_4 * 0xc)) break;
      iVar1 = *param_4 + -1;
      *param_4 = iVar1;
    } while (0 < iVar1);
  }
  return *(int *)(*(int *)(param_1 + 0x20) + 4 + param_2 * 0xc) * *(int *)(param_1 + 0x1c) +
         *(int *)(param_1 + 0x24);
}



int __cdecl
FUN_1001ce60(int param_1,int *param_2,int *param_3,undefined4 *param_4,undefined4 *param_5)

{
  int iVar1;
  int iVar2;
  
  if (*param_2 != *(int *)(param_1 + 0x28)) {
    do {
      iVar2 = (*param_2 % *(int *)(param_1 + 0x10)) * (*(int *)(param_1 + 0x1c) + 0x14) +
              *(int *)(param_1 + 0x2c);
      *param_2 = *param_2 + 1;
      if (((-1 < *(int *)(iVar2 + 0xc)) && (*(int *)(iVar2 + 0xc) < *param_3)) ||
         ((-1 < *(int *)(iVar2 + 0x10) && (*(int *)(iVar2 + 0x10) < *param_3)))) {
        if ((*(int *)(iVar2 + 0xc) < 0) || (iVar1 = *param_3, iVar1 <= *(int *)(iVar2 + 0xc))) {
          *param_3 = *param_3 + 1;
        }
        else if ((*(int *)(iVar2 + 0x10) < 0) || (iVar1 <= *(int *)(iVar2 + 0x10))) {
          *param_3 = iVar1 + -1;
        }
        if (param_4 != (undefined4 *)0x0) {
          *param_4 = *(undefined4 *)(iVar2 + 4);
        }
        if (param_5 != (undefined4 *)0x0) {
          *param_5 = *(undefined4 *)(iVar2 + 8);
        }
        return iVar2 + 0x14;
      }
    } while (*param_2 != *(int *)(param_1 + 0x28));
  }
  return 0;
}



bool __cdecl FUN_1001cf00(int param_1,FILE *param_2)

{
  size_t sVar1;
  undefined4 local_c;
  undefined4 local_8;
  ushort local_4;
  
  local_4 = *(ushort *)(param_1 + 0x1c);
  local_c = 0x11234;
  local_8 = CONCAT22(*(undefined2 *)(param_1 + 0x10),*(undefined2 *)(param_1 + 0xc));
  _fwrite(&local_c,10,1,param_2);
  _fwrite(*(void **)(param_1 + 0x20),0xc,local_8 & 0xffff,param_2);
  sVar1 = _fwrite(*(void **)(param_1 + 0x24),(uint)local_4,local_8 >> 0x10,param_2);
  return sVar1 == local_8 >> 0x10;
}



int __cdecl FUN_1001d090(int param_1,char *param_2)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  iVar2 = param_1;
  piVar3 = (int *)FUN_1002c7c0(*(int *)(param_1 + 0x30),param_2);
  if (piVar3 == (int *)0x0) {
    return -1;
  }
  iVar6 = 0;
  iVar4 = *(int *)(param_1 + 0xc);
  if (*(int *)(param_1 + 0x14) <= *(int *)(param_1 + 0xc)) {
    iVar4 = *(int *)(param_1 + 0x14);
  }
  iVar4 = iVar4 + -1;
  param_1 = -1;
  if (-1 < iVar4) {
    while( true ) {
      param_1 = (iVar4 + iVar6) / 2;
      piVar1 = (int *)(*(int *)(iVar2 + 0x20) + param_1 * 0xc);
      iVar5 = *piVar3 - *piVar1;
      if ((iVar5 == 0) &&
         (iVar5 = FUN_10019c70((char *)(piVar1[1] * *(int *)(iVar2 + 0x1c) + *(int *)(iVar2 + 0x24))
                               ,param_2), iVar5 == 0)) break;
      if (iVar5 < 1) {
        iVar6 = param_1 + 1;
      }
      else {
        iVar4 = param_1 + -1;
      }
      if (iVar4 < iVar6) {
        return -1;
      }
    }
  }
  return param_1;
}



undefined4 __cdecl FUN_1001d140(int param_1,char *param_2)

{
  int iVar1;
  int local_4;
  
  local_4 = -1;
  iVar1 = FUN_1001d090(param_1,param_2);
  if (iVar1 < 0) {
    return 0xffffffff;
  }
  iVar1 = FUN_1001cde0(param_1,iVar1,(undefined4 *)0x0,&local_4);
  if (iVar1 == 0) {
    return 0xffffffff;
  }
  return local_4;
}



undefined1 * FUN_1001d190(void)

{
  if (DAT_10052b08 == '\0') {
    _sprintf(&DAT_10052b08,"llll%dsl%ds%ds%ds%ds",0x10,0x10,0x44,0x44,0x14);
  }
  return &DAT_10052b08;
}



undefined4 * __cdecl FUN_1001d1c0(int param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int iVar3;
  
  puVar1 = (undefined4 *)_malloc(0xdc);
  puVar2 = (undefined4 *)0x0;
  if (puVar1 != (undefined4 *)0x0) {
    puVar2 = puVar1;
    for (iVar3 = 0x37; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    puVar1[8] = param_1;
    puVar2 = FUN_10018b00(param_1 / 2,param_1);
    puVar1[0x34] = puVar2;
    puVar2 = FUN_10019e90(param_1,param_1 * 2);
    puVar1[0x35] = puVar2;
    puVar2 = puVar1;
  }
  return puVar2;
}



void __cdecl FUN_1001d220(void *param_1)

{
  if (param_1 != (void *)0x0) {
    if (*(void **)((int)param_1 + 0xd0) != (void *)0x0) {
      FUN_10018680(*(void **)((int)param_1 + 0xd0));
    }
    if (*(void **)((int)param_1 + 0xd4) != (void *)0x0) {
      FUN_10019f20(*(void **)((int)param_1 + 0xd4));
    }
    if (*(int **)((int)param_1 + 0xd8) != (int *)0x0) {
      FUN_1002c1d0(*(int **)((int)param_1 + 0xd8));
    }
    _free(param_1);
  }
  return;
}



void __cdecl FUN_1001d270(int param_1,int *param_2)

{
  FUN_10018820(*(void **)(param_1 + 0xd0),(int *)*(void **)(param_1 + 0xd0),(byte *)(param_2 + 8),
               (int)param_2);
  FUN_10019f50(*(int **)(param_1 + 0xd4),*param_2,param_2);
  return;
}



bool __cdecl FUN_1001d2b0(int param_1,int *param_2)

{
  int iVar1;
  void *this;
  
  FUN_1001a0d0(*(int *)(param_1 + 0xd4),*param_2);
  iVar1 = FUN_100188e0(this,*(int **)(param_1 + 0xd0),(byte *)(param_2 + 8));
  return iVar1 != 0;
}



void __cdecl FUN_1001d2f0(int param_1,undefined4 *param_2)

{
  int iVar1;
  int *piVar2;
  
  iVar1 = 0;
  piVar2 = (int *)(param_1 + 0x454);
  do {
    if (*piVar2 == 0) {
      *(undefined4 *)(param_1 + 0x454 + iVar1 * 4) = *param_2;
      *(int *)(param_1 + 4) = *(int *)(param_1 + 4) + 1;
      return;
    }
    iVar1 = iVar1 + 1;
    piVar2 = piVar2 + 1;
  } while (iVar1 < 4);
  return;
}



void __cdecl FUN_1001d320(int param_1,int param_2,int *param_3)

{
  int iVar1;
  bool bVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  void *this;
  int iVar7;
  int *local_4;
  
  local_4 = (int *)0x0;
  do {
    iVar5 = *(int *)(param_2 + (int)local_4 * 4);
    if (iVar5 == 0) break;
    bVar2 = false;
    iVar7 = 0;
    piVar3 = param_3 + 0x115;
    do {
      if (bVar2) goto LAB_1001d3ad;
      if (*piVar3 == 0) goto LAB_1001d36d;
      if (iVar5 == *piVar3) {
        bVar2 = true;
      }
      iVar7 = iVar7 + 1;
      piVar3 = piVar3 + 1;
    } while (iVar7 < 4);
    if (!bVar2) {
LAB_1001d36d:
      piVar3 = (int *)FUN_1001a190(param_1,iVar5);
      if (piVar3 != (int *)0x0) {
        FUN_1001a0d0(piVar3[0x35],*param_3);
        FUN_100188e0((void *)piVar3[0x34],(int *)piVar3[0x34],(byte *)(param_3 + 8));
        FUN_1001a010(param_1,*piVar3);
      }
    }
LAB_1001d3ad:
    local_4 = (int *)((int)local_4 + 1);
  } while ((int)local_4 < 4);
  local_4 = param_3 + 0x119;
  piVar3 = local_4;
  for (iVar5 = 0x10; iVar5 != 0; iVar5 = iVar5 + -1) {
    *piVar3 = 0;
    piVar3 = piVar3 + 1;
  }
  iVar5 = 0;
  piVar3 = param_3 + 0x115;
  do {
    iVar7 = *piVar3;
    if (iVar7 == 0) {
      return;
    }
    bVar2 = false;
    iVar6 = 0;
    do {
      if ((bVar2) || (iVar1 = *(int *)(param_2 + iVar6 * 4), iVar1 == 0)) break;
      if (iVar1 == iVar7) {
        bVar2 = true;
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 < 4);
    piVar4 = (int *)FUN_1001a190(param_1,iVar7);
    if (piVar4 != (int *)0x0) {
      if (!bVar2) {
        FUN_10018820(this,(int *)piVar4[0x34],(byte *)(param_3 + 8),(int)param_3);
        FUN_10019f50((int *)piVar4[0x35],*param_3,param_3);
        FUN_1001a010(param_1,*piVar4);
      }
      _strncpy((char *)local_4,(char *)(piVar4 + 9),0x10);
    }
    iVar5 = iVar5 + 1;
    local_4 = local_4 + 4;
    piVar3 = piVar3 + 1;
    if (3 < iVar5) {
      return;
    }
  } while( true );
}



void __cdecl FUN_1001d490(byte *param_1,byte *param_2)

{
  FUN_10002c50(param_1,param_2,(byte *)"I=%d T=%d SF=%f CF=%d O=%s S=%d N=%s D=%s P=%s");
  return;
}



void __cdecl FUN_1001d4d0(byte *param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  byte *_Dest;
  byte local_48 [72];
  
  _Dest = local_48;
  local_48[0] = 0;
  pcVar3 = (char *)(param_3 + 0x464);
  iVar2 = 4;
  do {
    if (*pcVar3 != '\0') {
      iVar1 = _sprintf((char *)_Dest,"%s,",pcVar3);
      _Dest = _Dest + iVar1;
    }
    pcVar3 = pcVar3 + 0x10;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  if ((_Dest != local_48) && (_Dest[-1] == 0x2c)) {
    _Dest[-1] = 0;
  }
  FUN_10002620(param_1,param_2,&DAT_1003d384,local_48);
  return;
}



void __cdecl FUN_1001d550(int param_1,int *param_2,int *param_3)

{
  int *piVar1;
  int iVar2;
  void *this;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this_00;
  int *piVar3;
  int local_4;
  
  piVar3 = param_3 + 0x115;
  local_4 = 4;
  do {
    if ((*piVar3 != 0) && (piVar1 = (int *)FUN_1001a190(param_1,*piVar3), piVar1 != (int *)0x0)) {
      FUN_1001a0d0(piVar1[0x35],*param_3);
      FUN_100188e0(this,(int *)piVar1[0x34],(byte *)(param_3 + 8));
      iVar2 = FUN_10019c70((char *)(piVar1 + 4),(char *)(param_3 + 8));
      this_00 = extraout_ECX;
      if ((iVar2 == 0) ||
         ((iVar2 = FUN_10018780((undefined4 *)piVar1[0x34]), iVar2 == 0 &&
          (this_00 = extraout_ECX_00, (piVar1[2] & 0x80000U) == 0)))) {
        FUN_100188e0(this_00,param_2,(byte *)(piVar1 + 9));
        FUN_1001a0d0(param_1,*piVar1);
        FUN_1001d220(piVar1);
      }
    }
    piVar3 = piVar3 + 1;
    local_4 = local_4 + -1;
  } while (local_4 != 0);
  return;
}



uint __cdecl FUN_1001d610(int param_1,int param_2)

{
  uint uVar1;
  int *piVar2;
  
  uVar1 = 0;
  piVar2 = (int *)(param_1 + 0x454);
  do {
    if (*piVar2 == param_2) {
      return CONCAT31((int3)(uVar1 >> 8),1);
    }
    uVar1 = uVar1 + 1;
    piVar2 = piVar2 + 1;
  } while ((int)uVar1 < 4);
  return uVar1 & 0xffffff00;
}



void FUN_1001d640(void)

{
  _sprintf(&DAT_10052b88,"lll%ds%ds%dslllll%ds%dsllll",0x24,0x48,0x14,0x24,0x84);
  _sprintf(&DAT_10052c88,"l%ds",0x24);
  _sprintf(&DAT_10052c08,"%dsllll%ds",0x10,0x24);
  return;
}



void __cdecl
FUN_1001d690(int param_1,undefined4 param_2,byte *param_3,int param_4,byte *param_5,byte *param_6,
            undefined *param_7,undefined4 param_8,char param_9)

{
  char cVar1;
  int iVar2;
  int *piVar3;
  void *extraout_ECX;
  void *this;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  int local_28;
  int local_24;
  byte local_20 [32];
  
  pbVar4 = param_3;
  iVar5 = 0;
  local_28 = -1;
  if (0 < *(int *)(param_3 + 0x9c)) {
    pbVar6 = param_3 + 0x1c8;
    do {
      if (local_28 != -1) break;
      iVar2 = FUN_10019c70((char *)(param_4 + 0x20),(char *)(pbVar6 + -0x10));
      if (iVar2 == 0) {
        local_28 = *(int *)pbVar6;
      }
      iVar5 = iVar5 + 1;
      pbVar6 = pbVar6 + 0x68;
    } while (iVar5 < *(int *)(param_3 + 0x9c));
  }
  FUN_10002c50(param_5,param_6,
               (byte *)
               "IDENT=%d WHEN=%e NAME=%s HOST=%s ROOM=%d MAXSIZE=%d MINSIZE=%d COUNT=%d CUSTFLAGS=%d SYSFLAGS=%d EVID=%d EVGID=%d NUMPART=%d"
              );
  iVar5 = 0;
  local_24 = 0;
  if (0 < *(int *)(param_3 + 0x9c)) {
    pbVar6 = param_3 + 0x1b8;
    this = extraout_ECX;
    do {
      if (*pbVar6 == 0) break;
      piVar3 = (int *)FUN_10018890(this,param_1,pbVar6);
      if (piVar3 != (int *)0x0) {
        _sprintf((char *)local_20,"OPID%d",iVar5);
        FUN_10002310(param_5,(int)param_6,local_20,*piVar3);
        _sprintf((char *)local_20,"OPPO%d",iVar5);
        FUN_10002620(param_5,(int)param_6,local_20,(byte *)(piVar3 + 8));
        _sprintf((char *)local_20,"ADDR%d",iVar5);
        FUN_10002490(param_5,(int)param_6,local_20,*(uint *)(pbVar6 + 0x1c));
        _sprintf((char *)local_20,"LADDR%d",iVar5);
        FUN_10002490(param_5,(int)param_6,local_20,piVar3[0x102]);
        _sprintf((char *)local_20,"MADDR%d",iVar5);
        FUN_10002620(param_5,(int)param_6,local_20,(byte *)(piVar3 + 0xf6));
        _sprintf((char *)local_20,"OPPART%d",iVar5);
        FUN_10002310(param_5,(int)param_6,local_20,*(int *)(pbVar6 + 0x10));
        _sprintf((char *)local_20,"OPFLAG%d",iVar5);
        FUN_10002310(param_5,(int)param_6,local_20,*(int *)(pbVar6 + 0x18));
        iVar5 = iVar5 + 1;
      }
      this = *(void **)(param_3 + 0x9c);
      local_24 = local_24 + 1;
      pbVar6 = pbVar6 + 0x68;
    } while (local_24 < (int)this);
  }
  iVar5 = 0;
  if (0 < *(int *)(param_3 + 0x154)) {
    param_3 = param_3 + 0x168;
    do {
      _sprintf((char *)local_20,"PARTSIZE%d",iVar5);
      FUN_10002310(param_5,(int)param_6,local_20,*(int *)param_3);
      iVar5 = iVar5 + 1;
      param_3 = param_3 + 0x28;
    } while (iVar5 < *(int *)(pbVar4 + 0x154));
  }
  if ((param_7 == (undefined *)0x0) ||
     (cVar1 = (*(code *)param_7)(param_8,param_5,param_6,pbVar4,param_4), cVar1 == '\0')) {
    FUN_10002620(param_5,(int)param_6,(byte *)"PARAMS",pbVar4 + 0xc4);
    iVar5 = 0;
    if (0 < *(int *)(pbVar4 + 0x154)) {
      param_3 = pbVar4 + 0x16c;
      do {
        if ((param_9 == '\0') && (local_28 != iVar5)) {
          if (*(int *)(pbVar4 + 0x90) < 0) {
            pbVar6 = &DAT_10039247;
          }
          else {
            pbVar6 = pbVar4 + *(int *)(pbVar4 + 0x90) * 0x68 + 0x1b8;
          }
          iVar2 = FUN_10019c70((char *)pbVar6,(char *)(param_4 + 0x20));
          if (iVar2 == 0) goto LAB_1001d9be;
        }
        else {
LAB_1001d9be:
          _sprintf((char *)local_20,"PARTPARAMS%d",iVar5);
          FUN_10002620(param_5,(int)param_6,local_20,param_3);
        }
        iVar5 = iVar5 + 1;
        param_3 = param_3 + 0x28;
      } while (iVar5 < *(int *)(pbVar4 + 0x154));
    }
    iVar5 = 0;
    pbVar4 = pbVar4 + 0x1c8;
    do {
      if (pbVar4[-0x10] == 0) {
        return;
      }
      if ((param_9 != '\0') || (*(int *)pbVar4 == local_28)) {
        _sprintf((char *)local_20,"OPPARAM%d",iVar5);
        FUN_10002620(param_5,(int)param_6,local_20,pbVar4 + 0x10);
      }
      iVar5 = iVar5 + 1;
      pbVar4 = pbVar4 + 0x68;
    } while (iVar5 < 8);
  }
  return;
}



void __cdecl FUN_1001da50(byte *param_1,int param_2,uint *param_3)

{
  uint *puVar1;
  int iVar2;
  byte local_20 [32];
  
  if (DAT_10052b88 == '\0') {
    FUN_1001d640();
  }
  FUN_10002880(param_1,param_2,&DAT_1003a714,param_3,0x4f8,(byte *)&DAT_10052b88);
  iVar2 = 0;
  if (0 < (int)param_3[0x55]) {
    puVar1 = param_3 + 0x5a;
    do {
      _sprintf((char *)local_20,"PT%d",iVar2);
      FUN_10002880(param_1,param_2,local_20,puVar1,0x28,&DAT_10052c88);
      iVar2 = iVar2 + 1;
      puVar1 = puVar1 + 10;
    } while (iVar2 < (int)param_3[0x55]);
  }
  iVar2 = 0;
  if (0 < (int)param_3[0x27]) {
    puVar1 = param_3 + 0x6e;
    do {
      _sprintf((char *)local_20,"PL%d",iVar2);
      FUN_10002880(param_1,param_2,local_20,puVar1,0x68,&DAT_10052c08);
      iVar2 = iVar2 + 1;
      puVar1 = puVar1 + 0x1a;
    } while (iVar2 < (int)param_3[0x27]);
  }
  return;
}



void __cdecl FUN_1001db40(byte *param_1,uint *param_2)

{
  byte *pbVar1;
  uint *puVar2;
  uint *puVar3;
  int iVar4;
  int iVar5;
  byte *pbVar6;
  byte local_20 [32];
  
  if (DAT_10052b88 == '\0') {
    FUN_1001d640();
  }
  pbVar6 = (byte *)&DAT_10052b88;
  iVar4 = 0x4f8;
  puVar2 = param_2;
  pbVar1 = FUN_10002000(param_1,&DAT_1003a714);
  FUN_10003360(pbVar1,puVar2,iVar4,pbVar6);
  iVar4 = 0;
  if (0 < (int)param_2[0x55]) {
    puVar2 = param_2 + 0x5a;
    do {
      _sprintf((char *)local_20,"PT%d",iVar4);
      pbVar6 = &DAT_10052c88;
      iVar5 = 0x28;
      puVar3 = puVar2;
      pbVar1 = FUN_10002000(param_1,local_20);
      FUN_10003360(pbVar1,puVar3,iVar5,pbVar6);
      iVar4 = iVar4 + 1;
      puVar2 = puVar2 + 10;
    } while (iVar4 < (int)param_2[0x55]);
  }
  iVar4 = 0;
  if (0 < (int)param_2[0x27]) {
    puVar2 = param_2 + 0x6e;
    do {
      _sprintf((char *)local_20,"PL%d",iVar4);
      pbVar6 = &DAT_10052c08;
      iVar5 = 0x68;
      puVar3 = puVar2;
      pbVar1 = FUN_10002000(param_1,local_20);
      FUN_10003360(pbVar1,puVar3,iVar5,pbVar6);
      iVar4 = iVar4 + 1;
      puVar2 = puVar2 + 0x1a;
    } while (iVar4 < (int)param_2[0x27]);
  }
  return;
}



void __cdecl
FUN_1001dc30(undefined4 param_1,int param_2,undefined1 *param_3,int param_4,int param_5)

{
  undefined1 *puVar1;
  uint local_154 [21];
  char local_100 [256];
  
  if (*(int *)(param_2 + 0x90) < 0) {
    puVar1 = &DAT_10039247;
  }
  else {
    puVar1 = (undefined1 *)(*(int *)(param_2 + 0x90) * 0x68 + 0x1b8 + param_2);
  }
  __snprintf(local_100,0x100,(char *)(param_2 + 0xa0),puVar1,param_5 + 0x20,
             *(undefined4 *)(param_2 + 0x148));
  FUN_10012e70(local_154);
  FUN_10012ea0(local_154,local_100,-1);
  FUN_10012f00(local_154,param_3,param_4);
  return;
}



void __cdecl FUN_1001dcc0(undefined4 param_1)

{
  FUN_10019ad0(param_1,0x4f8);
  return;
}



void __cdecl FUN_1001dce0(int param_1,int param_2)

{
  if (param_2 != 0) {
    if (*(void **)(param_2 + 0x158) != (void *)0x0) {
      _free(*(void **)(param_2 + 0x158));
    }
    FUN_10019b00(param_1,param_2);
  }
  return;
}



int __cdecl FUN_1001dd10(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  bool bVar5;
  
  iVar4 = 0;
  iVar3 = *(int *)(param_1 + 400) + -1;
  if (-1 < iVar3) {
    do {
      iVar2 = (iVar3 + iVar4) / 2;
      iVar1 = *(int *)(param_1 + iVar2 * 4);
      if (iVar1 == param_2) {
        return iVar2;
      }
      bVar5 = iVar1 - param_2 < 0;
      if (iVar1 == param_2 || bVar5) {
        if (bVar5) {
          iVar4 = iVar2 + 1;
        }
      }
      else {
        iVar3 = iVar2 + -1;
      }
    } while (iVar4 <= iVar3);
  }
  return -1;
}



void __cdecl
FUN_1001ddf0(int param_1,undefined4 param_2,byte *param_3,byte *param_4,uint *param_5,int param_6,
            undefined *param_7,undefined4 param_8)

{
  byte local_24 [36];
  
  FUN_1001d690(param_1,param_2,(byte *)param_5,param_6,param_3,param_4,param_7,param_8,'\x01');
  FUN_10002310(param_3,(int)param_4,&DAT_1003a6cc,(param_5[0x52] ^ *param_5) & 0xffffff);
  FUN_10002620(param_3,(int)param_4,&DAT_1003d4c0,(byte *)(param_6 + 0x20));
  if ((param_5[1] & 0x40000) != 0) {
    FUN_1001dc30(param_1,(int)param_5,local_24,0x21,param_6);
    FUN_10002620(param_3,(int)param_4,&DAT_1003d4b8,local_24);
  }
  return;
}



void __cdecl FUN_1001de90(void *param_1)

{
  int iVar1;
  void *_Memory;
  int iVar2;
  int iVar3;
  int local_4;
  
  _Memory = param_1;
  local_4 = 0;
  if (*(int *)((int)param_1 + 0x10) != 0) {
    param_1 = (void *)0x0;
    do {
      iVar1 = *(int *)((int)_Memory + 0xc);
      iVar3 = 0;
      if (*(int *)(iVar1 + 0x28 + (int)param_1) != 0) {
        iVar2 = 0;
        do {
          _free(*(void **)(*(int *)((int)param_1 + iVar1 + 0x24) + iVar2 + 0x24));
          iVar3 = iVar3 + 1;
          iVar2 = iVar2 + 0x30;
        } while (iVar3 != *(int *)((int)param_1 + iVar1 + 0x28));
      }
      _free(*(void **)((int)param_1 + iVar1 + 0x24));
      local_4 = local_4 + 1;
      param_1 = (void *)((int)param_1 + 0x30);
    } while (local_4 != *(int *)((int)_Memory + 0x10));
  }
  _free(*(void **)((int)_Memory + 0xc));
  _free(_Memory);
  return;
}



undefined4 * __cdecl FUN_1001df20(undefined4 *param_1)

{
  int iVar1;
  ulonglong uVar2;
  uint in_EAX;
  uint uVar3;
  uint uVar4;
  int *piVar5;
  int iVar6;
  uint uVar7;
  
  uVar3 = in_EAX / 0x15180;
  uVar2 = ((ulonglong)in_EAX % 0x15180) / 0x3c;
  *param_1 = (int)(((ulonglong)in_EAX % 0x15180) % 0x3c);
  param_1[1] = (int)(uVar2 % 0x3c);
  param_1[2] = (int)(uVar2 / 0x3c);
  uVar7 = 0x7b2;
  while( true ) {
    if (((uVar7 & 3) == 0) && (((int)uVar7 % 100 != 0 || ((int)uVar7 % 400 == 0)))) {
      uVar4 = 0x16e;
    }
    else {
      uVar4 = 0x16d;
    }
    if ((int)uVar3 < (int)uVar4) break;
    uVar4 = (int)uVar3 / 0x16e + uVar7;
    if (uVar4 == uVar7) {
      uVar4 = uVar4 + 1;
    }
    iVar6 = uVar7 - 1;
    iVar1 = uVar4 - 1;
    uVar3 = uVar3 + ((((((uVar7 - uVar4) * 0x16d + iVar6 / 400) - iVar1 / 400) - iVar6 / 100) +
                      iVar1 / 100 + ((int)(iVar6 + (iVar6 >> 0x1f & 3U)) >> 2)) -
                    ((int)(iVar1 + (iVar1 >> 0x1f & 3U)) >> 2));
    uVar7 = uVar4;
  }
  piVar5 = &DAT_1003d548 + (uVar4 & 1) * 0xc;
  param_1[5] = uVar7 - 0x76c;
  param_1[7] = uVar3;
  param_1[4] = 0;
  iVar6 = *piVar5;
  if (iVar6 <= (int)uVar3) {
    do {
      uVar3 = uVar3 - iVar6;
      piVar5 = piVar5 + 1;
      param_1[4] = param_1[4] + 1;
      iVar6 = *piVar5;
    } while (iVar6 <= (int)uVar3);
  }
  param_1[8] = 0;
  param_1[3] = uVar3 + 1;
  return param_1;
}



undefined4 __fastcall FUN_1001e070(undefined4 param_1,int param_2)

{
  char cVar1;
  int in_EAX;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar3 = 0;
  iVar2 = in_EAX + -1;
  do {
    if (iVar2 < 0x10) {
      return 0;
    }
    cVar1 = *(char *)(iVar2 + param_2);
    if (((cVar1 == '>') && (*(char *)(iVar2 + -1 + param_2) == '/')) ||
       ((cVar1 == '/' && (*(char *)(iVar2 + -1 + param_2) == '<')))) {
      iVar3 = iVar3 + 1;
      iVar2 = iVar2 + -1;
    }
    else if ((cVar1 == '<') && (iVar4 = iVar4 + 1, iVar3 < iVar4)) {
      return 1;
    }
    iVar2 = iVar2 + -1;
  } while( true );
}



undefined4 __fastcall FUN_1001e0c0(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = param_1 + -1;
  if ((0 < param_1) && (*(char *)(iVar1 + param_2) == '>')) {
    for (; (0xf < iVar1 &&
           ((*(char *)(iVar1 + param_2) != '>' || (*(char *)(iVar1 + -1 + param_2) != '/'))));
        iVar1 = iVar1 + -1) {
      if (*(char *)(iVar1 + param_2) == '<') {
        return 1;
      }
    }
  }
  return 0;
}



undefined4 __fastcall FUN_1001e100(int param_1,uint param_2,uint param_3)

{
  int in_EAX;
  uint uVar1;
  int unaff_EDI;
  
  if (unaff_EDI < 0) {
    *(undefined1 *)(in_EAX + -1 + param_2) = 0;
    *(char *)(in_EAX + 1) = "0123456789abcdef"[(int)param_2 >> 0xc & 0xf];
    *(char *)(in_EAX + 2) = "0123456789abcdef"[(int)param_2 >> 8 & 0xf];
    *(char *)(in_EAX + 3) = "0123456789abcdef"[(int)param_2 >> 4 & 0xf];
    *(char *)(in_EAX + 4) = "0123456789abcdef"[param_2 & 0xf];
    return 0xffffffff;
  }
  uVar1 = param_1 + unaff_EDI;
  *(char *)(in_EAX + 1) = "0123456789abcdef"[(int)uVar1 >> 0xc & 0xf];
  *(char *)(in_EAX + 2) = "0123456789abcdef"[(int)uVar1 >> 8 & 0xf];
  *(char *)(in_EAX + 3) = "0123456789abcdef"[(int)uVar1 >> 4 & 0xf];
  *(char *)(in_EAX + 4) = "0123456789abcdef"[uVar1 & 0xf];
  *(char *)(in_EAX + 9) = "0123456789abcdef"[(int)param_3 >> 4 & 0xf];
  *(char *)(in_EAX + 10) = "0123456789abcdef"[param_3 & 0xf];
  return 0;
}



int __fastcall FUN_1001e1c0(int param_1,int param_2,int param_3,byte param_4)

{
  int in_EAX;
  int iVar1;
  size_t _Count;
  
  iVar1 = 0;
  if ((param_4 & 1) == 0) {
    return iVar1;
  }
  _Count = param_1 - param_2;
  if (in_EAX == 0) {
    if (0 < (int)_Count) {
      iVar1 = __snprintf((char *)(param_3 + param_2),_Count,"\n");
      return iVar1;
    }
  }
  else if (in_EAX * 2 + 1 < (int)_Count) {
    iVar1 = __snprintf((char *)(param_3 + param_2),_Count,"\n%*c",in_EAX * 2,0x20);
  }
  return iVar1;
}



undefined4 __cdecl FUN_1001e220(char *param_1,char *param_2)

{
  char cVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  byte bVar6;
  char *pcVar7;
  int iVar8;
  char *pcVar9;
  uint uVar10;
  uint uVar11;
  
  pcVar7 = param_1;
  if ((((*param_1 != '<') || (param_1[0xd] != ' ')) || (param_1[0xe] != '/')) ||
     (param_1[0xf] != '>')) {
    return 0xfffffffe;
  }
  bVar2 = "0123456789abcdef"[param_1[5] + 0x10];
  uVar11 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
  bVar3 = "0123456789abcdef"[param_1[6] + 0x10];
  bVar4 = "0123456789abcdef"[param_1[7] + 0x10];
  bVar5 = "0123456789abcdef"[param_1[8] + 0x10];
  uVar10 = (uint)(byte)"0123456789abcdef"[param_1[9] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[10] + 0x10];
  bVar6 = "0123456789abcdef"[param_1[0xc] + 0x10];
  iVar8 = FUN_1001e070((int)param_1[0xc],(int)param_1);
  if (iVar8 == 0) {
    return 0xfffffffd;
  }
  param_1 = (char *)0x0;
  if (*param_2 == '<') {
    param_1 = (char *)0x0;
    if ((bVar6 & 1) != 0) {
      param_1 = (char *)(uVar10 * 2 + 1);
    }
  }
  else {
    pcVar9 = _strchr(param_2,0x22);
    if (pcVar9 != (char *)0x0) {
      iVar8 = FUN_1001e0c0(uVar11,(int)pcVar7);
      if (iVar8 == 0) {
        return 0xfffffffc;
      }
      pcVar7[uVar11 - 1] = ' ';
    }
  }
  pcVar9 = param_2;
  do {
    cVar1 = *pcVar9;
    pcVar9 = pcVar9 + 1;
  } while (cVar1 != '\0');
  if ((int)(param_1 + ((int)pcVar9 - (int)(param_2 + 1))) <
      (int)(((((uint)bVar2 << 4 | (uint)bVar3) << 4 | (uint)bVar4) << 4 | (uint)bVar5) - uVar11)) {
    if ((*param_2 == '<') && ((bVar6 & 1) != 0)) {
      pcVar7[uVar11] = '\n';
      uVar11 = uVar11 + 1;
      for (; uVar10 != 0; uVar10 = uVar10 - 1) {
        pcVar7[uVar11] = ' ';
        pcVar7[uVar11 + 1] = ' ';
        uVar11 = uVar11 + 2;
      }
    }
    cVar1 = *param_2;
    while (cVar1 != '\0') {
      pcVar7[uVar11] = cVar1;
      pcVar9 = param_2 + 1;
      uVar11 = uVar11 + 1;
      param_2 = param_2 + 1;
      cVar1 = *pcVar9;
    }
    pcVar7[uVar11] = '\0';
    pcVar7[1] = "0123456789abcdef"[(int)uVar11 >> 0xc & 0xf];
    pcVar7[2] = "0123456789abcdef"[(int)uVar11 >> 8 & 0xf];
    pcVar7[3] = "0123456789abcdef"[(int)uVar11 >> 4 & 0xf];
    pcVar7[4] = "0123456789abcdef"[uVar11 & 0xf];
    return 0;
  }
  return 0xffffffff;
}



int __cdecl FUN_1001e410(byte *param_1,int param_2,byte *param_3)

{
  byte bVar1;
  int iVar2;
  
  iVar2 = param_2;
  if (1 < param_2) {
    do {
      bVar1 = *param_3;
      if (bVar1 == 0) break;
      if (((((char)bVar1 < ' ') || (bVar1 == 0x3d)) || (bVar1 == 0x3c)) ||
         (((bVar1 == 0x3e || (bVar1 == 0x26)) || ((bVar1 == 0x22 || ('~' < (char)bVar1)))))) {
        if (3 < iVar2) {
          *param_1 = 0x25;
          param_1[1] = "0123456789abcdef"[*param_3 >> 4];
          param_1[2] = "0123456789abcdef"[*param_3 & 0xf];
          param_1 = param_1 + 3;
          iVar2 = iVar2 + -3;
        }
      }
      else {
        *param_1 = bVar1;
        param_1 = param_1 + 1;
        iVar2 = iVar2 + -1;
      }
      param_3 = param_3 + 1;
    } while (1 < iVar2);
  }
  if (0 < iVar2) {
    *param_1 = 0;
  }
  return param_2 - iVar2;
}



void __cdecl FUN_1001e4a0(char *param_1,uint param_2,byte param_3)

{
  uint uVar1;
  char *pcVar2;
  
  pcVar2 = param_1;
  for (uVar1 = param_2 >> 2; uVar1 != 0; uVar1 = uVar1 - 1) {
    pcVar2[0] = '\0';
    pcVar2[1] = '\0';
    pcVar2[2] = '\0';
    pcVar2[3] = '\0';
    pcVar2 = pcVar2 + 4;
  }
  for (uVar1 = param_2 & 3; uVar1 != 0; uVar1 = uVar1 - 1) {
    *pcVar2 = '\0';
    pcVar2 = pcVar2 + 1;
  }
  if (0x10 < (int)param_2) {
    uVar1 = __snprintf(param_1,param_2 - 1,"<000000000000 />");
    param_1[1] = "0123456789abcdef"[(int)uVar1 >> 0xc & 0xf];
    param_1[2] = "0123456789abcdef"[(int)uVar1 >> 8 & 0xf];
    param_1[3] = "0123456789abcdef"[(int)uVar1 >> 4 & 0xf];
    param_1[4] = "0123456789abcdef"[uVar1 & 0xf];
    param_1[5] = "0123456789abcdef"[(int)param_2 >> 0xc & 0xf];
    param_1[6] = "0123456789abcdef"[(int)param_2 >> 8 & 0xf];
    param_1[7] = "0123456789abcdef"[(int)param_2 >> 4 & 0xf];
    param_1[8] = "0123456789abcdef"[param_2 & 0xf];
    param_1[0xb] = "0123456789abcdef"[(int)(uint)param_3 >> 4];
    param_1[0xc] = "0123456789abcdef"[param_3 & 0xf];
  }
  return;
}



undefined4 __cdecl FUN_1001e580(char *param_1,undefined4 param_2)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  
  if ((((*param_1 == '<') && (param_1[0xd] == ' ')) && (param_1[0xe] == '/')) &&
     (param_1[0xf] == '>')) {
    uVar6 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
    bVar1 = "0123456789abcdef"[param_1[9] + 0x10];
    uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
    bVar2 = "0123456789abcdef"[param_1[10] + 0x10];
    iVar3 = FUN_1001e1c0(uVar7,uVar6,(int)param_1,
                         "0123456789abcdef"[param_1[0xb] + 0x10] << 4 |
                         "0123456789abcdef"[param_1[0xc] + 0x10]);
    if (uVar7 <= uVar6) {
      return 0xffffffff;
    }
    iVar4 = __snprintf(param_1 + iVar3 + uVar6,(uVar7 - iVar3) - uVar6,"<%s>",param_2);
    param_1[iVar3 + iVar4 + uVar6] = '\0';
    uVar5 = FUN_1001e100(uVar6,uVar7,((uint)bVar1 << 4 | (uint)bVar2) + 1);
    return uVar5;
  }
  return 0xfffffffe;
}



undefined4 __cdecl FUN_1001e6c0(char *param_1)

{
  char cVar1;
  char cVar2;
  byte bVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  size_t _Count;
  int iVar10;
  int local_94;
  char local_84 [132];
  
  local_94 = 0;
  if ((((*param_1 != '<') || (param_1[0xd] != ' ')) || (param_1[0xe] != '/')) ||
     (param_1[0xf] != '>')) {
    return 0xfffffffe;
  }
  uVar8 = (((uint)(byte)"0123456789abcdef"[param_1[2] + 0x10] |
           (uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
  cVar2 = "0123456789abcdef"[param_1[0xb] + 0x10];
  uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
  bVar3 = "0123456789abcdef"[param_1[0xc] + 0x10];
  uVar6 = ((uint)(byte)"0123456789abcdef"[param_1[9] + 0x10] << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[10] + 0x10]) - 1;
  iVar4 = uVar8 - 1;
  if (0xf < iVar4) {
    iVar9 = 0;
    do {
      cVar1 = param_1[iVar4];
      if (((cVar1 == '>') && (param_1[iVar4 + -1] == '/')) ||
         ((cVar1 == '/' && (param_1[iVar4 + -1] == '<')))) {
        iVar9 = iVar9 + 1;
        iVar4 = iVar4 + -1;
      }
      else if ((cVar1 == '<') && (local_94 = local_94 + 1, iVar9 < local_94)) {
        _Count = uVar7 - uVar8;
        if ((int)_Count < 3) {
          return 0xffffffff;
        }
        if ((iVar9 == 0) && (param_1[uVar8 - 1] == '>')) {
          (param_1 + uVar8)[-1] = ' ';
          __snprintf(param_1 + uVar8,_Count,"/>");
          uVar5 = FUN_1001e100(uVar8,uVar7,uVar6);
          return uVar5;
        }
        local_84[0] = '<';
        local_84[1] = 0x2f;
        local_84[2] = 0x30;
        iVar9 = 2;
        goto LAB_1001e873;
      }
      iVar4 = iVar4 + -1;
    } while (0xf < iVar4);
  }
  return 0;
  while (iVar4 = iVar4 + 1, iVar9 = iVar10 + 1, iVar10 + 1 < 0x7f) {
LAB_1001e873:
    iVar10 = iVar9;
    local_84[iVar10] = param_1[iVar4 + 1];
    if ((((int)uVar7 <= iVar4 + 1) || (param_1[iVar4 + 2] == ' ')) || (param_1[iVar4 + 2] == '>'))
    break;
  }
  local_84[iVar10 + 1] = '>';
  local_84[iVar10 + 2] = '\0';
  iVar4 = FUN_1001e1c0(uVar7,uVar8,(int)param_1,cVar2 << 4 | bVar3);
  if ((int)_Count < iVar10 + 2 + iVar4) {
    return 0xffffffff;
  }
  __snprintf(param_1 + iVar4 + uVar8,(uVar7 - iVar4) - uVar8,"%s",local_84);
  uVar5 = FUN_1001e100(uVar8,uVar7,uVar6);
  return uVar5;
}



undefined4 __cdecl FUN_1001e910(char *param_1,undefined4 param_2,byte *param_3)

{
  byte bVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int extraout_EDX;
  uint uVar6;
  uint uVar7;
  
  if ((((*param_1 != '<') || (param_1[0xd] != ' ')) || (param_1[0xe] != '/')) ||
     (param_1[0xf] != '>')) {
    return 0xfffffffe;
  }
  uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
  bVar1 = "0123456789abcdef"[param_1[9] + 0x10];
  uVar6 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
           (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
          (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
  bVar2 = "0123456789abcdef"[param_1[10] + 0x10];
  iVar3 = FUN_1001e070((uint)bVar2,(int)param_1);
  if (iVar3 == 0) {
    return 0xfffffffd;
  }
  iVar3 = FUN_1001e0c0(uVar7,extraout_EDX);
  if (iVar3 != 0) {
    iVar3 = __snprintf(param_1 + uVar7,uVar6 - uVar7,"%s=\"",param_2);
    if (-1 < iVar3) {
      iVar3 = uVar7 + iVar3;
      iVar4 = FUN_1001e410((byte *)(param_1 + iVar3),uVar6 - iVar3,param_3);
      if ((-1 < iVar4) && (iVar3 = iVar3 + iVar4, iVar3 + 3 <= (int)uVar6)) {
        (param_1 + uVar7)[-1] = ' ';
        param_1[iVar3] = '\"';
        param_1[iVar3 + 1] = '>';
        param_1[iVar3 + 2] = '\0';
        uVar5 = FUN_1001e100(uVar7,uVar6,(uint)bVar1 << 4 | (uint)bVar2);
        return uVar5;
      }
    }
    return 0xffffffff;
  }
  return 0xfffffffc;
}



undefined4 __cdecl FUN_1001ea90(char *param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 local_124 [9];
  char local_100 [256];
  
  puVar1 = FUN_1001df20(local_124);
  if (puVar1 == (undefined4 *)0x0) {
    return 0xfffffffb;
  }
  __snprintf(local_100,0x100,"%s=\"%04d-%02d-%02dT%02d:%02d:%02dZ\">",param_2,puVar1[5] + 0x76c,
             puVar1[4] + 1,puVar1[3],puVar1[2],puVar1[1],*puVar1);
  uVar2 = FUN_1001e220(param_1,local_100);
  return uVar2;
}



undefined4 __cdecl FUN_1001eb20(char *param_1,byte *param_2)

{
  byte bVar1;
  byte bVar2;
  char cVar3;
  byte bVar4;
  int iVar5;
  undefined4 uVar6;
  uint uVar7;
  uint uVar8;
  
  if ((((*param_1 == '<') && (param_1[0xd] == ' ')) && (param_1[0xe] == '/')) &&
     (param_1[0xf] == '>')) {
    uVar7 = (((uint)(byte)"0123456789abcdef"[param_1[1] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[2] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[3] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[4] + 0x10];
    bVar1 = "0123456789abcdef"[param_1[9] + 0x10];
    uVar8 = (((uint)(byte)"0123456789abcdef"[param_1[5] + 0x10] << 4 |
             (uint)(byte)"0123456789abcdef"[param_1[6] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[7] + 0x10]) << 4 |
            (uint)(byte)"0123456789abcdef"[param_1[8] + 0x10];
    bVar2 = "0123456789abcdef"[param_1[10] + 0x10];
    cVar3 = "0123456789abcdef"[param_1[0xb] + 0x10];
    bVar4 = "0123456789abcdef"[param_1[0xc] + 0x10];
    iVar5 = FUN_1001e070((int)param_1[0xc],(int)param_1);
    if (iVar5 == 0) {
      return 0xfffffffd;
    }
    iVar5 = FUN_1001e1c0(uVar8,uVar7,(int)param_1,cVar3 << 4 | bVar4);
    if (-1 < iVar5) {
      iVar5 = FUN_1001e410((byte *)(param_1 + uVar7 + iVar5),uVar8 - (uVar7 + iVar5),param_2);
      if (-1 < iVar5) {
        uVar6 = FUN_1001e100(uVar7,uVar8,(uint)bVar1 << 4 | (uint)bVar2);
        return uVar6;
      }
    }
    return 0xffffffff;
  }
  return 0xfffffffe;
}



char * __cdecl FUN_1001ec70(char *param_1,uint param_2,char *param_3,int param_4)

{
  undefined4 *puVar1;
  int *piVar2;
  byte bVar3;
  char cVar4;
  int iVar5;
  uint uVar6;
  char *pcVar7;
  int iVar8;
  int iVar9;
  char *pcVar10;
  char *pcVar11;
  char local_380 [96];
  char local_320 [32];
  char local_300 [256];
  char local_200 [256];
  char local_100 [256];
  
  cVar4 = *param_3;
  if (cVar4 == ' ') {
    param_3 = param_3 + 1;
  }
  if (-1 < (int)param_2) {
    FUN_1001e4a0(param_1,param_2,cVar4 == ' ');
  }
  if (*param_3 != '\0') {
    iVar9 = param_4 + -4;
    pcVar11 = param_3 + 4;
    pcVar10 = local_380 + (1 - (int)param_3);
    do {
      if (pcVar11[-4] == '<') {
        iVar5 = 0;
        pcVar7 = pcVar11 + -3;
        do {
          cVar4 = *pcVar7;
          if (((cVar4 < '\x01') || ('~' < cVar4)) ||
             (s___0123456789_ABCDEFGHIJKLMNOPQRS_100411e8[cVar4] < '!')) break;
          local_380[iVar5] = cVar4;
          cVar4 = pcVar11[iVar5 + -2];
          if (((cVar4 < '\x01') || ('~' < cVar4)) ||
             (s___0123456789_ABCDEFGHIJKLMNOPQRS_100411e8[cVar4] < '!')) {
            iVar5 = iVar5 + 1;
            break;
          }
          pcVar7[(int)(pcVar10 + -1)] = cVar4;
          cVar4 = pcVar11[iVar5 + -1];
          if (((cVar4 < '\x01') || ('~' < cVar4)) ||
             (s___0123456789_ABCDEFGHIJKLMNOPQRS_100411e8[cVar4] < '!')) {
            iVar5 = iVar5 + 2;
            break;
          }
          pcVar7[(int)pcVar10] = cVar4;
          cVar4 = pcVar11[iVar5];
          if (((cVar4 < '\x01') || ('~' < cVar4)) ||
             (s___0123456789_ABCDEFGHIJKLMNOPQRS_100411e8[cVar4] < '!')) {
            iVar5 = iVar5 + 3;
            break;
          }
          pcVar7[(int)(pcVar10 + 1)] = cVar4;
          iVar5 = iVar5 + 4;
          pcVar7 = pcVar7 + 4;
        } while (iVar5 < 0x40);
        local_380[iVar5] = '\0';
        if (0 < iVar5) {
          FUN_1001e580(param_1,local_380);
        }
      }
      cVar4 = pcVar11[-4];
      pcVar7 = pcVar11 + -4;
      if (cVar4 == '=') {
        if (pcVar11 + -4 != param_3) {
          while( true ) {
            bVar3 = pcVar7[-1];
            if (((char)bVar3 < '\x01') || ('~' < (char)bVar3)) break;
            if ((s___0123456789_ABCDEFGHIJKLMNOPQRS_100411e8[bVar3 & 0x7f] < '!') ||
               (pcVar7 = pcVar7 + -1, pcVar7 == param_3)) break;
          }
        }
        iVar8 = 0;
        iVar5 = -(int)pcVar7;
        do {
          if (pcVar7 == pcVar11 + -4) break;
          iVar8 = iVar8 + 1;
          pcVar7[(int)(local_380 + iVar5)] = *pcVar7;
          pcVar7 = pcVar7 + 1;
        } while (iVar8 < 0x40);
        local_380[iVar8] = '\0';
      }
      uVar6 = (((int)cVar4 | 0x2000U) << 8 | (int)pcVar11[-3]) << 8 | (int)pcVar11[-2];
      if ((cVar4 == '/') && (pcVar11[-3] == '>')) {
        FUN_1001e6c0(param_1);
      }
      else if (uVar6 == 0x203e2573) {
        puVar1 = (undefined4 *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        FUN_1001eb20(param_1,(byte *)*puVar1);
      }
      else if (uVar6 == 0x203e2564) {
        puVar1 = (undefined4 *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        __snprintf(local_300,0x100,"%d",*puVar1);
        FUN_1001e220(param_1,local_300);
      }
      else if (uVar6 == 0x203e2565) {
        iVar5 = *(int *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        if (iVar5 == 0) {
          iVar5 = FID_conflict___time32((__time32_t *)0x0);
        }
        __snprintf(local_200,0x100,"%d",iVar5);
        FUN_1001e220(param_1,local_200);
      }
      else if (uVar6 == 0x203e2561) {
        uVar6 = *(uint *)(iVar9 + 4);
        iVar9 = iVar9 + 4;
        __snprintf(local_320,0x20,"%d.%d.%d.%d",uVar6 >> 0x18,uVar6 >> 0x10 & 0xff,uVar6 >> 8 & 0xff
                   ,uVar6 & 0xff);
        FUN_1001e220(param_1,local_320);
      }
      else if (local_380[0] != '\0') {
        if (uVar6 == 0x203d2573) {
          puVar1 = (undefined4 *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          FUN_1001e910(param_1,local_380,(byte *)*puVar1);
        }
        else if (uVar6 == 0x203d2564) {
          puVar1 = (undefined4 *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          __snprintf(local_100,0x100,"%s=\"%d\">",local_380,*puVar1);
          FUN_1001e220(param_1,local_100);
        }
        else if (uVar6 == 0x203d2565) {
          piVar2 = (int *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          if (*piVar2 == 0) {
            FID_conflict___time32((__time32_t *)0x0);
          }
          FUN_1001ea90(param_1,local_380);
        }
        else if (uVar6 == 0x203d2561) {
          uVar6 = *(uint *)(iVar9 + 4);
          iVar9 = iVar9 + 4;
          __snprintf(local_380 + 0x40,0x20,"%s=\"%d.%d.%d.%d\">",local_380,uVar6 >> 0x18,
                     uVar6 >> 0x10 & 0xff,uVar6 >> 8 & 0xff,uVar6 & 0xff);
          FUN_1001e220(param_1,local_380 + 0x40);
        }
      }
      pcVar7 = pcVar11 + -3;
      pcVar10 = pcVar10 + -1;
      pcVar11 = pcVar11 + 1;
    } while (*pcVar7 != '\0');
  }
  if ((((-1 < (int)param_2) && (*param_1 == '<')) && (param_1[0xd] == ' ')) &&
     ((param_1[0xe] == '/' && (param_1[0xf] == '>')))) {
    builtin_strncpy(param_1,"                ",0x10);
    param_1 = param_1 + 0x10;
  }
  return param_1;
}



void __cdecl FUN_1001f0b0(char *param_1,uint param_2,char *param_3)

{
  FUN_1001ec70(param_1,param_2,param_3,(int)&stack0x00000010);
  return;
}



undefined4 __thiscall FUN_1001f0d0(void *this,int param_1,byte *param_2,int param_3,int *param_4)

{
  int iVar1;
  int iVar2;
  
  if (*param_2 == 0) {
    return 0x6d697373;
  }
  iVar1 = FUN_10018890(this,param_1,param_2);
  if (iVar1 == 0) {
    return 0x6e737276;
  }
  iVar2 = FUN_10011c20(iVar1);
  if (*(int *)(iVar2 + 0x18) == 0) {
    return 0x6e737276;
  }
  FUN_10011c30(iVar1,param_3);
  *param_4 = iVar2;
  return 0;
}



void __cdecl FUN_1001f130(int *param_1,byte *param_2,int param_3,undefined4 param_4)

{
  byte *pbVar1;
  char *pcVar2;
  byte *pbVar3;
  undefined4 uVar4;
  byte *pbVar5;
  void *this;
  int iVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  byte *pbVar10;
  char *pcVar11;
  uint uVar12;
  int iVar13;
  byte local_1a0 [32];
  byte local_180 [64];
  byte local_140 [64];
  byte local_100 [256];
  
  pbVar10 = &DAT_10039247;
  iVar8 = 0x20;
  pbVar3 = local_1a0;
  pbVar1 = FUN_10002000(param_2,&DAT_1003a67c);
  FUN_100030f0(pbVar1,pbVar3,iVar8,pbVar10);
  pcVar2 = (char *)FUN_10018890(local_1a0,(int)param_1,local_1a0);
  if (pcVar2 == (char *)0x0) {
    pcVar2 = FUN_10011960((char *)local_1a0,0x10);
    pcVar11 = pcVar2;
    pbVar3 = (byte *)FUN_100119e0(pcVar2);
    FUN_10018820(this,param_1,pbVar3,(int)pcVar11);
  }
  iVar8 = 0;
  pbVar3 = FUN_10002000(param_2,&DAT_10039210);
  iVar8 = FUN_10002e80(pbVar3,iVar8);
  uVar12 = 0;
  pbVar3 = FUN_10002000(param_2,&DAT_10039d3c);
  uVar12 = FUN_10002f10(pbVar3,uVar12);
  iVar13 = 0;
  pbVar3 = FUN_10002000(param_2,(byte *)"IDENT");
  iVar13 = FUN_10002e80(pbVar3,iVar13);
  if (iVar8 == 0) {
    iVar8 = FUN_10011c50((int)pcVar2,iVar13,uVar12);
    if (-1 < iVar8) {
      FUN_10011ca0((int)pcVar2,iVar8);
      return;
    }
  }
  else {
    pbVar10 = &DAT_10039247;
    iVar9 = 0x40;
    pbVar3 = local_140;
    pbVar1 = FUN_10002000(param_2,(byte *)"SECRET");
    FUN_100030f0(pbVar1,pbVar3,iVar9,pbVar10);
    pbVar10 = &DAT_10039247;
    iVar9 = 0x100;
    pbVar3 = local_100;
    pbVar1 = FUN_10002000(param_2,(byte *)"CUSTOM");
    FUN_100030f0(pbVar1,pbVar3,iVar9,pbVar10);
    pbVar10 = &DAT_10039247;
    iVar9 = 0x40;
    pbVar3 = local_180;
    pbVar1 = FUN_10002000(param_2,(byte *)"FORMAT");
    FUN_100030f0(pbVar1,pbVar3,iVar9,pbVar10);
    if (param_3 == 0) {
      uVar4 = 0x7f000000;
    }
    else {
      uVar4 = *(undefined4 *)(param_3 + 4);
    }
    pbVar3 = local_180;
    pbVar1 = local_100;
    pbVar10 = local_140;
    uVar7 = 0;
    pbVar5 = FUN_10002000(param_2,(byte *)"FLAGS");
    uVar7 = FUN_10002ed0((char *)pbVar5,uVar7);
    iVar9 = 0;
    pbVar5 = FUN_10002000(param_2,(byte *)"LIMIT");
    iVar9 = FUN_10002e80(pbVar5,iVar9);
    iVar6 = 0;
    pbVar5 = FUN_10002000(param_2,(byte *)"COUNT");
    iVar6 = FUN_10002e80(pbVar5,iVar6);
    FUN_100119f0((int)pcVar2,iVar13,uVar12,iVar8,iVar6,iVar9,uVar7,(char *)pbVar10,uVar4,param_4,
                 (char *)pbVar1,(char *)pbVar3);
  }
  return;
}



void __cdecl FUN_1001f330(int param_1,int param_2,uint param_3)

{
  int iVar1;
  
  FUN_10018a80(param_1);
  iVar1 = FUN_10018a90(param_1,(undefined4 *)0x0);
  while (iVar1 != 0) {
    FUN_10011ce0(iVar1,param_2,param_3);
    iVar1 = FUN_10018a90(param_1,(undefined4 *)0x0);
  }
  return;
}



void __thiscall FUN_1001f370(void *this,int param_1)

{
  int iVar1;
  int *piVar2;
  int *unaff_ESI;
  
  if (unaff_ESI != (int *)0x0) {
                    // WARNING: Load size is inaccurate
    iVar1 = 0;
    piVar2 = unaff_ESI + 0x115;
    while (*piVar2 != *this) {
      iVar1 = iVar1 + 1;
      piVar2 = piVar2 + 1;
      if (3 < iVar1) {
        return;
      }
    }
    _memmove(unaff_ESI + iVar1 + 0x115,unaff_ESI + iVar1 + 0x116,(3 - iVar1) * 4);
    unaff_ESI[0x118] = 0;
    unaff_ESI[1] = unaff_ESI[1] + 1;
    FUN_1001a010(*(int *)(param_1 + 0x1608),*unaff_ESI);
  }
  return;
}



undefined4 __cdecl FUN_1001f3e0(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  int iVar6;
  byte *pbVar7;
  uint uVar8;
  int local_e8 [8];
  int local_c8;
  byte local_c4 [16];
  byte local_b4 [68];
  byte local_70 [68];
  char local_2c [40];
  
  pbVar7 = &DAT_10039247;
  piVar3 = local_e8;
  for (iVar6 = 0x37; iVar6 != 0; iVar6 = iVar6 + -1) {
    *piVar3 = 0;
    piVar3 = piVar3 + 1;
  }
  iVar6 = 0x10;
  pbVar2 = local_c4;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar1,pbVar2,iVar6,pbVar7);
  iVar6 = -1;
  pbVar7 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a67c);
  local_e8[1] = FUN_10002e80(pbVar7,iVar6);
  iVar6 = -1;
  pbVar7 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a724);
  local_c8 = FUN_10002e80(pbVar7,iVar6);
  if (((local_c4[0] == 0) || (local_e8[1] == -1)) || (local_c8 == -1)) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if (local_c8 < 2) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x696e7670;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  uVar8 = 0;
  pbVar7 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"SYSFLAGS");
  local_e8[2] = FUN_10002ed0((char *)pbVar7,uVar8);
  iVar6 = 0;
  pbVar7 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CUSTFLAGS");
  local_e8[3] = FUN_10002e80(pbVar7,iVar6);
  pbVar1 = &DAT_10039247;
  iVar6 = 0x44;
  pbVar7 = local_b4;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a1b0);
  FUN_100030f0(pbVar2,pbVar7,iVar6,pbVar1);
  pbVar1 = &DAT_10039247;
  iVar6 = 0x44;
  pbVar7 = local_70;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"PARAMS");
  FUN_100030f0(pbVar2,pbVar7,iVar6,pbVar1);
  iVar6 = FUN_10018890(local_c4,*(int *)(param_1 + 0x1724),local_c4);
  if (iVar6 != 0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6475706c;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar6 = 0;
  pbVar7 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar6 = FUN_10002e80(pbVar7,iVar6);
  piVar3 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar6);
  if (piVar3 == (int *)0x0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar6 = 0;
  piVar4 = piVar3 + 0x115;
  do {
    if (*piVar4 == 0) break;
    iVar6 = iVar6 + 1;
    piVar4 = piVar4 + 1;
  } while (iVar6 < 4);
  if (iVar6 == 4) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e737063;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  local_e8[2] = local_e8[2] & 0xfff7ffff;
  piVar4 = FUN_1001d1c0(local_c8);
  piVar4[1] = local_e8[1];
  piVar4[2] = local_e8[2];
  _strncpy((char *)(piVar4 + 9),(char *)local_c4,0x10);
  _strncpy((char *)(piVar4 + 0xd),(char *)local_b4,0x44);
  _strncpy((char *)(piVar4 + 0x2f),local_2c,0x14);
  _strncpy((char *)(piVar4 + 0x1e),(char *)local_70,0x44);
  FUN_10018820(*(void **)(param_1 + 0x1724),(int *)*(void **)(param_1 + 0x1724),(byte *)(piVar4 + 9)
               ,(int)piVar4);
  iVar6 = FUN_10019f50(*(int **)(param_1 + 0x1728),0,piVar4);
  *piVar4 = iVar6;
  FUN_1001d270((int)piVar4,piVar3);
  _strncpy((char *)(piVar4 + 4),(char *)(piVar3 + 8),0x10);
  FUN_1001d2f0((int)piVar3,piVar4);
  FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar3);
  FUN_10002c50(*(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),(byte *)"IDENT=%d");
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  uVar5 = FUN_1000c9b0(param_2);
  return uVar5;
}



undefined4 __cdecl FUN_1001f730(int param_1,int param_2)

{
  bool bVar1;
  byte *pbVar2;
  void *this;
  byte *pbVar3;
  int *piVar4;
  undefined4 uVar5;
  void *this_00;
  int iVar6;
  byte *pbVar7;
  byte local_10 [16];
  
  pbVar7 = &DAT_10039247;
  iVar6 = 0x10;
  pbVar3 = local_10;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar7);
  this = (void *)FUN_10018890(this_00,*(int *)(param_1 + 0x1724),local_10);
  if (this == (void *)0x0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e666e64;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if ((*(uint *)((int)this + 8) & 0x80000) != 0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar6 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar6 = FUN_10002e80(pbVar3,iVar6);
  piVar4 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar6);
  if (piVar4 == (int *)0x0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar6 = FUN_10019c70((char *)((int)this + 0x10),(char *)(piVar4 + 8));
  if (iVar6 == 0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x696e6f70;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  bVar1 = FUN_1001d2b0((int)this,piVar4);
  if (!bVar1) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6a6f696e;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  FUN_1001f370(this,param_1);
  uVar5 = FUN_1000c9b0(param_2);
  return uVar5;
}



undefined4 __cdecl FUN_1001f8b0(int param_1,int param_2)

{
  bool bVar1;
  byte *pbVar2;
  int *this;
  byte *pbVar3;
  uint uVar4;
  int *piVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  void *this_00;
  void *this_01;
  int iVar8;
  byte *pbVar9;
  byte local_30 [16];
  byte local_20 [16];
  byte local_10 [16];
  
  pbVar9 = &DAT_10039247;
  iVar8 = 0x10;
  pbVar3 = local_10;
  bVar1 = false;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar2,pbVar3,iVar8,pbVar9);
  this = (int *)FUN_10018890(this_00,*(int *)(param_1 + 0x1724),local_10);
  if (this == (int *)0x0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e666e64;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if ((this[2] & 0x80000U) != 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar8 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar8 = FUN_10002e80(pbVar3,iVar8);
  iVar8 = FUN_1001a190(*(int *)(param_1 + 0x1608),iVar8);
  if (iVar8 == 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar8 = FUN_10019c70((char *)(this + 4),(char *)(iVar8 + 0x20));
  if (iVar8 != 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e6f776e;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  pbVar9 = &DAT_10039247;
  iVar8 = 0x10;
  pbVar3 = local_20;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"OWNER");
  FUN_100030f0(pbVar2,pbVar3,iVar8,pbVar9);
  if (local_20[0] != 0) {
    iVar8 = FUN_10018890(this_01,this[0x34],local_20);
    if (iVar8 == 0) {
      iVar8 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar8) {
        iVar8 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar8;
      *(undefined4 *)(param_2 + 0x4c) = 0x75757372;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    _strncpy((char *)(this + 4),(char *)(iVar8 + 0x20),0x10);
    bVar1 = true;
  }
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"SYSFLAGS");
  if (pbVar3 != (byte *)0x0) {
    uVar4 = FUN_10002ed0((char *)pbVar3,this[2]);
    this[2] = uVar4 & 0xfff7ffff;
    bVar1 = true;
  }
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CUSTFLAGS");
  if (pbVar3 != (byte *)0x0) {
    iVar8 = FUN_10002e80(pbVar3,this[3]);
    this[3] = iVar8;
    bVar1 = true;
  }
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a1b0);
  if (pbVar3 != (byte *)0x0) {
    FUN_100030f0(pbVar3,(byte *)(this + 0xd),0x44,(byte *)(this + 0xd));
    bVar1 = true;
  }
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a74c);
  if (pbVar3 != (byte *)0x0) {
    FUN_100030f0(pbVar3,(byte *)(this + 0x2f),0x14,(byte *)(this + 0x2f));
    bVar1 = true;
  }
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"PARAMS");
  if (pbVar3 != (byte *)0x0) {
    FUN_100030f0(pbVar3,(byte *)(this + 0x1e),0x44,(byte *)(this + 0x1e));
    bVar1 = true;
  }
  pbVar9 = &DAT_10039247;
  iVar8 = 0x10;
  pbVar3 = local_30;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a744);
  FUN_100030f0(pbVar2,pbVar3,iVar8,pbVar9);
  if (local_30[0] == 0) {
LAB_1001fbce:
    if (!bVar1) goto LAB_1001fbe9;
  }
  else {
    piVar5 = (int *)FUN_10018890(local_30,this[0x34],local_30);
    if (piVar5 == (int *)0x0) goto LAB_1001fbce;
    FUN_1001d2b0((int)this,piVar5);
    FUN_1001f370(this,param_1);
    if ((this[2] & 0x800U) != 0) {
      if (this[0x36] == 0) {
        puVar6 = FUN_1002c800(0x10,0);
        this[0x36] = (int)puVar6;
        FUN_1002c1c0((int)puVar6,FUN_10019c70);
      }
      FUN_1002c280(this[0x36],(char *)local_30,(char *)0xffffffff,(char *)0x0,0);
    }
  }
  FUN_1001a010(*(int *)(param_1 + 0x1728),*this);
LAB_1001fbe9:
  uVar7 = FUN_1000c9b0(param_2);
  return uVar7;
}



undefined4 __cdecl FUN_1001fc00(int param_1,byte *param_2)

{
  int *this;
  int *piVar1;
  undefined4 uVar2;
  
  this = (int *)FUN_100188e0(*(void **)(param_1 + 0x1724),(int *)*(void **)(param_1 + 0x1724),
                             param_2);
  if (this != (int *)0x0) {
    piVar1 = (int *)FUN_10018720((int *)this[0x34]);
    while (piVar1 != (int *)0x0) {
      FUN_1001f370(this,param_1);
      FUN_1001a0d0(this[0x35],*piVar1);
      piVar1 = (int *)FUN_10018720((int *)this[0x34]);
    }
    FUN_1001a0d0(*(int *)(param_1 + 0x1728),*this);
    uVar2 = FUN_1001d220(this);
    return CONCAT31((int3)((uint)uVar2 >> 8),1);
  }
  return 0;
}



void __cdecl FUN_1001fca0(int param_1,undefined4 *param_2,int *param_3)

{
  FUN_1001d270((int)param_2,param_3);
  FUN_1001d2f0((int)param_3,param_2);
  FUN_1001a010(*(int *)(param_1 + 0x1608),*param_3);
  return;
}



undefined4 __cdecl FUN_1001fce0(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  undefined4 uVar3;
  void *this;
  int iVar4;
  byte *pbVar5;
  int iVar6;
  byte local_10 [16];
  
  pbVar5 = &DAT_10039247;
  iVar4 = 0x10;
  pbVar2 = local_10;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar1,pbVar2,iVar4,pbVar5);
  iVar4 = FUN_10018890(this,*(int *)(param_1 + 0x1724),local_10);
  if (iVar4 == 0) {
    iVar4 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar4;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e666e64;
    return 0;
  }
  if ((*(uint *)(iVar4 + 8) & 0x80000) != 0) {
    iVar4 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar4;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
    return 0;
  }
  iVar6 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar6 = FUN_10002e80(pbVar2,iVar6);
  iVar6 = FUN_1001a190(*(int *)(param_1 + 0x1608),iVar6);
  if (iVar6 == 0) {
    iVar4 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar4;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  iVar4 = FUN_10019c70((char *)(iVar4 + 0x10),(char *)(iVar6 + 0x20));
  if (iVar4 != 0) {
    iVar4 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar4) {
      iVar4 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar4;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e6f776e;
    return 0;
  }
  FUN_1001fc00(param_1,local_10);
  uVar3 = FUN_1000c9b0(param_2);
  return uVar3;
}



undefined4 __cdecl FUN_1001fe30(int param_1,int param_2)

{
  byte bVar1;
  byte *pbVar2;
  undefined4 *puVar3;
  byte *pbVar4;
  int *piVar5;
  undefined4 uVar6;
  void *this;
  int *piVar7;
  bool bVar8;
  int iVar9;
  byte *pbVar10;
  byte local_14 [20];
  
  pbVar10 = &DAT_10039247;
  iVar9 = 0x10;
  pbVar4 = local_14;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar2,pbVar4,iVar9,pbVar10);
  puVar3 = (undefined4 *)FUN_10018890(this,*(int *)(param_1 + 0x1724),local_14);
  if (puVar3 == (undefined4 *)0x0) {
    iVar9 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar9;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e666e64;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if ((puVar3[2] & 0x80000) != 0) {
    iVar9 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar9;
    *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  pbVar4 = (byte *)(puVar3 + 0x2f);
  if (*(char *)(puVar3 + 0x2f) != '\0') {
    pbVar2 = local_14;
    do {
      bVar1 = *pbVar4;
      bVar8 = bVar1 < *pbVar2;
      if (bVar1 != *pbVar2) {
LAB_1001ff05:
        iVar9 = (1 - (uint)bVar8) - (uint)(bVar8 != 0);
        goto LAB_1001ff0a;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar4[1];
      bVar8 = bVar1 < pbVar2[1];
      if (bVar1 != pbVar2[1]) goto LAB_1001ff05;
      pbVar4 = pbVar4 + 2;
      pbVar2 = pbVar2 + 2;
    } while (bVar1 != 0);
    iVar9 = 0;
LAB_1001ff0a:
    if (iVar9 != 0) {
      iVar9 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar9) {
        iVar9 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar9;
      *(undefined4 *)(param_2 + 0x4c) = 0x70617373;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
  }
  iVar9 = FUN_10018780((undefined4 *)puVar3[0x34]);
  if (puVar3[8] == iVar9) {
    iVar9 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar9;
    *(undefined4 *)(param_2 + 0x4c) = 0x66756c6c;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar9 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar9 = FUN_10002e80(pbVar4,iVar9);
  piVar5 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar9);
  if (piVar5 == (int *)0x0) {
    iVar9 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar9;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar9 = FUN_10018890((void *)0x0,puVar3[0x34],(byte *)(piVar5 + 8));
  if (iVar9 != 0) {
    iVar9 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar9;
    *(undefined4 *)(param_2 + 0x4c) = 0x616a6f69;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar9 = 0;
  piVar7 = piVar5 + 0x115;
  do {
    if (*piVar7 == 0) break;
    iVar9 = iVar9 + 1;
    piVar7 = piVar7 + 1;
  } while (iVar9 < 4);
  if (iVar9 == 4) {
    iVar9 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar9;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e737063;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if ((((puVar3[2] & 0x800) != 0) && (puVar3[0x36] != 0)) &&
     (iVar9 = FUN_1002c7c0(puVar3[0x36],piVar5 + 8), iVar9 != 0)) {
    iVar9 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar9) {
      iVar9 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar9;
    *(undefined4 *)(param_2 + 0x4c) = 0x6b69636b;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if ((puVar3[2] & 0x1000) == 0) {
    FUN_1001fca0(param_1,puVar3,piVar5);
    FUN_10002c50(*(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),(byte *)"IDENT=%d");
    *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
    uVar6 = FUN_1000c9b0(param_2);
    return uVar6;
  }
  iVar9 = *(int *)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if (-1 < iVar9) {
    iVar9 = *(int *)(param_2 + 100);
  }
  *(int *)(param_2 + 0x48) = iVar9;
  *(undefined4 *)(param_2 + 0x4c) = 0x6c6f636b;
  *(undefined4 *)(param_2 + 0x50) = 0;
  return 0;
}



void __cdecl FUN_10020120(char *param_1,undefined4 param_2)

{
  int *piVar1;
  char cVar2;
  void *_Dst;
  int in_EAX;
  undefined4 *puVar3;
  int iVar4;
  char *pcVar5;
  
  if (*(int *)(in_EAX + 0x158) == 0) {
    puVar3 = (undefined4 *)_malloc(0x304);
    *(undefined4 **)(in_EAX + 0x158) = puVar3;
    for (iVar4 = 0xc1; iVar4 != 0; iVar4 = iVar4 + -1) {
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    }
  }
  _Dst = *(void **)(in_EAX + 0x158);
  if (*(int *)((int)_Dst + 0x300) == 0x20) {
    _memmove(_Dst,(void *)((int)_Dst + 0x18),0x2e8);
    *(int *)(*(int *)(in_EAX + 0x158) + 0x300) = *(int *)(*(int *)(in_EAX + 0x158) + 0x300) + -1;
  }
  pcVar5 = (char *)(*(int *)(in_EAX + 0x158) + *(int *)(*(int *)(in_EAX + 0x158) + 0x300) * 0x18);
  do {
    cVar2 = *param_1;
    param_1 = param_1 + 1;
    *pcVar5 = cVar2;
    pcVar5 = pcVar5 + 1;
  } while (cVar2 != '\0');
  *(undefined4 *)
   (*(int *)(in_EAX + 0x158) + 0x14 + *(int *)(*(int *)(in_EAX + 0x158) + 0x300) * 0x18) = param_2;
  piVar1 = (int *)(*(int *)(in_EAX + 0x158) + 0x300);
  *piVar1 = *piVar1 + 1;
  return;
}



void __cdecl FUN_10020270(int param_1,int param_2)

{
  int iVar1;
  byte *pbVar2;
  int iVar3;
  int iVar4;
  char local_c4 [196];
  
  iVar4 = 0;
  iVar3 = 0;
  if (0 < *(int *)(param_2 + 0x9c)) {
    pbVar2 = (byte *)(param_2 + 0x1b8);
    do {
      iVar1 = FUN_10018890(*(void **)(param_1 + 0x1604),(int)*(void **)(param_1 + 0x1604),pbVar2);
      if (iVar1 != 0) {
        iVar1 = __snprintf(local_c4 + iVar4,0xc1 - iVar4,"USER%d=%s ",iVar3,iVar1 + 0x20);
        iVar4 = iVar4 + iVar1;
      }
      iVar3 = iVar3 + 1;
      pbVar2 = pbVar2 + 0x68;
    } while (iVar3 < *(int *)(param_2 + 0x9c));
  }
  FUN_1000cd80(param_1,0x80,(char *)0x0,"GAME: IDENT=%d AUTO=%d %s");
  return;
}



void FUN_10020330(void)

{
  int iVar1;
  int unaff_ESI;
  int unaff_EDI;
  
  *(int *)(unaff_ESI + 0x15c) =
       *(int *)(*(int *)(unaff_EDI + 0x172c) + 0x134) + *(int *)(unaff_EDI + 0x1944);
  *(uint *)(unaff_ESI + 4) = *(uint *)(unaff_ESI + 4) | 0x80000;
  if (*(int *)(unaff_ESI + 0x8c) != 0) {
    iVar1 = FUN_1001a190(*(int *)(unaff_EDI + 0x15f8),*(int *)(unaff_ESI + 0x8c));
    if (iVar1 != 0) {
      *(int *)(iVar1 + 0x17c) = *(int *)(iVar1 + 0x17c) + -1;
    }
  }
  FUN_10020270(unaff_EDI,unaff_ESI);
  return;
}



uint FUN_10020390(void)

{
  uint in_EAX;
  uint uVar1;
  undefined4 uVar2;
  
  uVar1 = in_EAX & 0xffffff00;
  if (((*(byte *)(in_EAX + 4) & 2) != 0) && (*(int *)(in_EAX + 0x9c) == *(int *)(in_EAX + 0x94))) {
    uVar2 = FUN_10020330();
    uVar1 = CONCAT31((int3)((uint)uVar2 >> 8),1);
  }
  return uVar1;
}



void __cdecl FUN_10020460(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  int iVar2;
  char *unaff_EBX;
  undefined4 *unaff_ESI;
  int unaff_EDI;
  
  _strncpy((char *)(unaff_ESI + unaff_ESI[0x27] * 0x1a + 0x6e),(char *)(unaff_EDI + 0x20),0x10);
  unaff_ESI[unaff_ESI[0x27] * 0x1a + 0x72] = param_2;
  unaff_ESI[unaff_ESI[0x27] * 0x1a + 0x74] = param_3;
  unaff_ESI[unaff_ESI[0x27] * 0x1a + 0x75] = *(undefined4 *)(unaff_EDI + 0x404);
  unaff_ESI[unaff_ESI[0x27] * 0x1a + 0x73] = param_4;
  if (unaff_EBX != (char *)0x0) {
    _strncpy((char *)(unaff_ESI + unaff_ESI[0x27] * 0x1a + 0x76),unaff_EBX,0x24);
  }
  uVar1 = *unaff_ESI;
  *(int *)(unaff_EDI + 4) = *(int *)(unaff_EDI + 4) + 1;
  *(undefined4 *)(unaff_EDI + 0x34) = uVar1;
  iVar2 = FUN_1001a190(*(int *)(param_1 + 0x15f8),*(int *)(unaff_EDI + 0x30));
  if (iVar2 == 0) {
    *(undefined1 *)(unaff_ESI + unaff_ESI[0x27] * 0x1a + 0x7f) = 0;
    unaff_ESI[0x27] = unaff_ESI[0x27] + 1;
    return;
  }
  _strncpy((char *)(unaff_ESI + unaff_ESI[0x27] * 0x1a + 0x7f),(char *)(iVar2 + 8),0x24);
  unaff_ESI[0x27] = unaff_ESI[0x27] + 1;
  return;
}



uint __cdecl FUN_10020560(int param_1,int param_2)

{
  undefined1 *_Dst;
  uint in_EAX;
  uint uVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  
  uVar1 = in_EAX & 0xffffff00;
  iVar4 = 0;
  if (0 < *(int *)(param_1 + 0x9c)) {
    pcVar3 = (char *)(param_1 + 0x1b8);
    while( true ) {
      iVar2 = FUN_10019c70((char *)(param_2 + 0x20),pcVar3);
      if (iVar2 == 0) break;
      iVar4 = iVar4 + 1;
      pcVar3 = pcVar3 + 0x68;
      if ((int)*(uint *)(param_1 + 0x9c) <= iVar4) {
        return *(uint *)(param_1 + 0x9c) & 0xffffff00;
      }
    }
    if ((*(uint *)(param_1 + 4) & 0x100) != 0) {
      FUN_10020120((char *)(param_2 + 0xc),*(undefined4 *)(iVar4 * 0x68 + 0x1c8 + param_1));
    }
    iVar2 = iVar4 * 0x68 + param_1;
    _Dst = (undefined1 *)(iVar2 + 0x1b8);
    *_Dst = 0;
    if (iVar4 != 7) {
      _memmove(_Dst,(void *)(iVar2 + 0x220),((*(int *)(param_1 + 0x9c) - iVar4) + -1) * 0x68);
      if (iVar4 < *(int *)(param_1 + 0x90)) {
        *(int *)(param_1 + 0x90) = *(int *)(param_1 + 0x90) + -1;
      }
    }
    iVar4 = *(int *)(param_1 + 0x9c) + -1;
    *(int *)(param_1 + 0x9c) = iVar4;
    uVar1 = CONCAT31((int3)((uint)iVar4 >> 8),1);
  }
  return uVar1;
}



undefined4 __cdecl FUN_10020630(int param_1,int param_2)

{
  byte bVar1;
  char cVar2;
  byte *pbVar3;
  byte *pbVar4;
  int *piVar5;
  int *piVar6;
  char *pcVar7;
  int iVar8;
  uint *puVar9;
  uint uVar10;
  undefined4 uVar11;
  int iVar12;
  uint *puVar13;
  uint *puVar14;
  int iVar15;
  int iVar16;
  byte *pbVar17;
  byte *pbVar18;
  undefined4 *local_568;
  int local_564;
  undefined4 *local_55c;
  byte local_554 [16];
  byte local_544 [32];
  byte local_524 [36];
  uint local_500 [3];
  byte local_4f4 [36];
  byte local_4d0 [72];
  byte local_488 [20];
  undefined4 local_474;
  undefined4 local_470;
  int local_46c;
  int local_468;
  char local_460 [36];
  byte local_43c [132];
  undefined4 local_3b8;
  int local_3b4;
  int local_3b0;
  int local_3ac;
  int local_3a4;
  int local_398;
  byte local_394 [912];
  
  iVar8 = *(int *)(param_1 + 0x172c);
  pbVar17 = &DAT_10039247;
  iVar15 = 0x24;
  pbVar4 = local_4f4;
  puVar13 = local_500;
  for (iVar12 = 0x13e; iVar12 != 0; iVar12 = iVar12 + -1) {
    *puVar13 = 0;
    puVar13 = puVar13 + 1;
  }
  local_568 = (undefined4 *)0x0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar3,pbVar4,iVar15,pbVar17);
  if (local_4f4[0] == 0) {
LAB_10020f2c:
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
    return 0;
  }
  pbVar4 = local_4f4;
  do {
    bVar1 = *pbVar4;
    pbVar4[0x24] = bVar1;
    pbVar4 = pbVar4 + 1;
  } while (bVar1 != 0);
  pbVar3 = &DAT_10039247;
  iVar12 = 0x84;
  pbVar4 = local_43c;
  pbVar17 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"PARAMS");
  FUN_100030f0(pbVar17,pbVar4,iVar12,pbVar3);
  iVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a71c);
  iVar12 = FUN_10002e80(pbVar4,iVar12);
  local_55c = (undefined4 *)0x0;
  if (iVar12 != 0) {
    local_55c = (undefined4 *)FUN_1001a190(*(int *)(param_1 + 0x15f8),iVar12);
    if (local_55c == (undefined4 *)0x0) {
      iVar8 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar8) {
        iVar8 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar8;
      *(undefined4 *)(param_2 + 0x4c) = 0x75726f6d;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    local_474 = *local_55c;
  }
  iVar12 = -1;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"MAXSIZE");
  local_46c = FUN_10002e80(pbVar4,iVar12);
  iVar12 = -1;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"MINSIZE");
  local_468 = FUN_10002e80(pbVar4,iVar12);
  if ((local_46c == -1) || (local_468 == -1)) goto LAB_10020f2c;
  if ((((local_46c < 1) || (8 < local_46c)) || (local_468 < 1)) || (local_46c < local_468)) {
LAB_10020f09:
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x696e7670;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CUSTFLAGS");
  local_500[2] = FUN_10002e80(pbVar4,iVar12);
  iVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"SYSFLAGS");
  local_500[1] = FUN_10002e80(pbVar4,iVar12);
  pbVar3 = &DAT_10039247;
  iVar12 = 0x14;
  pbVar4 = local_488;
  local_500[1] = local_500[1] & 0xfff7ffff;
  pbVar17 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a74c);
  FUN_100030f0(pbVar17,pbVar4,iVar12,pbVar3);
  if (local_488[0] != 0) {
    local_500[1] = local_500[1] | 0x10000;
  }
  iVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003d6a0);
  local_3b4 = FUN_10002e80(pbVar4,iVar12);
  iVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"EVGID");
  local_3b0 = FUN_10002e80(pbVar4,iVar12);
  iVar12 = 1;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"NUMPART");
  local_3ac = FUN_10002e80(pbVar4,iVar12);
  if ((local_3ac < 1) || (2 < local_3ac)) goto LAB_10020f09;
  iVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar12 = FUN_10002e80(pbVar4,iVar12);
  piVar5 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar12);
  if (piVar5 == (int *)0x0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if (piVar5[0xd] != 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x696e676d;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar12 = 0;
  local_470 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"IGNPROFNAME");
  iVar12 = FUN_10002e80(pbVar4,iVar12);
  if (iVar12 == 0) {
    FUN_10019870(*(undefined4 *)(param_1 + 0x1c78),local_4f4);
    iVar12 = FUN_100195a0(*(int **)(param_1 + 0x1c78),local_4f4);
    if ((0 < iVar12) || (local_4f4[0] == 0)) {
      iVar8 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar8) {
        iVar8 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar8;
      *(undefined4 *)(param_2 + 0x4c) = 0x66696c74;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
  }
  iVar12 = FUN_10018890(local_4f4,*(int *)(param_1 + 0x1718),local_4f4);
  if (iVar12 != 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x6475706c;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar12 = 0;
  local_564 = 0;
  if (0 < local_3ac) {
    pbVar4 = local_394;
    do {
      _sprintf((char *)local_544,"PARTSIZE%d",iVar12);
      iVar15 = 0;
      pbVar17 = FUN_10002000(*(byte **)(param_2 + 0x74),local_544);
      iVar15 = FUN_10002e80(pbVar17,iVar15);
      local_564 = local_564 + iVar15;
      *(int *)(pbVar4 + -4) = iVar15;
      _sprintf((char *)local_544,"PARTPARAMS%d",iVar12);
      pbVar18 = &DAT_10039247;
      iVar15 = 0x24;
      pbVar17 = pbVar4;
      pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),local_544);
      FUN_100030f0(pbVar3,pbVar17,iVar15,pbVar18);
      iVar12 = iVar12 + 1;
      pbVar4 = pbVar4 + 0x28;
    } while (iVar12 < local_3ac);
    if (local_564 != 0) {
      if (local_564 != local_46c) {
        iVar8 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar8) {
          iVar8 = *(int *)(param_2 + 100);
        }
        *(int *)(param_2 + 0x48) = iVar8;
        *(undefined4 *)(param_2 + 0x4c) = 0x696e7670;
        *(undefined4 *)(param_2 + 0x50) = 0;
        return 0;
      }
      goto LAB_10020af0;
    }
  }
  iVar12 = 0;
  if (0 < local_3ac) {
    piVar6 = &local_398;
    do {
      *piVar6 = local_46c / local_3ac;
      iVar12 = iVar12 + 1;
      piVar6 = piVar6 + 10;
    } while (iVar12 < local_3ac);
  }
  (&local_398)[iVar12 * 10] = (&local_398)[iVar12 * 10] + local_46c % local_3ac;
LAB_10020af0:
  iVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"USERPART");
  iVar12 = FUN_10002e80(pbVar4,iVar12);
  if ((iVar12 < 0) || (local_3ac <= iVar12)) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x4c) = 0x70617274;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  pbVar3 = &DAT_10039247;
  iVar15 = 0x10;
  pbVar4 = local_554;
  pbVar17 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a72c);
  FUN_100030f0(pbVar17,pbVar4,iVar15,pbVar3);
  if (local_554[0] == 0) {
    iVar15 = 0;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"USERFLAGS");
    iVar15 = FUN_10002e80(pbVar4,iVar15);
    pbVar3 = &DAT_10039247;
    iVar16 = 0x24;
    pbVar4 = local_524;
    pbVar17 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"USERPARAMS");
    FUN_100030f0(pbVar17,pbVar4,iVar16,pbVar3);
    FUN_10020460(param_1,iVar12,iVar15,0);
    FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar5);
  }
  else {
    local_568 = (undefined4 *)FUN_10018890(local_554,*(int *)(param_1 + 0x1724),local_554);
    if (local_568 == (undefined4 *)0x0) {
      iVar8 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar8) {
        iVar8 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar8;
      *(undefined4 *)(param_2 + 0x4c) = 0x75757374;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    iVar15 = FUN_10019c70((char *)(local_568 + 4),(char *)(piVar5 + 8));
    if (iVar15 != 0) {
      iVar8 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar8) {
        iVar8 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar8;
      *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    if ((local_568[2] & 0x1000) == 0) {
      iVar8 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar8) {
        iVar8 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar8;
      *(undefined4 *)(param_2 + 0x4c) = 0x6e6c6f6b;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    iVar15 = FUN_10018780((undefined4 *)local_568[0x34]);
    if ((&local_398)[iVar12 * 10] < iVar15) {
      iVar8 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar8) {
        iVar8 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar8;
      *(undefined4 *)(param_2 + 0x4c) = 0x66756c6c;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    FUN_10018a80(local_568[0x34]);
    piVar6 = (int *)FUN_10018a90(local_568[0x34],(undefined4 *)0x0);
    while (piVar6 != (int *)0x0) {
      FUN_10020460(param_1,iVar12,0,*local_568);
      FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar6);
      piVar6 = (int *)FUN_10018a90(local_568[0x34],(undefined4 *)0x0);
    }
  }
  local_3b8 = FUN_100035f0((char *)0x0,0);
  local_3a4 = *(int *)(param_1 + 0x1944) + *(int *)(iVar8 + 0x134);
  pcVar7 = (char *)(iVar8 + 8);
  iVar8 = -(int)pcVar7;
  do {
    cVar2 = *pcVar7;
    pcVar7[(int)(local_460 + iVar8)] = cVar2;
    pcVar7 = pcVar7 + 1;
  } while (cVar2 != '\0');
  iVar8 = (*(code *)PTR_FUN_1004141c)
                    (*(undefined4 *)(*(int *)(param_1 + 0x172c) + 0x10c),local_500,piVar5,local_568,
                     *(undefined4 *)(param_2 + 0x74));
  if (iVar8 != 0) {
    iVar12 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar12) {
      iVar12 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x4c) = iVar8;
    *(int *)(param_2 + 0x48) = iVar12;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  puVar9 = (uint *)FUN_1001dcc0(*(undefined4 *)(param_1 + 0x1720));
  puVar13 = local_500;
  puVar14 = puVar9;
  for (iVar8 = 0x13e; iVar8 != 0; iVar8 = iVar8 + -1) {
    *puVar14 = *puVar13;
    puVar13 = puVar13 + 1;
    puVar14 = puVar14 + 1;
  }
  FUN_10018820((void *)0x0,*(int **)(param_1 + 0x1718),(byte *)(puVar9 + 0xc),(int)puVar9);
  uVar10 = FUN_10019f50(*(int **)(param_1 + 0x171c),0,puVar9);
  *puVar9 = uVar10;
  FUN_10019b30(*(int **)(param_1 + 0x1720),(int)puVar9);
  piVar5[0xd] = *puVar9;
  FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar5);
  if (puVar9[0x23] != 0) {
    local_55c[0x5f] = local_55c[0x5f] + 1;
  }
  FUN_10020390();
  FUN_1001d690(*(int *)(param_1 + 0x1604),*(undefined4 *)(param_1 + 0x15f8),(byte *)puVar9,
               (int)piVar5,*(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),PTR_FUN_1004143c,
               *(undefined4 *)(*(int *)(param_1 + 0x172c) + 0x10c),'\0');
  uVar11 = FUN_1000c9b0(param_2);
  return uVar11;
}



undefined4 __cdecl FUN_10021720(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  int iVar6;
  byte *pbVar7;
  byte local_24 [36];
  
  pbVar7 = &DAT_10039247;
  iVar6 = 0x24;
  pbVar2 = local_24;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar1,pbVar2,iVar6,pbVar7);
  if (local_24[0] == 0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar6 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar6 = FUN_10002e80(pbVar2,iVar6);
  iVar6 = FUN_1001a190(*(int *)(param_1 + 0x1608),iVar6);
  if (iVar6 == 0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  piVar3 = (int *)FUN_10018890(local_24,*(int *)(param_1 + 0x1718),local_24);
  if (piVar3 == (int *)0x0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x7567616d;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if (*(int *)(iVar6 + 0x34) != *piVar3) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e67616d;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if (piVar3[0x24] < 0) {
    piVar4 = (int *)&DAT_10039247;
  }
  else {
    piVar4 = piVar3 + piVar3[0x24] * 0x1a + 0x6e;
  }
  iVar6 = FUN_10019c70((char *)piVar4,(char *)(iVar6 + 0x20));
  if (iVar6 != 0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e676874;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if ((piVar3[1] & 0x80000U) != 0) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x61737461;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  if (piVar3[0x27] < piVar3[0x26]) {
    iVar6 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar6) {
      iVar6 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar6;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e65706c;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  FUN_10020330();
  FUN_1001a010(*(int *)(param_1 + 0x171c),*piVar3);
  *(undefined4 *)(param_2 + 0x50) = 0;
  uVar5 = FUN_1000c9b0(param_2);
  return uVar5;
}



undefined4 __cdecl FUN_10021fa0(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  int local_30;
  byte *local_2c;
  byte local_24 [36];
  
  pbVar8 = &DAT_10039247;
  iVar7 = 0x24;
  pbVar2 = local_24;
  iVar6 = 0;
  local_30 = 0;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar1,pbVar2,iVar7,pbVar8);
  iVar7 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"FORCE");
  iVar7 = FUN_10002e80(pbVar2,iVar7);
  iVar9 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"FORCE_LOCK");
  iVar9 = FUN_10002e80(pbVar2,iVar9);
  iVar10 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"FORCE_START");
  iVar10 = FUN_10002e80(pbVar2,iVar10);
  if (local_24[0] == 0) {
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
    return 0;
  }
  pbVar2 = (byte *)FUN_10018890(*(void **)(param_1 + 0x1718),(int)*(void **)(param_1 + 0x1718),
                                local_24);
  if (pbVar2 == (byte *)0x0) {
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x7567616d;
    return 0;
  }
  if ((((*(uint *)(pbVar2 + 4) & 0x1000) != 0) && (iVar7 == 0)) && (iVar9 == 0)) {
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x6c6f636b;
    return 0;
  }
  iVar9 = 0;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar9 = FUN_10002e80(pbVar1,iVar9);
  piVar3 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar9);
  if (piVar3 == (int *)0x0) {
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  if (piVar3[0xd] != *(int *)pbVar2) {
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x6a6f696e;
    return 0;
  }
  if (*(int *)(pbVar2 + 0x90) < 0) {
    pbVar1 = &DAT_10039247;
  }
  else {
    pbVar1 = pbVar2 + *(int *)(pbVar2 + 0x90) * 0x68 + 0x1b8;
  }
  iVar9 = FUN_10019c70((char *)(piVar3 + 8),(char *)pbVar1);
  if (iVar9 == 0) {
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x67687374;
    return 0;
  }
  if (((*(uint *)(pbVar2 + 4) & 0x80000) != 0) &&
     (((iVar7 == 0 && (iVar10 == 0)) || (piVar3[0xd] == 0)))) {
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x61737461;
    return 0;
  }
  iVar7 = -1;
  if (0 < *(int *)(pbVar2 + 0x9c)) {
    local_2c = pbVar2 + 0x1b8;
    do {
      if (iVar7 != -1) goto LAB_10022261;
      iVar9 = FUN_10019c70((char *)local_2c,(char *)(piVar3 + 8));
      if (iVar9 == 0) {
        iVar7 = iVar6;
      }
      iVar6 = iVar6 + 1;
      local_2c = local_2c + 0x68;
    } while (iVar6 < *(int *)(pbVar2 + 0x9c));
    if (iVar7 != -1) {
LAB_10022261:
      if (((*(int *)(pbVar2 + iVar7 * 0x68 + 0x1cc) != 0) &&
          (local_30 = FUN_1001a190(*(int *)(param_1 + 0x1728),
                                   *(int *)(pbVar2 + iVar7 * 0x68 + 0x1cc)), local_30 != 0)) &&
         (iVar7 = FUN_10019c70((char *)(local_30 + 0x10),(char *)(piVar3 + 8)), iVar7 != 0)) {
        iVar7 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar7) {
          iVar7 = *(int *)(param_2 + 100);
        }
        *(int *)(param_2 + 0x48) = iVar7;
        *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
        *(undefined4 *)(param_2 + 0x50) = 0;
        return 0;
      }
      iVar7 = (*(code *)PTR_FUN_10041434)
                        (*(undefined4 *)(*(int *)(param_1 + 0x172c) + 0x10c),pbVar2,piVar3,
                         *(undefined4 *)(param_2 + 0x74));
      if (iVar7 != 0) {
        iVar9 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar9) {
          iVar9 = *(int *)(param_2 + 100);
        }
        *(int *)(param_2 + 0x4c) = iVar7;
        *(int *)(param_2 + 0x48) = iVar9;
        *(undefined4 *)(param_2 + 0x50) = 0;
        return 0;
      }
      if (local_30 == 0) {
        FUN_10020560((int)pbVar2,(int)piVar3);
        piVar3[1] = piVar3[1] + 1;
        piVar3[0xd] = 0;
        FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar3);
      }
      else {
        FUN_10018a80(*(int *)(local_30 + 0xd0));
        piVar4 = (int *)FUN_10018a90(*(int *)(local_30 + 0xd0),(undefined4 *)0x0);
        while (piVar4 != (int *)0x0) {
          FUN_10020560((int)pbVar2,(int)piVar4);
          piVar4[1] = piVar4[1] + 1;
          piVar4[0xd] = 0;
          FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar4);
          piVar4 = (int *)FUN_10018a90(*(int *)(local_30 + 0xd0),(undefined4 *)0x0);
        }
      }
      FUN_1001a010(*(int *)(param_1 + 0x171c),*(int *)pbVar2);
      FUN_1001d690(*(int *)(param_1 + 0x1604),*(undefined4 *)(param_1 + 0x15f8),pbVar2,(int)piVar3,
                   *(byte **)(param_2 + 0x58),*(byte **)(param_2 + 0x54),PTR_FUN_1004143c,
                   *(undefined4 *)(*(int *)(param_1 + 0x172c) + 0x10c),'\0');
      uVar5 = FUN_1000c9b0(param_2);
      return uVar5;
    }
  }
  iVar7 = *(int *)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if (-1 < iVar7) {
    iVar7 = *(int *)(param_2 + 100);
  }
  *(int *)(param_2 + 0x48) = iVar7;
  *(undefined4 *)(param_2 + 0x4c) = 0x6a6f696e;
  *(undefined4 *)(param_2 + 0x50) = 0;
  return 0;
}



void __thiscall FUN_100225c0(void *this,int param_1,int *param_2,int *param_3)

{
  int *piVar1;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *extraout_ECX_01;
  int iVar2;
  byte *pbVar3;
  
  iVar2 = 0;
  if (0 < param_2[0x27]) {
    pbVar3 = (byte *)(param_2 + 0x6e);
    do {
      piVar1 = (int *)FUN_10018890(this,*(int *)(param_1 + 0x1604),pbVar3);
      this = extraout_ECX;
      if ((piVar1 != (int *)0x0) && (this = (void *)piVar1[0xd], this == (void *)*param_2)) {
        piVar1[0xd] = 0;
        piVar1[1] = piVar1[1] + 1;
        if (piVar1[0x101] == 0) {
          this = (void *)0x0;
          if (param_3 != piVar1) {
            FUN_10028a50(param_1,piVar1,'\x01');
            this = extraout_ECX_00;
          }
        }
        else {
          FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar1);
          this = extraout_ECX_01;
        }
      }
      iVar2 = iVar2 + 1;
      pbVar3 = pbVar3 + 0x68;
    } while (iVar2 < param_2[0x27]);
  }
  return;
}



void __cdecl FUN_10022650(int param_1,int *param_2,char param_3,int *param_4)

{
  int iVar1;
  void *this;
  
  FUN_100188e0(*(void **)(param_1 + 0x1718),(int *)*(void **)(param_1 + 0x1718),
               (byte *)(param_2 + 0xc));
  FUN_1001a0d0(*(int *)(param_1 + 0x171c),*param_2);
  FUN_10019be0(*(int **)(param_1 + 0x1720),(int)param_2,'\0');
  if (param_3 != '\0') {
    FUN_100225c0(this,param_1,param_2,param_4);
  }
  if ((param_2[0x23] != 0) && ((param_2[1] & 0x80000U) == 0)) {
    iVar1 = FUN_1001a190(*(int *)(param_1 + 0x15f8),param_2[0x23]);
    if (iVar1 != 0) {
      *(int *)(iVar1 + 0x17c) = *(int *)(iVar1 + 0x17c) + -1;
    }
  }
  FUN_1001dce0(*(int *)(param_1 + 0x1720),(int)param_2);
  return;
}



undefined4 __cdecl FUN_100226f0(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  undefined4 uVar6;
  void *this;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  byte local_24 [36];
  
  pbVar9 = &DAT_10039247;
  iVar8 = 0x24;
  pbVar2 = local_24;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar1,pbVar2,iVar8,pbVar9);
  iVar8 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"FORCE");
  iVar8 = FUN_10002e80(pbVar2,iVar8);
  if (local_24[0] == 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d697373;
    return 0;
  }
  iVar7 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar7 = FUN_10002e80(pbVar2,iVar7);
  iVar7 = FUN_1001a190(*(int *)(param_1 + 0x1608),iVar7);
  if (iVar7 == 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  piVar3 = (int *)FUN_10018890(this,*(int *)(param_1 + 0x1718),local_24);
  if (piVar3 == (int *)0x0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x7567616d;
    return 0;
  }
  if (*(int *)(iVar7 + 0x34) != *piVar3) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e67616d;
    return 0;
  }
  if (piVar3[0x24] < 0) {
    piVar4 = (int *)&DAT_10039247;
  }
  else {
    piVar4 = piVar3 + piVar3[0x24] * 0x1a + 0x6e;
  }
  iVar5 = FUN_10019c70((char *)piVar4,(char *)(iVar7 + 0x20));
  if (iVar5 != 0) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e676874;
    return 0;
  }
  if (((piVar3[1] & 0x80000U) != 0) && ((iVar8 == 0 || (*(int *)(iVar7 + 0x34) == 0)))) {
    iVar8 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar8) {
      iVar8 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar8;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x696e676d;
    return 0;
  }
  FUN_10022650(param_1,piVar3,'\x01',(int *)0x0);
  *(undefined4 *)(param_2 + 0x50) = 0;
  uVar6 = FUN_1000c9b0(param_2);
  return uVar6;
}



int FUN_10022940(void)

{
  int in_EAX;
  int iVar1;
  int unaff_EBX;
  char *pcVar2;
  int iVar3;
  
  iVar3 = 0;
  pcVar2 = (char *)(in_EAX + 0x26a4);
  while( true ) {
    if (*pcVar2 == '\0') {
      return -1;
    }
    iVar1 = FUN_1002a1d0(*(int *)(unaff_EBX + 0x25dc),pcVar2);
    if (-1 < iVar1) break;
    iVar3 = iVar3 + 1;
    pcVar2 = pcVar2 + 0x68;
    if (7 < iVar3) {
      return -1;
    }
  }
  return iVar1;
}



void __cdecl FUN_10022980(int param_1)

{
  int in_EAX;
  int iVar1;
  int iVar2;
  int *piVar3;
  
  iVar2 = *(int *)(in_EAX + 0x172c);
  FUN_1000cd80(in_EAX,0x40000,(char *)0x0,
               "BATCH: BAD_STATE: head blocked by non-head.  Attempting to release.");
  iVar1 = FUN_10019b70(*(int *)(iVar2 + 0x114));
  if (iVar1 != 0) {
    do {
      if (*(int *)(iVar1 + 0x24ec) == *(int *)(*(int *)(in_EAX + 0x25dc) + 0x8c + param_1 * 0x7a6c))
      {
        if (*(int *)(*(int *)(in_EAX + 0x25dc) + 0x88 + param_1 * 0x7a6c) ==
            *(int *)(iVar1 + 0x2588)) {
          FUN_1002a1a0(*(int *)(in_EAX + 0x25dc),param_1);
          FUN_1002a100(*(int *)(in_EAX + 0x25dc),*(int *)(iVar1 + 0x24d4));
          *(undefined4 *)(iVar1 + 0x24d0) = 0;
          FUN_1000cd80(in_EAX,0x40000,(char *)0x0,
                       "BATCH: BAD_STATE: request finished; releasing slot.");
          return;
        }
        FUN_1000cd80(in_EAX,0x40000,(char *)0x0,
                     "BATCH: BAD_STATE: request not completed yet; will cleanup later.");
        return;
      }
      iVar1 = FUN_10019c60(*(undefined4 *)(iVar2 + 0x114),iVar1);
    } while (iVar1 != 0);
  }
  FUN_1000cd80(in_EAX,0x40000,(char *)0x0,
               "BATCH: BAD_STATE: reserving game not found; releasing slot.");
  FUN_1002a1a0(*(int *)(in_EAX + 0x25dc),param_1);
  iVar2 = 0;
  piVar3 = (int *)(*(int *)(in_EAX + 0x25dc) + 0xc);
  do {
    if (*piVar3 == *(int *)(iVar1 + 0x24ec)) {
      FUN_1002a100(*(int *)(in_EAX + 0x25dc),*(int *)(iVar1 + 0x24d4));
      return;
    }
    iVar2 = iVar2 + 1;
    piVar3 = piVar3 + 4;
  } while (iVar2 < 8);
  return;
}



void FUN_10022ac0(void)

{
  int iVar1;
  int in_EAX;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  void *this;
  byte *_Source;
  int local_f70;
  int local_f6c;
  byte local_f5c [32];
  byte local_f3c [3900];
  
  iVar1 = *(int *)(in_EAX + 0x172c);
  local_f70 = 0;
  iVar2 = FUN_10019b70(*(int *)(iVar1 + 0x114));
  iVar6 = iVar2;
  if (iVar2 != 0) {
    do {
      if ((*(uint *)(iVar6 + 0x24f0) & 0x40000) == 0) {
        *(undefined4 *)(iVar6 + 0x24d0) = 7;
        *(undefined4 *)(iVar6 + 0x24e8) = 0xffffffff;
      }
      else if (*(int *)(iVar6 + 0x24d0) == 0) {
        iVar3 = FUN_10022940();
        if (-1 < iVar3) {
          FUN_1000cd80(in_EAX,0x40000,(char *)0x0,
                       "BATCH: queued game %d contains duplicate user for %d");
          if (iVar6 == iVar2) {
            if (*(int *)(*(int *)(in_EAX + 0x25dc) + 0x8c + iVar3 * 0x7a6c) ==
                *(int *)(iVar6 + 0x24ec)) {
              FUN_1000cd80(in_EAX,0x40000,(char *)0x0,
                           "BATCH: BAD_STATE: head game in bad state; fixing.");
              *(undefined4 *)(iVar6 + 0x24d0) = 1;
            }
            else {
              FUN_10022980(iVar3);
            }
          }
          break;
        }
        iVar3 = FUN_1002a140(*(int *)(in_EAX + 0x25dc));
        *(int *)(iVar6 + 0x24e8) = iVar3;
        if (iVar3 < 0) break;
        iVar3 = FUN_1002a0c0(*(int *)(in_EAX + 0x25dc));
        *(int *)(iVar6 + 0x24d4) = iVar3;
        if (iVar3 == 0) {
          FUN_1002a1a0(*(int *)(in_EAX + 0x25dc),*(int *)(iVar6 + 0x24e8));
          break;
        }
        *(undefined4 *)(*(int *)(iVar6 + 0x24e8) * 0x7a6c + 0x8c + *(int *)(in_EAX + 0x25dc)) =
             *(undefined4 *)(iVar6 + 0x24ec);
        *(undefined4 *)(*(int *)(iVar6 + 0x24d4) + 0xc) = *(undefined4 *)(iVar6 + 0x24ec);
        local_f3c[0] = 0;
        iVar3 = 0;
        if (0 < *(int *)(iVar6 + 0x2588)) {
          local_f6c = 0x90;
          _Source = (byte *)(iVar6 + 0x26a4);
          do {
            _sprintf((char *)local_f5c,"PERS%d",iVar3);
            FUN_10002620(local_f3c,0xf3c,local_f5c,_Source);
            _strncpy((char *)(*(int *)(iVar6 + 0x24e8) * 0x7a6c + *(int *)(in_EAX + 0x25dc) +
                             local_f6c),(char *)_Source,0x10);
            iVar4 = FUN_10018890(this,*(int *)(in_EAX + 0x1604),_Source);
            if (iVar4 != 0) {
              _sprintf((char *)local_f5c,"UID%d",iVar3);
              FUN_10002620(local_f3c,0xf3c,local_f5c,(byte *)(iVar4 + 0x41c));
            }
            iVar3 = iVar3 + 1;
            local_f6c = local_f6c + 0x10;
            _Source = _Source + 0x68;
          } while (iVar3 < *(int *)(iVar6 + 0x2588));
        }
        FUN_10002310(local_f3c,0xf3c,(byte *)"BSLOT",*(int *)(iVar6 + 0x24e8));
        FUN_10002310(local_f3c,0xf3c,&DAT_1003c564,1);
        uVar5 = FUN_1002a090(*(int *)(in_EAX + 0x25dc));
        *(undefined4 *)(*(int *)(iVar6 + 0x24d4) + 8) = uVar5;
        FUN_10018470(*(SOCKET **)(in_EAX + 0x1960),0x2a626174,
                     -*(int *)(*(int *)(iVar6 + 0x24d4) + 8),(char *)local_f3c,(char *)0xffffffff);
        *(int *)(iVar6 + 0x24d8) = *(int *)(in_EAX + 0x1944) + 30000;
        local_f70 = local_f70 + 1;
        *(undefined4 *)(iVar6 + 0x24d0) = 1;
      }
      iVar6 = FUN_10019c60(*(undefined4 *)(iVar1 + 0x114),iVar6);
    } while (iVar6 != 0);
    if (0 < local_f70) {
      FUN_10019c50(*(undefined4 **)(iVar1 + 0x114));
      FUN_1000cd80(in_EAX,0x40000,(char *)0x0,
                   "BATCH: %d user batch requests queued in this cycle; outstanding reports=%d");
    }
  }
  return;
}



void __cdecl FUN_10022e00(int param_1)

{
  int iVar1;
  FILE *_File;
  undefined4 *puVar2;
  undefined4 uVar3;
  void *pvVar4;
  undefined4 local_8;
  undefined4 local_4;
  
  iVar1 = *(int *)(param_1 + 0x172c);
  if (*(char *)(iVar1 + 0x138) != '\0') {
    _File = (FILE *)FUN_1002e478((char *)(iVar1 + 0x138),"w");
    if (_File == (FILE *)0x0) {
      FUN_1000cd80(param_1,0x80,(char *)0x0,"Error opening \'%s\' game report file for write.\n");
      return;
    }
    local_4 = 0;
    local_8 = 0x29a3e;
    puVar2 = FUN_10019c50(*(undefined4 **)(iVar1 + 0x114));
    local_4 = CONCAT22(local_4._2_2_,(short)puVar2);
    uVar3 = FUN_10018780(*(undefined4 **)(iVar1 + 0x110));
    local_4 = CONCAT22((short)uVar3,(undefined2)local_4);
    _fwrite(&local_8,8,1,_File);
    for (pvVar4 = (void *)FUN_10019b70(*(int *)(iVar1 + 0x114)); pvVar4 != (void *)0x0;
        pvVar4 = (void *)FUN_10019c60(*(undefined4 *)(iVar1 + 0x114),(int)pvVar4)) {
      _fwrite(pvVar4,0x29f0,1,_File);
    }
    FUN_10018a80(*(int *)(iVar1 + 0x110));
    pvVar4 = (void *)FUN_10018a90(*(int *)(iVar1 + 0x110),(undefined4 *)0x0);
    while (pvVar4 != (void *)0x0) {
      _fwrite(pvVar4,0x29f0,1,_File);
      pvVar4 = (void *)FUN_10018a90(*(int *)(iVar1 + 0x110),(undefined4 *)0x0);
    }
    _fclose(_File);
    FUN_1000cd80(param_1,0x80,(char *)0x0,
                 "Saved %d (c=%d/i=%d) unprocessed game reports to \'%s\'\n");
  }
  return;
}



void __cdecl FUN_10022f60(int param_1)

{
  int iVar1;
  FILE *_File;
  size_t sVar2;
  undefined4 *_DstBuf;
  int iVar3;
  char *pcVar4;
  undefined4 local_8;
  uint local_4;
  
  iVar1 = *(int *)(param_1 + 0x172c);
  if (*(char *)(iVar1 + 0x138) == '\0') {
    return;
  }
  _File = (FILE *)FUN_1002e478((char *)(iVar1 + 0x138),"r");
  if (_File == (FILE *)0x0) {
    pcVar4 = "Error opening \'%s\' game report file for read.\n";
  }
  else {
    local_8 = 0;
    local_4 = 0;
    sVar2 = _fread(&local_8,8,1,_File);
    if (sVar2 == 1) {
      if (((short)local_8 != -0x65c2) || (local_8._2_2_ != 2)) {
        FUN_1000cd80(param_1,0x80,(char *)0x0,
                     "Game report file \'%s\' mismatch: ident=0x%x version=%d  want: ident=0x%x version=%d\n"
                    );
        return;
      }
      iVar3 = 0;
      if ((local_4 >> 0x10) + (local_4 & 0xffff) != 0) {
        do {
          _DstBuf = FUN_10019ad0(*(undefined4 *)(iVar1 + 0x114),0x29f0);
          sVar2 = _fread(_DstBuf,0x29f0,1,_File);
          if (sVar2 != 1) {
            FUN_10019b00(*(int *)(iVar1 + 0x114),(int)_DstBuf);
            FUN_1000cd80(param_1,0x80,(char *)0x0,
                         "Failed to read entry %d from game report file \'%s\'.  Remaining entries (%d) will be lost.\n"
                        );
            break;
          }
          _DstBuf[0x935] = 0;
          _DstBuf[0x934] = 0;
          _DstBuf[0x93b] = 0;
          _DstBuf[0x93a] = 0xffffffff;
          FUN_10019b30(*(int **)(iVar1 + 0x114),(int)_DstBuf);
          iVar3 = iVar3 + 1;
        } while (iVar3 < (int)((local_4 >> 0x10) + (local_4 & 0xffff)));
      }
      _fclose(_File);
      FUN_1000cd80(param_1,0x80,(char *)0x0,
                   "Read %d (c=%d/i=%d) unprocessed game reports from \'%s\'\n");
      return;
    }
    pcVar4 = "Game report file \'%s\' corrupt.\n";
  }
  FUN_1000cd80(param_1,0x80,(char *)0x0,pcVar4);
  return;
}



int * __cdecl FUN_10023140(int param_1,int *param_2,int *param_3)

{
  byte *pbVar1;
  char cVar2;
  int *piVar3;
  byte *pbVar4;
  char *pcVar5;
  int iVar6;
  int iVar7;
  int unaff_EBX;
  int *piVar8;
  int iVar9;
  
  iVar6 = *(int *)(unaff_EBX + 0x172c);
  piVar3 = (int *)FUN_1001dcc0(*(undefined4 *)(unaff_EBX + 0x1720));
  piVar8 = piVar3;
  for (iVar7 = 0x13e; iVar7 != 0; iVar7 = iVar7 + -1) {
    *piVar8 = 0;
    piVar8 = piVar8 + 1;
  }
  _sprintf((char *)(piVar3 + 3),"%s vs %s",param_2 + 8,param_3 + 8);
  piVar3[0x24] = 0;
  _strncpy((char *)(piVar3 + 0x6e),(char *)(param_2 + 8),0x10);
  piVar3[0x75] = param_2[0x101];
  _strncpy((char *)(piVar3 + 0x88),(char *)(param_3 + 8),0x10);
  piVar3[0x8f] = param_3[0x101];
  piVar3[0x27] = 2;
  piVar3[0x26] = 2;
  piVar3[0x25] = 2;
  iVar7 = FUN_1001a190(*(int *)(unaff_EBX + 0x15f8),param_2[0xc]);
  if (iVar7 != 0) {
    _strncpy((char *)(piVar3 + 0x7f),(char *)(iVar7 + 8),0x24);
  }
  if (param_2[0xc] != param_3[0xc]) {
    iVar7 = FUN_1001a190(*(int *)(unaff_EBX + 0x15f8),param_3[0xc]);
  }
  if (iVar7 != 0) {
    _strncpy((char *)(piVar3 + 0x99),(char *)(iVar7 + 8),0x24);
  }
  pbVar1 = (byte *)(piVar3 + 0x31);
  FUN_10002230((char *)pbVar1,0x84,(char *)(param_3 + 0x13));
  FUN_10002bf0(pbVar1,0x84,(byte *)(param_2 + 0x13));
  iVar7 = 0;
  pbVar4 = FUN_10002000(pbVar1,&DAT_1003d6a0);
  iVar7 = FUN_10002e80(pbVar4,iVar7);
  iVar9 = 0;
  piVar3[0x53] = iVar7;
  pbVar4 = FUN_10002000(pbVar1,(byte *)"EVGID");
  iVar7 = FUN_10002e80(pbVar4,iVar9);
  piVar3[0x54] = iVar7;
  FUN_100021b0(pbVar1,&DAT_1003d6a0);
  FUN_100021b0(pbVar1,(byte *)"EVGID");
  iVar7 = FUN_100035f0((char *)0x0,0);
  piVar3[0x52] = iVar7;
  piVar3[1] = param_1;
  pcVar5 = (char *)(iVar6 + 8);
  piVar3[0x57] = *(int *)(unaff_EBX + 0x1944) + *(int *)(iVar6 + 0x134);
  iVar6 = 0xa0 - (int)pcVar5;
  do {
    cVar2 = *pcVar5;
    pcVar5[(int)piVar3 + iVar6] = cVar2;
    pcVar5 = pcVar5 + 1;
  } while (cVar2 != '\0');
  _sprintf((char *)(piVar3 + 0xc),"%s:%lu",piVar3 + 3,piVar3[0x52]);
  FUN_10018820(*(void **)(unaff_EBX + 0x1718),(int *)*(void **)(unaff_EBX + 0x1718),
               (byte *)(piVar3 + 0xc),(int)piVar3);
  iVar6 = FUN_10019f50(*(int **)(unaff_EBX + 0x171c),0,piVar3);
  *piVar3 = iVar6;
  FUN_10019b30(*(int **)(unaff_EBX + 0x1720),(int)piVar3);
  iVar6 = *piVar3;
  param_2[0xe] = iVar6;
  param_2[0xd] = iVar6;
  FUN_1001a010(*(int *)(unaff_EBX + 0x1608),*param_2);
  iVar6 = *piVar3;
  param_3[0xe] = iVar6;
  param_3[0xd] = iVar6;
  FUN_1001a010(*(int *)(unaff_EBX + 0x1608),*param_3);
  param_3[0xff] = param_2[0xff];
  return piVar3;
}



undefined4 __cdecl FUN_100234b0(int param_1,byte *param_2)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  byte *pbVar5;
  byte *pbVar6;
  int iVar7;
  uint uVar8;
  int *piVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  char *pcVar12;
  
  puVar2 = (undefined4 *)_malloc(0x238);
  puVar3 = puVar2;
  for (iVar7 = 0x8e; iVar7 != 0; iVar7 = iVar7 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar3 = FUN_10018b00(500,5000);
  puVar2[0x44] = puVar3;
  uVar4 = FUN_10019a50(0);
  puVar2[0x45] = uVar4;
  uVar4 = (*(code *)PTR_FUN_10041384)(param_1);
  uVar8 = 0;
  puVar2[0x43] = uVar4;
  iVar7 = (*(code *)PTR_FUN_1004139c)(uVar4,0);
  if (iVar7 != 0) {
    piVar9 = (int *)(param_1 + 0x1734);
    do {
      if (uVar8 < 0x80) {
        *piVar9 = iVar7;
      }
      else {
        _printf("MasterPlayCreate: maximum number of ranking lists (%d) exceeded.\n",0x80);
      }
      uVar8 = uVar8 + 1;
      piVar9 = piVar9 + 1;
      iVar7 = (*(code *)PTR_FUN_1004139c)(puVar2[0x43],uVar8);
    } while (iVar7 != 0);
  }
  uVar1 = *(uint *)(param_1 + 0x1938);
  if (uVar1 == 0) {
    *(uint *)(param_1 + 0x1938) = uVar8;
  }
  else if (uVar8 != uVar1) {
    _printf("MasterPlayCreate: expected %d ranking lists, mas-cust only defined %d\n",uVar1,uVar8);
  }
  uVar4 = *(undefined4 *)(param_1 + 0x1604);
  uVar11 = *(undefined4 *)(param_1 + 0x1608);
  uVar10 = *(undefined4 *)(param_1 + 0x1960);
  iVar7 = 0x80;
  pbVar5 = FUN_10002000(param_2,(byte *)"USER_ITERATE_QUEUE_SIZE");
  iVar7 = FUN_10002e80(pbVar5,iVar7);
  puVar3 = FUN_1002cab0(iVar7,uVar10,uVar11,uVar4);
  pcVar12 = "gamefile.bin";
  iVar7 = 0x100;
  pbVar5 = (byte *)(puVar2 + 0x4e);
  *(undefined4 **)(param_1 + 0x1164d90) = puVar3;
  *(undefined4 *)(param_1 + 0x1164d94) = 0;
  pbVar6 = FUN_10002000(param_2,(byte *)"GAMEFILE");
  FUN_100030f0(pbVar6,pbVar5,iVar7,(byte *)pcVar12);
  *(undefined4 **)(param_1 + 0x172c) = puVar2;
  FUN_10022f60(param_1);
  return 0;
}



undefined4 __cdecl FUN_10023bb0(int param_1)

{
  int *piVar1;
  undefined4 *_Memory;
  int iVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  int *piVar7;
  char local_40 [64];
  
  iVar6 = *(int *)(param_1 + 0x172c);
  piVar1 = (int *)(iVar6 + 0x118);
  iVar3 = *piVar1;
  piVar7 = piVar1;
  while (iVar3 != 0) {
    iVar3 = FUN_1001a190(*(int *)(param_1 + 0x1608),*(int *)(*piVar7 + 0x44));
    if (iVar3 == 0) {
      piVar4 = (int *)*piVar7;
      *piVar7 = *piVar4;
      _free(piVar4);
    }
    else {
      piVar7 = (int *)*piVar7;
    }
    iVar3 = *piVar7;
  }
  if ((((*(int *)(iVar6 + 0x11c) != 0) && (piVar7 = (int *)*piVar1, piVar7 != (int *)0x0)) &&
      (*piVar7 != 0)) && (*(int *)(iVar6 + 0x11c) < *(int *)(param_1 + 0x1944) - piVar7[0x12])) {
    piVar4 = piVar7 + 1;
    iVar3 = -(int)piVar4;
    do {
      iVar2 = *piVar4;
      (local_40 + iVar3)[(int)piVar4] = (char)iVar2;
      piVar4 = (int *)((int)piVar4 + 1);
    } while ((char)iVar2 != '\0');
    piVar4 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),piVar7[0x11]);
    _Memory = (undefined4 *)*piVar7;
    *piVar1 = (int)_Memory;
    piVar5 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),_Memory[0x11]);
    *piVar1 = *_Memory;
    piVar1 = piVar4 + 0x13;
    *(undefined1 *)piVar1 = 0;
    *(undefined1 *)(piVar5 + 0x13) = 0;
    iVar6 = (*(code *)PTR_FUN_100413cc)(*(undefined4 *)(iVar6 + 0x10c),piVar7,_Memory,piVar1,0x84);
    if (iVar6 != 0) {
      *(undefined1 *)piVar1 = 0;
    }
    FUN_10023140(0xe0000,piVar4,piVar5);
    FUN_1000cd80(param_1,0x80,(char *)0x0,"QUIK: IDENT=%d KIND=%s USER0=%s USER1=%s IDLE=1");
    _free(piVar7);
    _free(_Memory);
  }
  return 0;
}



undefined4 __cdecl FUN_10023d00(int param_1,int param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  int *piVar4;
  int *piVar5;
  int *piVar6;
  undefined4 uVar7;
  void *this;
  int *piVar8;
  char *pcVar9;
  bool bVar10;
  int iVar11;
  int iVar12;
  byte *pbVar13;
  int iVar14;
  byte local_20 [32];
  
  iVar12 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar12 = FUN_10002e80(pbVar2,iVar12);
  pbVar13 = &DAT_10039247;
  iVar11 = 0x20;
  pbVar2 = local_20;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b70);
  FUN_100030f0(pbVar3,pbVar2,iVar11,pbVar13);
  iVar11 = -1;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a75c);
  iVar11 = FUN_10002e80(pbVar2,iVar11);
  piVar4 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar12);
  if (piVar4 == (int *)0x0) {
    return 0;
  }
  iVar12 = piVar4[0xfd];
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLPING");
  iVar12 = FUN_10002e80(pbVar2,iVar12);
  iVar14 = 0;
  piVar4[0xfd] = iVar12;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a66c);
  iVar12 = FUN_10002e80(pbVar2,iVar14);
  piVar4[0xff] = iVar12;
  if ((local_20[0] == 0x2a) && (local_20[1] == '\0')) {
    piVar8 = (int *)0x0;
    piVar5 = (int *)FUN_1001a190(*(int *)(param_1 + 0x171c),piVar4[0xd]);
    if (piVar5 != (int *)0x0) {
      if ((piVar5[1] & 0x20008U) == 0) {
        iVar12 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar12) {
          iVar12 = *(int *)(param_2 + 100);
        }
        *(int *)(param_2 + 0x48) = iVar12;
        *(undefined4 *)(param_2 + 0x4c) = 0x7567616d;
        *(undefined4 *)(param_2 + 0x50) = 0;
        return 0;
      }
      pbVar2 = (byte *)(piVar5 + 0x6e);
      iVar12 = FUN_10019c70((char *)pbVar2,(char *)(piVar4 + 8));
      if (iVar12 == 0) {
        pbVar2 = (byte *)(piVar5 + 0x88);
      }
      piVar8 = (int *)FUN_10018890(this,*(int *)(param_1 + 0x1604),pbVar2);
    }
    piVar4[2] = piVar4[2] & 0xfff7ffff;
    piVar4[0xd] = 0;
    piVar4[0xe] = 0;
    *(undefined1 *)(piVar4 + 0xf) = 0;
    FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar4);
    if (piVar8 != (int *)0x0) {
      piVar8[0xd] = 0;
      piVar8[0xe] = 0;
      *(undefined1 *)(piVar8 + 0xf) = 0;
      piVar8[2] = piVar8[2] & 0xfff7ffff;
      FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar8);
    }
    if (piVar5 != (int *)0x0) {
      FUN_10022650(param_1,piVar5,'\0',(int *)0x0);
    }
    pbVar3 = &DAT_1003e168;
    **(undefined1 **)(param_2 + 0x58) = 0;
    iVar12 = *(int *)(param_2 + 0x54);
    pbVar2 = *(byte **)(param_2 + 0x58);
  }
  else {
    if (piVar4[0xd] != 0) {
      FUN_1000cd80(param_1,0x80,(char *)0x0,"user %d chal error already-in-game %d\n");
      iVar12 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar12) {
        iVar12 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar12;
      *(undefined4 *)(param_2 + 0x4c) = 0x696e676d;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    if (local_20[0] == 0) {
      *(undefined1 *)(piVar4 + 0xf) = 0;
      FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar4);
      **(undefined1 **)(param_2 + 0x58) = 0;
      FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003e160,&DAT_1003e168);
      FUN_1000cd80(param_1,0x80,(char *)0x0,"user %d chal undo \'%s\'\n");
      uVar7 = FUN_1000c9b0(param_2);
      return uVar7;
    }
    piVar5 = (int *)FUN_10018890(local_20,*(int *)(param_1 + 0x1604),local_20);
    if (piVar5 == (int *)0x0) {
      FUN_1000cd80(param_1,0x80,(char *)0x0,"CHAL: IDENT %d unknown \'%s\'\n");
      iVar12 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar12) {
        iVar12 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar12;
      *(undefined4 *)(param_2 + 0x4c) = 0x75757372;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    piVar6 = piVar5 + 0xf;
    iVar12 = 9;
    bVar10 = true;
    piVar8 = piVar6;
    pcVar9 = "$ignore$";
    do {
      if (iVar12 == 0) break;
      iVar12 = iVar12 + -1;
      bVar10 = (char)*piVar8 == *pcVar9;
      piVar8 = (int *)((int)piVar8 + 1);
      pcVar9 = pcVar9 + 1;
    } while (bVar10);
    if (bVar10) {
      iVar12 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar12) {
        iVar12 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar12;
      *(undefined4 *)(param_2 + 0x4c) = 0x69676e6f;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    if (((char)*piVar6 != '\0') &&
       (iVar12 = FUN_10019c70((char *)(piVar4 + 8),(char *)piVar6), iVar12 != 0)) {
      FUN_1000cd80(param_1,0x80,(char *)0x0,"CHAL: IDENT %d error unavail \'%s\'\n");
      iVar12 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar12) {
        iVar12 = *(int *)(param_2 + 100);
      }
      *(undefined4 *)(param_2 + 0x50) = 0;
      *(int *)(param_2 + 0x48) = iVar12;
      *(undefined4 *)(param_2 + 0x4c) = 0x6368616c;
      return 0;
    }
    iVar12 = 0;
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a71c);
    iVar12 = FUN_10002e80(pbVar2,iVar12);
    if ((0 < iVar12) && (piVar4[0xc] != piVar5[0xc])) {
      FUN_1000cd80(param_1,0x80,(char *)0x0,"CHAL: IDENT %d error not-in-room \'%s\'\n");
      iVar12 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar12) {
        iVar12 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar12;
      *(undefined4 *)(param_2 + 0x4c) = 0x6e726f6d;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
    FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
    FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CALLPING");
    FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CALLADDR");
    FUN_100021b0(*(byte **)(param_2 + 0x74),&DAT_1003a66c);
    FUN_100021b0(*(byte **)(param_2 + 0x74),&DAT_10039b70);
    FUN_100021b0(*(byte **)(param_2 + 0x74),&DAT_1003a75c);
    FUN_10002230((char *)(piVar4 + 0x13),0x84,*(char **)(param_2 + 0x74));
    iVar12 = FUN_10019c70((char *)(piVar4 + 8),(char *)(piVar5 + 0xf));
    if (iVar12 != 0) {
      pbVar2 = local_20;
      iVar12 = 0x3c - (int)pbVar2;
      do {
        bVar1 = *pbVar2;
        pbVar2[(int)piVar4 + iVar12] = bVar1;
        pbVar2 = pbVar2 + 1;
      } while (bVar1 != 0);
      FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar4);
      **(undefined1 **)(param_2 + 0x58) = 0;
      FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003e160,&DAT_1003e0a0);
      FUN_1000cd80(param_1,0x80,(char *)0x0,"CHAL: IDENT %d chal USER0=\'%s\' USER1=\'%s\'\n");
      uVar7 = FUN_1000c9b0(param_2);
      return uVar7;
    }
    if (iVar11 == 1) {
      FUN_10023140(0xc0008,piVar4,piVar5);
    }
    else {
      FUN_10023140(0xc0008,piVar5,piVar4);
    }
    FUN_1000cd80(param_1,0x80,(char *)0x0,"CHAL: IDENT=%d USER0=%s USER1=%s IDLE=1");
    pbVar3 = &DAT_1003e044;
    **(undefined1 **)(param_2 + 0x58) = 0;
    iVar12 = *(int *)(param_2 + 0x54);
    pbVar2 = *(byte **)(param_2 + 0x58);
  }
  FUN_10002620(pbVar2,iVar12,&DAT_1003e160,pbVar3);
  uVar7 = FUN_1000c9b0(param_2);
  return uVar7;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

undefined4 __cdecl FUN_10024270(int param_1,int param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  uint uVar4;
  int *piVar5;
  bool bVar6;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  int local_1ff0;
  byte abStack_1fec [16];
  byte abStack_1fdc [32];
  byte abStack_1fbc [64];
  byte abStack_1f7c [260];
  byte local_1e78 [3900];
  byte local_f3c [3896];
  undefined4 uStack_4;
  
  uStack_4 = 0x1002427a;
  iVar8 = *(int *)(param_1 + 0x172c);
  pbVar9 = &DAT_10039247;
  iVar7 = 0xf3c;
  pbVar3 = local_f3c;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CUSRINP");
  FUN_100030f0(pbVar2,pbVar3,iVar7,pbVar9);
  FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CUSRINP");
  iVar7 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar7 = FUN_10002e80(pbVar3,iVar7);
  FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  **(undefined1 **)(param_2 + 0x58) = 0;
  _strncpy((char *)local_1e78,*(char **)(param_2 + 0x74),0xf3c);
  local_1ff0 = 0;
  uVar4 = (*(code *)PTR_FUN_100413dc)
                    (*(undefined4 *)(iVar8 + 0x10c),local_f3c,local_1e78,0xf3c,
                     *(undefined4 *)(param_2 + 0x58),*(undefined4 *)(param_2 + 0x54),&local_1ff0);
  if ((local_1ff0 == 0) && ((uVar4 & 1) != 0)) {
    pbVar9 = &DAT_10039247;
    iVar8 = 0x20;
    pbVar3 = abStack_1fdc;
    pbVar2 = FUN_10002000(local_f3c,&DAT_1003a25c);
    FUN_100030f0(pbVar2,pbVar3,iVar8,pbVar9);
    if (abStack_1fdc[0] != 0) {
      FUN_10002620(local_1e78,0xf3c,&DAT_1003a25c,abStack_1fdc);
    }
    FUN_10018470(*(SOCKET **)(param_1 + 0x1960),0x2a707574,0,(char *)local_1e78,(char *)0xffffffff);
    piVar5 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar7);
    if (piVar5 != (int *)0x0) {
      pbVar9 = &DAT_10039247;
      iVar8 = 0x104;
      pbVar3 = abStack_1f7c;
      pbVar2 = FUN_10002000(local_1e78,&DAT_1003a70c);
      FUN_100030f0(pbVar2,pbVar3,iVar8,pbVar9);
      pbVar3 = (byte *)(piVar5 + 0x34);
      pbVar2 = abStack_1f7c;
      do {
        bVar1 = *pbVar3;
        bVar6 = bVar1 < *pbVar2;
        if (bVar1 != *pbVar2) {
LAB_10024448:
          iVar8 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
          goto LAB_1002444d;
        }
        if (bVar1 == 0) break;
        bVar1 = pbVar3[1];
        bVar6 = bVar1 < pbVar2[1];
        if (bVar1 != pbVar2[1]) goto LAB_10024448;
        pbVar3 = pbVar3 + 2;
        pbVar2 = pbVar2 + 2;
      } while (bVar1 != 0);
      iVar8 = 0;
LAB_1002444d:
      if (iVar8 != 0) {
        FUN_10002230((char *)(piVar5 + 0x34),0x104,(char *)abStack_1f7c);
        piVar5[1] = piVar5[1] + 1;
        FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar5);
      }
    }
  }
  else {
    iVar8 = -1;
    pbVar3 = FUN_10002000(local_1e78,&DAT_1003c564);
    iVar8 = FUN_10002e80(pbVar3,iVar8);
    pbVar9 = &DAT_10039247;
    iVar7 = 0x10;
    pbVar3 = abStack_1fec;
    pbVar2 = FUN_10002000(local_1e78,&DAT_10039b70);
    FUN_100030f0(pbVar2,pbVar3,iVar7,pbVar9);
    if ((iVar8 != -1) && (abStack_1fec[0] != 0)) {
      FUN_10002c50(abStack_1fbc,(byte *)0x40,(byte *)"PERS=%s LOCK=%d");
      FUN_10018470(*(SOCKET **)(param_1 + 0x1960),0x2a756c6b,0,(char *)abStack_1fbc,
                   (char *)0xffffffff);
    }
  }
  iVar8 = *(int *)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if (-1 < iVar8) {
    iVar8 = *(int *)(param_2 + 100);
  }
  *(int *)(param_2 + 0x48) = iVar8;
  *(int *)(param_2 + 0x4c) = local_1ff0;
  *(undefined4 *)(param_2 + 0x50) = 0;
  if (**(char **)(param_2 + 0x58) != '\0') {
    *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  }
  return 0;
}



undefined4 __cdecl FUN_10024640(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  byte *pbVar6;
  byte *pbVar7;
  int *piVar8;
  int iVar9;
  int iVar10;
  byte *pbVar11;
  int local_58;
  byte abStack_50 [16];
  byte abStack_40 [64];
  
  iVar3 = param_1;
  iVar1 = *(int *)(param_1 + 0x172c);
  local_58 = 0;
  if ((*(int *)(param_1 + 0x1968) != 0) &&
     (iVar4 = FUN_10019b70(*(int *)(iVar1 + 0x114)), iVar4 != 0)) {
    do {
      iVar9 = 0;
      if (*(int *)(iVar4 + 0x24d0) == 0) {
        if (*(int *)(iVar4 + 0x24e0) == 0) {
          *(undefined4 *)(iVar4 + 0x24d0) = 7;
          goto LAB_100246a0;
        }
        if (local_58 < 1) goto LAB_10024acb;
LAB_10024ab6:
        FUN_1000cd80(iVar3,0x40000,(char *)0x0,"BATCH: %d reports processed this cycle.");
LAB_10024acb:
        FUN_10022ac0();
        return 0;
      }
LAB_100246a0:
      if (*(int *)(iVar4 + 0x24d0) == 1) {
        piVar8 = *(int **)(iVar4 + 0x24d4);
        piVar2 = (int *)*piVar8;
        if ((piVar2 != (int *)0x0) && (-piVar8[2] == *piVar2)) {
          if (piVar2[1] == 0) {
            if (*(int *)(*(int *)(iVar4 + 0x24e8) * 0x7a6c + 0x88 + *(int *)(iVar3 + 0x25dc)) ==
                *(int *)(iVar4 + 0x2588)) {
              *(undefined4 *)(iVar4 + 0x24d0) = 2;
            }
          }
          else {
            if (-1 < *(int *)(iVar4 + 0x24e8)) {
              FUN_1002a100(*(int *)(iVar3 + 0x25dc),(int)piVar8);
              FUN_1002a1a0(*(int *)(iVar3 + 0x25dc),*(int *)(iVar4 + 0x24e8));
            }
            piVar8 = *(int **)(iVar4 + 0x24d4);
            if ((*(int *)(*piVar8 + 4) == 0x74696d65) || (*(int *)(*piVar8 + 4) == 0x64626572)) {
              *(undefined4 *)(iVar4 + 0x24d0) = 0;
            }
            else {
              *(undefined4 *)(iVar4 + 0x24d0) = 7;
            }
          }
        }
        if (*(int *)(iVar4 + 0x24d0) == 1) {
          if (*(int *)(iVar3 + 0x1944) == *(int *)(iVar4 + 0x24d8) ||
              *(int *)(iVar3 + 0x1944) - *(int *)(iVar4 + 0x24d8) < 0) {
            if (local_58 < 1) {
              return 0;
            }
            goto LAB_10024ab6;
          }
          if (-1 < *(int *)(iVar4 + 0x24e8)) {
            FUN_1002a100(*(int *)(iVar3 + 0x25dc),(int)piVar8);
            FUN_1002a1a0(*(int *)(iVar3 + 0x25dc),*(int *)(iVar4 + 0x24e8));
          }
          *(undefined4 *)(iVar4 + 0x24d0) = 0;
        }
      }
      if (*(int *)(iVar4 + 0x24d0) == 2) {
        uVar5 = (*(code *)PTR_FUN_100413b4)
                          (*(undefined4 *)(iVar1 + 0x10c),iVar4,
                           *(int *)(iVar4 + 0x24e8) * 0x7a6c + 0x84 + *(int *)(iVar3 + 0x25dc),0xf3c
                          );
        *(undefined4 *)(iVar4 + 0x24dc) = uVar5;
        *(undefined4 *)(iVar4 + 0x24d0) = 3;
      }
      if (*(int *)(iVar4 + 0x24d0) == 3) {
        param_1 = 0;
        if (0 < *(int *)(iVar4 + 0x2588)) {
          do {
            pbVar6 = (byte *)(*(int *)(iVar4 + 0x24e8) * 0x7a6c + iVar9 + 0x110 +
                             *(int *)(iVar3 + 0x25dc));
            if (*pbVar6 == 0) break;
            iVar10 = -1;
            if ((*(byte *)(iVar4 + 0x24dc) & 1) == 0) {
              pbVar6 = FUN_10002000(pbVar6,&DAT_1003c564);
              iVar10 = FUN_10002e80(pbVar6,iVar10);
              if (iVar10 != -1) {
                FUN_10002c50(abStack_40,(byte *)0x40,(byte *)"PERS=%s LOCK=%d");
                FUN_10018470(*(SOCKET **)(iVar3 + 0x1960),0x2a756c6b,0,(char *)abStack_40,
                             (char *)0xffffffff);
              }
            }
            else {
              FUN_10018470(*(SOCKET **)(iVar3 + 0x1960),0x2a707574,0,(char *)pbVar6,
                           (char *)0xffffffff);
            }
            param_1 = param_1 + 1;
            iVar9 = iVar9 + 0xf3c;
          } while (param_1 < *(int *)(iVar4 + 0x2588));
        }
        *(uint *)(iVar4 + 0x24d0) = ((int)(char)~*(byte *)(iVar4 + 0x24dc) & 1U) << 1 | 5;
      }
      iVar9 = 0;
      if (*(int *)(iVar4 + 0x24d0) == 5) {
        param_1 = 0;
        if (0 < *(int *)(iVar4 + 0x2588)) {
          do {
            pbVar11 = &DAT_10039247;
            iVar10 = 0x10;
            pbVar6 = abStack_50;
            pbVar7 = FUN_10002000((byte *)(*(int *)(iVar4 + 0x24e8) * 0x7a6c + iVar9 + 0x110 +
                                          *(int *)(iVar3 + 0x25dc)),&DAT_10039b70);
            FUN_100030f0(pbVar7,pbVar6,iVar10,pbVar11);
            piVar8 = (int *)FUN_10018890(abStack_50,*(int *)(iVar3 + 0x1604),abStack_50);
            if (piVar8 != (int *)0x0) {
              pbVar11 = &DAT_10039247;
              iVar10 = 0x104;
              pbVar6 = (byte *)(piVar8 + 0x34);
              pbVar7 = FUN_10002000((byte *)(*(int *)(iVar4 + 0x24e8) * 0x7a6c + iVar9 + 0x110 +
                                            *(int *)(iVar3 + 0x25dc)),&DAT_1003a70c);
              FUN_100030f0(pbVar7,pbVar6,iVar10,pbVar11);
              FUN_1001a010(*(int *)(iVar3 + 0x1608),*piVar8);
            }
            param_1 = param_1 + 1;
            iVar9 = iVar9 + 0xf3c;
          } while (param_1 < *(int *)(iVar4 + 0x2588));
        }
        *(undefined4 *)(iVar4 + 0x24d0) = 7;
      }
      if (*(int *)(iVar4 + 0x24d0) == 7) {
        FUN_1000cd80(iVar3,0x40000,(char *)0x0,"BATCH: completed processing of game %d");
        if (-1 < *(int *)(iVar4 + 0x24e8)) {
          FUN_1002a100(*(int *)(iVar3 + 0x25dc),*(int *)(iVar4 + 0x24d4));
          FUN_1002a1a0(*(int *)(iVar3 + 0x25dc),*(int *)(iVar4 + 0x24e8));
        }
        FUN_10019b90(*(int **)(iVar1 + 0x114));
        local_58 = local_58 + 1;
      }
      iVar4 = FUN_10019b70(*(int *)(iVar1 + 0x114));
    } while (iVar4 != 0);
    if (0 < local_58) {
      FUN_1000cd80(iVar3,0x40000,(char *)0x0,"BATCH: %d reports processed this cycle.");
    }
  }
  return 0;
}



void FUN_10024d20(void)

{
                    // WARNING: Could not recover jumptable at 0x10024d34. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)PTR_FUN_100413f4)();
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

undefined4 __cdecl FUN_10024f50(int param_1,int param_2,int param_3)

{
  int iVar1;
  char cVar2;
  byte *pbVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  byte *pbVar9;
  byte local_17ac [16];
  byte abStack_179c [32];
  byte abStack_177c [64];
  byte local_173c [2048];
  byte local_f3c [3896];
  undefined4 uStack_4;
  
  uStack_4 = 0x10024f5a;
  iVar5 = *(int *)(param_1 + 0x172c);
  iVar1 = *(int *)(param_3 + 0x480);
  iVar7 = 0;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar7 = FUN_10002e80(pbVar3,iVar7);
  iVar7 = FUN_1001a190(*(int *)(param_1 + 0x1608),iVar7);
  if (*(int *)(iVar1 + 8) == 0) {
    pbVar3 = *(byte **)(param_2 + 0x74);
    local_17ac[0] = 0;
  }
  else {
    pbVar8 = &DAT_10039247;
    iVar6 = 0x800;
    pbVar3 = local_173c;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003e228);
    FUN_100030f0(pbVar4,pbVar3,iVar6,pbVar8);
    FUN_100021b0(*(byte **)(param_2 + 0x74),&DAT_1003e228);
    FUN_10002bb0(local_173c,0x800,(byte *)"CALLUSER",*(byte **)(param_2 + 0x74));
    FUN_10002bb0(local_173c,0x800,(byte *)"CALLPING",*(byte **)(param_2 + 0x74));
    FUN_10002bb0(local_173c,0x800,(byte *)"CALLADDR",*(byte **)(param_2 + 0x74));
    FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
    FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CALLPING");
    FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"CALLADDR");
    _strncpy((char *)local_f3c,*(char **)(param_2 + 0x74),0xf3c);
    pbVar9 = &DAT_10039247;
    iVar6 = 0x10;
    pbVar4 = local_17ac;
    pbVar3 = local_173c;
    pbVar8 = FUN_10002000(local_f3c,&DAT_10039b70);
    FUN_100030f0(pbVar8,pbVar4,iVar6,pbVar9);
  }
  *(undefined4 *)(param_2 + 0x4c) = 0;
  **(undefined1 **)(param_2 + 0x58) = 0;
  cVar2 = (**(code **)(iVar1 + 0xc))
                    (*(undefined4 *)(iVar5 + 0x10c),pbVar3,*(undefined4 *)(param_2 + 0x58),
                     *(undefined4 *)(param_2 + 0x54),(undefined4 *)(param_2 + 0x4c),
                     -(uint)(*(int *)(iVar1 + 8) != 0) & (uint)local_f3c,
                     -(uint)(*(int *)(iVar1 + 8) != 0) & 0xf3c);
  if (*(int *)(iVar1 + 8) == 0) goto LAB_10025218;
  if (cVar2 != '\0') {
    if (*(int *)(iVar1 + 8) != 1) {
LAB_1002513d:
      pbVar8 = &DAT_10039247;
      iVar5 = 0x20;
      pbVar4 = abStack_179c;
      pbVar3 = FUN_10002000(pbVar3,&DAT_1003a25c);
      FUN_100030f0(pbVar3,pbVar4,iVar5,pbVar8);
      if (abStack_179c[0] != 0) {
        FUN_10002620(local_f3c,0xf3c,&DAT_1003a25c,abStack_179c);
      }
      FUN_10018470(*(SOCKET **)(param_1 + 0x1960),0x2a707574,0,(char *)local_f3c,(char *)0xffffffff)
      ;
      goto LAB_10025218;
    }
    if (iVar7 != 0) {
      iVar5 = FUN_10019c70((char *)local_17ac,(char *)(iVar7 + 0x20));
      if (iVar5 == 0) goto LAB_1002513d;
    }
  }
  iVar5 = -1;
  pbVar3 = FUN_10002000(local_f3c,&DAT_1003c564);
  iVar5 = FUN_10002e80(pbVar3,iVar5);
  if ((iVar5 != -1) && (local_17ac[0] != 0)) {
    FUN_10002c50(abStack_177c,(byte *)0x40,(byte *)"PERS=%s LOCK=%d");
    FUN_10018470(*(SOCKET **)(param_1 + 0x1960),0x2a756c6b,0,(char *)abStack_177c,(char *)0xffffffff
                );
  }
LAB_10025218:
  *(uint *)(param_2 + 0x50) = -(uint)(**(char **)(param_2 + 0x58) != '\0');
  return 0;
}



char __cdecl FUN_10025240(undefined4 param_1,int param_2,int param_3)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  
  cVar4 = '\0';
  piVar2 = (int *)(*(code *)PTR_FUN_10041404)();
  if ((piVar2 != (int *)0x0) && (*piVar2 != 0)) {
    do {
      if (cVar4 != '\0') {
        return cVar4;
      }
      if (*piVar2 == *(int *)(param_2 + 100)) {
        *(code **)(param_2 + 0x20) = FUN_10024f50;
        *(undefined4 *)(param_2 + 0x2c) = 0;
        iVar3 = *(int *)(param_2 + 0x68);
        if (-1 < *(int *)(param_2 + 0x68)) {
          iVar3 = *(int *)(param_2 + 100);
        }
        *(int *)(param_2 + 0x48) = iVar3;
        *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
        **(undefined1 **)(param_2 + 0x58) = 0;
        *(int **)(param_3 + 0x480) = piVar2;
        cVar4 = '\x01';
      }
      piVar1 = piVar2 + 4;
      piVar2 = piVar2 + 4;
    } while (*piVar1 != 0);
    return cVar4;
  }
  return '\0';
}



void __cdecl FUN_100252b0(byte *param_1,int param_2)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  size_t _Count;
  byte *_Dest;
  byte abStack_400 [1024];
  
  piVar2 = (int *)(*(code *)PTR_FUN_10041404)();
  if (piVar2 != (int *)0x0) {
    abStack_400[0] = 0;
    _Dest = abStack_400;
    _Count = 0x400;
    iVar3 = *piVar2;
    while (iVar3 != 0) {
      if ((char)piVar2[1] != '\0') {
        iVar3 = __snprintf((char *)_Dest,_Count,"%d,%d:",iVar3,piVar2[2]);
        _Dest = _Dest + iVar3;
        _Count = (int)&stack0x00000000 - (int)_Dest;
      }
      piVar1 = piVar2 + 4;
      piVar2 = piVar2 + 4;
      iVar3 = *piVar1;
    }
    FUN_10002620(param_1,param_2,(byte *)"CUSTCMDS",abStack_400);
  }
  return;
}



undefined4 * __cdecl FUN_10025340(int param_1,int param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int *piVar3;
  undefined4 *puVar4;
  int iVar5;
  int *piVar6;
  
  iVar1 = *(int *)(param_1 + 0x172c);
  puVar2 = (undefined4 *)FUN_100189f0(*(int *)(iVar1 + 0x110),param_2);
  if (puVar2 == (undefined4 *)0x0) {
    piVar3 = (int *)FUN_1001a190(*(int *)(param_1 + 0x171c),param_2);
    if ((piVar3 != (int *)0x0) && ((piVar3[1] & 0x80000U) != 0)) {
      puVar4 = FUN_10019ad0(*(undefined4 *)(iVar1 + 0x114),0x29f0);
      puVar2 = puVar4;
      for (iVar5 = 0xa7c; iVar5 != 0; iVar5 = iVar5 + -1) {
        *puVar2 = 0;
        puVar2 = puVar2 + 1;
      }
      piVar6 = puVar4 + 0x93b;
      for (iVar5 = 0x13e; iVar5 != 0; iVar5 = iVar5 + -1) {
        *piVar6 = *piVar3;
        piVar3 = piVar3 + 1;
        piVar6 = piVar6 + 1;
      }
      puVar4[0x939] = puVar4[0x962];
      puVar4[0x991] = 0;
      puVar4[1] = *(int *)(iVar1 + 4) * 1000 + *(int *)(param_1 + 0x1944);
      FUN_10018940(*(int **)(iVar1 + 0x110),puVar4[0x93b],(int)puVar4);
      FUN_1000cd80(param_1,0x40000,(char *)0x0,"QUEUE: %d for reporting");
      return puVar4;
    }
  }
  return puVar2;
}



void __cdecl FUN_10025c00(int param_1,int param_2,int param_3,char param_4)

{
  bool bVar1;
  undefined4 *puVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int *piVar6;
  char *pcVar7;
  int *piVar8;
  int local_8;
  
  iVar5 = *(int *)(param_1 + 0x172c);
  bVar1 = false;
  puVar2 = FUN_10025340(param_1,param_3);
  if (puVar2 != (undefined4 *)0x0) {
    iVar3 = puVar2[0x994];
    puVar2[0x994] = iVar3 + 1;
    if ((int)puVar2[0x962] <= iVar3 + 1) {
      iVar3 = *(int *)(param_1 + 0x1944) + *(int *)(iVar5 + 0x130);
      puVar2[1] = iVar3;
      puVar2[0x993] = iVar3;
    }
    piVar4 = (int *)FUN_1001a190(*(int *)(param_1 + 0x171c),param_3);
    if (piVar4 != (int *)0x0) {
      if ((int)puVar2[0x994] < 2) {
        if ((piVar4[1] & 0x40U) == 0) {
          FUN_10022650(param_1,piVar4,'\0',(int *)0x0);
        }
        else {
          piVar4[1] = piVar4[1] & 0xfff7ffffU | 0x1000;
          piVar4[0x57] = *(int *)(param_1 + 0x1944) + *(int *)(iVar5 + 0x134);
          piVar4[0x58] = 0;
          piVar6 = piVar4 + 0x6e;
          for (iVar5 = 0xd0; iVar5 != 0; iVar5 = iVar5 + -1) {
            *piVar6 = 0;
            piVar6 = piVar6 + 1;
          }
          piVar4[0x27] = 0;
          piVar4[0x24] = -1;
          bVar1 = true;
        }
      }
      if (((((*(byte *)(puVar2 + 0x93c) & 0x40) != 0) && (param_4 == '\0')) &&
          (piVar4[0x27] < piVar4[0x25])) && (local_8 = 0, 0 < (int)puVar2[0x962])) {
        pcVar7 = (char *)(puVar2 + 0x9a9);
LAB_10025d30:
        iVar5 = FUN_10019c70((char *)(param_2 + 0x20),pcVar7);
        if (iVar5 != 0) goto code_r0x10025d46;
        piVar6 = puVar2 + local_8 * 0x1a + 0x9a9;
        piVar8 = piVar4 + piVar4[0x27] * 0x1a + 0x6e;
        for (iVar5 = 0x1a; iVar5 != 0; iVar5 = iVar5 + -1) {
          *piVar8 = *piVar6;
          piVar6 = piVar6 + 1;
          piVar8 = piVar8 + 1;
        }
        if (puVar2[0x95f] == local_8) {
          piVar4[0x24] = piVar4[0x27];
        }
        piVar4[0x27] = piVar4[0x27] + 1;
        *(undefined4 *)(param_2 + 0x34) = puVar2[0x93b];
        goto LAB_10025d60;
      }
LAB_10025d58:
      if (bVar1) {
LAB_10025d60:
        FUN_1001a010(*(int *)(param_1 + 0x171c),*piVar4);
      }
    }
  }
  return;
code_r0x10025d46:
  local_8 = local_8 + 1;
  pcVar7 = pcVar7 + 0x68;
  if ((int)puVar2[0x962] <= local_8) goto LAB_10025d58;
  goto LAB_10025d30;
}



undefined4 __cdecl FUN_10025de0(int param_1,int param_2)

{
  bool bVar1;
  byte *pbVar2;
  uint *puVar3;
  uint uVar4;
  byte *pbVar5;
  uint *puVar6;
  uint *puVar7;
  undefined4 uVar8;
  uint *puVar9;
  uint *puVar10;
  int iVar11;
  int iVar12;
  byte *pbVar13;
  char *pcVar14;
  uint local_1b8 [2];
  byte local_1b0 [36];
  byte local_18c [32];
  byte local_16c [20];
  byte local_158 [132];
  int local_d4;
  undefined4 local_cc;
  uint local_c8;
  uint auStack_38 [13];
  
  iVar12 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar12 = FUN_10002e80(pbVar2,iVar12);
  puVar3 = (uint *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar12);
  if (puVar3 == (uint *)0x0) {
    return 0;
  }
  uVar4 = puVar3[0xfd];
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLPING");
  uVar4 = FUN_10002e80(pbVar2,uVar4);
  puVar3[0xfd] = uVar4;
  if ((puVar3[2] & 0x10) != 0) {
    iVar12 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar12) {
      iVar12 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar12;
    *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  iVar12 = FUN_1001a1d0(*(int *)(param_1 + 0x15f8));
  if (*(int *)(param_1 + 0x15f0) < iVar12) {
    iVar12 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar12) {
      iVar12 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar12;
    *(undefined4 *)(param_2 + 0x4c) = 0x66756c6c;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  pbVar13 = &DAT_10039247;
  iVar11 = 0x24;
  pbVar2 = local_1b0;
  puVar9 = local_1b8;
  for (iVar12 = 0x6b; iVar12 != 0; iVar12 = iVar12 + -1) {
    *puVar9 = 0;
    puVar9 = puVar9 + 1;
  }
  pbVar5 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar5,pbVar2,iVar11,pbVar13);
  pbVar5 = &DAT_10039247;
  iVar12 = 0x14;
  pbVar2 = local_16c;
  pbVar13 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a74c);
  FUN_100030f0(pbVar13,pbVar2,iVar12,pbVar5);
  puVar9 = puVar3 + 8;
  puVar6 = puVar9;
  do {
    uVar4 = *puVar6;
    (local_18c + -(int)puVar9)[(int)puVar6] = (byte)uVar4;
    puVar6 = (uint *)((int)puVar6 + 1);
  } while ((byte)uVar4 != 0);
  local_c8 = puVar3[0x101];
  pbVar5 = &DAT_10039247;
  iVar12 = 0x84;
  pbVar2 = local_158;
  pbVar13 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a1b0);
  FUN_100030f0(pbVar13,pbVar2,iVar12,pbVar5);
  uVar4 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"FLAGS");
  local_1b8[1] = FUN_10002ed0((char *)pbVar2,uVar4);
  iVar12 = 0x19;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003e430);
  local_d4 = FUN_10002e80(pbVar2,iVar12);
  iVar12 = 0;
  local_cc = 0xf;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"IGNEXIST");
  iVar12 = FUN_10002e80(pbVar2,iVar12);
  iVar11 = 0;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"IGNPROFNAME");
  iVar11 = FUN_10002e80(pbVar2,iVar11);
  if (iVar11 == 0) {
    FUN_10019870(*(undefined4 *)(param_1 + 0x1c78),local_1b0);
    iVar11 = FUN_100195a0(*(int **)(param_1 + 0x1c78),local_1b0);
    if ((0 < iVar11) || (local_1b0[0] == 0)) {
      iVar12 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar12) {
        iVar12 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar12;
      *(undefined4 *)(param_2 + 0x4c) = 0x66696c74;
      *(undefined4 *)(param_2 + 0x50) = 0;
      return 0;
    }
  }
  uVar4 = local_1b8[1] | 8;
  if (local_16c[0] != 0) {
    uVar4 = local_1b8[1] | 0x10008;
  }
  local_1b8[1] = uVar4;
  if (local_d4 < 2) {
    local_d4 = 2;
  }
  else if (999 < local_d4) {
    local_d4 = 999;
  }
  if (((puVar3[2] & 0x2002) != 0) && (iVar11 = __stricmp((char *)local_16c,"$invis$"), iVar11 == 0))
  {
    local_1b8[1] = local_1b8[1] & 0xfffeffff | 0x200;
    local_16c[0] = 0;
  }
  (*(code *)PTR_FUN_10041414)
            (*(undefined4 *)(*(int *)(param_1 + 0x172c) + 0x10c),*(undefined4 *)(param_2 + 0x74),
             puVar3,local_1b8);
  uVar4 = FUN_1002b420(auStack_38,puVar3 + 0x129);
  if (uVar4 != 0) {
    puVar6 = (uint *)FUN_10018890(local_1b0,*(int *)(param_1 + 0x15f4),local_1b0);
    if (puVar6 == (uint *)0x0) {
      bVar1 = false;
      puVar6 = (uint *)_malloc(0x1ac);
      puVar7 = local_1b8;
      puVar10 = puVar6;
      for (iVar12 = 0x6b; iVar12 != 0; iVar12 = iVar12 + -1) {
        *puVar10 = *puVar7;
        puVar7 = puVar7 + 1;
        puVar10 = puVar10 + 1;
      }
      FUN_10018820(puVar6 + 2,*(int **)(param_1 + 0x15f4),(byte *)(puVar6 + 2),(int)puVar6);
      uVar4 = FUN_10019f50(*(int **)(param_1 + 0x15f8),0,puVar6);
      *puVar6 = uVar4;
      FUN_100123b0(*(char **)(param_1 + 0x8d7c),"~\'%s\' created room \'%s\'",(byte *)puVar9);
    }
    else {
      bVar1 = true;
      if (iVar12 == 0) {
        iVar12 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar12) {
          iVar12 = *(int *)(param_2 + 100);
        }
        *(int *)(param_2 + 0x48) = iVar12;
        *(undefined4 *)(param_2 + 0x4c) = 0x6475706c;
        *(undefined4 *)(param_2 + 0x50) = 0;
        return 0;
      }
    }
    puVar7 = (uint *)FUN_1001a190(*(int *)(param_1 + 0x15f8),puVar3[0xc]);
    if ((puVar7 != (uint *)0x0) && (puVar7[0x3a] = puVar7[0x3a] - 1, 0 < *(int *)(param_1 + 0x15fc))
       ) {
      FUN_1000ca40(param_1,*puVar3,*puVar7,8,(char *)puVar9,"has left the room");
    }
    puVar6[0x3a] = puVar6[0x3a] + 1;
    puVar3[0xc] = *puVar6;
    FUN_1001a010(*(int *)(param_1 + 0x1608),*puVar3);
    if (0 < *(int *)(param_1 + 0x15fc)) {
      if (bVar1) {
        pcVar14 = "has entered the room";
      }
      else {
        pcVar14 = "has created the room";
      }
      FUN_1000ca40(param_1,0,*puVar6,8,(char *)puVar9,pcVar14);
    }
    **(undefined1 **)(param_2 + 0x58) = 0;
    FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"IDENT",*puVar6);
    FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b60,
                 (byte *)(puVar6 + 2));
    FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a75c,
                 (byte *)(puVar6 + 0xb));
    FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a1b0,
                 (byte *)(puVar6 + 0x18));
    FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"COUNT",puVar6[0x3a]);
    FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"LIMIT",puVar6[0x39]);
    FUN_100023e0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"FLAGS",puVar6[1]);
    FUN_10002880(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a730,puVar6 + 0x60,
                 0x2c,&DAT_1003a738);
    uVar8 = FUN_1000c9b0(param_2);
    return uVar8;
  }
  iVar12 = *(int *)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if (-1 < iVar12) {
    iVar12 = *(int *)(param_2 + 100);
  }
  *(int *)(param_2 + 0x48) = iVar12;
  *(undefined4 *)(param_2 + 0x4c) = 0x72617574;
  *(undefined4 *)(param_2 + 0x50) = 0;
  return 0;
}



undefined4 __cdecl FUN_10026370(int param_1,int param_2)

{
  byte *pbVar1;
  int iVar2;
  byte *pbVar3;
  int *_Memory;
  undefined4 uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  byte local_20 [32];
  
  iVar7 = 0;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar7 = FUN_10002e80(pbVar1,iVar7);
  iVar7 = FUN_1001a190(*(int *)(param_1 + 0x1608),iVar7);
  if (iVar7 != 0) {
    iVar2 = *(int *)(iVar7 + 0x3f4);
    pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLPING");
    iVar2 = FUN_10002e80(pbVar1,iVar2);
    pbVar8 = &DAT_10039247;
    iVar6 = 0x20;
    pbVar1 = local_20;
    *(int *)(iVar7 + 0x3f4) = iVar2;
    pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
    FUN_100030f0(pbVar3,pbVar1,iVar6,pbVar8);
    _Memory = (int *)FUN_10018890(*(void **)(param_1 + 0x15f4),(int)*(void **)(param_1 + 0x15f4),
                                  local_20);
    if (_Memory == (int *)0x0) {
      iVar7 = *(int *)(param_2 + 0x68);
      *(undefined4 *)(param_2 + 0x20) = 0;
      if (-1 < iVar7) {
        iVar7 = *(int *)(param_2 + 100);
      }
      *(int *)(param_2 + 0x48) = iVar7;
      *(undefined4 *)(param_2 + 0x50) = 0;
      *(undefined4 *)(param_2 + 0x4c) = 0x75726f6d;
      return 0;
    }
    uVar5 = *(uint *)(iVar7 + 8) & 0x2002;
    iVar2 = FUN_10019c70((char *)(iVar7 + 0x20),(char *)(_Memory + 0xb));
    if (iVar2 == 0) {
      uVar5 = uVar5 | 0x100;
    }
    FUN_10019c70((char *)(iVar7 + 0x20),(char *)(_Memory + 0xf));
    if (uVar5 != 0) {
      _sprintf(*(char **)(param_2 + 0x58),"KILL=\'%s\'",_Memory + 2);
      FUN_1001a0d0(*(int *)(param_1 + 0x15f8),*_Memory);
      FUN_100188e0(*(void **)(param_1 + 0x15f4),(int *)*(void **)(param_1 + 0x15f4),
                   (byte *)(_Memory + 2));
      _free(_Memory);
      uVar4 = FUN_1000c9b0(param_2);
      return uVar4;
    }
    iVar7 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar7) {
      iVar7 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar7;
    *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
    *(undefined4 *)(param_2 + 0x50) = 0;
  }
  return 0;
}



undefined4 __cdecl FUN_100264f0(void *param_1,uint param_2)

{
  uint *puVar1;
  byte bVar2;
  uint uVar3;
  byte *pbVar4;
  int iVar5;
  byte *pbVar6;
  uint *puVar7;
  int *piVar8;
  int *piVar9;
  uint uVar10;
  undefined4 uVar11;
  void *this;
  int *piVar12;
  int iVar13;
  int iVar14;
  byte *pbVar15;
  byte local_20 [32];
  
  uVar3 = param_2;
  iVar14 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar14 = FUN_10002e80(pbVar4,iVar14);
  iVar14 = FUN_1001a190(*(int *)((int)param_1 + 0x1608),iVar14);
  if (iVar14 == 0) {
    iVar14 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar14) {
      iVar14 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar14;
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  iVar5 = *(int *)(iVar14 + 0x3f4);
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLPING");
  iVar5 = FUN_10002e80(pbVar4,iVar5);
  pbVar15 = &DAT_10039247;
  iVar13 = 0x20;
  pbVar4 = local_20;
  *(int *)(iVar14 + 0x3f4) = iVar5;
  pbVar6 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar6,pbVar4,iVar13,pbVar15);
  puVar7 = (uint *)FUN_10018890(*(void **)((int)param_1 + 0x15f4),
                                (int)*(void **)((int)param_1 + 0x15f4),local_20);
  if (local_20[0] == 0x23) {
    puVar7 = (uint *)FUN_1001a190(*(int *)((int)param_1 + 0x15f8),*(int *)(iVar14 + 0x30));
  }
  if (puVar7 == (uint *)0x0) {
    iVar14 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar14) {
      iVar14 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar14;
    *(undefined4 *)(param_2 + 0x4c) = 0x75726f6d;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  param_2 = *(uint *)(iVar14 + 8) & 0x2002;
  iVar5 = FUN_10019c70((char *)(iVar14 + 0x20),(char *)(puVar7 + 0xb));
  if (iVar5 == 0) {
    param_2 = param_2 | 0x100;
  }
  iVar14 = FUN_10019c70((char *)(iVar14 + 0x20),(char *)(puVar7 + 0xf));
  if (iVar14 == 0) {
    param_2 = param_2 | 0x400000;
  }
  if (param_2 != 0) {
    pbVar15 = (byte *)0x0;
    iVar14 = 0x20;
    pbVar4 = local_20;
    pbVar6 = FUN_10002000(*(byte **)(uVar3 + 0x74),&DAT_1003a74c);
    iVar14 = FUN_100030f0(pbVar6,pbVar4,iVar14,pbVar15);
    if (-1 < iVar14) {
      if ((char)(param_2 >> 8) == '\0') goto LAB_100269b9;
      pbVar4 = local_20;
      iVar14 = (int)(puVar7 + 0x13) - (int)pbVar4;
      do {
        bVar2 = *pbVar4;
        pbVar4[iVar14] = bVar2;
        pbVar4 = pbVar4 + 1;
      } while (bVar2 != 0);
      uVar10 = puVar7[1];
      puVar7[1] = uVar10 | 0x10000;
      if ((char)puVar7[0x13] == '\0') {
        puVar7[1] = (uVar10 | 0x10000) ^ 0x10000;
      }
    }
    pbVar15 = (byte *)0x0;
    iVar14 = 0x20;
    pbVar4 = local_20;
    pbVar6 = FUN_10002000(*(byte **)(uVar3 + 0x74),&DAT_1003a75c);
    iVar14 = FUN_100030f0(pbVar6,pbVar4,iVar14,pbVar15);
    if (-1 < iVar14) {
      if ((param_2 & 0x2100) == 0) goto LAB_100269b9;
      if (((char)param_2 == '\0') || (local_20[0] != 0x23)) {
        piVar8 = (int *)FUN_10018890(*(void **)((int)param_1 + 0x1604),
                                     (int)*(void **)((int)param_1 + 0x1604),local_20);
        if (piVar8 == (int *)0x0) {
          iVar14 = *(int *)(uVar3 + 0x68);
          *(undefined4 *)(uVar3 + 0x20) = 0;
          if (-1 < iVar14) {
            iVar14 = *(int *)(uVar3 + 100);
          }
          *(int *)(uVar3 + 0x48) = iVar14;
          *(undefined4 *)(uVar3 + 0x4c) = 0x75757372;
          *(undefined4 *)(uVar3 + 0x50) = 0;
          return 0;
        }
        piVar12 = piVar8 + 8;
        iVar14 = FUN_10019c70((char *)(puVar7 + 0xb),(char *)piVar12);
        if (iVar14 == 0) {
          iVar14 = *(int *)(uVar3 + 0x68);
          *(undefined4 *)(uVar3 + 0x20) = 0;
          if (-1 < iVar14) {
            iVar14 = *(int *)(uVar3 + 100);
          }
          *(int *)(uVar3 + 0x48) = iVar14;
          *(undefined4 *)(uVar3 + 0x4c) = 0x73616d65;
          *(undefined4 *)(uVar3 + 0x50) = 0;
          return 0;
        }
        piVar9 = (int *)FUN_10018890(this,*(int *)((int)param_1 + 0x1604),(byte *)(puVar7 + 0xb));
        if (piVar9 != (int *)0x0) {
          FUN_1001a010(*(int *)((int)param_1 + 0x1608),*piVar9);
        }
        piVar9 = piVar12;
        do {
          iVar14 = *piVar9;
          *(char *)((int)puVar7 + (0x2c - (int)piVar12) + (int)piVar9) = (char)iVar14;
          piVar9 = (int *)((int)piVar9 + 1);
        } while ((char)iVar14 != '\0');
        puVar7[0x3c] = piVar8[0x101];
        FUN_1001a010(*(int *)((int)param_1 + 0x1608),*piVar8);
        FUN_1000ca40((int)param_1,0,*puVar7,8,(char *)piVar12,"is now the room host");
      }
      else {
        pbVar4 = local_20 + 1;
        iVar14 = 0x2c - (int)pbVar4;
        do {
          bVar2 = *pbVar4;
          pbVar4[(int)puVar7 + iVar14] = bVar2;
          pbVar4 = pbVar4 + 1;
        } while (bVar2 != 0);
        puVar7[0x3c] = 0;
      }
    }
    pbVar15 = (byte *)0x0;
    iVar14 = 0x20;
    pbVar4 = local_20;
    pbVar6 = FUN_10002000(*(byte **)(uVar3 + 0x74),&DAT_1003a754);
    iVar14 = FUN_100030f0(pbVar6,pbVar4,iVar14,pbVar15);
    if (-1 < iVar14) {
      if ((param_2 & 0x402100) == 0) goto LAB_100269b9;
      piVar8 = (int *)FUN_10018890(param_1,*(int *)((int)param_1 + 0x1604),local_20);
      if (piVar8 == (int *)0x0) {
        iVar14 = *(int *)(uVar3 + 0x68);
        *(undefined4 *)(uVar3 + 0x20) = 0;
        if (-1 < iVar14) {
          iVar14 = *(int *)(uVar3 + 100);
        }
        *(undefined4 *)(uVar3 + 0x50) = 0;
        *(int *)(uVar3 + 0x48) = iVar14;
        *(undefined4 *)(uVar3 + 0x4c) = 0x75757372;
        return 0;
      }
      piVar12 = piVar8 + 8;
      puVar1 = puVar7 + 0xf;
      iVar14 = FUN_10019c70((char *)puVar1,(char *)piVar12);
      if (iVar14 == 0) {
        iVar14 = *(int *)(uVar3 + 0x68);
        *(undefined4 *)(uVar3 + 0x20) = 0;
        if (-1 < iVar14) {
          iVar14 = *(int *)(uVar3 + 100);
        }
        *(int *)(uVar3 + 0x48) = iVar14;
        *(undefined4 *)(uVar3 + 0x4c) = 0x73656c66;
        *(undefined4 *)(uVar3 + 0x50) = 0;
        return 0;
      }
      piVar9 = (int *)FUN_10018890(*(void **)((int)param_1 + 0x1604),
                                   (int)*(void **)((int)param_1 + 0x1604),(byte *)puVar1);
      if (piVar9 != (int *)0x0) {
        FUN_1001a010(*(int *)((int)param_1 + 0x1608),*piVar9);
      }
      piVar9 = piVar12;
      do {
        iVar14 = *piVar9;
        *(char *)(((int)puVar1 - (int)piVar12) + (int)piVar9) = (char)iVar14;
        piVar9 = (int *)((int)piVar9 + 1);
      } while ((char)iVar14 != '\0');
      FUN_1001a010(*(int *)((int)param_1 + 0x1608),*piVar8);
      FUN_1000ca40((int)param_1,0,*puVar7,8,(char *)piVar12,"is now the assistant room host");
    }
    pbVar15 = (byte *)0x0;
    iVar14 = 0x20;
    pbVar4 = local_20;
    pbVar6 = FUN_10002000(*(byte **)(uVar3 + 0x74),(byte *)"PERSIST");
    iVar14 = FUN_100030f0(pbVar6,pbVar4,iVar14,pbVar15);
    if (-1 < iVar14) {
      if ((param_2 & 0x2000) == 0) goto LAB_100269b9;
      puVar7[0x3b] = (local_20[0] != 0x30) - 1 & 0xf;
    }
    pbVar15 = (byte *)0x0;
    iVar14 = 0x20;
    pbVar4 = local_20;
    pbVar6 = FUN_10002000(*(byte **)(uVar3 + 0x74),(byte *)"LIMIT");
    iVar14 = FUN_100030f0(pbVar6,pbVar4,iVar14,pbVar15);
    if (-1 < iVar14) {
      if ((param_2 & 0x2000) == 0) goto LAB_100269b9;
      uVar10 = _atol((char *)local_20);
      puVar7[0x39] = uVar10;
      if ((int)uVar10 < 1) {
        puVar7[0x39] = 1;
      }
      if (1000 < (int)puVar7[0x39]) {
        puVar7[0x39] = 1000;
      }
    }
    FUN_1001a010(*(int *)((int)param_1 + 0x15f8),*puVar7);
    *(undefined4 *)(uVar3 + 0x50) = 0;
    uVar11 = FUN_1000c9b0(uVar3);
    return uVar11;
  }
LAB_100269b9:
  iVar14 = *(int *)(uVar3 + 0x68);
  *(undefined4 *)(uVar3 + 0x20) = 0;
  if (-1 < iVar14) {
    iVar14 = *(int *)(uVar3 + 100);
  }
  *(undefined4 *)(uVar3 + 0x50) = 0;
  *(int *)(uVar3 + 0x48) = iVar14;
  *(undefined4 *)(uVar3 + 0x4c) = 0x61757468;
  return 0;
}



undefined4 __cdecl FUN_10026dd0(int param_1,int param_2)

{
  char *pcVar1;
  byte bVar2;
  int iVar3;
  byte *pbVar4;
  uint *puVar5;
  uint *puVar6;
  byte *pbVar7;
  undefined4 uVar8;
  uint *puVar9;
  char cVar10;
  uint *puVar11;
  undefined1 *puVar12;
  uint *puVar13;
  bool bVar14;
  int iVar15;
  byte *pbVar16;
  byte local_20 [32];
  
  iVar15 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar15 = FUN_10002e80(pbVar4,iVar15);
  puVar5 = (uint *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar15);
  if (puVar5 == (uint *)0x0) {
    iVar15 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar15;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    return 0;
  }
  puVar6 = (uint *)FUN_1001a190(*(int *)(param_1 + 0x15f8),puVar5[0xc]);
  if (puVar6 == (uint *)0x0) {
    iVar15 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar15;
    *(undefined4 *)(param_2 + 0x4c) = 0x6e726f6d;
    return 0;
  }
  puVar13 = puVar5 + 8;
  iVar15 = FUN_10019c70((char *)puVar13,(char *)(puVar6 + 0xb));
  if (((iVar15 != 0) && (iVar15 = FUN_10019c70((char *)puVar13,(char *)(puVar6 + 0xf)), iVar15 != 0)
      ) && ((puVar5[2] & 0x2000) == 0)) {
    iVar15 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar15;
    *(undefined4 *)(param_2 + 0x4c) = 0x61757468;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  pbVar16 = &DAT_10039247;
  iVar15 = 0x20;
  pbVar4 = local_20;
  pbVar7 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b70);
  FUN_100030f0(pbVar7,pbVar4,iVar15,pbVar16);
  iVar15 = 2;
  bVar14 = true;
  pbVar4 = local_20;
  pbVar7 = &DAT_1003e4d0;
  do {
    if (iVar15 == 0) break;
    iVar15 = iVar15 + -1;
    bVar14 = *pbVar4 == *pbVar7;
    pbVar4 = pbVar4 + 1;
    pbVar7 = pbVar7 + 1;
  } while (bVar14);
  if (bVar14) {
    **(undefined1 **)(param_2 + 0x58) = 0;
    FUN_10002620(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a744,
                 (byte *)(puVar6 + 0x3f));
    uVar8 = FUN_1000c9b0(param_2);
    return uVar8;
  }
  if (local_20[0] == 0x2d) {
    pbVar4 = local_20;
    do {
      pbVar4 = pbVar4 + 1;
      pbVar4[-1] = *pbVar4;
    } while (*pbVar4 != 0);
    puVar13 = puVar6 + 0x3f;
    bVar2 = (byte)*puVar13;
    puVar5 = puVar13;
    while( true ) {
      if (bVar2 == 0) {
        iVar15 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar15) {
          iVar15 = *(int *)(param_2 + 100);
        }
        *(int *)(param_2 + 0x48) = iVar15;
        *(undefined4 *)(param_2 + 0x4c) = 0x6e6b696b;
        *(undefined4 *)(param_2 + 0x50) = 0;
        return 0;
      }
      iVar15 = 0;
      if (local_20[0] == bVar2) {
        do {
          iVar3 = iVar15 + 1;
          iVar15 = iVar15 + 1;
        } while (local_20[iVar3] == *(byte *)((int)puVar5 + iVar15));
      }
      if (((local_20[iVar15] == 0) && (*(char *)(iVar15 + (int)puVar5) == '/')) &&
         ((puVar5 == puVar13 || (*(char *)((int)puVar5 + -1) == '/')))) break;
      bVar2 = *(byte *)((int)puVar5 + 1);
      puVar5 = (uint *)((int)puVar5 + 1);
    }
    puVar12 = (undefined1 *)(iVar15 + 1 + (int)puVar5);
    cVar10 = *(char *)(iVar15 + 1 + (int)puVar5);
    while (cVar10 != '\0') {
      *(char *)puVar5 = cVar10;
      pcVar1 = puVar12 + 1;
      puVar5 = (uint *)((int)puVar5 + 1);
      puVar12 = puVar12 + 1;
      cVar10 = *pcVar1;
    }
    *(undefined1 *)puVar5 = 0;
    FUN_1001a010(*(int *)(param_1 + 0x15f8),*puVar6);
    uVar8 = FUN_1000c9b0(param_2);
    return uVar8;
  }
  puVar9 = (uint *)FUN_10018890(local_20,*(int *)(param_1 + 0x1604),local_20);
  if (puVar9 == (uint *)0x0) {
    iVar15 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar15;
    *(undefined4 *)(param_2 + 0x4c) = 0x75757372;
    return 0;
  }
  if (puVar5 == puVar9) {
    iVar15 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar15;
    *(undefined4 *)(param_2 + 0x4c) = 0x73656c66;
    return 0;
  }
  iVar15 = FUN_10019c70((char *)(puVar9 + 8),(char *)puVar13);
  if ((iVar15 == 0) && ((puVar5[2] & 0x2000) == 0)) {
    iVar15 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar15) {
      iVar15 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar15;
    *(undefined4 *)(param_2 + 0x4c) = 0x6b696b68;
    return 0;
  }
  cVar10 = (char)puVar6[0x3f];
  puVar5 = puVar6 + 0x3f;
  if (cVar10 != '\0') {
    do {
      iVar15 = 0;
      if ((char)puVar9[8] == cVar10) {
        do {
          iVar3 = iVar15 + 0x21;
          iVar15 = iVar15 + 1;
        } while (*(char *)((int)puVar9 + iVar3) == *(char *)(iVar15 + (int)puVar5));
      }
      if (((*(char *)((int)puVar9 + iVar15 + 0x20) == '\0') &&
          (*(char *)(iVar15 + (int)puVar5) == '/')) &&
         ((puVar5 == puVar6 + 0x3f || (*(char *)((int)puVar5 + -1) == '/')))) {
        puVar12 = (undefined1 *)(iVar15 + 1 + (int)puVar5);
        cVar10 = *(char *)(iVar15 + 1 + (int)puVar5);
        while (cVar10 != '\0') {
          *(char *)puVar5 = cVar10;
          pcVar1 = puVar12 + 1;
          puVar5 = (uint *)((int)puVar5 + 1);
          puVar12 = puVar12 + 1;
          cVar10 = *pcVar1;
        }
        *(undefined1 *)puVar5 = 0;
        break;
      }
      cVar10 = *(char *)((int)puVar5 + 1);
      puVar5 = (uint *)((int)puVar5 + 1);
    } while (cVar10 != '\0');
  }
  iVar15 = 0;
  cVar10 = (char)puVar9[8];
  while (cVar10 != '\0') {
    iVar3 = iVar15 + 0x21;
    iVar15 = iVar15 + 1;
    cVar10 = *(char *)((int)puVar9 + iVar3);
  }
  puVar12 = (undefined1 *)((int)puVar5 + ((iVar15 + -0xfa) - (int)puVar6));
  do {
    if ((int)puVar12 < 0x80) {
      puVar11 = puVar9 + 8;
      cVar10 = (char)puVar9[8];
      while (cVar10 != '\0') {
        *(char *)puVar5 = cVar10;
        pcVar1 = (char *)((int)puVar11 + 1);
        puVar5 = (uint *)((int)puVar5 + 1);
        puVar11 = (uint *)((int)puVar11 + 1);
        cVar10 = *pcVar1;
      }
      *(undefined1 *)puVar5 = 0x2f;
      *(undefined1 *)((int)puVar5 + 1) = 0;
      FUN_1001a010(*(int *)(param_1 + 0x15f8),*puVar6);
      if (puVar9[0xc] == *puVar6) {
        _sprintf(*(char **)(param_2 + 0x58),"You have been kicked out of the room by %s",puVar13);
        FUN_1000ca40(param_1,*puVar9,0,0,"Server",*(char **)(param_2 + 0x58));
        _sprintf(*(char **)(param_2 + 0x58),"has been kicked out of room by %s",puVar13);
        FUN_1000ca40(param_1,0,*puVar6,8,(char *)(puVar9 + 8),*(char **)(param_2 + 0x58));
        puVar6[0x3a] = puVar6[0x3a] - 1;
        puVar9[0xc] = 0;
        FUN_1001a010(*(int *)(param_1 + 0x1608),*puVar9);
      }
      *(undefined4 *)(param_2 + 0x50) = 0;
      uVar8 = FUN_1000c9b0(param_2);
      return uVar8;
    }
    puVar11 = puVar6 + 0x3f;
    cVar10 = (char)puVar6[0x3f];
    while (cVar10 != '\0') {
      if (cVar10 == '/') goto LAB_10027192;
      pcVar1 = (char *)((int)puVar11 + 1);
      puVar11 = (uint *)((int)puVar11 + 1);
      puVar12 = puVar12 + -1;
      cVar10 = *pcVar1;
    }
    if ((char)*puVar11 == '/') {
LAB_10027192:
      puVar11 = (uint *)((int)puVar11 + 1);
      puVar12 = puVar12 + -1;
    }
    puVar5 = puVar6 + 0x3f;
    cVar10 = (char)*puVar11;
    while (cVar10 != '\0') {
      *(char *)puVar5 = cVar10;
      pcVar1 = (char *)((int)puVar11 + 1);
      puVar5 = (uint *)((int)puVar5 + 1);
      puVar11 = (uint *)((int)puVar11 + 1);
      cVar10 = *pcVar1;
    }
    *(undefined1 *)puVar5 = 0;
  } while( true );
}



undefined4 __cdecl FUN_10027290(int param_1,int param_2)

{
  byte *pbVar1;
  int *piVar2;
  byte *pbVar3;
  undefined4 uVar4;
  int iVar5;
  byte *pbVar6;
  byte local_20 [32];
  
  iVar5 = 0;
  pbVar1 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"CALLUSER");
  iVar5 = FUN_10002e80(pbVar1,iVar5);
  piVar2 = (int *)FUN_1001a190(*(int *)(param_1 + 0x1608),iVar5);
  if (piVar2 == (int *)0x0) {
    *(undefined4 *)(param_2 + 0x20) = 0;
    iVar5 = *(int *)(param_2 + 0x68);
    if (-1 < iVar5) {
      iVar5 = *(int *)(param_2 + 100);
    }
    *(int *)(param_2 + 0x48) = iVar5;
    *(undefined4 *)(param_2 + 0x4c) = 0x6d617574;
    *(undefined4 *)(param_2 + 0x50) = 0;
    return 0;
  }
  pbVar6 = &DAT_10039247;
  iVar5 = 0x20;
  pbVar1 = local_20;
  pbVar3 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003e160);
  FUN_100030f0(pbVar3,pbVar1,iVar5,pbVar6);
  iVar5 = __stricmp((char *)local_20,"ON");
  if ((iVar5 == 0) && ((piVar2[2] & 0x10000U) != 0)) {
    piVar2[2] = piVar2[2] ^ 0x10000;
    FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar2);
  }
  iVar5 = __stricmp((char *)local_20,"OFF");
  if ((iVar5 == 0) && ((piVar2[2] & 0x10000U) == 0)) {
    piVar2[2] = piVar2[2] ^ 0x10000;
    FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar2);
  }
  **(undefined1 **)(param_2 + 0x58) = 0;
  FUN_10002310(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a68c,
               ~(uint)*(ushort *)((int)piVar2 + 10) & 1);
  *(undefined4 *)(param_2 + 0x50) = 0xffffffff;
  uVar4 = FUN_1000c9b0(param_2);
  return uVar4;
}



void FUN_100273d0(void)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  void *this;
  int unaff_ESI;
  int *local_8;
  int local_4;
  
  local_4 = 0;
  iVar3 = FUN_1001a1f0(*(int *)(unaff_ESI + 0x15f8),&local_4,&local_8);
  do {
    if (iVar3 == 0) {
      return;
    }
    if (local_8 != (int *)0x0) {
      this = (void *)local_8[0x3a];
      if ((0 < (int)this) && (this = (void *)local_8[0x3b], this != (void *)0x0)) {
        this = (void *)(*(int *)(unaff_ESI + 0x1944) + 20000);
        local_8[0x3b] = (int)this;
      }
      iVar3 = FUN_10018890(this,*(int *)(unaff_ESI + 0x1604),(byte *)(local_8 + 0xb));
      if ((iVar3 == 0) || (*(int *)(iVar3 + 0x3f4) == 0)) {
        if (local_8[0x3c] != 0) {
          local_8[0x3c] = 0;
          goto LAB_10027489;
        }
      }
      else if (local_8[0x3c] != *(int *)(iVar3 + 0x404)) {
        local_8[0x3c] = *(int *)(iVar3 + 0x404);
LAB_10027489:
        FUN_1001a010(*(int *)(unaff_ESI + 0x15f8),*local_8);
      }
      uVar1 = local_8[0x3b];
      if ((uVar1 != 0) &&
         (uVar2 = *(uint *)(unaff_ESI + 0x1944), uVar2 != uVar1 && -1 < (int)(uVar2 - uVar1))) {
        if (uVar1 < 0xe10) {
          local_8[0x3b] = uVar1 * 1000 + uVar2;
        }
        else if (local_8[0x5f] < 1) {
          FUN_100188e0(*(void **)(unaff_ESI + 0x15f4),(int *)*(void **)(unaff_ESI + 0x15f4),
                       (byte *)(local_8 + 2));
          FUN_1001a0d0(*(int *)(unaff_ESI + 0x15f8),*local_8);
          _free(local_8);
        }
      }
    }
    local_4 = local_4 + 1;
    iVar3 = FUN_1001a1f0(*(int *)(unaff_ESI + 0x15f8),&local_4,&local_8);
  } while( true );
}



void FUN_10027540(void)

{
  int iVar1;
  byte *pbVar2;
  int iVar3;
  int unaff_ESI;
  int *local_8;
  int local_4;
  
  local_4 = 1;
  iVar1 = FUN_1001a1f0(*(int *)(unaff_ESI + 0x171c),&local_4,&local_8);
  do {
    if (iVar1 < 1) {
      return;
    }
    if (local_8 != (int *)0x0) {
      iVar1 = local_8[0x57];
      if (iVar1 == 0) {
        iVar1 = FUN_10018890((void *)0x0,*(int *)(unaff_ESI + 0x15f4),(byte *)(local_8 + 3));
        if (local_8[0x24] < 0) {
          pbVar2 = &DAT_10039247;
        }
        else {
          pbVar2 = (byte *)(local_8 + local_8[0x24] * 0x1a + 0x6e);
        }
        iVar3 = FUN_10018890(*(void **)(unaff_ESI + 0x1604),(int)*(void **)(unaff_ESI + 0x1604),
                             pbVar2);
        if (((iVar1 == 0) || (iVar3 == 0)) ||
           (iVar1 = FUN_10019c70((char *)(iVar1 + 0x2c),(char *)(iVar3 + 0x20)), iVar1 != 0)) {
LAB_100275ee:
          FUN_10022650(unaff_ESI,local_8,'\x01',(int *)0x0);
        }
      }
      else if (*(int *)(unaff_ESI + 0x1944) != iVar1 && -1 < *(int *)(unaff_ESI + 0x1944) - iVar1)
      goto LAB_100275ee;
    }
    local_4 = local_4 + 1;
    iVar1 = FUN_1001a1f0(*(int *)(unaff_ESI + 0x171c),&local_4,&local_8);
  } while( true );
}



undefined4 __cdecl FUN_10028610(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  int *piVar8;
  bool bVar9;
  int local_18 [6];
  
  iVar3 = *(int *)(param_1 + 0x1944);
  if (iVar3 == *(int *)(param_1 + 0x1164fc0) || iVar3 - *(int *)(param_1 + 0x1164fc0) < 0) {
    return 0;
  }
  iVar4 = 0;
  iVar5 = 0;
  iVar7 = 0;
  *(int *)(param_1 + 0x1164fc0) = *(int *)(param_1 + 0x1164fbc) + iVar3;
  local_18[5] = 0;
  local_18[0] = 0;
  local_18[1] = 0;
  local_18[2] = 0;
  local_18[3] = 0;
  local_18[4] = 0;
  FUN_10018a80(*(int *)(param_1 + 0x1604));
  iVar3 = FUN_10018a90(*(int *)(param_1 + 0x1604),(undefined4 *)0x0);
  iVar1 = local_18[0];
  iVar2 = local_18[1];
  while (iVar3 != 0) {
    if (*(int *)(iVar3 + 0x404) == 0) {
      local_18[2] = local_18[2] + 1;
    }
    else if (*(int *)(iVar3 + 0x30) == 0) {
      iVar5 = iVar5 + 1;
    }
    else {
      iVar7 = iVar7 + 1;
    }
    iVar3 = FUN_10018a90(*(int *)(param_1 + 0x1604),(undefined4 *)0x0);
    iVar1 = iVar5;
    iVar2 = iVar7;
  }
  local_18[0] = iVar1;
  local_18[1] = iVar2;
  for (iVar3 = FUN_10019b70(*(int *)(param_1 + 0x1720)); iVar3 != 0;
      iVar3 = FUN_10019c60(*(undefined4 *)(param_1 + 0x1720),iVar3)) {
    if ((*(uint *)(iVar3 + 4) & 0x80000) == 0) {
      local_18[4] = local_18[4] + 1;
    }
    else {
      local_18[3] = local_18[3] + 1;
    }
  }
  iVar3 = FUN_10019b70(*(int *)(*(int *)(param_1 + 0x172c) + 0x114));
  iVar5 = local_18[5];
  while (iVar3 != 0) {
    iVar4 = iVar4 + 1;
    iVar3 = FUN_10019c60(*(undefined4 *)(*(int *)(param_1 + 0x172c) + 0x114),iVar3);
    iVar5 = iVar4;
  }
  local_18[5] = iVar5;
  FUN_10018a80(*(int *)(*(int *)(param_1 + 0x172c) + 0x110));
  iVar3 = FUN_10018a90(*(int *)(*(int *)(param_1 + 0x172c) + 0x110),(undefined4 *)0x0);
  if (iVar3 != 0) {
    do {
      iVar4 = iVar4 + 1;
      iVar3 = FUN_10018a90(*(int *)(*(int *)(param_1 + 0x172c) + 0x110),(undefined4 *)0x0);
    } while (iVar3 != 0);
    local_18[5] = iVar4;
  }
  iVar3 = 6;
  bVar9 = true;
  piVar6 = (int *)(param_1 + 0x1164fa0);
  piVar8 = local_18;
  do {
    if (iVar3 == 0) break;
    iVar3 = iVar3 + -1;
    bVar9 = *piVar6 == *piVar8;
    piVar6 = piVar6 + 1;
    piVar8 = piVar8 + 1;
  } while (bVar9);
  if (!bVar9) {
    *(int *)(param_1 + 0x1164fa0) = local_18[0];
    *(int *)(param_1 + 0x1164fa4) = local_18[1];
    *(int *)(param_1 + 0x1164fa8) = local_18[2];
    *(int *)(param_1 + 0x1164fac) = local_18[3];
    *(int *)(param_1 + 0x1164fb0) = local_18[4];
    *(int *)(param_1 + 0x1164fb4) = iVar4;
    *(int *)(param_1 + 0x1164fb8) = *(int *)(param_1 + 0x1164fb8) + 1;
  }
  return 0;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe

void __cdecl FUN_100287e0(int param_1,int param_2)

{
  bool bVar1;
  byte *pbVar2;
  int *piVar3;
  byte *pbVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  byte *pbVar8;
  byte local_115c [16];
  byte local_114c [16];
  byte local_113c [512];
  byte local_f3c [3896];
  undefined4 uStack_4;
  
  uStack_4 = 0x100287ea;
  pbVar8 = &DAT_10039247;
  iVar7 = 0x10;
  pbVar4 = local_114c;
  bVar1 = false;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b70);
  FUN_100030f0(pbVar2,pbVar4,iVar7,pbVar8);
  piVar3 = (int *)FUN_10018890(*(void **)(param_1 + 0x1604),(int)*(void **)(param_1 + 0x1604),
                               local_114c);
  pbVar8 = &DAT_10039247;
  iVar7 = 0x200;
  pbVar4 = local_113c;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"EDUSINP");
  FUN_100030f0(pbVar2,pbVar4,iVar7,pbVar8);
  FUN_100021b0(*(byte **)(param_2 + 0x74),(byte *)"EDUSINP");
  FUN_10002230((char *)local_f3c,0xf3c,*(char **)(param_2 + 0x74));
  pbVar4 = FUN_10002000(local_113c,(byte *)"MEDALS");
  if (pbVar4 != (byte *)0x0) {
    iVar7 = FUN_10002e80(pbVar4,0);
    FUN_10002310(local_f3c,0xf3c,(byte *)"MEDALS",iVar7);
    bVar1 = true;
    if (piVar3 != (int *)0x0) {
      piVar3[0x114] = iVar7;
    }
  }
  pbVar4 = FUN_10002000(local_113c,(byte *)"LEVEL");
  if (pbVar4 != (byte *)0x0) {
    iVar7 = FUN_10002e80(pbVar4,0);
    FUN_10002310(local_f3c,0xf3c,(byte *)"LEVEL",iVar7);
    bVar1 = true;
    if (piVar3 != (int *)0x0) {
      piVar3[0x113] = iVar7;
    }
  }
  pbVar4 = FUN_10002000(local_113c,&DAT_1003a704);
  if (pbVar4 == (byte *)0x0) {
    if (!bVar1) goto LAB_10028a31;
LAB_100289e6:
    if (piVar3 != (int *)0x0) {
      piVar3[1] = piVar3[1] + 1;
      FUN_1001a010(*(int *)(param_1 + 0x1608),*piVar3);
    }
  }
  else {
    FUN_10002f60(pbVar4,local_115c,0x10,&DAT_1003b708,0,0x2c);
    uVar5 = FUN_10002e80(local_115c,0);
    FUN_10002f60(pbVar4,local_115c,0x10,&DAT_1003b708,1,0x2c);
    iVar7 = FUN_10002e80(local_115c,0);
    FUN_10002f60(pbVar4,local_115c,0x10,&DAT_1003b708,2,0x2c);
    iVar6 = FUN_10002e80(local_115c,0);
    uVar5 = (uVar5 & 0xe0) << 1 | iVar7 >> 2 & 0x38U | iVar6 >> 5 & 7U;
    FUN_10002310(local_f3c,0xf3c,&DAT_1003a704,uVar5);
    if (piVar3 != (int *)0x0) {
      piVar3[0xfe] = uVar5;
      goto LAB_100289e6;
    }
  }
  FUN_10018470(*(SOCKET **)(param_1 + 0x1960),0x2a707574,0,(char *)local_f3c,(char *)0xffffffff);
LAB_10028a31:
  FUN_1000c9b0(param_2);
  return;
}



void __cdecl FUN_10028a50(int param_1,int *param_2,char param_3)

{
  if (param_3 != '\0') {
    FUN_1001d550(*(int *)(param_1 + 0x1728),*(int **)(param_1 + 0x1724),param_2);
  }
  FUN_1001a0d0(*(int *)(param_1 + 0x1608),*param_2);
  FUN_100188e0(param_2 + 3,*(int **)(param_1 + 0x1600),(byte *)(param_2 + 3));
  FUN_100188e0(*(void **)(param_1 + 0x1604),(int *)*(void **)(param_1 + 0x1604),
               (byte *)(param_2 + 8));
  _free(param_2);
  return;
}



void __cdecl FUN_10028ac0(int param_1,int *param_2,char param_3)

{
  bool bVar1;
  uint *puVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  uint uVar6;
  void *this;
  
  puVar2 = (uint *)FUN_1001a190(*(int *)(param_1 + 0x15f8),param_2[0xc]);
  if ((puVar2 != (uint *)0x0) && (puVar2[0x3a] = puVar2[0x3a] - 1, 0 < *(int *)(param_1 + 0x15fc)))
  {
    FUN_1000ca40(param_1,0,*puVar2,8,(char *)(param_2 + 8),"has disconnected from server");
  }
  if ((param_2[0xd] != 0) &&
     (piVar3 = (int *)FUN_1001a190(*(int *)(param_1 + 0x171c),param_2[0xd]), piVar3 != (int *)0x0))
  {
    if (((piVar3[1] & 0x80000U) != 0) && (param_3 == '\0')) {
      param_2[0xe] = param_2[0xd];
      if ((param_2[0x101] == 0) && (param_2[0xc] == 0)) {
        bVar1 = false;
      }
      else {
        bVar1 = true;
      }
      param_2[0x101] = 0;
      param_2[0xc] = 0;
      param_2[0x106] = *(int *)(param_1 + 0x1940) * 60000 + *(int *)(param_1 + 0x1944);
      if (!bVar1) {
        return;
      }
      FUN_1001a010(*(int *)(param_1 + 0x1608),*param_2);
      return;
    }
    if (piVar3[0x24] < 0) {
      piVar4 = (int *)&DAT_10039247;
    }
    else {
      piVar4 = piVar3 + piVar3[0x24] * 0x1a + 0x6e;
    }
    iVar5 = FUN_10019c70((char *)piVar4,(char *)(param_2 + 8));
    if (iVar5 == 0) {
      FUN_10022650(param_1,piVar3,'\x01',param_2);
    }
    else {
      uVar6 = FUN_10020560((int)piVar3,(int)param_2);
      if ((char)uVar6 != '\0') {
        FUN_1001a010(*(int *)(param_1 + 0x171c),*piVar3);
      }
    }
  }
  FUN_1001d550(*(int *)(param_1 + 0x1728),*(int **)(param_1 + 0x1724),param_2);
  FUN_1001a0d0(*(int *)(param_1 + 0x1608),*param_2);
  FUN_100188e0(this,*(int **)(param_1 + 0x1600),(byte *)(param_2 + 3));
  FUN_100188e0(param_2 + 8,*(int **)(param_1 + 0x1604),(byte *)(param_2 + 8));
  _free(param_2);
  return;
}



undefined4 __cdecl FUN_10028c60(int param_1,int param_2)

{
  byte bVar1;
  byte *pbVar2;
  int *piVar3;
  byte *pbVar4;
  char *pcVar5;
  char *pcVar6;
  int *piVar7;
  undefined4 uVar8;
  void *this;
  void *this_00;
  void *this_01;
  bool bVar9;
  int iVar10;
  byte *pbVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  int iVar15;
  int local_158;
  int local_154;
  int local_150;
  int local_14c;
  int local_144;
  byte local_140 [32];
  byte local_120 [32];
  char local_100 [256];
  
  pbVar11 = &DAT_10039247;
  local_14c = 0;
  local_158 = 0;
  local_154 = 0;
  local_150 = 0;
  iVar10 = 0x20;
  pbVar4 = local_140;
  local_144 = 0;
  bVar9 = false;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b60);
  FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
  pbVar11 = &DAT_10039247;
  iVar10 = 0x20;
  pbVar4 = local_120;
  pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b70);
  FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
  piVar3 = (int *)FUN_10018890(local_140,*(int *)(param_1 + 0x1600),local_140);
  if (piVar3 != (int *)0x0) {
    if (piVar3[0x101] == 0) {
      FUN_1000cd80(param_1,0x80,(char *)0x0,"LOGIN: PERS=%s GAMEREPT=%d");
      local_144 = piVar3[0xe];
      local_158 = piVar3[0x115];
      local_154 = piVar3[0x116];
      local_150 = piVar3[0x117];
      local_14c = piVar3[0x118];
      iVar10 = FUN_10019c70((char *)(piVar3 + 8),(char *)local_120);
      bVar9 = iVar10 != 0;
      FUN_1001a0d0(*(int *)(param_1 + 0x1608),*piVar3);
      FUN_100188e0(*(void **)(param_1 + 0x1600),(int *)*(void **)(param_1 + 0x1600),
                   (byte *)(piVar3 + 3));
      FUN_100188e0(this,*(int **)(param_1 + 0x1604),(byte *)(piVar3 + 8));
      _free(piVar3);
    }
    else {
      pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039b58);
      if (pbVar4 == (byte *)0x0) {
        iVar10 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar10) {
          iVar10 = *(int *)(param_2 + 100);
        }
        *(undefined4 *)(param_2 + 0x50) = 0;
        *(int *)(param_2 + 0x48) = iVar10;
        *(undefined4 *)(param_2 + 0x4c) = 0x70736574;
        return 0;
      }
      FUN_10028ac0(param_1,piVar3,'\x01');
    }
  }
  iVar10 = FUN_100195a0(*(int **)(param_1 + 0x1c7c),local_140);
  if ((0 < iVar10) || (iVar10 = FUN_100195a0(*(int **)(param_1 + 0x1c7c),local_120), 0 < iVar10)) {
    iVar10 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar10) {
      iVar10 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar10;
    *(undefined4 *)(param_2 + 0x4c) = 0x66696c74;
    return 0;
  }
  uVar12 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"FLAGS");
  uVar12 = FUN_10002ed0((char *)pbVar4,uVar12);
  if ((uVar12 & 0x1000) != 0) {
    iVar10 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar10) {
      iVar10 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar10;
    *(undefined4 *)(param_2 + 0x4c) = 0x6c6f636b;
    return 0;
  }
  iVar10 = FUN_10029bc0(*(int **)(param_1 + 0x1730),param_1,*(byte **)(param_2 + 0x74));
  if (iVar10 < 0) {
    iVar10 = *(int *)(param_2 + 0x68);
    *(undefined4 *)(param_2 + 0x20) = 0;
    if (-1 < iVar10) {
      iVar10 = *(int *)(param_2 + 100);
    }
    *(undefined4 *)(param_2 + 0x50) = 0;
    *(int *)(param_2 + 0x48) = iVar10;
    *(undefined4 *)(param_2 + 0x4c) = 0x63646576;
    return 0;
  }
  uVar12 = 0;
  _sprintf(local_100,"[%s]",local_140);
  pcVar5 = _strstr((char *)(param_1 + 0x1da1),local_100);
  if (pcVar5 != (char *)0x0) {
    uVar12 = 0x2002;
  }
  pcVar5 = _strstr((char *)(param_1 + 0x1164fc4),local_100);
  if (pcVar5 != (char *)0x0) {
    uVar12 = uVar12 | 0x2000000;
  }
  uVar13 = 0;
  pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"FLAGS");
  uVar13 = FUN_10002ed0((char *)pbVar4,uVar13);
  uVar12 = uVar12 | uVar13 & 0x102000;
  if ((uVar12 & 0x2002) == 0) {
    for (pcVar5 = _strchr((char *)(param_1 + 0x21a1),0x5b); pcVar5 != (char *)0x0;
        pcVar5 = _strchr(pcVar5 + 1,0x5b)) {
      pcVar6 = _strchr(pcVar5,0x5d);
      iVar10 = __strnicmp((char *)local_120,pcVar5 + 1,(size_t)(pcVar6 + (-1 - (int)pcVar5)));
      if (iVar10 == 0) {
        FUN_1000cde0(param_1,0x80000,"<FILTER time=%e pers=%s>%s</>");
        iVar10 = *(int *)(param_2 + 0x68);
        *(undefined4 *)(param_2 + 0x20) = 0;
        if (-1 < iVar10) {
          iVar10 = *(int *)(param_2 + 100);
        }
        *(undefined4 *)(param_2 + 0x50) = 0;
        *(int *)(param_2 + 0x48) = iVar10;
        *(undefined4 *)(param_2 + 0x4c) = 0x72737276;
        return 0;
      }
    }
  }
  iVar10 = FUN_10018890(*(void **)(param_1 + 0x1600),(int)*(void **)(param_1 + 0x1600),local_140);
  if ((iVar10 == 0) &&
     (iVar10 = FUN_10018890(this_00,*(int *)(param_1 + 0x1604),local_120), iVar10 == 0)) {
    piVar7 = (int *)_malloc(0x524);
    piVar3 = piVar7;
    for (iVar10 = 0x149; iVar10 != 0; iVar10 = iVar10 + -1) {
      *piVar3 = 0;
      piVar3 = piVar3 + 1;
    }
    pbVar4 = local_140;
    iVar10 = 0xc - (int)pbVar4;
    do {
      bVar1 = *pbVar4;
      pbVar4[(int)piVar7 + iVar10] = bVar1;
      pbVar4 = pbVar4 + 1;
    } while (bVar1 != 0);
    pbVar4 = local_120;
    iVar10 = (int)(piVar7 + 8) - (int)pbVar4;
    pbVar2 = pbVar4;
    do {
      bVar1 = *pbVar4;
      pbVar2 = (byte *)CONCAT31((int3)((uint)pbVar2 >> 8),bVar1);
      pbVar4[iVar10] = bVar1;
      pbVar4 = pbVar4 + 1;
    } while (bVar1 != 0);
    FUN_10018820(pbVar2,*(int **)(param_1 + 0x1600),(byte *)(piVar7 + 3),(int)piVar7);
    FUN_10018820(this_01,*(int **)(param_1 + 0x1604),(byte *)(piVar7 + 8),(int)piVar7);
    iVar10 = FUN_10019f50(*(int **)(param_1 + 0x1608),0,piVar7);
    *piVar7 = iVar10;
    piVar7[0xc] = 0;
    piVar7[0x103] = *(int *)(param_2 + 0xc);
    uVar13 = 0;
    piVar7[0x104] = *(int *)(param_2 + 0x10);
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039d3c);
    uVar13 = FUN_10002f10(pbVar4,uVar13);
    uVar14 = 0;
    piVar7[0x101] = uVar13;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"LADDR");
    uVar13 = FUN_10002f10(pbVar4,uVar14);
    iVar10 = 0;
    piVar7[0x102] = uVar13;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039d1c);
    iVar10 = FUN_10002e80(pbVar4,iVar10);
    iVar15 = 0;
    piVar7[0x105] = iVar10;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a6dc);
    iVar10 = FUN_10002e80(pbVar4,iVar15);
    piVar7[0xfd] = iVar10;
    uVar13 = 0;
    piVar7[0x100] =
         (((int)*(char *)(param_1 + 0x1948) << 8 | (int)*(char *)(param_1 + 0x1949)) << 8 |
         (int)*(char *)(param_1 + 0x194a)) << 8 | (int)*(char *)(param_1 + 0x194b);
    piVar7[2] = uVar12;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a6b8);
    uVar12 = FUN_10002ed0((char *)pbVar4,uVar13);
    pbVar11 = &DAT_10039247;
    piVar7[0x112] = uVar12;
    iVar10 = 0x104;
    pbVar4 = (byte *)(piVar7 + 0x34);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a70c);
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_10039247;
    iVar10 = 0x20;
    pbVar4 = (byte *)(piVar7 + 0x107);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a6c0);
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_10039247;
    iVar10 = 0x1c;
    pbVar4 = (byte *)(piVar7 + 0xf6);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"MADDR");
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    iVar10 = 0;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"GFIDS");
    iVar10 = FUN_10002e80(pbVar4,iVar10);
    iVar15 = 0;
    piVar7[0x10f] = iVar10;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"HWFLAG");
    iVar10 = FUN_10002e80(pbVar4,iVar15);
    iVar15 = 0;
    piVar7[0x110] = iVar10;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"HWMASK");
    iVar10 = FUN_10002e80(pbVar4,iVar15);
    piVar7[0x111] = iVar10;
    iVar10 = *(int *)(param_1 + 0x1164e98);
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a704);
    iVar10 = FUN_10002e80(pbVar4,iVar10);
    iVar15 = 0;
    piVar7[0xfe] = iVar10;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"LEVEL");
    iVar10 = FUN_10002e80(pbVar4,iVar15);
    iVar15 = 0;
    piVar7[0x113] = iVar10;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),(byte *)"MEDALS");
    iVar10 = FUN_10002e80(pbVar4,iVar15);
    iVar15 = 0;
    piVar7[0x114] = iVar10;
    pbVar4 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_1003a6a4);
    iVar10 = FUN_10002e80(pbVar4,iVar15);
    piVar7[0x148] = iVar10;
    if (iVar10 < 0) {
      piVar7[0x148] = 0;
    }
    else if (999 < iVar10) {
      piVar7[0x148] = 999;
    }
    pbVar11 = &DAT_10039247;
    iVar10 = 0x20;
    pbVar4 = (byte *)(piVar7 + 0x13e);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e58);
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_10039247;
    iVar10 = 0x20;
    pbVar4 = (byte *)(piVar7 + 0x136);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e44);
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_10039247;
    iVar10 = 8;
    pbVar4 = (byte *)(piVar7 + 0x134);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e3c);
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_10039247;
    iVar10 = 4;
    pbVar4 = (byte *)(piVar7 + 0x147);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e4c);
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    pbVar11 = &DAT_10039247;
    iVar10 = 4;
    pbVar4 = (byte *)(piVar7 + 0x146);
    pbVar2 = FUN_10002000(*(byte **)(param_2 + 0x74),&DAT_10039e34);
    FUN_100030f0(pbVar2,pbVar4,iVar10,pbVar11);
    (*(code *)PTR_FUN_1004140c)(*(undefined4 *)(*(int *)(param_1 + 0x172c) + 0x10c),piVar7);
    piVar7[1] = piVar7[1] + 1;
    piVar7[0x115] = local_158;
    piVar7[0x116] = local_154;
    piVar7[0x117] = local_150;
    piVar7[0xe] = local_144;
    piVar7[0x118] = local_14c;
    if (local_144 != 0) {
      FUN_10025c00(param_1,(int)piVar7,local_144,bVar9);
    }
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b60,
                 *(byte **)(param_2 + 0x74));
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_10039b70,
                 *(byte **)(param_2 + 0x74));
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003e770,
                 *(byte **)(param_2 + 0x74));
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"PLAST",
                 *(byte **)(param_2 + 0x74));
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"SINCE",
                 *(byte **)(param_2 + 0x74));
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),(byte *)"PSINCE",
                 *(byte **)(param_2 + 0x74));
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003c41c,
                 *(byte **)(param_2 + 0x74));
    FUN_10002bb0(*(byte **)(param_2 + 0x58),*(int *)(param_2 + 0x54),&DAT_1003a70c,
                 *(byte **)(param_2 + 0x74));
    uVar8 = FUN_1000c9b0(param_2);
    return uVar8;
  }
  iVar10 = *(int *)(param_2 + 0x68);
  *(undefined4 *)(param_2 + 0x20) = 0;
  if (-1 < iVar10) {
    iVar10 = *(int *)(param_2 + 100);
  }
  *(undefined4 *)(param_2 + 0x50) = 0;
  *(int *)(param_2 + 0x48) = iVar10;
  *(undefined4 *)(param_2 + 0x4c) = 0x6c6f676e;
  return 0;
}



void FUN_100296d0(void)

{
  int in_EAX;
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  int unaff_EBX;
  
  if (*(void **)(unaff_EBX + 0x1c) != (void *)0x0) {
    _free(*(void **)(unaff_EBX + 0x1c));
    *(undefined4 *)(unaff_EBX + 0x1c) = 0;
    *(undefined4 *)(unaff_EBX + 0x10) = 0;
  }
  *(int *)(unaff_EBX + 0x10) = 0;
  *(undefined4 *)(unaff_EBX + 0x14) = 0;
  *(undefined4 *)(unaff_EBX + 0x18) = 0;
  *(undefined4 *)(unaff_EBX + 0x1c) = 0;
  puVar1 = (undefined4 *)_malloc(in_EAX * 0x84);
  *(int *)(unaff_EBX + 0x10) = in_EAX;
  *(undefined4 **)(unaff_EBX + 0x1c) = puVar1;
  for (uVar2 = (uint)(in_EAX * 0x84) >> 2; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar1 = 0;
    puVar1 = puVar1 + 1;
  }
  for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
    *(undefined1 *)puVar1 = 0;
    puVar1 = (undefined4 *)((int)puVar1 + 1);
  }
  return;
}



undefined4 __cdecl FUN_10029730(int param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  byte *pbVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  bool bVar11;
  int local_98;
  int *local_94;
  undefined4 local_90 [35];
  
  local_98 = 0;
  if (0 < *(int *)(param_1 + 4)) {
    local_94 = *(int **)(param_1 + 0xc);
    pbVar3 = (byte *)(local_94 + 1);
    pbVar7 = param_2;
    pbVar2 = pbVar3;
LAB_10029765:
    do {
      bVar1 = *pbVar3;
      bVar11 = bVar1 < *pbVar7;
      if (bVar1 == *pbVar7) {
        if (bVar1 != 0) {
          bVar1 = pbVar3[1];
          bVar11 = bVar1 < pbVar7[1];
          if (bVar1 != pbVar7[1]) goto LAB_10029789;
          pbVar3 = pbVar3 + 2;
          pbVar7 = pbVar7 + 2;
          if (bVar1 != 0) goto LAB_10029765;
        }
        iVar4 = 0;
      }
      else {
LAB_10029789:
        iVar4 = (1 - (uint)bVar11) - (uint)(bVar11 != 0);
      }
      if (iVar4 == 0) {
        *local_94 = *local_94 + 1;
        if (local_98 < 1) {
          return 0;
        }
        iVar4 = local_98 * 0x84;
        do {
          if (*(uint *)(*(int *)(param_1 + 0xc) + iVar4) <=
              *(uint *)(*(int *)(param_1 + 0xc) + -0x84 + iVar4)) {
            return 0;
          }
          puVar6 = (undefined4 *)(*(int *)(param_1 + 0xc) + iVar4);
          puVar9 = puVar6 + -0x21;
          puVar8 = puVar9;
          puVar10 = local_90;
          for (iVar5 = 0x21; iVar5 != 0; iVar5 = iVar5 + -1) {
            *puVar10 = *puVar8;
            puVar8 = puVar8 + 1;
            puVar10 = puVar10 + 1;
          }
          for (iVar5 = 0x21; iVar5 != 0; iVar5 = iVar5 + -1) {
            *puVar9 = *puVar6;
            puVar6 = puVar6 + 1;
            puVar9 = puVar9 + 1;
          }
          puVar9 = local_90;
          puVar6 = (undefined4 *)(*(int *)(param_1 + 0xc) + iVar4);
          for (iVar5 = 0x21; iVar5 != 0; iVar5 = iVar5 + -1) {
            *puVar6 = *puVar9;
            puVar9 = puVar9 + 1;
            puVar6 = puVar6 + 1;
          }
          local_98 = local_98 + -1;
          iVar4 = iVar4 + -0x84;
        } while (0 < local_98);
        return 0;
      }
      local_98 = local_98 + 1;
      local_94 = local_94 + 0x21;
      pbVar3 = pbVar2 + 0x84;
      pbVar7 = param_2;
      pbVar2 = pbVar3;
    } while (local_98 < *(int *)(param_1 + 4));
  }
  return 0xffffffff;
}



void __cdecl FUN_10029840(char *param_1)

{
  char *_Dest;
  uint uVar1;
  uint *in_EAX;
  int iVar2;
  undefined4 *puVar3;
  char *pcVar4;
  
  uVar1 = in_EAX[1];
  if (uVar1 < *in_EAX) {
    puVar3 = (undefined4 *)(uVar1 * 0x84 + in_EAX[3]);
    in_EAX[1] = uVar1 + 1;
    _Dest = (char *)(puVar3 + 1);
    pcVar4 = _Dest;
    for (iVar2 = 0x20; iVar2 != 0; iVar2 = iVar2 + -1) {
      pcVar4[0] = '\0';
      pcVar4[1] = '\0';
      pcVar4[2] = '\0';
      pcVar4[3] = '\0';
      pcVar4 = pcVar4 + 4;
    }
    _strncpy(_Dest,param_1,0x7f);
    *puVar3 = 1;
    return;
  }
  in_EAX[2] = in_EAX[2] + 1;
  return;
}



char FUN_10029890(void)

{
  byte *in_EAX;
  int iVar1;
  byte *pbVar2;
  byte *pbVar3;
  bool bVar4;
  byte local_84 [132];
  
  if (in_EAX == (byte *)0x0) {
    return '\x01';
  }
  FUN_100030f0(in_EAX,local_84,0x84,&DAT_10039247);
  iVar1 = 8;
  bVar4 = true;
  pbVar2 = local_84;
  pbVar3 = (byte *)"$WATCH$";
  do {
    if (iVar1 == 0) break;
    iVar1 = iVar1 + -1;
    bVar4 = *pbVar2 == *pbVar3;
    pbVar2 = pbVar2 + 1;
    pbVar3 = pbVar3 + 1;
  } while (bVar4);
  if (bVar4) {
    return '\x02';
  }
  iVar1 = 0xc;
  bVar4 = true;
  pbVar2 = local_84;
  pbVar3 = (byte *)"$AUTOWATCH$";
  do {
    if (iVar1 == 0) break;
    iVar1 = iVar1 + -1;
    bVar4 = *pbVar2 == *pbVar3;
    pbVar2 = pbVar2 + 1;
    pbVar3 = pbVar3 + 1;
  } while (bVar4);
  if (bVar4) {
    return '\x04';
  }
  bVar4 = true;
  iVar1 = 7;
  pbVar2 = local_84;
  pbVar3 = (byte *)"$AUTO$";
  do {
    if (iVar1 == 0) break;
    iVar1 = iVar1 + -1;
    bVar4 = *pbVar2 == *pbVar3;
    pbVar2 = pbVar2 + 1;
    pbVar3 = pbVar3 + 1;
  } while (bVar4);
  return bVar4 * '\x02' + '\x03';
}



undefined4 __cdecl FUN_10029930(int param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  int unaff_EDI;
  bool bVar4;
  
  *(undefined4 *)(param_1 + 0xc) = 0;
  if (((*(uint *)(param_1 + 0x20) <= *(uint *)(param_1 + 4)) && (*(int *)(unaff_EDI + 4) != 0)) &&
     (*(uint *)(param_1 + 0x24) <=
      (uint)(**(int **)(unaff_EDI + 0xc) * 100) / *(uint *)(param_1 + 4))) {
    *(undefined4 *)(param_1 + 0xc) = 1;
    pbVar2 = (byte *)(*(int *)(unaff_EDI + 0xc) + 4);
    do {
      bVar1 = *pbVar2;
      bVar4 = bVar1 < *param_2;
      if (bVar1 != *param_2) {
LAB_10029998:
        iVar3 = (1 - (uint)bVar4) - (uint)(bVar4 != 0);
        goto LAB_1002999d;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar2[1];
      bVar4 = bVar1 < param_2[1];
      if (bVar1 != param_2[1]) goto LAB_10029998;
      pbVar2 = pbVar2 + 2;
      param_2 = param_2 + 2;
    } while (bVar1 != 0);
    iVar3 = 0;
LAB_1002999d:
    if (iVar3 != 0) {
      *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + 1;
      return 0xffffffff;
    }
  }
  return 0;
}



undefined4 FUN_100299b0(void)

{
  char *in_EAX;
  int iVar1;
  char *pcVar2;
  int unaff_EBX;
  char *unaff_EDI;
  
  if (in_EAX != (char *)0x0) {
    do {
      iVar1 = _strncmp(in_EAX,unaff_EDI,0x20);
      if (iVar1 == 0) {
        return 0;
      }
      pcVar2 = _strchr(in_EAX,0x2c);
    } while ((pcVar2 != (char *)0x0) && (in_EAX = pcVar2 + 1, in_EAX != (char *)0x0));
  }
  *(int *)(unaff_EBX + 8) = *(int *)(unaff_EBX + 8) + 1;
  return 0xffffffff;
}



undefined4 * FUN_100299f0(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0xac);
  puVar3 = puVar1;
  for (iVar2 = 0x2b; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  return puVar1;
}



void __cdecl FUN_10029a10(int *param_1,byte *param_2)

{
  byte bVar1;
  char cVar2;
  byte *pbVar3;
  byte *pbVar4;
  undefined3 extraout_var;
  int *piVar5;
  bool bVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  byte *pbVar10;
  byte local_80 [128];
  
  iVar8 = 10;
  pbVar3 = FUN_10002000(param_2,(byte *)"CHEAT_MAXLOGENT");
  iVar8 = FUN_10002e80(pbVar3,iVar8);
  iVar9 = 0;
  pbVar3 = FUN_10002000(param_2,(byte *)"CHEAT_RESET");
  iVar9 = FUN_10002e80(pbVar3,iVar9);
  pbVar10 = &DAT_10039247;
  iVar7 = 0x80;
  pbVar3 = local_80;
  pbVar4 = FUN_10002000(param_2,(byte *)"CHEAT_PAT");
  FUN_100030f0(pbVar4,pbVar3,iVar7,pbVar10);
  FUN_10002000(param_2,(byte *)"CHEAT_HIT");
  cVar2 = FUN_10029890();
  if ((param_1[4] == iVar8) && (*param_1 == CONCAT31(extraout_var,cVar2))) {
    pbVar4 = local_80;
    pbVar3 = (byte *)(param_1 + 10);
    do {
      bVar1 = *pbVar3;
      bVar6 = bVar1 < *pbVar4;
      if (bVar1 != *pbVar4) {
LAB_10029ad4:
        iVar7 = (1 - (uint)bVar6) - (uint)(bVar6 != 0);
        goto LAB_10029ad9;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar3[1];
      bVar6 = bVar1 < pbVar4[1];
      if (bVar1 != pbVar4[1]) goto LAB_10029ad4;
      pbVar3 = pbVar3 + 2;
      pbVar4 = pbVar4 + 2;
    } while (bVar1 != 0);
    iVar7 = 0;
LAB_10029ad9:
    if ((iVar7 == 0) && (iVar9 != 1)) goto LAB_10029b1f;
  }
  piVar5 = param_1;
  for (iVar9 = 0x2b; iVar9 != 0; iVar9 = iVar9 + -1) {
    *piVar5 = 0;
    piVar5 = piVar5 + 1;
  }
  pbVar3 = local_80;
  param_1[4] = iVar8;
  iVar8 = 0x28 - (int)pbVar3;
  do {
    bVar1 = *pbVar3;
    pbVar3[(int)param_1 + iVar8] = bVar1;
    pbVar3 = pbVar3 + 1;
  } while (bVar1 != 0);
  *param_1 = CONCAT31(extraout_var,cVar2);
  FUN_100296d0();
LAB_10029b1f:
  iVar8 = 0;
  pbVar3 = FUN_10002000(param_2,(byte *)"CHEAT_DIAGNOSTIC");
  iVar8 = FUN_10002e80(pbVar3,iVar8);
  iVar9 = 100;
  *(char *)(param_1 + 0x2a) = (char)iVar8;
  pbVar3 = FUN_10002000(param_2,(byte *)"CHEAT_AUTO_ENABLECT");
  iVar8 = FUN_10002e80(pbVar3,iVar9);
  iVar9 = 0x5a;
  param_1[8] = iVar8;
  pbVar3 = FUN_10002000(param_2,(byte *)"CHEAT_AUTO_THRESHOLDPCT");
  iVar8 = FUN_10002e80(pbVar3,iVar9);
  param_1[9] = iVar8;
  return;
}



void __cdecl FUN_10029b90(void *param_1)

{
  if (*(void **)((int)param_1 + 0x1c) != (void *)0x0) {
    _free(*(void **)((int)param_1 + 0x1c));
    *(undefined4 *)((int)param_1 + 0x1c) = 0;
    *(undefined4 *)((int)param_1 + 0x10) = 0;
  }
  _free(param_1);
  return;
}



undefined4 __cdecl FUN_10029bc0(int *param_1,int param_2,byte *param_3)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  undefined4 uVar4;
  bool bVar5;
  int iVar6;
  byte *pbVar7;
  byte local_1e4 [32];
  byte local_1c4 [32];
  byte local_1a4 [128];
  byte local_124 [32];
  byte local_104 [132];
  byte local_80 [128];
  
  uVar4 = 0;
  if (*param_1 == 1) {
    param_1[3] = 0;
    return 0;
  }
  pbVar7 = &DAT_10039247;
  iVar6 = 0x20;
  pbVar3 = local_1c4;
  pbVar2 = FUN_10002000(param_3,&DAT_10039b70);
  FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar7);
  pbVar7 = &DAT_10039247;
  iVar6 = 0x20;
  pbVar3 = local_1e4;
  pbVar2 = FUN_10002000(param_3,&DAT_10039e58);
  FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar7);
  pbVar7 = &DAT_10039247;
  iVar6 = 0x20;
  pbVar3 = local_124;
  pbVar2 = FUN_10002000(param_3,&DAT_10039e44);
  FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar7);
  pbVar7 = &DAT_10039247;
  iVar6 = 0x84;
  pbVar3 = local_104;
  pbVar2 = FUN_10002000(param_3,&DAT_1003c4a0);
  FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar7);
  pbVar7 = &DAT_10039247;
  iVar6 = 0x80;
  pbVar3 = local_80;
  pbVar2 = FUN_10002000(param_3,&DAT_1003c230);
  FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar7);
  pbVar7 = &DAT_10039247;
  iVar6 = 0x80;
  pbVar3 = local_1a4;
  pbVar2 = FUN_10002000(param_3,&DAT_1003c498);
  FUN_100030f0(pbVar2,pbVar3,iVar6,pbVar7);
  iVar6 = 7;
  bVar5 = true;
  pbVar3 = local_1e4;
  pbVar2 = (byte *)"FLM/A1";
  do {
    if (iVar6 == 0) break;
    iVar6 = iVar6 + -1;
    bVar5 = *pbVar3 == *pbVar2;
    pbVar3 = pbVar3 + 1;
    pbVar2 = pbVar2 + 1;
  } while (bVar5);
  if (bVar5) {
    pbVar3 = local_1a4;
    do {
      bVar1 = *pbVar3;
      pbVar3 = pbVar3 + 1;
    } while (bVar1 != 0);
    if (pbVar3 == local_1a4 + 1) {
      return 0;
    }
  }
  param_1[1] = param_1[1] + 1;
  iVar6 = FUN_10029730((int)(param_1 + 4),local_1a4);
  if (iVar6 < 0) {
    FUN_10029840((char *)local_1a4);
  }
  iVar6 = *param_1;
  if (iVar6 != 2) {
    if (iVar6 != 4) {
      if (iVar6 == 5) {
        uVar4 = FUN_10029930((int)param_1,local_1a4);
      }
      else if (iVar6 == 3) {
        param_1[3] = 1;
        uVar4 = FUN_100299b0();
      }
      goto LAB_10029d98;
    }
    FUN_10029930((int)param_1,local_1a4);
  }
  uVar4 = 0;
  param_1[3] = 0;
LAB_10029d98:
  FUN_1000cd80(param_2,0x80000,(char *)0x0,
               "user=%s, vers=%s, slus=%s, cpat=%s, chit=%s, cdev=%s, cheater=%s");
  return uVar4;
}



void __cdecl FUN_10029df0(int *param_1,char *param_2,int param_3)

{
  float fVar1;
  float fVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  char *_Format;
  char local_800 [2048];
  
  iVar3 = _sprintf(local_800,"\n\nCheat Device Statistics\n\n");
  pcVar6 = local_800 + iVar3;
  iVar3 = _sprintf(pcVar6,"Mode: %s\n",(&PTR_s_Unknown_10041514)[*param_1]);
  pcVar6 = pcVar6 + iVar3;
  iVar3 = _sprintf(pcVar6,"Status: %s\n\n");
  iVar4 = _sprintf(pcVar6 + iVar3,"Total Logins: %d\n",param_1[1]);
  pcVar6 = pcVar6 + iVar3 + iVar4;
  iVar3 = *param_1;
  if (iVar3 == 5) {
LAB_10029e71:
    if (iVar3 == 4) goto LAB_10029e76;
    _Format = "Total Rejections: %d\n";
  }
  else {
    if (iVar3 != 4) {
      if (iVar3 != 3) goto LAB_10029edc;
      goto LAB_10029e71;
    }
LAB_10029e76:
    _Format = "Potential Rejections: %d\n";
  }
  iVar3 = _sprintf(pcVar6,_Format);
  pcVar6 = pcVar6 + iVar3;
  iVar3 = param_1[1];
  if (iVar3 != 0) {
    fVar1 = (float)param_1[2];
    if (param_1[2] < 0) {
      fVar1 = fVar1 + 4.2949673e+09;
    }
    fVar2 = (float)iVar3;
    if (iVar3 < 0) {
      fVar2 = fVar2 + 4.2949673e+09;
    }
    iVar3 = _sprintf(pcVar6,"Rejection Percentage: %2.1f%%\n",(double)((fVar1 * 100.0) / fVar2));
    pcVar6 = pcVar6 + iVar3;
  }
LAB_10029edc:
  if ((*param_1 == 5) || (*param_1 == 4)) {
    if (param_1[5] == 0) {
      iVar3 = _sprintf(pcVar6,"AutoThreshold: %d%%\n");
    }
    else {
      fVar1 = (float)*(int *)param_1[7];
      if (*(int *)param_1[7] < 0) {
        fVar1 = fVar1 + 4.2949673e+09;
      }
      fVar2 = (float)param_1[1];
      if (param_1[1] < 0) {
        fVar2 = fVar2 + 4.2949673e+09;
      }
      iVar3 = _sprintf(pcVar6,"AutoThreshold: %d%% (%2.1f%%)\n",param_1[9],
                       (double)((fVar1 * 100.0) / fVar2));
    }
    iVar4 = _sprintf(pcVar6 + iVar3,"AutoEnable: %d\n");
    pcVar6 = pcVar6 + iVar3 + iVar4;
  }
  iVar3 = _sprintf(pcVar6,"\nPattern: %s\n");
  iVar4 = _sprintf(pcVar6 + iVar3,"\nCheat Response Log (max entries=%d)\n",param_1[4]);
  pcVar6 = pcVar6 + iVar3 + iVar4;
  uVar5 = 0;
  if (param_1[4] != 0) {
    iVar3 = 0;
    do {
      if (uVar5 < (uint)param_1[5]) {
        iVar4 = _sprintf(pcVar6,"   %d) Count: %d  MD5: %s\n",uVar5,
                         *(undefined4 *)(param_1[7] + iVar3),param_1[7] + iVar3 + 4);
      }
      else {
        iVar4 = _sprintf(pcVar6,"   %d) Empty\n",uVar5);
      }
      pcVar6 = pcVar6 + iVar4;
      uVar5 = uVar5 + 1;
      iVar3 = iVar3 + 0x84;
    } while (uVar5 < (uint)param_1[4]);
  }
  iVar3 = _sprintf(pcVar6,"\n   %d discards\n");
  _sprintf(pcVar6 + iVar3,"\n(output=%d bytes)\n",(int)(pcVar6 + iVar3) - (int)local_800);
  param_2[param_3 + -1] = '\0';
  _strncpy(param_2,local_800,param_3 - 1);
  return;
}



undefined1 __cdecl FUN_1002a030(int param_1)

{
  return *(undefined1 *)(param_1 + 0xa8);
}



undefined4 * FUN_1002a040(void)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)_malloc(0x3d3e4);
  puVar3 = puVar1;
  for (iVar2 = 0xf4f9; iVar2 != 0; iVar2 = iVar2 + -1) {
    *puVar3 = 0;
    puVar3 = puVar3 + 1;
  }
  puVar1[0x20] = 0x7f000000;
  return puVar1;
}



void __cdecl FUN_1002a070(void *param_1)

{
  if (param_1 != (void *)0x0) {
    _free(param_1);
    return;
  }
  return;
}



void __cdecl FUN_1002a090(int param_1)

{
  uint uVar1;
  
  uVar1 = *(int *)(param_1 + 0x80) + 1;
  *(uint *)(param_1 + 0x80) = uVar1;
  if (0x7fffffff < uVar1) {
    *(undefined4 *)(param_1 + 0x80) = 0x7f000000;
  }
  return;
}



int __cdecl FUN_1002a0c0(int param_1)

{
  int iVar1;
  char *pcVar2;
  
  iVar1 = 0;
  pcVar2 = (char *)(param_1 + 4);
  do {
    if (*pcVar2 == '\0') {
      iVar1 = iVar1 * 0x10 + param_1;
      *(undefined1 *)(iVar1 + 4) = 1;
      *(undefined4 *)(iVar1 + 8) = 0;
      return iVar1;
    }
    iVar1 = iVar1 + 1;
    pcVar2 = pcVar2 + 0x10;
  } while (iVar1 < 8);
  return 0;
}



void __cdecl FUN_1002a100(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar1 = 0;
  iVar2 = param_1;
  do {
    if (iVar2 == param_2) {
      iVar2 = iVar1 * 0x10 + param_1;
      *(undefined1 *)(iVar2 + 4) = 0;
      *(undefined4 *)(iVar2 + 8) = 0;
      return;
    }
    iVar1 = iVar1 + 1;
    iVar2 = iVar2 + 0x10;
  } while (iVar1 < 8);
  return;
}



int __cdecl FUN_1002a140(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  undefined4 *puVar6;
  
  iVar5 = 0;
  pcVar3 = (char *)(param_1 + 0x84);
  do {
    if (*pcVar3 == '\0') {
      iVar2 = iVar5 * 0x7a6c + param_1;
      puVar1 = (undefined4 *)(iVar2 + 0x84);
      puVar6 = puVar1;
      for (iVar4 = 0x1e9b; iVar4 != 0; iVar4 = iVar4 + -1) {
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      }
      *(undefined4 *)(iVar2 + 0x88) = 0;
      *(undefined1 *)puVar1 = 1;
      return iVar5;
    }
    iVar5 = iVar5 + 1;
    pcVar3 = pcVar3 + 0x7a6c;
  } while (iVar5 < 8);
  return -1;
}



void __cdecl FUN_1002a1a0(int param_1,int param_2)

{
  int iVar1;
  
  if ((-1 < param_2) && (param_2 < 8)) {
    iVar1 = param_2 * 0x7a6c + param_1;
    *(undefined1 *)(iVar1 + 0x84) = 0;
    *(undefined4 *)(iVar1 + 0x88) = 0;
  }
  return;
}



int __cdecl FUN_1002a1d0(int param_1,char *param_2)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  
  iVar3 = 0;
  pcVar2 = (char *)(param_1 + 0x90);
  do {
    if (pcVar2[-0xc] != '\0') {
      iVar5 = 0;
      pcVar4 = pcVar2;
      do {
        if (*pcVar4 == '\0') break;
        iVar1 = FUN_10019c70(pcVar4,param_2);
        if (iVar1 == 0) {
          return iVar3;
        }
        iVar5 = iVar5 + 1;
        pcVar4 = pcVar4 + 0x10;
      } while (iVar5 < 8);
    }
    iVar3 = iVar3 + 1;
    pcVar2 = pcVar2 + 0x7a6c;
    if (7 < iVar3) {
      return -1;
    }
  } while( true );
}



uint __cdecl
FUN_1002a230(int param_1,int *param_2,int param_3,undefined4 param_4,int param_5,char *param_6)

{
  char cVar1;
  uint in_EAX;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  char *pcVar5;
  int iVar6;
  int *piVar7;
  
  iVar4 = -param_3;
  uVar2 = in_EAX & 0xffffff00;
  if ((0x7effffff < iVar4) && (param_3 == -0x7fffffff || iVar4 < 0x7fffffff)) {
    iVar6 = 0;
    piVar7 = (int *)(param_1 + 8);
    while (*piVar7 != iVar4) {
      iVar6 = iVar6 + 1;
      piVar7 = piVar7 + 4;
      if (7 < iVar6) {
        return CONCAT31((int3)((uint)piVar7 >> 8),1);
      }
    }
    puVar3 = FUN_100199e0(param_2,param_5 + 1);
    piVar7 = (int *)(iVar6 * 0x10 + param_1);
    *piVar7 = (int)puVar3;
    pcVar5 = (char *)puVar3[3];
    do {
      cVar1 = *param_6;
      param_6 = param_6 + 1;
      *pcVar5 = cVar1;
      pcVar5 = pcVar5 + 1;
    } while (cVar1 != '\0');
    *(int *)*piVar7 = param_3;
    iVar4 = *piVar7;
    *(undefined4 *)(iVar4 + 4) = param_4;
    uVar2 = CONCAT31((int3)((uint)iVar4 >> 8),1);
  }
  return uVar2;
}



void __cdecl
FUN_1002a2b0(int param_1,undefined4 param_2,int param_3,undefined4 param_4,byte *param_5)

{
  byte *pbVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = -1;
  pbVar1 = FUN_10002000(param_5,(byte *)"BSLOT");
  iVar2 = FUN_10002e80(pbVar1,iVar2);
  iVar3 = -1;
  pbVar1 = FUN_10002000(param_5,&DAT_1003eaac);
  iVar3 = FUN_10002e80(pbVar1,iVar3);
  FUN_100021b0(param_5,(byte *)"BSLOT");
  FUN_100021b0(param_5,&DAT_1003eaac);
  if (((-1 < iVar2) && (iVar2 < 8)) &&
     (iVar2 = iVar2 * 0x7a6c, *(char *)(iVar2 + 0x84 + param_1) != '\0')) {
    if (((param_3 == 0) && (-1 < iVar3)) && (iVar3 < 8)) {
      _strncpy((char *)(iVar3 * 0xf3c + iVar2 + 0x110 + param_1),(char *)param_5,0xf3c);
    }
    *(int *)(iVar2 + 0x88 + param_1) = *(int *)(iVar2 + 0x88 + param_1) + 1;
  }
  return;
}



void FUN_1002a370(void *param_1)

{
  int iVar1;
  
  iVar1 = *(int *)((int)param_1 + 0x1c);
  if (iVar1 != *(int *)((int)param_1 + 0x24)) {
    do {
      if (*(SOCKET *)(iVar1 + 0x30) != 0xffffffff) {
        closesocket(*(SOCKET *)(iVar1 + 0x30));
      }
      *(undefined4 *)(iVar1 + 0x30) = 0xffffffff;
      iVar1 = iVar1 + 0x38;
    } while (iVar1 != *(int *)((int)param_1 + 0x24));
  }
  if (*(SOCKET *)((int)param_1 + 0x2c) != 0xffffffff) {
    closesocket(*(SOCKET *)((int)param_1 + 0x2c));
  }
  FUN_10018680(*(void **)((int)param_1 + 0x28));
  _free(*(void **)((int)param_1 + 0x14));
  _free(*(void **)((int)param_1 + 0x1c));
  _free(param_1);
                    // WARNING: Could not recover jumptable at 0x1002a3d3. Too many branches
                    // WARNING: Treating indirect jump as call
  WSACleanup();
  return;
}



uint __cdecl FUN_1002a3e0(uint *param_1,int param_2)

{
  u_short uVar1;
  u_long uVar2;
  sockaddr local_10;
  
  if (param_2 == 0x73696d75) {
    return *param_1;
  }
  if (param_2 == 0x72786275) {
    return param_1[3];
  }
  if (param_2 == 0x70657269) {
    return param_1[6];
  }
  if (param_2 == 0x64656c79) {
    return param_1[1];
  }
  if (param_2 == 0x706f7274) {
    param_2 = 0x10;
    getsockname(param_1[0xb],&local_10,&param_2);
    uVar1 = ntohs(local_10.sa_data._0_2_);
    return (uint)uVar1;
  }
  if (param_2 == 0x61646472) {
    param_2 = 0x10;
    getsockname(param_1[0xb],&local_10,&param_2);
    uVar2 = ntohl(CONCAT22(local_10.sa_data._4_2_,local_10.sa_data._2_2_));
    return uVar2;
  }
  return 0;
}



int FUN_1002a4b0(void)

{
  u_short uVar1;
  SOCKET s;
  u_long uVar2;
  int iVar3;
  undefined4 *puVar4;
  int *unaff_EDI;
  int local_28;
  int local_24;
  u_long local_20;
  int local_1c;
  char acStack_18 [8];
  sockaddr local_10;
  
  local_1c = *unaff_EDI;
  puVar4 = (undefined4 *)unaff_EDI[7];
  local_28 = 0;
  local_24 = 0;
  if (local_1c < 1) {
    return 0;
  }
  do {
    if (puVar4 == (undefined4 *)unaff_EDI[9]) {
      puVar4 = (undefined4 *)unaff_EDI[7];
    }
    if (puVar4[0xc] == -1) {
      local_20 = 0x10;
      s = accept(unaff_EDI[0xb],&local_10,(int *)&local_20);
      if (s == 0xffffffff) {
        return local_28;
      }
      if (CONCAT22(local_10.sa_data._4_2_,local_10.sa_data._2_2_) == 0) {
        closesocket(s);
        return local_28;
      }
      if (0 < unaff_EDI[6]) {
        uVar2 = ntohl(CONCAT22(local_10.sa_data._4_2_,local_10.sa_data._2_2_));
        local_24 = FUN_100189f0(unaff_EDI[10],uVar2);
        if (unaff_EDI[6] < local_24) {
          acStack_18[0] = '\x01';
          acStack_18[1] = '\0';
          acStack_18[2] = '\0';
          acStack_18[3] = '\0';
          acStack_18[4] = '\0';
          acStack_18[5] = '\0';
          acStack_18[6] = '\0';
          acStack_18[7] = '\0';
          setsockopt(s,0xffff,0x80,acStack_18,8);
          closesocket(s);
          goto LAB_1002a5fe;
        }
      }
      local_20 = 1;
      ioctlsocket(s,-0x7ffb9982,&local_20);
      puVar4[8] = unaff_EDI[0x12];
      uVar2 = ntohl(CONCAT22(local_10.sa_data._4_2_,local_10.sa_data._2_2_));
      puVar4[6] = uVar2;
      uVar1 = ntohs(local_10.sa_data._0_2_);
      *(u_short *)(puVar4 + 7) = uVar1;
      puVar4[2] = 0;
      puVar4[4] = 0;
      puVar4[3] = 0;
      puVar4[9] = 0;
      if (0 < unaff_EDI[6]) {
        local_24 = local_24 + 1;
        iVar3 = FUN_100189b0(unaff_EDI[10],puVar4[6],local_24);
        if (iVar3 == 0) {
          FUN_10018940((int *)unaff_EDI[10],puVar4[6],local_24);
        }
      }
      local_28 = local_28 + 1;
      *puVar4 = 1;
      puVar4[0xc] = s;
    }
LAB_1002a5fe:
    local_1c = local_1c + -1;
    puVar4 = puVar4 + 0xe;
    if (local_1c < 1) {
      return local_28;
    }
  } while( true );
}



undefined4 __cdecl FUN_1002a630(int param_1,SOCKET *param_2)

{
  uint *puVar1;
  u_int uVar2;
  SOCKET SVar3;
  int iVar4;
  int unaff_EBX;
  int iVar5;
  fd_set *unaff_ESI;
  int unaff_EDI;
  undefined4 local_c;
  timeval local_8;
  
  unaff_ESI->fd_array[unaff_ESI[0x3f].fd_array[1]] = *(SOCKET *)(param_1 + 0x2c);
  uVar2 = unaff_ESI->fd_count;
  iVar5 = 0;
  unaff_ESI[0x3f].fd_array[1] = unaff_ESI[0x3f].fd_array[1] + 1;
  unaff_ESI->fd_count = uVar2 + 1;
  local_8.tv_sec = (uint)param_2 / 1000;
  local_8.tv_usec = (uint)param_2 % 1000;
  local_c = 0;
  iVar4 = select(unaff_EBX,unaff_ESI,(fd_set *)0x0,(fd_set *)0x0,&local_8);
  if (iVar4 < 1) {
    return 0;
  }
  iVar4 = 0;
  if (0 < (int)unaff_ESI->fd_count) {
    param_2 = unaff_ESI->fd_array;
    do {
      if (*param_2 == *(SOCKET *)(param_1 + 0x2c)) {
        local_c = 1;
      }
      else {
        SVar3 = *(SOCKET *)(*(int *)(unaff_EDI + iVar4 * 4) + 0x30);
        while (SVar3 != *param_2) {
          iVar4 = (iVar4 + 1) % unaff_EBX;
          SVar3 = *(SOCKET *)(*(int *)(unaff_EDI + iVar4 * 4) + 0x30);
        }
        puVar1 = (uint *)(*(int *)(unaff_EDI + iVar4 * 4) + 0x34);
        *puVar1 = *puVar1 | 1;
      }
      iVar5 = iVar5 + 1;
      param_2 = param_2 + 1;
    } while (iVar5 < (int)unaff_ESI->fd_count);
  }
  return local_c;
}



uint __cdecl FUN_1002a6f0(int *param_1,int param_2,uint param_3)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint *puVar4;
  
  if (param_2 < *param_1) {
    puVar4 = (uint *)(param_2 * 0x38 + param_1[7]);
    param_1[0x10] = param_1[0x10] + param_1[0x12];
    if (puVar4[0xc] != 0xffffffff) {
      if (param_1[3] < (int)puVar4[3]) {
        puVar4[3] = param_1[3];
      }
      uVar1 = puVar4[4];
      if (((int)uVar1 < (int)puVar4[3]) && ((puVar4[0xd] & 1) != 0)) {
        iVar2 = recv(puVar4[0xc],(char *)(puVar4[5] + uVar1),param_1[3] - uVar1,0);
        param_1[0x11] = param_1[0x11] + iVar2;
        if (iVar2 < (int)(param_1[3] - puVar4[4])) {
          puVar4[0xd] = puVar4[0xd] ^ 1;
        }
        if ((iVar2 == 0) || ((iVar2 < 0 && (iVar3 = WSAGetLastError(), iVar3 != 0x2733)))) {
          *puVar4 = *puVar4 | 0x10;
        }
        if ((0 < iVar2) &&
           (uVar1 = puVar4[4], puVar4[4] = uVar1 + iVar2, (int)puVar4[3] <= (int)(uVar1 + iVar2))) {
          *puVar4 = *puVar4 | 4;
        }
      }
      return -(uint)((*puVar4 & param_3) != 0) & (uint)puVar4;
    }
  }
  return 0;
}



void __cdecl FUN_1002a7a0(int *param_1,int param_2)

{
  SOCKET s;
  
  if ((-1 < param_2) && (param_2 < *param_1)) {
    s = *(SOCKET *)(param_1[7] + 0x30 + param_2 * 0x38);
    if (s != 0xffffffff) {
      shutdown(s,2);
    }
    *(undefined4 *)(param_2 * 0x38 + param_1[7]) = 0x10;
  }
  return;
}



void __cdecl FUN_1002a7e0(int *param_1,int param_2)

{
  SOCKET s;
  int iVar1;
  int iVar2;
  
  if ((-1 < param_2) && (param_2 < *param_1)) {
    iVar2 = param_2 * 0x38;
    s = *(SOCKET *)(param_1[7] + 0x30 + iVar2);
    if (s != 0xffffffff) {
      shutdown(s,2);
      closesocket(*(SOCKET *)(param_1[7] + 0x30 + iVar2));
      *(undefined4 *)(param_1[7] + 0x30 + iVar2) = 0xffffffff;
      if (0 < param_1[6]) {
        iVar1 = FUN_100189f0(param_1[10],*(int *)(param_1[7] + 0x18 + iVar2));
        iVar2 = *(int *)(param_1[7] + 0x18 + iVar2);
        if (iVar1 + -1 == 0) {
          FUN_10018a30((int *)param_1[10],iVar2);
          return;
        }
        FUN_100189b0(param_1[10],iVar2,iVar1 + -1);
      }
    }
  }
  return;
}



undefined4 __cdecl FUN_1002a870(int *param_1,int param_2,int param_3,int param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  
  if ((param_2 < 0) || (*param_1 <= param_2)) {
    return 0xffffffff;
  }
  if ((-1 < param_3) && (param_3 <= param_1[3])) {
    puVar4 = (uint *)(param_2 * 0x38 + param_1[7]);
    if (param_4 == 0) {
      uVar3 = puVar4[3] + param_3;
      puVar4[3] = uVar3;
    }
    else {
      uVar3 = param_3 + puVar4[3];
      puVar4[2] = puVar4[3];
      puVar4[3] = uVar3;
    }
    uVar1 = puVar4[4];
    uVar2 = puVar4[2];
    if ((int)uVar2 < (int)uVar1) {
      if ((param_1[3] < (int)uVar3) || (param_1[4] < (int)uVar2)) {
        _memmove((void *)puVar4[5],(void *)((int)puVar4[5] + uVar2),uVar1 - uVar2);
        puVar4[3] = puVar4[3] - puVar4[2];
        puVar4[4] = puVar4[4] - puVar4[2];
        puVar4[2] = 0;
      }
      if ((0 < (int)puVar4[3]) && ((int)puVar4[3] <= (int)puVar4[4])) {
        *puVar4 = *puVar4 | 4;
        return 0;
      }
    }
    else if (0 < (int)uVar2) {
      puVar4[3] = uVar3 - uVar2;
      puVar4[4] = uVar1 - puVar4[2];
      puVar4[2] = 0;
    }
    return 0;
  }
  return 0xfffffffe;
}



int __cdecl FUN_1002a950(int *param_1,int param_2,char *param_3,int param_4)

{
  SOCKET s;
  int iVar1;
  int iVar2;
  
  if ((-1 < param_2) && (param_2 < *param_1)) {
    iVar2 = param_2 * 0x38;
    iVar1 = *(int *)(param_1[7] + 0x2c + iVar2);
    if ((iVar1 != 0) && (param_1[0x12] == iVar1 || param_1[0x12] - iVar1 < 0)) {
      return 0;
    }
    *(undefined4 *)(param_1[7] + 0x2c + iVar2) = 0;
    *(uint *)(param_1[7] + 0x34 + iVar2) = *(uint *)(param_1[7] + 0x34 + iVar2) & 0xfffffffd;
    s = *(SOCKET *)(param_1[7] + 0x30 + iVar2);
    if (s != 0xffffffff) {
      iVar1 = send(s,param_3,param_4,0);
      if (iVar1 < 0) {
        iVar1 = WSAGetLastError();
        if (((iVar1 == 0) || (iVar1 == 0x2733)) || (iVar1 == 0x2747)) {
          iVar1 = 0;
        }
        else {
          *(uint *)(param_1[7] + iVar2) = *(uint *)(param_1[7] + iVar2) | 0x10;
          iVar1 = -1;
        }
      }
      if (param_4 <= iVar1) {
        return iVar1;
      }
      *(int *)(param_1[7] + 0x2c + iVar2) = param_1[0x12] + param_1[2];
      return iVar1;
    }
  }
  return -1;
}



undefined4 __cdecl FUN_1002aa10(int *param_1,int param_2)

{
  int iVar1;
  
  if (((-1 < param_2) && (param_2 < *param_1)) &&
     (iVar1 = param_2 * 0x38 + param_1[7], *(int *)(iVar1 + 0x30) != -1)) {
    return *(undefined4 *)(iVar1 + 0x18);
  }
  return 0;
}



undefined2 __cdecl FUN_1002aa40(int *param_1,int param_2)

{
  int iVar1;
  
  if (((-1 < param_2) && (param_2 < *param_1)) &&
     (iVar1 = param_2 * 0x38 + param_1[7], *(int *)(iVar1 + 0x30) != -1)) {
    return *(undefined2 *)(iVar1 + 0x1c);
  }
  return 0;
}



u_long __cdecl FUN_1002aa70(int *param_1,int param_2)

{
  SOCKET s;
  int iVar1;
  u_long uVar2;
  sockaddr local_10;
  
  if (((-1 < param_2) && (param_2 < *param_1)) &&
     (s = *(SOCKET *)(param_2 * 0x38 + 0x30 + param_1[7]), s != 0xffffffff)) {
    local_10.sa_family = 0;
    local_10.sa_data[0] = '\0';
    local_10.sa_data[1] = '\0';
    local_10.sa_data[2] = '\0';
    local_10.sa_data[3] = '\0';
    local_10.sa_data[4] = '\0';
    local_10.sa_data[5] = '\0';
    local_10.sa_data[6] = '\0';
    local_10.sa_data[7] = '\0';
    local_10.sa_data[8] = '\0';
    local_10.sa_data[9] = '\0';
    local_10.sa_data[10] = '\0';
    local_10.sa_data[0xb] = '\0';
    local_10.sa_data[0xc] = '\0';
    local_10.sa_data[0xd] = '\0';
    param_2 = 0x10;
    iVar1 = getsockname(s,&local_10,&param_2);
    if (iVar1 == 0) {
      uVar2 = ntohl(local_10.sa_data._2_4_);
      return uVar2;
    }
  }
  return 0;
}



void __cdecl FUN_1002aae0(int param_1)

{
  undefined1 uVar1;
  char cVar2;
  
  uVar1 = *(undefined1 *)(param_1 + 0x3c);
  *(byte *)(param_1 + 0x3c) = *(byte *)(param_1 + 0x39) ^ *(byte *)(param_1 + 0x48);
  *(undefined1 *)(param_1 + 0x39) = uVar1;
  uVar1 = *(undefined1 *)(param_1 + 0x43);
  *(byte *)(param_1 + 0x43) =
       (byte)((uint)*(undefined4 *)(param_1 + 0x48) >> 8) ^ *(byte *)(param_1 + 0x3e);
  *(undefined1 *)(param_1 + 0x3e) = uVar1;
  uVar1 = *(undefined1 *)(param_1 + 0x45);
  *(char *)(param_1 + 0x45) = *(char *)(param_1 + 0x41) + -1;
  cVar2 = *(char *)(param_1 + 0x47);
  *(undefined1 *)(param_1 + 0x41) = uVar1;
  *(undefined1 *)(param_1 + 0x47) = *(undefined1 *)(param_1 + 0x3a);
  *(char *)(param_1 + 0x3a) = cVar2 + '\x01';
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void __cdecl FUN_1002ab30(int param_1)

{
  int iVar1;
  longlong lVar2;
  
  lVar2 = CONCAT44(_DAT_10052d0c,DAT_10052d08);
  if (DAT_10052d08 == 0 && _DAT_10052d0c == 0) {
    lVar2 = FUN_10017d20();
    lVar2 = lVar2 + -1;
  }
  _DAT_10052d0c = (int)((ulonglong)lVar2 >> 0x20);
  DAT_10052d08 = (int)lVar2;
  iVar1 = FUN_10017d20();
  *(int *)(param_1 + 0x48) = iVar1 - DAT_10052d08;
  return;
}



int * __cdecl
FUN_1002ab70(int param_1,undefined2 param_2,int param_3,int param_4,int param_5,int param_6)

{
  int iVar1;
  u_short uVar2;
  int iVar3;
  int *_Memory;
  undefined4 *puVar4;
  SOCKET SVar5;
  uint uVar6;
  int *piVar7;
  u_long uStack_1a4;
  sockaddr sStack_1a0;
  WSADATA local_190;
  
  iVar3 = WSAStartup(2,&local_190);
  if (iVar3 == 0) {
    if ((char)local_190.wVersion == '\x02') {
      if (0xfff < param_3) {
        param_3 = 0xfff;
      }
      _Memory = (int *)_malloc(0x4c);
      piVar7 = _Memory;
      for (iVar3 = 0x13; iVar3 != 0; iVar3 = iVar3 + -1) {
        *piVar7 = 0;
        piVar7 = piVar7 + 1;
      }
      _Memory[6] = param_5;
      puVar4 = FUN_10018b00(10,1000);
      _Memory[10] = (int)puVar4;
      *_Memory = param_3;
      _Memory[3] = param_4;
      if (0x1fff < param_4) {
        param_4 = param_4 + -0x1000;
      }
      _Memory[4] = param_4;
      _Memory[1] = param_6;
      _Memory[2] = 0x32;
      puVar4 = (undefined4 *)_malloc((param_3 + 1) * 0x38);
      _Memory[9] = (int)(puVar4 + *_Memory * 0xe);
      _Memory[7] = (int)puVar4;
      for (uVar6 = *_Memory * 0x38 + 0x38U >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      }
      for (iVar3 = 0; iVar3 != 0; iVar3 = iVar3 + -1) {
        *(undefined1 *)puVar4 = 0;
        puVar4 = (undefined4 *)((int)puVar4 + 1);
      }
      puVar4 = (undefined4 *)_malloc(*_Memory * _Memory[3]);
      iVar3 = *_Memory;
      iVar1 = _Memory[3];
      _Memory[5] = (int)puVar4;
      for (uVar6 = (uint)(iVar3 * iVar1) >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      }
      for (uVar6 = iVar3 * iVar1 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
        *(undefined1 *)puVar4 = 0;
        puVar4 = (undefined4 *)((int)puVar4 + 1);
      }
      uStack_1a4 = 0;
      if (0 < *_Memory) {
        do {
          iVar3 = uStack_1a4 * 0x38 + _Memory[7];
          *(undefined4 *)(iVar3 + 0x30) = 0xffffffff;
          *(u_long *)(iVar3 + 4) = uStack_1a4;
          *(u_long *)(iVar3 + 0x14) = _Memory[3] * uStack_1a4 + _Memory[5];
          uStack_1a4 = uStack_1a4 + 1;
        } while ((int)uStack_1a4 < *_Memory);
      }
      _Memory[8] = _Memory[7];
      _Memory[0xc] = param_1;
      *(undefined2 *)(_Memory + 0xd) = param_2;
      _Memory[0xb] = -1;
      SVar5 = socket(2,1,0);
      _Memory[0xb] = SVar5;
      if (SVar5 != 0xffffffff) {
        uStack_1a4 = 1;
        ioctlsocket(_Memory[0xb],-0x7ffb9982,&uStack_1a4);
        uStack_1a4 = 1;
        setsockopt(_Memory[0xb],0xffff,4,(char *)&uStack_1a4,4);
        sStack_1a0.sa_data[2] = '\0';
        sStack_1a0.sa_data[3] = '\0';
        sStack_1a0.sa_data[4] = '\0';
        sStack_1a0.sa_data[5] = '\0';
        sStack_1a0.sa_data[6] = '\0';
        sStack_1a0.sa_data[7] = '\0';
        sStack_1a0.sa_data[8] = '\0';
        sStack_1a0.sa_data[9] = '\0';
        sStack_1a0.sa_data[10] = '\0';
        sStack_1a0.sa_data[0xb] = '\0';
        sStack_1a0.sa_data[0xc] = '\0';
        sStack_1a0.sa_data[0xd] = '\0';
        sStack_1a0.sa_family = 2;
        sStack_1a0.sa_data[0] = '\0';
        sStack_1a0.sa_data[1] = '\0';
        uVar2 = htons(*(u_short *)(_Memory + 0xd));
        sStack_1a0.sa_data._0_2_ = uVar2;
        sStack_1a0.sa_data._2_4_ = htonl(_Memory[0xc]);
        iVar3 = bind(_Memory[0xb],&sStack_1a0,0x10);
        if ((-1 < iVar3) && (iVar3 = listen(_Memory[0xb],0x19), -1 < iVar3)) {
          FUN_1002ab30((int)_Memory);
          return _Memory;
        }
      }
      _free(_Memory);
      return (int *)0x0;
    }
    WSACleanup();
  }
  return (int *)0x0;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 __cdecl FUN_1002ada0(int param_1,SOCKET *param_2)

{
  uint uVar1;
  int iVar2;
  uint *puVar3;
  int iVar4;
  longlong lVar5;
  undefined4 local_8008 [4096];
  int local_4008;
  uint auStack_4004 [4096];
  int local_4;
  
  lVar5 = CONCAT44(_DAT_10052d0c,DAT_10052d08);
  local_4 = 0x1002adaa;
  if (DAT_10052d08 == 0 && _DAT_10052d0c == 0) {
    lVar5 = FUN_10017d20();
    lVar5 = lVar5 + -1;
  }
  _DAT_10052d0c = (int)((ulonglong)lVar5 >> 0x20);
  DAT_10052d08 = (int)lVar5;
  iVar2 = FUN_10017d20();
  iVar2 = iVar2 - DAT_10052d08;
  *(int *)(param_1 + 0x48) = iVar2;
  puVar3 = *(uint **)(param_1 + 0x1c);
  iVar4 = 0;
  *(int *)(param_1 + 0x40) = *(int *)(param_1 + 0x40) + iVar2;
  local_4 = 0;
  local_4008 = 0;
  if (puVar3 != *(uint **)(param_1 + 0x24)) {
    do {
      if (puVar3[0xc] != 0xffffffff) {
        uVar1 = puVar3[9];
        if (uVar1 != 0) {
          if (uVar1 < 0xe11) {
            puVar3[9] = uVar1 * 1000 + *(int *)(param_1 + 0x48);
          }
          if (*(uint *)(param_1 + 0x48) != puVar3[9] &&
              -1 < (int)(*(uint *)(param_1 + 0x48) - puVar3[9])) {
            puVar3[9] = 0;
            *puVar3 = *puVar3 | 2;
          }
        }
        if ((int)*(uint *)(param_1 + 0xc) < (int)puVar3[3]) {
          puVar3[3] = *(uint *)(param_1 + 0xc);
        }
        if (((int)puVar3[4] < (int)puVar3[3]) && ((puVar3[0xd] & 1) == 0)) {
          auStack_4004[local_4] = puVar3[0xc];
          local_8008[iVar4] = puVar3;
          iVar4 = iVar4 + 1;
          local_4 = local_4 + 1;
          local_4008 = local_4008 + 1;
        }
      }
      puVar3 = puVar3 + 0xe;
    } while (puVar3 != *(uint **)(param_1 + 0x24));
  }
  iVar2 = FUN_1002a630(param_1,param_2);
  if (iVar2 != 0) {
    FUN_1002a4b0();
  }
  return 0;
}



void * FUN_1002aee0(undefined4 param_1,char *param_2,size_t *param_3)

{
  FILE *_File;
  size_t _Count;
  void *_DstBuf;
  size_t sVar1;
  
  if ((param_2 == (char *)0x0) || (*param_2 == '\0')) {
    return (void *)0x0;
  }
  if (param_3 != (size_t *)0x0) {
    *param_3 = 0xffffffff;
  }
  _File = (FILE *)FUN_1002e478(param_2,"rb");
  if (_File == (FILE *)0x0) {
    return (void *)0x0;
  }
  _fseek(_File,0,2);
  _Count = _ftell(_File);
  _fseek(_File,0,0);
  _DstBuf = _malloc(_Count + 1);
  if (_DstBuf == (void *)0x0) {
    _fclose(_File);
    return (void *)0x0;
  }
  sVar1 = _fread(_DstBuf,1,_Count,_File);
  if (sVar1 != _Count) {
    _fclose(_File);
    _free(_DstBuf);
    return (void *)0x0;
  }
  *(undefined1 *)((int)_DstBuf + _Count) = 0;
  _fclose(_File);
  if (param_3 != (size_t *)0x0) {
    *param_3 = _Count;
  }
  return _DstBuf;
}



void __cdecl FUN_1002afa0(undefined4 param_1,void *param_2)

{
  if (param_2 != (void *)0x0) {
    _free(param_2);
  }
  return;
}



size_t __cdecl
FUN_1002afb0(undefined4 param_1,char *param_2,char *param_3,size_t param_4,int param_5)

{
  char cVar1;
  char *pcVar2;
  FILE *_File;
  long lVar3;
  size_t sVar4;
  
  if ((param_2 == (char *)0x0) || (*param_2 == '\0')) {
    return 0xffffffff;
  }
  if ((int)param_4 < 0) {
    pcVar2 = param_3;
    do {
      cVar1 = *pcVar2;
      pcVar2 = pcVar2 + 1;
    } while (cVar1 != '\0');
    param_4 = (int)pcVar2 - (int)(param_3 + 1);
  }
  _File = (FILE *)FUN_1002e478(param_2,"ab");
  if (_File == (FILE *)0x0) {
    return 0xffffffff;
  }
  if (0 < param_5) {
    lVar3 = _ftell(_File);
    if (param_5 < lVar3) {
      _fclose(_File);
      return 0xfffffffe;
    }
  }
  sVar4 = _fwrite(param_3,1,param_4,_File);
  _fclose(_File);
  return sVar4;
}



bool __cdecl FUN_1002b050(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  
  bVar1 = *param_2;
  pbVar2 = param_1;
  do {
    if (bVar1 == 0) {
      *pbVar2 = 0;
      if (((char)*param_1 < 'a') || ('z' < (char)*param_1)) {
        *param_1 = 0;
      }
      if (param_1[1] == 0) {
        *param_1 = 0;
      }
      return *param_1 != 0;
    }
    param_2 = param_2 + 1;
    if (((char)bVar1 < 'A') || ('Z' < (char)bVar1)) {
      if ((('`' < (char)bVar1) && ((char)bVar1 < '{')) ||
         (('/' < (char)bVar1 && ((char)bVar1 < ':')))) goto LAB_1002b085;
    }
    else {
      bVar1 = bVar1 ^ 0x20;
LAB_1002b085:
      *pbVar2 = bVar1;
      pbVar2 = pbVar2 + 1;
    }
    bVar1 = *param_2;
  } while( true );
}



int __cdecl
FUN_1002b0c0(char *param_1,int param_2,char *param_3,undefined4 param_4,char *param_5,char *param_6)

{
  char cVar1;
  char *_Source;
  int iVar2;
  size_t _Count;
  uint local_94 [21];
  byte local_40 [63];
  undefined1 local_1;
  
  _strncpy((char *)local_40,param_3,0x40);
  local_1 = 0;
  FUN_1002b050(local_40,local_40);
  _Source = param_5;
  _Count = 0;
  cVar1 = *param_5;
  while ('/' < cVar1) {
    iVar2 = _Count + 1;
    _Count = _Count + 1;
    cVar1 = param_5[iVar2];
  }
  FUN_10012e70(local_94);
  FUN_10012ea0(local_94,_Source,_Count);
  FUN_10012ea0(local_94,(char *)local_40,-1);
  FUN_10012ea0(local_94,(char *)&param_4,4);
  FUN_10012ea0(local_94,param_6,-1);
  FUN_10012ea0(local_94,_Source,_Count);
  iVar2 = 0;
  *param_1 = '\0';
  if ((int)(_Count + 0x22) < param_2) {
    _strncpy(param_1,_Source,_Count);
    param_1[_Count] = ',';
    FUN_10012f00(local_94,param_1 + _Count + 1,0x21);
    iVar2 = _Count + 0x21;
  }
  return iVar2;
}



void __cdecl FUN_1002b1c0(int param_1,char *param_2,int param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  
  if (DAT_10052e18 == 0) {
    DAT_10052e18 = 1;
    FUN_1002b1c0(0x10052d10,"hello world",-1,10);
  }
  if (param_4 < 0) {
    param_4 = -param_4;
  }
  else {
    iVar2 = 0;
    do {
      *(char *)(iVar2 + param_1) = (char)iVar2;
      iVar2 = iVar2 + 1;
    } while (iVar2 < 0x100);
    *(undefined1 *)(param_1 + 0x100) = 0;
    *(undefined4 *)(param_1 + 0x104) = 0;
  }
  bVar6 = param_3 < 0;
  if (bVar6) {
    param_3 = 0;
    if (*param_2 == '\0') {
      return;
    }
    do {
      param_3 = param_3 + 1;
    } while (param_2[param_3] != '\0');
    bVar6 = param_3 < 0;
  }
  if (param_3 != 0 && !bVar6) {
    uVar5 = 0;
    uVar4 = 0;
    if (0 < param_4 * 0x100) {
      uVar3 = 0;
      do {
        uVar5 = uVar5 >> 8 ^
                *(uint *)(&DAT_1003eab8 + ((byte)param_2[(int)uVar4 % param_3] ^ uVar3) * 4);
        bVar1 = *(byte *)((uVar4 & 0xff) + param_1);
        uVar5 = uVar5 >> 8 ^ *(uint *)(&DAT_1003eab8 + (uVar5 & 0xff ^ (uint)bVar1) * 4);
        uVar3 = uVar5 & 0xff;
        *(undefined1 *)((uVar4 & 0xff) + param_1) = *(undefined1 *)(uVar3 + param_1);
        uVar4 = uVar4 + 1;
        *(byte *)(uVar3 + param_1) = bVar1;
      } while ((int)uVar4 < param_4 * 0x100);
    }
  }
  return;
}



void __cdecl FUN_1002b2c0(int param_1,byte *param_2,int param_3)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  
  bVar3 = *(byte *)(param_1 + 0x100);
  uVar5 = *(uint *)(param_1 + 0x104);
  if (0 < param_3) {
    pbVar6 = (byte *)((uint)bVar3 + param_1);
    uVar4 = uVar5 & 0xff;
    do {
      uVar5 = uVar5 >> 8 ^ *(uint *)(&DAT_1003eab8 + (*pbVar6 ^ uVar4) * 4);
      bVar3 = bVar3 + 1;
      pbVar6 = (byte *)((uint)bVar3 + param_1);
      bVar1 = *pbVar6;
      uVar4 = uVar5 & 0xff;
      bVar2 = *(byte *)(uVar4 + param_1);
      *pbVar6 = bVar2;
      *(byte *)(uVar4 + param_1) = bVar1;
      *param_2 = *param_2 ^ *(byte *)(((uint)bVar1 - (uint)bVar2 & 0xff) + param_1);
      param_2 = param_2 + 1;
      param_3 = param_3 + -1;
    } while (param_3 != 0);
  }
  *(uint *)(param_1 + 0x104) = uVar5;
  *(byte *)(param_1 + 0x100) = bVar3;
  return;
}



undefined4 __cdecl
FUN_1002b360(char *param_1,int param_2,int param_3,char *param_4,int param_5,int param_6)

{
  byte bVar1;
  char cVar2;
  int iVar3;
  byte local_109;
  undefined1 local_108 [264];
  
  local_109 = 0;
  FUN_1002b1c0((int)local_108,param_4,param_5,param_6);
  iVar3 = 0;
  if (0 < param_2 + -1) {
    while( true ) {
      bVar1 = *(byte *)(iVar3 + param_3);
      iVar3 = iVar3 + 1;
      if (bVar1 == 0) break;
      FUN_1002b2c0((int)local_108,&local_109,1);
      cVar2 = (char)((int)(((uint)bVar1 - (uint)local_109 % 0x60) + 0x40) % 0x60) + ' ';
      *param_1 = cVar2;
      if ((cVar2 == '\x7f') || (param_1 = param_1 + 1, param_2 + -1 <= iVar3)) break;
    }
  }
  if (iVar3 < param_2) {
    *param_1 = '\0';
  }
  return 0;
}



uint __cdecl FUN_1002b420(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  int iVar6;
  uint local_20 [8];
  
  uVar1 = param_1[2];
  uVar2 = (uint)((*param_1 & param_1[1]) == (param_1[1] & *param_2));
  uVar3 = uVar2;
  if (0 < (int)uVar1) {
    iVar6 = 0;
    if (0 < (int)uVar1) {
      puVar5 = param_2 + 3;
      do {
        uVar3 = *(uint *)(((int)param_1 - (int)param_2) + (int)puVar5);
        uVar4 = uVar3 >> 3;
        switch(uVar3 & 3) {
        case 0:
          local_20[iVar6] = (uint)(*puVar5 == uVar4);
          break;
        case 1:
          local_20[iVar6] = (uint)(*puVar5 != uVar4);
          break;
        case 2:
          local_20[iVar6] = (uint)((int)*puVar5 <= (int)uVar4);
          break;
        case 3:
          local_20[iVar6] = (uint)((int)uVar4 <= (int)*puVar5);
          break;
        default:
          local_20[iVar6] = 1;
        }
        iVar6 = iVar6 + 1;
        puVar5 = puVar5 + 1;
      } while (iVar6 < (int)uVar1);
    }
    iVar6 = 1;
    if (1 < (int)uVar1) {
      puVar5 = param_1 + 4;
      do {
        if ((*puVar5 & 4) == 0) {
          local_20[0] = local_20[0] & local_20[iVar6];
        }
        else if ((*puVar5 & 4) == 4) {
          local_20[0] = local_20[0] | local_20[iVar6];
        }
        iVar6 = iVar6 + 1;
        puVar5 = puVar5 + 1;
      } while (iVar6 < (int)uVar1);
    }
    if ((param_1[3] & 4) == 0) {
      return local_20[0] & uVar2;
    }
    uVar3 = local_20[0];
    if ((param_1[3] & 4) == 4) {
      return local_20[0] | uVar2;
    }
  }
  return uVar3;
}



int FUN_1002b540(void)

{
  char cVar1;
  byte bVar2;
  char *pcVar3;
  int iVar4;
  byte *pbVar5;
  undefined4 *unaff_ESI;
  
  pcVar3 = (char *)unaff_ESI[0x102];
  cVar1 = *pcVar3;
  iVar4 = 0;
  if (cVar1 != '%') {
    if ((cVar1 == '#') || (cVar1 == '$')) {
      pbVar5 = (byte *)(pcVar3 + 1);
      bVar2 = *pbVar5;
      while (('/' < (char)bVar2 && ((char)bVar2 < ':'))) {
        pbVar5 = pbVar5 + 1;
        iVar4 = (bVar2 & 0xf) + iVar4 * 10;
        bVar2 = *pbVar5;
      }
    }
    return iVar4;
  }
  iVar4 = 0;
  pbVar5 = FUN_10002000((byte *)*unaff_ESI,(byte *)(pcVar3 + 1));
  iVar4 = FUN_10002e80(pbVar5,iVar4);
  return iVar4;
}



int __fastcall FUN_1002b5a0(undefined4 *param_1)

{
  char cVar1;
  char *pcVar2;
  byte *pbVar3;
  char *pcVar4;
  int iVar5;
  byte *pbVar6;
  byte *pbVar7;
  
  pcVar2 = (char *)param_1[0x102];
  cVar1 = *pcVar2;
  if (cVar1 == '%') {
    pbVar7 = &DAT_10039247;
    iVar5 = param_1[0x103] + -1;
    pbVar6 = (byte *)(pcVar2 + 1);
    pbVar3 = FUN_10002000((byte *)*param_1,pbVar6);
    iVar5 = FUN_100030f0(pbVar3,pbVar6,iVar5,pbVar7);
    *pcVar2 = '$';
    return iVar5;
  }
  if ((cVar1 != '$') && (cVar1 != '#')) {
    *pcVar2 = '$';
    pcVar2[1] = '\0';
    return 0;
  }
  pcVar4 = pcVar2 + 1;
  *pcVar2 = '$';
  do {
    cVar1 = *pcVar4;
    pcVar4 = pcVar4 + 1;
  } while (cVar1 != '\0');
  return (int)pcVar4 - (int)(pcVar2 + 2);
}



byte * __cdecl FUN_1002b610(int param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  
  pbVar2 = *(byte **)(param_1 + 0x408);
  bVar1 = *param_2;
  while ((bVar1 != 0 && ((char)bVar1 < '!'))) {
    pbVar4 = param_2 + 1;
    param_2 = param_2 + 1;
    bVar1 = *pbVar4;
  }
  bVar1 = *param_2;
  if (bVar1 == 0x28) {
    pbVar2 = FUN_1002bf80((undefined4 *)param_1,param_2 + 1);
    bVar1 = *pbVar2;
    while ((bVar1 != 0 && ((char)bVar1 < '!'))) {
      pbVar4 = pbVar2 + 1;
      pbVar2 = pbVar2 + 1;
      bVar1 = *pbVar4;
    }
    if (*pbVar2 == 0x29) {
      return pbVar2 + 1;
    }
  }
  else {
    if (bVar1 == 0x21) {
      pbVar2 = FUN_1002b610(param_1,param_2 + 1);
      iVar3 = FUN_1002b540();
      _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,(uint)(iVar3 == 0));
      return pbVar2;
    }
    if (bVar1 != 0x22) {
      if ((((char)bVar1 < '0') || ('9' < (char)bVar1)) && (bVar1 != 0x2d)) {
        if ((char)bVar1 < '@') {
          *pbVar2 = 0;
          pbVar2[1] = 0;
          return param_2;
        }
        *pbVar2 = 0x25;
        while( true ) {
          pbVar2 = pbVar2 + 1;
          bVar1 = *param_2;
          if ((((char)bVar1 < '0') || ('9' < (char)bVar1)) && ((char)bVar1 < '@')) break;
          *pbVar2 = bVar1;
          param_2 = param_2 + 1;
        }
      }
      else {
        *pbVar2 = 0x23;
        pbVar2[1] = *param_2;
        pbVar2 = pbVar2 + 2;
        bVar1 = param_2[1];
        pbVar4 = param_2;
        while ((param_2 = pbVar4 + 1, '/' < (char)bVar1 && ((char)bVar1 < ':'))) {
          *pbVar2 = bVar1;
          pbVar2 = pbVar2 + 1;
          bVar1 = pbVar4[2];
          pbVar4 = param_2;
        }
      }
      *pbVar2 = 0;
      return param_2;
    }
    *pbVar2 = 0x24;
    FUN_100030f0(param_2,pbVar2 + 1,*(int *)(param_1 + 0x40c) + -1,&DAT_10039247);
    bVar1 = param_2[1];
    while (pbVar2 = param_2 + 1, '\x1f' < (char)bVar1) {
      if (bVar1 == 0x22) goto LAB_1002b6d8;
      bVar1 = param_2[2];
      param_2 = pbVar2;
    }
    if (*pbVar2 == 0x22) {
LAB_1002b6d8:
      return param_2 + 2;
    }
  }
  return pbVar2;
}



byte * __cdecl FUN_1002b750(int param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  int iVar5;
  
  pbVar3 = FUN_1002b610(param_1,param_2);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar3;
  if ((bVar2 == 0x2a) && (pbVar3[1] != 0x2a)) {
    iVar4 = FUN_1002b540();
    pbVar3 = FUN_1002b750(param_1,pbVar3 + 1);
    iVar5 = FUN_1002b540();
    _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,iVar5 * iVar4);
    return pbVar3;
  }
  if ((bVar2 == 0x2f) && (pbVar3[1] != 0x2f)) {
    iVar4 = FUN_1002b540();
    pbVar3 = FUN_1002b750(param_1,pbVar3 + 1);
    iVar5 = FUN_1002b540();
    if (iVar5 != 0) {
      _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,iVar4 / iVar5);
      return pbVar3;
    }
    _sprintf(*(char **)(param_1 + 0x408),"%cDIV0",0x23);
    return pbVar3;
  }
  if ((bVar2 == 0x25) && (pbVar3[1] != 0x25)) {
    iVar4 = FUN_1002b540();
    pbVar3 = FUN_1002b750(param_1,pbVar3 + 1);
    iVar5 = FUN_1002b540();
    if (iVar5 != 0) {
      _sprintf(*(char **)(param_1 + 0x408),"%c%d",0x23,iVar4 % iVar5);
      return pbVar3;
    }
    _sprintf(*(char **)(param_1 + 0x408),"%cMOD0",0x23);
  }
  return pbVar3;
}



byte * __cdecl FUN_1002b8a0(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  undefined1 uVar3;
  byte *pbVar4;
  int iVar5;
  int iVar6;
  
  pbVar4 = FUN_1002b750((int)param_1,param_2);
  bVar2 = *pbVar4;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar4 + 1;
    pbVar4 = pbVar4 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar4;
  if (bVar2 != 0x2b) {
    if (bVar2 == 0x2d) {
      iVar5 = FUN_1002b540();
      pbVar4 = FUN_1002b8a0(param_1,pbVar4 + 1);
      iVar6 = FUN_1002b540();
      _sprintf((char *)param_1[0x102],"%c%d",0x23,iVar5 - iVar6);
      return pbVar4;
    }
    if (bVar2 == 0x23) {
      iVar6 = FUN_1002b5a0(param_1);
      iVar5 = param_1[0x102];
      param_1[0x102] = (undefined1 *)(iVar5 + iVar6);
      param_1[0x103] = param_1[0x103] - iVar6;
      uVar3 = *(undefined1 *)(iVar5 + iVar6);
      pbVar4 = FUN_1002b8a0(param_1,pbVar4 + 1);
      FUN_1002b5a0(param_1);
      *(undefined1 *)param_1[0x102] = uVar3;
      param_1[0x102] = param_1[0x102] - iVar6;
      param_1[0x103] = param_1[0x103] + iVar6;
    }
    return pbVar4;
  }
  iVar5 = FUN_1002b540();
  pbVar4 = FUN_1002b8a0(param_1,pbVar4 + 1);
  iVar6 = FUN_1002b540();
  _sprintf((char *)param_1[0x102],"%c%d",0x23,iVar6 + iVar5);
  return pbVar4;
}



byte * __cdecl FUN_1002b9b0(undefined4 *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte *pbVar5;
  int iVar6;
  byte *_Dest;
  uint uVar7;
  char *pcVar8;
  bool bVar9;
  
  pbVar2 = FUN_1002b8a0(param_1,param_2);
  bVar1 = *pbVar2;
  while ((bVar1 != 0 && ((char)bVar1 < '!'))) {
    pbVar5 = pbVar2 + 1;
    pbVar2 = pbVar2 + 1;
    bVar1 = *pbVar5;
  }
  bVar1 = *pbVar2;
  if ((bVar1 == 0x3d) && (pbVar2[1] == 0x3d)) {
    iVar3 = FUN_1002b5a0(param_1);
    iVar3 = iVar3 + 2;
    param_1[0x102] = param_1[0x102] + iVar3;
    param_1[0x103] = param_1[0x103] - iVar3;
    pbVar4 = FUN_1002b8a0(param_1,pbVar2 + 2);
    FUN_1002b5a0(param_1);
    _Dest = (byte *)(param_1[0x102] - iVar3);
    param_1[0x103] = param_1[0x103] + iVar3;
    param_1[0x102] = _Dest;
    pbVar2 = _Dest + iVar3;
    pbVar5 = _Dest;
    do {
      bVar1 = *pbVar5;
      bVar9 = bVar1 < *pbVar2;
      if (bVar1 != *pbVar2) {
LAB_1002ba80:
        uVar7 = (uint)(1 - bVar9 == (uint)(bVar9 != 0));
        goto LAB_1002bb33;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar5[1];
      bVar9 = bVar1 < pbVar2[1];
      if (bVar1 != pbVar2[1]) goto LAB_1002ba80;
      pbVar5 = pbVar5 + 2;
      pbVar2 = pbVar2 + 2;
    } while (bVar1 != 0);
    uVar7 = 1;
  }
  else {
    if ((bVar1 != 0x21) || (pbVar2[1] != 0x3d)) {
      if ((bVar1 == 0x7e) && (pbVar2[1] == 0x3d)) {
        iVar3 = FUN_1002b5a0(param_1);
        iVar3 = iVar3 + 2;
        param_1[0x102] = param_1[0x102] + iVar3;
        param_1[0x103] = param_1[0x103] - iVar3;
        pbVar2 = FUN_1002b8a0(param_1,pbVar2 + 2);
        FUN_1002b5a0(param_1);
        pcVar8 = (char *)(param_1[0x102] - iVar3);
        param_1[0x103] = param_1[0x103] + iVar3;
        param_1[0x102] = pcVar8;
        pcVar8 = _strstr(pcVar8,pcVar8 + iVar3);
        _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)(pcVar8 != (char *)0x0));
        return pbVar2;
      }
      if (bVar1 == 0x3c) {
        if (pbVar2[1] != 0x3d) {
          iVar3 = FUN_1002b540();
          pbVar2 = FUN_1002b9b0(param_1,pbVar2 + 1);
          iVar6 = FUN_1002b540();
          _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)(iVar3 < iVar6));
          return pbVar2;
        }
        iVar3 = FUN_1002b540();
        pbVar2 = FUN_1002b9b0(param_1,pbVar2 + 2);
        iVar6 = FUN_1002b540();
        bVar9 = iVar3 <= iVar6;
      }
      else {
        if (bVar1 != 0x3e) {
          return pbVar2;
        }
        if (pbVar2[1] != 0x3d) {
          iVar3 = FUN_1002b540();
          pbVar2 = FUN_1002b9b0(param_1,pbVar2 + 1);
          iVar6 = FUN_1002b540();
          _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)(iVar6 < iVar3));
          return pbVar2;
        }
        iVar3 = FUN_1002b540();
        pbVar2 = FUN_1002b9b0(param_1,pbVar2 + 2);
        iVar6 = FUN_1002b540();
        bVar9 = iVar6 <= iVar3;
      }
      _sprintf((char *)param_1[0x102],"%c%d",0x23,(uint)bVar9);
      return pbVar2;
    }
    iVar3 = FUN_1002b5a0(param_1);
    iVar3 = iVar3 + 2;
    param_1[0x102] = param_1[0x102] + iVar3;
    param_1[0x103] = param_1[0x103] - iVar3;
    pbVar4 = FUN_1002b8a0(param_1,pbVar2 + 2);
    FUN_1002b5a0(param_1);
    _Dest = (byte *)(param_1[0x102] - iVar3);
    param_1[0x103] = param_1[0x103] + iVar3;
    param_1[0x102] = _Dest;
    pbVar2 = _Dest + iVar3;
    pbVar5 = _Dest;
    do {
      bVar1 = *pbVar5;
      bVar9 = bVar1 < *pbVar2;
      if (bVar1 != *pbVar2) {
LAB_1002bb27:
        iVar3 = (1 - (uint)bVar9) - (uint)(bVar9 != 0);
        goto LAB_1002bb2c;
      }
      if (bVar1 == 0) break;
      bVar1 = pbVar5[1];
      bVar9 = bVar1 < pbVar2[1];
      if (bVar1 != pbVar2[1]) goto LAB_1002bb27;
      pbVar5 = pbVar5 + 2;
      pbVar2 = pbVar2 + 2;
    } while (bVar1 != 0);
    iVar3 = 0;
LAB_1002bb2c:
    uVar7 = (uint)(iVar3 != 0);
  }
LAB_1002bb33:
  _sprintf((char *)_Dest,"%c%d",0x23,uVar7);
  return pbVar4;
}



byte * __cdecl FUN_1002bce0(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  uint uVar4;
  uint uVar5;
  
  pbVar3 = FUN_1002b9b0(param_1,param_2);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  bVar2 = *pbVar3;
  if (bVar2 != 0x26) {
    if (bVar2 == 0x7c) {
      uVar4 = FUN_1002b540();
      pbVar3 = FUN_1002bce0(param_1,pbVar3 + 1);
      uVar5 = FUN_1002b540();
      _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar5 | uVar4);
      return pbVar3;
    }
    if (bVar2 == 0x5e) {
      uVar4 = FUN_1002b540();
      pbVar3 = FUN_1002bce0(param_1,pbVar3 + 1);
      uVar5 = FUN_1002b540();
      _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar5 ^ uVar4);
    }
    return pbVar3;
  }
  uVar4 = FUN_1002b540();
  pbVar3 = FUN_1002bce0(param_1,pbVar3 + 1);
  uVar5 = FUN_1002b540();
  _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar5 & uVar4);
  return pbVar3;
}



byte * __cdecl FUN_1002bdc0(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  
  pbVar3 = FUN_1002bce0(param_1,param_2);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  if ((*pbVar3 == 0x26) && (pbVar3[1] == 0x26)) {
    iVar4 = FUN_1002b540();
    pbVar3 = FUN_1002bdc0(param_1,pbVar3 + 2);
    if ((iVar4 == 0) || (iVar4 = FUN_1002b540(), iVar4 == 0)) {
      uVar5 = 0;
    }
    else {
      uVar5 = 1;
    }
    _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar5);
    return pbVar3;
  }
  if ((*pbVar3 == 0x7c) && (pbVar3[1] == 0x7c)) {
    uVar6 = FUN_1002b540();
    pbVar3 = FUN_1002bdc0(param_1,pbVar3 + 2);
    uVar7 = FUN_1002b540();
    _sprintf((char *)param_1[0x102],"%c%d",0x23,uVar7 | uVar6);
  }
  return pbVar3;
}



byte * __cdecl FUN_1002be90(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  char *pcVar2;
  byte bVar3;
  char cVar4;
  byte *pbVar5;
  char *pcVar6;
  char *pcVar7;
  
  pbVar5 = FUN_1002bdc0(param_1,param_2);
  bVar3 = *pbVar5;
  while ((bVar3 != 0 && ((char)bVar3 < '!'))) {
    pbVar1 = pbVar5 + 1;
    pbVar5 = pbVar5 + 1;
    bVar3 = *pbVar1;
  }
  if ((*pbVar5 == 0x3d) && (pbVar5[1] != 0x3d)) {
    pcVar6 = (char *)param_1[0x102];
    pcVar7 = pcVar6 + 1;
    do {
      cVar4 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar4 != '\0');
    pcVar6 = pcVar6 + (1 - (int)pcVar7);
    param_1[0x102] = pcVar6 + param_1[0x102];
    param_1[0x103] = param_1[0x103] - (int)pcVar6;
    pbVar5 = FUN_1002be90(param_1,pbVar5 + 1);
    FUN_1002b5a0(param_1);
    FUN_10002620((byte *)*param_1,param_1[1],(byte *)((param_1[0x102] - (int)pcVar6) + 1),
                 (byte *)(param_1[0x102] + 1));
    pcVar7 = (char *)(param_1[0x102] - (int)pcVar6);
    param_1[0x102] = pcVar7;
    param_1[0x103] = pcVar6 + param_1[0x103];
    cVar4 = pcVar7[(int)pcVar6];
    while (cVar4 != '\0') {
      *pcVar7 = cVar4;
      pcVar2 = pcVar7 + (int)(pcVar6 + 1);
      pcVar7 = pcVar7 + 1;
      cVar4 = *pcVar2;
    }
    *pcVar7 = '\0';
  }
  return pbVar5;
}



byte * __cdecl FUN_1002bf80(undefined4 *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  char cVar3;
  byte *pbVar4;
  int iVar5;
  char *pcVar6;
  
  pbVar4 = FUN_1002be90(param_1,param_2);
  bVar2 = *pbVar4;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar4 + 1;
    pbVar4 = pbVar4 + 1;
    bVar2 = *pbVar1;
  }
  if (*pbVar4 == 0x3f) {
    iVar5 = FUN_1002b540();
    pbVar4 = FUN_1002bf80(param_1,pbVar4 + 1);
    bVar2 = *pbVar4;
    while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
      pbVar1 = pbVar4 + 1;
      pbVar4 = pbVar4 + 1;
      bVar2 = *pbVar1;
    }
    if (iVar5 == 0) {
      pcVar6 = (char *)0x0;
    }
    else {
      pcVar6 = (char *)(param_1 + 2);
      do {
        cVar3 = *pcVar6;
        pcVar6 = pcVar6 + 1;
      } while (cVar3 != '\0');
      pcVar6 = pcVar6 + (1 - ((int)param_1 + 9));
    }
    if (*pbVar4 == 0x3a) {
      param_1[0x102] = pcVar6 + param_1[0x102];
      param_1[0x103] = param_1[0x103] - (int)pcVar6;
      pbVar4 = FUN_1002bf80(param_1,pbVar4 + 1);
      param_1[0x102] = param_1[0x102] - (int)pcVar6;
      param_1[0x103] = pcVar6 + param_1[0x103];
    }
    return pbVar4;
  }
  return pbVar4;
}



void __fastcall FUN_1002c050(undefined4 *param_1)

{
  byte *pbVar1;
  byte bVar2;
  byte *in_EAX;
  byte *pbVar3;
  
  pbVar3 = FUN_1002bf80(param_1,in_EAX);
  bVar2 = *pbVar3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar1 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar1;
  }
  if (*pbVar3 == 0x3b) {
    bVar2 = pbVar3[1];
    while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
      bVar2 = pbVar3[2];
      pbVar3 = pbVar3 + 1;
    }
  }
  return;
}



int __cdecl
FUN_1002c090(undefined4 param_1,undefined4 param_2,byte *param_3,char *param_4,int param_5)

{
  byte *pbVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  bool bVar5;
  undefined4 local_410;
  undefined4 local_40c;
  undefined1 local_408 [1024];
  undefined1 *local_8;
  undefined4 local_4;
  
  local_8 = local_408;
  bVar2 = *param_3;
  local_4 = 0x400;
  local_410 = param_1;
  local_40c = param_2;
  pbVar3 = param_3;
  while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
    pbVar4 = pbVar3 + 1;
    pbVar3 = pbVar3 + 1;
    bVar2 = *pbVar4;
  }
  if (*pbVar3 == 0x7b) {
    pbVar4 = pbVar3 + 1;
    while( true ) {
      pbVar3 = FUN_1002bf80(&local_410,pbVar4);
      bVar2 = *pbVar3;
      while ((bVar2 != 0 && ((char)bVar2 < '!'))) {
        pbVar1 = pbVar3 + 1;
        pbVar3 = pbVar3 + 1;
        bVar2 = *pbVar1;
      }
      if (*pbVar3 == 0x3b) {
        bVar2 = pbVar3[1];
        while ((pbVar3 = pbVar3 + 1, bVar2 != 0 && ((char)bVar2 < '!'))) {
          bVar2 = pbVar3[1];
        }
      }
      if (*pbVar3 == 0) goto LAB_1002c16b;
      if (*pbVar3 == 0x7d) break;
      bVar5 = pbVar3 == pbVar4;
      pbVar4 = pbVar3;
      if (bVar5) {
        pbVar4 = pbVar3 + 1;
      }
    }
    pbVar3 = pbVar3 + 1;
  }
  else if (*pbVar3 == 0x28) {
    pbVar3 = (byte *)FUN_1002c050(&local_410);
    if (*pbVar3 == 0x29) {
      pbVar3 = pbVar3 + 1;
    }
  }
  else {
    pbVar3 = (byte *)FUN_1002c050(&local_410);
  }
LAB_1002c16b:
  if (param_4 != (char *)0x0) {
    FUN_1002b5a0(&local_410);
    FUN_10002230(param_4,param_5,local_8 + 1);
  }
  for (; (pbVar3 != param_3 && ((char)pbVar3[-1] < '!')); pbVar3 = pbVar3 + -1) {
  }
  return (int)pbVar3 - (int)param_3;
}



void __cdecl FUN_1002c1c0(int param_1,undefined4 param_2)

{
  *(undefined4 *)(param_1 + 0x20) = param_2;
  return;
}



void __cdecl FUN_1002c1d0(int *param_1)

{
  void *_Memory;
  int iVar1;
  
  iVar1 = *param_1;
  while (iVar1 != 0) {
    _Memory = (void *)*param_1;
    *param_1 = *(int *)((int)_Memory + 4);
    _free(_Memory);
    iVar1 = *param_1;
  }
  _free(param_1);
  return;
}



int FUN_1002c210(undefined4 *param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  int iVar5;
  
  if (param_2 < 0x10) {
    param_2 = 0x10;
  }
  iVar1 = param_2 + 1;
  puVar3 = (undefined4 *)_malloc(param_1[7] * iVar1);
  if (puVar3 != (undefined4 *)0x0) {
    uVar2 = *param_1;
    iVar5 = 1;
    *puVar3 = uVar2;
    puVar3[1] = uVar2;
    *param_1 = puVar3;
    if (1 < iVar1) {
      do {
        uVar2 = param_1[1];
        puVar4 = (undefined4 *)(param_1[7] * iVar5 + (int)puVar3);
        iVar5 = iVar5 + 1;
        *puVar4 = uVar2;
        puVar4[1] = uVar2;
        param_1[1] = puVar4;
      } while (iVar5 < iVar1);
    }
    return param_2;
  }
  return 0;
}



undefined4 __cdecl FUN_1002c280(int param_1,char *param_2,char *param_3,char *param_4,uint param_5)

{
  undefined4 *puVar1;
  int *piVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  undefined4 *puVar7;
  char cVar8;
  undefined4 *puVar9;
  char *pcVar10;
  int iVar11;
  int aiStack_80 [32];
  
  if ((int)param_3 < 0) {
    pcVar3 = param_2;
    do {
      cVar8 = *pcVar3;
      pcVar3 = pcVar3 + 1;
    } while (cVar8 != '\0');
    param_3 = pcVar3 + (1 - (int)(param_2 + 1));
  }
  if (*(int *)(param_1 + 0xc) < (int)param_3) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x14) < (int)param_5) {
    return 0xfffffffe;
  }
  if ((*(int *)(param_1 + 4) == 0) && (iVar4 = FUN_1002c210(param_1,0x400), iVar4 < 1)) {
    return 0xfffffffd;
  }
  puVar1 = *(undefined4 **)(param_1 + 4);
  *(undefined1 *)((int)puVar1 + 0xb) = (undefined1)param_5;
  *(char *)((int)puVar1 + 10) = (char)param_3;
  uVar6 = (uint)param_3 >> 2;
  pcVar3 = (char *)(puVar1 + 3);
  *(undefined1 *)(puVar1 + 2) = 0;
  pcVar10 = pcVar3;
  for (; uVar6 != 0; uVar6 = uVar6 - 1) {
    *(undefined4 *)pcVar10 = *(undefined4 *)param_2;
    param_2 = param_2 + 4;
    pcVar10 = pcVar10 + 4;
  }
  for (uVar6 = (uint)param_3 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
    *pcVar10 = *param_2;
    param_2 = param_2 + 1;
    pcVar10 = pcVar10 + 1;
  }
  if ((param_4 != (char *)0x0) && (0 < (int)param_5)) {
    pcVar10 = pcVar3 + *(int *)(param_1 + 0x10);
    for (uVar6 = param_5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
      *(undefined4 *)pcVar10 = *(undefined4 *)param_4;
      param_4 = param_4 + 4;
      pcVar10 = pcVar10 + 4;
    }
    for (uVar6 = param_5 & 3; uVar6 != 0; uVar6 = uVar6 - 1) {
      *pcVar10 = *param_4;
      param_4 = param_4 + 1;
      pcVar10 = pcVar10 + 1;
    }
  }
  puVar9 = *(undefined4 **)(param_1 + 8);
  iVar4 = 0;
  if (puVar9 == (undefined4 *)0x0) {
    *(undefined4 **)(param_1 + 8) = puVar1;
    *(undefined4 *)(param_1 + 4) = *puVar1;
    puVar1[1] = 0;
    *puVar1 = 0;
    return 1;
  }
  do {
    iVar11 = iVar4;
    aiStack_80[iVar11] = (int)puVar9;
    iVar5 = (**(code **)(param_1 + 0x20))(pcVar3,puVar9 + 3);
    if (iVar5 < 0) {
      puVar9 = (undefined4 *)*puVar9;
    }
    else {
      if (iVar5 < 1) {
        return 0;
      }
      puVar9 = (undefined4 *)puVar9[1];
    }
    iVar4 = iVar11 + 1;
  } while (puVar9 != (undefined4 *)0x0);
  if (iVar5 < 0) {
    *(undefined4 *)aiStack_80[iVar11] = puVar1;
  }
  else {
    ((undefined4 *)aiStack_80[iVar11])[1] = puVar1;
  }
  *(undefined4 *)(param_1 + 4) = *puVar1;
  puVar9 = (undefined4 *)aiStack_80[iVar11];
  puVar1[1] = 0;
  *puVar1 = 0;
  cVar8 = *(char *)(puVar9 + 2) + ((undefined4 *)*puVar9 != puVar1) * '\x02' + -1;
  *(char *)(puVar9 + 2) = cVar8;
  while( true ) {
    if ((cVar8 < -1) || ('\x01' < *(char *)(puVar9 + 2))) {
      puVar1 = (undefined4 *)aiStack_80[iVar11 + 1];
      iVar4 = (int)*(char *)(puVar1 + 2) + (int)*(char *)(puVar9 + 2);
      if (iVar4 == -3) {
        *(undefined1 *)(puVar9 + 2) = 0;
        *(undefined1 *)(puVar1 + 2) = 0;
        *puVar9 = puVar1[1];
        puVar1[1] = puVar9;
        puVar7 = puVar1;
      }
      else if (iVar4 == -1) {
        puVar7 = (undefined4 *)puVar1[1];
        *puVar9 = puVar7[1];
        puVar1[1] = *puVar7;
        puVar7[1] = puVar9;
        *puVar7 = puVar1;
        *(bool *)(puVar9 + 2) = *(char *)(puVar7 + 2) == -1;
        *(char *)(puVar1 + 2) = (*(char *)(puVar7 + 2) != '\x01') + -1;
        *(undefined1 *)(puVar7 + 2) = 0;
      }
      else if (iVar4 == 1) {
        puVar7 = (undefined4 *)*puVar1;
        puVar9[1] = *puVar7;
        *puVar1 = puVar7[1];
        *puVar7 = puVar9;
        puVar7[1] = puVar1;
        *(char *)(puVar9 + 2) = (*(char *)(puVar7 + 2) != '\x01') + -1;
        *(bool *)(puVar1 + 2) = *(char *)(puVar7 + 2) == -1;
        *(undefined1 *)(puVar7 + 2) = 0;
      }
      else {
        puVar7 = (undefined4 *)0x0;
        if (iVar4 == 3) {
          *(undefined1 *)(puVar9 + 2) = 0;
          *(undefined1 *)(puVar1 + 2) = 0;
          puVar9[1] = *puVar1;
          *puVar1 = puVar9;
          puVar7 = puVar1;
        }
      }
      if (iVar11 == 0) {
        *(undefined4 **)(param_1 + 8) = puVar7;
        return 1;
      }
      piVar2 = (int *)aiStack_80[iVar11 + -1];
      if (*piVar2 == aiStack_80[iVar11]) {
        *piVar2 = (int)puVar7;
        return 1;
      }
      piVar2[1] = (int)puVar7;
      return 1;
    }
    if (*(char *)(puVar9 + 2) == '\0') {
      return 1;
    }
    if (iVar11 == 0) break;
    puVar1 = (undefined4 *)aiStack_80[iVar11 + -1];
    iVar11 = iVar11 + -1;
    cVar8 = *(char *)(puVar1 + 2) + ((undefined4 *)*puVar1 != puVar9) * '\x02' + -1;
    *(char *)(puVar1 + 2) = cVar8;
    puVar9 = puVar1;
  }
  return 1;
}



undefined4 __cdecl FUN_1002c550(int param_1,undefined4 param_2)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  undefined4 *puVar4;
  char cVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  int *piVar9;
  int *piVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  int aiStack_80 [32];
  
  piVar1 = (int *)(param_1 + 8);
  piVar10 = (int *)*piVar1;
  iVar11 = 0;
  if (piVar10 != (int *)0x0) {
    while( true ) {
      aiStack_80[iVar11] = (int)piVar10;
      iVar12 = iVar11 + 1;
      iVar6 = (**(code **)(param_1 + 0x20))(param_2,piVar10 + 3);
      if (iVar6 == 0) break;
      if (iVar6 < 0) {
        piVar10 = (int *)*piVar10;
      }
      else {
        piVar10 = (int *)piVar10[1];
      }
      iVar11 = iVar12;
      if (piVar10 == (int *)0x0) {
        return 0xffffffff;
      }
    }
    iVar6 = *piVar10;
    if (iVar6 != 0) {
      iVar2 = *(int *)(iVar6 + 4);
      aiStack_80[iVar12] = iVar6;
      iVar12 = iVar11 + 2;
      while (iVar2 != 0) {
        iVar11 = *(int *)(iVar2 + 4);
        aiStack_80[iVar12] = iVar2;
        iVar12 = iVar12 + 1;
        iVar6 = iVar2;
        iVar2 = iVar11;
      }
      uVar7 = *(int *)(param_1 + 0x18) + *(int *)(param_1 + 0x10);
      piVar13 = (int *)(iVar6 + 0xc);
      piVar10 = piVar10 + 3;
      for (uVar8 = uVar7 >> 2; uVar8 != 0; uVar8 = uVar8 - 1) {
        *piVar10 = *piVar13;
        piVar13 = piVar13 + 1;
        piVar10 = piVar10 + 1;
      }
      for (uVar7 = uVar7 & 3; uVar7 != 0; uVar7 = uVar7 - 1) {
        *(char *)piVar10 = (char)*piVar13;
        piVar13 = (int *)((int)piVar13 + 1);
        piVar10 = (int *)((int)piVar10 + 1);
      }
    }
    piVar10 = (int *)aiStack_80[iVar12 + -1];
    iVar11 = *piVar10;
    iVar6 = iVar12 + -1;
    if (iVar11 == 0) {
      iVar11 = piVar10[1];
    }
    iVar2 = *(int *)(param_1 + 4);
    piVar10[1] = iVar2;
    *piVar10 = iVar2;
    *(int **)(param_1 + 4) = piVar10;
    if (iVar6 < 1) {
      *piVar1 = iVar11;
      return 0;
    }
    piVar13 = (int *)aiStack_80[iVar12 + -2];
    if ((int *)*piVar13 == piVar10) {
      *piVar13 = iVar11;
      aiStack_80[iVar6] = iVar11;
    }
    else {
      piVar13[1] = iVar11;
      aiStack_80[iVar6] = *piVar13 + 0xc;
    }
    iVar11 = iVar12 + -2;
    if (-1 < iVar11) {
      piVar10 = aiStack_80 + iVar12 + -3;
      do {
        piVar13 = (int *)piVar10[1];
        cVar5 = (*piVar13 == piVar10[2]) * '\x02' + -1 + (char)piVar13[2];
        *(char *)(piVar13 + 2) = cVar5;
        if (cVar5 != '\0') {
          if (cVar5 == -1) {
            return 0xffffffff;
          }
          if (cVar5 == '\x01') {
            return 0xffffffff;
          }
          piVar9 = piVar1;
          if ((0 < iVar11) && (piVar9 = (int *)*piVar10, (int *)*piVar9 != piVar13)) {
            piVar9 = piVar9 + 1;
          }
          if (cVar5 == '\x02') {
            piVar3 = (int *)piVar13[1];
            if ((char)piVar3[2] == '\0') {
              piVar13[1] = *piVar3;
              *piVar3 = (int)piVar13;
              *piVar9 = (int)piVar3;
              *(undefined1 *)(piVar3 + 2) = 0xff;
              *(undefined1 *)(piVar13 + 2) = 1;
              return 0xffffffff;
            }
            if ((char)piVar3[2] == '\x01') {
              piVar13[1] = *piVar3;
              *piVar3 = (int)piVar13;
              *piVar9 = (int)piVar3;
              *(undefined1 *)(piVar3 + 2) = 0;
              *(undefined1 *)(piVar13 + 2) = 0;
            }
            if ((char)piVar3[2] == -1) {
              iVar12 = *piVar3;
              *piVar9 = iVar12;
              *piVar3 = *(int *)(iVar12 + 4);
              *(int **)(*piVar9 + 4) = piVar3;
              piVar13[1] = *(int *)*piVar9;
              *(int **)*piVar9 = piVar13;
              *(char *)(piVar13 + 2) = (*(char *)(*piVar9 + 8) != '\x01') + -1;
              *(bool *)(piVar3 + 2) = *(char *)(*piVar9 + 8) == -1;
              *(undefined1 *)(*piVar9 + 8) = 0;
            }
          }
          if ((char)piVar13[2] == -2) {
            iVar12 = *piVar13;
            if (*(char *)(iVar12 + 8) == '\0') {
              *piVar13 = *(int *)(iVar12 + 4);
              *(int **)(iVar12 + 4) = piVar13;
              *piVar9 = iVar12;
              *(undefined1 *)(iVar12 + 8) = 1;
              *(undefined1 *)(piVar13 + 2) = 0xff;
              return 0xffffffff;
            }
            if (*(char *)(iVar12 + 8) == -1) {
              *piVar13 = *(int *)(iVar12 + 4);
              *(int **)(iVar12 + 4) = piVar13;
              *piVar9 = iVar12;
              *(undefined1 *)(iVar12 + 8) = 0;
              *(undefined1 *)(piVar13 + 2) = 0;
            }
            if (*(char *)(iVar12 + 8) == '\x01') {
              puVar4 = *(undefined4 **)(iVar12 + 4);
              *piVar9 = (int)puVar4;
              *(undefined4 *)(iVar12 + 4) = *puVar4;
              *(int *)*piVar9 = iVar12;
              *piVar13 = *(int *)(*piVar9 + 4);
              *(int **)(*piVar9 + 4) = piVar13;
              *(char *)(iVar12 + 8) = (*(char *)(*piVar9 + 8) != '\x01') + -1;
              *(bool *)(piVar13 + 2) = *(char *)(*piVar9 + 8) == -1;
              *(undefined1 *)(*piVar9 + 8) = 0;
            }
          }
          piVar10[1] = *piVar9;
        }
        iVar11 = iVar11 + -1;
        piVar10 = piVar10 + -1;
        if (iVar11 < 0) {
          return 0xffffffff;
        }
      } while( true );
    }
  }
  return 0xffffffff;
}



int __cdecl FUN_1002c7c0(int param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  int iVar2;
  
  puVar1 = *(undefined4 **)(param_1 + 8);
  while( true ) {
    while( true ) {
      if (puVar1 == (undefined4 *)0x0) {
        return 0;
      }
      iVar2 = (**(code **)(param_1 + 0x20))(param_2,puVar1 + 3);
      if (-1 < iVar2) break;
      puVar1 = (undefined4 *)*puVar1;
    }
    if (iVar2 < 1) break;
    puVar1 = (undefined4 *)puVar1[1];
  }
  return *(int *)(param_1 + 0x10) + 0xc + (int)puVar1;
}



undefined4 * __cdecl FUN_1002c800(int param_1,int param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  uint uVar3;
  
  puVar1 = (undefined4 *)_malloc(0x24);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[4] = 0;
  puVar1[5] = 0;
  puVar1[6] = 0;
  puVar1[7] = 0;
  puVar1[8] = 0;
  puVar1[3] = param_1;
  puVar1[5] = param_2;
  uVar2 = param_1 + 3U & 0x7ffc;
  uVar3 = param_2 + 3U & 0x7ffc;
  puVar1[4] = uVar2;
  puVar1[6] = uVar3;
  puVar1[7] = uVar3 + 0xc + uVar2;
  puVar1[8] = _strcmp;
  FUN_1002c210(puVar1,0x100);
  return puVar1;
}



void __cdecl FUN_1002c870(int *param_1)

{
  void *_Memory;
  int iVar1;
  
  iVar1 = *param_1;
  while (iVar1 != 0) {
    _Memory = (void *)*param_1;
    *param_1 = *(int *)((int)_Memory + 4);
    _free(_Memory);
    iVar1 = *param_1;
  }
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  FUN_1002c210(param_1,0x100);
  return;
}



undefined4 * __cdecl
FUN_1002cab0(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  
  if (param_1 < 1) {
    param_1 = 10;
  }
  puVar1 = (undefined4 *)_malloc(0x1c);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[4] = 0;
  puVar1[5] = 0;
  puVar1[6] = 0;
  puVar1[1] = param_1;
  puVar2 = (undefined4 *)_malloc(param_1 * 4);
  *puVar1 = puVar2;
  for (uVar3 = puVar1[1] & 0x3fffffff; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  for (iVar4 = 0; iVar4 != 0; iVar4 = iVar4 + -1) {
    *(undefined1 *)puVar2 = 0;
    puVar2 = (undefined4 *)((int)puVar2 + 1);
  }
  FUN_1001a3b0(0x1002c8c0,(int)puVar1);
  puVar1[4] = param_2;
  puVar1[6] = param_3;
  puVar1[5] = param_4;
  return puVar1;
}



int WSAGetLastError(void)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce74. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSAGetLastError();
  return iVar1;
}



int WSAStartup(WORD wVersionRequired,LPWSADATA lpWSAData)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce7a. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSAStartup(wVersionRequired,lpWSAData);
  return iVar1;
}



int setsockopt(SOCKET s,int level,int optname,char *optval,int optlen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce80. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = setsockopt(s,level,optname,optval,optlen);
  return iVar1;
}



int ioctlsocket(SOCKET s,long cmd,u_long *argp)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce86. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = ioctlsocket(s,cmd,argp);
  return iVar1;
}



SOCKET socket(int af,int type,int protocol)

{
  SOCKET SVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce8c. Too many branches
                    // WARNING: Treating indirect jump as call
  SVar1 = socket(af,type,protocol);
  return SVar1;
}



int closesocket(SOCKET s)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce92. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = closesocket(s);
  return iVar1;
}



int shutdown(SOCKET s,int how)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce98. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = shutdown(s,how);
  return iVar1;
}



int bind(SOCKET s,sockaddr *addr,int namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ce9e. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = bind(s,addr,namelen);
  return iVar1;
}



int connect(SOCKET s,sockaddr *name,int namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002cea4. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = connect(s,name,namelen);
  return iVar1;
}



int sendto(SOCKET s,char *buf,int len,int flags,sockaddr *to,int tolen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ceaa. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = sendto(s,buf,len,flags,to,tolen);
  return iVar1;
}



int send(SOCKET s,char *buf,int len,int flags)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ceb0. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = send(s,buf,len,flags);
  return iVar1;
}



int recvfrom(SOCKET s,char *buf,int len,int flags,sockaddr *from,int *fromlen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ceb6. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = recvfrom(s,buf,len,flags,from,fromlen);
  return iVar1;
}



int recv(SOCKET s,char *buf,int len,int flags)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002cebc. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = recv(s,buf,len,flags);
  return iVar1;
}



int getsockname(SOCKET s,sockaddr *name,int *namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002cec2. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = getsockname(s,name,namelen);
  return iVar1;
}



hostent * gethostbyname(char *name)

{
  hostent *phVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002cec8. Too many branches
                    // WARNING: Treating indirect jump as call
  phVar1 = gethostbyname(name);
  return phVar1;
}



int gethostname(char *name,int namelen)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002cece. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = gethostname(name,namelen);
  return iVar1;
}



void WSAIoctl(void)

{
                    // WARNING: Could not recover jumptable at 0x1002ced4. Too many branches
                    // WARNING: Treating indirect jump as call
  WSAIoctl();
  return;
}



int WSACleanup(void)

{
  int iVar1;
  
                    // WARNING: Could not recover jumptable at 0x1002ceda. Too many branches
                    // WARNING: Treating indirect jump as call
  iVar1 = WSACleanup();
  return iVar1;
}



float10 __cdecl FUN_1002cee0(int param_1,int param_2)

{
  return (float10)(param_1 - param_2);
}



// Library Function - Multiple Matches With Different Base Names
//  __time32
//  _time
// 
// Libraries: Visual Studio 2003 Release, Visual Studio 2005 Release

__time32_t __cdecl FID_conflict___time32(__time32_t *_Time)

{
  undefined8 uVar1;
  _FILETIME local_c;
  
  GetSystemTimeAsFileTime(&local_c);
  uVar1 = __aulldiv(local_c.dwLowDateTime + 0x2ac18000,
                    local_c.dwHighDateTime + 0xfe624e21 + (uint)(0xd53e7fff < local_c.dwLowDateTime)
                    ,10000000,0);
  if (_Time != (__time32_t *)0x0) {
    *_Time = (__time32_t)uVar1;
  }
  return (__time32_t)uVar1;
}



void FUN_1002cf2b(void)

{
  PTR___fptrap_10041800 = __cfltcvt;
  PTR___fptrap_10041804 = &LAB_1002f3f4;
  PTR___fptrap_10041808 = __fassign;
  PTR___fptrap_1004180c = __forcdecpt;
  PTR___fptrap_10041810 = &LAB_1002f43f;
  PTR___fptrap_10041814 = __cfltcvt;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __fpmath
// 
// Library: Visual Studio 2003 Release

void __cdecl __fpmath(int param_1)

{
  FUN_1002cf2b();
  _DAT_10052e64 = __ms_p5_mp_test_fdiv();
  if (param_1 != 0) {
    __setdefaultprecision();
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  public: virtual __thiscall type_info::~type_info(void)
// 
// Library: Visual Studio 2003 Release

void __thiscall type_info::~type_info(type_info *this)

{
  *(undefined ***)this = &vftable;
  __lock(0xe);
  if (*(void **)(this + 4) != (void *)0x0) {
    _free(*(void **)(this + 4));
  }
  FUN_1002cfbe();
  return;
}



void FUN_1002cfbe(void)

{
  FUN_1002f8d0(0xe);
  return;
}



// Library Function - Single Match
//  public: virtual void * __thiscall type_info::`scalar deleting destructor'(unsigned int)
// 
// Library: Visual Studio 2003 Release

void * __thiscall type_info::_scalar_deleting_destructor_(type_info *this,uint param_1)

{
  ~type_info(this);
  if ((param_1 & 1) != 0) {
    _free(this);
  }
  return this;
}



// Library Function - Single Match
//  _sprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl _sprintf(char *_Dest,char *_Format,...)

{
  int iVar1;
  FILE local_24;
  
  local_24._cnt = 0x7fffffff;
  local_24._flag = 0x42;
  local_24._base = _Dest;
  local_24._ptr = _Dest;
  iVar1 = __output(&local_24,(byte *)_Format,(wchar_t *)&stack0x0000000c);
  if (_Dest != (char *)0x0) {
    local_24._cnt = local_24._cnt + -1;
    if (local_24._cnt < 0) {
      __flsbuf(0,&local_24);
    }
    else {
      *local_24._ptr = '\0';
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  void __stdcall _JumpToContinuation(void *,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

void _JumpToContinuation(void *param_1,EHRegistrationNode *param_2)

{
                    // WARNING: Load size is inaccurate
  ExceptionList = *ExceptionList;
                    // WARNING: Could not recover jumptable at 0x1002d064. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)param_1)();
  return;
}



// Library Function - Multiple Matches With Different Base Names
//  void __stdcall _CallMemberFunction1(void *,void *,void *)
//  void __stdcall _CallMemberFunction2(void *,void *,void *,int)
// 
// Library: Visual Studio 2003 Release

void FID_conflict__CallMemberFunction1(undefined4 param_1,undefined *UNRECOVERED_JUMPTABLE)

{
  LOCK();
  UNLOCK();
                    // WARNING: Could not recover jumptable at 0x1002d070. Too many branches
                    // WARNING: Treating indirect jump as call
  (*(code *)UNRECOVERED_JUMPTABLE)();
  return;
}



// Library Function - Single Match
//  void __stdcall _UnwindNestedFrames(struct EHRegistrationNode *,struct EHExceptionRecord *)
// 
// Library: Visual Studio 2003 Release

void _UnwindNestedFrames(EHRegistrationNode *param_1,EHExceptionRecord *param_2)

{
  void *pvVar1;
  
  pvVar1 = ExceptionList;
  RtlUnwind(param_1,(PVOID)0x1002d09b,(PEXCEPTION_RECORD)param_2,(PVOID)0x0);
  *(uint *)(param_2 + 4) = *(uint *)(param_2 + 4) & 0xfffffffd;
  *(void **)pvVar1 = ExceptionList;
  ExceptionList = pvVar1;
  return;
}



// Library Function - Single Match
//  ___CxxFrameHandler
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl
___CxxFrameHandler(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,
                  void *param_4)

{
  _s_FuncInfo *in_EAX;
  undefined4 uVar1;
  
  uVar1 = ___InternalCxxFrameHandler
                    (param_1,param_2,param_3,param_4,in_EAX,0,(EHRegistrationNode *)0x0,'\0');
  return uVar1;
}



// Library Function - Single Match
//  int __cdecl _CallSETranslator(struct EHExceptionRecord *,struct EHRegistrationNode *,void *,void
// *,struct _s_FuncInfo const *,int,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

int __cdecl
_CallSETranslator(EHExceptionRecord *param_1,EHRegistrationNode *param_2,void *param_3,void *param_4
                 ,_s_FuncInfo *param_5,int param_6,EHRegistrationNode *param_7)

{
  _ptiddata p_Var1;
  undefined4 uVar2;
  EHExceptionRecord **ppEVar3;
  int local_38;
  EHExceptionRecord *local_34;
  void *local_30;
  undefined4 *local_2c;
  code *local_28;
  undefined4 local_24;
  _s_FuncInfo *local_20;
  EHRegistrationNode *local_1c;
  int local_18;
  EHRegistrationNode *local_14;
  undefined1 *local_10;
  undefined1 *local_c;
  int local_8;
  
  local_c = &stack0xfffffffc;
  local_10 = &stack0xffffffc4;
  if (param_1 == (EHExceptionRecord *)0x123) {
    *(undefined4 *)param_2 = 0x1002d1d0;
    local_38 = 1;
  }
  else {
    local_28 = TranslatorGuardHandler;
    local_24 = DAT_10041558;
    local_20 = param_5;
    local_1c = param_2;
    local_18 = param_6;
    local_14 = param_7;
    local_8 = 0;
    local_2c = (undefined4 *)ExceptionList;
    ExceptionList = &local_2c;
    local_34 = param_1;
    local_30 = param_3;
    ppEVar3 = &local_34;
    uVar2 = *(undefined4 *)param_1;
    p_Var1 = __getptd();
    (*(code *)p_Var1->_NLG_dwCode)(uVar2,ppEVar3);
    local_38 = 0;
    if (local_8 != 0) {
                    // WARNING: Load size is inaccurate
      *local_2c = *ExceptionList;
    }
    ExceptionList = local_2c;
  }
  return local_38;
}



// Library Function - Single Match
//  enum _EXCEPTION_DISPOSITION __cdecl TranslatorGuardHandler(struct EHExceptionRecord *,struct
// TranslatorGuardRN *,void *,void *)
// 
// Library: Visual Studio 2003 Release

_EXCEPTION_DISPOSITION __cdecl
TranslatorGuardHandler
          (EHExceptionRecord *param_1,TranslatorGuardRN *param_2,void *param_3,void *param_4)

{
  _EXCEPTION_DISPOSITION _Var1;
  code *local_8;
  
  if (*(int *)(param_2 + 8) == DAT_10041558) {
    if ((*(uint *)(param_1 + 4) & 0x66) == 0) {
      ___InternalCxxFrameHandler
                (param_1,*(EHRegistrationNode **)(param_2 + 0x10),(_CONTEXT *)param_3,(void *)0x0,
                 *(_s_FuncInfo **)(param_2 + 0xc),*(int *)(param_2 + 0x14),
                 *(EHRegistrationNode **)(param_2 + 0x18),'\x01');
      if (*(int *)(param_2 + 0x24) == 0) {
        _UnwindNestedFrames((EHRegistrationNode *)param_2,param_1);
      }
      _CallSETranslator((EHExceptionRecord *)0x123,(EHRegistrationNode *)&local_8,(void *)0x0,
                        (void *)0x0,(_s_FuncInfo *)0x0,0,(EHRegistrationNode *)0x0);
                    // WARNING: Could not recover jumptable at 0x1002d2a6. Too many branches
                    // WARNING: Treating indirect jump as call
      _Var1 = (*local_8)();
      return _Var1;
    }
    *(undefined4 *)(param_2 + 0x24) = 1;
  }
  else {
    *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 8;
  }
  return 1;
}



// Library Function - Single Match
//  struct _s_TryBlockMapEntry const * __cdecl _GetRangeOfTrysToCheck(struct _s_FuncInfo const
// *,int,int,unsigned int *,unsigned int *)
// 
// Library: Visual Studio 2003 Release

_s_TryBlockMapEntry * __cdecl
_GetRangeOfTrysToCheck(_s_FuncInfo *param_1,int param_2,int param_3,uint *param_4,uint *param_5)

{
  TryBlockMapEntry *pTVar1;
  _s_FuncInfo *p_Var2;
  _s_FuncInfo *p_Var3;
  _s_FuncInfo *local_8;
  
  p_Var2 = param_1;
  local_8 = (_s_FuncInfo *)param_1->nTryBlocks;
  pTVar1 = param_1->pTryBlockMap;
  p_Var3 = local_8;
  param_1 = local_8;
  if (-1 < param_2) {
    do {
      if (p_Var3 == (_s_FuncInfo *)0xffffffff) {
        _inconsistency();
      }
      p_Var3 = (_s_FuncInfo *)((int)&p_Var3[-1].pIPToStateMap + 3);
      if (((pTVar1[(int)p_Var3].tryHigh < param_3) && (param_3 <= pTVar1[(int)p_Var3].catchHigh)) ||
         (p_Var3 == (_s_FuncInfo *)0xffffffff)) {
        param_2 = param_2 + -1;
        local_8 = param_1;
        param_1 = p_Var3;
      }
    } while (-1 < param_2);
  }
  p_Var3 = (_s_FuncInfo *)((int)&p_Var3->magicNumber_and_bbtFlags + 1);
  *param_4 = (uint)p_Var3;
  *param_5 = (uint)local_8;
  if (((_s_FuncInfo *)p_Var2->nTryBlocks < local_8) || (local_8 < p_Var3)) {
    _inconsistency();
  }
  return pTVar1 + (int)p_Var3;
}



// Library Function - Single Match
//  struct FrameInfo * __cdecl _CreateFrameInfo(struct FrameInfo *,void *)
// 
// Library: Visual Studio 2003 Release

FrameInfo * __cdecl _CreateFrameInfo(FrameInfo *param_1,void *param_2)

{
  _ptiddata p_Var1;
  
  *(void **)param_1 = param_2;
  p_Var1 = __getptd();
  *(void **)(param_1 + 4) = p_Var1->_curexception;
  p_Var1 = __getptd();
  p_Var1->_curexception = param_1;
  return param_1;
}



// Library Function - Single Match
//  int __cdecl IsExceptionObjectToBeDestroyed(void *)
// 
// Library: Visual Studio 2003 Release

int __cdecl IsExceptionObjectToBeDestroyed(void *param_1)

{
  _ptiddata p_Var1;
  int *piVar2;
  
  p_Var1 = __getptd();
  piVar2 = (int *)p_Var1->_curexception;
  while( true ) {
    if (piVar2 == (int *)0x0) {
      return 1;
    }
    if ((void *)*piVar2 == param_1) break;
    piVar2 = (int *)piVar2[1];
  }
  return 0;
}



// Library Function - Single Match
//  void __cdecl _FindAndUnlinkFrame(struct FrameInfo *)
// 
// Library: Visual Studio 2003 Release

void __cdecl _FindAndUnlinkFrame(FrameInfo *param_1)

{
  FrameInfo *pFVar1;
  _ptiddata p_Var2;
  FrameInfo *pFVar3;
  
  p_Var2 = __getptd();
  if (param_1 == (FrameInfo *)p_Var2->_curexception) {
    p_Var2 = __getptd();
    p_Var2->_curexception = *(void **)(param_1 + 4);
    return;
  }
  p_Var2 = __getptd();
  pFVar1 = (FrameInfo *)p_Var2->_curexception;
  do {
    pFVar3 = pFVar1;
    if (*(int *)(pFVar3 + 4) == 0) {
      _inconsistency();
      return;
    }
    pFVar1 = *(FrameInfo **)(pFVar3 + 4);
  } while (param_1 != *(FrameInfo **)(pFVar3 + 4));
  *(undefined4 *)(pFVar3 + 4) = *(undefined4 *)(param_1 + 4);
  return;
}



// Library Function - Single Match
//  void * __cdecl _CallCatchBlock2(struct EHRegistrationNode *,struct _s_FuncInfo const *,void
// *,int,unsigned long)
// 
// Library: Visual Studio 2003 Release

void * __cdecl
_CallCatchBlock2(EHRegistrationNode *param_1,_s_FuncInfo *param_2,void *param_3,int param_4,
                ulong param_5)

{
  void *pvVar1;
  void *local_1c;
  undefined1 *local_18;
  undefined4 local_14;
  _s_FuncInfo *local_10;
  EHRegistrationNode *local_c;
  int local_8;
  
  local_14 = DAT_10041558;
  local_10 = param_2;
  local_8 = param_4 + 1;
  local_18 = &LAB_1002d0fa;
  local_c = param_1;
  local_1c = ExceptionList;
  ExceptionList = &local_1c;
  pvVar1 = (void *)__CallSettingFrame_12(param_3,param_1,param_5);
  ExceptionList = local_1c;
  return pvVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// Library Function - Single Match
//  _report_failure
// 
// Library: Visual Studio 2003 Release

void __cdecl report_failure(void)

{
  ___security_error_handler(1);
                    // WARNING: Subroutine does not return
  ExitProcess(3);
}



void __fastcall FUN_1002d447(int param_1)

{
  if (param_1 == DAT_10041558) {
    return;
  }
  report_failure();
  return;
}



// Library Function - Single Match
//  __global_unwind2
// 
// Library: Visual Studio

void __cdecl __global_unwind2(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x1002d470,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



// Library Function - Single Match
//  __local_unwind2
// 
// Library: Visual Studio 2003 Release

void __cdecl __local_unwind2(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *pvStack_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  int iStack_10;
  
  iStack_10 = param_1;
  puStack_18 = &LAB_1002d478;
  pvStack_1c = ExceptionList;
  ExceptionList = &pvStack_1c;
  while( true ) {
    iVar1 = *(int *)(param_1 + 8);
    iVar2 = *(int *)(param_1 + 0xc);
    if ((iVar2 == -1) || (iVar2 == param_2)) break;
    local_14 = *(undefined4 *)(iVar1 + iVar2 * 0xc);
    *(undefined4 *)(param_1 + 0xc) = local_14;
    if (*(int *)(iVar1 + 4 + iVar2 * 0xc) == 0) {
      FUN_1002d52e();
      (**(code **)(iVar1 + 8 + iVar2 * 0xc))();
    }
  }
  ExceptionList = pvStack_1c;
  return;
}



// Library Function - Single Match
//  __abnormal_termination
// 
// Library: Visual Studio 2003 Release

int __cdecl __abnormal_termination(void)

{
  int iVar1;
  
  iVar1 = 0;
  if ((*(undefined1 **)((int)ExceptionList + 4) == &LAB_1002d478) &&
     (*(int *)((int)ExceptionList + 8) == *(int *)(*(int *)((int)ExceptionList + 0xc) + 0xc))) {
    iVar1 = 1;
  }
  return iVar1;
}



// Library Function - Single Match
//  __NLG_Notify1
// 
// Libraries: Visual Studio 2017 Debug, Visual Studio 2017 Release, Visual Studio 2019 Debug, Visual
// Studio 2019 Release

void __fastcall __NLG_Notify1(undefined4 param_1)

{
  undefined4 in_EAX;
  undefined4 unaff_EBP;
  
  DAT_10041564 = param_1;
  DAT_10041560 = in_EAX;
  DAT_10041568 = unaff_EBP;
  return;
}



void FUN_1002d52e(void)

{
  undefined4 in_EAX;
  int unaff_EBP;
  
  DAT_10041564 = *(undefined4 *)(unaff_EBP + 8);
  DAT_10041560 = in_EAX;
  DAT_10041568 = unaff_EBP;
  return;
}



ulonglong FUN_1002d548(void)

{
  ulonglong uVar1;
  uint uVar2;
  float fVar3;
  float10 in_ST0;
  undefined4 local_20;
  undefined4 uStack_1c;
  
  uVar1 = (ulonglong)ROUND(in_ST0);
  local_20 = (uint)uVar1;
  uStack_1c = (float)(uVar1 >> 0x20);
  fVar3 = (float)in_ST0;
  if ((local_20 != 0) || (fVar3 = uStack_1c, (uVar1 & 0x7fffffff00000000) != 0)) {
    if ((int)fVar3 < 0) {
      uVar1 = uVar1 + (0x80000000 < (uint)-(float)(in_ST0 - (float10)(longlong)uVar1));
    }
    else {
      uVar2 = (uint)(0x80000000 < (uint)(float)(in_ST0 - (float10)(longlong)uVar1));
      uVar1 = CONCAT44((int)uStack_1c - (uint)(local_20 < uVar2),local_20 - uVar2);
    }
  }
  return uVar1;
}



// Library Function - Single Match
//  __CxxThrowException@8
// 
// Library: Visual Studio 2003 Release

void __CxxThrowException_8(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  DWORD *pDVar2;
  DWORD *pDVar3;
  DWORD local_24 [4];
  DWORD local_14;
  ULONG_PTR local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  pDVar2 = &DAT_1003ef0c;
  pDVar3 = local_24;
  for (iVar1 = 8; iVar1 != 0; iVar1 = iVar1 + -1) {
    *pDVar3 = *pDVar2;
    pDVar2 = pDVar2 + 1;
    pDVar3 = pDVar3 + 1;
  }
  local_c = param_1;
  local_8 = param_2;
  RaiseException(local_24[0],local_24[1],local_14,&local_10);
  return;
}



// Library Function - Single Match
//  _strncpy
// 
// Library: Visual Studio 2003 Release

char * __cdecl _strncpy(char *_Dest,char *_Source,size_t _Count)

{
  uint uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  
  if (_Count == 0) {
    return _Dest;
  }
  puVar5 = (uint *)_Dest;
  if (((uint)_Source & 3) != 0) {
    while( true ) {
      uVar4 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 1);
      *(char *)puVar5 = (char)uVar4;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
      if (_Count == 0) {
        return _Dest;
      }
      if ((char)uVar4 == '\0') break;
      if (((uint)_Source & 3) == 0) {
        uVar4 = _Count >> 2;
        goto joined_r0x1002d64c;
      }
    }
    do {
      if (((uint)puVar5 & 3) == 0) {
        uVar4 = _Count >> 2;
        cVar3 = '\0';
        if (uVar4 == 0) goto LAB_1002d693;
        goto LAB_1002d709;
      }
      *(char *)puVar5 = '\0';
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
    } while (_Count != 0);
    return _Dest;
  }
  uVar4 = _Count >> 2;
  if (uVar4 != 0) {
    do {
      uVar1 = *(uint *)_Source;
      uVar2 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 4);
      if (((uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff) & 0x81010100) != 0) {
        if ((char)uVar2 == '\0') {
          *puVar5 = 0;
joined_r0x1002d705:
          while( true ) {
            uVar4 = uVar4 - 1;
            puVar5 = puVar5 + 1;
            if (uVar4 == 0) break;
LAB_1002d709:
            *puVar5 = 0;
          }
          cVar3 = '\0';
          _Count = _Count & 3;
          if (_Count != 0) goto LAB_1002d693;
          return _Dest;
        }
        if ((char)(uVar2 >> 8) == '\0') {
          *puVar5 = uVar2 & 0xff;
          goto joined_r0x1002d705;
        }
        if ((uVar2 & 0xff0000) == 0) {
          *puVar5 = uVar2 & 0xffff;
          goto joined_r0x1002d705;
        }
        if ((uVar2 & 0xff000000) == 0) {
          *puVar5 = uVar2;
          goto joined_r0x1002d705;
        }
      }
      *puVar5 = uVar2;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
joined_r0x1002d64c:
    } while (uVar4 != 0);
    _Count = _Count & 3;
    if (_Count == 0) {
      return _Dest;
    }
  }
  do {
    cVar3 = (char)*(uint *)_Source;
    _Source = (char *)((int)_Source + 1);
    *(char *)puVar5 = cVar3;
    puVar5 = (uint *)((int)puVar5 + 1);
    if (cVar3 == '\0') {
      while (_Count = _Count - 1, _Count != 0) {
LAB_1002d693:
        *(char *)puVar5 = cVar3;
        puVar5 = (uint *)((int)puVar5 + 1);
      }
      return _Dest;
    }
    _Count = _Count - 1;
  } while (_Count != 0);
  return _Dest;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __CRT_INIT@12
// 
// Library: Visual Studio 2003 Release

undefined4 __CRT_INIT_12(undefined4 param_1,int param_2)

{
  BOOL BVar1;
  int iVar2;
  _ptiddata _Ptd;
  DWORD DVar3;
  DWORD local_9c;
  DWORD local_98;
  DWORD local_94;
  uint local_90;
  DWORD local_8c;
  CHAR aCStack_18 [4];
  pthreadlocinfo _Locale;
  
  if (param_2 == 1) {
    local_9c = 0x94;
    BVar1 = GetVersionExA((LPOSVERSIONINFOA)&local_9c);
    if (BVar1 != 0) {
      DAT_10053014 = local_8c;
      DAT_10053020 = local_98;
      _DAT_10053024 = local_94;
      _DAT_10053018 = local_90 & 0x7fff;
      if (local_8c != 2) {
        _DAT_10053018 = _DAT_10053018 | 0x8000;
      }
      _DAT_1005301c = local_98 * 0x100 + local_94;
      iVar2 = __heap_init();
      if (iVar2 != 0) {
        iVar2 = __mtinit();
        if (iVar2 != 0) {
          __RTC_Initialize();
          DAT_10054704 = GetCommandLineA();
          DAT_10052e6c = ___crtGetEnvironmentStringsA();
          iVar2 = __ioinit();
          if (-1 < iVar2) {
            iVar2 = __setargv();
            if (((-1 < iVar2) && (iVar2 = __setenvp(), -1 < iVar2)) &&
               (iVar2 = __cinit(0), iVar2 == 0)) {
              DAT_10052e68 = DAT_10052e68 + 1;
              return 1;
            }
            __ioterm();
          }
          __mtterm();
        }
        __heap_term();
      }
    }
  }
  else if (param_2 == 0) {
    if (0 < DAT_10052e68) {
      DAT_10052e68 = DAT_10052e68 + -1;
      if (DAT_10053050 == 0) {
        __cexit();
      }
      __ioterm();
      __mtterm();
      __heap_term();
      return 1;
    }
  }
  else {
    if (param_2 != 2) {
      if (param_2 != 3) {
        return 1;
      }
      __freeptd((_ptiddata)0x0);
      return 1;
    }
    _Ptd = (_ptiddata)_calloc(1,0x8c);
    if (_Ptd != (_ptiddata)0x0) {
      _Locale = DAT_10041944;
      iVar2 = (*DAT_10053000)();
      if (iVar2 != 0) {
        aCStack_18[0] = 't';
        aCStack_18[1] = -0x28;
        aCStack_18[2] = '\x02';
        aCStack_18[3] = '\x10';
        __initptd(_Ptd,_Locale);
        DVar3 = GetCurrentThreadId();
        _Ptd->_thandle = 0xffffffff;
        _Ptd->_tid = DVar3;
        return 1;
      }
      aCStack_18[0] = -0x78;
      aCStack_18[1] = -0x28;
      aCStack_18[2] = '\x02';
      aCStack_18[3] = '\x10';
      _free(_Ptd);
    }
  }
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3

int entry(undefined4 param_1,int param_2,undefined4 param_3)

{
  int iVar1;
  int local_20;
  
  local_20 = 1;
  if ((param_2 == 0) && (DAT_10052e68 == 0)) {
LAB_1002d97f:
    local_20 = 0;
  }
  else {
    if ((param_2 == 1) || (param_2 == 2)) {
      if (DAT_10054708 != (code *)0x0) {
        local_20 = (*DAT_10054708)(param_1,param_2,param_3);
      }
      if ((local_20 == 0) || (iVar1 = __CRT_INIT_12(param_1,param_2), iVar1 == 0))
      goto LAB_1002d97f;
    }
    local_20 = FUN_10001550(param_1,param_2);
    if ((param_2 == 1) && (local_20 == 0)) {
      __CRT_INIT_12(param_1,0);
    }
    if ((param_2 == 0) || (param_2 == 3)) {
      iVar1 = __CRT_INIT_12(param_1,param_2);
      if (iVar1 == 0) {
        local_20 = 0;
      }
      if ((local_20 != 0) && (DAT_10054708 != (code *)0x0)) {
        local_20 = (*DAT_10054708)(param_1,param_2,param_3);
      }
    }
  }
  return local_20;
}



// Library Function - Single Match
//  __amsg_exit
// 
// Library: Visual Studio 2003 Release

void __cdecl __amsg_exit(int param_1)

{
  if ((DAT_10052e74 == 1) || ((DAT_10052e74 == 0 && (DAT_10052e78 == 1)))) {
    __FF_MSGBANNER();
  }
  __NMSG_WRITE(param_1);
  (*(code *)PTR___exit_10041570)(0xff);
  return;
}



// Library Function - Single Match
//  _strchr
// 
// Library: Visual Studio 2003 Release

char * __cdecl _strchr(char *_Str,int _Val)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar1 = (uint)_Str & 3;
  while (uVar1 != 0) {
    if ((char)*(uint *)_Str == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)*(uint *)_Str == '\0') {
      return (char *)0x0;
    }
    uVar1 = (uint)((int)_Str + 1) & 3;
    _Str = (char *)((int)_Str + 1);
  }
  while( true ) {
    while( true ) {
      uVar1 = *(uint *)_Str;
      uVar4 = uVar1 ^ CONCAT22(CONCAT11((char)_Val,(char)_Val),CONCAT11((char)_Val,(char)_Val));
      uVar3 = uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff;
      puVar5 = (uint *)((int)_Str + 4);
      if (((uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff) & 0x81010100) != 0) break;
      _Str = (char *)puVar5;
      if ((uVar3 & 0x81010100) != 0) {
        if ((uVar3 & 0x1010100) != 0) {
          return (char *)0x0;
        }
        if ((uVar1 + 0x7efefeff & 0x80000000) == 0) {
          return (char *)0x0;
        }
      }
    }
    uVar1 = *(uint *)_Str;
    if ((char)uVar1 == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)uVar1 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 8);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 1);
    }
    if (cVar2 == '\0') break;
    cVar2 = (char)(uVar1 >> 0x10);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 2);
    }
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 0x18);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 3);
    }
    _Str = (char *)puVar5;
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
  }
  return (char *)0x0;
}



// Library Function - Single Match
//  _strstr
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

char * __cdecl _strstr(char *_Str,char *_SubStr)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  uint uVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  char *pcVar8;
  uint *puVar9;
  char *pcVar10;
  
  cVar3 = *_SubStr;
  if (cVar3 == '\0') {
    return _Str;
  }
  if (_SubStr[1] == '\0') {
    uVar4 = (uint)_Str & 3;
    while (uVar4 != 0) {
      if ((char)*(uint *)_Str == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)*(uint *)_Str == '\0') {
        return (char *)0x0;
      }
      uVar4 = (uint)((int)_Str + 1) & 3;
      _Str = (char *)((int)_Str + 1);
    }
    while( true ) {
      while( true ) {
        uVar4 = *(uint *)_Str;
        uVar7 = uVar4 ^ CONCAT22(CONCAT11(cVar3,cVar3),CONCAT11(cVar3,cVar3));
        uVar6 = uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff;
        puVar9 = (uint *)((int)_Str + 4);
        if (((uVar7 ^ 0xffffffff ^ uVar7 + 0x7efefeff) & 0x81010100) != 0) break;
        _Str = (char *)puVar9;
        if ((uVar6 & 0x81010100) != 0) {
          if ((uVar6 & 0x1010100) != 0) {
            return (char *)0x0;
          }
          if ((uVar4 + 0x7efefeff & 0x80000000) == 0) {
            return (char *)0x0;
          }
        }
      }
      uVar4 = *(uint *)_Str;
      if ((char)uVar4 == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)uVar4 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 8);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 1);
      }
      if (cVar5 == '\0') break;
      cVar5 = (char)(uVar4 >> 0x10);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 2);
      }
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 0x18);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 3);
      }
      _Str = (char *)puVar9;
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
    }
    return (char *)0x0;
  }
  do {
    cVar5 = *_Str;
    do {
      while (_Str = _Str + 1, cVar5 != cVar3) {
        if (cVar5 == '\0') {
          return (char *)0x0;
        }
        cVar5 = *_Str;
      }
      cVar5 = *_Str;
      pcVar10 = _Str + 1;
      pcVar8 = _SubStr;
    } while (cVar5 != _SubStr[1]);
    do {
      if (pcVar8[2] == '\0') {
LAB_1002db09:
        return _Str + -1;
      }
      if (*pcVar10 != pcVar8[2]) break;
      pcVar1 = pcVar8 + 3;
      if (*pcVar1 == '\0') goto LAB_1002db09;
      pcVar2 = pcVar10 + 1;
      pcVar8 = pcVar8 + 2;
      pcVar10 = pcVar10 + 2;
    } while (*pcVar1 == *pcVar2);
  } while( true );
}



// Library Function - Single Match
//  _memmove
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

void * __cdecl _memmove(void *_Dst,void *_Src,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((_Src < _Dst) && (_Dst < (void *)(_Size + (int)_Src))) {
    puVar3 = (undefined4 *)((_Size - 4) + (int)_Src);
    puVar4 = (undefined4 *)((_Size - 4) + (int)_Dst);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = _Size >> 2;
      uVar2 = _Size & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return _Dst;
        case 2:
          goto switchD_1002dcdb_caseD_2;
        case 3:
          goto switchD_1002dcdb_caseD_3;
        }
        goto switchD_1002dcdb_caseD_1;
      }
    }
    else {
      switch(_Size) {
      case 0:
        goto switchD_1002dcdb_caseD_0;
      case 1:
        goto switchD_1002dcdb_caseD_1;
      case 2:
        goto switchD_1002dcdb_caseD_2;
      case 3:
        goto switchD_1002dcdb_caseD_3;
      default:
        uVar1 = _Size - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_1002dcdb_caseD_2;
            case 3:
              goto switchD_1002dcdb_caseD_3;
            }
            goto switchD_1002dcdb_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_1002dcdb_caseD_2;
            case 3:
              goto switchD_1002dcdb_caseD_3;
            }
            goto switchD_1002dcdb_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_1002dcdb_caseD_2;
            case 3:
              goto switchD_1002dcdb_caseD_3;
            }
            goto switchD_1002dcdb_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_1002dcdb_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return _Dst;
    case 2:
switchD_1002dcdb_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return _Dst;
    case 3:
switchD_1002dcdb_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return _Dst;
    }
switchD_1002dcdb_caseD_0:
    return _Dst;
  }
  puVar3 = (undefined4 *)_Dst;
  if (((uint)_Dst & 3) == 0) {
    uVar1 = _Size >> 2;
    uVar2 = _Size & 3;
    if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *_Src;
        _Src = (undefined4 *)((int)_Src + 4);
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return _Dst;
      case 2:
        goto switchD_1002db55_caseD_2;
      case 3:
        goto switchD_1002db55_caseD_3;
      }
      goto switchD_1002db55_caseD_1;
    }
  }
  else {
    switch(_Size) {
    case 0:
      goto switchD_1002db55_caseD_0;
    case 1:
      goto switchD_1002db55_caseD_1;
    case 2:
      goto switchD_1002db55_caseD_2;
    case 3:
      goto switchD_1002db55_caseD_3;
    default:
      uVar1 = (_Size - 4) + ((uint)_Dst & 3);
      switch((uint)_Dst & 3) {
      case 1:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 2) = *(undefined1 *)((int)_Src + 2);
        _Src = (void *)((int)_Src + 3);
        puVar3 = (undefined4 *)((int)_Dst + 3);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_1002db55_caseD_2;
          case 3:
            goto switchD_1002db55_caseD_3;
          }
          goto switchD_1002db55_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        _Src = (void *)((int)_Src + 2);
        puVar3 = (undefined4 *)((int)_Dst + 2);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_1002db55_caseD_2;
          case 3:
            goto switchD_1002db55_caseD_3;
          }
          goto switchD_1002db55_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        _Src = (void *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)_Dst + 1);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_1002db55_caseD_2;
          case 3:
            goto switchD_1002db55_caseD_3;
          }
          goto switchD_1002db55_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = *(undefined4 *)((int)_Src + (uVar1 - 7) * 4);
  case 6:
    puVar3[uVar1 - 6] = *(undefined4 *)((int)_Src + (uVar1 - 6) * 4);
  case 5:
    puVar3[uVar1 - 5] = *(undefined4 *)((int)_Src + (uVar1 - 5) * 4);
  case 4:
    puVar3[uVar1 - 4] = *(undefined4 *)((int)_Src + (uVar1 - 4) * 4);
  case 3:
    puVar3[uVar1 - 3] = *(undefined4 *)((int)_Src + (uVar1 - 3) * 4);
  case 2:
    puVar3[uVar1 - 2] = *(undefined4 *)((int)_Src + (uVar1 - 2) * 4);
  case 1:
    puVar3[uVar1 - 1] = *(undefined4 *)((int)_Src + (uVar1 - 1) * 4);
    _Src = (void *)((int)_Src + uVar1 * 4);
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_1002db55_caseD_1:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    return _Dst;
  case 2:
switchD_1002db55_caseD_2:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    return _Dst;
  case 3:
switchD_1002db55_caseD_3:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)_Src + 2);
    return _Dst;
  }
switchD_1002db55_caseD_0:
  return _Dst;
}



// WARNING: This is an inlined function
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  __chkstk
// 
// Library: Visual Studio 2003 Release

void __chkstk(void)

{
  uint in_EAX;
  undefined1 *puVar1;
  undefined4 unaff_retaddr;
  
  if (in_EAX < 0x1000) {
    *(undefined4 *)(&stack0x00000000 + -in_EAX) = unaff_retaddr;
    return;
  }
  puVar1 = &stack0x00000004;
  do {
    puVar1 = puVar1 + -0x1000;
    in_EAX = in_EAX - 0x1000;
  } while (0xfff < in_EAX);
  *(undefined4 *)(puVar1 + (-4 - in_EAX)) = unaff_retaddr;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _localtime
// 
// Library: Visual Studio 2003 Release

tm * __cdecl _localtime(time_t *_Time)

{
  time_t *_Time_00;
  tm *_Time_01;
  int iVar1;
  
  _Time_00 = _Time;
  if ((int)*_Time < 0) {
    _Time_01 = (tm *)0x0;
  }
  else {
    ___tzset();
    iVar1 = (int)*_Time_00;
    if ((iVar1 < 0x3f481) || (0x7ffc0b7e < iVar1)) {
      _Time_01 = _gmtime(_Time_00);
      if ((DAT_10041a9c == 0) || (iVar1 = __isindst(_Time_01), iVar1 == 0)) {
        _Time = (time_t *)(_Time_01->tm_sec - _DAT_10041a98);
      }
      else {
        _Time = (time_t *)((_Time_01->tm_sec - DAT_10041aa0) - _DAT_10041a98);
        _Time_01->tm_isdst = 1;
      }
      iVar1 = (int)_Time % 0x3c;
      _Time_01->tm_sec = iVar1;
      if (iVar1 < 0) {
        _Time_01->tm_sec = iVar1 + 0x3c;
        _Time = (time_t *)((int)_Time + -0x3c);
      }
      _Time = (time_t *)((int)_Time / 0x3c + _Time_01->tm_min);
      iVar1 = (int)_Time % 0x3c;
      _Time_01->tm_min = iVar1;
      if (iVar1 < 0) {
        _Time_01->tm_min = iVar1 + 0x3c;
        _Time = (time_t *)((int)_Time + -0x3c);
      }
      _Time = (time_t *)((int)_Time / 0x3c + _Time_01->tm_hour);
      iVar1 = (int)_Time % 0x18;
      _Time_01->tm_hour = iVar1;
      if (iVar1 < 0) {
        _Time_01->tm_hour = iVar1 + 0x18;
        _Time = _Time + -3;
      }
      iVar1 = (int)_Time / 0x18;
      if (iVar1 < 1) {
        if (-1 < iVar1) {
          return _Time_01;
        }
        _Time_01->tm_wday = (_Time_01->tm_wday + 7 + iVar1) % 7;
        _Time_01->tm_mday = _Time_01->tm_mday + iVar1;
        if (_Time_01->tm_mday < 1) {
          _Time_01->tm_year = _Time_01->tm_year + -1;
          _Time_01->tm_mday = _Time_01->tm_mday + 0x1f;
          _Time_01->tm_yday = 0x16c;
          _Time_01->tm_mon = 0xb;
          return _Time_01;
        }
      }
      else {
        _Time_01->tm_wday = (_Time_01->tm_wday + iVar1) % 7;
        _Time_01->tm_mday = _Time_01->tm_mday + iVar1;
      }
      _Time_01->tm_yday = _Time_01->tm_yday + iVar1;
    }
    else {
      _Time = (time_t *)(iVar1 - _DAT_10041a98);
      _Time_01 = _gmtime((time_t *)&_Time);
      if ((DAT_10041a9c != 0) && (iVar1 = __isindst(_Time_01), iVar1 != 0)) {
        _Time = (time_t *)((int)_Time - DAT_10041aa0);
        _Time_01 = _gmtime((time_t *)&_Time);
        _Time_01->tm_isdst = 1;
      }
    }
  }
  return _Time_01;
}



// Library Function - Single Match
//  _gmtime
// 
// Library: Visual Studio 2003 Release

tm * __cdecl _gmtime(time_t *_Time)

{
  bool bVar1;
  _ptiddata p_Var2;
  void *pvVar3;
  tm *ptVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  undefined4 *puVar9;
  
  iVar8 = (int)*_Time;
  bVar1 = false;
  p_Var2 = __getptd();
  if (iVar8 < 0) {
    return (tm *)0x0;
  }
  if (p_Var2->_gmtimebuf == (void *)0x0) {
    pvVar3 = _malloc(0x24);
    p_Var2->_gmtimebuf = pvVar3;
    ptVar4 = (tm *)&DAT_10052e7c;
    if (pvVar3 == (void *)0x0) goto LAB_1002e057;
  }
  ptVar4 = (tm *)p_Var2->_gmtimebuf;
LAB_1002e057:
  iVar6 = iVar8 % 0x7861f80;
  iVar8 = (iVar8 / 0x7861f80) * 4;
  iVar5 = iVar8 + 0x46;
  iVar7 = iVar6;
  if (0x1e1337f < iVar6) {
    iVar7 = iVar6 + -0x1e13380;
    iVar5 = iVar8 + 0x47;
    if (0x1e1337f < iVar7) {
      iVar7 = iVar6 + -0x3c26700;
      iVar5 = iVar8 + 0x48;
      if (iVar7 < 0x1e28500) {
        bVar1 = true;
      }
      else {
        iVar5 = iVar8 + 0x49;
        iVar7 = iVar6 + -0x5a4ec00;
      }
    }
  }
  ptVar4->tm_year = iVar5;
  puVar9 = (undefined4 *)&DAT_10041b48;
  ptVar4->tm_yday = iVar7 / 0x15180;
  if (!bVar1) {
    puVar9 = &DAT_10041b7c;
  }
  iVar5 = 1;
  iVar8 = puVar9[1];
  while (iVar8 < ptVar4->tm_yday) {
    iVar5 = iVar5 + 1;
    iVar8 = puVar9[iVar5];
  }
  ptVar4->tm_mon = iVar5 + -1;
  ptVar4->tm_mday = ptVar4->tm_yday - puVar9[iVar5 + -1];
  ptVar4->tm_wday = ((int)*_Time / 0x15180 + 4) % 7;
  ptVar4->tm_hour = (iVar7 % 0x15180) / 0xe10;
  iVar8 = (iVar7 % 0x15180) % 0xe10;
  ptVar4->tm_min = iVar8 / 0x3c;
  ptVar4->tm_isdst = 0;
  ptVar4->tm_sec = iVar8 % 0x3c;
  return ptVar4;
}



// Library Function - Single Match
//  _strncmp
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

int __cdecl _strncmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  char cVar2;
  size_t sVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  
  sVar3 = _MaxCount;
  pcVar6 = _Str1;
  if (_MaxCount != 0) {
    do {
      if (sVar3 == 0) break;
      sVar3 = sVar3 - 1;
      cVar1 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar1 != '\0');
    iVar4 = _MaxCount - sVar3;
    do {
      pcVar6 = _Str2;
      pcVar7 = _Str1;
      if (iVar4 == 0) break;
      iVar4 = iVar4 + -1;
      pcVar7 = _Str1 + 1;
      pcVar6 = _Str2 + 1;
      cVar2 = *_Str1;
      cVar1 = *_Str2;
      _Str2 = pcVar6;
      _Str1 = pcVar7;
    } while (cVar1 == cVar2);
    uVar5 = 0;
    if ((byte)pcVar6[-1] <= (byte)pcVar7[-1]) {
      if (pcVar6[-1] == pcVar7[-1]) {
        return 0;
      }
      uVar5 = 0xfffffffe;
    }
    _MaxCount = ~uVar5;
  }
  return _MaxCount;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __heap_alloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl __heap_alloc(size_t _Size)

{
  int *piVar1;
  LPVOID pvVar2;
  
  if ((DAT_100535c0 == 3) && (_Size <= DAT_100535ac)) {
    __lock(4);
    piVar1 = ___sbh_alloc_block((uint *)_Size);
    FUN_1002e1db();
    if (piVar1 != (int *)0x0) {
      return piVar1;
    }
  }
  if (_Size == 0) {
    _Size = 1;
  }
  if (DAT_100535c0 != 1) {
    _Size = _Size + 0xf & 0xfffffff0;
  }
  pvVar2 = HeapAlloc(DAT_100535bc,0,_Size);
  return pvVar2;
}



void FUN_1002e1db(void)

{
  FUN_1002f8d0(4);
  return;
}



// Library Function - Single Match
//  __nh_malloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl __nh_malloc(size_t _Size,int _NhFlag)

{
  void *pvVar1;
  int iVar2;
  
  if (_Size < 0xffffffe1) {
    do {
      pvVar1 = __heap_alloc(_Size);
      if (pvVar1 != (void *)0x0) {
        return pvVar1;
      }
      if (_NhFlag == 0) {
        return (void *)0x0;
      }
      iVar2 = __callnewh(_Size);
    } while (iVar2 != 0);
  }
  return (void *)0x0;
}



// Library Function - Single Match
//  _malloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl _malloc(size_t _Size)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(_Size,DAT_10053224);
  return pvVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _free
// 
// Library: Visual Studio 2003 Release

void __cdecl _free(void *_Memory)

{
  uint *puVar1;
  
  if (_Memory != (void *)0x0) {
    if (DAT_100535c0 == 3) {
      __lock(4);
      puVar1 = (uint *)___sbh_find_block((int)_Memory);
      if (puVar1 != (uint *)0x0) {
        ___sbh_free_block(puVar1,(int)_Memory);
      }
      FUN_1002e275();
      if (puVar1 != (uint *)0x0) {
        return;
      }
    }
    HeapFree(DAT_100535bc,0,_Memory);
  }
  return;
}



void FUN_1002e275(void)

{
  FUN_1002f8d0(4);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _printf
// 
// Library: Visual Studio 2003 Release

int __cdecl _printf(char *_Format,...)

{
  int _Flag;
  int iVar1;
  
  __lock_file2(1,&DAT_100415a0);
  _Flag = __stbuf((FILE *)&DAT_100415a0);
  iVar1 = __output(&DAT_100415a0,(byte *)_Format,(wchar_t *)&stack0x00000008);
  __ftbuf(_Flag,(FILE *)&DAT_100415a0);
  FUN_1002e2ee();
  return iVar1;
}



void FUN_1002e2ee(void)

{
  void *unaff_ESI;
  
  __unlock_file2(1,unaff_ESI);
  return;
}



// Library Function - Single Match
//  __fclose_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __fclose_lk(FILE *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar2 = -1;
  if ((param_1->_flag & 0x83) != 0) {
    iVar2 = __flush(param_1);
    __freebuf(param_1);
    iVar1 = __close(param_1->_file);
    if (iVar1 < 0) {
      iVar2 = -1;
    }
    else if (param_1->_tmpfname != (char *)0x0) {
      _free(param_1->_tmpfname);
      param_1->_tmpfname = (char *)0x0;
    }
  }
  param_1->_flag = 0;
  return iVar2;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fclose
// 
// Library: Visual Studio 2003 Release

int __cdecl _fclose(FILE *_File)

{
  int local_20;
  
  local_20 = -1;
  if ((_File->_flag & 0x40) == 0) {
    __lock_file(_File);
    local_20 = __fclose_lk(_File);
    FUN_1002e38e();
  }
  else {
    _File->_flag = 0;
  }
  return local_20;
}



void FUN_1002e38e(void)

{
  FILE *unaff_ESI;
  
  __unlock_file(unaff_ESI);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fgets
// 
// Library: Visual Studio 2003 Release

char * __cdecl _fgets(char *_Buf,int _MaxCount,FILE *_File)

{
  int *piVar1;
  uint uVar2;
  char *pcVar3;
  char *local_20;
  
  local_20 = _Buf;
  if (_MaxCount < 1) {
    local_20 = (char *)0x0;
  }
  else {
    __lock_file(_File);
    pcVar3 = _Buf;
    do {
      _MaxCount = _MaxCount + -1;
      if (_MaxCount == 0) break;
      piVar1 = &_File->_cnt;
      *piVar1 = *piVar1 + -1;
      if (*piVar1 < 0) {
        uVar2 = __filbuf(_File);
      }
      else {
        uVar2 = (uint)(byte)*_File->_ptr;
        _File->_ptr = _File->_ptr + 1;
      }
      if (uVar2 == 0xffffffff) {
        if (pcVar3 == _Buf) {
          local_20 = (char *)0x0;
          goto LAB_1002e3ff;
        }
        break;
      }
      *pcVar3 = (char)uVar2;
      pcVar3 = pcVar3 + 1;
    } while ((char)uVar2 != '\n');
    *pcVar3 = '\0';
LAB_1002e3ff:
    FUN_1002e414();
  }
  return local_20;
}



void FUN_1002e414(void)

{
  FILE *unaff_ESI;
  
  __unlock_file(unaff_ESI);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __fsopen
// 
// Library: Visual Studio 2003 Release

FILE * __cdecl __fsopen(char *_Filename,char *_Mode,int _ShFlag)

{
  FILE *pFVar1;
  int *piVar2;
  
  pFVar1 = __getstream();
  if (pFVar1 == (FILE *)0x0) {
    piVar2 = FUN_1003366f();
    *piVar2 = 0x18;
    pFVar1 = (FILE *)0x0;
  }
  else {
    pFVar1 = __openfile(_Filename,_Mode,_ShFlag,pFVar1);
    FUN_1002e46e();
  }
  return pFVar1;
}



void FUN_1002e46e(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + -0x1c));
  return;
}



void __cdecl FUN_1002e478(char *param_1,char *param_2)

{
  __fsopen(param_1,param_2,0x40);
  return;
}



// Library Function - Single Match
//  _strcmp
// 
// Library: Visual Studio 2003 Release

int __cdecl _strcmp(char *_Str1,char *_Str2)

{
  undefined2 uVar1;
  undefined4 uVar2;
  byte bVar3;
  byte bVar4;
  bool bVar5;
  
  if (((uint)_Str1 & 3) != 0) {
    if (((uint)_Str1 & 1) != 0) {
      bVar4 = *_Str1;
      _Str1 = _Str1 + 1;
      bVar5 = bVar4 < (byte)*_Str2;
      if (bVar4 != *_Str2) goto LAB_1002e4d4;
      _Str2 = _Str2 + 1;
      if (bVar4 == 0) {
        return 0;
      }
      if (((uint)_Str1 & 2) == 0) goto LAB_1002e4a0;
    }
    uVar1 = *(undefined2 *)_Str1;
    _Str1 = _Str1 + 2;
    bVar4 = (byte)uVar1;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) goto LAB_1002e4d4;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((ushort)uVar1 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) goto LAB_1002e4d4;
    if (bVar4 == 0) {
      return 0;
    }
    _Str2 = (char *)((byte *)_Str2 + 2);
  }
LAB_1002e4a0:
  while( true ) {
    uVar2 = *(undefined4 *)_Str1;
    bVar4 = (byte)uVar2;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 0x10);
    bVar5 = bVar4 < ((byte *)_Str2)[2];
    if (bVar4 != ((byte *)_Str2)[2]) break;
    bVar3 = (byte)((uint)uVar2 >> 0x18);
    if (bVar4 == 0) {
      return 0;
    }
    bVar5 = bVar3 < ((byte *)_Str2)[3];
    if (bVar3 != ((byte *)_Str2)[3]) break;
    _Str2 = (char *)((byte *)_Str2 + 4);
    _Str1 = _Str1 + 4;
    if (bVar3 == 0) {
      return 0;
    }
  }
LAB_1002e4d4:
  return (uint)bVar5 * -2 + 1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl _fprintf(FILE *_File,char *_Format,...)

{
  int _Flag;
  int iVar1;
  
  __lock_file(_File);
  _Flag = __stbuf(_File);
  iVar1 = __output(_File,(byte *)_Format,(wchar_t *)&stack0x0000000c);
  __ftbuf(_Flag,_File);
  FUN_1002e56c();
  return iVar1;
}



void FUN_1002e56c(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + -0x20));
  return;
}



// Library Function - Single Match
//  __lock_file
// 
// Library: Visual Studio 2003 Release

void __cdecl __lock_file(FILE *_File)

{
  if (((FILE *)0x1004157f < _File) && (_File < (FILE *)0x100417e1)) {
    __lock(((int)(_File + -0x8020ac) >> 5) + 0x10);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



// Library Function - Single Match
//  __lock_file2
// 
// Library: Visual Studio 2003 Release

void __cdecl __lock_file2(int _Index,void *_File)

{
  if (_Index < 0x14) {
    __lock(_Index + 0x10);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)((int)_File + 0x20));
  return;
}



// Library Function - Single Match
//  __unlock_file
// 
// Libraries: Visual Studio 2003 Release, Visual Studio 2005 Release

void __cdecl __unlock_file(FILE *_File)

{
  if (((FILE *)0x1004157f < _File) && (_File < (FILE *)0x100417e1)) {
    FUN_1002f8d0(((int)(_File + -0x8020ac) >> 5) + 0x10);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(_File + 1));
  return;
}



// Library Function - Single Match
//  __unlock_file2
// 
// Library: Visual Studio 2003 Release

void __cdecl __unlock_file2(int _Index,void *_File)

{
  if (_Index < 0x14) {
    FUN_1002f8d0(_Index + 0x10);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)((int)_File + 0x20));
  return;
}



// Library Function - Single Match
//  _atol
// 
// Library: Visual Studio 2003 Release

long __cdecl _atol(char *_Str)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  int iVar4;
  int *extraout_ECX;
  int *extraout_ECX_00;
  int *extraout_ECX_01;
  int *this;
  uint uVar5;
  int iVar6;
  byte *pbVar7;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  while( true ) {
    if ((int)ptVar2->lc_category[1].refcount < 2) {
      this = ptVar2->lc_category[3].refcount;
      uVar3 = *(byte *)((int)this + (uint)(byte)*_Str * 2) & 8;
    }
    else {
      uVar3 = ___isctype_mt(this,(int)ptVar2,(uint)(byte)*_Str,8);
      this = extraout_ECX_01;
    }
    if (uVar3 == 0) break;
    _Str = (char *)((byte *)_Str + 1);
  }
  uVar3 = (uint)(byte)*_Str;
  pbVar7 = (byte *)_Str + 1;
  if ((uVar3 == 0x2d) || (uVar5 = uVar3, uVar3 == 0x2b)) {
    uVar5 = (uint)*pbVar7;
    pbVar7 = (byte *)_Str + 2;
  }
  iVar4 = 0;
  while( true ) {
    if ((uVar5 < 0x30) || (0x39 < uVar5)) {
      iVar6 = -1;
    }
    else {
      iVar6 = uVar5 - 0x30;
    }
    if (iVar6 == -1) break;
    iVar4 = iVar6 + iVar4 * 10;
    uVar5 = (uint)*pbVar7;
    pbVar7 = pbVar7 + 1;
  }
  if (uVar3 == 0x2d) {
    iVar4 = -iVar4;
  }
  return iVar4;
}



long __cdecl _atol(char *_Str)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  int iVar4;
  int *extraout_ECX;
  int *extraout_ECX_00;
  int *extraout_ECX_01;
  int *this;
  uint uVar5;
  int iVar6;
  byte *pbVar7;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  while( true ) {
    if ((int)ptVar2->lc_category[1].refcount < 2) {
      this = ptVar2->lc_category[3].refcount;
      uVar3 = *(byte *)((int)this + (uint)(byte)*_Str * 2) & 8;
    }
    else {
      uVar3 = ___isctype_mt(this,(int)ptVar2,(uint)(byte)*_Str,8);
      this = extraout_ECX_01;
    }
    if (uVar3 == 0) break;
    _Str = (char *)((byte *)_Str + 1);
  }
  uVar3 = (uint)(byte)*_Str;
  pbVar7 = (byte *)_Str + 1;
  if ((uVar3 == 0x2d) || (uVar5 = uVar3, uVar3 == 0x2b)) {
    uVar5 = (uint)*pbVar7;
    pbVar7 = (byte *)_Str + 2;
  }
  iVar4 = 0;
  while( true ) {
    if ((uVar5 < 0x30) || (0x39 < uVar5)) {
      iVar6 = -1;
    }
    else {
      iVar6 = uVar5 - 0x30;
    }
    if (iVar6 == -1) break;
    iVar4 = iVar6 + iVar4 * 10;
    uVar5 = (uint)*pbVar7;
    pbVar7 = pbVar7 + 1;
  }
  if (uVar3 == 0x2d) {
    iVar4 = -iVar4;
  }
  return iVar4;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _realloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl _realloc(void *_Memory,size_t _NewSize)

{
  void *pvVar1;
  int iVar2;
  uint *puVar3;
  LPVOID pvVar4;
  uint *local_24;
  int *local_20;
  
  if (_Memory == (void *)0x0) {
    pvVar1 = _malloc(_NewSize);
  }
  else {
    if (_NewSize == 0) {
      _free(_Memory);
    }
    else if (DAT_100535c0 == 3) {
      do {
        local_20 = (int *)0x0;
        if (_NewSize < (uint *)0xffffffe1) {
          __lock(4);
          local_24 = (uint *)___sbh_find_block((int)_Memory);
          if (local_24 != (uint *)0x0) {
            if (_NewSize <= DAT_100535ac) {
              iVar2 = ___sbh_resize_block(local_24,(int)_Memory,_NewSize);
              if (iVar2 == 0) {
                local_20 = ___sbh_alloc_block((uint *)_NewSize);
                if (local_20 != (int *)0x0) {
                  puVar3 = (uint *)(*(int *)((int)_Memory + -4) - 1);
                  if (_NewSize <= puVar3) {
                    puVar3 = (uint *)_NewSize;
                  }
                  _memcpy(local_20,_Memory,(size_t)puVar3);
                  local_24 = (uint *)___sbh_find_block((int)_Memory);
                  ___sbh_free_block(local_24,(int)_Memory);
                }
              }
              else {
                local_20 = (int *)_Memory;
              }
            }
            if (local_20 == (int *)0x0) {
              if ((uint *)_NewSize == (uint *)0x0) {
                _NewSize = 1;
              }
              _NewSize = _NewSize + 0xf & 0xfffffff0;
              local_20 = (int *)HeapAlloc(DAT_100535bc,0,_NewSize);
              if (local_20 != (int *)0x0) {
                puVar3 = (uint *)(*(int *)((int)_Memory + -4) - 1);
                if (_NewSize <= puVar3) {
                  puVar3 = (uint *)_NewSize;
                }
                _memcpy(local_20,_Memory,(size_t)puVar3);
                ___sbh_free_block(local_24,(int)_Memory);
              }
            }
          }
          FUN_1002e8cc();
          if (local_24 == (uint *)0x0) {
            if ((uint *)_NewSize == (uint *)0x0) {
              _NewSize = 1;
            }
            _NewSize = _NewSize + 0xf & 0xfffffff0;
            local_20 = (int *)HeapReAlloc(DAT_100535bc,0,_Memory,_NewSize);
          }
        }
        if (local_20 != (int *)0x0) {
          return local_20;
        }
        if (DAT_10053224 == 0) {
          return (void *)0x0;
        }
        iVar2 = __callnewh(_NewSize);
      } while (iVar2 != 0);
    }
    else {
      do {
        pvVar4 = (LPVOID)0x0;
        if (_NewSize < 0xffffffe1) {
          if (_NewSize == 0) {
            _NewSize = 1;
          }
          pvVar4 = HeapReAlloc(DAT_100535bc,0,_Memory,_NewSize);
        }
        if (pvVar4 != (LPVOID)0x0) {
          return pvVar4;
        }
        if (DAT_10053224 == 0) {
          return (void *)0x0;
        }
        iVar2 = __callnewh(_NewSize);
      } while (iVar2 != 0);
    }
    pvVar1 = (void *)0x0;
  }
  return pvVar1;
}



void FUN_1002e8cc(void)

{
  FUN_1002f8d0(4);
  return;
}



// Library Function - Single Match
//  __vsnprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl __vsnprintf(char *_Dest,size_t _Count,char *_Format,va_list _Args)

{
  int iVar1;
  FILE local_24;
  
  local_24._cnt = _Count;
  local_24._flag = 0x42;
  local_24._base = _Dest;
  local_24._ptr = _Dest;
  iVar1 = __output(&local_24,(byte *)_Format,(wchar_t *)_Args);
  if (_Dest != (char *)0x0) {
    local_24._cnt = local_24._cnt - 1;
    if (local_24._cnt < 0) {
      __flsbuf(0,&local_24);
    }
    else {
      *local_24._ptr = '\0';
    }
  }
  return iVar1;
}



// Library Function - Single Match
//  __flush
// 
// Library: Visual Studio 2003 Release

int __cdecl __flush(FILE *_File)

{
  uint uVar1;
  int iVar2;
  uint _MaxCharCount;
  
  iVar2 = 0;
  if ((((byte)_File->_flag & 3) == 2) && ((_File->_flag & 0x108U) != 0)) {
    _MaxCharCount = (int)_File->_ptr - (int)_File->_base;
    if (0 < (int)_MaxCharCount) {
      uVar1 = __write(_File->_file,_File->_base,_MaxCharCount);
      if (uVar1 == _MaxCharCount) {
        if ((char)_File->_flag < '\0') {
          _File->_flag = _File->_flag & 0xfffffffd;
        }
      }
      else {
        _File->_flag = _File->_flag | 0x20;
        iVar2 = -1;
      }
    }
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return iVar2;
}



// Library Function - Single Match
//  __fflush_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __fflush_lk(FILE *param_1)

{
  int iVar1;
  
  iVar1 = __flush(param_1);
  if (iVar1 != 0) {
    return -1;
  }
  if ((param_1->_flag & 0x4000) != 0) {
    iVar1 = __commit(param_1->_file);
    return -(uint)(iVar1 != 0);
  }
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _flsall
// 
// Library: Visual Studio 2003 Release

int __cdecl flsall(int param_1)

{
  void *_File;
  FILE *pFVar1;
  int iVar2;
  int _Index;
  int local_28;
  int local_20;
  
  local_20 = 0;
  local_28 = 0;
  __lock(1);
  for (_Index = 0; _Index < DAT_10054700; _Index = _Index + 1) {
    _File = *(void **)(DAT_100536f0 + _Index * 4);
    if ((_File != (void *)0x0) && ((*(byte *)((int)_File + 0xc) & 0x83) != 0)) {
      __lock_file2(_Index,_File);
      pFVar1 = *(FILE **)(DAT_100536f0 + _Index * 4);
      if ((pFVar1->_flag & 0x83U) != 0) {
        if (param_1 == 1) {
          iVar2 = __fflush_lk(pFVar1);
          if (iVar2 != -1) {
            local_20 = local_20 + 1;
          }
        }
        else if ((param_1 == 0) && ((pFVar1->_flag & 2U) != 0)) {
          iVar2 = __fflush_lk(pFVar1);
          if (iVar2 == -1) {
            local_28 = -1;
          }
        }
      }
      FUN_1002ea92();
    }
  }
  FUN_1002eabe();
  if (param_1 != 1) {
    local_20 = local_28;
  }
  return local_20;
}



void FUN_1002ea92(void)

{
  int unaff_ESI;
  
  __unlock_file2(unaff_ESI,*(void **)(DAT_100536f0 + unaff_ESI * 4));
  return;
}



void FUN_1002eabe(void)

{
  FUN_1002f8d0(1);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fflush
// 
// Library: Visual Studio 2003 Release

int __cdecl _fflush(FILE *_File)

{
  int iVar1;
  
  if (_File == (FILE *)0x0) {
    iVar1 = flsall(0);
  }
  else {
    __lock_file(_File);
    iVar1 = __fflush_lk(_File);
    FUN_1002eb0d();
  }
  return iVar1;
}



void FUN_1002eb0d(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 8));
  return;
}



// Library Function - Single Match
//  __snprintf
// 
// Library: Visual Studio 2003 Release

int __cdecl __snprintf(char *_Dest,size_t _Count,char *_Format,...)

{
  int iVar1;
  FILE local_24;
  
  local_24._cnt = _Count;
  local_24._flag = 0x42;
  local_24._base = _Dest;
  local_24._ptr = _Dest;
  iVar1 = __output(&local_24,(byte *)_Format,(wchar_t *)&stack0x00000010);
  if (_Dest != (char *)0x0) {
    local_24._cnt = local_24._cnt - 1;
    if (local_24._cnt < 0) {
      __flsbuf(0,&local_24);
    }
    else {
      *local_24._ptr = '\0';
    }
  }
  return iVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fputs
// 
// Library: Visual Studio 2003 Release

int __cdecl _fputs(char *_Str,FILE *_File)

{
  size_t sVar1;
  int _Flag;
  uint uVar2;
  
  sVar1 = _strlen(_Str);
  __lock_file(_File);
  _Flag = __stbuf(_File);
  uVar2 = __fwrite_lk(_Str,1,sVar1,_File);
  __ftbuf(_Flag,_File);
  FUN_1002ebde();
  return (uVar2 == sVar1) - 1;
}



void FUN_1002ebde(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 0xc));
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  _puts
// 
// Library: Visual Studio 2003 Release

int __cdecl _puts(char *_Str)

{
  int _Flag;
  size_t sVar1;
  uint uVar2;
  int local_24;
  
  local_24 = -1;
  __lock_file2(1,&DAT_100415a0);
  _Flag = __stbuf((FILE *)&DAT_100415a0);
  sVar1 = _strlen(_Str);
  uVar2 = __fwrite_lk(_Str,1,sVar1,(FILE *)&DAT_100415a0);
  if (uVar2 == sVar1) {
    _DAT_100415a4 = _DAT_100415a4 + -1;
    if (_DAT_100415a4 < 0) {
      __flsbuf(10,(FILE *)&DAT_100415a0);
    }
    else {
      *DAT_100415a0 = 10;
      DAT_100415a0 = DAT_100415a0 + 1;
    }
    local_24 = 0;
  }
  __ftbuf(_Flag,(FILE *)&DAT_100415a0);
  FUN_1002ec7e();
  return local_24;
}



void FUN_1002ec7e(void)

{
  void *unaff_ESI;
  
  __unlock_file2(1,unaff_ESI);
  return;
}



// Library Function - Single Match
//  _isdigit
// 
// Library: Visual Studio 2003 Release

int __cdecl _isdigit(int _C)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (1 < (int)ptVar2->lc_category[1].refcount) {
    uVar3 = ___isctype_mt(this,(int)ptVar2,_C,4);
    return uVar3;
  }
  return *(byte *)((int)ptVar2->lc_category[3].refcount + _C * 2) & 4;
}



// Library Function - Single Match
//  _isspace
// 
// Library: Visual Studio 2003 Release

int __cdecl _isspace(int _C)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (1 < (int)ptVar2->lc_category[1].refcount) {
    uVar3 = ___isctype_mt(this,(int)ptVar2,_C,8);
    return uVar3;
  }
  return *(byte *)((int)ptVar2->lc_category[3].refcount + _C * 2) & 8;
}



// Library Function - Single Match
//  __fread_lk
// 
// Library: Visual Studio 2003 Release

uint __cdecl __fread_lk(undefined1 *param_1,uint param_2,uint param_3,FILE *param_4)

{
  undefined1 *puVar1;
  int iVar2;
  undefined1 *puVar3;
  undefined1 *puVar4;
  undefined1 *_Size;
  undefined1 *local_8;
  
  puVar4 = (undefined1 *)(param_2 * param_3);
  if (puVar4 == (undefined1 *)0x0) {
    param_3 = 0;
  }
  else {
    puVar3 = param_1;
    param_1 = puVar4;
    if ((param_4->_flag & 0x10c) == 0) {
      local_8 = (undefined1 *)0x1000;
    }
    else {
      local_8 = (undefined1 *)param_4->_bufsiz;
    }
    do {
      if (((param_4->_flag & 0x10c) == 0) ||
         (puVar1 = (undefined1 *)param_4->_cnt, puVar1 == (undefined1 *)0x0)) {
        if (param_1 < local_8) {
          iVar2 = __filbuf(param_4);
          if (iVar2 == -1) goto LAB_1002edd4;
          *puVar3 = (char)iVar2;
          local_8 = (undefined1 *)param_4->_bufsiz;
          puVar3 = puVar3 + 1;
          param_1 = param_1 + -1;
        }
        else {
          puVar1 = param_1;
          if (local_8 != (undefined1 *)0x0) {
            puVar1 = param_1 + -((uint)param_1 % (uint)local_8);
          }
          iVar2 = __read(param_4->_file,puVar3,(uint)puVar1);
          if (iVar2 == 0) {
            param_4->_flag = param_4->_flag | 0x10;
LAB_1002edd4:
            return (uint)((int)puVar4 - (int)param_1) / param_2;
          }
          if (iVar2 == -1) {
            param_4->_flag = param_4->_flag | 0x20;
            goto LAB_1002edd4;
          }
          param_1 = param_1 + -iVar2;
          puVar3 = puVar3 + iVar2;
        }
      }
      else {
        _Size = param_1;
        if (puVar1 <= param_1) {
          _Size = puVar1;
        }
        _memcpy(puVar3,param_4->_ptr,(size_t)_Size);
        param_1 = param_1 + -(int)_Size;
        param_4->_cnt = param_4->_cnt - (int)_Size;
        param_4->_ptr = _Size + (int)param_4->_ptr;
        puVar3 = puVar3 + (int)_Size;
      }
    } while (param_1 != (undefined1 *)0x0);
  }
  return param_3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fread
// 
// Library: Visual Studio 2003 Release

size_t __cdecl _fread(void *_DstBuf,size_t _ElementSize,size_t _Count,FILE *_File)

{
  uint uVar1;
  
  __lock_file(_File);
  uVar1 = __fread_lk((undefined1 *)_DstBuf,_ElementSize,_Count,_File);
  FUN_1002ee28();
  return uVar1;
}



void FUN_1002ee28(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 0x14));
  return;
}



// Library Function - Single Match
//  ___tolower_mt
// 
// Library: Visual Studio 2003 Release

uint __thiscall ___tolower_mt(void *this,int param_1,uint param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  LPCSTR _LpSrcStr;
  int iVar4;
  BOOL unaff_EDI;
  undefined4 local_8;
  
  uVar2 = param_2;
  iVar4 = param_1;
  if ((*(int *)(param_1 + 0x14) == 0) || ((*(int *)(param_1 + 0x24) != 0 && (param_2 < 0x80)))) {
    if ((0x40 < (int)param_2) && ((int)param_2 < 0x5b)) {
      return param_2 + 0x20;
    }
  }
  else {
    local_8 = this;
    if (param_2 < 0x100) {
      if (*(int *)(param_1 + 0x28) < 2) {
        uVar3 = *(byte *)(*(int *)(param_1 + 0x48) + param_2 * 2) & 1;
      }
      else {
        uVar3 = ___isctype_mt(this,param_1,param_2,1);
      }
      if (uVar3 == 0) {
        return uVar2;
      }
    }
    iVar1 = param_1;
    if ((*(byte *)(*(int *)(iVar4 + 0x48) + 1 + ((int)uVar2 >> 8 & 0xffU) * 2) & 0x80) == 0) {
      param_1._0_2_ = (ushort)(byte)uVar2;
      _LpSrcStr = (LPCSTR)0x1;
    }
    else {
      param_1._0_2_ = CONCAT11((byte)uVar2,(char)(uVar2 >> 8));
      param_1._3_1_ = SUB41(iVar1,3);
      param_1._0_3_ = (uint3)(ushort)param_1;
      _LpSrcStr = (LPCSTR)0x2;
    }
    iVar4 = ___crtLCMapStringA(*(_locale_t *)(iVar4 + 0x14),(LPCWSTR)0x100,(DWORD)&param_1,_LpSrcStr
                               ,(int)&local_8,(LPSTR)0x3,*(int *)(iVar4 + 4),1,unaff_EDI);
    if (iVar4 != 0) {
      if (iVar4 != 1) {
        return (uint)CONCAT11((undefined1)local_8,local_8._1_1_);
      }
      return (uint)local_8 & 0xff;
    }
  }
  return uVar2;
}



// Library Function - Single Match
//  _tolower
// 
// Library: Visual Studio 2003 Release

int __cdecl _tolower(int _C)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  uint uVar3;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  uVar3 = ___tolower_mt(this,(int)ptVar2,_C);
  return uVar3;
}



// Library Function - Single Match
//  __fwrite_lk
// 
// Library: Visual Studio 2003 Release

uint __cdecl __fwrite_lk(char *param_1,uint param_2,uint param_3,FILE *param_4)

{
  uint uVar1;
  int iVar2;
  uint _Size;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint local_8;
  
  uVar5 = param_2 * param_3;
  if (uVar5 == 0) {
    param_3 = 0;
  }
  else {
    uVar4 = uVar5;
    if ((param_4->_flag & 0x10c) == 0) {
      local_8 = 0x1000;
    }
    else {
      local_8 = param_4->_bufsiz;
    }
    do {
      uVar3 = param_4->_flag & 0x108;
      if ((uVar3 == 0) || (uVar1 = param_4->_cnt, uVar1 == 0)) {
        if (local_8 <= uVar4) {
          if ((uVar3 != 0) && (iVar2 = __flush(param_4), iVar2 != 0)) {
LAB_1002f011:
            return (uVar5 - uVar4) / param_2;
          }
          uVar3 = uVar4;
          if (local_8 != 0) {
            uVar3 = uVar4 - uVar4 % local_8;
          }
          _Size = __write(param_4->_file,param_1,uVar3);
          if ((_Size == 0xffffffff) || (uVar4 = uVar4 - _Size, _Size < uVar3)) {
            param_4->_flag = param_4->_flag | 0x20;
            goto LAB_1002f011;
          }
          goto LAB_1002efd1;
        }
        iVar2 = __flsbuf((int)*param_1,param_4);
        if (iVar2 == -1) goto LAB_1002f011;
        param_1 = param_1 + 1;
        local_8 = param_4->_bufsiz;
        uVar4 = uVar4 - 1;
        if ((int)local_8 < 1) {
          local_8 = 1;
        }
      }
      else {
        _Size = uVar4;
        if (uVar1 <= uVar4) {
          _Size = uVar1;
        }
        _memcpy(param_4->_ptr,param_1,_Size);
        param_4->_cnt = param_4->_cnt - _Size;
        param_4->_ptr = param_4->_ptr + _Size;
        uVar4 = uVar4 - _Size;
LAB_1002efd1:
        param_1 = param_1 + _Size;
      }
    } while (uVar4 != 0);
  }
  return param_3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fwrite
// 
// Library: Visual Studio 2003 Release

size_t __cdecl _fwrite(void *_Str,size_t _Size,size_t _Count,FILE *_File)

{
  uint uVar1;
  
  __lock_file(_File);
  uVar1 = __fwrite_lk((char *)_Str,_Size,_Count,_File);
  FUN_1002f065();
  return uVar1;
}



void FUN_1002f065(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 0x14));
  return;
}



// Library Function - Single Match
//  __ftell_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __ftell_lk(uint *param_1)

{
  uint _FileHandle;
  uint uVar1;
  byte bVar2;
  int *piVar3;
  uint *puVar4;
  long lVar5;
  char *pcVar6;
  uint *puVar7;
  char *pcVar8;
  char *pcVar9;
  int iVar10;
  int local_c;
  int local_8;
  
  puVar7 = param_1;
  _FileHandle = param_1[4];
  if ((int)param_1[1] < 0) {
    param_1[1] = 0;
  }
  local_8 = __lseek(_FileHandle,0,1);
  if (local_8 < 0) {
LAB_1002f13a:
    local_c = -1;
  }
  else {
    uVar1 = param_1[3];
    if ((uVar1 & 0x108) == 0) {
      return local_8 - param_1[1];
    }
    pcVar6 = (char *)*param_1;
    pcVar9 = (char *)param_1[2];
    local_c = (int)pcVar6 - (int)pcVar9;
    if ((uVar1 & 3) == 0) {
      if (-1 < (char)uVar1) {
        piVar3 = FUN_1003366f();
        *piVar3 = 0x16;
        goto LAB_1002f13a;
      }
    }
    else if (((*(byte *)((&DAT_100535e0)[(int)_FileHandle >> 5] + 4 + (_FileHandle & 0x1f) * 0x24) &
              0x80) != 0) && (pcVar8 = pcVar9, pcVar9 < pcVar6)) {
      do {
        if (*pcVar8 == '\n') {
          local_c = local_c + 1;
        }
        pcVar8 = pcVar8 + 1;
      } while (pcVar8 < (char *)*param_1);
    }
    if (local_8 != 0) {
      if ((param_1[3] & 1) != 0) {
        if (param_1[1] == 0) {
          local_c = 0;
        }
        else {
          puVar4 = (uint *)(pcVar6 + (param_1[1] - (int)pcVar9));
          iVar10 = (_FileHandle & 0x1f) * 0x24;
          if ((*(byte *)(iVar10 + 4 + (&DAT_100535e0)[(int)_FileHandle >> 5]) & 0x80) != 0) {
            lVar5 = __lseek(_FileHandle,0,2);
            if (lVar5 == local_8) {
              pcVar6 = (char *)param_1[2];
              pcVar9 = (char *)((int)puVar4 + (int)pcVar6);
              param_1 = puVar4;
              for (; pcVar6 < pcVar9; pcVar6 = pcVar6 + 1) {
                if (*pcVar6 == '\n') {
                  param_1 = (uint *)((int)param_1 + 1);
                }
              }
              bVar2 = *(byte *)((int)puVar7 + 0xd) & 0x20;
            }
            else {
              __lseek(_FileHandle,local_8,0);
              puVar7 = (uint *)0x200;
              if ((((uint *)0x200 < puVar4) || ((param_1[3] & 8) == 0)) ||
                 ((param_1[3] & 0x400) != 0)) {
                puVar7 = (uint *)param_1[6];
              }
              bVar2 = *(byte *)(iVar10 + 4 + (&DAT_100535e0)[(int)_FileHandle >> 5]) & 4;
              param_1 = puVar7;
            }
            puVar4 = param_1;
            if (bVar2 != 0) {
              puVar4 = (uint *)((int)param_1 + 1);
            }
          }
          param_1 = puVar4;
          local_8 = local_8 - (int)param_1;
        }
      }
      local_c = local_c + local_8;
    }
  }
  return local_c;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _ftell
// 
// Library: Visual Studio 2003 Release

long __cdecl _ftell(FILE *_File)

{
  int iVar1;
  
  __lock_file(_File);
  iVar1 = __ftell_lk((uint *)_File);
  FUN_1002f236();
  return iVar1;
}



void FUN_1002f236(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 8));
  return;
}



// Library Function - Single Match
//  __fseek_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __fseek_lk(FILE *param_1,int param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  long lVar3;
  int *piVar4;
  
  if (((param_1->_flag & 0x83U) == 0) || (((param_3 != 0 && (param_3 != 1)) && (param_3 != 2)))) {
    piVar4 = FUN_1003366f();
    *piVar4 = 0x16;
    iVar2 = -1;
  }
  else {
    param_1->_flag = param_1->_flag & 0xffffffef;
    if (param_3 == 1) {
      iVar2 = __ftell_lk((uint *)param_1);
      param_2 = param_2 + iVar2;
      param_3 = 0;
    }
    __flush(param_1);
    uVar1 = param_1->_flag;
    if ((char)uVar1 < '\0') {
      param_1->_flag = uVar1 & 0xfffffffc;
    }
    else if ((((uVar1 & 1) != 0) && ((uVar1 & 8) != 0)) && ((uVar1 & 0x400) == 0)) {
      param_1->_bufsiz = 0x200;
    }
    lVar3 = __lseek(param_1->_file,param_2,param_3);
    iVar2 = (lVar3 != -1) - 1;
  }
  return iVar2;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _fseek
// 
// Library: Visual Studio 2003 Release

int __cdecl _fseek(FILE *_File,long _Offset,int _Origin)

{
  int iVar1;
  
  __lock_file(_File);
  iVar1 = __fseek_lk(_File,_Offset,_Origin);
  FUN_1002f30e();
  return iVar1;
}



void FUN_1002f30e(void)

{
  int unaff_EBP;
  
  __unlock_file(*(FILE **)(unaff_EBP + 8));
  return;
}



// Library Function - Single Match
//  _strrchr
// 
// Library: Visual Studio

char * __cdecl _strrchr(char *_Str,int _Ch)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  
  iVar2 = -1;
  do {
    pcVar4 = _Str;
    if (iVar2 == 0) break;
    iVar2 = iVar2 + -1;
    pcVar4 = _Str + 1;
    cVar1 = *_Str;
    _Str = pcVar4;
  } while (cVar1 != '\0');
  iVar2 = -(iVar2 + 1);
  pcVar4 = pcVar4 + -1;
  do {
    pcVar3 = pcVar4;
    if (iVar2 == 0) break;
    iVar2 = iVar2 + -1;
    pcVar3 = pcVar4 + -1;
    cVar1 = *pcVar4;
    pcVar4 = pcVar3;
  } while ((char)_Ch != cVar1);
  pcVar3 = pcVar3 + 1;
  if (*pcVar3 != (char)_Ch) {
    pcVar3 = (char *)0x0;
  }
  return pcVar3;
}



// Library Function - Single Match
//  __aulldiv
// 
// Libraries: Visual Studio 2003 Release, Visual Studio 2005 Release

undefined8 __aulldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



// Library Function - Single Match
//  __forcdecpt
// 
// Library: Visual Studio 2003 Release

void __cdecl __forcdecpt(char *_Buf)

{
  char cVar1;
  char cVar2;
  int iVar3;
  bool bVar4;
  
  iVar3 = _tolower((int)*_Buf);
  bVar4 = iVar3 == 0x65;
  while (!bVar4) {
    _Buf = _Buf + 1;
    iVar3 = _isdigit((int)*_Buf);
    bVar4 = iVar3 == 0;
  }
  cVar2 = *_Buf;
  *_Buf = DAT_10041eb4;
  do {
    _Buf = _Buf + 1;
    cVar1 = *_Buf;
    *_Buf = cVar2;
    cVar2 = cVar1;
  } while (*_Buf != '\0');
  return;
}



// Library Function - Single Match
//  __fassign
// 
// Library: Visual Studio 2003 Release

void __cdecl __fassign(int flag,char *argument,char *number)

{
  _CRT_FLOAT local_c;
  undefined4 local_8;
  
  if (flag != 0) {
    FID_conflict___atodbl(&local_c,number);
    *(float *)argument = local_c.f;
    *(undefined4 *)(argument + 4) = local_8;
    return;
  }
  FID_conflict___atodbl((_CRT_FLOAT *)&flag,number);
  *(int *)argument = flag;
  return;
}



// Library Function - Single Match
//  __shift
// 
// Library: Visual Studio 2003 Release

void __shift(void)

{
  char *in_EAX;
  size_t sVar1;
  int unaff_EDI;
  
  if (unaff_EDI != 0) {
    sVar1 = _strlen(in_EAX);
    _memmove(in_EAX + unaff_EDI,in_EAX,sVar1 + 1);
  }
  return;
}



// Library Function - Single Match
//  __cftoe2
// 
// Library: Visual Studio 2003 Release

void __cdecl __cftoe2(int param_1,int param_2,char param_3)

{
  int *in_EAX;
  undefined1 *puVar1;
  uint *puVar2;
  int iVar3;
  int iVar4;
  undefined1 *unaff_EBX;
  
  if (param_3 != '\0') {
    __shift();
  }
  if (*in_EAX == 0x2d) {
    *unaff_EBX = 0x2d;
    unaff_EBX = unaff_EBX + 1;
  }
  puVar1 = unaff_EBX;
  if (0 < param_1) {
    puVar1 = unaff_EBX + 1;
    *unaff_EBX = *puVar1;
    *puVar1 = DAT_10041eb4;
  }
  puVar2 = FUN_10034d50((uint *)(puVar1 + param_1 + (uint)(param_3 == '\0')),(uint *)"e+000");
  if (param_2 != 0) {
    *(undefined1 *)puVar2 = 0x45;
  }
  if (*(char *)in_EAX[3] != '0') {
    iVar3 = in_EAX[1] + -1;
    if (iVar3 < 0) {
      iVar3 = -iVar3;
      *(undefined1 *)((int)puVar2 + 1) = 0x2d;
    }
    if (99 < iVar3) {
      iVar4 = iVar3 / 100;
      iVar3 = iVar3 % 100;
      *(char *)((int)puVar2 + 2) = *(char *)((int)puVar2 + 2) + (char)iVar4;
    }
    if (9 < iVar3) {
      iVar4 = iVar3 / 10;
      iVar3 = iVar3 % 10;
      *(char *)((int)puVar2 + 3) = *(char *)((int)puVar2 + 3) + (char)iVar4;
    }
    *(char *)(puVar2 + 1) = (char)puVar2[1] + (char)iVar3;
  }
  return;
}



// Library Function - Single Match
//  __cftoe
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl __cftoe(double *_Value,char *_Buf,size_t _SizeInBytes,int _Dec,int _Caps)

{
  errno_t eVar1;
  size_t unaff_ESI;
  STRFLT _PtFlt;
  _strflt local_30;
  char local_20 [24];
  int local_8;
  
  local_8 = DAT_10041558;
  _PtFlt = *(STRFLT *)_Value;
  __fltout2((_CRT_DOUBLE)*_Value,&local_30,local_20,unaff_ESI);
  __fptostr(_Buf + (uint)(0 < (int)_SizeInBytes) + (uint)(local_30.sign == 0x2d),_SizeInBytes + 1,
            (int)&local_30,_PtFlt);
  __cftoe2(_SizeInBytes,_Dec,'\0');
  eVar1 = FUN_1002d447(local_8);
  return eVar1;
}



// Library Function - Single Match
//  __cftof2
// 
// Library: Visual Studio 2003 Release

undefined1 * __cdecl __cftof2(undefined1 *param_1,size_t param_2,char param_3)

{
  int iVar1;
  int iVar2;
  int *in_EAX;
  undefined1 *puVar3;
  
  iVar1 = in_EAX[1];
  if ((param_3 != '\0') && (iVar1 - 1U == param_2)) {
    iVar2 = *in_EAX;
    param_1[(uint)(iVar2 == 0x2d) + (iVar1 - 1U)] = 0x30;
    (param_1 + (uint)(iVar2 == 0x2d) + (iVar1 - 1U))[1] = 0;
  }
  puVar3 = param_1;
  if (*in_EAX == 0x2d) {
    *param_1 = 0x2d;
    puVar3 = param_1 + 1;
  }
  if (in_EAX[1] < 1) {
    __shift();
    *puVar3 = 0x30;
    puVar3 = puVar3 + 1;
  }
  else {
    puVar3 = puVar3 + in_EAX[1];
  }
  if (0 < (int)param_2) {
    __shift();
    *puVar3 = DAT_10041eb4;
    iVar1 = in_EAX[1];
    if (iVar1 < 0) {
      if ((param_3 != '\0') || (SBORROW4(param_2,-iVar1) == (int)(param_2 + iVar1) < 0)) {
        param_2 = -iVar1;
      }
      __shift();
      _memset(puVar3 + 1,0x30,param_2);
    }
  }
  return param_1;
}



// Library Function - Single Match
//  __cftof
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl __cftof(double *_Value,char *_Buf,size_t _SizeInBytes,int _Dec)

{
  errno_t eVar1;
  size_t unaff_ESI;
  STRFLT _PtFlt;
  _strflt local_30;
  char local_20 [24];
  int local_8;
  
  local_8 = DAT_10041558;
  _PtFlt = *(STRFLT *)_Value;
  __fltout2((_CRT_DOUBLE)*_Value,&local_30,local_20,unaff_ESI);
  __fptostr(_Buf + (local_30.sign == 0x2d),local_30.decpt + _SizeInBytes,(int)&local_30,_PtFlt);
  __cftof2(_Buf,_SizeInBytes,'\0');
  eVar1 = FUN_1002d447(local_8);
  return eVar1;
}



// Library Function - Single Match
//  __cftog
// 
// Library: Visual Studio 2003 Release

void __cdecl __cftog(double *param_1,undefined1 *param_2,size_t param_3,int param_4)

{
  char *pcVar1;
  int iVar2;
  size_t unaff_EDI;
  char *pcVar3;
  STRFLT _PtFlt;
  _strflt local_30;
  char local_20 [24];
  int local_8;
  
  local_8 = DAT_10041558;
  _PtFlt = *(STRFLT *)param_1;
  __fltout2((_CRT_DOUBLE)*param_1,&local_30,local_20,unaff_EDI);
  iVar2 = local_30.decpt + -1;
  __fptostr(param_2 + (local_30.sign == 0x2d),param_3,(int)&local_30,_PtFlt);
  local_30.decpt = local_30.decpt + -1;
  if ((local_30.decpt < -4) || ((int)param_3 <= local_30.decpt)) {
    __cftoe2(param_3,param_4,'\x01');
  }
  else {
    pcVar1 = param_2 + (local_30.sign == 0x2d);
    if (iVar2 < local_30.decpt) {
      do {
        pcVar3 = pcVar1;
        pcVar1 = pcVar3 + 1;
      } while (*pcVar3 != '\0');
      pcVar3[-1] = '\0';
    }
    __cftof2(param_2,param_3,'\x01');
  }
  FUN_1002d447(local_8);
  return;
}



// Library Function - Single Match
//  __cfltcvt
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl
__cfltcvt(double *arg,char *buffer,size_t sizeInBytes,int format,int precision,int caps)

{
  errno_t eVar1;
  int unaff_EBP;
  
  if ((sizeInBytes == 0x65) || (sizeInBytes == 0x45)) {
    eVar1 = __cftoe(arg,buffer,format,precision,unaff_EBP);
  }
  else {
    if (sizeInBytes == 0x66) {
      eVar1 = __cftof(arg,buffer,format,unaff_EBP);
      return eVar1;
    }
    eVar1 = __cftog(arg,buffer,format,precision);
  }
  return eVar1;
}



// Library Function - Single Match
//  __setdefaultprecision
// 
// Library: Visual Studio 2003 Release

void __setdefaultprecision(void)

{
  __controlfp(0x10000,0x30000);
  return;
}



// WARNING: Removing unreachable block (ram,0x1002f800)
// Library Function - Single Match
//  __ms_p5_test_fdiv
// 
// Library: Visual Studio 2003 Release

undefined4 __ms_p5_test_fdiv(void)

{
  return 0;
}



// Library Function - Single Match
//  __ms_p5_mp_test_fdiv
// 
// Library: Visual Studio 2003 Release

void __ms_p5_mp_test_fdiv(void)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleA("KERNEL32");
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"IsProcessorFeaturePresent");
    if (pFVar1 != (FARPROC)0x0) {
      (*pFVar1)(0);
      return;
    }
  }
  __ms_p5_test_fdiv();
  return;
}



// Library Function - Single Match
//  __mtinitlocks
// 
// Library: Visual Studio 2003 Release

int __cdecl __mtinitlocks(void)

{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  
  iVar2 = 0;
  puVar3 = &DAT_10052ea8;
  do {
    if ((&DAT_1004181c)[iVar2 * 2] == 1) {
      (&DAT_10041818)[iVar2 * 2] = puVar3;
      puVar3 = puVar3 + 0x18;
      iVar1 = ___crtInitCritSecAndSpinCount((&DAT_10041818)[iVar2 * 2],4000);
      if (iVar1 == 0) {
        (&DAT_10041818)[iVar2 * 2] = 0;
        return 0;
      }
    }
    iVar2 = iVar2 + 1;
  } while (iVar2 < 0x24);
  return 1;
}



// Library Function - Single Match
//  __mtdeletelocks
// 
// Library: Visual Studio 2003 Release

void __cdecl __mtdeletelocks(void)

{
  LPCRITICAL_SECTION lpCriticalSection;
  undefined4 *puVar1;
  
  puVar1 = &DAT_10041818;
  do {
    lpCriticalSection = (LPCRITICAL_SECTION)*puVar1;
    if ((lpCriticalSection != (LPCRITICAL_SECTION)0x0) && (puVar1[1] != 1)) {
      DeleteCriticalSection(lpCriticalSection);
      _free(lpCriticalSection);
      *puVar1 = 0;
    }
    puVar1 = puVar1 + 2;
  } while ((int)puVar1 < 0x10041938);
  puVar1 = &DAT_10041818;
  do {
    if (((LPCRITICAL_SECTION)*puVar1 != (LPCRITICAL_SECTION)0x0) && (puVar1[1] == 1)) {
      DeleteCriticalSection((LPCRITICAL_SECTION)*puVar1);
    }
    puVar1 = puVar1 + 2;
  } while ((int)puVar1 < 0x10041938);
  return;
}



void __cdecl FUN_1002f8d0(int param_1)

{
  LeaveCriticalSection((LPCRITICAL_SECTION)(&DAT_10041818)[param_1 * 2]);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __mtinitlocknum
// 
// Library: Visual Studio 2003 Release

int __cdecl __mtinitlocknum(int _LockNum)

{
  void *_Memory;
  int *piVar1;
  int iVar2;
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_1003f098;
  uStack_c = 0x1002f8f1;
  piVar1 = &DAT_10041818 + _LockNum * 2;
  if (*piVar1 == 0) {
    _Memory = _malloc(0x18);
    if (_Memory == (void *)0x0) {
      piVar1 = FUN_1003366f();
      *piVar1 = 0xc;
      return 0;
    }
    __lock(10);
    local_8 = (undefined *)0x0;
    if (*piVar1 == 0) {
      iVar2 = ___crtInitCritSecAndSpinCount(_Memory,4000);
      if (iVar2 == 0) {
        _free(_Memory);
        piVar1 = FUN_1003366f();
        *piVar1 = 0xc;
        __local_unwind2((int)local_14,-1);
        return 0;
      }
      *piVar1 = (int)_Memory;
    }
    else {
      _free(_Memory);
    }
    local_8 = (undefined *)0xffffffff;
    FUN_1002f97c();
  }
  return 1;
}



void FUN_1002f97c(void)

{
  FUN_1002f8d0(10);
  return;
}



// Library Function - Single Match
//  __lock
// 
// Library: Visual Studio 2003 Release

void __cdecl __lock(int _File)

{
  int iVar1;
  
  if ((&DAT_10041818)[_File * 2] == 0) {
    iVar1 = __mtinitlocknum(_File);
    if (iVar1 == 0) {
      __amsg_exit(0x11);
    }
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(&DAT_10041818)[_File * 2]);
  return;
}



// WARNING: This is an inlined function
// WARNING: Unable to track spacebase fully for stack
// WARNING: Variable defined which should be unmapped: param_2
// Library Function - Single Match
//  __SEH_prolog
// 
// Library: Visual Studio

void __cdecl __SEH_prolog(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 unaff_EBX;
  undefined4 unaff_ESI;
  undefined4 unaff_EDI;
  undefined4 unaff_retaddr;
  undefined4 auStack_18 [4];
  undefined1 local_8 [8];
  
  iVar1 = -param_2;
  *(undefined4 *)((int)auStack_18 + iVar1 + 0xc) = unaff_EBX;
  *(undefined4 *)((int)auStack_18 + iVar1 + 8) = unaff_ESI;
  *(undefined4 *)((int)auStack_18 + iVar1 + 4) = unaff_EDI;
  *(undefined4 *)((int)auStack_18 + iVar1) = unaff_retaddr;
  ExceptionList = local_8;
  return;
}



// WARNING: This is an inlined function
// Library Function - Single Match
//  __SEH_epilog
// 
// Library: Visual Studio

void __SEH_epilog(void)

{
  undefined4 *unaff_EBP;
  undefined4 unaff_retaddr;
  
  ExceptionList = (void *)unaff_EBP[-4];
  *unaff_EBP = unaff_retaddr;
  return;
}



void FUN_1002faf2(int param_1)

{
  __local_unwind2(*(int *)(param_1 + 0x18),*(int *)(param_1 + 0x1c));
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3

void __cdecl _free(void *_Memory)

{
  uint *puVar1;
  
  if (_Memory != (void *)0x0) {
    if (DAT_100535c0 == 3) {
      __lock(4);
      puVar1 = (uint *)___sbh_find_block((int)_Memory);
      if (puVar1 != (uint *)0x0) {
        ___sbh_free_block(puVar1,(int)_Memory);
      }
      FUN_1002e275();
      if (puVar1 != (uint *)0x0) {
        return;
      }
    }
    HeapFree(DAT_100535bc,0,_Memory);
  }
  return;
}



// Library Function - Single Match
//  __flsbuf
// 
// Library: Visual Studio 2003 Release

int __cdecl __flsbuf(int _Ch,FILE *_File)

{
  uint uVar1;
  uint _FileHandle;
  char *_Buf;
  char *pcVar2;
  FILE *_File_00;
  int iVar3;
  undefined *puVar4;
  FILE *_MaxCharCount;
  
  _File_00 = _File;
  uVar1 = _File->_flag;
  _FileHandle = _File->_file;
  if (((uVar1 & 0x82) == 0) || ((uVar1 & 0x40) != 0)) {
LAB_1002fc1e:
    _File->_flag = uVar1 | 0x20;
  }
  else {
    if ((uVar1 & 1) != 0) {
      _File->_cnt = 0;
      if ((uVar1 & 0x10) == 0) goto LAB_1002fc1e;
      _File->_ptr = _File->_base;
      _File->_flag = uVar1 & 0xfffffffe;
    }
    uVar1 = _File->_flag;
    _File->_cnt = 0;
    _File = (FILE *)0x0;
    _File_00->_flag = uVar1 & 0xffffffef | 2;
    if (((uVar1 & 0x10c) == 0) &&
       (((_File_00 != (FILE *)&DAT_100415a0 && (_File_00 != (FILE *)&DAT_100415c0)) ||
        (iVar3 = __isatty(_FileHandle), iVar3 == 0)))) {
      __getbuf(_File_00);
    }
    if ((_File_00->_flag & 0x108) == 0) {
      _MaxCharCount = (FILE *)0x1;
      _File = (FILE *)__write(_FileHandle,&_Ch,1);
    }
    else {
      _Buf = _File_00->_base;
      pcVar2 = _File_00->_ptr;
      _File_00->_ptr = _Buf + 1;
      _MaxCharCount = (FILE *)(pcVar2 + -(int)_Buf);
      _File_00->_cnt = _File_00->_bufsiz + -1;
      if ((int)_MaxCharCount < 1) {
        if (_FileHandle == 0xffffffff) {
          puVar4 = &DAT_10041950;
        }
        else {
          puVar4 = (undefined *)
                   ((&DAT_100535e0)[(int)_FileHandle >> 5] + (_FileHandle & 0x1f) * 0x24);
        }
        if ((puVar4[4] & 0x20) != 0) {
          __lseek(_FileHandle,0,2);
        }
      }
      else {
        _File = (FILE *)__write(_FileHandle,_Buf,(uint)_MaxCharCount);
      }
      *_File_00->_base = (char)_Ch;
    }
    if (_File == _MaxCharCount) {
      return _Ch & 0xff;
    }
    _File_00->_flag = _File_00->_flag | 0x20;
  }
  return -1;
}



// Library Function - Single Match
//  _write_char
// 
// Library: Visual Studio 2003 Release

void __cdecl write_char(void)

{
  int *piVar1;
  byte in_AL;
  uint uVar2;
  FILE *in_ECX;
  int *unaff_ESI;
  
  if (((in_ECX->_flag & 0x40) == 0) || (in_ECX->_base != (char *)0x0)) {
    piVar1 = &in_ECX->_cnt;
    *piVar1 = *piVar1 + -1;
    if (*piVar1 < 0) {
      uVar2 = __flsbuf((int)(char)in_AL,in_ECX);
    }
    else {
      *in_ECX->_ptr = in_AL;
      in_ECX->_ptr = in_ECX->_ptr + 1;
      uVar2 = (uint)in_AL;
    }
    if (uVar2 == 0xffffffff) {
      *unaff_ESI = -1;
      return;
    }
  }
  *unaff_ESI = *unaff_ESI + 1;
  return;
}



// Library Function - Single Match
//  _write_multi_char
// 
// Library: Visual Studio 2003 Release

void __cdecl write_multi_char(undefined4 param_1,int param_2)

{
  int *in_EAX;
  
  do {
    if (param_2 < 1) {
      return;
    }
    param_2 = param_2 + -1;
    write_char();
  } while (*in_EAX != -1);
  return;
}



// Library Function - Single Match
//  _write_string
// 
// Library: Visual Studio 2003 Release

void __cdecl write_string(int param_1)

{
  int *in_EAX;
  int unaff_EDI;
  
  if (((*(byte *)(unaff_EDI + 0xc) & 0x40) == 0) || (*(int *)(unaff_EDI + 8) != 0)) {
    do {
      if (param_1 < 1) {
        return;
      }
      param_1 = param_1 + -1;
      write_char();
    } while (*in_EAX != -1);
  }
  else {
    *in_EAX = *in_EAX + param_1;
  }
  return;
}



// WARNING: Type propagation algorithm not settling
// Library Function - Single Match
//  __output
// 
// Library: Visual Studio 2003 Release

void __cdecl __output(undefined4 param_1,byte *param_2,wchar_t *param_3)

{
  byte bVar1;
  short *psVar2;
  byte *pbVar3;
  wchar_t *pwVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int extraout_ECX;
  uint uVar8;
  byte bVar9;
  wchar_t *pwVar10;
  wchar_t *pwVar11;
  bool bVar12;
  undefined8 uVar13;
  undefined4 local_258;
  undefined4 local_254;
  size_t local_24c;
  int local_248;
  undefined4 local_244;
  int local_240;
  int local_23c;
  wchar_t *local_238;
  int local_234;
  int local_230;
  int local_22c;
  undefined1 local_228;
  char local_227;
  int local_224;
  size_t local_220;
  wchar_t *local_21c;
  int local_218;
  uint local_214;
  wchar_t local_210 [255];
  undefined2 local_11;
  int local_8;
  
  local_8 = DAT_10041558;
  local_220 = 0;
  local_224 = 0;
  local_238 = (wchar_t *)0x0;
  bVar9 = *param_2;
  iVar7 = 0;
  pbVar3 = param_2;
  pwVar11 = param_3;
  do {
    if ((bVar9 == 0) || (param_2 = pbVar3 + 1, local_224 < 0)) {
      FUN_1002d447(local_8);
      return;
    }
    if (((char)bVar9 < ' ') || ('x' < (char)bVar9)) {
      uVar5 = 0;
    }
    else {
      uVar5 = (int)"GAIsProcessorFeaturePresent"[(char)bVar9 + 0x1a] & 0xf;
    }
    local_248 = (int)(char)(&DAT_1003f0a8)[uVar5 * 8 + iVar7] >> 4;
    param_3 = pwVar11;
    switch(local_248) {
    case 0:
switchD_1002fd3e_caseD_0:
      local_234 = 0;
      if ((PTR_DAT_10041ef0[(uint)bVar9 * 2 + 1] & 0x80) != 0) {
        write_char();
        param_2 = pbVar3 + 2;
      }
      write_char();
      break;
    case 1:
      local_218 = -1;
      local_244 = 0;
      local_23c = 0;
      local_230 = 0;
      local_22c = 0;
      local_214 = 0;
      local_234 = 0;
      break;
    case 2:
      if (bVar9 == 0x20) {
        local_214 = local_214 | 2;
      }
      else if (bVar9 == 0x23) {
        local_214 = local_214 | 0x80;
      }
      else if (bVar9 == 0x2b) {
        local_214 = local_214 | 1;
      }
      else if (bVar9 == 0x2d) {
        local_214 = local_214 | 4;
      }
      else if (bVar9 == 0x30) {
        local_214 = local_214 | 8;
      }
      break;
    case 3:
      if (bVar9 == 0x2a) {
        local_230 = *(int *)pwVar11;
        param_3 = pwVar11 + 2;
        if (local_230 < 0) {
          local_214 = local_214 | 4;
          local_230 = -local_230;
        }
      }
      else {
        local_230 = (char)bVar9 + -0x30 + local_230 * 10;
      }
      break;
    case 4:
      local_218 = 0;
      break;
    case 5:
      if (bVar9 == 0x2a) {
        local_218 = *(int *)pwVar11;
        param_3 = pwVar11 + 2;
        if (local_218 < 0) {
          local_218 = -1;
        }
      }
      else {
        local_218 = (char)bVar9 + -0x30 + local_218 * 10;
      }
      break;
    case 6:
      if (bVar9 == 0x49) {
        bVar1 = *param_2;
        if ((bVar1 == 0x36) && (pbVar3[2] == 0x34)) {
          param_2 = pbVar3 + 3;
          local_214 = local_214 | 0x8000;
        }
        else if ((bVar1 == 0x33) && (pbVar3[2] == 0x32)) {
          param_2 = pbVar3 + 3;
          local_214 = local_214 & 0xffff7fff;
        }
        else if (((((bVar1 != 100) && (bVar1 != 0x69)) && (bVar1 != 0x6f)) &&
                 ((bVar1 != 0x75 && (bVar1 != 0x78)))) && (bVar1 != 0x58)) {
          local_248 = 0;
          goto switchD_1002fd3e_caseD_0;
        }
      }
      else if (bVar9 == 0x68) {
        local_214 = local_214 | 0x20;
      }
      else if (bVar9 == 0x6c) {
        local_214 = local_214 | 0x10;
      }
      else if (bVar9 == 0x77) {
        local_214 = local_214 | 0x800;
      }
      break;
    case 7:
      if ((char)bVar9 < 'h') {
        if ((char)bVar9 < 'e') {
          if ((char)bVar9 < 'Y') {
            if (bVar9 != 0x58) {
              if (bVar9 == 0x43) {
                if ((local_214 & 0x830) == 0) {
                  local_214 = local_214 | 0x800;
                }
                goto LAB_1002ffde;
              }
              if ((bVar9 != 0x45) && (bVar9 != 0x47)) {
                if (bVar9 == 0x53) {
                  if ((local_214 & 0x830) == 0) {
                    local_214 = local_214 | 0x800;
                  }
                  goto LAB_1002ff61;
                }
                goto LAB_10030356;
              }
              local_244 = 1;
              bVar9 = bVar9 + 0x20;
              goto LAB_1002ffb2;
            }
LAB_100301fc:
            local_240 = 7;
LAB_100301ff:
            local_220 = 0x10;
            if ((local_214 & 0x80) != 0) {
              local_227 = (char)local_240 + 'Q';
              local_228 = 0x30;
              local_22c = 2;
            }
            goto LAB_1003002f;
          }
          if (bVar9 == 0x5a) {
            param_3 = pwVar11 + 2;
            psVar2 = *(short **)pwVar11;
            pwVar11 = (wchar_t *)PTR_s__null__10041938;
            pwVar4 = (wchar_t *)PTR_s__null__10041938;
            if ((psVar2 == (short *)0x0) ||
               (local_21c = *(wchar_t **)(psVar2 + 2), pwVar4 = (wchar_t *)PTR_s__null__10041938,
               local_21c == (wchar_t *)0x0)) goto LAB_10030170;
            local_220 = (size_t)*psVar2;
            if ((local_214 & 0x800) == 0) {
              local_234 = 0;
            }
            else {
              local_220 = (int)local_220 / 2;
              local_234 = 1;
            }
          }
          else if (bVar9 == 99) {
LAB_1002ffde:
            if ((local_214 & 0x810) == 0) {
              local_210[0]._0_1_ = (char)*pwVar11;
              local_220 = 1;
            }
            else {
              local_220 = _wctomb((char *)local_210,*pwVar11);
              if ((int)local_220 < 0) {
                local_23c = 1;
              }
            }
            param_3 = pwVar11 + 2;
            local_21c = local_210;
          }
          else if (bVar9 == 100) goto LAB_10030024;
        }
        else {
LAB_1002ffb2:
          local_214 = local_214 | 0x40;
          pwVar10 = local_210;
          pwVar4 = local_210;
          if (local_218 < 0) {
            local_218 = 6;
          }
          else if (local_218 == 0) {
            if (bVar9 == 0x67) {
              local_218 = 1;
            }
          }
          else {
            if (0x200 < local_218) {
              local_218 = 0x200;
            }
            if ((0xa3 < local_218) &&
               (local_21c = local_210, local_238 = (wchar_t *)_malloc(local_218 + 0x15d),
               pwVar10 = local_238, pwVar4 = local_238, local_238 == (wchar_t *)0x0)) {
              local_218 = 0xa3;
              pwVar10 = local_210;
              pwVar4 = local_21c;
            }
          }
          local_21c = pwVar4;
          local_258 = *(undefined4 *)pwVar11;
          param_3 = pwVar11 + 4;
          local_254 = *(undefined4 *)(pwVar11 + 2);
          (*(code *)PTR___fptrap_10041800)(&local_258,pwVar10,(int)(char)bVar9,local_218,local_244);
          uVar5 = local_214 & 0x80;
          if ((uVar5 != 0) && (local_218 == 0)) {
            (*(code *)PTR___fptrap_1004180c)(pwVar10);
          }
          if ((bVar9 == 0x67) && (uVar5 == 0)) {
            (*(code *)PTR___fptrap_10041804)(pwVar10);
          }
          pwVar11 = pwVar10;
          pwVar4 = local_21c;
          if ((char)*pwVar10 == '-') {
            local_214 = local_214 | 0x100;
            pwVar11 = (wchar_t *)((int)pwVar10 + 1);
            pwVar4 = (wchar_t *)((int)pwVar10 + 1);
          }
LAB_10030170:
          local_21c = pwVar4;
          local_220 = _strlen((char *)pwVar11);
        }
LAB_10030356:
        uVar5 = local_214;
        if (local_23c == 0) {
          if ((local_214 & 0x40) != 0) {
            if ((local_214 & 0x100) == 0) {
              if ((local_214 & 1) == 0) {
                if ((local_214 & 2) == 0) goto LAB_1003038e;
                local_228 = 0x20;
              }
              else {
                local_228 = 0x2b;
              }
            }
            else {
              local_228 = 0x2d;
            }
            local_22c = 1;
          }
LAB_1003038e:
          iVar7 = (local_230 - local_22c) - local_220;
          if ((local_214 & 0xc) == 0) {
            write_multi_char(0x20,iVar7);
          }
          write_string(local_22c);
          if (((uVar5 & 8) != 0) && ((uVar5 & 4) == 0)) {
            write_multi_char(0x30,iVar7);
          }
          if ((local_234 == 0) || ((int)local_220 < 1)) {
            write_string(local_220);
          }
          else {
            local_24c = local_220;
            pwVar11 = local_21c;
            do {
              local_24c = local_24c - 1;
              iVar6 = _wctomb((char *)((int)&local_11 + 1),*pwVar11);
              pwVar11 = pwVar11 + 1;
              if (iVar6 < 1) break;
              write_string(iVar6);
            } while (local_24c != 0);
          }
          if ((local_214 & 4) != 0) {
            write_multi_char(0x20,iVar7);
          }
        }
      }
      else {
        if (bVar9 == 0x69) {
LAB_10030024:
          local_214 = local_214 | 0x40;
LAB_10030028:
          local_220 = 10;
LAB_1003002f:
          if ((local_214 & 0x8000) == 0) {
            param_3 = pwVar11 + 2;
            if ((local_214 & 0x20) == 0) {
              uVar5 = *(uint *)pwVar11;
              if ((local_214 & 0x40) == 0) {
                uVar8 = 0;
                goto LAB_100302a0;
              }
            }
            else if ((local_214 & 0x40) == 0) {
              uVar5 = (uint)(ushort)*pwVar11;
            }
            else {
              uVar5 = (uint)*pwVar11;
            }
            uVar8 = (int)uVar5 >> 0x1f;
          }
          else {
            uVar5 = *(uint *)pwVar11;
            uVar8 = *(uint *)(pwVar11 + 2);
            param_3 = pwVar11 + 4;
          }
LAB_100302a0:
          if ((((local_214 & 0x40) != 0) && ((int)uVar8 < 1)) && ((int)uVar8 < 0)) {
            bVar12 = uVar5 != 0;
            uVar5 = -uVar5;
            uVar8 = -(uVar8 + bVar12);
            local_214 = local_214 | 0x100;
          }
          uVar13 = CONCAT44(uVar8,uVar5);
          if ((local_214 & 0x8000) == 0) {
            uVar8 = 0;
          }
          if (local_218 < 0) {
            local_218 = 1;
          }
          else {
            local_214 = local_214 & 0xfffffff7;
            if (0x200 < local_218) {
              local_218 = 0x200;
            }
          }
          if (uVar5 == 0 && uVar8 == 0) {
            local_22c = 0;
          }
          pwVar11 = &local_11;
          while( true ) {
            uVar5 = (uint)uVar13;
            iVar7 = local_218 + -1;
            if ((local_218 < 1) && (uVar5 == 0 && uVar8 == 0)) break;
            local_218 = iVar7;
            uVar13 = __aulldvrm(uVar5,uVar8,local_220,(int)local_220 >> 0x1f);
            uVar8 = (uint)((ulonglong)uVar13 >> 0x20);
            iVar7 = extraout_ECX + 0x30;
            if (0x39 < iVar7) {
              iVar7 = iVar7 + local_240;
            }
            *(char *)pwVar11 = (char)iVar7;
            pwVar11 = (wchar_t *)((int)pwVar11 + -1);
            local_24c = uVar5;
          }
          local_220 = (int)&local_11 + -(int)pwVar11;
          local_21c = (wchar_t *)((int)pwVar11 + 1);
          local_218 = iVar7;
          if (((local_214 & 0x200) != 0) && ((*(char *)local_21c != '0' || (local_220 == 0)))) {
            *(char *)pwVar11 = '0';
            local_220 = (int)&local_11 + -(int)pwVar11 + 1;
            local_21c = pwVar11;
          }
          goto LAB_10030356;
        }
        if (bVar9 != 0x6e) {
          if (bVar9 == 0x6f) {
            local_220 = 8;
            if ((local_214 & 0x80) != 0) {
              local_214 = local_214 | 0x200;
            }
            goto LAB_1003002f;
          }
          if (bVar9 == 0x70) {
            local_218 = 8;
            goto LAB_100301fc;
          }
          if (bVar9 == 0x73) {
LAB_1002ff61:
            iVar7 = local_218;
            if (local_218 == -1) {
              iVar7 = 0x7fffffff;
            }
            param_3 = pwVar11 + 2;
            local_21c = *(wchar_t **)pwVar11;
            if ((local_214 & 0x810) == 0) {
              pwVar11 = local_21c;
              if (local_21c == (wchar_t *)0x0) {
                pwVar11 = (wchar_t *)PTR_s__null__10041938;
                local_21c = (wchar_t *)PTR_s__null__10041938;
              }
              for (; (iVar7 != 0 && (iVar7 = iVar7 + -1, (char)*pwVar11 != '\0'));
                  pwVar11 = (wchar_t *)((int)pwVar11 + 1)) {
              }
              local_220 = (int)pwVar11 - (int)local_21c;
            }
            else {
              if (local_21c == (wchar_t *)0x0) {
                local_21c = (wchar_t *)PTR_DAT_1004193c;
              }
              local_234 = 1;
              for (pwVar11 = local_21c; (iVar7 != 0 && (iVar7 = iVar7 + -1, *pwVar11 != L'\0'));
                  pwVar11 = pwVar11 + 1) {
              }
              local_220 = (int)pwVar11 - (int)local_21c >> 1;
            }
            goto LAB_10030356;
          }
          if (bVar9 != 0x75) {
            if (bVar9 != 0x78) goto LAB_10030356;
            local_240 = 0x27;
            goto LAB_100301ff;
          }
          goto LAB_10030028;
        }
        param_3 = pwVar11 + 2;
        if ((local_214 & 0x20) == 0) {
          **(int **)pwVar11 = local_224;
        }
        else {
          *(undefined2 *)*(int **)pwVar11 = (undefined2)local_224;
        }
        local_23c = 1;
      }
      if (local_238 != (wchar_t *)0x0) {
        _free(local_238);
        local_238 = (wchar_t *)0x0;
      }
    }
    bVar9 = *param_2;
    iVar7 = local_248;
    pbVar3 = param_2;
    pwVar11 = param_3;
  } while( true );
}



// Library Function - Single Match
//  int __cdecl TypeMatch(struct _s_HandlerType const *,struct _s_CatchableType const *,struct
// _s_ThrowInfo const *)
// 
// Library: Visual Studio 2003 Release

int __cdecl TypeMatch(_s_HandlerType *param_1,_s_CatchableType *param_2,_s_ThrowInfo *param_3)

{
  int iVar1;
  byte *unaff_ESI;
  byte *unaff_EDI;
  
  iVar1 = *(int *)(unaff_ESI + 4);
  if ((iVar1 != 0) && (*(char *)(iVar1 + 8) != '\0')) {
    if ((iVar1 != *(int *)(unaff_EDI + 4)) &&
       (iVar1 = _strcmp((char *)(iVar1 + 8),(char *)(*(int *)(unaff_EDI + 4) + 8)), iVar1 != 0)) {
      return 0;
    }
    if (((((*unaff_EDI & 2) != 0) && ((*unaff_ESI & 8) == 0)) ||
        (((param_1->adjectives & 1) != 0 && ((*unaff_ESI & 1) == 0)))) ||
       (((param_1->adjectives & 2) != 0 && ((*unaff_ESI & 2) == 0)))) {
      return 0;
    }
  }
  return 1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___FrameUnwindToState
// 
// Library: Visual Studio 2003 Release

void __cdecl ___FrameUnwindToState(int param_1,undefined4 param_2,int param_3,int param_4)

{
  _ptiddata p_Var1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = *(int *)(param_1 + 8);
  p_Var1 = __getptd();
  p_Var1->_purecall = (void *)((int)p_Var1->_purecall + 1);
  while (iVar4 != param_4) {
    if ((iVar4 < 0) || (*(int *)(param_3 + 4) <= iVar4)) {
      _inconsistency();
    }
    iVar2 = iVar4 * 8;
    piVar3 = (int *)(*(int *)(param_3 + 8) + iVar2);
    iVar4 = *piVar3;
    if (piVar3[1] != 0) {
      *(int *)(param_1 + 8) = iVar4;
      __CallSettingFrame_12(*(undefined4 *)(*(int *)(param_3 + 8) + 4 + iVar2),param_1,0x103);
    }
  }
  FUN_100305d3();
  if (iVar4 != param_4) {
    _inconsistency();
  }
  *(int *)(param_1 + 8) = iVar4;
  return;
}



void FUN_100305d3(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  if (0 < (int)p_Var1->_purecall) {
    p_Var1 = __getptd();
    p_Var1->_purecall = (void *)((int)p_Var1->_purecall + -1);
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___DestructExceptionObject
// 
// Library: Visual Studio 2003 Release

void __cdecl ___DestructExceptionObject(int param_1)

{
  undefined *UNRECOVERED_JUMPTABLE;
  
  if ((param_1 != 0) &&
     (UNRECOVERED_JUMPTABLE = *(undefined **)(*(int *)(param_1 + 0x1c) + 4),
     UNRECOVERED_JUMPTABLE != (undefined *)0x0)) {
    FID_conflict__CallMemberFunction1(*(undefined4 *)(param_1 + 0x18),UNRECOVERED_JUMPTABLE);
  }
  return;
}



// Library Function - Single Match
//  void * __cdecl AdjustPointer(void *,struct PMD const &)
// 
// Library: Visual Studio 2003 Release

void * __cdecl AdjustPointer(void *param_1,PMD *param_2)

{
  int in_EAX;
  void *pvVar1;
  int *in_ECX;
  
  pvVar1 = (void *)(*in_ECX + in_EAX);
  if (-1 < in_ECX[1]) {
    pvVar1 = (void *)((int)pvVar1 + *(int *)(*(int *)(in_ECX[1] + in_EAX) + in_ECX[2]) + in_ECX[1]);
  }
  return pvVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  void * __cdecl CallCatchBlock(struct EHExceptionRecord *,struct EHRegistrationNode *,struct
// _CONTEXT *,struct _s_FuncInfo const *,void *,int,unsigned long)
// 
// Library: Visual Studio 2003 Release

void * __cdecl
CallCatchBlock(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,
              _s_FuncInfo *param_4,void *param_5,int param_6,ulong param_7)

{
  _ptiddata p_Var1;
  void *in_ECX;
  FrameInfo local_54 [8];
  undefined4 local_4c;
  void *local_48;
  void *local_44;
  FrameInfo *local_40;
  undefined4 local_3c;
  void *local_24;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_1003f148;
  uStack_c = 0x1003065e;
  local_4c = 0;
  local_3c = *(undefined4 *)(param_2 + -4);
  local_40 = _CreateFrameInfo(local_54,*(void **)(param_1 + 0x18));
  p_Var1 = __getptd();
  local_44 = p_Var1->_unexpected;
  p_Var1 = __getptd();
  local_48 = p_Var1->_translator;
  p_Var1 = __getptd();
  p_Var1->_unexpected = param_1;
  p_Var1 = __getptd();
  p_Var1->_translator = param_3;
  local_8 = (undefined *)0x1;
  local_24 = _CallCatchBlock2(param_2,param_4,in_ECX,(int)param_5,param_6);
  local_8 = (undefined *)0xffffffff;
  FUN_100307a7();
  return local_24;
}



void FUN_100307a7(void)

{
  _ptiddata p_Var1;
  int iVar2;
  int unaff_EBP;
  int *unaff_ESI;
  int unaff_EDI;
  
  *(undefined4 *)(unaff_EDI + -4) = *(undefined4 *)(unaff_EBP + -0x38);
  _FindAndUnlinkFrame(*(FrameInfo **)(unaff_EBP + -0x3c));
  p_Var1 = __getptd();
  p_Var1->_unexpected = *(void **)(unaff_EBP + -0x40);
  p_Var1 = __getptd();
  p_Var1->_translator = *(void **)(unaff_EBP + -0x44);
  if ((((*unaff_ESI == -0x1f928c9d) && (unaff_ESI[4] == 3)) &&
      ((unaff_ESI[5] == 0x19930520 || (unaff_ESI[5] == 0x19930521)))) &&
     ((*(int *)(unaff_EBP + -0x48) == 0 && (*(int *)(unaff_EBP + -0x20) != 0)))) {
    iVar2 = IsExceptionObjectToBeDestroyed((void *)unaff_ESI[6]);
    if (iVar2 != 0) {
      __abnormal_termination();
      ___DestructExceptionObject((int)unaff_ESI);
    }
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  void __cdecl BuildCatchObject(struct EHExceptionRecord *,void *,struct _s_HandlerType const
// *,struct _s_CatchableType const *)
// 
// Library: Visual Studio 2003 Release

void __cdecl
BuildCatchObject(EHExceptionRecord *param_1,void *param_2,_s_HandlerType *param_3,
                _s_CatchableType *param_4)

{
  int iVar1;
  void *pvVar2;
  void *_Src;
  byte *in_ECX;
  int *in_EDX;
  PMD *unaff_ESI;
  PMD *unaff_EDI;
  
  if (*(int *)((int)param_2 + 4) == 0) {
    return;
  }
  if (*(char *)(*(int *)((int)param_2 + 4) + 8) == '\0') {
    return;
  }
  if ((*(int *)((int)param_2 + 8) == 0) && ((*(byte *)((int)param_2 + 3) & 0x80) == 0)) {
    return;
  }
                    // WARNING: Load size is inaccurate
  if (-1 < (int)*param_2) {
    in_EDX = (int *)(*(int *)((int)param_2 + 8) + 0xc + (int)in_EDX);
  }
  pvVar2 = *(void **)(param_1 + 0x18);
  if ((*param_2 & 8) == 0) {
    if ((*in_ECX & 1) == 0) {
      if (*(int *)(in_ECX + 0x18) == 0) {
        iVar1 = _ValidateRead(pvVar2,1);
        if ((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) {
          pvVar2 = *(void **)(in_ECX + 0x14);
          _Src = AdjustPointer(pvVar2,unaff_EDI);
          _memmove(in_EDX,_Src,(size_t)pvVar2);
          return;
        }
      }
      else {
        iVar1 = _ValidateRead(pvVar2,1);
        if (((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) &&
           (iVar1 = _ValidateExecute(*(_func_int **)(in_ECX + 0x18)), iVar1 != 0)) {
          if ((*in_ECX & 4) != 0) {
            AdjustPointer((void *)0x1,unaff_EDI);
            FID_conflict__CallMemberFunction1(in_EDX,*(undefined **)(in_ECX + 0x18));
            return;
          }
          AdjustPointer(unaff_EDI,unaff_ESI);
          FID_conflict__CallMemberFunction1(in_EDX,*(undefined **)(in_ECX + 0x18));
          return;
        }
      }
    }
    else {
      iVar1 = _ValidateRead(pvVar2,1);
      if ((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) {
        _memmove(in_EDX,*(void **)(param_1 + 0x18),*(size_t *)(in_ECX + 0x14));
        if (*(int *)(in_ECX + 0x14) != 4) {
          return;
        }
        if (*in_EDX == 0) {
          return;
        }
        goto LAB_1003088f;
      }
    }
  }
  else {
    iVar1 = _ValidateRead(pvVar2,1);
    if ((iVar1 != 0) && (iVar1 = _ValidateWrite(in_EDX,1), iVar1 != 0)) {
      *in_EDX = *(int *)(param_1 + 0x18);
LAB_1003088f:
      pvVar2 = AdjustPointer(unaff_EDI,unaff_ESI);
      *in_EDX = (int)pvVar2;
      return;
    }
  }
  _inconsistency();
  return;
}



// Library Function - Single Match
//  void __cdecl CatchIt(struct EHExceptionRecord *,struct EHRegistrationNode *,struct _CONTEXT
// *,void *,struct _s_FuncInfo const *,struct _s_HandlerType const *,struct _s_CatchableType const
// *,struct _s_TryBlockMapEntry const *,int,struct EHRegistrationNode *,unsigned char)
// 
// Library: Visual Studio 2003 Release

void __cdecl
CatchIt(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
       _s_FuncInfo *param_5,_s_HandlerType *param_6,_s_CatchableType *param_7,
       _s_TryBlockMapEntry *param_8,int param_9,EHRegistrationNode *param_10,uchar param_11)

{
  void *pvVar1;
  int in_ECX;
  void *unaff_EBX;
  _s_HandlerType *unaff_EBP;
  _s_HandlerType *unaff_ESI;
  int *unaff_EDI;
  _s_CatchableType *unaff_retaddr;
  _s_HandlerType *p_Var2;
  
  if (in_ECX != 0) {
    BuildCatchObject(param_1,unaff_EBX,unaff_EBP,unaff_retaddr);
  }
  if (param_6 == (_s_HandlerType *)0x0) {
    param_6 = unaff_ESI;
  }
  _UnwindNestedFrames((EHRegistrationNode *)param_6,param_1);
  p_Var2 = unaff_ESI;
  ___FrameUnwindToState((int)unaff_ESI,param_3,(int)param_4,*unaff_EDI);
  unaff_ESI->dispCatchObj = unaff_EDI[1] + 1;
  pvVar1 = CallCatchBlock(param_1,(EHRegistrationNode *)unaff_ESI,(_CONTEXT *)param_2,
                          (_s_FuncInfo *)param_4,param_5,0x100,(ulong)p_Var2);
  if (pvVar1 != (void *)0x0) {
    _JumpToContinuation(pvVar1,(EHRegistrationNode *)unaff_ESI);
  }
  return;
}



// Library Function - Single Match
//  void __cdecl FindHandlerForForeignException(struct EHExceptionRecord *,struct EHRegistrationNode
// *,struct _CONTEXT *,void *,struct _s_FuncInfo const *,int,int,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

void __cdecl
FindHandlerForForeignException
          (EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
          _s_FuncInfo *param_5,int param_6,int param_7,EHRegistrationNode *param_8)

{
  TypeDescriptor *pTVar1;
  _ptiddata p_Var2;
  int iVar3;
  _s_TryBlockMapEntry *p_Var4;
  _s_CatchableType *unaff_EBX;
  int unaff_ESI;
  _s_TryBlockMapEntry *unaff_EDI;
  EHRegistrationNode *extraout_var;
  EHRegistrationNode *pEVar5;
  EHRegistrationNode *extraout_var_00;
  EHRegistrationNode *pEVar6;
  
  if ((*(int *)param_1 != -0x7ffffffd) &&
     (((p_Var2 = __getptd(), pEVar5 = extraout_var, pEVar6 = extraout_var_00,
       p_Var2->_NLG_dwCode == 0 ||
       (iVar3 = _CallSETranslator(param_1,param_2,param_3,param_4,param_5,param_7,param_8),
       iVar3 == 0)) &&
      (p_Var4 = _GetRangeOfTrysToCheck
                          (param_5,param_7,param_6,(uint *)&stack0xfffffff8,(uint *)&stack0xfffffff4
                          ), pEVar6 < pEVar5)))) {
    do {
      if (((p_Var4->tryLow <= param_6) && (param_6 <= p_Var4->tryHigh)) &&
         ((pTVar1 = p_Var4->pHandlerArray[p_Var4->nCatches + -1].pType,
          pTVar1 == (TypeDescriptor *)0x0 || (*(char *)&pTVar1[1].pVFTable == '\0')))) {
        CatchIt(param_1,(EHRegistrationNode *)param_3,(_CONTEXT *)param_4,param_5,
                (_s_FuncInfo *)param_7,(_s_HandlerType *)param_8,unaff_EBX,unaff_EDI,unaff_ESI,
                pEVar5,(uchar)pEVar6);
      }
      pEVar6 = pEVar6 + 1;
      p_Var4 = p_Var4 + 1;
    } while (pEVar6 < pEVar5);
  }
  return;
}



// Library Function - Single Match
//  void __cdecl FindHandler(struct EHExceptionRecord *,struct EHRegistrationNode *,struct _CONTEXT
// *,void *,struct _s_FuncInfo const *,unsigned char,int,struct EHRegistrationNode *)
// 
// Library: Visual Studio 2003 Release

void __cdecl
FindHandler(EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
           _s_FuncInfo *param_5,uchar param_6,int param_7,EHRegistrationNode *param_8)

{
  int iVar1;
  int iVar2;
  _ptiddata p_Var3;
  int iVar4;
  _s_TryBlockMapEntry *p_Var5;
  int iVar6;
  int unaff_EBX;
  _s_TryBlockMapEntry *unaff_ESI;
  _s_CatchableType *unaff_EDI;
  EHRegistrationNode *pEVar7;
  uint in_stack_ffffffdc;
  int *local_14;
  uint local_10;
  _s_TryBlockMapEntry *local_c;
  undefined1 local_5;
  
  iVar1 = *(int *)(param_2 + 8);
  local_5 = 0;
  if ((iVar1 < -1) || (param_5->maxState <= iVar1)) {
    _inconsistency();
  }
  if (*(int *)param_1 == -0x1f928c9d) {
    if ((*(int *)(param_1 + 0x10) == 3) &&
       (((*(int *)(param_1 + 0x14) == 0x19930520 || (*(int *)(param_1 + 0x14) == 0x19930521)) &&
        (*(int *)(param_1 + 0x1c) == 0)))) {
      p_Var3 = __getptd();
      if (p_Var3->_unexpected == (void *)0x0) {
        return;
      }
      p_Var3 = __getptd();
      param_1 = (EHExceptionRecord *)p_Var3->_unexpected;
      p_Var3 = __getptd();
      param_3 = (_CONTEXT *)p_Var3->_translator;
      local_5 = 1;
      iVar4 = _ValidateRead(param_1,1);
      if (iVar4 == 0) {
        _inconsistency();
      }
      if (*(int *)param_1 != -0x1f928c9d) goto LAB_10030c90;
      if (((*(int *)(param_1 + 0x10) == 3) &&
          ((*(int *)(param_1 + 0x14) == 0x19930520 || (*(int *)(param_1 + 0x14) == 0x19930521)))) &&
         (*(int *)(param_1 + 0x1c) == 0)) {
        _inconsistency();
      }
    }
    if (((*(int *)param_1 == -0x1f928c9d) && (*(int *)(param_1 + 0x10) == 3)) &&
       ((*(int *)(param_1 + 0x14) == 0x19930520 || (*(int *)(param_1 + 0x14) == 0x19930521)))) {
      p_Var5 = _GetRangeOfTrysToCheck(param_5,param_7,iVar1,&local_10,(uint *)&stack0xffffffdc);
      local_c = p_Var5;
      if (local_10 < in_stack_ffffffdc) {
        do {
          if ((p_Var5->tryLow <= iVar1) && (iVar1 <= p_Var5->tryHigh)) {
            local_c = p_Var5;
            for (iVar4 = p_Var5->nCatches; 0 < iVar4; iVar4 = iVar4 + -1) {
              local_14 = *(int **)(*(int *)(param_1 + 0x1c) + 0xc);
              for (iVar2 = *local_14; 0 < iVar2; iVar2 = iVar2 + -1) {
                local_14 = local_14 + 1;
                pEVar7 = (EHRegistrationNode *)*local_14;
                iVar6 = TypeMatch(*(_s_HandlerType **)(param_1 + 0x1c),unaff_EDI,
                                  (_s_ThrowInfo *)unaff_ESI);
                p_Var5 = local_c;
                if (iVar6 != 0) {
                  CatchIt(param_1,(EHRegistrationNode *)param_3,(_CONTEXT *)param_4,param_5,
                          (_s_FuncInfo *)param_7,(_s_HandlerType *)param_8,unaff_EDI,unaff_ESI,
                          unaff_EBX,pEVar7,(uchar)in_stack_ffffffdc);
                  goto LAB_10030c63;
                }
              }
            }
          }
LAB_10030c63:
          local_10 = local_10 + 1;
          p_Var5 = p_Var5 + 1;
          local_c = p_Var5;
        } while (local_10 < in_stack_ffffffdc);
      }
      if (param_6 == '\0') {
        return;
      }
      ___DestructExceptionObject((int)param_1);
      return;
    }
  }
LAB_10030c90:
  if (param_6 == '\0') {
    FindHandlerForForeignException(param_1,param_2,param_3,param_4,param_5,iVar1,param_7,param_8);
    return;
  }
  terminate();
  return;
}



// Library Function - Single Match
//  ___InternalCxxFrameHandler
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl
___InternalCxxFrameHandler
          (EHExceptionRecord *param_1,EHRegistrationNode *param_2,_CONTEXT *param_3,void *param_4,
          _s_FuncInfo *param_5,int param_6,EHRegistrationNode *param_7,uchar param_8)

{
  undefined4 uVar1;
  
  if ((param_5->magicNumber_and_bbtFlags & 0x1fffffff) != 0x19930520) {
    _inconsistency();
  }
  if (((byte)param_1[4] & 0x66) == 0) {
    if (param_5->nTryBlocks != 0) {
      if (((*(int *)param_1 == -0x1f928c9d) && (0x19930520 < *(uint *)(param_1 + 0x14))) &&
         (*(code **)(*(int *)(param_1 + 0x1c) + 8) != (code *)0x0)) {
        uVar1 = (**(code **)(*(int *)(param_1 + 0x1c) + 8))
                          (param_1,param_2,param_3,param_4,param_5,param_6,param_7,param_8);
        return uVar1;
      }
      FindHandler(param_1,param_2,param_3,param_4,param_5,param_8,param_6,param_7);
    }
  }
  else if ((param_5->maxState != 0) && (param_6 == 0)) {
    ___FrameUnwindToState((int)param_2,param_4,(int)param_5,-1);
  }
  return 1;
}



void FUN_10030d5d(void)

{
  TlsAlloc();
  return;
}



// Library Function - Single Match
//  __mtterm
// 
// Library: Visual Studio 2003 Release

void __cdecl __mtterm(void)

{
  if (DAT_10041944 != -1) {
    (*DAT_10053004)(DAT_10041944);
    DAT_10041944 = -1;
  }
  __mtdeletelocks();
  return;
}



// Library Function - Single Match
//  __initptd
// 
// Library: Visual Studio 2003 Release

void __cdecl __initptd(_ptiddata _Ptd,pthreadlocinfo _Locale)

{
  _Ptd->_initaddr = &DAT_10041978;
  _Ptd->_holdrand = 1;
  return;
}



// Library Function - Single Match
//  __getptd
// 
// Library: Visual Studio 2003 Release

_ptiddata __cdecl __getptd(void)

{
  DWORD dwErrCode;
  _ptiddata p_Var1;
  int iVar2;
  DWORD DVar3;
  
  dwErrCode = GetLastError();
  p_Var1 = (_ptiddata)(*DAT_10052ffc)(DAT_10041944);
  if (p_Var1 == (_ptiddata)0x0) {
    p_Var1 = (_ptiddata)_calloc(1,0x8c);
    if (p_Var1 != (_ptiddata)0x0) {
      iVar2 = (*DAT_10053000)(DAT_10041944,p_Var1);
      if (iVar2 != 0) {
        p_Var1->_initaddr = &DAT_10041978;
        p_Var1->_holdrand = 1;
        DVar3 = GetCurrentThreadId();
        p_Var1->_thandle = 0xffffffff;
        p_Var1->_tid = DVar3;
        goto LAB_10030dfb;
      }
    }
    __amsg_exit(0x10);
  }
LAB_10030dfb:
  SetLastError(dwErrCode);
  return p_Var1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __freefls@4
// 
// Library: Visual Studio 2003 Release

void __freefls_4(void *param_1)

{
  int *piVar1;
  
  if (param_1 != (void *)0x0) {
    if (*(void **)((int)param_1 + 0x24) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x24));
    }
    if (*(void **)((int)param_1 + 0x2c) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x2c));
    }
    if (*(void **)((int)param_1 + 0x34) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x34));
    }
    if (*(void **)((int)param_1 + 0x3c) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x3c));
    }
    if (*(void **)((int)param_1 + 0x44) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x44));
    }
    if (*(void **)((int)param_1 + 0x48) != (void *)0x0) {
      _free(*(void **)((int)param_1 + 0x48));
    }
    if (*(undefined **)((int)param_1 + 0x54) != &DAT_10041978) {
      _free(*(undefined **)((int)param_1 + 0x54));
    }
    __lock(0xd);
    piVar1 = *(int **)((int)param_1 + 0x60);
    if (((piVar1 != (int *)0x0) && (*piVar1 = *piVar1 + -1, *piVar1 == 0)) &&
       (piVar1 != DAT_10053364)) {
      _free(piVar1);
    }
    FUN_10030f39();
    __lock(0xc);
    piVar1 = *(int **)((int)param_1 + 100);
    if (piVar1 != (int *)0x0) {
      *piVar1 = *piVar1 + -1;
      if (piVar1[0xb] != 0) {
        *(int *)piVar1[0xb] = *(int *)piVar1[0xb] + -1;
      }
      if (piVar1[0xd] != 0) {
        *(int *)piVar1[0xd] = *(int *)piVar1[0xd] + -1;
      }
      if (piVar1[0xc] != 0) {
        *(int *)piVar1[0xc] = *(int *)piVar1[0xc] + -1;
      }
      if (piVar1[0x10] != 0) {
        *(int *)piVar1[0x10] = *(int *)piVar1[0x10] + -1;
      }
      *(int *)(piVar1[0x13] + 0xb4) = *(int *)(piVar1[0x13] + 0xb4) + -1;
      if (((piVar1 != (int *)PTR_DAT_10041d74) && (piVar1 != &DAT_10041d20)) && (*piVar1 == 0)) {
        ___freetlocinfo(piVar1);
      }
    }
    FUN_10030f45();
    _free(param_1);
  }
  return;
}



void FUN_10030f39(void)

{
  FUN_1002f8d0(0xd);
  return;
}



void FUN_10030f45(void)

{
  FUN_1002f8d0(0xc);
  return;
}



// Library Function - Single Match
//  __freeptd
// 
// Library: Visual Studio 2003 Release

void __cdecl __freeptd(_ptiddata _Ptd)

{
  if (DAT_10041944 != -1) {
    if (_Ptd == (_ptiddata)0x0) {
      _Ptd = (_ptiddata)(*DAT_10052ffc)(DAT_10041944);
    }
    __freefls_4(_Ptd);
    (*DAT_10053000)(DAT_10041944,0);
  }
  return;
}



// Library Function - Single Match
//  __mtinit
// 
// Library: Visual Studio 2003 Release

int __cdecl __mtinit(void)

{
  int iVar1;
  HMODULE hModule;
  DWORD *pDVar2;
  DWORD DVar3;
  
  iVar1 = __mtinitlocks();
  if (iVar1 == 0) {
    __mtterm();
    return 0;
  }
  hModule = GetModuleHandleA("kernel32.dll");
  if (hModule != (HMODULE)0x0) {
    DAT_10052ff8 = GetProcAddress(hModule,"FlsAlloc");
    DAT_10052ffc = GetProcAddress(hModule,"FlsGetValue");
    DAT_10053000 = GetProcAddress(hModule,"FlsSetValue");
    DAT_10053004 = GetProcAddress(hModule,"FlsFree");
    if (DAT_10052ffc == (FARPROC)0x0) {
      DAT_10052ffc = TlsGetValue_exref;
      DAT_10053000 = TlsSetValue_exref;
      DAT_10052ff8 = FUN_10030d5d;
      DAT_10053004 = TlsFree_exref;
    }
  }
  DAT_10041944 = (*DAT_10052ff8)(__freefls_4);
  if (((DAT_10041944 != -1) && (pDVar2 = (DWORD *)_calloc(1,0x8c), pDVar2 != (DWORD *)0x0)) &&
     (iVar1 = (*DAT_10053000)(DAT_10041944,pDVar2), iVar1 != 0)) {
    pDVar2[0x15] = (DWORD)&DAT_10041978;
    pDVar2[5] = 1;
    DVar3 = GetCurrentThreadId();
    pDVar2[1] = 0xffffffff;
    *pDVar2 = DVar3;
    return 1;
  }
  __mtterm();
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// Library Function - Single Match
//  void __cdecl terminate(void)
// 
// Library: Visual Studio 2003 Release

void __cdecl terminate(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  if (p_Var1->ptlocinfo != (pthreadlocinfo)0x0) {
    p_Var1 = __getptd();
    (*(code *)p_Var1->ptlocinfo)();
  }
                    // WARNING: Subroutine does not return
  _abort();
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// Library Function - Single Match
//  void __cdecl _inconsistency(void)
// 
// Library: Visual Studio 2003 Release

void __cdecl _inconsistency(void)

{
  if (PTR_terminate_10041948 != (undefined *)0x0) {
    (*(code *)PTR_terminate_10041948)();
  }
  terminate();
  return;
}



// WARNING: Restarted to delay deadcode elimination for space: stack
// Library Function - Single Match
//  __CallSettingFrame@12
// 
// Library: Visual Studio 2003 Release

void __CallSettingFrame_12(undefined4 param_1,undefined4 param_2,int param_3)

{
  code *pcVar1;
  
  pcVar1 = (code *)__NLG_Notify1(param_3);
  (*pcVar1)();
  if (param_3 == 0x100) {
    param_3 = 2;
  }
  __NLG_Notify1(param_3);
  return;
}



// Library Function - Single Match
//  ___security_init_cookie
// 
// Library: Visual Studio 2003 Release

void __cdecl ___security_init_cookie(void)

{
  DWORD DVar1;
  DWORD DVar2;
  DWORD DVar3;
  LARGE_INTEGER local_14;
  _FILETIME local_c;
  
  if ((DAT_10041558 == 0) || (DAT_10041558 == 0xbb40e64e)) {
    GetSystemTimeAsFileTime(&local_c);
    DVar1 = GetCurrentProcessId();
    DVar2 = GetCurrentThreadId();
    DVar3 = GetTickCount();
    QueryPerformanceCounter(&local_14);
    DAT_10041558 = local_c.dwHighDateTime ^ local_c.dwLowDateTime ^ DVar1 ^ DVar2 ^ DVar3 ^
                   local_14.s.HighPart ^ local_14.s.LowPart;
    if (DAT_10041558 == 0) {
      DAT_10041558 = 0xbb40e64e;
    }
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// Library Function - Single Match
//  ___security_error_handler
// 
// Library: Visual Studio 2003 Release

void ___security_error_handler(int param_1)

{
  DWORD DVar1;
  size_t sVar2;
  uint *_Str;
  char *pcVar3;
  uint *local_12c;
  uint local_128 [65];
  undefined1 local_24;
  undefined4 local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_1003f3d0;
  uStack_c = 0x10031191;
  local_20 = DAT_10041558;
  if (DAT_10053008 == (code *)0x0) {
    if (param_1 == 1) {
      pcVar3 = "Buffer overrun detected!";
      local_12c = (uint *)0x1003f238;
    }
    else {
      pcVar3 = "Unknown security failure detected!";
      local_12c = (uint *)0x1003f2f8;
    }
    local_24 = 0;
    DVar1 = GetModuleFileNameA((HMODULE)0x0,(LPSTR)local_128,0x104);
    if (DVar1 == 0) {
      FUN_10034d50(local_128,(uint *)"<program name unknown>");
    }
    _Str = local_128;
    sVar2 = _strlen((char *)_Str);
    if (0x3c < sVar2 + 0xb) {
      sVar2 = _strlen((char *)_Str);
      _Str = (uint *)(&stack0xfffffea7 + sVar2);
      _strncpy((char *)_Str,"...",3);
    }
    _strlen((char *)_Str);
    local_1c = &stack0xfffffec8;
    FUN_10034d50((uint *)&stack0xfffffec8,(uint *)pcVar3);
    FUN_10034d60((uint *)&stack0xfffffec8,(uint *)&DAT_1003f218);
    FUN_10034d60((uint *)&stack0xfffffec8,(uint *)"Program: ");
    FUN_10034d60((uint *)&stack0xfffffec8,_Str);
    FUN_10034d60((uint *)&stack0xfffffec8,(uint *)&DAT_1003f218);
    FUN_10034d60((uint *)&stack0xfffffec8,local_12c);
    ___crtMessageBoxA(&stack0xfffffec8,"Microsoft Visual C++ Runtime Library",0x12010);
  }
  else {
    local_8 = (undefined *)0x0;
    (*DAT_10053008)();
    local_8 = (undefined *)0xffffffff;
  }
                    // WARNING: Subroutine does not return
  __exit(3);
}



// Library Function - Single Match
//  long __stdcall __CxxUnhandledExceptionFilter(struct _EXCEPTION_POINTERS *)
// 
// Library: Visual Studio 2003 Release

long __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *param_1)

{
  PEXCEPTION_RECORD pEVar1;
  int iVar2;
  
  pEVar1 = param_1->ExceptionRecord;
  if (((pEVar1->ExceptionCode == 0xe06d7363) && (pEVar1->NumberParameters == 3)) &&
     ((pEVar1->ExceptionInformation[0] == 0x19930520 ||
      (pEVar1->ExceptionInformation[0] == 0x19930521)))) {
    terminate();
  }
  if ((DAT_1005300c != (_func_int *)0x0) && (iVar2 = _ValidateExecute(DAT_1005300c), iVar2 != 0)) {
    iVar2 = (*DAT_1005300c)(param_1);
    return iVar2;
  }
  return 0;
}



// Library Function - Single Match
//  ___crtExitProcess
// 
// Library: Visual Studio 2003 Release

void __cdecl ___crtExitProcess(int param_1)

{
  HMODULE hModule;
  FARPROC pFVar1;
  
  hModule = GetModuleHandleA("mscoree.dll");
  if (hModule != (HMODULE)0x0) {
    pFVar1 = GetProcAddress(hModule,"CorExitProcess");
    if (pFVar1 != (FARPROC)0x0) {
      (*pFVar1)(param_1);
    }
  }
                    // WARNING: Subroutine does not return
  ExitProcess(param_1);
}



void FUN_10031368(void)

{
  __lock(8);
  return;
}



void FUN_10031371(void)

{
  FUN_1002f8d0(8);
  return;
}



// Library Function - Single Match
//  __initterm
// 
// Library: Visual Studio 2003 Release

void __cdecl __initterm(undefined4 *param_1)

{
  undefined4 *in_EAX;
  
  for (; in_EAX < param_1; in_EAX = in_EAX + 1) {
    if ((code *)*in_EAX != (code *)0x0) {
      (*(code *)*in_EAX)();
    }
  }
  return;
}



// Library Function - Single Match
//  __cinit
// 
// Library: Visual Studio 2003 Release

int __cdecl __cinit(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  
  if (PTR___fpmath_10041534 != (undefined *)0x0) {
    (*(code *)PTR___fpmath_10041534)(param_1);
  }
  iVar1 = 0;
  puVar2 = &DAT_1004100c;
  do {
    if (iVar1 != 0) {
      return iVar1;
    }
    if ((code *)*puVar2 != (code *)0x0) {
      iVar1 = (*(code *)*puVar2)();
    }
    puVar2 = puVar2 + 1;
  } while (puVar2 < &DAT_10041020);
  if (iVar1 == 0) {
    _atexit((_func_4879 *)&LAB_10031c1f);
    puVar2 = &DAT_10041000;
    do {
      if ((code *)*puVar2 != (code *)0x0) {
        (*(code *)*puVar2)();
      }
      puVar2 = puVar2 + 1;
    } while (puVar2 < &DAT_10041008);
    iVar1 = 0;
  }
  return iVar1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Removing unreachable block (ram,0x100314b0)
// Library Function - Single Match
//  _doexit
// 
// Library: Visual Studio 2003 Release

void __cdecl doexit(UINT param_1,int param_2,int param_3)

{
  HANDLE hProcess;
  UINT uExitCode;
  
  __lock(8);
  if (DAT_10053054 == 1) {
    uExitCode = param_1;
    hProcess = GetCurrentProcess();
    TerminateProcess(hProcess,uExitCode);
  }
  DAT_10053050 = 1;
  DAT_1005304c = (undefined1)param_3;
  if (param_2 == 0) {
    if (DAT_100536e8 != (undefined4 *)0x0) {
      while (DAT_100536e4 = DAT_100536e4 + -1, DAT_100536e8 <= DAT_100536e4) {
        if ((code *)*DAT_100536e4 != (code *)0x0) {
          (*(code *)*DAT_100536e4)();
        }
      }
    }
    __initterm((undefined4 *)&DAT_1004102c);
  }
  __initterm((undefined4 *)&DAT_10041038);
  FUN_100314ab();
  if (param_3 != 0) {
    return;
  }
  DAT_10053054 = 1;
  ___crtExitProcess(param_1);
  return;
}



void FUN_100314ab(void)

{
  int unaff_EBP;
  int unaff_EDI;
  
  if (*(int *)(unaff_EBP + 0x10) != unaff_EDI) {
    FUN_1002f8d0(8);
  }
  return;
}



// Library Function - Single Match
//  __exit
// 
// Library: Visual Studio 2003 Release

void __cdecl __exit(int _Code)

{
  doexit(_Code,1,0);
  return;
}



// Library Function - Single Match
//  __cexit
// 
// Library: Visual Studio 2003 Release

void __cdecl __cexit(void)

{
  doexit(0,0,1);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _calloc
// 
// Library: Visual Studio 2003 Release

void * __cdecl _calloc(size_t _Count,size_t _Size)

{
  int iVar1;
  uint *_Size_00;
  uint *dwBytes;
  int *_Dst;
  
  _Size_00 = (uint *)(_Count * _Size);
  dwBytes = _Size_00;
  if (_Size_00 == (uint *)0x0) {
    dwBytes = (uint *)0x1;
  }
  do {
    _Dst = (int *)0x0;
    if (dwBytes < (uint *)0xffffffe1) {
      if ((DAT_100535c0 == 3) &&
         (dwBytes = (uint *)((int)dwBytes + 0xfU & 0xfffffff0), _Size_00 <= DAT_100535ac)) {
        __lock(4);
        _Dst = ___sbh_alloc_block(_Size_00);
        FUN_10031589();
        if (_Dst != (int *)0x0) {
          _memset(_Dst,0,(size_t)_Size_00);
          goto LAB_10031554;
        }
      }
      else {
LAB_10031554:
        if (_Dst != (int *)0x0) {
          return _Dst;
        }
      }
      _Dst = (int *)HeapAlloc(DAT_100535bc,8,(SIZE_T)dwBytes);
    }
    if (_Dst != (int *)0x0) {
      return _Dst;
    }
    if (DAT_10053224 == 0) {
      return (void *)0x0;
    }
    iVar1 = __callnewh((size_t)dwBytes);
    if (iVar1 == 0) {
      return (void *)0x0;
    }
  } while( true );
}



void FUN_10031589(void)

{
  FUN_1002f8d0(4);
  return;
}



// Library Function - Single Match
//  __ioinit
// 
// Library: Visual Studio 2003 Release

int __cdecl __ioinit(void)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *puVar5;
  DWORD DVar6;
  HANDLE hFile;
  int iVar7;
  uint uVar8;
  UINT *pUVar9;
  UINT UVar10;
  UINT UVar11;
  byte *pbStack_48;
  _STARTUPINFOA local_44;
  
  puVar3 = (undefined4 *)_malloc(0x480);
  if (puVar3 == (undefined4 *)0x0) {
    iVar4 = -1;
  }
  else {
    DAT_100535c4 = 0x20;
    DAT_100535e0 = puVar3;
    for (; puVar3 < DAT_100535e0 + 0x120; puVar3 = puVar3 + 9) {
      *puVar3 = 0xffffffff;
      puVar3[2] = 0;
      *(undefined1 *)(puVar3 + 1) = 0;
      *(undefined1 *)((int)puVar3 + 5) = 10;
    }
    GetStartupInfoA(&local_44);
    if ((local_44.cbReserved2 != 0) && ((UINT *)local_44.lpReserved2 != (UINT *)0x0)) {
      UVar10 = *(UINT *)local_44.lpReserved2;
      pUVar9 = (UINT *)((int)local_44.lpReserved2 + 4);
      pbStack_48 = (byte *)(UVar10 + (int)pUVar9);
      if (0x7ff < (int)UVar10) {
        UVar10 = 0x800;
      }
      UVar11 = UVar10;
      if ((int)DAT_100535c4 < (int)UVar10) {
        puVar3 = &DAT_100535e4;
        do {
          puVar5 = (undefined4 *)_malloc(0x480);
          UVar11 = DAT_100535c4;
          if (puVar5 == (undefined4 *)0x0) break;
          DAT_100535c4 = DAT_100535c4 + 0x20;
          *puVar3 = puVar5;
          puVar2 = puVar5;
          for (; puVar5 < puVar2 + 0x120; puVar5 = puVar5 + 9) {
            *puVar5 = 0xffffffff;
            puVar5[2] = 0;
            *(undefined1 *)(puVar5 + 1) = 0;
            *(undefined1 *)((int)puVar5 + 5) = 10;
            puVar2 = (undefined4 *)*puVar3;
          }
          puVar3 = puVar3 + 1;
          UVar11 = UVar10;
        } while ((int)DAT_100535c4 < (int)UVar10);
      }
      uVar8 = 0;
      if (0 < (int)UVar11) {
        do {
          if (((*(HANDLE *)pbStack_48 != (HANDLE)0xffffffff) && ((*pUVar9 & 1) != 0)) &&
             (((*pUVar9 & 8) != 0 || (DVar6 = GetFileType(*(HANDLE *)pbStack_48), DVar6 != 0)))) {
            puVar3 = (undefined4 *)((int)(&DAT_100535e0)[(int)uVar8 >> 5] + (uVar8 & 0x1f) * 0x24);
            *puVar3 = *(undefined4 *)pbStack_48;
            *(byte *)(puVar3 + 1) = (byte)*pUVar9;
            iVar4 = ___crtInitCritSecAndSpinCount(puVar3 + 3,4000);
            if (iVar4 == 0) {
              return -1;
            }
            puVar3[2] = puVar3[2] + 1;
          }
          pbStack_48 = pbStack_48 + 4;
          uVar8 = uVar8 + 1;
          pUVar9 = (UINT *)((int)pUVar9 + 1);
        } while ((int)uVar8 < (int)UVar11);
      }
    }
    iVar4 = 0;
    do {
      piVar1 = DAT_100535e0 + iVar4 * 9;
      if (*piVar1 == -1) {
        *(undefined1 *)(piVar1 + 1) = 0x81;
        if (iVar4 == 0) {
          DVar6 = 0xfffffff6;
        }
        else {
          DVar6 = 0xfffffff5 - (iVar4 != 1);
        }
        hFile = GetStdHandle(DVar6);
        if ((hFile == (HANDLE)0xffffffff) || (DVar6 = GetFileType(hFile), DVar6 == 0)) {
          *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 0x40;
        }
        else {
          *piVar1 = (int)hFile;
          if ((DVar6 & 0xff) == 2) {
            *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 0x40;
          }
          else if ((DVar6 & 0xff) == 3) {
            *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 8;
          }
          iVar7 = ___crtInitCritSecAndSpinCount(piVar1 + 3,4000);
          if (iVar7 == 0) {
            return -1;
          }
          piVar1[2] = piVar1[2] + 1;
        }
      }
      else {
        *(byte *)(piVar1 + 1) = *(byte *)(piVar1 + 1) | 0x80;
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < 3);
    SetHandleCount(DAT_100535c4);
    iVar4 = 0;
  }
  return iVar4;
}



// Library Function - Single Match
//  __ioterm
// 
// Library: Visual Studio 2003 Release

void __cdecl __ioterm(void)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  
  puVar2 = &DAT_100535e0;
  do {
    uVar3 = *puVar2;
    uVar1 = uVar3;
    if (uVar3 != 0) {
      for (; uVar3 < uVar1 + 0x480; uVar3 = uVar3 + 0x24) {
        if (*(int *)(uVar3 + 8) != 0) {
          DeleteCriticalSection((LPCRITICAL_SECTION)(uVar3 + 0xc));
        }
        uVar1 = *puVar2;
      }
      _free((void *)*puVar2);
      *puVar2 = 0;
    }
    puVar2 = puVar2 + 1;
  } while ((int)puVar2 < 0x100536e0);
  return;
}



// Library Function - Single Match
//  __setenvp
// 
// Library: Visual Studio 2003 Release

int __cdecl __setenvp(void)

{
  undefined4 *puVar1;
  size_t sVar2;
  uint *puVar3;
  uint *puVar4;
  int iVar5;
  
  if (DAT_100536ec == 0) {
    ___initmbctable();
  }
  iVar5 = 0;
  puVar4 = DAT_10052e6c;
  if (DAT_10052e6c != (uint *)0x0) {
    for (; (char)*puVar4 != '\0'; puVar4 = (uint *)((int)puVar4 + sVar2 + 1)) {
      if ((char)*puVar4 != '=') {
        iVar5 = iVar5 + 1;
      }
      sVar2 = _strlen((char *)puVar4);
    }
    puVar1 = (undefined4 *)_malloc(iVar5 * 4 + 4);
    puVar4 = DAT_10052e6c;
    DAT_10053034 = puVar1;
    if (puVar1 != (undefined4 *)0x0) {
      do {
        if ((char)*puVar4 == '\0') {
          _free(DAT_10052e6c);
          DAT_10052e6c = (uint *)0x0;
          *puVar1 = 0;
          DAT_100536e0 = 1;
          return 0;
        }
        sVar2 = _strlen((char *)puVar4);
        if ((char)*puVar4 != '=') {
          puVar3 = (uint *)_malloc(sVar2 + 1);
          *puVar1 = puVar3;
          if (puVar3 == (uint *)0x0) {
            _free(DAT_10053034);
            DAT_10053034 = (undefined4 *)0x0;
            return -1;
          }
          FUN_10034d50(puVar3,puVar4);
          puVar1 = puVar1 + 1;
        }
        puVar4 = (uint *)((int)puVar4 + sVar2 + 1);
      } while( true );
    }
  }
  return -1;
}



// Library Function - Single Match
//  _parse_cmdline
// 
// Library: Visual Studio 2003 Release

void __cdecl parse_cmdline(undefined4 *param_1,int *param_2)

{
  bool bVar1;
  bool bVar2;
  byte *in_EAX;
  byte *pbVar3;
  byte *pbVar4;
  byte bVar5;
  byte *in_ECX;
  uint uVar6;
  int *unaff_ESI;
  
  bVar1 = false;
  *unaff_ESI = 0;
  *param_2 = 1;
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = in_ECX;
    param_1 = param_1 + 1;
  }
  do {
    if (*in_EAX == 0x22) {
      bVar1 = !bVar1;
      pbVar3 = in_EAX + 1;
      bVar5 = 0x22;
    }
    else {
      *unaff_ESI = *unaff_ESI + 1;
      if (in_ECX != (byte *)0x0) {
        *in_ECX = *in_EAX;
        in_ECX = in_ECX + 1;
      }
      bVar5 = *in_EAX;
      pbVar3 = in_EAX + 1;
      if (((&DAT_10053381)[bVar5] & 4) != 0) {
        *unaff_ESI = *unaff_ESI + 1;
        if (in_ECX != (byte *)0x0) {
          *in_ECX = *pbVar3;
          in_ECX = in_ECX + 1;
        }
        pbVar3 = in_EAX + 2;
      }
      if (bVar5 == 0) {
        pbVar3 = pbVar3 + -1;
        goto LAB_10031924;
      }
    }
    in_EAX = pbVar3;
  } while ((bVar1) || ((bVar5 != 0x20 && (bVar5 != 9))));
  if (in_ECX != (byte *)0x0) {
    in_ECX[-1] = 0;
  }
LAB_10031924:
  bVar1 = false;
  while (*pbVar3 != 0) {
    for (; (*pbVar3 == 0x20 || (*pbVar3 == 9)); pbVar3 = pbVar3 + 1) {
    }
    if (*pbVar3 == 0) break;
    if (param_1 != (undefined4 *)0x0) {
      *param_1 = in_ECX;
      param_1 = param_1 + 1;
    }
    *param_2 = *param_2 + 1;
    while( true ) {
      bVar2 = true;
      uVar6 = 0;
      for (; *pbVar3 == 0x5c; pbVar3 = pbVar3 + 1) {
        uVar6 = uVar6 + 1;
      }
      if (*pbVar3 == 0x22) {
        pbVar4 = pbVar3;
        if ((uVar6 & 1) == 0) {
          if ((!bVar1) || (pbVar4 = pbVar3 + 1, *pbVar4 != 0x22)) {
            bVar2 = false;
            pbVar4 = pbVar3;
          }
          bVar1 = !bVar1;
        }
        uVar6 = uVar6 >> 1;
        pbVar3 = pbVar4;
      }
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if (in_ECX != (byte *)0x0) {
          *in_ECX = 0x5c;
          in_ECX = in_ECX + 1;
        }
        *unaff_ESI = *unaff_ESI + 1;
      }
      bVar5 = *pbVar3;
      if ((bVar5 == 0) || ((!bVar1 && ((bVar5 == 0x20 || (bVar5 == 9)))))) break;
      if (bVar2) {
        if (in_ECX == (byte *)0x0) {
          if (((&DAT_10053381)[bVar5] & 4) != 0) {
            pbVar3 = pbVar3 + 1;
            *unaff_ESI = *unaff_ESI + 1;
          }
        }
        else {
          if (((&DAT_10053381)[bVar5] & 4) != 0) {
            *in_ECX = bVar5;
            in_ECX = in_ECX + 1;
            pbVar3 = pbVar3 + 1;
            *unaff_ESI = *unaff_ESI + 1;
          }
          *in_ECX = *pbVar3;
          in_ECX = in_ECX + 1;
        }
        *unaff_ESI = *unaff_ESI + 1;
      }
      pbVar3 = pbVar3 + 1;
    }
    if (in_ECX != (byte *)0x0) {
      *in_ECX = 0;
      in_ECX = in_ECX + 1;
    }
    *unaff_ESI = *unaff_ESI + 1;
  }
  if (param_1 != (undefined4 *)0x0) {
    *param_1 = 0;
  }
  *param_2 = *param_2 + 1;
  return;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __setargv
// 
// Library: Visual Studio 2003 Release

int __cdecl __setargv(void)

{
  undefined4 *puVar1;
  int iVar2;
  int in_ECX;
  int local_8;
  
  local_8 = in_ECX;
  if (DAT_100536ec == 0) {
    ___initmbctable();
  }
  DAT_1005315c = 0;
  GetModuleFileNameA((HMODULE)0x0,&DAT_10053058,0x104);
  _DAT_10053044 = &DAT_10053058;
  parse_cmdline((undefined4 *)0x0,&local_8);
  puVar1 = (undefined4 *)_malloc(in_ECX + local_8 * 4);
  if (puVar1 == (undefined4 *)0x0) {
    iVar2 = -1;
  }
  else {
    parse_cmdline(puVar1,&local_8);
    _DAT_10053028 = local_8 + -1;
    iVar2 = 0;
    _DAT_1005302c = puVar1;
  }
  return iVar2;
}



// Library Function - Single Match
//  ___crtGetEnvironmentStringsA
// 
// Library: Visual Studio 2003 Release

LPVOID __cdecl ___crtGetEnvironmentStringsA(void)

{
  char cVar1;
  WCHAR WVar2;
  DWORD DVar3;
  WCHAR *pWVar4;
  int iVar6;
  size_t _Size;
  LPSTR lpMultiByteStr;
  LPCH _Src;
  char *pcVar7;
  void *_Dst;
  LPWCH lpWideCharStr;
  LPSTR local_8;
  WCHAR *pWVar5;
  char *pcVar8;
  
  lpWideCharStr = (LPWCH)0x0;
  if (DAT_10053160 == 0) {
    lpWideCharStr = GetEnvironmentStringsW();
    if (lpWideCharStr != (LPWCH)0x0) {
      DAT_10053160 = 1;
      goto LAB_10031b07;
    }
    DVar3 = GetLastError();
    if (DVar3 == 0x78) {
      DAT_10053160 = 2;
    }
  }
  if (DAT_10053160 != 1) {
    if ((DAT_10053160 != 2) && (DAT_10053160 != 0)) {
      return (LPVOID)0x0;
    }
    _Src = GetEnvironmentStrings();
    if (_Src == (LPCH)0x0) {
      return (LPVOID)0x0;
    }
    cVar1 = *_Src;
    pcVar7 = _Src;
    while (cVar1 != '\0') {
      do {
        pcVar8 = pcVar7;
        pcVar7 = pcVar8 + 1;
      } while (*pcVar7 != '\0');
      pcVar7 = pcVar8 + 2;
      cVar1 = *pcVar7;
    }
    _Dst = _malloc((size_t)(pcVar7 + (1 - (int)_Src)));
    if (_Dst == (void *)0x0) {
      _Dst = (void *)0x0;
    }
    else {
      _memcpy(_Dst,_Src,(size_t)(pcVar7 + (1 - (int)_Src)));
    }
    FreeEnvironmentStringsA(_Src);
    return _Dst;
  }
LAB_10031b07:
  if ((lpWideCharStr == (LPWCH)0x0) &&
     (lpWideCharStr = GetEnvironmentStringsW(), lpWideCharStr == (LPWCH)0x0)) {
    return (LPVOID)0x0;
  }
  WVar2 = *lpWideCharStr;
  pWVar4 = lpWideCharStr;
  while (WVar2 != L'\0') {
    do {
      pWVar5 = pWVar4;
      pWVar4 = pWVar5 + 1;
    } while (*pWVar4 != L'\0');
    pWVar4 = pWVar5 + 2;
    WVar2 = *pWVar4;
  }
  iVar6 = ((int)pWVar4 - (int)lpWideCharStr >> 1) + 1;
  _Size = WideCharToMultiByte(0,0,lpWideCharStr,iVar6,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
  local_8 = (LPSTR)0x0;
  if (((_Size != 0) && (lpMultiByteStr = (LPSTR)_malloc(_Size), lpMultiByteStr != (LPSTR)0x0)) &&
     (iVar6 = WideCharToMultiByte(0,0,lpWideCharStr,iVar6,lpMultiByteStr,_Size,(LPCSTR)0x0,
                                  (LPBOOL)0x0), local_8 = lpMultiByteStr, iVar6 == 0)) {
    _free(lpMultiByteStr);
    local_8 = (LPSTR)0x0;
  }
  FreeEnvironmentStringsW(lpWideCharStr);
  return local_8;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __RTC_Initialize
// 
// Library: Visual Studio 2003 Release

void __RTC_Initialize(void)

{
  undefined4 *local_20;
  
  for (local_20 = &DAT_10040318; local_20 < &DAT_10040318; local_20 = local_20 + 1) {
    if ((code *)*local_20 != (code *)0x0) {
      (*(code *)*local_20)();
    }
  }
  return;
}



// Library Function - Single Match
//  ___heap_select
// 
// Library: Visual Studio 2003 Release

undefined4 ___heap_select(void)

{
  if ((DAT_10053014 == 2) && (4 < DAT_10053020)) {
    return 1;
  }
  return 3;
}



// Library Function - Single Match
//  __heap_init
// 
// Library: Visual Studio 2003 Release

int __cdecl __heap_init(void)

{
  int iVar1;
  int in_stack_00000004;
  
  DAT_100535bc = HeapCreate((uint)(in_stack_00000004 == 0),0x1000,0);
  if (DAT_100535bc == (HANDLE)0x0) {
    return 0;
  }
  DAT_100535c0 = ___heap_select();
  if ((DAT_100535c0 == 3) && (iVar1 = ___sbh_heap_init(0x3f8), iVar1 == 0)) {
    HeapDestroy(DAT_100535bc);
    return 0;
  }
  return 1;
}



// Library Function - Single Match
//  __heap_term
// 
// Library: Visual Studio 2003 Release

void __cdecl __heap_term(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  if (DAT_100535c0 == 3) {
    iVar1 = 0;
    if (0 < DAT_100535a4) {
      puVar2 = (undefined4 *)((int)DAT_100535a8 + 0xc);
      do {
        VirtualFree((LPVOID)*puVar2,0x100000,0x4000);
        VirtualFree((LPVOID)*puVar2,0,0x8000);
        HeapFree(DAT_100535bc,0,(LPVOID)puVar2[1]);
        puVar2 = puVar2 + 5;
        iVar1 = iVar1 + 1;
      } while (iVar1 < DAT_100535a4);
    }
    HeapFree(DAT_100535bc,0,DAT_100535a8);
  }
  HeapDestroy(DAT_100535bc);
  return;
}



// Library Function - Single Match
//  __XcptFilter
// 
// Library: Visual Studio 2003 Release

int __cdecl __XcptFilter(ulong _ExceptionNum,_EXCEPTION_POINTERS *_ExceptionPtr)

{
  ulong *puVar1;
  code *pcVar2;
  void *pvVar3;
  ulong uVar4;
  void *pvVar5;
  _ptiddata p_Var6;
  int iVar7;
  int iVar8;
  ulong *puVar9;
  
  p_Var6 = __getptd();
  puVar1 = (ulong *)p_Var6->_initaddr;
  puVar9 = puVar1;
  do {
    if (*puVar9 == _ExceptionNum) break;
    puVar9 = puVar9 + 3;
  } while (puVar9 < puVar1 + DAT_100419fc * 3);
  if ((puVar1 + DAT_100419fc * 3 <= puVar9) || (*puVar9 != _ExceptionNum)) {
    puVar9 = (ulong *)0x0;
  }
  if ((puVar9 == (ulong *)0x0) || (pcVar2 = (code *)puVar9[2], pcVar2 == (code *)0x0)) {
    iVar7 = UnhandledExceptionFilter(_ExceptionPtr);
  }
  else if (pcVar2 == (code *)0x5) {
    puVar9[2] = 0;
    iVar7 = 1;
  }
  else {
    if (pcVar2 != (code *)0x1) {
      pvVar3 = p_Var6->_initarg;
      p_Var6->_initarg = _ExceptionPtr;
      if (puVar9[1] == 8) {
        if (DAT_100419f0 < DAT_100419f4 + DAT_100419f0) {
          iVar8 = DAT_100419f0 * 0xc;
          iVar7 = DAT_100419f0;
          do {
            *(undefined4 *)(iVar8 + 8 + (int)p_Var6->_initaddr) = 0;
            iVar7 = iVar7 + 1;
            iVar8 = iVar8 + 0xc;
          } while (iVar7 < DAT_100419f4 + DAT_100419f0);
        }
        uVar4 = *puVar9;
        pvVar5 = p_Var6->_pxcptacttab;
        if (uVar4 == 0xc000008e) {
          p_Var6->_pxcptacttab = (void *)0x83;
        }
        else if (uVar4 == 0xc0000090) {
          p_Var6->_pxcptacttab = (void *)0x81;
        }
        else if (uVar4 == 0xc0000091) {
          p_Var6->_pxcptacttab = (void *)0x84;
        }
        else if (uVar4 == 0xc0000093) {
          p_Var6->_pxcptacttab = (void *)0x85;
        }
        else if (uVar4 == 0xc000008d) {
          p_Var6->_pxcptacttab = (void *)0x82;
        }
        else if (uVar4 == 0xc000008f) {
          p_Var6->_pxcptacttab = (void *)0x86;
        }
        else if (uVar4 == 0xc0000092) {
          p_Var6->_pxcptacttab = (void *)0x8a;
        }
        (*pcVar2)(8,p_Var6->_pxcptacttab);
        p_Var6->_pxcptacttab = pvVar5;
      }
      else {
        puVar9[2] = 0;
        (*pcVar2)(puVar9[1]);
      }
      p_Var6->_initarg = pvVar3;
    }
    iVar7 = -1;
  }
  return iVar7;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  __NMSG_WRITE
// 
// Library: Visual Studio 2003 Release

void __cdecl __NMSG_WRITE(int param_1)

{
  int iVar1;
  uint uVar2;
  DWORD DVar3;
  size_t sVar4;
  size_t sVar5;
  HANDLE hFile;
  int iVar6;
  uint *_Str;
  undefined1 auStackY_14c [4];
  UINT aUStackY_148 [3];
  undefined4 auStackY_13c [2];
  undefined4 uStackY_134;
  LPCVOID lpBuffer;
  LPDWORD lpNumberOfBytesWritten;
  LPOVERLAPPED lpOverlapped;
  uint local_110 [65];
  undefined1 local_c;
  int local_8;
  
  local_8 = DAT_10041558;
  uVar2 = 0;
  do {
    if (param_1 == (&DAT_10041a00)[uVar2 * 2]) break;
    uVar2 = uVar2 + 1;
  } while (uVar2 < 0x13);
  iVar6 = uVar2 * 8;
  if (param_1 == (&DAT_10041a00)[uVar2 * 2]) {
    if ((DAT_10052e74 == 1) || ((DAT_10052e74 == 0 && (DAT_10052e78 == 1)))) {
      lpOverlapped = (LPOVERLAPPED)0x0;
      lpNumberOfBytesWritten = (LPDWORD)&param_1;
      sVar4 = _strlen(*(char **)(iVar6 + 0x10041a04));
      lpBuffer = *(LPCVOID *)(iVar6 + 0x10041a04);
      uStackY_134 = 0x10032020;
      hFile = GetStdHandle(0xfffffff4);
      uStackY_134 = 0x10032027;
      WriteFile(hFile,lpBuffer,sVar4,lpNumberOfBytesWritten,lpOverlapped);
    }
    else if (param_1 != 0xfc) {
      local_c = 0;
      DVar3 = GetModuleFileNameA((HMODULE)0x0,(LPSTR)local_110,0x104);
      if (DVar3 == 0) {
        FUN_10034d50(local_110,(uint *)"<program name unknown>");
      }
      _Str = local_110;
      sVar4 = _strlen((char *)_Str);
      if (0x3c < sVar4 + 1) {
        sVar4 = _strlen((char *)_Str);
        _Str = (uint *)(auStackY_14c + sVar4 + 1);
        _strncpy((char *)_Str,"...",3);
      }
      sVar4 = _strlen((char *)_Str);
      sVar5 = _strlen(*(char **)(iVar6 + 0x10041a04));
      iVar1 = -(sVar4 + sVar5 + 0x1f & 0xfffffffc);
      *(char **)((int)local_110 + iVar1 + -0x10) = "Runtime Error!\n\nProgram: ";
      *(int *)((int)local_110 + iVar1 + -0x14) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)local_110 + iVar1 + -0x18) = 0x10031fcc;
      FUN_10034d50(*(uint **)((int)local_110 + iVar1 + -0x14),
                   *(uint **)((int)local_110 + iVar1 + -0x10));
      *(uint **)((int)local_110 + iVar1 + -0x18) = _Str;
      *(int *)((int)local_110 + iVar1 + -0x1c) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)local_110 + iVar1 + -0x20) = 0x10031fd3;
      FUN_10034d60(*(uint **)((int)local_110 + iVar1 + -0x1c),
                   *(uint **)((int)local_110 + iVar1 + -0x18));
      *(undefined **)((int)local_110 + iVar1 + -0x20) = &DAT_1003f218;
      *(int *)((int)&uStackY_134 + iVar1) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)auStackY_13c + iVar1 + 4) = 0x10031fde;
      FUN_10034d60(*(uint **)((int)&uStackY_134 + iVar1),*(uint **)((int)local_110 + iVar1 + -0x20))
      ;
      *(undefined4 *)((int)auStackY_13c + iVar1 + 4) = *(undefined4 *)(iVar6 + 0x10041a04);
      *(int *)((int)auStackY_13c + iVar1) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)((int)aUStackY_148 + iVar1 + 8) = 0x10031fea;
      FUN_10034d60(*(uint **)((int)auStackY_13c + iVar1),*(uint **)((int)auStackY_13c + iVar1 + 4));
      *(undefined4 *)((int)aUStackY_148 + iVar1 + 8) = 0x12010;
      *(char **)((int)aUStackY_148 + iVar1 + 4) = "Microsoft Visual C++ Runtime Library";
      *(int *)((int)aUStackY_148 + iVar1) = (int)local_110 + iVar1 + -0xc;
      *(undefined4 *)(auStackY_14c + iVar1) = 0x10031ffa;
      ___crtMessageBoxA(*(LPCSTR *)((int)aUStackY_148 + iVar1),
                        *(LPCSTR *)((int)aUStackY_148 + iVar1 + 4),
                        *(UINT *)((int)aUStackY_148 + iVar1 + 8));
    }
  }
  FUN_1002d447(local_8);
  return;
}



// Library Function - Single Match
//  __FF_MSGBANNER
// 
// Library: Visual Studio 2003 Release

void __cdecl __FF_MSGBANNER(void)

{
  if ((DAT_10052e74 == 1) || ((DAT_10052e74 == 0 && (DAT_10052e78 == 1)))) {
    __NMSG_WRITE(0xfc);
    if (DAT_10053164 != (code *)0x0) {
      (*DAT_10053164)();
    }
    __NMSG_WRITE(0xff);
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __tzset_lk
// 
// Library: Visual Studio 2003 Release

void __tzset_lk(void)

{
  char cVar1;
  char cVar2;
  UINT CodePage;
  uint *_Str1;
  int iVar3;
  size_t sVar4;
  long lVar5;
  DWORD DVar6;
  uint *_Str;
  int local_20 [3];
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_1003f838;
  uStack_c = 0x10032088;
  __lock(7);
  CodePage = DAT_100532c4;
  local_8 = (undefined *)0x0;
  DAT_10053214 = 0;
  DAT_10041b3c = 0xffffffff;
  DAT_10041b30 = 0xffffffff;
  _Str1 = (uint *)__getenv_lk("TZ");
  if ((_Str1 == (uint *)0x0) || ((char)*_Str1 == '\0')) {
    if (DAT_10053218 != (uint *)0x0) {
      _free(DAT_10053218);
      DAT_10053218 = (uint *)0x0;
    }
    DVar6 = GetTimeZoneInformation((LPTIME_ZONE_INFORMATION)&DAT_10053168);
    if (DVar6 != 0xffffffff) {
      DAT_10053214 = 1;
      _DAT_10041a98 = DAT_10053168 * 0x3c;
      if (DAT_100531ae != 0) {
        _DAT_10041a98 = _DAT_10041a98 + DAT_100531bc * 0x3c;
      }
      if ((DAT_10053202 == 0) || (DAT_10053210 == 0)) {
        DAT_10041a9c = 0;
        DAT_10041aa0 = 0;
      }
      else {
        DAT_10041a9c = 1;
        DAT_10041aa0 = (DAT_10053210 - DAT_100531bc) * 0x3c;
      }
      iVar3 = WideCharToMultiByte(CodePage,0,(LPCWSTR)&DAT_1005316c,-1,PTR_DAT_10041b28,0x3f,
                                  (LPCSTR)0x0,local_20);
      if ((iVar3 == 0) || (local_20[0] != 0)) {
        *PTR_DAT_10041b28 = 0;
      }
      else {
        PTR_DAT_10041b28[0x3f] = 0;
      }
      iVar3 = WideCharToMultiByte(CodePage,0,(LPCWSTR)&DAT_100531c0,-1,PTR_DAT_10041b2c,0x3f,
                                  (LPCSTR)0x0,local_20);
      if ((iVar3 == 0) || (local_20[0] != 0)) {
        *PTR_DAT_10041b2c = 0;
      }
      else {
        PTR_DAT_10041b2c[0x3f] = 0;
      }
    }
  }
  else {
    if (DAT_10053218 != (uint *)0x0) {
      iVar3 = _strcmp((char *)_Str1,(char *)DAT_10053218);
      if (iVar3 == 0) goto LAB_10032280;
      if (DAT_10053218 != (uint *)0x0) {
        _free(DAT_10053218);
      }
    }
    sVar4 = _strlen((char *)_Str1);
    DAT_10053218 = (uint *)_malloc(sVar4 + 1);
    if (DAT_10053218 != (uint *)0x0) {
      FUN_10034d50(DAT_10053218,_Str1);
      local_8 = (undefined *)0xffffffff;
      FUN_10032297();
      _strncpy(PTR_DAT_10041b28,(char *)_Str1,3);
      PTR_DAT_10041b28[3] = 0;
      _Str = (uint *)((int)_Str1 + 3);
      cVar2 = *(char *)_Str;
      if (cVar2 == '-') {
        _Str = _Str1 + 1;
      }
      lVar5 = _atol((char *)_Str);
      _DAT_10041a98 = lVar5 * 0xe10;
      for (; (cVar1 = (char)*_Str, cVar1 == '+' || (('/' < cVar1 && (cVar1 < ':'))));
          _Str = (uint *)((int)_Str + 1)) {
      }
      if ((char)*_Str == ':') {
        _Str = (uint *)((int)_Str + 1);
        lVar5 = _atol((char *)_Str);
        _DAT_10041a98 = _DAT_10041a98 + lVar5 * 0x3c;
        for (; ('/' < (char)*_Str && ((char)*_Str < ':')); _Str = (uint *)((int)_Str + 1)) {
        }
        if ((char)*_Str == ':') {
          _Str = (uint *)((int)_Str + 1);
          lVar5 = _atol((char *)_Str);
          _DAT_10041a98 = _DAT_10041a98 + lVar5;
          for (; ('/' < (char)*_Str && ((char)*_Str < ':')); _Str = (uint *)((int)_Str + 1)) {
          }
        }
      }
      if (cVar2 == '-') {
        _DAT_10041a98 = -_DAT_10041a98;
      }
      DAT_10041a9c = (int)(char)*_Str;
      if (DAT_10041a9c != 0) {
        _strncpy(PTR_DAT_10041b2c,(char *)_Str,3);
        PTR_DAT_10041b2c[3] = 0;
        return;
      }
      *PTR_DAT_10041b2c = 0;
      return;
    }
  }
LAB_10032280:
  __local_unwind2((int)local_14,-1);
  return;
}



void FUN_10032297(void)

{
  FUN_1002f8d0(7);
  return;
}



// Library Function - Single Match
//  _cvtdate
// 
// Library: Visual Studio 2003 Release

int __cdecl
cvtdate(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int param_7,
       int param_8,int param_9)

{
  int in_EAX;
  int iVar1;
  int in_ECX;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar2 = param_3 % 4;
  if (param_2 == 1) {
    if (((iVar2 == 0) && (param_3 % 100 != 0)) || ((param_3 + 0x76c) % 400 == 0)) {
      iVar4 = (&DAT_10041b44)[in_EAX];
    }
    else {
      iVar4 = *(int *)(&DAT_10041b78 + in_EAX * 4);
    }
    iVar5 = iVar4 + 1;
    iVar3 = (param_3 * 0x16d + -0x63db +
            (param_3 + -1) / 4 + iVar5 + ((param_3 + 299) / 400 - (param_3 + -1) / 100)) % 7;
    iVar1 = (param_4 * 7 - iVar3) + param_5;
    if (iVar3 <= param_5) {
      iVar5 = iVar4 + -6;
    }
    iVar5 = iVar5 + iVar1;
    if (param_4 == 5) {
      if (((iVar2 == 0) && (param_3 % 100 != 0)) || ((param_3 + 0x76c) % 400 == 0)) {
        iVar1 = *(int *)(&DAT_10041b48 + in_EAX * 4);
      }
      else {
        iVar1 = (&DAT_10041b7c)[in_EAX];
      }
      if (iVar1 < iVar5) {
        iVar5 = iVar5 + -7;
      }
    }
  }
  else {
    if (((iVar2 == 0) && (iVar1 = param_3 / 100, param_3 % 100 != 0)) ||
       (iVar1 = (param_3 + 0x76c) / 400, (param_3 + 0x76c) % 400 == 0)) {
      iVar5 = (&DAT_10041b44)[in_EAX];
    }
    else {
      iVar5 = *(int *)(&DAT_10041b78 + in_EAX * 4);
    }
    iVar5 = iVar5 + param_6;
  }
  iVar2 = (in_ECX * 0x3c + param_7) * 0x3c;
  if (param_1 == 1) {
    DAT_10041b38 = (iVar2 + param_8) * 1000 + param_9;
    DAT_10041b30 = param_3;
    DAT_10041b34 = iVar5;
  }
  else {
    DAT_10041b44 = (iVar2 + DAT_10041aa0 + param_8) * 1000 + param_9;
    if (DAT_10041b44 < 0) {
      DAT_10041b44 = DAT_10041b44 + 86400000;
      DAT_10041b40 = iVar5 + -1;
    }
    else {
      iVar1 = 86400000;
      DAT_10041b40 = iVar5;
      if (86399999 < DAT_10041b44) {
        DAT_10041b44 = DAT_10041b44 + -86400000;
        DAT_10041b40 = iVar5 + 1;
      }
    }
    DAT_10041b3c = param_3;
  }
  return iVar1;
}



// Library Function - Single Match
//  __isindst_lk
// 
// Library: Visual Studio 2003 Release

bool __isindst_lk(void)

{
  int iVar1;
  bool bVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  int *unaff_EBX;
  uint uVar6;
  
  if (DAT_10041a9c == 0) {
    return false;
  }
  iVar1 = unaff_EBX[5];
  if ((iVar1 != DAT_10041b30) || (iVar1 != DAT_10041b3c)) {
    if (DAT_10053214 == 0) {
      cvtdate(1,1,iVar1,1,0,0,0,0,0);
      cvtdate(0,1,iVar1,5,0,0,0,0,0);
    }
    else {
      if (DAT_10053200 != 0) {
        uVar6 = (uint)DAT_10053206;
        uVar3 = 0;
        uVar4 = 0;
      }
      else {
        uVar3 = (uint)DAT_10053204;
        uVar6 = 0;
        uVar4 = (uint)DAT_10053206;
      }
      cvtdate(1,(uint)(DAT_10053200 == 0),iVar1,uVar4,uVar3,uVar6,(uint)DAT_1005320a,
              (uint)DAT_1005320c,(uint)DAT_1005320e);
      if (DAT_100531ac != 0) {
        uVar6 = (uint)DAT_100531b2;
        uVar3 = 0;
        uVar4 = 0;
      }
      else {
        uVar3 = (uint)DAT_100531b0;
        uVar6 = 0;
        uVar4 = (uint)DAT_100531b2;
      }
      cvtdate(0,(uint)(DAT_100531ac == 0),iVar1,uVar4,uVar3,uVar6,(uint)DAT_100531b6,
              (uint)DAT_100531b8,(uint)DAT_100531ba);
    }
  }
  iVar1 = unaff_EBX[7];
  if (DAT_10041b34 < DAT_10041b40) {
    if ((iVar1 < DAT_10041b34) || (DAT_10041b40 < iVar1)) {
      return false;
    }
    if ((DAT_10041b34 < iVar1) && (iVar1 < DAT_10041b40)) {
      return true;
    }
  }
  else {
    if (iVar1 < DAT_10041b40) {
      return true;
    }
    if (DAT_10041b34 < iVar1) {
      return true;
    }
    if ((DAT_10041b40 < iVar1) && (iVar1 < DAT_10041b34)) {
      return false;
    }
  }
  iVar5 = ((unaff_EBX[2] * 0x3c + unaff_EBX[1]) * 0x3c + *unaff_EBX) * 1000;
  if (iVar1 == DAT_10041b34) {
    bVar2 = DAT_10041b38 <= iVar5;
  }
  else {
    bVar2 = iVar5 < DAT_10041b44;
  }
  return bVar2;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___tzset
// 
// Library: Visual Studio 2003 Release

void __cdecl ___tzset(void)

{
  if (DAT_1005321c == 0) {
    __lock(6);
    if (DAT_1005321c == 0) {
      __tzset_lk();
      DAT_1005321c = DAT_1005321c + 1;
    }
    FUN_100326a6();
  }
  return;
}



void FUN_100326a6(void)

{
  FUN_1002f8d0(6);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __isindst
// 
// Library: Visual Studio 2003 Release

int __cdecl __isindst(tm *_Time)

{
  bool bVar1;
  undefined3 extraout_var;
  
  __lock(6);
  bVar1 = __isindst_lk();
  FUN_100326e4();
  return CONCAT31(extraout_var,bVar1);
}



void FUN_100326e4(void)

{
  FUN_1002f8d0(6);
  return;
}



// Library Function - Single Match
//  ___sbh_heap_init
// 
// Library: Visual Studio 2003 Release

undefined4 ___sbh_heap_init(undefined4 param_1)

{
  DAT_100535a8 = HeapAlloc(DAT_100535bc,0,0x140);
  if (DAT_100535a8 == (LPVOID)0x0) {
    return 0;
  }
  DAT_100535a0 = 0;
  DAT_100535a4 = 0;
  DAT_100535b0 = DAT_100535a8;
  DAT_100535ac = param_1;
  DAT_100535b4 = 0x10;
  return 1;
}



// Library Function - Single Match
//  ___sbh_find_block
// 
// Library: Visual Studio 2003 Release

uint __cdecl ___sbh_find_block(int param_1)

{
  uint uVar1;
  
  uVar1 = DAT_100535a8;
  while( true ) {
    if (DAT_100535a8 + DAT_100535a4 * 0x14 <= uVar1) {
      return 0;
    }
    if ((uint)(param_1 - *(int *)(uVar1 + 0xc)) < 0x100000) break;
    uVar1 = uVar1 + 0x14;
  }
  return uVar1;
}



// Library Function - Single Match
//  ___sbh_free_block
// 
// Library: Visual Studio 2003 Release

void __cdecl ___sbh_free_block(uint *param_1,int param_2)

{
  int *piVar1;
  char *pcVar2;
  uint *puVar3;
  int *piVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  byte bVar8;
  uint uVar9;
  uint *puVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  uint uVar14;
  uint local_8;
  
  uVar6 = param_1[4];
  puVar12 = (uint *)(param_2 + -4);
  uVar14 = param_2 - param_1[3] >> 0xf;
  piVar4 = (int *)(uVar14 * 0x204 + 0x144 + uVar6);
  local_8 = *puVar12 - 1;
  if ((local_8 & 1) == 0) {
    puVar10 = (uint *)(local_8 + (int)puVar12);
    uVar13 = *puVar10;
    uVar7 = *(uint *)(param_2 + -8);
    if ((uVar13 & 1) == 0) {
      uVar9 = ((int)uVar13 >> 4) - 1;
      if (0x3f < uVar9) {
        uVar9 = 0x3f;
      }
      if (puVar10[1] == puVar10[2]) {
        if (uVar9 < 0x20) {
          pcVar2 = (char *)(uVar9 + 4 + uVar6);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 & 0x1f));
          puVar11 = (uint *)(uVar6 + 0x44 + uVar14 * 4);
          *puVar11 = *puVar11 & uVar9;
          *pcVar2 = *pcVar2 + -1;
          if (*pcVar2 == '\0') {
            *param_1 = *param_1 & uVar9;
          }
        }
        else {
          pcVar2 = (char *)(uVar9 + 4 + uVar6);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 - 0x20 & 0x1f));
          puVar11 = (uint *)(uVar6 + 0xc4 + uVar14 * 4);
          *puVar11 = *puVar11 & uVar9;
          *pcVar2 = *pcVar2 + -1;
          if (*pcVar2 == '\0') {
            param_1[1] = param_1[1] & uVar9;
          }
        }
      }
      local_8 = local_8 + uVar13;
      *(uint *)(puVar10[2] + 4) = puVar10[1];
      *(uint *)(puVar10[1] + 8) = puVar10[2];
    }
    puVar10 = (uint *)(((int)local_8 >> 4) - 1);
    if ((uint *)0x3f < puVar10) {
      puVar10 = (uint *)0x3f;
    }
    puVar11 = param_1;
    if ((uVar7 & 1) == 0) {
      puVar12 = (uint *)((int)puVar12 - uVar7);
      puVar11 = (uint *)(((int)uVar7 >> 4) - 1);
      if ((uint *)0x3f < puVar11) {
        puVar11 = (uint *)0x3f;
      }
      local_8 = local_8 + uVar7;
      puVar10 = (uint *)(((int)local_8 >> 4) - 1);
      if ((uint *)0x3f < puVar10) {
        puVar10 = (uint *)0x3f;
      }
      if (puVar11 != puVar10) {
        if (puVar12[1] == puVar12[2]) {
          if (puVar11 < (uint *)0x20) {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 & 0x1f));
            puVar3 = (uint *)(uVar6 + 0x44 + uVar14 * 4);
            *puVar3 = *puVar3 & uVar13;
            pcVar2 = (char *)((int)puVar11 + uVar6 + 4);
            *pcVar2 = *pcVar2 + -1;
            if (*pcVar2 == '\0') {
              *param_1 = *param_1 & uVar13;
            }
          }
          else {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 - 0x20 & 0x1f));
            puVar3 = (uint *)(uVar6 + 0xc4 + uVar14 * 4);
            *puVar3 = *puVar3 & uVar13;
            pcVar2 = (char *)((int)puVar11 + uVar6 + 4);
            *pcVar2 = *pcVar2 + -1;
            if (*pcVar2 == '\0') {
              param_1[1] = param_1[1] & uVar13;
            }
          }
        }
        *(uint *)(puVar12[2] + 4) = puVar12[1];
        *(uint *)(puVar12[1] + 8) = puVar12[2];
      }
    }
    if (((uVar7 & 1) != 0) || (puVar11 != puVar10)) {
      piVar1 = piVar4 + (int)puVar10 * 2;
      uVar13 = piVar1[1];
      puVar12[2] = (uint)piVar1;
      puVar12[1] = uVar13;
      piVar1[1] = (int)puVar12;
      *(uint **)(puVar12[1] + 8) = puVar12;
      if (puVar12[1] == puVar12[2]) {
        cVar5 = *(char *)((int)puVar10 + uVar6 + 4);
        *(char *)((int)puVar10 + uVar6 + 4) = cVar5 + '\x01';
        bVar8 = (byte)puVar10;
        if (puVar10 < (uint *)0x20) {
          if (cVar5 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
          }
          puVar10 = (uint *)(uVar6 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 & 0x1f);
        }
        else {
          if (cVar5 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
          }
          puVar10 = (uint *)(uVar6 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
        }
      }
    }
    *puVar12 = local_8;
    *(uint *)((local_8 - 4) + (int)puVar12) = local_8;
    *piVar4 = *piVar4 + -1;
    if (*piVar4 == 0) {
      if (DAT_100535a0 != (uint *)0x0) {
        VirtualFree((LPVOID)(DAT_100535b8 * 0x8000 + DAT_100535a0[3]),0x8000,0x4000);
        DAT_100535a0[2] = DAT_100535a0[2] | 0x80000000U >> ((byte)DAT_100535b8 & 0x1f);
        *(undefined4 *)(DAT_100535a0[4] + 0xc4 + DAT_100535b8 * 4) = 0;
        *(char *)(DAT_100535a0[4] + 0x43) = *(char *)(DAT_100535a0[4] + 0x43) + -1;
        if (*(char *)(DAT_100535a0[4] + 0x43) == '\0') {
          DAT_100535a0[1] = DAT_100535a0[1] & 0xfffffffe;
        }
        if (DAT_100535a0[2] == 0xffffffff) {
          VirtualFree((LPVOID)DAT_100535a0[3],0,0x8000);
          HeapFree(DAT_100535bc,0,(LPVOID)DAT_100535a0[4]);
          _memmove(DAT_100535a0,DAT_100535a0 + 5,
                   (DAT_100535a4 * 0x14 - (int)DAT_100535a0) + -0x14 + DAT_100535a8);
          DAT_100535a4 = DAT_100535a4 + -1;
          if (DAT_100535a0 < param_1) {
            param_1 = param_1 + -5;
          }
          DAT_100535b0 = DAT_100535a8;
        }
      }
      DAT_100535a0 = param_1;
      DAT_100535b8 = uVar14;
    }
  }
  return;
}



// Library Function - Single Match
//  ___sbh_alloc_new_region
// 
// Library: Visual Studio 2003 Release

undefined4 * ___sbh_alloc_new_region(void)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  
  if (DAT_100535a4 == DAT_100535b4) {
    pvVar2 = HeapReAlloc(DAT_100535bc,0,DAT_100535a8,(DAT_100535b4 * 5 + 0x50) * 4);
    if (pvVar2 == (LPVOID)0x0) {
      return (undefined4 *)0x0;
    }
    DAT_100535b4 = DAT_100535b4 + 0x10;
    DAT_100535a8 = pvVar2;
  }
  puVar1 = (undefined4 *)((int)DAT_100535a8 + DAT_100535a4 * 0x14);
  pvVar2 = HeapAlloc(DAT_100535bc,8,0x41c4);
  puVar1[4] = pvVar2;
  if (pvVar2 != (LPVOID)0x0) {
    pvVar2 = VirtualAlloc((LPVOID)0x0,0x100000,0x2000,4);
    puVar1[3] = pvVar2;
    if (pvVar2 != (LPVOID)0x0) {
      puVar1[2] = 0xffffffff;
      *puVar1 = 0;
      puVar1[1] = 0;
      DAT_100535a4 = DAT_100535a4 + 1;
      *(undefined4 *)puVar1[4] = 0xffffffff;
      return puVar1;
    }
    HeapFree(DAT_100535bc,0,(LPVOID)puVar1[4]);
  }
  return (undefined4 *)0x0;
}



// Library Function - Single Match
//  ___sbh_alloc_new_group
// 
// Library: Visual Studio 2003 Release

int __cdecl ___sbh_alloc_new_group(int param_1)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  LPVOID pvVar5;
  int *piVar6;
  int iVar7;
  int iVar8;
  LPVOID lpAddress;
  
  iVar2 = *(int *)(param_1 + 0x10);
  iVar8 = 0;
  for (iVar3 = *(int *)(param_1 + 8); -1 < iVar3; iVar3 = iVar3 << 1) {
    iVar8 = iVar8 + 1;
  }
  iVar3 = iVar8 * 0x204 + 0x144 + iVar2;
  iVar7 = 0x3f;
  iVar4 = iVar3;
  do {
    *(int *)(iVar4 + 8) = iVar4;
    *(int *)(iVar4 + 4) = iVar4;
    iVar4 = iVar4 + 8;
    iVar7 = iVar7 + -1;
  } while (iVar7 != 0);
  lpAddress = (LPVOID)(iVar8 * 0x8000 + *(int *)(param_1 + 0xc));
  pvVar5 = VirtualAlloc(lpAddress,0x8000,0x1000,4);
  if (pvVar5 == (LPVOID)0x0) {
    iVar8 = -1;
  }
  else {
    if (lpAddress <= (LPVOID)((int)lpAddress + 0x7000U)) {
      piVar6 = (int *)((int)lpAddress + 0x10);
      iVar7 = ((uint)((int)((int)lpAddress + 0x7000U) - (int)lpAddress) >> 0xc) + 1;
      do {
        piVar6[-2] = -1;
        piVar6[0x3fb] = -1;
        *piVar6 = (int)(piVar6 + 0x3ff);
        piVar6[-1] = 0xff0;
        piVar6[1] = (int)(piVar6 + -0x401);
        piVar6[0x3fa] = 0xff0;
        piVar6 = piVar6 + 0x400;
        iVar7 = iVar7 + -1;
      } while (iVar7 != 0);
    }
    *(int *)(iVar3 + 0x1fc) = (int)lpAddress + 0xc;
    *(int *)((int)lpAddress + 0x14) = iVar3 + 0x1f8;
    *(int *)(iVar3 + 0x200) = (int)lpAddress + 0x700c;
    *(int *)((int)lpAddress + 0x7010) = iVar3 + 0x1f8;
    *(undefined4 *)(iVar2 + 0x44 + iVar8 * 4) = 0;
    *(undefined4 *)(iVar2 + 0xc4 + iVar8 * 4) = 1;
    cVar1 = *(char *)(iVar2 + 0x43);
    *(char *)(iVar2 + 0x43) = cVar1 + '\x01';
    if (cVar1 == '\0') {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 1;
    }
    *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) & ~(0x80000000U >> ((byte)iVar8 & 0x1f));
  }
  return iVar8;
}



// Library Function - Single Match
//  ___sbh_resize_block
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl ___sbh_resize_block(uint *param_1,int param_2,int param_3)

{
  char *pcVar1;
  uint *puVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  char cVar6;
  uint uVar7;
  uint *puVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint local_c;
  
  uVar7 = param_1[4];
  uVar10 = param_2 - param_1[3] >> 0xf;
  iVar5 = uVar10 * 0x204 + 0x144 + uVar7;
  uVar12 = param_3 + 0x17U & 0xfffffff0;
  iVar9 = *(int *)(param_2 + -4) + -1;
  puVar8 = (uint *)(*(int *)(param_2 + -4) + -5 + param_2);
  uVar13 = *puVar8;
  if (iVar9 < (int)uVar12) {
    if (((uVar13 & 1) != 0) || ((int)(uVar13 + iVar9) < (int)uVar12)) {
      return 0;
    }
    local_c = ((int)uVar13 >> 4) - 1;
    if (0x3f < local_c) {
      local_c = 0x3f;
    }
    if (puVar8[1] == puVar8[2]) {
      if (local_c < 0x20) {
        pcVar1 = (char *)(local_c + 4 + uVar7);
        uVar11 = ~(0x80000000U >> ((byte)local_c & 0x1f));
        puVar2 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
        *puVar2 = *puVar2 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar11;
        }
      }
      else {
        pcVar1 = (char *)(local_c + 4 + uVar7);
        uVar11 = ~(0x80000000U >> ((byte)local_c - 0x20 & 0x1f));
        puVar2 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
        *puVar2 = *puVar2 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar11;
        }
      }
    }
    *(uint *)(puVar8[2] + 4) = puVar8[1];
    *(uint *)(puVar8[1] + 8) = puVar8[2];
    iVar9 = uVar13 + (iVar9 - uVar12);
    if (0 < iVar9) {
      uVar13 = (iVar9 >> 4) - 1;
      iVar3 = param_2 + -4 + uVar12;
      if (0x3f < uVar13) {
        uVar13 = 0x3f;
      }
      iVar5 = iVar5 + uVar13 * 8;
      *(undefined4 *)(iVar3 + 4) = *(undefined4 *)(iVar5 + 4);
      *(int *)(iVar3 + 8) = iVar5;
      *(int *)(iVar5 + 4) = iVar3;
      *(int *)(*(int *)(iVar3 + 4) + 8) = iVar3;
      if (*(int *)(iVar3 + 4) == *(int *)(iVar3 + 8)) {
        cVar6 = *(char *)(uVar13 + 4 + uVar7);
        *(char *)(uVar13 + 4 + uVar7) = cVar6 + '\x01';
        if (uVar13 < 0x20) {
          if (cVar6 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> ((byte)uVar13 & 0x1f);
          }
          puVar8 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
        }
        else {
          if (cVar6 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> ((byte)uVar13 - 0x20 & 0x1f);
          }
          puVar8 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
          uVar13 = uVar13 - 0x20;
        }
        *puVar8 = *puVar8 | 0x80000000U >> ((byte)uVar13 & 0x1f);
      }
      piVar4 = (int *)(param_2 + -4 + uVar12);
      *piVar4 = iVar9;
      *(int *)(iVar9 + -4 + (int)piVar4) = iVar9;
    }
    *(uint *)(param_2 + -4) = uVar12 + 1;
    *(uint *)(param_2 + -8 + uVar12) = uVar12 + 1;
  }
  else if ((int)uVar12 < iVar9) {
    param_3 = iVar9 - uVar12;
    *(uint *)(param_2 + -4) = uVar12 + 1;
    piVar4 = (int *)(param_2 + -4 + uVar12);
    uVar11 = (param_3 >> 4) - 1;
    piVar4[-1] = uVar12 + 1;
    if (0x3f < uVar11) {
      uVar11 = 0x3f;
    }
    if ((uVar13 & 1) == 0) {
      uVar12 = ((int)uVar13 >> 4) - 1;
      if (0x3f < uVar12) {
        uVar12 = 0x3f;
      }
      if (puVar8[1] == puVar8[2]) {
        if (uVar12 < 0x20) {
          pcVar1 = (char *)(uVar12 + 4 + uVar7);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 & 0x1f));
          puVar2 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
          *puVar2 = *puVar2 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar12;
          }
        }
        else {
          pcVar1 = (char *)(uVar12 + 4 + uVar7);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 - 0x20 & 0x1f));
          puVar2 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
          *puVar2 = *puVar2 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar12;
          }
        }
      }
      *(uint *)(puVar8[2] + 4) = puVar8[1];
      *(uint *)(puVar8[1] + 8) = puVar8[2];
      param_3 = param_3 + uVar13;
      uVar11 = (param_3 >> 4) - 1;
      if (0x3f < uVar11) {
        uVar11 = 0x3f;
      }
    }
    iVar5 = iVar5 + uVar11 * 8;
    iVar9 = *(int *)(iVar5 + 4);
    piVar4[2] = iVar5;
    piVar4[1] = iVar9;
    *(int **)(iVar5 + 4) = piVar4;
    *(int **)(piVar4[1] + 8) = piVar4;
    if (piVar4[1] == piVar4[2]) {
      cVar6 = *(char *)(uVar11 + 4 + uVar7);
      *(char *)(uVar11 + 4 + uVar7) = cVar6 + '\x01';
      if (uVar11 < 0x20) {
        if (cVar6 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> ((byte)uVar11 & 0x1f);
        }
        puVar8 = (uint *)(uVar7 + 0x44 + uVar10 * 4);
      }
      else {
        if (cVar6 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> ((byte)uVar11 - 0x20 & 0x1f);
        }
        puVar8 = (uint *)(uVar7 + 0xc4 + uVar10 * 4);
        uVar11 = uVar11 - 0x20;
      }
      *puVar8 = *puVar8 | 0x80000000U >> ((byte)uVar11 & 0x1f);
    }
    *piVar4 = param_3;
    *(int *)(param_3 + -4 + (int)piVar4) = param_3;
  }
  return 1;
}



// Library Function - Single Match
//  ___sbh_alloc_block
// 
// Library: Visual Studio 2003 Release

int * __cdecl ___sbh_alloc_block(uint *param_1)

{
  int *piVar1;
  char *pcVar2;
  int *piVar3;
  char cVar4;
  int *piVar5;
  byte bVar6;
  uint uVar7;
  int iVar8;
  uint *puVar9;
  int iVar10;
  int *piVar11;
  uint *puVar12;
  uint *puVar13;
  uint uVar14;
  int iVar15;
  bool bVar16;
  uint local_c;
  int local_8;
  
  uVar7 = (int)param_1 + 0x17U & 0xfffffff0;
  iVar8 = ((int)((int)param_1 + 0x17U) >> 4) + -1;
  puVar9 = DAT_100535a8 + DAT_100535a4 * 5;
  bVar6 = (byte)iVar8;
  if (iVar8 < 0x20) {
    uVar14 = 0xffffffff >> (bVar6 & 0x1f);
    local_c = 0xffffffff;
  }
  else {
    uVar14 = 0;
    local_c = 0xffffffff >> (bVar6 - 0x20 & 0x1f);
  }
  bVar16 = DAT_100535b0 < puVar9;
  param_1 = DAT_100535b0;
  while ((bVar16 && ((param_1[1] & local_c) == 0 && (*param_1 & uVar14) == 0))) {
    param_1 = param_1 + 5;
    bVar16 = param_1 < puVar9;
  }
  puVar12 = DAT_100535a8;
  if (param_1 == puVar9) {
    for (; (puVar12 < DAT_100535b0 && ((puVar12[1] & local_c) == 0 && (*puVar12 & uVar14) == 0));
        puVar12 = puVar12 + 5) {
    }
    param_1 = puVar12;
    if (puVar12 == DAT_100535b0) {
      for (; (puVar12 < puVar9 && (puVar12[2] == 0)); puVar12 = puVar12 + 5) {
      }
      puVar13 = DAT_100535a8;
      param_1 = puVar12;
      if (puVar12 == puVar9) {
        for (; (puVar13 < DAT_100535b0 && (puVar13[2] == 0)); puVar13 = puVar13 + 5) {
        }
        param_1 = puVar13;
        if ((puVar13 == DAT_100535b0) &&
           (param_1 = ___sbh_alloc_new_region(), param_1 == (uint *)0x0)) {
          return (int *)0x0;
        }
      }
      iVar8 = ___sbh_alloc_new_group((int)param_1);
      *(int *)param_1[4] = iVar8;
      if (*(int *)param_1[4] == -1) {
        return (int *)0x0;
      }
    }
  }
  piVar5 = (int *)param_1[4];
  local_8 = *piVar5;
  if ((local_8 == -1) ||
     ((piVar5[local_8 + 0x31] & local_c) == 0 && (piVar5[local_8 + 0x11] & uVar14) == 0)) {
    local_8 = 0;
    puVar9 = (uint *)(piVar5 + 0x11);
    if ((piVar5[0x31] & local_c) == 0 && (*puVar9 & uVar14) == 0) {
      do {
        puVar12 = puVar9 + 0x21;
        local_8 = local_8 + 1;
        puVar9 = puVar9 + 1;
      } while ((*puVar12 & local_c) == 0 && (*puVar9 & uVar14) == 0);
    }
  }
  piVar3 = piVar5 + local_8 * 0x81 + 0x51;
  iVar8 = 0;
  uVar14 = piVar5[local_8 + 0x11] & uVar14;
  if (uVar14 == 0) {
    uVar14 = piVar5[local_8 + 0x31] & local_c;
    iVar8 = 0x20;
  }
  for (; -1 < (int)uVar14; uVar14 = uVar14 << 1) {
    iVar8 = iVar8 + 1;
  }
  piVar11 = (int *)piVar3[iVar8 * 2 + 1];
  iVar10 = *piVar11 - uVar7;
  iVar15 = (iVar10 >> 4) + -1;
  if (0x3f < iVar15) {
    iVar15 = 0x3f;
  }
  DAT_100535b0 = param_1;
  if (iVar15 != iVar8) {
    if (piVar11[1] == piVar11[2]) {
      if (iVar8 < 0x20) {
        pcVar2 = (char *)((int)piVar5 + iVar8 + 4);
        uVar14 = ~(0x80000000U >> ((byte)iVar8 & 0x1f));
        piVar5[local_8 + 0x11] = uVar14 & piVar5[local_8 + 0x11];
        *pcVar2 = *pcVar2 + -1;
        if (*pcVar2 == '\0') {
          *param_1 = *param_1 & uVar14;
        }
      }
      else {
        pcVar2 = (char *)((int)piVar5 + iVar8 + 4);
        uVar14 = ~(0x80000000U >> ((byte)iVar8 - 0x20 & 0x1f));
        piVar5[local_8 + 0x31] = piVar5[local_8 + 0x31] & uVar14;
        *pcVar2 = *pcVar2 + -1;
        if (*pcVar2 == '\0') {
          param_1[1] = param_1[1] & uVar14;
        }
      }
    }
    *(int *)(piVar11[2] + 4) = piVar11[1];
    *(int *)(piVar11[1] + 8) = piVar11[2];
    if (iVar10 == 0) goto LAB_100331cd;
    piVar1 = piVar3 + iVar15 * 2;
    iVar8 = piVar1[1];
    piVar11[2] = (int)piVar1;
    piVar11[1] = iVar8;
    piVar1[1] = (int)piVar11;
    *(int **)(piVar11[1] + 8) = piVar11;
    if (piVar11[1] == piVar11[2]) {
      cVar4 = *(char *)(iVar15 + 4 + (int)piVar5);
      *(char *)(iVar15 + 4 + (int)piVar5) = cVar4 + '\x01';
      bVar6 = (byte)iVar15;
      if (iVar15 < 0x20) {
        if (cVar4 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar6 & 0x1f);
        }
        piVar5[local_8 + 0x11] = piVar5[local_8 + 0x11] | 0x80000000U >> (bVar6 & 0x1f);
      }
      else {
        if (cVar4 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar6 - 0x20 & 0x1f);
        }
        piVar5[local_8 + 0x31] = piVar5[local_8 + 0x31] | 0x80000000U >> (bVar6 - 0x20 & 0x1f);
      }
    }
  }
  if (iVar10 != 0) {
    *piVar11 = iVar10;
    *(int *)(iVar10 + -4 + (int)piVar11) = iVar10;
  }
LAB_100331cd:
  piVar11 = (int *)((int)piVar11 + iVar10);
  *piVar11 = uVar7 + 1;
  *(uint *)((int)piVar11 + (uVar7 - 4)) = uVar7 + 1;
  iVar8 = *piVar3;
  *piVar3 = iVar8 + 1;
  if (((iVar8 == 0) && (param_1 == DAT_100535a0)) && (local_8 == DAT_100535b8)) {
    DAT_100535a0 = (uint *)0x0;
  }
  *piVar5 = local_8;
  return piVar11 + 1;
}



// Library Function - Single Match
//  __callnewh
// 
// Library: Visual Studio 2003 Release

int __cdecl __callnewh(size_t _Size)

{
  int iVar1;
  
  if (DAT_10053220 != (code *)0x0) {
    iVar1 = (*DAT_10053220)(_Size);
    if (iVar1 != 0) {
      return 1;
    }
  }
  return 0;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __stbuf
// 
// Library: Visual Studio 2003 Release

int __cdecl __stbuf(FILE *_File)

{
  int *piVar1;
  char *pcVar2;
  int iVar3;
  void *pvVar4;
  
  iVar3 = __isatty(_File->_file);
  if (iVar3 == 0) {
    return 0;
  }
  if (_File == (FILE *)&DAT_100415a0) {
    iVar3 = 0;
  }
  else {
    if (_File != (FILE *)&DAT_100415c0) {
      return 0;
    }
    iVar3 = 1;
  }
  _DAT_10052ea0 = _DAT_10052ea0 + 1;
  if ((_File->_flag & 0x10c) != 0) {
    return 0;
  }
  piVar1 = &DAT_10053228 + iVar3;
  if (*piVar1 == 0) {
    pvVar4 = _malloc(0x1000);
    *piVar1 = (int)pvVar4;
    if (pvVar4 == (void *)0x0) {
      _File->_base = (char *)&_File->_charbuf;
      _File->_ptr = (char *)&_File->_charbuf;
      _File->_bufsiz = 2;
      _File->_cnt = 2;
      goto LAB_100332a2;
    }
  }
  pcVar2 = (char *)*piVar1;
  _File->_base = pcVar2;
  _File->_ptr = pcVar2;
  _File->_bufsiz = 0x1000;
  _File->_cnt = 0x1000;
LAB_100332a2:
  *(ushort *)&_File->_flag = (ushort)_File->_flag | 0x1102;
  return 1;
}



// Library Function - Single Match
//  __ftbuf
// 
// Library: Visual Studio 2003 Release

void __cdecl __ftbuf(int _Flag,FILE *_File)

{
  byte *pbVar1;
  
  if ((_Flag != 0) && ((_File->_flag & 0x1000) != 0)) {
    __flush(_File);
    pbVar1 = (byte *)((int)&_File->_flag + 1);
    *pbVar1 = *pbVar1 & 0xee;
    _File->_bufsiz = 0;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
  }
  return;
}



// Library Function - Single Match
//  __close_lk
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __close_lk(uint param_1)

{
  intptr_t iVar1;
  intptr_t iVar2;
  HANDLE hObject;
  BOOL BVar3;
  DWORD DVar4;
  undefined4 uVar5;
  
  iVar1 = __get_osfhandle(param_1);
  if (iVar1 != -1) {
    if ((param_1 == 1) || (param_1 == 2)) {
      iVar1 = __get_osfhandle(2);
      iVar2 = __get_osfhandle(1);
      if (iVar2 == iVar1) goto LAB_1003332b;
    }
    hObject = (HANDLE)__get_osfhandle(param_1);
    BVar3 = CloseHandle(hObject);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      goto LAB_1003332d;
    }
  }
LAB_1003332b:
  DVar4 = 0;
LAB_1003332d:
  __free_osfhnd(param_1);
  *(undefined1 *)((&DAT_100535e0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) = 0;
  if (DVar4 == 0) {
    uVar5 = 0;
  }
  else {
    __dosmaperr(DVar4);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __close
// 
// Library: Visual Studio 2003 Release

int __cdecl __close(int _FileHandle)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  int local_20;
  
  if ((uint)_FileHandle < DAT_100535c4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_1003366f();
        *piVar1 = 9;
        local_20 = -1;
      }
      else {
        local_20 = __close_lk(_FileHandle);
      }
      FUN_100333d7();
      return local_20;
    }
  }
  piVar1 = FUN_1003366f();
  *piVar1 = 9;
  puVar2 = FUN_10033678();
  *puVar2 = 0;
  return -1;
}



void FUN_100333d7(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// Library Function - Single Match
//  __freebuf
// 
// Library: Visual Studio 2003 Release

void __cdecl __freebuf(FILE *_File)

{
  if (((_File->_flag & 0x83U) != 0) && ((_File->_flag & 8U) != 0)) {
    _free(_File->_base);
    *(ushort *)&_File->_flag = (ushort)_File->_flag & 0xfbf7;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_cnt = 0;
  }
  return;
}



// Library Function - Single Match
//  __filbuf
// 
// Library: Visual Studio 2003 Release

int __cdecl __filbuf(FILE *_File)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  undefined *puVar4;
  
  uVar2 = _File->_flag;
  if (((uVar2 & 0x83) != 0) && ((uVar2 & 0x40) == 0)) {
    if ((uVar2 & 2) == 0) {
      _File->_flag = uVar2 | 1;
      if ((uVar2 & 0x10c) == 0) {
        __getbuf(_File);
      }
      else {
        _File->_ptr = _File->_base;
      }
      iVar3 = __read(_File->_file,_File->_base,_File->_bufsiz);
      _File->_cnt = iVar3;
      if ((iVar3 != 0) && (iVar3 != -1)) {
        if ((_File->_flag & 0x82U) == 0) {
          uVar2 = _File->_file;
          if (uVar2 == 0xffffffff) {
            puVar4 = &DAT_10041950;
          }
          else {
            puVar4 = (undefined *)((&DAT_100535e0)[(int)uVar2 >> 5] + (uVar2 & 0x1f) * 0x24);
          }
          if ((puVar4[4] & 0x82) == 0x82) {
            _File->_flag = _File->_flag | 0x2000;
          }
        }
        if (((_File->_bufsiz == 0x200) && ((_File->_flag & 8U) != 0)) &&
           ((_File->_flag & 0x400U) == 0)) {
          _File->_bufsiz = 0x1000;
        }
        _File->_cnt = iVar3 + -1;
        bVar1 = *_File->_ptr;
        _File->_ptr = _File->_ptr + 1;
        return (uint)bVar1;
      }
      _File->_flag = _File->_flag | (-(uint)(iVar3 != 0) & 0x10) + 0x10;
      _File->_cnt = 0;
    }
    else {
      _File->_flag = uVar2 | 0x20;
    }
  }
  return -1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __openfile
// 
// Library: Visual Studio 2003 Release

FILE * __cdecl __openfile(char *_Filename,char *_Mode,int _ShFlag,FILE *_File)

{
  char cVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  int iVar5;
  uint _OpenFlag;
  uint uVar6;
  
  cVar1 = *_Mode;
  bVar4 = false;
  bVar3 = false;
  if (cVar1 == 'a') {
    _OpenFlag = 0x109;
  }
  else {
    if (cVar1 == 'r') {
      _OpenFlag = 0;
      uVar6 = DAT_100532cc | 1;
      goto LAB_10033548;
    }
    if (cVar1 != 'w') {
      return (FILE *)0x0;
    }
    _OpenFlag = 0x301;
  }
  uVar6 = DAT_100532cc | 2;
LAB_10033548:
  bVar2 = true;
LAB_10033627:
  _Mode = _Mode + 1;
  cVar1 = *_Mode;
  if ((cVar1 == '\0') || (!bVar2)) {
    iVar5 = __sopen(_Filename,_OpenFlag,_ShFlag,0x1a4);
    if (iVar5 < 0) {
      return (FILE *)0x0;
    }
    _DAT_10052ea0 = _DAT_10052ea0 + 1;
    _File->_flag = uVar6;
    _File->_cnt = 0;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_tmpfname = (char *)0x0;
    _File->_file = iVar5;
    return _File;
  }
  if (cVar1 < 'U') {
    if (cVar1 == 'T') {
      if ((_OpenFlag & 0x1000) == 0) {
        _OpenFlag = _OpenFlag | 0x1000;
        goto LAB_10033627;
      }
    }
    else if (cVar1 == '+') {
      if ((_OpenFlag & 2) == 0) {
        _OpenFlag = _OpenFlag & 0xfffffffe | 2;
        uVar6 = uVar6 & 0xfffffffc | 0x80;
        goto LAB_10033627;
      }
    }
    else if (cVar1 == 'D') {
      if ((_OpenFlag & 0x40) == 0) {
        _OpenFlag = _OpenFlag | 0x40;
        goto LAB_10033627;
      }
    }
    else if (cVar1 == 'R') {
      if (!bVar3) {
        bVar3 = true;
        _OpenFlag = _OpenFlag | 0x10;
        goto LAB_10033627;
      }
    }
    else if ((cVar1 == 'S') && (!bVar3)) {
      bVar3 = true;
      _OpenFlag = _OpenFlag | 0x20;
      goto LAB_10033627;
    }
  }
  else {
    if (cVar1 == 'b') {
      if ((_OpenFlag & 0xc000) != 0) goto LAB_10033609;
      _OpenFlag = _OpenFlag | 0x8000;
      goto LAB_10033627;
    }
    if (cVar1 == 'c') {
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 | 0x4000;
        goto LAB_10033627;
      }
    }
    else {
      if (cVar1 != 'n') {
        if ((cVar1 != 't') || ((_OpenFlag & 0xc000) != 0)) goto LAB_10033609;
        _OpenFlag = _OpenFlag | 0x4000;
        goto LAB_10033627;
      }
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 & 0xffffbfff;
        goto LAB_10033627;
      }
    }
  }
LAB_10033609:
  bVar2 = false;
  goto LAB_10033627;
}



int * FUN_1003366f(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  return &p_Var1->_terrno;
}



ulong * FUN_10033678(void)

{
  _ptiddata p_Var1;
  
  p_Var1 = __getptd();
  return &p_Var1->_tdoserrno;
}



// Library Function - Single Match
//  __dosmaperr
// 
// Library: Visual Studio 2003 Release

void __cdecl __dosmaperr(ulong param_1)

{
  _ptiddata p_Var1;
  uint uVar2;
  
  p_Var1 = __getptd();
  p_Var1->_tdoserrno = param_1;
  uVar2 = 0;
  do {
    if (param_1 == (&DAT_10041bb0)[uVar2 * 2]) {
      p_Var1 = __getptd();
      p_Var1->_terrno = (&DAT_10041bb4)[uVar2 * 2];
      return;
    }
    uVar2 = uVar2 + 1;
  } while (uVar2 < 0x2d);
  if ((0x12 < param_1) && (param_1 < 0x25)) {
    p_Var1 = __getptd();
    p_Var1->_terrno = 0xd;
    return;
  }
  if ((0xbb < param_1) && (param_1 < 0xcb)) {
    p_Var1 = __getptd();
    p_Var1->_terrno = 8;
    return;
  }
  p_Var1 = __getptd();
  p_Var1->_terrno = 0x16;
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __getstream
// 
// Library: Visual Studio 2003 Release

FILE * __cdecl __getstream(void)

{
  int iVar1;
  void *pvVar2;
  int iVar3;
  FILE *pFVar4;
  FILE *_File;
  
  pFVar4 = (FILE *)0x0;
  __lock(1);
  iVar3 = 0;
  do {
    _File = pFVar4;
    if (DAT_10054700 <= iVar3) {
LAB_100337e3:
      if (_File != (FILE *)0x0) {
        _File->_cnt = 0;
        _File->_flag = 0;
        _File->_base = (char *)0x0;
        _File->_ptr = (char *)0x0;
        _File->_tmpfname = (char *)0x0;
        _File->_file = -1;
      }
      FUN_1003380d();
      return _File;
    }
    iVar1 = *(int *)(DAT_100536f0 + iVar3 * 4);
    if (iVar1 == 0) {
      iVar3 = iVar3 * 4;
      pvVar2 = _malloc(0x38);
      *(void **)(iVar3 + DAT_100536f0) = pvVar2;
      if (*(int *)(iVar3 + DAT_100536f0) != 0) {
        iVar1 = ___crtInitCritSecAndSpinCount(*(int *)(iVar3 + DAT_100536f0) + 0x20,4000);
        if (iVar1 == 0) {
          _free(*(void **)(iVar3 + DAT_100536f0));
          *(undefined4 *)(iVar3 + DAT_100536f0) = 0;
        }
        else {
          EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(iVar3 + DAT_100536f0) + 0x20));
          _File = *(FILE **)(iVar3 + DAT_100536f0);
        }
      }
      goto LAB_100337e3;
    }
    if ((*(byte *)(iVar1 + 0xc) & 0x83) == 0) {
      if (((2 < iVar3) && (iVar3 < 0x14)) && (iVar1 = __mtinitlocknum(iVar3 + 0x10), iVar1 == 0))
      goto LAB_100337e3;
      __lock_file2(iVar3,*(void **)(DAT_100536f0 + iVar3 * 4));
      _File = *(FILE **)(DAT_100536f0 + iVar3 * 4);
      if ((_File->_flag & 0x83) == 0) goto LAB_100337e3;
      __unlock_file2(iVar3,_File);
    }
    iVar3 = iVar3 + 1;
  } while( true );
}



void FUN_1003380d(void)

{
  FUN_1002f8d0(1);
  return;
}



// Library Function - Single Match
//  ___isctype_mt
// 
// Library: Visual Studio 2003 Release

uint __thiscall ___isctype_mt(void *this,int param_1,int param_2,uint param_3)

{
  undefined4 uVar1;
  LPCSTR _LpSrcStr;
  BOOL BVar2;
  undefined4 local_8;
  
  if (param_2 + 1U < 0x101) {
    param_2._2_2_ = *(ushort *)(*(int *)(param_1 + 0x48) + param_2 * 2);
  }
  else {
    local_8._2_2_ = (undefined2)((uint)this >> 0x10);
    if ((*(byte *)(*(int *)(param_1 + 0x48) + 1 + (param_2 >> 8 & 0xffU) * 2) & 0x80) == 0) {
      local_8._0_2_ = (ushort)(byte)param_2;
      _LpSrcStr = (LPCSTR)0x1;
    }
    else {
      local_8 = CONCAT31(CONCAT21(local_8._2_2_,(byte)param_2),(char)((uint)param_2 >> 8));
      uVar1 = local_8;
      local_8._3_1_ = (undefined1)((uint)this >> 0x18);
      local_8._0_2_ = (ushort)uVar1;
      local_8._0_3_ = (uint3)(ushort)local_8;
      _LpSrcStr = (LPCSTR)0x2;
    }
    BVar2 = ___crtGetStringTypeA
                      ((_locale_t)0x1,(DWORD)&local_8,_LpSrcStr,(int)&param_2 + 2,
                       *(LPWORD *)(param_1 + 4),*(int *)(param_1 + 0x14),1);
    if (BVar2 == 0) {
      return 0;
    }
  }
  return param_2._2_2_ & param_3;
}



// Library Function - Single Match
//  ___freetlocinfo
// 
// Library: Visual Studio 2003 Release

void __cdecl ___freetlocinfo(void *param_1)

{
  int *piVar1;
  undefined4 *puVar2;
  
  if (((*(int *)((int)param_1 + 0x3c) != DAT_100532dc) && (*(int *)((int)param_1 + 0x3c) != 0)) &&
     (**(int **)((int)param_1 + 0x2c) == 0)) {
    piVar1 = *(int **)((int)param_1 + 0x34);
    if (((piVar1 != (int *)0x0) && (*piVar1 == 0)) && (piVar1 != DAT_10053358)) {
      _free(piVar1);
      ___free_lconv_mon(*(int *)((int)param_1 + 0x3c));
    }
    piVar1 = *(int **)((int)param_1 + 0x30);
    if (((piVar1 != (int *)0x0) && (*piVar1 == 0)) && (piVar1 != DAT_1005335c)) {
      _free(piVar1);
      ___free_lconv_num(*(undefined4 **)((int)param_1 + 0x3c));
    }
    _free(*(void **)((int)param_1 + 0x2c));
    _free(*(void **)((int)param_1 + 0x3c));
  }
  piVar1 = *(int **)((int)param_1 + 0x40);
  if (((piVar1 != DAT_10053354) && (piVar1 != (int *)0x0)) && (*piVar1 == 0)) {
    _free(piVar1);
    _free((void *)(*(int *)((int)param_1 + 0x44) + -0xfe));
  }
  puVar2 = *(undefined4 **)((int)param_1 + 0x50);
  if (((puVar2 != DAT_100532d8) && (puVar2 != (undefined4 *)0x0)) && (puVar2[0x2d] == 0)) {
    ___free_lc_time(puVar2);
    _free(*(void **)((int)param_1 + 0x50));
  }
  _free(param_1);
  return;
}



// Library Function - Single Match
//  ___updatetlocinfo_lk
// 
// Library: Visual Studio 2003 Release

int ___updatetlocinfo_lk(void)

{
  int *piVar1;
  int *piVar2;
  _ptiddata p_Var3;
  
  p_Var3 = __getptd();
  piVar1 = (int *)p_Var3->_tfpecode;
  if (piVar1 != (int *)PTR_DAT_10041d74) {
    if (piVar1 != (int *)0x0) {
      piVar2 = (int *)piVar1[0xb];
      *piVar1 = *piVar1 + -1;
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      piVar2 = (int *)piVar1[0xd];
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      piVar2 = (int *)piVar1[0xc];
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      piVar2 = (int *)piVar1[0x10];
      if (piVar2 != (int *)0x0) {
        *piVar2 = *piVar2 + -1;
      }
      *(int *)(piVar1[0x13] + 0xb4) = *(int *)(piVar1[0x13] + 0xb4) + -1;
    }
    p_Var3->_tfpecode = (int)PTR_DAT_10041d74;
    *(int *)PTR_DAT_10041d74 = *(int *)PTR_DAT_10041d74 + 1;
    if (*(int *)(PTR_DAT_10041d74 + 0x2c) != 0) {
      **(int **)(PTR_DAT_10041d74 + 0x2c) = **(int **)(PTR_DAT_10041d74 + 0x2c) + 1;
    }
    if (*(int *)(PTR_DAT_10041d74 + 0x34) != 0) {
      **(int **)(PTR_DAT_10041d74 + 0x34) = **(int **)(PTR_DAT_10041d74 + 0x34) + 1;
    }
    if (*(int *)(PTR_DAT_10041d74 + 0x30) != 0) {
      **(int **)(PTR_DAT_10041d74 + 0x30) = **(int **)(PTR_DAT_10041d74 + 0x30) + 1;
    }
    if (*(int *)(PTR_DAT_10041d74 + 0x40) != 0) {
      **(int **)(PTR_DAT_10041d74 + 0x40) = **(int **)(PTR_DAT_10041d74 + 0x40) + 1;
    }
    *(int *)(*(int *)(PTR_DAT_10041d74 + 0x4c) + 0xb4) =
         *(int *)(*(int *)(PTR_DAT_10041d74 + 0x4c) + 0xb4) + 1;
    if (((piVar1 != (int *)0x0) && (*piVar1 == 0)) && (piVar1 != &DAT_10041d20)) {
      ___freetlocinfo(piVar1);
    }
  }
  return p_Var3->_tfpecode;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___updatetlocinfo
// 
// Library: Visual Studio 2003 Release

pthreadlocinfo __cdecl ___updatetlocinfo(void)

{
  pthreadlocinfo ptVar1;
  
  __lock(0xc);
  ptVar1 = (pthreadlocinfo)___updatetlocinfo_lk();
  FUN_10033aeb();
  return ptVar1;
}



void FUN_10033aeb(void)

{
  FUN_1002f8d0(0xc);
  return;
}



// Library Function - Single Match
//  _memcpy
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release

void * __cdecl _memcpy(void *_Dst,void *_Src,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((_Src < _Dst) && (_Dst < (void *)(_Size + (int)_Src))) {
    puVar3 = (undefined4 *)((_Size - 4) + (int)_Src);
    puVar4 = (undefined4 *)((_Size - 4) + (int)_Dst);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = _Size >> 2;
      uVar2 = _Size & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return _Dst;
        case 2:
          goto switchD_10033cfb_caseD_2;
        case 3:
          goto switchD_10033cfb_caseD_3;
        }
        goto switchD_10033cfb_caseD_1;
      }
    }
    else {
      switch(_Size) {
      case 0:
        goto switchD_10033cfb_caseD_0;
      case 1:
        goto switchD_10033cfb_caseD_1;
      case 2:
        goto switchD_10033cfb_caseD_2;
      case 3:
        goto switchD_10033cfb_caseD_3;
      default:
        uVar1 = _Size - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_10033cfb_caseD_2;
            case 3:
              goto switchD_10033cfb_caseD_3;
            }
            goto switchD_10033cfb_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_10033cfb_caseD_2;
            case 3:
              goto switchD_10033cfb_caseD_3;
            }
            goto switchD_10033cfb_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return _Dst;
            case 2:
              goto switchD_10033cfb_caseD_2;
            case 3:
              goto switchD_10033cfb_caseD_3;
            }
            goto switchD_10033cfb_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_10033cfb_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return _Dst;
    case 2:
switchD_10033cfb_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return _Dst;
    case 3:
switchD_10033cfb_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return _Dst;
    }
switchD_10033cfb_caseD_0:
    return _Dst;
  }
  puVar3 = (undefined4 *)_Dst;
  if (((uint)_Dst & 3) == 0) {
    uVar1 = _Size >> 2;
    uVar2 = _Size & 3;
    if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *_Src;
        _Src = (undefined4 *)((int)_Src + 4);
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return _Dst;
      case 2:
        goto switchD_10033b75_caseD_2;
      case 3:
        goto switchD_10033b75_caseD_3;
      }
      goto switchD_10033b75_caseD_1;
    }
  }
  else {
    switch(_Size) {
    case 0:
      goto switchD_10033b75_caseD_0;
    case 1:
      goto switchD_10033b75_caseD_1;
    case 2:
      goto switchD_10033b75_caseD_2;
    case 3:
      goto switchD_10033b75_caseD_3;
    default:
      uVar1 = (_Size - 4) + ((uint)_Dst & 3);
      switch((uint)_Dst & 3) {
      case 1:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 2) = *(undefined1 *)((int)_Src + 2);
        _Src = (void *)((int)_Src + 3);
        puVar3 = (undefined4 *)((int)_Dst + 3);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10033b75_caseD_2;
          case 3:
            goto switchD_10033b75_caseD_3;
          }
          goto switchD_10033b75_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)_Dst + 1) = *(undefined1 *)((int)_Src + 1);
        _Src = (void *)((int)_Src + 2);
        puVar3 = (undefined4 *)((int)_Dst + 2);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10033b75_caseD_2;
          case 3:
            goto switchD_10033b75_caseD_3;
          }
          goto switchD_10033b75_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
                    // WARNING: Load size is inaccurate
        *(undefined1 *)_Dst = *_Src;
        _Src = (void *)((int)_Src + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)_Dst + 1);
        if (7 < uVar1) {
                    // WARNING: Load size is inaccurate
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *_Src;
            _Src = (undefined4 *)((int)_Src + 4);
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return _Dst;
          case 2:
            goto switchD_10033b75_caseD_2;
          case 3:
            goto switchD_10033b75_caseD_3;
          }
          goto switchD_10033b75_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = *(undefined4 *)((int)_Src + (uVar1 - 7) * 4);
  case 6:
    puVar3[uVar1 - 6] = *(undefined4 *)((int)_Src + (uVar1 - 6) * 4);
  case 5:
    puVar3[uVar1 - 5] = *(undefined4 *)((int)_Src + (uVar1 - 5) * 4);
  case 4:
    puVar3[uVar1 - 4] = *(undefined4 *)((int)_Src + (uVar1 - 4) * 4);
  case 3:
    puVar3[uVar1 - 3] = *(undefined4 *)((int)_Src + (uVar1 - 3) * 4);
  case 2:
    puVar3[uVar1 - 2] = *(undefined4 *)((int)_Src + (uVar1 - 2) * 4);
  case 1:
    puVar3[uVar1 - 1] = *(undefined4 *)((int)_Src + (uVar1 - 1) * 4);
    _Src = (void *)((int)_Src + uVar1 * 4);
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_10033b75_caseD_1:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    return _Dst;
  case 2:
switchD_10033b75_caseD_2:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    return _Dst;
  case 3:
switchD_10033b75_caseD_3:
                    // WARNING: Load size is inaccurate
    *(undefined1 *)puVar3 = *_Src;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)_Src + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)_Src + 2);
    return _Dst;
  }
switchD_10033b75_caseD_0:
  return _Dst;
}



// Library Function - Single Match
//  __write_lk
// 
// Library: Visual Studio 2003 Release

void __cdecl __write_lk(uint param_1,char *param_2,uint param_3)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  BOOL BVar4;
  int *piVar5;
  ulong *puVar6;
  uint uVar7;
  int iVar8;
  DWORD local_424;
  int local_420;
  DWORD local_41c;
  char *local_418;
  int local_414;
  ulong local_410;
  char local_40c [1028];
  int local_8;
  
  local_8 = DAT_10041558;
  local_41c = 0;
  local_420 = 0;
  if (param_3 == 0) goto LAB_10034037;
  piVar5 = &DAT_100535e0 + ((int)param_1 >> 5);
  iVar8 = (param_1 & 0x1f) * 0x24;
  if ((*(byte *)(*piVar5 + 4 + iVar8) & 0x20) != 0) {
    __lseeki64_lk(param_1,0,0,2);
  }
  if ((*(byte *)((undefined4 *)(*piVar5 + iVar8) + 1) & 0x80) == 0) {
    BVar4 = WriteFile(*(HANDLE *)(*piVar5 + iVar8),param_2,param_3,&local_424,(LPOVERLAPPED)0x0);
    if (BVar4 == 0) {
      local_410 = GetLastError();
    }
    else {
      local_410 = 0;
      local_41c = local_424;
    }
LAB_10033f99:
    if (local_41c != 0) goto LAB_10034037;
    if (local_410 != 0) {
      if (local_410 == 5) {
        piVar5 = FUN_1003366f();
        *piVar5 = 9;
        puVar6 = FUN_10033678();
        *puVar6 = 5;
      }
      else {
        __dosmaperr(local_410);
      }
      goto LAB_10034037;
    }
  }
  else {
    local_418 = param_2;
    local_410 = 0;
    if (param_3 != 0) {
      do {
        uVar7 = (int)local_418 - (int)param_2;
        pcVar3 = local_40c;
        local_414 = 0;
        do {
          if (param_3 <= uVar7) break;
          pcVar1 = local_418 + 1;
          cVar2 = *local_418;
          uVar7 = uVar7 + 1;
          if (cVar2 == '\n') {
            local_420 = local_420 + 1;
            *pcVar3 = '\r';
            pcVar3 = pcVar3 + 1;
            local_414 = local_414 + 1;
          }
          *pcVar3 = cVar2;
          pcVar3 = pcVar3 + 1;
          local_414 = local_414 + 1;
          local_418 = pcVar1;
        } while (local_414 < 0x400);
        BVar4 = WriteFile(*(HANDLE *)(*piVar5 + iVar8),local_40c,(int)pcVar3 - (int)local_40c,
                          &local_424,(LPOVERLAPPED)0x0);
        if (BVar4 == 0) {
          local_410 = GetLastError();
          goto LAB_10033f99;
        }
        local_41c = local_41c + local_424;
        if (((int)local_424 < (int)pcVar3 - (int)local_40c) ||
           (param_3 <= (uint)((int)local_418 - (int)param_2))) goto LAB_10033f99;
      } while( true );
    }
  }
  if (((*(byte *)(*piVar5 + 4 + iVar8) & 0x40) == 0) || (*param_2 != '\x1a')) {
    piVar5 = FUN_1003366f();
    *piVar5 = 0x1c;
    puVar6 = FUN_10033678();
    *puVar6 = 0;
  }
LAB_10034037:
  FUN_1002d447(local_8);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __write
// 
// Library: Visual Studio 2003 Release

int __cdecl __write(int _FileHandle,void *_Buf,uint _MaxCharCount)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  int local_20;
  
  if ((uint)_FileHandle < DAT_100535c4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_1003366f();
        *piVar1 = 9;
        puVar2 = FUN_10033678();
        *puVar2 = 0;
        local_20 = -1;
      }
      else {
        local_20 = __write_lk(_FileHandle,(char *)_Buf,_MaxCharCount);
      }
      FUN_100340d2();
      return local_20;
    }
  }
  piVar1 = FUN_1003366f();
  *piVar1 = 9;
  puVar2 = FUN_10033678();
  *puVar2 = 0;
  return -1;
}



void FUN_100340d2(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __commit
// 
// Library: Visual Studio 2003 Release

int __cdecl __commit(int _FileHandle)

{
  HANDLE hFile;
  BOOL BVar1;
  ulong *puVar2;
  int *piVar3;
  int iVar4;
  DWORD local_20;
  
  if (DAT_100535c4 <= (uint)_FileHandle) {
LAB_1003419e:
    piVar3 = FUN_1003366f();
    *piVar3 = 9;
    return -1;
  }
  iVar4 = (_FileHandle & 0x1fU) * 0x24;
  if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar4) & 1) == 0) goto LAB_1003419e;
  __lock_fhandle(_FileHandle);
  if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar4) & 1) != 0) {
    hFile = (HANDLE)__get_osfhandle(_FileHandle);
    BVar1 = FlushFileBuffers(hFile);
    if (BVar1 == 0) {
      local_20 = GetLastError();
    }
    else {
      local_20 = 0;
    }
    if (local_20 == 0) goto LAB_10034185;
    puVar2 = FUN_10033678();
    *puVar2 = local_20;
  }
  piVar3 = FUN_1003366f();
  *piVar3 = 9;
  local_20 = 0xffffffff;
LAB_10034185:
  FUN_10034196();
  return local_20;
}



void FUN_10034196(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// Library Function - Single Match
//  _strlen
// 
// Library: Visual Studio

size_t __cdecl _strlen(char *_Str)

{
  uint uVar1;
  uint *puVar2;
  uint *puVar3;
  
  uVar1 = (uint)_Str & 3;
  puVar2 = (uint *)_Str;
  while (uVar1 != 0) {
    uVar1 = *puVar2;
    puVar2 = (uint *)((int)puVar2 + 1);
    if ((char)uVar1 == '\0') goto LAB_10034223;
    uVar1 = (uint)puVar2 & 3;
  }
  do {
    do {
      puVar3 = puVar2;
      puVar2 = puVar3 + 1;
    } while (((*puVar3 ^ 0xffffffff ^ *puVar3 + 0x7efefeff) & 0x81010100) == 0);
    uVar1 = *puVar3;
    if ((char)uVar1 == '\0') {
      return (int)puVar3 - (int)_Str;
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (size_t)((int)puVar3 + (1 - (int)_Str));
    }
    if ((uVar1 & 0xff0000) == 0) {
      return (size_t)((int)puVar3 + (2 - (int)_Str));
    }
  } while ((uVar1 & 0xff000000) != 0);
LAB_10034223:
  return (size_t)((int)puVar2 + (-1 - (int)_Str));
}



// Library Function - Single Match
//  __read_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __read_lk(uint param_1,char *param_2,char *param_3)

{
  byte *pbVar1;
  char *pcVar2;
  byte bVar3;
  char cVar4;
  BOOL BVar5;
  DWORD DVar6;
  int *piVar7;
  ulong *puVar8;
  char *pcVar9;
  int iVar10;
  DWORD local_10;
  char *local_c;
  char local_5;
  
  local_c = (char *)0x0;
  if (param_3 != (char *)0x0) {
    piVar7 = &DAT_100535e0 + ((int)param_1 >> 5);
    iVar10 = (param_1 & 0x1f) * 0x24;
    bVar3 = *(byte *)(*piVar7 + iVar10 + 4);
    if ((bVar3 & 2) == 0) {
      pcVar9 = param_2;
      if (((bVar3 & 0x48) != 0) && (*(char *)(*piVar7 + iVar10 + 5) != '\n')) {
        param_3 = param_3 + -1;
        *param_2 = *(char *)(*piVar7 + 5 + iVar10);
        pcVar9 = param_2 + 1;
        local_c = (char *)0x1;
        *(undefined1 *)(*piVar7 + 5 + iVar10) = 10;
      }
      BVar5 = ReadFile(*(HANDLE *)(*piVar7 + iVar10),pcVar9,(DWORD)param_3,&local_10,
                       (LPOVERLAPPED)0x0);
      if (BVar5 == 0) {
        DVar6 = GetLastError();
        if (DVar6 == 5) {
          piVar7 = FUN_1003366f();
          *piVar7 = 9;
          puVar8 = FUN_10033678();
          *puVar8 = 5;
        }
        else {
          if (DVar6 == 0x6d) {
            return 0;
          }
          __dosmaperr(DVar6);
        }
        return -1;
      }
      if ((*(byte *)(*piVar7 + 4 + iVar10) & 0x80) == 0) {
        return (int)local_c + local_10;
      }
      if ((local_10 == 0) || (*param_2 != '\n')) {
        pbVar1 = (byte *)(*piVar7 + 4 + iVar10);
        *pbVar1 = *pbVar1 & 0xfb;
      }
      else {
        pbVar1 = (byte *)(*piVar7 + 4 + iVar10);
        *pbVar1 = *pbVar1 | 4;
      }
      local_c = param_2 + (int)local_c + local_10;
      param_3 = param_2;
      pcVar9 = param_2;
      if (param_2 < local_c) {
        do {
          cVar4 = *param_3;
          if (cVar4 == '\x1a') {
            if ((*(byte *)(*piVar7 + 4 + iVar10) & 0x40) == 0) {
              pbVar1 = (byte *)(*piVar7 + 4 + iVar10);
              *pbVar1 = *pbVar1 | 2;
            }
            break;
          }
          if (cVar4 == '\r') {
            if (param_3 < local_c + -1) {
              if (param_3[1] == '\n') {
                pcVar2 = param_3 + 2;
                goto LAB_100343d8;
              }
LAB_100343f2:
              param_3 = param_3 + 1;
              *pcVar9 = '\r';
            }
            else {
              pcVar2 = param_3 + 1;
              BVar5 = ReadFile(*(HANDLE *)(*piVar7 + iVar10),&local_5,1,&local_10,(LPOVERLAPPED)0x0)
              ;
              if (((BVar5 == 0) && (DVar6 = GetLastError(), DVar6 != 0)) || (local_10 == 0))
              goto LAB_100343f2;
              if ((*(byte *)(*piVar7 + 4 + iVar10) & 0x48) == 0) {
                if ((pcVar9 == param_2) && (local_5 == '\n')) goto LAB_100343d8;
                __lseek_lk(param_1,-1,1);
                if (local_5 == '\n') goto LAB_100343f6;
                goto LAB_100343f2;
              }
              if (local_5 == '\n') {
LAB_100343d8:
                param_3 = pcVar2;
                *pcVar9 = '\n';
              }
              else {
                *pcVar9 = '\r';
                *(char *)(*piVar7 + 5 + iVar10) = local_5;
                param_3 = pcVar2;
              }
            }
            pcVar9 = pcVar9 + 1;
            pcVar2 = param_3;
          }
          else {
            *pcVar9 = cVar4;
            pcVar9 = pcVar9 + 1;
            pcVar2 = param_3 + 1;
          }
LAB_100343f6:
          param_3 = pcVar2;
        } while (param_3 < local_c);
      }
      return (int)pcVar9 - (int)param_2;
    }
  }
  return 0;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __read
// 
// Library: Visual Studio 2003 Release

int __cdecl __read(int _FileHandle,void *_DstBuf,uint _MaxCharCount)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  int local_20;
  
  if ((uint)_FileHandle < DAT_100535c4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_1003366f();
        *piVar1 = 9;
        puVar2 = FUN_10033678();
        *puVar2 = 0;
        local_20 = -1;
      }
      else {
        local_20 = __read_lk(_FileHandle,(char *)_DstBuf,(char *)_MaxCharCount);
      }
      FUN_100344ad();
      return local_20;
    }
  }
  piVar1 = FUN_1003366f();
  *piVar1 = 9;
  puVar2 = FUN_10033678();
  *puVar2 = 0;
  return -1;
}



void FUN_100344ad(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  ___crtLCMapStringA
// 
// Library: Visual Studio 2003 Release

int __cdecl
___crtLCMapStringA(_locale_t _Plocinfo,LPCWSTR _LocaleName,DWORD _DwMapFlag,LPCSTR _LpSrcStr,
                  int _CchSrc,LPSTR _LpDestStr,int _CchDest,int _Code_page,BOOL _BError)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  DWORD DVar4;
  int iVar5;
  undefined1 *puVar6;
  int iVar7;
  UINT UVar8;
  LPCSTR pCVar9;
  undefined1 *puVar10;
  undefined1 *puVar11;
  undefined1 *puVar12;
  undefined1 *puVar13;
  char *pcVar14;
  undefined4 uStackY_74;
  uint local_4c;
  LPCSTR local_2c;
  size_t local_28;
  undefined1 *local_24;
  undefined1 *local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_1003fa58;
  uStack_c = 0x100344dd;
  if (DAT_1005323c == 0) {
    uStackY_74 = 0x100344fe;
    iVar3 = LCMapStringW(0,0x100,L"",1,(LPWSTR)0x0,0);
    if (iVar3 == 0) {
      DVar4 = GetLastError();
      if (DVar4 == 0x78) {
        DAT_1005323c = 2;
      }
    }
    else {
      DAT_1005323c = 1;
    }
  }
  pcVar14 = (char *)_DwMapFlag;
  pCVar9 = _LpSrcStr;
  if (0 < (int)_LpSrcStr) {
    do {
      pCVar9 = pCVar9 + -1;
      if (*pcVar14 == '\0') goto LAB_10034537;
      pcVar14 = pcVar14 + 1;
    } while (pCVar9 != (LPCSTR)0x0);
    pCVar9 = (LPCSTR)0xffffffff;
LAB_10034537:
    _LpSrcStr = _LpSrcStr + (-1 - (int)pCVar9);
  }
  if ((DAT_1005323c != 2) && (DAT_1005323c != 0)) {
    if (DAT_1005323c == 1) {
      iVar3 = 0;
      bVar2 = false;
      bVar1 = false;
      if (_CchDest == 0) {
        _CchDest = DAT_100532c4;
      }
      uStackY_74 = 0x10034597;
      iVar5 = MultiByteToWideChar(_CchDest,(uint)(_Code_page != 0) * 8 + 1,(LPCSTR)_DwMapFlag,
                                  (int)_LpSrcStr,(LPWSTR)0x0,0);
      if (iVar5 != 0) {
        puVar6 = (undefined1 *)(iVar5 * 2 + 3U & 0xfffffffc);
        iVar7 = -(int)puVar6;
        local_1c = &stack0xffffffa8 + iVar7;
        local_20 = &stack0xffffffa8 + iVar7;
        local_8 = (undefined *)0xffffffff;
        if (&stack0xffffffa8 == puVar6) {
          *(int *)(&stack0xffffffa4 + iVar7) = iVar5 * 2;
          *(undefined4 *)(&stack0xffffffa0 + iVar7) = 0x100345f0;
          local_20 = (undefined1 *)_malloc(*(size_t *)(&stack0xffffffa4 + iVar7));
          if (local_20 == (undefined1 *)0x0) {
            return 0;
          }
          bVar2 = true;
        }
        *(int *)(&stack0xffffffa4 + iVar7) = iVar5;
        *(undefined1 **)(&stack0xffffffa0 + iVar7) = local_20;
        *(LPCSTR *)(&stack0xffffff9c + iVar7) = _LpSrcStr;
        *(DWORD *)(&stack0xffffff98 + iVar7) = _DwMapFlag;
        *(undefined4 *)(&stack0xffffff94 + iVar7) = 1;
        *(int *)(&stack0xffffff90 + iVar7) = _CchDest;
        puVar10 = (undefined1 *)((int)&uStackY_74 + iVar7);
        *(undefined4 *)((int)&uStackY_74 + iVar7) = 0x10034618;
        iVar7 = MultiByteToWideChar(*(UINT *)(&stack0xffffff90 + iVar7),
                                    *(DWORD *)(&stack0xffffff94 + iVar7),
                                    *(LPCSTR *)(&stack0xffffff98 + iVar7),
                                    *(int *)(&stack0xffffff9c + iVar7),
                                    *(LPWSTR *)(&stack0xffffffa0 + iVar7),
                                    *(int *)(&stack0xffffffa4 + iVar7));
        puVar6 = puVar10;
        if (iVar7 != 0) {
          *(undefined4 *)(puVar10 + -4) = 0;
          *(undefined4 *)(puVar10 + -8) = 0;
          *(int *)(puVar10 + -0xc) = iVar5;
          *(undefined1 **)(puVar10 + -0x10) = local_20;
          *(LPCWSTR *)(puVar10 + -0x14) = _LocaleName;
          *(_locale_t *)(puVar10 + -0x18) = _Plocinfo;
          puVar11 = puVar10 + -0x1c;
          *(undefined4 *)(puVar10 + -0x1c) = 0x10034632;
          iVar3 = LCMapStringW(*(LCID *)(puVar10 + -0x18),*(DWORD *)(puVar10 + -0x14),
                               *(LPCWSTR *)(puVar10 + -0x10),*(int *)(puVar10 + -0xc),
                               *(LPWSTR *)(puVar10 + -8),*(int *)(puVar10 + -4));
          puVar6 = puVar11;
          if (iVar3 != 0) {
            if (((uint)_LocaleName & 0x400) == 0) {
              puVar6 = (undefined1 *)(iVar3 * 2 + 3U & 0xfffffffc);
              *(undefined4 *)(puVar11 + -4) = 0x10034687;
              iVar7 = -(int)puVar6;
              local_1c = puVar11 + iVar7;
              local_24 = puVar11 + iVar7;
              local_8 = (undefined *)0xffffffff;
              if (puVar11 == puVar6) {
                *(int *)(puVar11 + iVar7 + -4) = iVar3 * 2;
                *(undefined4 *)(puVar11 + iVar7 + -8) = 0x100346be;
                local_24 = (undefined1 *)_malloc(*(size_t *)(puVar11 + iVar7 + -4));
                puVar6 = puVar11 + iVar7;
                if (local_24 == (undefined1 *)0x0) goto LAB_10034706;
                bVar1 = true;
              }
              *(int *)(puVar11 + iVar7 + -4) = iVar3;
              *(undefined1 **)(puVar11 + iVar7 + -8) = local_24;
              *(int *)(puVar11 + iVar7 + -0xc) = iVar5;
              *(undefined1 **)(puVar11 + iVar7 + -0x10) = local_20;
              *(LPCWSTR *)(puVar11 + iVar7 + -0x14) = _LocaleName;
              *(_locale_t *)(puVar11 + iVar7 + -0x18) = _Plocinfo;
              puVar13 = puVar11 + iVar7 + -0x1c;
              *(undefined4 *)(puVar11 + iVar7 + -0x1c) = 0x100346e1;
              iVar5 = LCMapStringW(*(LCID *)(puVar11 + iVar7 + -0x18),
                                   *(DWORD *)(puVar11 + iVar7 + -0x14),
                                   *(LPCWSTR *)(puVar11 + iVar7 + -0x10),
                                   *(int *)(puVar11 + iVar7 + -0xc),
                                   *(LPWSTR *)(puVar11 + iVar7 + -8),*(int *)(puVar11 + iVar7 + -4))
              ;
              puVar6 = puVar13;
              if (iVar5 != 0) {
                *(undefined4 *)(puVar13 + -4) = 0;
                *(undefined4 *)(puVar13 + -8) = 0;
                if (_LpDestStr == (LPSTR)0x0) {
                  *(undefined4 *)(puVar13 + -0xc) = 0;
                  *(undefined4 *)(puVar13 + -0x10) = 0;
                }
                else {
                  *(LPSTR *)(puVar13 + -0xc) = _LpDestStr;
                  *(int *)(puVar13 + -0x10) = _CchSrc;
                }
                *(int *)(puVar13 + -0x14) = iVar3;
                *(undefined1 **)(puVar13 + -0x18) = local_24;
                *(undefined4 *)(puVar13 + -0x1c) = 0;
                *(int *)(puVar13 + -0x20) = _CchDest;
                puVar6 = puVar13 + -0x24;
                *(undefined4 *)(puVar13 + -0x24) = 0x10034704;
                iVar3 = WideCharToMultiByte(*(UINT *)(puVar13 + -0x20),*(DWORD *)(puVar13 + -0x1c),
                                            *(LPCWSTR *)(puVar13 + -0x18),*(int *)(puVar13 + -0x14),
                                            *(LPSTR *)(puVar13 + -0x10),*(int *)(puVar13 + -0xc),
                                            *(LPCSTR *)(puVar13 + -8),*(LPBOOL *)(puVar13 + -4));
              }
            }
            else if ((_LpDestStr != (LPSTR)0x0) && (iVar3 <= (int)_LpDestStr)) {
              *(LPSTR *)(puVar11 + -4) = _LpDestStr;
              *(int *)(puVar11 + -8) = _CchSrc;
              *(int *)(puVar11 + -0xc) = iVar5;
              *(undefined1 **)(puVar11 + -0x10) = local_20;
              *(LPCWSTR *)(puVar11 + -0x14) = _LocaleName;
              *(_locale_t *)(puVar11 + -0x18) = _Plocinfo;
              puVar12 = puVar11 + -0x1c;
              *(undefined4 *)(puVar11 + -0x1c) = 0x1003466d;
              LCMapStringW(*(LCID *)(puVar11 + -0x18),*(DWORD *)(puVar11 + -0x14),
                           *(LPCWSTR *)(puVar11 + -0x10),*(int *)(puVar11 + -0xc),
                           *(LPWSTR *)(puVar11 + -8),*(int *)(puVar11 + -4));
              puVar6 = puVar12;
            }
          }
        }
LAB_10034706:
        if (bVar1) {
          *(undefined1 **)(puVar6 + -4) = local_24;
          *(undefined4 *)(puVar6 + -8) = 0x10034713;
          _free(*(void **)(puVar6 + -4));
        }
        if (bVar2) {
          *(undefined1 **)(puVar6 + -4) = local_20;
          *(undefined4 *)(puVar6 + -8) = 0x10034721;
          _free(*(void **)(puVar6 + -4));
          return iVar3;
        }
        return iVar3;
      }
    }
    return 0;
  }
  local_2c = (LPCSTR)0x0;
  pcVar14 = (char *)0x0;
  bVar1 = false;
  if (_Plocinfo == (_locale_t)0x0) {
    _Plocinfo = DAT_100532b4;
  }
  if (_CchDest == 0) {
    _CchDest = DAT_100532c4;
  }
  UVar8 = ___ansicp((LCID)_Plocinfo);
  if (UVar8 == 0xffffffff) {
    return 0;
  }
  if (UVar8 == _CchDest) {
    uStackY_74 = 0x10034872;
    local_4c = LCMapStringA((LCID)_Plocinfo,(DWORD)_LocaleName,(LPCSTR)_DwMapFlag,(int)_LpSrcStr,
                            (LPSTR)_CchSrc,(int)_LpDestStr);
    goto LAB_10034874;
  }
  uStackY_74 = 0x1003477e;
  local_2c = (LPCSTR)___convertcp(_CchDest,UVar8,(char *)_DwMapFlag,(size_t *)&_LpSrcStr,(LPSTR)0x0,
                                  0);
  if (local_2c == (LPCSTR)0x0) {
    return 0;
  }
  uStackY_74 = 0x1003479a;
  local_28 = LCMapStringA((LCID)_Plocinfo,(DWORD)_LocaleName,local_2c,(int)_LpSrcStr,(LPSTR)0x0,0);
  if (local_28 != 0) {
    local_8 = (undefined *)0x0;
    local_1c = &stack0xffffffa8;
    pcVar14 = &stack0xffffffa8;
    _memset(&stack0xffffffa8,0,local_28);
    local_8 = (undefined *)0xffffffff;
    if (&stack0x00000000 == (undefined1 *)0x58) {
      pcVar14 = (char *)_malloc(local_28);
      if (pcVar14 != (char *)0x0) {
        _memset(pcVar14,0,local_28);
        bVar1 = true;
        goto LAB_10034805;
      }
    }
    else {
LAB_10034805:
      uStackY_74 = 0x1003481b;
      local_28 = LCMapStringA((LCID)_Plocinfo,(DWORD)_LocaleName,local_2c,(int)_LpSrcStr,pcVar14,
                              local_28);
      if (local_28 != 0) {
        uStackY_74 = 0x1003483c;
        iVar3 = ___convertcp(UVar8,_CchDest,pcVar14,&local_28,(LPSTR)_CchSrc,(int)_LpDestStr);
        local_4c = (uint)(iVar3 != 0);
        goto LAB_1003484c;
      }
    }
    local_4c = 0;
  }
LAB_1003484c:
  if (bVar1) {
    _free(pcVar14);
  }
LAB_10034874:
  if (local_2c != (LPCSTR)0x0) {
    _free(local_2c);
    return local_4c;
  }
  return local_4c;
}



// Library Function - Single Match
//  __lseek_lk
// 
// Library: Visual Studio 2003 Release

DWORD __cdecl __lseek_lk(uint param_1,LONG param_2,DWORD param_3)

{
  byte *pbVar1;
  HANDLE hFile;
  int *piVar2;
  DWORD DVar3;
  ulong uVar4;
  
  hFile = (HANDLE)__get_osfhandle(param_1);
  if (hFile == (HANDLE)0xffffffff) {
    piVar2 = FUN_1003366f();
    *piVar2 = 9;
    return 0xffffffff;
  }
  DVar3 = SetFilePointer(hFile,param_2,(PLONG)0x0,param_3);
  if (DVar3 == 0xffffffff) {
    uVar4 = GetLastError();
  }
  else {
    uVar4 = 0;
  }
  if (uVar4 == 0) {
    pbVar1 = (byte *)((&DAT_100535e0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
    *pbVar1 = *pbVar1 & 0xfd;
  }
  else {
    __dosmaperr(uVar4);
    DVar3 = 0xffffffff;
  }
  return DVar3;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __lseek
// 
// Library: Visual Studio 2003 Release

long __cdecl __lseek(int _FileHandle,long _Offset,int _Origin)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  DWORD local_20;
  
  if ((uint)_FileHandle < DAT_100535c4) {
    iVar3 = (_FileHandle & 0x1fU) * 0x24;
    if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) != 0) {
      __lock_fhandle(_FileHandle);
      if ((*(byte *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + iVar3) & 1) == 0) {
        piVar1 = FUN_1003366f();
        *piVar1 = 9;
        puVar2 = FUN_10033678();
        *puVar2 = 0;
        local_20 = 0xffffffff;
      }
      else {
        local_20 = __lseek_lk(_FileHandle,_Offset,_Origin);
      }
      FUN_10034988();
      return local_20;
    }
  }
  piVar1 = FUN_1003366f();
  *piVar1 = 9;
  puVar2 = FUN_10033678();
  *puVar2 = 0;
  return -1;
}



void FUN_10034988(void)

{
  int unaff_EBX;
  
  __unlock_fhandle(unaff_EBX);
  return;
}



// Library Function - Single Match
//  __ZeroTail
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __ZeroTail(int param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  
  iVar2 = param_2 / 0x20;
  uVar1 = *(uint *)(param_1 + iVar2 * 4) & ~(-1 << (0x1fU - (char)(param_2 % 0x20) & 0x1f));
  while( true ) {
    if (uVar1 != 0) {
      return 0;
    }
    iVar2 = iVar2 + 1;
    if (2 < iVar2) break;
    uVar1 = *(uint *)(param_1 + iVar2 * 4);
  }
  return 1;
}



// Library Function - Single Match
//  __IncMan
// 
// Library: Visual Studio 2003 Release

void __cdecl __IncMan(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  uint *puVar3;
  
  puVar3 = (uint *)(param_1 + (param_2 / 0x20) * 4);
  iVar1 = ___addl(*puVar3,1 << (0x1fU - (char)(param_2 % 0x20) & 0x1f),puVar3);
  iVar2 = param_2 / 0x20 + -1;
  if (-1 < iVar2) {
    puVar3 = (uint *)(param_1 + iVar2 * 4);
    do {
      if (iVar1 == 0) {
        return;
      }
      iVar1 = ___addl(*puVar3,1,puVar3);
      iVar2 = iVar2 + -1;
      puVar3 = puVar3 + -1;
    } while (-1 < iVar2);
  }
  return;
}



// Library Function - Single Match
//  __RoundMan
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __RoundMan(int param_1,int param_2)

{
  uint *puVar1;
  int iVar2;
  int iVar3;
  byte bVar4;
  undefined4 *puVar5;
  undefined4 local_8;
  
  local_8 = 0;
  iVar2 = param_2 / 0x20;
  bVar4 = 0x1f - (char)(param_2 % 0x20);
  if (((*(uint *)(param_1 + iVar2 * 4) & 1 << (bVar4 & 0x1f)) != 0) &&
     (iVar3 = __ZeroTail(param_1,param_2), iVar3 == 0)) {
    local_8 = __IncMan(param_1,param_2 + -1);
  }
  puVar1 = (uint *)(param_1 + iVar2 * 4);
  *puVar1 = *puVar1 & -1 << (bVar4 & 0x1f);
  iVar2 = iVar2 + 1;
  if (iVar2 < 3) {
    puVar5 = (undefined4 *)(param_1 + iVar2 * 4);
    for (iVar3 = 3 - iVar2; iVar3 != 0; iVar3 = iVar3 + -1) {
      *puVar5 = 0;
      puVar5 = puVar5 + 1;
    }
  }
  return local_8;
}



// Library Function - Single Match
//  __CopyMan
// 
// Library: Visual Studio 2003 Release

void __cdecl __CopyMan(int param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = 3;
  iVar1 = param_1 - (int)param_2;
  do {
    *(undefined4 *)(iVar1 + (int)param_2) = *param_2;
    param_2 = param_2 + 1;
    iVar2 = iVar2 + -1;
  } while (iVar2 != 0);
  return;
}



// Library Function - Single Match
//  __IsZeroMan
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __IsZeroMan(int param_1)

{
  int iVar1;
  
  iVar1 = 0;
  do {
    if (*(int *)(param_1 + iVar1 * 4) != 0) {
      return 0;
    }
    iVar1 = iVar1 + 1;
  } while (iVar1 < 3);
  return 1;
}



// Library Function - Single Match
//  __ShrMan
// 
// Library: Visual Studio 2003 Release

void __cdecl __ShrMan(int param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  byte bVar3;
  undefined4 *puVar4;
  uint local_8;
  
  bVar3 = (byte)(param_2 % 0x20);
  iVar2 = 0;
  local_8 = 0;
  do {
    uVar1 = *(uint *)(param_1 + iVar2 * 4);
    *(uint *)(param_1 + iVar2 * 4) = uVar1 >> (bVar3 & 0x1f) | local_8;
    local_8 = (uVar1 & ~(-1 << (bVar3 & 0x1f))) << (0x20 - bVar3 & 0x1f);
    iVar2 = iVar2 + 1;
  } while (iVar2 < 3);
  iVar2 = 2;
  puVar4 = (undefined4 *)(param_1 + (2 - param_2 / 0x20) * 4);
  do {
    if (iVar2 < param_2 / 0x20) {
      *(undefined4 *)(param_1 + iVar2 * 4) = 0;
    }
    else {
      *(undefined4 *)(param_1 + iVar2 * 4) = *puVar4;
    }
    iVar2 = iVar2 + -1;
    puVar4 = puVar4 + -1;
  } while (-1 < iVar2);
  return;
}



// Library Function - Single Match
//  __ld12cvt
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __ld12cvt(ushort *param_1,uint *param_2,int *param_3)

{
  ushort uVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  undefined4 local_1c [3];
  uint local_10;
  uint local_c;
  int local_8;
  
  uVar1 = param_1[5];
  local_10 = *(uint *)(param_1 + 3);
  local_c = *(uint *)(param_1 + 1);
  local_8 = (uint)*param_1 << 0x10;
  uVar4 = uVar1 & 0x7fff;
  iVar5 = uVar4 - 0x3fff;
  if (iVar5 == -0x3fff) {
    iVar5 = 0;
    iVar2 = __IsZeroMan((int)&local_10);
    if (iVar2 != 0) {
LAB_10034c64:
      uVar3 = 0;
      goto LAB_10034c66;
    }
    local_10 = 0;
    local_c = 0;
  }
  else {
    __CopyMan((int)local_1c,&local_10);
    iVar2 = __RoundMan((int)&local_10,param_3[2]);
    if (iVar2 != 0) {
      iVar5 = uVar4 - 0x3ffe;
    }
    iVar2 = param_3[1];
    if (iVar5 < iVar2 - param_3[2]) {
      local_10 = 0;
      local_c = 0;
    }
    else {
      if (iVar2 < iVar5) {
        if (*param_3 <= iVar5) {
          local_c = 0;
          local_8 = 0;
          local_10 = 0x80000000;
          __ShrMan((int)&local_10,param_3[3]);
          iVar5 = param_3[5] + *param_3;
          uVar3 = 1;
          goto LAB_10034c66;
        }
        local_10 = local_10 & 0x7fffffff;
        iVar5 = param_3[5] + iVar5;
        __ShrMan((int)&local_10,param_3[3]);
        goto LAB_10034c64;
      }
      __CopyMan((int)&local_10,local_1c);
      __ShrMan((int)&local_10,iVar2 - iVar5);
      __RoundMan((int)&local_10,param_3[2]);
      __ShrMan((int)&local_10,param_3[3] + 1);
    }
  }
  iVar5 = 0;
  uVar3 = 2;
LAB_10034c66:
  local_10 = iVar5 << (0x1fU - (char)param_3[3] & 0x1f) |
             -(uint)((uVar1 & 0x8000) != 0) & 0x80000000 | local_10;
  if (param_3[4] == 0x40) {
    param_2[1] = local_10;
    *param_2 = local_c;
  }
  else if (param_3[4] == 0x20) {
    *param_2 = local_10;
  }
  return uVar3;
}



// Library Function - Multiple Matches With Different Base Names
//  __ld12tod
//  __ld12tof
// 
// Library: Visual Studio 2003 Release

INTRNCVT_STATUS __cdecl FID_conflict___ld12tod(_LDBL12 *_Ifp,_CRT_DOUBLE *_D)

{
  INTRNCVT_STATUS IVar1;
  
  IVar1 = __ld12cvt((ushort *)_Ifp,(uint *)_D,(int *)&DAT_10041ebc);
  return IVar1;
}



// Library Function - Multiple Matches With Different Base Names
//  __ld12tod
//  __ld12tof
// 
// Library: Visual Studio 2003 Release

INTRNCVT_STATUS __cdecl FID_conflict___ld12tod(_LDBL12 *_Ifp,_CRT_DOUBLE *_D)

{
  INTRNCVT_STATUS IVar1;
  
  IVar1 = __ld12cvt((ushort *)_Ifp,(uint *)_D,(int *)&DAT_10041ed4);
  return IVar1;
}



// Library Function - Multiple Matches With Different Base Names
//  __atodbl
//  __atoflt
// 
// Library: Visual Studio 2003 Release

int __cdecl FID_conflict___atodbl(_CRT_FLOAT *_Result,char *_Str)

{
  int iVar1;
  char *local_18;
  _LDBL12 local_14;
  int local_8;
  
  local_8 = DAT_10041558;
  ___strgtold12(&local_14,&local_18,_Str,0,0,0,0);
  FID_conflict___ld12tod(&local_14,(_CRT_DOUBLE *)_Result);
  iVar1 = FUN_1002d447(local_8);
  return iVar1;
}



// Library Function - Multiple Matches With Different Base Names
//  __atodbl
//  __atoflt
// 
// Library: Visual Studio 2003 Release

int __cdecl FID_conflict___atodbl(_CRT_FLOAT *_Result,char *_Str)

{
  int iVar1;
  char *local_18;
  _LDBL12 local_14;
  int local_8;
  
  local_8 = DAT_10041558;
  ___strgtold12(&local_14,&local_18,_Str,0,0,0,0);
  FID_conflict___ld12tod(&local_14,(_CRT_DOUBLE *)_Result);
  iVar1 = FUN_1002d447(local_8);
  return iVar1;
}



uint * __cdecl FUN_10034d50(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  
  uVar3 = (uint)param_2 & 3;
  puVar4 = param_1;
  while (uVar3 != 0) {
    bVar1 = (byte)*param_2;
    uVar3 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_10034e40;
    *(byte *)puVar4 = bVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    uVar3 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar3 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar3 == '\0') {
LAB_10034e40:
        *(byte *)puVar4 = (byte)uVar3;
        return param_1;
      }
      if ((char)(uVar3 >> 8) == '\0') {
        *(short *)puVar4 = (short)uVar3;
        return param_1;
      }
      if ((uVar3 & 0xff0000) == 0) {
        *(short *)puVar4 = (short)uVar3;
        *(byte *)((int)puVar4 + 2) = 0;
        return param_1;
      }
      if ((uVar3 & 0xff000000) == 0) {
        *puVar4 = uVar3;
        return param_1;
      }
    }
    *puVar4 = uVar3;
    puVar4 = puVar4 + 1;
  } while( true );
}



uint * __cdecl FUN_10034d60(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar4 = (uint)param_1 & 3;
  puVar3 = param_1;
  while (uVar4 != 0) {
    uVar4 = *puVar3;
    puVar3 = (uint *)((int)puVar3 + 1);
    if ((byte)uVar4 == 0) goto LAB_10034db3;
    uVar4 = (uint)puVar3 & 3;
  }
  do {
    do {
      puVar5 = puVar3;
      puVar3 = puVar5 + 1;
    } while (((*puVar5 ^ 0xffffffff ^ *puVar5 + 0x7efefeff) & 0x81010100) == 0);
    uVar4 = *puVar5;
    if ((char)uVar4 == '\0') goto LAB_10034dc5;
    if ((char)(uVar4 >> 8) == '\0') {
      puVar5 = (uint *)((int)puVar5 + 1);
      goto LAB_10034dc5;
    }
    if ((uVar4 & 0xff0000) == 0) {
      puVar5 = (uint *)((int)puVar5 + 2);
      goto LAB_10034dc5;
    }
  } while ((uVar4 & 0xff000000) != 0);
LAB_10034db3:
  puVar5 = (uint *)((int)puVar3 + -1);
LAB_10034dc5:
  uVar4 = (uint)param_2 & 3;
  while (uVar4 != 0) {
    bVar1 = (byte)*param_2;
    uVar4 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_10034e40;
    *(byte *)puVar5 = bVar1;
    puVar5 = (uint *)((int)puVar5 + 1);
    uVar4 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar4 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar4 == '\0') {
LAB_10034e40:
        *(byte *)puVar5 = (byte)uVar4;
        return param_1;
      }
      if ((char)(uVar4 >> 8) == '\0') {
        *(short *)puVar5 = (short)uVar4;
        return param_1;
      }
      if ((uVar4 & 0xff0000) == 0) {
        *(short *)puVar5 = (short)uVar4;
        *(byte *)((int)puVar5 + 2) = 0;
        return param_1;
      }
      if ((uVar4 & 0xff000000) == 0) {
        *puVar5 = uVar4;
        return param_1;
      }
    }
    *puVar5 = uVar4;
    puVar5 = puVar5 + 1;
  } while( true );
}



// Library Function - Single Match
//  __fptostr
// 
// Library: Visual Studio 2003 Release

errno_t __cdecl __fptostr(char *_Buf,size_t _SizeInBytes,int _Digits,STRFLT _PtFlt)

{
  char *_Str;
  char *_Dst;
  char *pcVar1;
  size_t sVar2;
  char *pcVar3;
  char cVar4;
  
  _Dst = _Buf;
  pcVar3 = *(char **)(_Digits + 0xc);
  _Str = _Buf + 1;
  *_Buf = '0';
  pcVar1 = _Str;
  if (0 < (int)_SizeInBytes) {
    _Buf = (char *)_SizeInBytes;
    _SizeInBytes = 0;
    do {
      cVar4 = *pcVar3;
      if (cVar4 == '\0') {
        cVar4 = '0';
      }
      else {
        pcVar3 = pcVar3 + 1;
      }
      *pcVar1 = cVar4;
      pcVar1 = pcVar1 + 1;
      _Buf = _Buf + -1;
    } while (_Buf != (char *)0x0);
  }
  *pcVar1 = '\0';
  if ((-1 < (int)_SizeInBytes) && ('4' < *pcVar3)) {
    while (pcVar1 = pcVar1 + -1, *pcVar1 == '9') {
      *pcVar1 = '0';
    }
    *pcVar1 = *pcVar1 + '\x01';
  }
  if (*_Dst == '1') {
    *(int *)(_Digits + 4) = *(int *)(_Digits + 4) + 1;
  }
  else {
    sVar2 = _strlen(_Str);
    pcVar1 = (char *)_memmove(_Dst,_Str,sVar2 + 1);
  }
  return (errno_t)pcVar1;
}



// Library Function - Single Match
//  ___dtold
// 
// Library: Visual Studio 2003 Release

void __cdecl ___dtold(uint *param_1,uint *param_2)

{
  ushort uVar1;
  uint uVar2;
  ushort uVar3;
  ushort uVar4;
  uint local_8;
  
  uVar1 = *(ushort *)((int)param_2 + 6);
  local_8 = 0x80000000;
  uVar3 = uVar1 >> 4;
  uVar4 = uVar3 & 0x7ff;
  uVar2 = *param_2;
  if ((uVar3 & 0x7ff) == 0) {
    if (((param_2[1] & 0xfffff) == 0) && (uVar2 == 0)) {
      param_1[1] = 0;
      *param_1 = 0;
      *(undefined2 *)(param_1 + 2) = 0;
      return;
    }
    uVar4 = uVar4 + 0x3c01;
    local_8 = 0;
  }
  else if (uVar4 == 0x7ff) {
    uVar4 = 0x7fff;
  }
  else {
    uVar4 = uVar4 + 0x3c00;
  }
  param_1[1] = uVar2 >> 0x15 | (param_2[1] & 0xfffff) << 0xb | local_8;
  *param_1 = uVar2 << 0xb;
  while (local_8 == 0) {
    uVar2 = param_1[1];
    uVar4 = uVar4 - 1;
    param_1[1] = uVar2 << 1 | *param_1 >> 0x1f;
    *param_1 = *param_1 * 2;
    local_8 = uVar2 << 1 & 0x80000000;
  }
  *(ushort *)(param_1 + 2) = uVar1 & 0x8000 | uVar4;
  return;
}



// Library Function - Single Match
//  __fltout2
// 
// Library: Visual Studio 2003 Release

STRFLT __cdecl __fltout2(_CRT_DOUBLE _Dbl,STRFLT _Flt,char *_ResultStr,size_t _SizeInBytes)

{
  int iVar1;
  STRFLT p_Var2;
  undefined4 in_stack_ffffffb8;
  undefined2 uVar3;
  short local_30;
  char local_2e;
  uint local_2c [6];
  uint local_14;
  uint uStack_10;
  undefined2 uStack_c;
  int local_8;
  
  uVar3 = (undefined2)((uint)in_stack_ffffffb8 >> 0x10);
  local_8 = DAT_10041558;
  ___dtold(&local_14,(uint *)&_Dbl);
  iVar1 = _I10_OUTPUT(local_14,uStack_10,CONCAT22(uVar3,uStack_c),0x11,0,&local_30);
  _Flt->flag = iVar1;
  _Flt->sign = (int)local_2e;
  _Flt->decpt = (int)local_30;
  FUN_10034d50((uint *)_ResultStr,local_2c);
  _Flt->mantissa = _ResultStr;
  p_Var2 = (STRFLT)FUN_1002d447(local_8);
  return p_Var2;
}



// Library Function - Single Match
//  _memset
// 
// Libraries: Visual Studio 2003 Debug, Visual Studio 2003 Release, Visual Studio 2019 Release

void * __cdecl _memset(void *_Dst,int _Val,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  
  if (_Size == 0) {
    return _Dst;
  }
  uVar1 = _Val & 0xff;
  puVar4 = (uint *)_Dst;
  if (3 < _Size) {
    uVar2 = -(int)_Dst & 3;
    sVar3 = _Size;
    if (uVar2 != 0) {
      sVar3 = _Size - uVar2;
      do {
        *(undefined1 *)puVar4 = (undefined1)_Val;
        puVar4 = (uint *)((int)puVar4 + 1);
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    uVar1 = uVar1 * 0x1010101;
    _Size = sVar3 & 3;
    uVar2 = sVar3 >> 2;
    if (uVar2 != 0) {
      for (; uVar2 != 0; uVar2 = uVar2 - 1) {
        *puVar4 = uVar1;
        puVar4 = puVar4 + 1;
      }
      if (_Size == 0) {
        return _Dst;
      }
    }
  }
  do {
    *(char *)puVar4 = (char)uVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    _Size = _Size - 1;
  } while (_Size != 0);
  return _Dst;
}



// Library Function - Single Match
//  __fptrap
// 
// Library: Visual Studio 2003 Release

void __cdecl __fptrap(void)

{
  __amsg_exit(2);
  return;
}



// Library Function - Single Match
//  __abstract_cw
// 
// Library: Visual Studio 2003 Release

uint __abstract_cw(void)

{
  uint uVar1;
  ushort uVar2;
  ushort unaff_BX;
  
  uVar1 = 0;
  if ((unaff_BX & 1) != 0) {
    uVar1 = 0x10;
  }
  if ((unaff_BX & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((unaff_BX & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((unaff_BX & 0x10) != 0) {
    uVar1 = uVar1 | 2;
  }
  if ((unaff_BX & 0x20) != 0) {
    uVar1 = uVar1 | 1;
  }
  if ((unaff_BX & 2) != 0) {
    uVar1 = uVar1 | 0x80000;
  }
  uVar2 = unaff_BX & 0xc00;
  if ((unaff_BX & 0xc00) != 0) {
    if (uVar2 == 0x400) {
      uVar1 = uVar1 | 0x100;
    }
    else if (uVar2 == 0x800) {
      uVar1 = uVar1 | 0x200;
    }
    else if (uVar2 == 0xc00) {
      uVar1 = uVar1 | 0x300;
    }
  }
  if ((unaff_BX & 0x300) == 0) {
    uVar1 = uVar1 | 0x20000;
  }
  else if ((unaff_BX & 0x300) == 0x200) {
    uVar1 = uVar1 | 0x10000;
  }
  if ((unaff_BX & 0x1000) != 0) {
    uVar1 = uVar1 | 0x40000;
  }
  return uVar1;
}



// Library Function - Single Match
//  __hw_cw
// 
// Library: Visual Studio 2003 Release

uint __hw_cw(void)

{
  uint uVar1;
  uint uVar2;
  uint unaff_EBX;
  
  uVar1 = (uint)((unaff_EBX & 0x10) != 0);
  if ((unaff_EBX & 8) != 0) {
    uVar1 = uVar1 | 4;
  }
  if ((unaff_EBX & 4) != 0) {
    uVar1 = uVar1 | 8;
  }
  if ((unaff_EBX & 2) != 0) {
    uVar1 = uVar1 | 0x10;
  }
  if ((unaff_EBX & 1) != 0) {
    uVar1 = uVar1 | 0x20;
  }
  if ((unaff_EBX & 0x80000) != 0) {
    uVar1 = uVar1 | 2;
  }
  uVar2 = unaff_EBX & 0x300;
  if (uVar2 != 0) {
    if (uVar2 == 0x100) {
      uVar1 = uVar1 | 0x400;
    }
    else if (uVar2 == 0x200) {
      uVar1 = uVar1 | 0x800;
    }
    else if (uVar2 == 0x300) {
      uVar1 = uVar1 | 0xc00;
    }
  }
  if ((unaff_EBX & 0x30000) == 0) {
    uVar1 = uVar1 | 0x300;
  }
  else if ((unaff_EBX & 0x30000) == 0x10000) {
    uVar1 = uVar1 | 0x200;
  }
  if ((unaff_EBX & 0x40000) != 0) {
    uVar1 = uVar1 | 0x1000;
  }
  return uVar1;
}



// Library Function - Single Match
//  __control87
// 
// Library: Visual Studio 2003 Release

uint __cdecl __control87(uint _NewValue,uint _Mask)

{
  uint uVar1;
  
  uVar1 = __abstract_cw();
  __hw_cw();
  return uVar1 & ~_Mask | _NewValue & _Mask;
}



// Library Function - Single Match
//  __controlfp
// 
// Library: Visual Studio 2003 Release

uint __cdecl __controlfp(uint _NewValue,uint _Mask)

{
  uint uVar1;
  
  uVar1 = __control87(_NewValue,_Mask & 0xfff7ffff);
  return uVar1;
}



// Library Function - Single Match
//  ___crtInitCritSecNoSpinCount@8
// 
// Library: Visual Studio 2003 Release

undefined4 ___crtInitCritSecNoSpinCount_8(LPCRITICAL_SECTION param_1)

{
  InitializeCriticalSection(param_1);
  return 1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___crtInitCritSecAndSpinCount
// 
// Library: Visual Studio 2003 Release

void __cdecl ___crtInitCritSecAndSpinCount(undefined4 param_1,undefined4 param_2)

{
  HMODULE hModule;
  
  if (DAT_10053240 == (code *)0x0) {
    if (DAT_10053014 != 1) {
      hModule = GetModuleHandleA("kernel32.dll");
      if (hModule != (HMODULE)0x0) {
        DAT_10053240 = GetProcAddress(hModule,"InitializeCriticalSectionAndSpinCount");
        if (DAT_10053240 != (FARPROC)0x0) goto LAB_1003521d;
      }
    }
    DAT_10053240 = ___crtInitCritSecNoSpinCount_8;
  }
LAB_1003521d:
  (*DAT_10053240)(param_1,param_2);
  return;
}



// Library Function - Single Match
//  __ValidateEH3RN
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl __ValidateEH3RN(void *param_1)

{
  uint *puVar1;
  void *pvVar2;
  uint uVar3;
  void *pvVar4;
  uint *puVar5;
  SIZE_T SVar6;
  int *piVar7;
  LONG LVar8;
  uint *puVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  _MEMORY_BASIC_INFORMATION local_24;
  void *local_8;
  
  pvVar4 = param_1;
  puVar9 = *(uint **)((int)param_1 + 8);
  if ((((uint)puVar9 & 3) != 0) ||
     ((local_8 = StackLimit, StackLimit <= puVar9 && (puVar9 < StackBase)))) {
    return 0;
  }
  puVar1 = (uint *)((int)param_1 + 0xc);
  if (*puVar1 == 0xffffffff) {
    return 1;
  }
  uVar11 = 0;
  param_1 = (void *)0x0;
  puVar5 = puVar9;
  do {
    if ((*puVar5 != 0xffffffff) && (uVar11 <= *puVar5)) {
      return 0;
    }
    if (puVar5[1] != 0) {
      param_1 = (void *)((int)param_1 + 1);
    }
    uVar11 = uVar11 + 1;
    puVar5 = puVar5 + 3;
  } while (uVar11 <= *puVar1);
  if ((param_1 != (void *)0x0) &&
     ((pvVar2 = *(void **)((int)pvVar4 + -8), pvVar2 < StackLimit || (pvVar4 <= pvVar2)))) {
    return 0;
  }
  uVar11 = (uint)puVar9 & 0xfffff000;
  iVar14 = 0;
  if (0 < DAT_10053248) {
    do {
      if ((&DAT_10053250)[iVar14] == uVar11) {
        if (iVar14 < 1) {
          return 1;
        }
        LVar8 = InterlockedExchange((LONG *)&DAT_10053290,1);
        if (LVar8 != 0) {
          return 1;
        }
        if ((&DAT_10053250)[iVar14] == uVar11) goto LAB_10035457;
        iVar14 = DAT_10053248 + -1;
        if (iVar14 < 0) goto LAB_10035445;
        goto LAB_10035435;
      }
      iVar14 = iVar14 + 1;
    } while (iVar14 < DAT_10053248);
  }
  SVar6 = VirtualQuery(puVar9,&local_24,0x1c);
  if (SVar6 == 0) {
    return 0xffffffff;
  }
  if (local_24.Type != 0x1000000) {
    return 0xffffffff;
  }
  if (((byte)local_24.Protect & 0xcc) != 0) {
                    // WARNING: Load size is inaccurate
    if (((*local_24.AllocationBase != 0x5a4d) ||
        (piVar7 = (int *)(*(int *)((int)local_24.AllocationBase + 0x3c) +
                         (int)local_24.AllocationBase), *piVar7 != 0x4550)) ||
       ((short)piVar7[6] != 0x10b)) {
      return 0xffffffff;
    }
    uVar10 = (uint)*(ushort *)(piVar7 + 5);
    if (*(short *)((int)piVar7 + 6) == 0) {
      return 0xffffffff;
    }
    uVar3 = *(uint *)((int)piVar7 + uVar10 + 0x24);
    if (((uVar3 <= (uint)((int)puVar9 - (int)local_24.AllocationBase)) &&
        ((uint)((int)puVar9 - (int)local_24.AllocationBase) <
         *(int *)((int)piVar7 + uVar10 + 0x20) + uVar3)) &&
       ((*(byte *)((int)piVar7 + uVar10 + 0x3f) & 0x80) != 0)) {
      return 0;
    }
  }
  LVar8 = InterlockedExchange((LONG *)&DAT_10053290,1);
  iVar14 = DAT_10053248;
  if (LVar8 != 0) {
    return 1;
  }
  iVar12 = DAT_10053248;
  if (0 < DAT_10053248) {
    puVar9 = (uint *)(&DAT_1005324c + DAT_10053248 * 4);
    do {
      if (*puVar9 == uVar11) break;
      iVar12 = iVar12 + -1;
      puVar9 = puVar9 + -1;
    } while (0 < iVar12);
  }
  if (iVar12 == 0) {
    iVar12 = 0xf;
    if (DAT_10053248 < 0x10) {
      iVar12 = DAT_10053248;
    }
    iVar13 = 0;
    if (-1 < iVar12) {
      do {
        puVar9 = &DAT_10053250 + iVar13;
        uVar10 = *puVar9;
        iVar13 = iVar13 + 1;
        *puVar9 = uVar11;
        uVar11 = uVar10;
      } while (iVar13 <= iVar12);
    }
    if (iVar14 < 0x10) {
      DAT_10053248 = iVar14 + 1;
    }
  }
  InterlockedExchange((LONG *)&DAT_10053290,0);
  return 1;
  while (iVar14 = iVar14 + -1, -1 < iVar14) {
LAB_10035435:
    if ((&DAT_10053250)[iVar14] == uVar11) break;
  }
  if (iVar14 < 0) {
LAB_10035445:
    if (DAT_10053248 < 0x10) {
      DAT_10053248 = DAT_10053248 + 1;
    }
    iVar14 = DAT_10053248 + -1;
  }
  else if (iVar14 == 0) goto LAB_1003546f;
LAB_10035457:
  iVar12 = 0;
  if (-1 < iVar14) {
    do {
      puVar9 = &DAT_10053250 + iVar12;
      uVar10 = *puVar9;
      iVar12 = iVar12 + 1;
      *puVar9 = uVar11;
      uVar11 = uVar10;
    } while (iVar12 <= iVar14);
  }
LAB_1003546f:
  InterlockedExchange((LONG *)&DAT_10053290,0);
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address
// Library Function - Single Match
//  __getbuf
// 
// Library: Visual Studio 2003 Release

void __cdecl __getbuf(FILE *_File)

{
  char *pcVar1;
  
  _DAT_10052ea0 = _DAT_10052ea0 + 1;
  pcVar1 = (char *)_malloc(0x1000);
  _File->_base = pcVar1;
  if (pcVar1 == (char *)0x0) {
    _File->_flag = _File->_flag | 4;
    _File->_base = (char *)&_File->_charbuf;
    _File->_bufsiz = 2;
  }
  else {
    _File->_flag = _File->_flag | 8;
    _File->_bufsiz = 0x1000;
  }
  _File->_cnt = 0;
  _File->_ptr = _File->_base;
  return;
}



// Library Function - Single Match
//  __isatty
// 
// Library: Visual Studio 2003 Release

int __cdecl __isatty(int _FileHandle)

{
  if (DAT_100535c4 <= (uint)_FileHandle) {
    return 0;
  }
  return (int)*(char *)((&DAT_100535e0)[_FileHandle >> 5] + 4 + (_FileHandle & 0x1fU) * 0x24) & 0x40
  ;
}



// Library Function - Single Match
//  ___wctomb_mt
// 
// Library: Visual Studio 2003 Release

int __cdecl ___wctomb_mt(int param_1,LPSTR param_2,WCHAR param_3)

{
  LPSTR lpMultiByteStr;
  int iVar1;
  int *piVar2;
  
  lpMultiByteStr = param_2;
  if (param_2 == (LPSTR)0x0) {
    iVar1 = 0;
  }
  else {
    if (*(int *)(param_1 + 0x14) == 0) {
      if ((ushort)param_3 < 0x100) {
        *param_2 = (CHAR)param_3;
        return 1;
      }
    }
    else {
      param_2 = (LPSTR)0x0;
      iVar1 = WideCharToMultiByte(*(UINT *)(param_1 + 4),0,&param_3,1,lpMultiByteStr,
                                  *(int *)(param_1 + 0x28),(LPCSTR)0x0,(LPBOOL)&param_2);
      if ((iVar1 != 0) && (param_2 == (LPSTR)0x0)) {
        return iVar1;
      }
    }
    piVar2 = FUN_1003366f();
    *piVar2 = 0x2a;
    iVar1 = -1;
  }
  return iVar1;
}



// Library Function - Single Match
//  _wctomb
// 
// Library: Visual Studio 2003 Release

int __cdecl _wctomb(char *_MbCh,wchar_t _WCh)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  int iVar3;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
  }
  iVar3 = ___wctomb_mt((int)ptVar2,_MbCh,_WCh);
  return iVar3;
}



// Library Function - Single Match
//  __aulldvrm
// 
// Library: Visual Studio 2003 Release

undefined8 __aulldvrm(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



// Library Function - Single Match
//  int __cdecl _ValidateRead(void const *,unsigned int)
// 
// Library: Visual Studio 2003 Release

int __cdecl _ValidateRead(void *param_1,uint param_2)

{
  BOOL BVar1;
  
  BVar1 = IsBadReadPtr(param_1,param_2);
  return (uint)(BVar1 == 0);
}



// Library Function - Multiple Matches With Different Base Names
//  int __cdecl _ValidateRead(void const *,unsigned int)
//  int __cdecl _ValidateWrite(void *,unsigned int)
// 
// Library: Visual Studio 2003 Release

int __cdecl _ValidateWrite(void *param_1,uint param_2)

{
  BOOL BVar1;
  
  BVar1 = IsBadWritePtr(param_1,param_2);
  return (uint)(BVar1 == 0);
}



// Library Function - Single Match
//  int __cdecl _ValidateExecute(int (__stdcall*)(void))
// 
// Library: Visual Studio 2003 Release

int __cdecl _ValidateExecute(_func_int *param_1)

{
  BOOL BVar1;
  
  BVar1 = IsBadCodePtr((FARPROC)param_1);
  return (uint)(BVar1 == 0);
}



// Library Function - Single Match
//  _CPtoLCID
// 
// Library: Visual Studio 2003 Release

undefined4 _CPtoLCID(void)

{
  int in_EAX;
  
  if (in_EAX == 0x3a4) {
    return 0x411;
  }
  if (in_EAX == 0x3a8) {
    return 0x804;
  }
  if (in_EAX == 0x3b5) {
    return 0x412;
  }
  if (in_EAX != 0x3b6) {
    return 0;
  }
  return 0x404;
}



// Library Function - Single Match
//  _setSBCS
// 
// Library: Visual Studio 2003 Release

void __cdecl setSBCS(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)&DAT_10053380;
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *(undefined1 *)puVar2 = 0;
  DAT_10053484 = 0;
  DAT_10053368 = 0;
  DAT_10053360 = 0;
  DAT_10053490 = 0;
  DAT_10053494 = 0;
  DAT_10053498 = 0;
  return;
}



// Library Function - Single Match
//  _setSBUpLow
// 
// Library: Visual Studio 2003 Release

void __cdecl setSBUpLow(void)

{
  BOOL BVar1;
  uint uVar2;
  undefined1 uVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  BYTE *pBVar7;
  undefined4 *puVar8;
  _locale_t _BError;
  ushort local_51c [256];
  undefined1 local_31c [256];
  undefined1 local_21c [256];
  undefined4 local_11c [64];
  _cpinfo local_1c;
  int local_8;
  
  local_8 = DAT_10041558;
  BVar1 = GetCPInfo((UINT)DAT_10053484,&local_1c);
  if (BVar1 == 1) {
    uVar2 = 0;
    do {
      *(char *)((int)local_11c + uVar2) = (char)uVar2;
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
    local_11c[0]._0_1_ = 0x20;
    if (local_1c.LeadByte[0] != 0) {
      pBVar7 = local_1c.LeadByte + 1;
      do {
        uVar2 = (uint)local_1c.LeadByte[0];
        if (uVar2 <= *pBVar7) {
          uVar5 = (*pBVar7 - uVar2) + 1;
          puVar8 = (undefined4 *)((int)local_11c + uVar2);
          for (uVar6 = uVar5 >> 2; uVar6 != 0; uVar6 = uVar6 - 1) {
            *puVar8 = 0x20202020;
            puVar8 = puVar8 + 1;
          }
          for (uVar5 = uVar5 & 3; uVar5 != 0; uVar5 = uVar5 - 1) {
            *(undefined1 *)puVar8 = 0x20;
            puVar8 = (undefined4 *)((int)puVar8 + 1);
          }
        }
        local_1c.LeadByte[0] = pBVar7[1];
        pBVar7 = pBVar7 + 2;
      } while (local_1c.LeadByte[0] != 0);
    }
    BVar1 = 1;
    ___crtGetStringTypeA
              ((_locale_t)0x1,(DWORD)local_11c,(LPCSTR)0x100,(int)local_51c,DAT_10053484,
               (int)DAT_10053360,0);
    _BError = DAT_10053360;
    ___crtLCMapStringA(DAT_10053360,(LPCWSTR)0x100,(DWORD)local_11c,(LPCSTR)0x100,(int)local_21c,
                       (LPSTR)0x100,(int)DAT_10053484,0,BVar1);
    ___crtLCMapStringA(DAT_10053360,(LPCWSTR)0x200,(DWORD)local_11c,(LPCSTR)0x100,(int)local_31c,
                       (LPSTR)0x100,(int)DAT_10053484,0,(BOOL)_BError);
    uVar2 = 0;
    do {
      if ((local_51c[uVar2] & 1) == 0) {
        if ((local_51c[uVar2] & 2) != 0) {
          (&DAT_10053381)[uVar2] = (&DAT_10053381)[uVar2] | 0x20;
          uVar3 = local_31c[uVar2];
          goto LAB_100357cf;
        }
        (&DAT_100534a0)[uVar2] = 0;
      }
      else {
        (&DAT_10053381)[uVar2] = (&DAT_10053381)[uVar2] | 0x10;
        uVar3 = local_21c[uVar2];
LAB_100357cf:
        (&DAT_100534a0)[uVar2] = uVar3;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
  }
  else {
    uVar2 = 0;
    do {
      if ((uVar2 < 0x41) || (0x5a < uVar2)) {
        if ((0x60 < uVar2) && (uVar2 < 0x7b)) {
          (&DAT_10053381)[uVar2] = (&DAT_10053381)[uVar2] | 0x20;
          cVar4 = (char)uVar2 + -0x20;
          goto LAB_10035812;
        }
        (&DAT_100534a0)[uVar2] = 0;
      }
      else {
        (&DAT_10053381)[uVar2] = (&DAT_10053381)[uVar2] | 0x10;
        cVar4 = (char)uVar2 + ' ';
LAB_10035812:
        (&DAT_100534a0)[uVar2] = cVar4;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
  }
  FUN_1002d447(local_8);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___updatetmbcinfo
// 
// Library: Visual Studio 2003 Release

pthreadmbcinfo __cdecl ___updatetmbcinfo(void)

{
  _ptiddata p_Var1;
  pthreadmbcinfo _Memory;
  
  __lock(0xd);
  p_Var1 = __getptd();
  _Memory = (pthreadmbcinfo)p_Var1->_tpxcptinfoptrs;
  if (_Memory != DAT_10053364) {
    if ((_Memory != (pthreadmbcinfo)0x0) &&
       (_Memory->refcount = _Memory->refcount + -1, _Memory->refcount == 0)) {
      _free(_Memory);
    }
    p_Var1->_tpxcptinfoptrs = DAT_10053364;
    _Memory = DAT_10053364;
    DAT_10053364->refcount = DAT_10053364->refcount + 1;
  }
  FUN_100358af();
  return _Memory;
}



void FUN_100358af(void)

{
  FUN_1002f8d0(0xd);
  return;
}



// Library Function - Single Match
//  __setmbcp_lk
// 
// Library: Visual Studio 2003 Release

void __cdecl __setmbcp_lk(UINT param_1)

{
  BYTE *pBVar1;
  byte bVar2;
  byte bVar3;
  uint uVar4;
  BOOL BVar5;
  BYTE *pBVar6;
  int iVar7;
  int extraout_ECX;
  undefined4 extraout_ECX_00;
  int iVar8;
  byte *pbVar9;
  byte *pbVar10;
  undefined4 *puVar11;
  uint local_20;
  _cpinfo local_1c;
  int local_8;
  
  local_8 = DAT_10041558;
  if (param_1 != 0) {
    iVar8 = 0;
    uVar4 = 0;
LAB_100358da:
    if (*(UINT *)((int)&DAT_10041f08 + uVar4) != param_1) goto code_r0x100358e2;
    puVar11 = (undefined4 *)&DAT_10053380;
    for (iVar7 = 0x40; iVar7 != 0; iVar7 = iVar7 + -1) {
      *puVar11 = 0;
      puVar11 = puVar11 + 1;
    }
    local_20 = 0;
    *(undefined1 *)puVar11 = 0;
    pbVar9 = &DAT_10041f18 + iVar8 * 0x30;
    do {
      bVar3 = *pbVar9;
      pbVar10 = pbVar9;
      while ((bVar3 != 0 && (bVar2 = pbVar10[1], bVar2 != 0))) {
        uVar4 = (uint)bVar3;
        if (uVar4 <= bVar2) {
          bVar3 = (&DAT_10041f00)[local_20];
          do {
            (&DAT_10053381)[uVar4] = (&DAT_10053381)[uVar4] | bVar3;
            uVar4 = uVar4 + 1;
          } while (uVar4 <= bVar2);
        }
        pbVar10 = pbVar10 + 2;
        bVar3 = *pbVar10;
      }
      local_20 = local_20 + 1;
      pbVar9 = pbVar9 + 8;
    } while (local_20 < 4);
    DAT_10053484 = param_1;
    DAT_10053368 = 1;
    DAT_10053360 = _CPtoLCID();
    DAT_10053490 = *(undefined4 *)(&DAT_10041f0c + extraout_ECX);
    DAT_10053494 = *(undefined4 *)(&DAT_10041f10 + extraout_ECX);
    DAT_10053498 = *(undefined4 *)(&DAT_10041f14 + extraout_ECX);
    goto LAB_10035a2f;
  }
LAB_10035a2a:
  setSBCS();
LAB_10035a2f:
  setSBUpLow();
LAB_10035a3b:
  FUN_1002d447(local_8);
  return;
code_r0x100358e2:
  uVar4 = uVar4 + 0x30;
  iVar8 = iVar8 + 1;
  if (0xef < uVar4) goto code_r0x100358ed;
  goto LAB_100358da;
code_r0x100358ed:
  BVar5 = GetCPInfo(param_1,&local_1c);
  if (BVar5 != 1) {
    if (DAT_10053294 == 0) goto LAB_10035a3b;
    goto LAB_10035a2a;
  }
  puVar11 = (undefined4 *)&DAT_10053380;
  for (iVar8 = 0x40; iVar8 != 0; iVar8 = iVar8 + -1) {
    *puVar11 = 0;
    puVar11 = puVar11 + 1;
  }
  *(undefined1 *)puVar11 = 0;
  DAT_10053484 = param_1;
  DAT_10053360 = 0;
  if (local_1c.MaxCharSize < 2) {
    DAT_10053368 = 0;
  }
  else {
    if (local_1c.LeadByte[0] != '\0') {
      pBVar6 = local_1c.LeadByte + 1;
      do {
        bVar3 = *pBVar6;
        if (bVar3 == 0) break;
        for (uVar4 = (uint)pBVar6[-1]; uVar4 <= bVar3; uVar4 = uVar4 + 1) {
          (&DAT_10053381)[uVar4] = (&DAT_10053381)[uVar4] | 4;
        }
        pBVar1 = pBVar6 + 1;
        pBVar6 = pBVar6 + 2;
      } while (*pBVar1 != 0);
    }
    uVar4 = 1;
    do {
      (&DAT_10053381)[uVar4] = (&DAT_10053381)[uVar4] | 8;
      uVar4 = uVar4 + 1;
    } while (uVar4 < 0xff);
    DAT_10053360 = _CPtoLCID();
    DAT_10053368 = extraout_ECX_00;
  }
  DAT_10053490 = 0;
  DAT_10053494 = 0;
  DAT_10053498 = 0;
  goto LAB_10035a2f;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __setmbcp
// 
// Library: Visual Studio 2003 Release

int __cdecl __setmbcp(int _CodePage)

{
  int *_Memory;
  int iVar1;
  int local_24;
  
  local_24 = -1;
  __lock(0xd);
  DAT_10053294 = 0;
  if (_CodePage == -2) {
    DAT_10053294 = 1;
    _CodePage = GetOEMCP();
  }
  else if (_CodePage == -3) {
    DAT_10053294 = 1;
    _CodePage = GetACP();
  }
  else if (_CodePage == -4) {
    DAT_10053294 = 1;
    _CodePage = DAT_100532c4;
  }
  if (_CodePage == DAT_10053484) {
    local_24 = 0;
  }
  else {
    if ((DAT_10053364 == (int *)0x0) || (_Memory = DAT_10053364, *DAT_10053364 != 0)) {
      _Memory = (int *)_malloc(0x220);
    }
    if ((_Memory != (int *)0x0) && (local_24 = __setmbcp_lk(_CodePage), local_24 == 0)) {
      *_Memory = 0;
      _Memory[1] = DAT_10053484;
      _Memory[2] = DAT_10053368;
      _Memory[3] = DAT_10053360;
      for (iVar1 = 0; iVar1 < 5; iVar1 = iVar1 + 1) {
        *(undefined2 *)((int)_Memory + iVar1 * 2 + 0x10) =
             *(undefined2 *)((int)&DAT_10053490 + iVar1 * 2);
      }
      for (iVar1 = 0; iVar1 < 0x101; iVar1 = iVar1 + 1) {
        *(undefined1 *)(iVar1 + 0x1c + (int)_Memory) = (&DAT_10053380)[iVar1];
      }
      for (iVar1 = 0; DAT_10053364 = _Memory, iVar1 < 0x100; iVar1 = iVar1 + 1) {
        *(undefined1 *)(iVar1 + 0x11d + (int)_Memory) = (&DAT_100534a0)[iVar1];
      }
    }
    if ((local_24 == -1) && (_Memory != DAT_10053364)) {
      _free(_Memory);
    }
  }
  FUN_10035b8f();
  return local_24;
}



void FUN_10035b8f(void)

{
  FUN_1002f8d0(0xd);
  return;
}



// Library Function - Single Match
//  ___initmbctable
// 
// Library: Visual Studio 2003 Release

undefined4 ___initmbctable(void)

{
  if (DAT_100536ec == 0) {
    __setmbcp(-3);
    DAT_100536ec = 1;
  }
  return 0;
}



// Library Function - Single Match
//  _abort
// 
// Library: Visual Studio 2003 Release

void __cdecl _abort(void)

{
  __NMSG_WRITE(10);
  _raise(0x16);
                    // WARNING: Subroutine does not return
  __exit(3);
}



// Library Function - Single Match
//  ___crtMessageBoxA
// 
// Library: Visual Studio 2003 Release

int __cdecl ___crtMessageBoxA(LPCSTR _LpText,LPCSTR _LpCaption,UINT _UType)

{
  HMODULE hModule;
  int iVar1;
  int iVar2;
  undefined1 local_14 [8];
  byte local_c;
  undefined1 local_8 [4];
  
  iVar2 = 0;
  if (DAT_10053298 == (FARPROC)0x0) {
    hModule = LoadLibraryA("user32.dll");
    if ((hModule == (HMODULE)0x0) ||
       (DAT_10053298 = GetProcAddress(hModule,"MessageBoxA"), DAT_10053298 == (FARPROC)0x0)) {
      return 0;
    }
    DAT_1005329c = GetProcAddress(hModule,"GetActiveWindow");
    DAT_100532a0 = GetProcAddress(hModule,"GetLastActivePopup");
    if ((DAT_10053014 == 2) &&
       (DAT_100532a8 = GetProcAddress(hModule,"GetUserObjectInformationA"),
       DAT_100532a8 != (FARPROC)0x0)) {
      DAT_100532a4 = GetProcAddress(hModule,"GetProcessWindowStation");
    }
  }
  if ((DAT_100532a4 == (FARPROC)0x0) ||
     (((iVar1 = (*DAT_100532a4)(), iVar1 != 0 &&
       (iVar1 = (*DAT_100532a8)(iVar1,1,local_14,0xc,local_8), iVar1 != 0)) && ((local_c & 1) != 0))
     )) {
    if (((DAT_1005329c != (FARPROC)0x0) && (iVar2 = (*DAT_1005329c)(), iVar2 != 0)) &&
       (DAT_100532a0 != (FARPROC)0x0)) {
      iVar2 = (*DAT_100532a0)(iVar2);
    }
  }
  else if (DAT_10053020 < 4) {
    _UType = _UType | 0x40000;
  }
  else {
    _UType = _UType | 0x200000;
  }
  iVar2 = (*DAT_10053298)(iVar2,_LpText,_LpCaption,_UType);
  return iVar2;
}



// Library Function - Single Match
//  __onexit_lk
// 
// Library: Visual Studio 2003 Release

void __onexit_lk(void)

{
  size_t sVar1;
  void *pvVar2;
  size_t sVar3;
  undefined4 unaff_EDI;
  
  sVar1 = __msize(DAT_100536e8);
  if (sVar1 < (uint)((int)DAT_100536e4 + (4 - (int)DAT_100536e8))) {
    sVar3 = 0x800;
    if (sVar1 < 0x800) {
      sVar3 = sVar1;
    }
    pvVar2 = _realloc(DAT_100536e8,sVar3 + sVar1);
    if (pvVar2 == (void *)0x0) {
      pvVar2 = _realloc(DAT_100536e8,sVar1 + 0x10);
      if (pvVar2 == (void *)0x0) {
        return;
      }
    }
    DAT_100536e4 = (undefined4 *)((int)pvVar2 + ((int)DAT_100536e4 - (int)DAT_100536e8 >> 2) * 4);
    DAT_100536e8 = pvVar2;
  }
  *DAT_100536e4 = unaff_EDI;
  DAT_100536e4 = DAT_100536e4 + 1;
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __onexit
// 
// Library: Visual Studio 2003 Release

_onexit_t __cdecl __onexit(_onexit_t _Func)

{
  _onexit_t p_Var1;
  
  FUN_10031368();
  p_Var1 = (_onexit_t)__onexit_lk();
  FUN_10035da1();
  return p_Var1;
}



void FUN_10035da1(void)

{
  FUN_10031371();
  return;
}



// Library Function - Single Match
//  _atexit
// 
// Library: Visual Studio 2003 Release

int __cdecl _atexit(_func_4879 *param_1)

{
  _onexit_t p_Var1;
  
  p_Var1 = __onexit((_onexit_t)param_1);
  return (p_Var1 != (_onexit_t)0x0) - 1;
}



// Library Function - Single Match
//  __getenv_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __getenv_lk(uchar *param_1)

{
  int iVar1;
  size_t _MaxCount;
  size_t sVar2;
  int *piVar3;
  
  if (DAT_100536e0 == 0) {
    return 0;
  }
  if (((DAT_10053034 != (int *)0x0) ||
      (((DAT_1005303c != 0 && (iVar1 = ___wtomb_environ(), iVar1 == 0)) &&
       (DAT_10053034 != (int *)0x0)))) && (piVar3 = DAT_10053034, param_1 != (uchar *)0x0)) {
    _MaxCount = _strlen((char *)param_1);
    for (; (char *)*piVar3 != (char *)0x0; piVar3 = piVar3 + 1) {
      sVar2 = _strlen((char *)*piVar3);
      if (((_MaxCount < sVar2) && (((uchar *)*piVar3)[_MaxCount] == '=')) &&
         (iVar1 = __mbsnbicoll((uchar *)*piVar3,param_1,_MaxCount), iVar1 == 0)) {
        return *piVar3 + 1 + _MaxCount;
      }
    }
  }
  return 0;
}



// Library Function - Single Match
//  __set_osfhnd
// 
// Library: Visual Studio 2003 Release

int __cdecl __set_osfhnd(int param_1,intptr_t param_2)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if ((uint)param_1 < DAT_100535c4) {
    iVar3 = (param_1 & 0x1fU) * 0x24;
    if (*(int *)(iVar3 + (&DAT_100535e0)[param_1 >> 5]) == -1) {
      if (DAT_10052e78 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_10035e93;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)param_2);
      }
LAB_10035e93:
      *(intptr_t *)(iVar3 + (&DAT_100535e0)[param_1 >> 5]) = param_2;
      return 0;
    }
  }
  piVar1 = FUN_1003366f();
  *piVar1 = 9;
  puVar2 = FUN_10033678();
  *puVar2 = 0;
  return -1;
}



// Library Function - Single Match
//  __free_osfhnd
// 
// Library: Visual Studio 2003 Release

int __cdecl __free_osfhnd(int param_1)

{
  int *piVar1;
  ulong *puVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if ((uint)param_1 < DAT_100535c4) {
    iVar3 = (param_1 & 0x1fU) * 0x24;
    piVar1 = (int *)((&DAT_100535e0)[param_1 >> 5] + iVar3);
    if (((*(byte *)(piVar1 + 1) & 1) != 0) && (*piVar1 != -1)) {
      if (DAT_10052e78 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_10035f12;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_10035f12:
      *(undefined4 *)(iVar3 + (&DAT_100535e0)[param_1 >> 5]) = 0xffffffff;
      return 0;
    }
  }
  piVar1 = FUN_1003366f();
  *piVar1 = 9;
  puVar2 = FUN_10033678();
  *puVar2 = 0;
  return -1;
}



// Library Function - Single Match
//  __get_osfhandle
// 
// Library: Visual Studio 2003 Release

intptr_t __cdecl __get_osfhandle(int _FileHandle)

{
  intptr_t *piVar1;
  int *piVar2;
  ulong *puVar3;
  
  if (((uint)_FileHandle < DAT_100535c4) &&
     (piVar1 = (intptr_t *)((&DAT_100535e0)[_FileHandle >> 5] + (_FileHandle & 0x1fU) * 0x24),
     (*(byte *)(piVar1 + 1) & 1) != 0)) {
    return *piVar1;
  }
  piVar2 = FUN_1003366f();
  *piVar2 = 9;
  puVar3 = FUN_10033678();
  *puVar3 = 0;
  return -1;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __lock_fhandle
// 
// Library: Visual Studio 2003 Release

int __cdecl __lock_fhandle(int _Filehandle)

{
  int iVar1;
  int iVar2;
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10040070;
  uStack_c = 0x10035f82;
  iVar1 = (&DAT_100535e0)[_Filehandle >> 5] + (_Filehandle & 0x1fU) * 0x24;
  if (*(int *)(iVar1 + 8) == 0) {
    __lock(10);
    local_8 = (undefined *)0x0;
    if (*(int *)(iVar1 + 8) == 0) {
      iVar2 = ___crtInitCritSecAndSpinCount(iVar1 + 0xc,4000);
      if (iVar2 == 0) {
        __local_unwind2((int)local_14,-1);
        return 0;
      }
      *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
    }
    local_8 = (undefined *)0xffffffff;
    FUN_1003600d();
  }
  EnterCriticalSection
            ((LPCRITICAL_SECTION)
             ((&DAT_100535e0)[_Filehandle >> 5] + 0xc + (_Filehandle & 0x1fU) * 0x24));
  return 1;
}



void FUN_1003600d(void)

{
  FUN_1002f8d0(10);
  return;
}



// Library Function - Single Match
//  __unlock_fhandle
// 
// Library: Visual Studio 2003 Release

void __cdecl __unlock_fhandle(int _Filehandle)

{
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((&DAT_100535e0)[_Filehandle >> 5] + 0xc + (_Filehandle & 0x1fU) * 0x24));
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __alloc_osfhnd
// 
// Library: Visual Studio 2003 Release

int __cdecl __alloc_osfhnd(void)

{
  int iVar1;
  int iVar2;
  undefined4 *puVar3;
  int local_20;
  undefined1 local_14 [8];
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10040080;
  uStack_c = 0x10036044;
  local_20 = -1;
  iVar1 = __mtinitlocknum(0xb);
  if (iVar1 == 0) {
LAB_100360d9:
    local_20 = -1;
  }
  else {
    __lock(0xb);
    local_8 = (undefined *)0x0;
    for (iVar1 = 0; iVar1 < 0x40; iVar1 = iVar1 + 1) {
      puVar3 = (undefined4 *)(&DAT_100535e0)[iVar1];
      if (puVar3 == (undefined4 *)0x0) {
        puVar3 = (undefined4 *)_malloc(0x480);
        if (puVar3 != (undefined4 *)0x0) {
          (&DAT_100535e0)[iVar1] = puVar3;
          DAT_100535c4 = DAT_100535c4 + 0x20;
          for (; puVar3 < (undefined4 *)((&DAT_100535e0)[iVar1] + 0x480); puVar3 = puVar3 + 9) {
            *(undefined1 *)(puVar3 + 1) = 0;
            *puVar3 = 0xffffffff;
            *(undefined1 *)((int)puVar3 + 5) = 10;
            puVar3[2] = 0;
          }
          local_20 = iVar1 << 5;
          iVar1 = __lock_fhandle(local_20);
          if (iVar1 == 0) {
            local_20 = -1;
          }
        }
        break;
      }
      for (; puVar3 < (undefined4 *)((&DAT_100535e0)[iVar1] + 0x480); puVar3 = puVar3 + 9) {
        if ((*(byte *)(puVar3 + 1) & 1) == 0) {
          if (puVar3[2] == 0) {
            __lock(10);
            local_8 = (undefined *)0x1;
            if (puVar3[2] == 0) {
              iVar2 = ___crtInitCritSecAndSpinCount(puVar3 + 3,4000);
              if (iVar2 == 0) {
                __local_unwind2((int)local_14,-1);
                goto LAB_100360d9;
              }
              puVar3[2] = puVar3[2] + 1;
            }
            local_8 = (undefined *)0x0;
            FUN_10036111();
          }
          EnterCriticalSection((LPCRITICAL_SECTION)(puVar3 + 3));
          if ((*(byte *)(puVar3 + 1) & 1) == 0) {
            *puVar3 = 0xffffffff;
            local_20 = ((int)puVar3 - (&DAT_100535e0)[iVar1]) / 0x24 + iVar1 * 0x20;
            break;
          }
          LeaveCriticalSection((LPCRITICAL_SECTION)(puVar3 + 3));
        }
      }
      if (local_20 != -1) break;
    }
    local_8 = (undefined *)0xffffffff;
    FUN_100361ab();
  }
  return local_20;
}



void FUN_10036111(void)

{
  FUN_1002f8d0(10);
  return;
}



void FUN_100361ab(void)

{
  FUN_1002f8d0(0xb);
  return;
}



// Library Function - Single Match
//  __tsopen_lk
// 
// Library: Visual Studio 2003 Release

uint __thiscall
__tsopen_lk(void *this,undefined4 *param_1,uint *param_2,LPCSTR param_3,uint param_4,byte param_5)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  int *piVar4;
  ulong *puVar5;
  HANDLE hFile;
  int iVar6;
  DWORD DVar7;
  int iVar8;
  bool bVar9;
  _SECURITY_ATTRIBUTES local_20;
  DWORD local_14;
  DWORD local_10;
  uint local_c;
  char local_6;
  byte local_5;
  
  bVar9 = -1 < (char)param_4;
  local_20.nLength = 0xc;
  local_20.lpSecurityDescriptor = (LPVOID)0x0;
  if (bVar9) {
    local_5 = 0;
  }
  else {
    local_5 = 0x10;
  }
  local_20.bInheritHandle = (BOOL)bVar9;
  if (((param_4 & 0x8000) == 0) && (((param_4 & 0x4000) != 0 || (DAT_1005333c != 0x8000)))) {
    local_5 = local_5 | 0x80;
  }
  uVar3 = param_4 & 3;
  if (uVar3 == 0) {
    local_14 = 0x80000000;
  }
  else if (uVar3 == 1) {
    local_14 = 0x40000000;
  }
  else {
    if (uVar3 != 2) goto LAB_1003623b;
    local_14 = 0xc0000000;
  }
  if (this == (void *)0x10) {
    local_c = 0;
  }
  else if (this == (void *)0x20) {
    local_c = 1;
  }
  else if (this == (void *)0x30) {
    local_c = 2;
  }
  else {
    if (this != (void *)0x40) {
LAB_1003623b:
      piVar4 = FUN_1003366f();
      *piVar4 = 0x16;
      puVar5 = FUN_10033678();
      *puVar5 = 0;
      return 0xffffffff;
    }
    local_c = 3;
  }
  uVar3 = param_4 & 0x700;
  if (uVar3 < 0x401) {
    if ((uVar3 == 0x400) || (uVar3 == 0)) {
      local_10 = 3;
    }
    else if (uVar3 == 0x100) {
      local_10 = 4;
    }
    else {
      if (uVar3 == 0x200) goto LAB_100362e2;
      if (uVar3 != 0x300) goto LAB_100362c8;
      local_10 = 2;
    }
  }
  else {
    if (uVar3 != 0x500) {
      if (uVar3 == 0x600) {
LAB_100362e2:
        local_10 = 5;
        goto LAB_100362f2;
      }
      if (uVar3 != 0x700) {
LAB_100362c8:
        piVar4 = FUN_1003366f();
        *piVar4 = 0x16;
        puVar5 = FUN_10033678();
        *puVar5 = 0;
        return 0xffffffff;
      }
    }
    local_10 = 1;
  }
LAB_100362f2:
  DVar7 = 0x80;
  if (((param_4 & 0x100) != 0) && (-1 < (char)(~(byte)DAT_10053010 & param_5))) {
    DVar7 = 1;
  }
  if ((param_4 & 0x40) != 0) {
    local_14 = CONCAT13(local_14._3_1_,0x10000);
    DVar7 = DVar7 | 0x4000000;
    if (DAT_10053014 == 2) {
      local_c = local_c | 4;
    }
  }
  if ((param_4 & 0x1000) != 0) {
    DVar7 = DVar7 | 0x100;
  }
  if ((param_4 & 0x20) == 0) {
    if ((param_4 & 0x10) != 0) {
      DVar7 = DVar7 | 0x10000000;
    }
  }
  else {
    DVar7 = DVar7 | 0x8000000;
  }
  uVar3 = __alloc_osfhnd();
  if (uVar3 == 0xffffffff) {
    piVar4 = FUN_1003366f();
    *piVar4 = 0x18;
    puVar5 = FUN_10033678();
    *puVar5 = 0;
  }
  else {
    *param_1 = 1;
    *param_2 = uVar3;
    hFile = CreateFileA(param_3,local_14,local_c,&local_20,local_10,DVar7,(HANDLE)0x0);
    if (hFile != (HANDLE)0xffffffff) {
      DVar7 = GetFileType(hFile);
      if (DVar7 != 0) {
        if (DVar7 == 2) {
          local_5 = local_5 | 0x40;
        }
        else if (DVar7 == 3) {
          local_5 = local_5 | 8;
        }
        __set_osfhnd(uVar3,(intptr_t)hFile);
        bVar2 = local_5 | 1;
        iVar8 = (uVar3 & 0x1f) * 0x24;
        local_5 = local_5 & 0x48;
        *(byte *)(iVar8 + 4 + (&DAT_100535e0)[(int)uVar3 >> 5]) = bVar2;
        if (((local_5 == 0) && ((char)bVar2 < '\0')) && ((param_4 & 2) != 0)) {
          local_14 = __lseek_lk(uVar3,-1,2);
          if (local_14 == 0xffffffff) {
            puVar5 = FUN_10033678();
            if (*puVar5 == 0x83) goto LAB_10036434;
          }
          else {
            local_6 = '\0';
            iVar6 = __read_lk(uVar3,&local_6,(char *)0x1);
            if ((((iVar6 != 0) || (local_6 != '\x1a')) ||
                (iVar6 = __chsize_lk(uVar3,local_14), iVar6 != -1)) &&
               (DVar7 = __lseek_lk(uVar3,0,0), DVar7 != 0xffffffff)) goto LAB_10036434;
          }
          __close_lk(uVar3);
          return 0xffffffff;
        }
LAB_10036434:
        if (local_5 != 0) {
          return uVar3;
        }
        if ((param_4 & 8) == 0) {
          return uVar3;
        }
        pbVar1 = (byte *)(iVar8 + 4 + (&DAT_100535e0)[(int)uVar3 >> 5]);
        *pbVar1 = *pbVar1 | 0x20;
        return uVar3;
      }
      CloseHandle(hFile);
    }
    DVar7 = GetLastError();
    __dosmaperr(DVar7);
  }
  return 0xffffffff;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __sopen
// 
// Library: Visual Studio 2003 Release

int __cdecl __sopen(char *_Filename,int _OpenFlag,int _ShareFlag,...)

{
  uint uVar1;
  byte in_stack_00000010;
  uint local_24 [6];
  undefined4 uStack_c;
  undefined4 local_8;
  
  uStack_c = 0x100364a7;
  local_24[1] = 0;
  local_8 = 0;
  uVar1 = __tsopen_lk((void *)_ShareFlag,local_24 + 1,local_24,_Filename,_OpenFlag,in_stack_00000010
                     );
  local_8 = 0xffffffff;
  FUN_100364e0();
  return uVar1;
}



void FUN_100364e0(void)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x1c) != 0) {
    __unlock_fhandle(*(int *)(unaff_EBP + -0x20));
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Unable to track spacebase fully for stack
// Library Function - Single Match
//  ___crtGetStringTypeA
// 
// Library: Visual Studio 2003 Release

BOOL __cdecl
___crtGetStringTypeA
          (_locale_t _Plocinfo,DWORD _DWInfoType,LPCSTR _LpSrcStr,int _CchSrc,LPWORD _LpCharType,
          int _Code_page,BOOL _BError)

{
  int iVar1;
  bool bVar2;
  BOOL BVar3;
  DWORD DVar4;
  int iVar5;
  undefined1 *puVar6;
  undefined1 *puVar7;
  LPWORD pWVar8;
  LCID Locale;
  undefined1 *puVar9;
  void *_Memory;
  LPWORD pWVar10;
  undefined4 uStackY_58;
  BOOL local_28;
  WORD local_20 [2];
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_100400a8;
  uStack_c = 0x100364fc;
  _Memory = (void *)0x0;
  if (DAT_100532d0 == 0) {
    BVar3 = GetStringTypeW(1,L"",1,local_20);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      if (DVar4 == 0x78) {
        DAT_100532d0 = 2;
      }
    }
    else {
      DAT_100532d0 = 1;
    }
  }
  if ((DAT_100532d0 == 2) || (DAT_100532d0 == 0)) {
    Locale = _Code_page;
    if (_Code_page == 0) {
      Locale = DAT_100532b4;
    }
    pWVar10 = _LpCharType;
    if (_LpCharType == (LPWORD)0x0) {
      pWVar10 = DAT_100532c4;
    }
    pWVar8 = (LPWORD)___ansicp(Locale);
    if (pWVar8 != (LPWORD)0xffffffff) {
      if (pWVar8 != pWVar10) {
        uStackY_58 = 0x10036673;
        _Memory = (void *)___convertcp((UINT)pWVar10,(UINT)pWVar8,(char *)_DWInfoType,
                                       (size_t *)&_LpSrcStr,(LPSTR)0x0,0);
        _DWInfoType = (DWORD)_Memory;
        if (_Memory == (void *)0x0) {
          return 0;
        }
      }
      BVar3 = GetStringTypeA(Locale,(DWORD)_Plocinfo,(LPCSTR)_DWInfoType,(int)_LpSrcStr,
                             (LPWORD)_CchSrc);
      if (_Memory != (void *)0x0) {
        _free(_Memory);
        return BVar3;
      }
      return BVar3;
    }
  }
  else if (DAT_100532d0 == 1) {
    local_28 = 0;
    bVar2 = false;
    if (_LpCharType == (LPWORD)0x0) {
      _LpCharType = DAT_100532c4;
    }
    uStackY_58 = 0x1003658e;
    iVar5 = MultiByteToWideChar((UINT)_LpCharType,(uint)(_BError != 0) * 8 + 1,(LPCSTR)_DWInfoType,
                                (int)_LpSrcStr,(LPWSTR)0x0,0);
    if (iVar5 != 0) {
      local_8 = (undefined *)0x0;
      puVar6 = (undefined1 *)(iVar5 * 2 + 3U & 0xfffffffc);
      iVar1 = -(int)puVar6;
      puVar7 = &stack0xffffffc4 + iVar1;
      local_1c = &stack0xffffffc4 + iVar1;
      *(int *)((int)local_20 + iVar1 + -0x20) = iVar5 * 2;
      *(undefined4 *)(&stack0xffffffbc + iVar1) = 0;
      *(undefined1 **)(&stack0xffffffb8 + iVar1) = &stack0xffffffc4 + iVar1;
      *(undefined4 *)(&stack0xffffffb4 + iVar1) = 0x100365c0;
      _memset(*(void **)(&stack0xffffffb8 + iVar1),*(int *)(&stack0xffffffbc + iVar1),
              *(size_t *)((int)local_20 + iVar1 + -0x20));
      local_8 = (undefined *)0xffffffff;
      if (&stack0xffffffc4 == puVar6) {
        *(int *)((int)local_20 + iVar1 + -0x20) = iVar5;
        *(undefined4 *)(&stack0xffffffbc + iVar1) = 2;
        *(undefined4 *)(&stack0xffffffb8 + iVar1) = 0x100365ea;
        puVar7 = (undefined1 *)
                 _calloc(*(size_t *)(&stack0xffffffbc + iVar1),
                         *(size_t *)((int)local_20 + iVar1 + -0x20));
        if (puVar7 == (undefined1 *)0x0) {
          return 0;
        }
        bVar2 = true;
      }
      *(int *)((int)local_20 + iVar1 + -0x20) = iVar5;
      *(undefined1 **)(&stack0xffffffbc + iVar1) = puVar7;
      *(LPCSTR *)(&stack0xffffffb8 + iVar1) = _LpSrcStr;
      *(DWORD *)(&stack0xffffffb4 + iVar1) = _DWInfoType;
      *(undefined4 *)(&stack0xffffffb0 + iVar1) = 1;
      *(LPWORD *)(&stack0xffffffac + iVar1) = _LpCharType;
      puVar9 = (undefined1 *)((int)&uStackY_58 + iVar1);
      *(undefined4 *)((int)&uStackY_58 + iVar1) = 0x1003660c;
      iVar5 = MultiByteToWideChar(*(UINT *)(&stack0xffffffac + iVar1),
                                  *(DWORD *)(&stack0xffffffb0 + iVar1),
                                  *(LPCSTR *)(&stack0xffffffb4 + iVar1),
                                  *(int *)(&stack0xffffffb8 + iVar1),
                                  *(LPWSTR *)(&stack0xffffffbc + iVar1),
                                  *(int *)((int)local_20 + iVar1 + -0x20));
      puVar6 = puVar9;
      if (iVar5 != 0) {
        *(int *)(puVar9 + -4) = _CchSrc;
        *(int *)(puVar9 + -8) = iVar5;
        *(undefined1 **)(puVar9 + -0xc) = puVar7;
        *(_locale_t *)(puVar9 + -0x10) = _Plocinfo;
        puVar6 = puVar9 + -0x14;
        *(undefined4 *)(puVar9 + -0x14) = 0x1003661e;
        local_28 = GetStringTypeW(*(DWORD *)(puVar9 + -0x10),*(LPCWSTR *)(puVar9 + -0xc),
                                  *(int *)(puVar9 + -8),*(LPWORD *)(puVar9 + -4));
      }
      if (bVar2) {
        *(undefined1 **)(puVar6 + -4) = puVar7;
        *(undefined4 *)(puVar6 + -8) = 0x1003662d;
        _free(*(void **)(puVar6 + -4));
        return local_28;
      }
      return local_28;
    }
  }
  return 0;
}



// Library Function - Single Match
//  ___free_lc_time
// 
// Library: Visual Studio 2003 Release

void __cdecl ___free_lc_time(undefined4 *param_1)

{
  if (param_1 != (undefined4 *)0x0) {
    _free((void *)param_1[1]);
    _free((void *)param_1[2]);
    _free((void *)param_1[3]);
    _free((void *)param_1[4]);
    _free((void *)param_1[5]);
    _free((void *)param_1[6]);
    _free((void *)*param_1);
    _free((void *)param_1[8]);
    _free((void *)param_1[9]);
    _free((void *)param_1[10]);
    _free((void *)param_1[0xb]);
    _free((void *)param_1[0xc]);
    _free((void *)param_1[0xd]);
    _free((void *)param_1[7]);
    _free((void *)param_1[0xe]);
    _free((void *)param_1[0xf]);
    _free((void *)param_1[0x10]);
    _free((void *)param_1[0x11]);
    _free((void *)param_1[0x12]);
    _free((void *)param_1[0x13]);
    _free((void *)param_1[0x14]);
    _free((void *)param_1[0x15]);
    _free((void *)param_1[0x16]);
    _free((void *)param_1[0x17]);
    _free((void *)param_1[0x18]);
    _free((void *)param_1[0x19]);
    _free((void *)param_1[0x1a]);
    _free((void *)param_1[0x1b]);
    _free((void *)param_1[0x1c]);
    _free((void *)param_1[0x1d]);
    _free((void *)param_1[0x1e]);
    _free((void *)param_1[0x1f]);
    _free((void *)param_1[0x20]);
    _free((void *)param_1[0x21]);
    _free((void *)param_1[0x22]);
    _free((void *)param_1[0x23]);
    _free((void *)param_1[0x24]);
    _free((void *)param_1[0x25]);
    _free((void *)param_1[0x26]);
    _free((void *)param_1[0x27]);
    _free((void *)param_1[0x28]);
    _free((void *)param_1[0x29]);
    _free((void *)param_1[0x2a]);
  }
  return;
}



// Library Function - Single Match
//  ___free_lconv_num
// 
// Library: Visual Studio 2003 Release

void __cdecl ___free_lconv_num(undefined4 *param_1)

{
  undefined *puVar1;
  
  if (param_1 != (undefined4 *)0x0) {
    puVar1 = (undefined *)*param_1;
    if ((puVar1 != *(undefined **)PTR_PTR_DAT_100420ec) && (puVar1 != PTR_DAT_100420bc)) {
      _free(puVar1);
    }
    puVar1 = (undefined *)param_1[1];
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 4)) && (puVar1 != PTR_DAT_100420c0)) {
      _free(puVar1);
    }
    puVar1 = (undefined *)param_1[2];
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 8)) && (puVar1 != PTR_DAT_100420c4)) {
      _free(puVar1);
    }
  }
  return;
}



// Library Function - Single Match
//  ___free_lconv_mon
// 
// Library: Visual Studio 2003 Release

void __cdecl ___free_lconv_mon(int param_1)

{
  undefined *puVar1;
  
  if (param_1 != 0) {
    puVar1 = *(undefined **)(param_1 + 0xc);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 0xc)) && (puVar1 != PTR_DAT_100420c8)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x10);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 0x10)) && (puVar1 != PTR_DAT_100420cc)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x14);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 0x14)) && (puVar1 != PTR_DAT_100420d0)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x18);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 0x18)) && (puVar1 != PTR_DAT_100420d4)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x1c);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 0x1c)) && (puVar1 != PTR_DAT_100420d8)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x20);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 0x20)) && (puVar1 != PTR_DAT_100420dc)) {
      _free(puVar1);
    }
    puVar1 = *(undefined **)(param_1 + 0x24);
    if ((puVar1 != *(undefined **)(PTR_PTR_DAT_100420ec + 0x24)) && (puVar1 != PTR_DAT_100420e0)) {
      _free(puVar1);
    }
  }
  return;
}



// Library Function - Single Match
//  _strcspn
// 
// Library: Visual Studio

size_t __cdecl _strcspn(char *_Str,char *_Control)

{
  byte bVar1;
  size_t sVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *_Control;
    if (bVar1 == 0) break;
    _Control = (char *)((byte *)_Control + 1);
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  sVar2 = 0xffffffff;
  do {
    sVar2 = sVar2 + 1;
    bVar1 = *_Str;
    if (bVar1 == 0) {
      return sVar2;
    }
    _Str = (char *)((byte *)_Str + 1);
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return sVar2;
}



// Library Function - Single Match
//  _strpbrk
// 
// Library: Visual Studio

char * __cdecl _strpbrk(char *_Str,char *_Control)

{
  byte bVar1;
  byte *pbVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *_Control;
    if (bVar1 == 0) break;
    _Control = (char *)((byte *)_Control + 1);
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  do {
    pbVar2 = (byte *)_Str;
    bVar1 = *pbVar2;
    if (bVar1 == 0) {
      return (char *)(uint)bVar1;
    }
    _Str = (char *)(pbVar2 + 1);
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return (char *)pbVar2;
}



// Library Function - Single Match
//  __lseeki64_lk
// 
// Library: Visual Studio 2003 Release

undefined8 __cdecl __lseeki64_lk(uint param_1,LONG param_2,LONG param_3,DWORD param_4)

{
  byte *pbVar1;
  HANDLE hFile;
  int *piVar2;
  DWORD DVar3;
  DWORD DVar4;
  LONG local_8;
  
  local_8 = param_3;
  hFile = (HANDLE)__get_osfhandle(param_1);
  if (hFile == (HANDLE)0xffffffff) {
    piVar2 = FUN_1003366f();
    *piVar2 = 9;
LAB_10036b2a:
    DVar4 = 0xffffffff;
    local_8 = -1;
  }
  else {
    DVar4 = SetFilePointer(hFile,param_2,&local_8,param_4);
    if (DVar4 == 0xffffffff) {
      DVar3 = GetLastError();
      if (DVar3 != 0) {
        __dosmaperr(DVar3);
        goto LAB_10036b2a;
      }
    }
    pbVar1 = (byte *)((&DAT_100535e0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
    *pbVar1 = *pbVar1 & 0xfd;
  }
  return CONCAT44(local_8,DVar4);
}



// Library Function - Single Match
//  ___ansicp
// 
// Library: Visual Studio 2003 Release

void __cdecl ___ansicp(LCID param_1)

{
  int iVar1;
  CHAR local_10 [6];
  undefined1 local_a;
  int local_8;
  
  local_8 = DAT_10041558;
  local_a = 0;
  iVar1 = GetLocaleInfoA(param_1,0x1004,local_10,6);
  if (iVar1 != 0) {
    _atol(local_10);
  }
  FUN_1002d447(local_8);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  ___convertcp
// 
// Library: Visual Studio 2003 Release

void __cdecl
___convertcp(UINT param_1,UINT param_2,char *param_3,size_t *param_4,LPSTR param_5,int param_6)

{
  size_t cbMultiByte;
  bool bVar1;
  bool bVar2;
  BOOL BVar3;
  int iVar4;
  LPSTR lpMultiByteStr;
  size_t sVar5;
  LPCWSTR local_4c;
  size_t local_3c;
  _cpinfo local_34;
  int local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_10040198;
  uStack_c = 0x10036ba2;
  local_20 = DAT_10041558;
  bVar2 = false;
  cbMultiByte = *param_4;
  bVar1 = false;
  if (param_1 != param_2) {
    BVar3 = GetCPInfo(param_1,&local_34);
    if ((((BVar3 != 0) && (local_34.MaxCharSize == 1)) &&
        (BVar3 = GetCPInfo(param_2,&local_34), BVar3 != 0)) && (local_34.MaxCharSize == 1)) {
      bVar1 = true;
    }
    if ((bVar1) && (local_3c = cbMultiByte, cbMultiByte == 0xffffffff)) {
      sVar5 = _strlen(param_3);
      local_3c = sVar5 + 1;
    }
    if ((!bVar1) &&
       (local_3c = MultiByteToWideChar(param_1,1,param_3,cbMultiByte,(LPWSTR)0x0,0), local_3c == 0))
    goto LAB_10036d4e;
    local_8 = (undefined *)0x0;
    local_1c = &stack0xffffffa8;
    local_4c = (LPCWSTR)&stack0xffffffa8;
    _memset(&stack0xffffffa8,0,local_3c * 2);
    local_8 = (undefined *)0xffffffff;
    if (&stack0x00000000 == (undefined1 *)0x58) {
      local_4c = (LPCWSTR)_calloc(2,local_3c);
      if (local_4c == (LPCWSTR)0x0) goto LAB_10036d4e;
      bVar2 = true;
    }
    iVar4 = MultiByteToWideChar(param_1,1,param_3,cbMultiByte,local_4c,local_3c);
    if (iVar4 != 0) {
      if (param_5 == (LPSTR)0x0) {
        if (((bVar1) ||
            (local_3c = WideCharToMultiByte(param_2,0,local_4c,local_3c,(LPSTR)0x0,0,(LPCSTR)0x0,
                                            (LPBOOL)0x0), local_3c != 0)) &&
           (lpMultiByteStr = (LPSTR)_calloc(1,local_3c), lpMultiByteStr != (LPSTR)0x0)) {
          sVar5 = WideCharToMultiByte(param_2,0,local_4c,local_3c,lpMultiByteStr,local_3c,
                                      (LPCSTR)0x0,(LPBOOL)0x0);
          if (sVar5 == 0) {
            _free(lpMultiByteStr);
          }
          else if (cbMultiByte != 0xffffffff) {
            *param_4 = sVar5;
          }
        }
      }
      else {
        WideCharToMultiByte(param_2,0,local_4c,local_3c,param_5,param_6,(LPCSTR)0x0,(LPBOOL)0x0);
      }
    }
  }
  if (bVar2) {
    _free(local_4c);
  }
LAB_10036d4e:
  FUN_1002d447(local_20);
  return;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// Library Function - Single Match
//  __resetstkoflw
// 
// Library: Visual Studio 2003 Release

int __cdecl __resetstkoflw(void)

{
  SIZE_T SVar1;
  BOOL BVar2;
  LPCVOID pvVar3;
  LPCVOID pvVar4;
  undefined4 uStack_60;
  _SYSTEM_INFO local_50;
  _MEMORY_BASIC_INFORMATION local_2c;
  DWORD local_10;
  SIZE_T local_c;
  LPCVOID local_8;
  
  uStack_60 = 0x10036d70;
  SVar1 = VirtualQuery(&uStack_60,&local_2c,0x1c);
  if (SVar1 != 0) {
    GetSystemInfo(&local_50);
    pvVar4 = (LPCVOID)((~(local_50.dwPageSize - 1) & (uint)&uStack_60) - local_50.dwPageSize);
    pvVar3 = (LPCVOID)(((-(uint)(DAT_10053014 != 1) & 0xfffffff1) + 0x11) * local_50.dwPageSize +
                      (int)local_2c.AllocationBase);
    local_c = local_50.dwPageSize;
    if (pvVar3 <= pvVar4) {
      local_8 = pvVar4;
      if (DAT_10053014 != 1) {
        local_8 = local_2c.AllocationBase;
        do {
          SVar1 = VirtualQuery(local_8,&local_2c,0x1c);
          if (SVar1 == 0) {
            return 0;
          }
          local_8 = (LPCVOID)((int)local_8 + local_2c.RegionSize);
        } while ((local_2c.State & 0x1000) == 0);
        local_8 = local_2c.BaseAddress;
        if ((local_2c.Protect._1_1_ & 1) != 0) {
          return 1;
        }
        if (pvVar4 < local_2c.BaseAddress) {
          return 0;
        }
        if (local_2c.BaseAddress < pvVar3) {
          local_8 = pvVar3;
        }
        VirtualAlloc(local_8,local_c,0x1000,4);
      }
      BVar2 = VirtualProtect(local_8,local_c,(-(uint)(DAT_10053014 != 1) & 0x103) + 1,&local_10);
      return BVar2;
    }
  }
  return 0;
}



// Library Function - Single Match
//  ___addl
// 
// Library: Visual Studio 2003 Release

undefined4 __cdecl ___addl(uint param_1,uint param_2,uint *param_3)

{
  uint uVar1;
  undefined4 uVar2;
  
  uVar1 = param_1 + param_2;
  uVar2 = 0;
  if ((uVar1 < param_1) || (uVar1 < param_2)) {
    uVar2 = 1;
  }
  *param_3 = uVar1;
  return uVar2;
}



// Library Function - Single Match
//  ___add_12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___add_12(uint *param_1,uint *param_2)

{
  int iVar1;
  
  iVar1 = ___addl(*param_1,*param_2,param_1);
  if (iVar1 != 0) {
    iVar1 = ___addl(param_1[1],1,param_1 + 1);
    if (iVar1 != 0) {
      param_1[2] = param_1[2] + 1;
    }
  }
  iVar1 = ___addl(param_1[1],param_2[1],param_1 + 1);
  if (iVar1 != 0) {
    param_1[2] = param_1[2] + 1;
  }
  ___addl(param_1[2],param_2[2],param_1 + 2);
  return;
}



// Library Function - Single Match
//  ___shl_12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___shl_12(uint *param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *param_1;
  uVar2 = param_1[1];
  *param_1 = uVar1 * 2;
  param_1[1] = uVar2 * 2 | uVar1 >> 0x1f;
  param_1[2] = param_1[2] << 1 | uVar2 >> 0x1f;
  return;
}



// Library Function - Single Match
//  ___shr_12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___shr_12(uint *param_1)

{
  uint uVar1;
  
  uVar1 = param_1[1];
  param_1[1] = uVar1 >> 1 | param_1[2] << 0x1f;
  param_1[2] = param_1[2] >> 1;
  *param_1 = *param_1 >> 1 | uVar1 << 0x1f;
  return;
}



// Library Function - Single Match
//  ___mtold12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___mtold12(char *param_1,int param_2,uint *param_3)

{
  short sVar1;
  uint *puVar2;
  uint uVar3;
  uint local_14;
  uint local_10;
  uint local_c;
  int local_8;
  
  puVar2 = param_3;
  local_8 = DAT_10041558;
  sVar1 = 0x404e;
  *param_3 = 0;
  param_3[1] = 0;
  param_3[2] = 0;
  if (param_2 != 0) {
    param_3 = (uint *)param_2;
    do {
      local_14 = *puVar2;
      local_10 = puVar2[1];
      local_c = puVar2[2];
      ___shl_12(puVar2);
      ___shl_12(puVar2);
      ___add_12(puVar2,&local_14);
      ___shl_12(puVar2);
      local_14 = (uint)*param_1;
      local_10 = 0;
      local_c = 0;
      ___add_12(puVar2,&local_14);
      param_1 = param_1 + 1;
      param_3 = (uint *)((int)param_3 + -1);
    } while (param_3 != (uint *)0x0);
  }
  if (puVar2[2] == 0) {
    do {
      sVar1 = sVar1 + -0x10;
      uVar3 = puVar2[1] >> 0x10;
      puVar2[1] = *puVar2 >> 0x10 | puVar2[1] << 0x10;
      *puVar2 = *puVar2 << 0x10;
    } while (uVar3 == 0);
    puVar2[2] = uVar3;
  }
  while ((puVar2[2] & 0x8000) == 0) {
    ___shl_12(puVar2);
    sVar1 = sVar1 + -1;
  }
  *(short *)((int)puVar2 + 10) = sVar1;
  FUN_1002d447(local_8);
  return;
}



// Library Function - Single Match
//  ___strgtold12
// 
// Library: Visual Studio 2003 Release

uint __cdecl
___strgtold12(_LDBL12 *pld12,char **p_end_ptr,char *str,int mult12,int scale,int decpt,
             int implicit_E)

{
  bool bVar1;
  bool bVar2;
  bool bVar3;
  ushort uVar4;
  int iVar5;
  uint uVar6;
  byte bVar7;
  undefined4 uVar8;
  char *pcVar9;
  byte *pbVar10;
  int local_58;
  int local_50;
  byte *local_44;
  int local_40;
  uint local_3c;
  char local_34 [23];
  char local_1d;
  undefined2 local_18;
  undefined2 uStack_16;
  undefined2 uStack_14;
  undefined4 local_12;
  ushort local_e;
  int local_8;
  
  local_8 = DAT_10041558;
  iVar5 = 0;
  pcVar9 = local_34;
  uVar4 = 0;
  local_50 = 1;
  local_3c = 0;
  bVar1 = false;
  bVar3 = false;
  bVar2 = false;
  local_58 = 0;
  local_40 = 0;
  local_44 = (byte *)str;
  for (; (((bVar7 = *str, bVar7 == 0x20 || (bVar7 == 9)) || (bVar7 == 10)) || (bVar7 == 0xd));
      str = (char *)((byte *)str + 1)) {
  }
LAB_10037051:
  bVar7 = *str;
  pbVar10 = (byte *)str + 1;
  switch(iVar5) {
  case 0:
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) {
LAB_1003706e:
      iVar5 = 3;
      goto LAB_1003728f;
    }
    if (bVar7 == DAT_10041eb4) {
LAB_1003707d:
      iVar5 = 5;
      str = (char *)pbVar10;
      goto LAB_10037051;
    }
    if (bVar7 == 0x2b) {
      uVar4 = 0;
      iVar5 = 2;
      str = (char *)pbVar10;
      goto LAB_10037051;
    }
    if (bVar7 == 0x2d) {
      iVar5 = 2;
      uVar4 = 0x8000;
      str = (char *)pbVar10;
      goto LAB_10037051;
    }
    break;
  case 1:
    iVar5 = 1;
    bVar1 = true;
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1003706e;
    if (bVar7 == DAT_10041eb4) goto LAB_100370cf;
    if ((bVar7 == 0x2b) || (bVar7 == 0x2d)) goto LAB_10037110;
    str = (char *)pbVar10;
    if (bVar7 != 0x30) goto LAB_100370e9;
    goto LAB_10037051;
  case 2:
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1003706e;
    str = (char *)local_44;
    if (bVar7 == DAT_10041eb4) goto LAB_1003707d;
    break;
  case 3:
    while (iVar5 = _isdigit((uint)bVar7), iVar5 != 0) {
      if (local_3c < 0x19) {
        local_3c = local_3c + 1;
        *pcVar9 = bVar7 - 0x30;
        pcVar9 = pcVar9 + 1;
      }
      else {
        local_40 = local_40 + 1;
      }
      bVar7 = *pbVar10;
      pbVar10 = pbVar10 + 1;
    }
    if (bVar7 != DAT_10041eb4) goto LAB_100371bf;
LAB_100370cf:
    bVar1 = true;
    iVar5 = 4;
    str = (char *)pbVar10;
    goto LAB_10037051;
  case 4:
    bVar3 = true;
    if (local_3c == 0) {
      while (bVar7 == 0x30) {
        local_40 = local_40 + -1;
        bVar7 = *pbVar10;
        pbVar10 = pbVar10 + 1;
      }
    }
    while (iVar5 = _isdigit((uint)bVar7), iVar5 != 0) {
      if (local_3c < 0x19) {
        local_3c = local_3c + 1;
        *pcVar9 = bVar7 - 0x30;
        pcVar9 = pcVar9 + 1;
        local_40 = local_40 + -1;
      }
      bVar7 = *pbVar10;
      pbVar10 = pbVar10 + 1;
    }
LAB_100371bf:
    if ((bVar7 == 0x2b) || (bVar7 == 0x2d)) {
LAB_10037110:
      bVar1 = true;
      iVar5 = 0xb;
      str = (char *)(pbVar10 + -1);
    }
    else {
LAB_100370e9:
      bVar1 = true;
      if (((char)bVar7 < 'D') ||
         (('E' < (char)bVar7 && (((char)bVar7 < 'd' || ('e' < (char)bVar7)))))) {
LAB_10037249:
        str = (char *)(pbVar10 + -1);
        goto LAB_1003724d;
      }
      iVar5 = 6;
      str = (char *)pbVar10;
    }
    goto LAB_10037051;
  case 5:
    bVar3 = true;
    iVar5 = _isdigit((uint)bVar7);
    str = (char *)local_44;
    if (iVar5 != 0) {
      iVar5 = 4;
      goto LAB_1003728f;
    }
    goto LAB_1003724d;
  case 6:
    local_44 = (byte *)str + -1;
    if (((char)bVar7 < '1') || ('9' < (char)bVar7)) {
      if (bVar7 == 0x2b) goto LAB_100372c4;
      if (bVar7 == 0x2d) goto LAB_100372b8;
      str = (char *)local_44;
      if (bVar7 == 0x30) goto LAB_10037227;
      goto LAB_1003724d;
    }
LAB_1003728d:
    iVar5 = 9;
LAB_1003728f:
    str = (char *)(pbVar10 + -1);
    goto LAB_10037051;
  case 7:
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1003728d;
    str = (char *)local_44;
    if (bVar7 != 0x30) goto LAB_1003724d;
LAB_10037227:
    iVar5 = 8;
    str = (char *)pbVar10;
    goto LAB_10037051;
  case 8:
    bVar2 = true;
    while (bVar7 == 0x30) {
      bVar7 = *pbVar10;
      pbVar10 = pbVar10 + 1;
    }
    if (('0' < (char)bVar7) && ((char)bVar7 < ':')) goto LAB_1003728d;
    goto LAB_10037249;
  case 9:
    bVar2 = true;
    local_58 = 0;
    goto LAB_1003730b;
  default:
    goto switchD_1003705d_caseD_a;
  case 0xb:
    if (implicit_E != 0) {
      local_44 = (byte *)str;
      if (bVar7 == 0x2b) {
LAB_100372c4:
        iVar5 = 7;
        str = (char *)pbVar10;
      }
      else {
        if (bVar7 != 0x2d) goto LAB_1003724d;
LAB_100372b8:
        local_50 = -1;
        iVar5 = 7;
        str = (char *)pbVar10;
      }
      goto LAB_10037051;
    }
    iVar5 = 10;
    pbVar10 = (byte *)str;
switchD_1003705d_caseD_a:
    str = (char *)pbVar10;
    if (iVar5 != 10) goto LAB_10037051;
    goto LAB_1003724d;
  }
  if (bVar7 != 0x30) goto LAB_1003724d;
  iVar5 = 1;
  str = (char *)pbVar10;
  goto LAB_10037051;
LAB_1003730b:
  iVar5 = _isdigit((uint)bVar7);
  if (iVar5 == 0) goto LAB_1003732e;
  local_58 = (char)bVar7 + -0x30 + local_58 * 10;
  if (0x1450 < local_58) {
    local_58 = 0x1451;
    goto LAB_1003732e;
  }
  bVar7 = *pbVar10;
  pbVar10 = pbVar10 + 1;
  goto LAB_1003730b;
LAB_1003732e:
  while( true ) {
    iVar5 = _isdigit((uint)bVar7);
    if (iVar5 == 0) break;
    bVar7 = *pbVar10;
    pbVar10 = pbVar10 + 1;
  }
  str = (char *)(pbVar10 + -1);
LAB_1003724d:
  *p_end_ptr = str;
  if (bVar1) {
    if (0x18 < local_3c) {
      if ('\x04' < local_1d) {
        local_1d = local_1d + '\x01';
      }
      pcVar9 = pcVar9 + -1;
      local_40 = local_40 + 1;
      local_3c = 0x18;
    }
    if (local_3c != 0) {
      while (pcVar9 = pcVar9 + -1, *pcVar9 == '\0') {
        local_3c = local_3c - 1;
        local_40 = local_40 + 1;
      }
      ___mtold12(local_34,local_3c,(uint *)&local_18);
      if (local_50 < 0) {
        local_58 = -local_58;
      }
      uVar6 = local_58 + local_40;
      if (!bVar2) {
        uVar6 = uVar6 + scale;
      }
      if (!bVar3) {
        uVar6 = uVar6 - decpt;
      }
      if (0x1450 < (int)uVar6) {
        uVar8 = 0;
        local_e = 0x7fff;
        local_12 = 0x80000000;
        local_18 = 0;
        goto LAB_100373db;
      }
      if (-0x1451 < (int)uVar6) {
        ___multtenpow12((int *)&local_18,uVar6,mult12);
        uVar8 = CONCAT22(uStack_14,uStack_16);
        goto LAB_100373db;
      }
    }
  }
  local_18 = 0;
  local_e = 0;
  local_12 = 0;
  uVar8 = 0;
LAB_100373db:
  *(undefined4 *)(pld12->ld12 + 6) = local_12;
  *(undefined4 *)(pld12->ld12 + 2) = uVar8;
  *(ushort *)(pld12->ld12 + 10) = local_e | uVar4;
  *(undefined2 *)pld12->ld12 = local_18;
  uVar6 = FUN_1002d447(local_8);
  return uVar6;
}



// Library Function - Single Match
//  _$I10_OUTPUT
// 
// Library: Visual Studio 2003 Release

void __cdecl
_I10_OUTPUT(int param_1,uint param_2,uint param_3,int param_4,byte param_5,short *param_6)

{
  short *psVar1;
  char cVar2;
  uint uVar3;
  short *psVar4;
  short *psVar5;
  short sVar6;
  int iVar7;
  char *pcVar8;
  short *local_34;
  uint local_2c;
  undefined4 uStack_28;
  undefined4 uStack_24;
  undefined1 local_20;
  undefined1 local_1f;
  undefined1 local_1e;
  undefined1 local_1d;
  undefined1 local_1c;
  undefined1 local_1b;
  undefined1 local_1a;
  undefined1 local_19;
  undefined1 local_18;
  undefined1 local_17;
  undefined1 local_16;
  undefined1 local_15;
  undefined2 local_14;
  undefined4 local_12;
  undefined4 local_e;
  undefined1 local_a;
  char cStack_9;
  int local_8;
  
  local_8 = DAT_10041558;
  uVar3 = param_3 & 0x7fff;
  local_20 = 0xcc;
  local_1f = 0xcc;
  local_1e = 0xcc;
  local_1d = 0xcc;
  local_1c = 0xcc;
  local_1b = 0xcc;
  local_1a = 0xcc;
  local_19 = 0xcc;
  local_18 = 0xcc;
  local_17 = 0xcc;
  local_16 = 0xfb;
  local_15 = 0x3f;
  if ((param_3 & 0x8000) == 0) {
    *(undefined1 *)(param_6 + 1) = 0x20;
  }
  else {
    *(undefined1 *)(param_6 + 1) = 0x2d;
  }
  if ((((short)uVar3 == 0) && (param_2 == 0)) && (param_1 == 0)) {
LAB_100375a4:
    *(undefined1 *)(param_6 + 2) = 0x30;
LAB_100376a7:
    *param_6 = 0;
    *(undefined1 *)(param_6 + 1) = 0x20;
    *(undefined1 *)((int)param_6 + 3) = 1;
    *(undefined1 *)((int)param_6 + 5) = 0;
  }
  else {
    if ((short)uVar3 == 0x7fff) {
      *param_6 = 1;
      if (((param_2 == 0x80000000) && (param_1 == 0)) || ((param_2 & 0x40000000) != 0)) {
        if (((param_3 & 0x8000) == 0) || (param_2 != 0xc0000000)) {
          if ((param_2 != 0x80000000) || (param_1 != 0)) goto LAB_1003751a;
          pcVar8 = "1#INF";
        }
        else {
          if (param_1 != 0) {
LAB_1003751a:
            pcVar8 = "1#QNAN";
            goto LAB_1003751f;
          }
          pcVar8 = "1#IND";
        }
        FUN_10034d50((uint *)(param_6 + 2),(uint *)pcVar8);
        *(undefined1 *)((int)param_6 + 3) = 5;
      }
      else {
        pcVar8 = "1#SNAN";
LAB_1003751f:
        FUN_10034d50((uint *)(param_6 + 2),(uint *)pcVar8);
        *(undefined1 *)((int)param_6 + 3) = 6;
      }
      goto LAB_10037689;
    }
    local_14 = 0;
    sVar6 = (short)(((uVar3 >> 8) + (param_2 >> 0x18) * 2) * 0x4d + -0x134312f4 + uVar3 * 0x4d10 >>
                   0x10);
    local_a = (undefined1)uVar3;
    cStack_9 = (char)(uVar3 >> 8);
    local_12 = param_1;
    local_e = param_2;
    ___multtenpow12((int *)&local_14,-(int)sVar6,1);
    if (0x3ffe < CONCAT11(cStack_9,local_a)) {
      sVar6 = sVar6 + 1;
      ___ld12mul((int *)&local_14,(int *)&local_20);
    }
    *param_6 = sVar6;
    if (((param_5 & 1) != 0) && (param_4 = param_4 + sVar6, param_4 < 1)) goto LAB_100375a4;
    if (0x15 < param_4) {
      param_4 = 0x15;
    }
    iVar7 = CONCAT11(cStack_9,local_a) - 0x3ffe;
    local_a = 0;
    cStack_9 = '\0';
    param_3 = 8;
    do {
      ___shl_12((uint *)&local_14);
      param_3 = param_3 - 1;
    } while (param_3 != 0);
    if (iVar7 < 0) {
      for (uVar3 = -iVar7 & 0xff; uVar3 != 0; uVar3 = uVar3 - 1) {
        ___shr_12((uint *)&local_14);
      }
    }
    param_3 = param_4 + 1;
    psVar4 = param_6 + 2;
    local_34 = psVar4;
    iVar7 = local_12;
    uVar3 = local_e;
    if (0 < (int)param_3) {
      do {
        local_e._2_2_ = (undefined2)(uVar3 >> 0x10);
        local_e._0_2_ = (undefined2)uVar3;
        local_12._2_2_ = (undefined2)((uint)iVar7 >> 0x10);
        local_12._0_2_ = (undefined2)iVar7;
        local_2c = CONCAT22((undefined2)local_12,local_14);
        uStack_28 = CONCAT22((undefined2)local_e,local_12._2_2_);
        uStack_24 = CONCAT13(cStack_9,CONCAT12(local_a,local_e._2_2_));
        local_12 = iVar7;
        local_e = uVar3;
        ___shl_12((uint *)&local_14);
        ___shl_12((uint *)&local_14);
        ___add_12((uint *)&local_14,&local_2c);
        ___shl_12((uint *)&local_14);
        psVar4 = (short *)((int)local_34 + 1);
        param_3 = param_3 - 1;
        *(char *)local_34 = cStack_9 + '0';
        cStack_9 = '\0';
        local_34 = psVar4;
        iVar7 = local_12;
        uVar3 = local_e;
      } while (param_3 != 0);
    }
    psVar5 = psVar4 + -1;
    psVar1 = param_6 + 2;
    if (*(char *)((int)psVar4 + -1) < '5') {
      for (; (psVar1 <= psVar5 && ((char)*psVar5 == '0')); psVar5 = (short *)((int)psVar5 + -1)) {
      }
      if (psVar5 < psVar1) {
        *(char *)psVar1 = '0';
        goto LAB_100376a7;
      }
    }
    else {
      for (; (psVar1 <= psVar5 && ((char)*psVar5 == '9')); psVar5 = (short *)((int)psVar5 + -1)) {
        *(char *)psVar5 = '0';
      }
      if (psVar5 < psVar1) {
        psVar5 = (short *)((int)psVar5 + 1);
        *param_6 = *param_6 + 1;
      }
      *(char *)psVar5 = (char)*psVar5 + '\x01';
    }
    cVar2 = ((char)psVar5 - (char)param_6) + -3;
    *(char *)((int)param_6 + 3) = cVar2;
    *(undefined1 *)(cVar2 + 4 + (int)param_6) = 0;
  }
LAB_10037689:
  FUN_1002d447(local_8);
  return;
}



// Library Function - Single Match
//  _siglookup
// 
// Library: Visual Studio 2003 Release

void __cdecl siglookup(void)

{
  uint uVar1;
  uint in_EDX;
  int unaff_ESI;
  
  uVar1 = in_EDX;
  do {
    if (*(int *)(uVar1 + 4) == unaff_ESI) {
      return;
    }
    uVar1 = uVar1 + 0xc;
  } while (uVar1 < in_EDX + DAT_100419fc * 0xc);
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  _raise
// 
// Library: Visual Studio 2003 Release

int __cdecl _raise(int _SigNum)

{
  bool bVar1;
  int iVar2;
  undefined4 *puVar3;
  code *pcVar4;
  void *local_34;
  void *local_30;
  _ptiddata local_28;
  
  bVar1 = false;
  if (_SigNum == 2) {
    puVar3 = &DAT_10053328;
    pcVar4 = DAT_10053328;
LAB_10037777:
    bVar1 = true;
  }
  else {
    if (((_SigNum != 4) && (_SigNum != 8)) && (_SigNum != 0xb)) {
      if (_SigNum == 0xf) {
        puVar3 = &DAT_10053334;
        pcVar4 = DAT_10053334;
      }
      else if (_SigNum == 0x15) {
        puVar3 = &DAT_1005332c;
        pcVar4 = DAT_1005332c;
      }
      else {
        if (_SigNum != 0x16) {
          return -1;
        }
        puVar3 = &DAT_10053330;
        pcVar4 = DAT_10053330;
      }
      goto LAB_10037777;
    }
    local_28 = __getptd();
    iVar2 = siglookup();
    puVar3 = (undefined4 *)(iVar2 + 8);
    pcVar4 = (code *)*puVar3;
  }
  if (pcVar4 == (code *)0x1) {
    return 0;
  }
  if (pcVar4 == (code *)0x0) {
                    // WARNING: Subroutine does not return
    __exit(3);
  }
  if (bVar1) {
    __lock(0);
  }
  if (((_SigNum == 8) || (_SigNum == 0xb)) || (_SigNum == 4)) {
    local_30 = local_28->_initarg;
    local_28->_initarg = (void *)0x0;
    if (_SigNum == 8) {
      local_34 = local_28->_pxcptacttab;
      local_28->_pxcptacttab = (void *)0x8c;
      goto LAB_100377d6;
    }
  }
  else {
LAB_100377d6:
    iVar2 = DAT_100419f0;
    if (_SigNum == 8) {
      for (; iVar2 < DAT_100419f4 + DAT_100419f0; iVar2 = iVar2 + 1) {
        *(undefined4 *)((int)local_28->_initaddr + iVar2 * 0xc + 8) = 0;
      }
      goto LAB_10037804;
    }
  }
  *puVar3 = 0;
LAB_10037804:
  FUN_10037825(0);
  if (_SigNum == 8) {
    (*pcVar4)(8,local_28->_pxcptacttab);
  }
  else {
    (*pcVar4)(_SigNum);
    if ((_SigNum != 0xb) && (_SigNum != 4)) {
      return 0;
    }
  }
  local_28->_initarg = local_30;
  if (_SigNum == 8) {
    local_28->_pxcptacttab = local_34;
  }
  return 0;
}



void __fastcall FUN_10037825(int param_1)

{
  int unaff_EBP;
  
  if (*(int *)(unaff_EBP + -0x1c) != param_1) {
    FUN_1002f8d0(param_1);
  }
  return;
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// Library Function - Single Match
//  __msize
// 
// Library: Visual Studio 2003 Release

size_t __cdecl __msize(void *_Memory)

{
  uint uVar1;
  SIZE_T SVar2;
  size_t local_20;
  
  if (DAT_100535c0 == 3) {
    __lock(4);
    uVar1 = ___sbh_find_block((int)_Memory);
    if (uVar1 != 0) {
      local_20 = *(int *)((int)_Memory + -4) - 9;
    }
    FUN_100378d0();
    if (uVar1 != 0) {
      return local_20;
    }
  }
  SVar2 = HeapSize(DAT_100535bc,0,_Memory);
  return SVar2;
}



void FUN_100378d0(void)

{
  FUN_1002f8d0(4);
  return;
}



// Library Function - Single Match
//  __mbsnbicoll
// 
// Library: Visual Studio 2003 Release

int __cdecl __mbsnbicoll(uchar *_Str1,uchar *_Str2,size_t _MaxCount)

{
  _ptiddata p_Var1;
  pthreadmbcinfo ptVar2;
  int iVar3;
  int unaff_EBP;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadmbcinfo)p_Var1->_tpxcptinfoptrs;
  if (ptVar2 != DAT_10053364) {
    ptVar2 = ___updatetmbcinfo();
  }
  if (_MaxCount == 0) {
    return 0;
  }
  iVar3 = ___crtCompareStringA
                    (*(_locale_t *)ptVar2->mbulinfo,(LPCWSTR)0x1,(DWORD)_Str1,(LPCSTR)_MaxCount,
                     (int)_Str2,(LPCSTR)_MaxCount,ptVar2->mbcodepage,unaff_EBP);
  if (iVar3 == 0) {
    return 0x7fffffff;
  }
  return iVar3 + -2;
}



// Library Function - Single Match
//  ___wtomb_environ
// 
// Library: Visual Studio 2003 Release

int __cdecl ___wtomb_environ(void)

{
  LPCWSTR lpWideCharStr;
  size_t _Size;
  int iVar1;
  undefined4 *puVar2;
  char *local_8;
  
  local_8 = (LPSTR)0x0;
  lpWideCharStr = (LPCWSTR)*DAT_1005303c;
  puVar2 = DAT_1005303c;
  while( true ) {
    if (lpWideCharStr == (LPCWSTR)0x0) {
      return 0;
    }
    _Size = WideCharToMultiByte(0,0,lpWideCharStr,-1,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
    if ((_Size == 0) || (local_8 = (char *)_malloc(_Size), local_8 == (LPSTR)0x0)) break;
    iVar1 = WideCharToMultiByte(0,0,(LPCWSTR)*puVar2,-1,local_8,_Size,(LPCSTR)0x0,(LPBOOL)0x0);
    if (iVar1 == 0) {
      _free(local_8);
      return -1;
    }
    iVar1 = ___crtsetenv(&local_8,0);
    if ((iVar1 < 0) && (local_8 != (LPSTR)0x0)) {
      _free(local_8);
      local_8 = (LPSTR)0x0;
    }
    puVar2 = puVar2 + 1;
    lpWideCharStr = (LPCWSTR)*puVar2;
  }
  return -1;
}



// WARNING: Function: __chkstk replaced with injection: alloca_probe
// Library Function - Single Match
//  __chsize_lk
// 
// Library: Visual Studio 2003 Release

void __cdecl __chsize_lk(uint param_1,int param_2)

{
  DWORD DVar1;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  ulong *puVar6;
  int *piVar7;
  HANDLE hFile;
  BOOL BVar8;
  uint uVar9;
  char local_1008 [4096];
  int local_8;
  
  local_8 = DAT_10041558;
  DVar1 = __lseek_lk(param_1,0,1);
  if ((DVar1 != 0xffffffff) && (DVar2 = __lseek_lk(param_1,0,2), DVar2 != 0xffffffff)) {
    uVar9 = param_2 - DVar2;
    if ((int)uVar9 < 1) {
      if ((int)uVar9 < 0) {
        __lseek_lk(param_1,param_2,0);
        hFile = (HANDLE)__get_osfhandle(param_1);
        BVar8 = SetEndOfFile(hFile);
        if (BVar8 == 0) {
          piVar7 = FUN_1003366f();
          *piVar7 = 0xd;
          puVar6 = FUN_10033678();
          DVar2 = GetLastError();
          *puVar6 = DVar2;
        }
      }
    }
    else {
      _memset(local_1008,0,0x1000);
      iVar3 = __setmode_lk(param_1,0x8000);
      do {
        uVar4 = 0x1000;
        if ((int)uVar9 < 0x1000) {
          uVar4 = uVar9;
        }
        iVar5 = __write_lk(param_1,local_1008,uVar4);
        if (iVar5 == -1) {
          puVar6 = FUN_10033678();
          if (*puVar6 == 5) {
            piVar7 = FUN_1003366f();
            *piVar7 = 0xd;
          }
          break;
        }
        uVar9 = uVar9 - iVar5;
      } while (0 < (int)uVar9);
      __setmode_lk(param_1,iVar3);
    }
    __lseek_lk(param_1,DVar1,0);
  }
  FUN_1002d447(local_8);
  return;
}



// Library Function - Single Match
//  ___ascii_stricmp
// 
// Library: Visual Studio 2003 Release

int __cdecl ___ascii_stricmp(char *_Str1,char *_Str2)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  
  bVar3 = 0xff;
  do {
    do {
      if (bVar3 == 0) goto LAB_10037b46;
      bVar3 = *_Str2;
      _Str2 = (char *)((byte *)_Str2 + 1);
      bVar2 = *_Str1;
      _Str1 = (char *)((byte *)_Str1 + 1);
    } while (bVar2 == bVar3);
    bVar1 = bVar3 + 0xbf + (-((byte)(bVar3 + 0xbf) < 0x1a) & 0x20U) + 0x41;
    bVar2 = bVar2 + 0xbf;
    bVar3 = bVar2 + (-(bVar2 < 0x1a) & 0x20U) + 0x41;
  } while (bVar3 == bVar1);
  bVar3 = (bVar3 < bVar1) * -2 + 1;
LAB_10037b46:
  return (int)(char)bVar3;
}



// Library Function - Single Match
//  __stricmp
// 
// Library: Visual Studio 2003 Release

int __cdecl __stricmp(char *_Str1,char *_Str2)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  int iVar3;
  void *pvVar4;
  void *this;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this_00;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (ptVar2->lc_category[0].wlocale == (wchar_t *)0x0) {
    iVar3 = ___ascii_stricmp(_Str1,_Str2);
  }
  else {
    do {
      pvVar4 = (void *)___tolower_mt(this,(int)ptVar2,(uint)(byte)*_Str1);
      _Str1 = (char *)((byte *)_Str1 + 1);
      this = (void *)___tolower_mt(this_00,(int)ptVar2,(uint)(byte)*_Str2);
      _Str2 = (char *)((byte *)_Str2 + 1);
      if (pvVar4 == (void *)0x0) break;
    } while (pvVar4 == this);
    iVar3 = (int)pvVar4 - (int)this;
  }
  return iVar3;
}



// Library Function - Single Match
//  __strnicmp
// 
// Library: Visual Studio 2003 Release

int __cdecl __strnicmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  _ptiddata p_Var1;
  pthreadlocinfo ptVar2;
  int iVar3;
  void *pvVar4;
  void *this;
  void *extraout_ECX;
  void *extraout_ECX_00;
  void *this_00;
  
  p_Var1 = __getptd();
  ptVar2 = (pthreadlocinfo)p_Var1->_tfpecode;
  this = extraout_ECX;
  if (ptVar2 != (pthreadlocinfo)PTR_DAT_10041d74) {
    ptVar2 = ___updatetlocinfo();
    this = extraout_ECX_00;
  }
  if (_MaxCount == 0) {
    iVar3 = 0;
  }
  else if (ptVar2->lc_category[0].wlocale == (wchar_t *)0x0) {
    iVar3 = ___ascii_strnicmp(_Str1,_Str2,_MaxCount);
  }
  else {
    do {
      pvVar4 = (void *)___tolower_mt(this,(int)ptVar2,(uint)(byte)*_Str1);
      _Str1 = (char *)((byte *)_Str1 + 1);
      this = (void *)___tolower_mt(this_00,(int)ptVar2,(uint)(byte)*_Str2);
      _Str2 = (char *)((byte *)_Str2 + 1);
      _MaxCount = _MaxCount - 1;
      if ((_MaxCount == 0) || (pvVar4 == (void *)0x0)) break;
    } while (pvVar4 == this);
    iVar3 = (int)pvVar4 - (int)this;
  }
  return iVar3;
}



// Library Function - Single Match
//  ___ld12mul
// 
// Library: Visual Studio 2003 Release

void __cdecl ___ld12mul(int *param_1,int *param_2)

{
  int *piVar1;
  short sVar2;
  int iVar3;
  int *piVar4;
  int *piVar5;
  ushort uVar6;
  uint uVar7;
  int iVar8;
  ushort uVar9;
  uint uVar10;
  ushort uVar11;
  int *local_2c;
  ushort *local_28;
  ushort *local_24;
  int local_20;
  int local_1c;
  short *local_18;
  byte local_14;
  undefined1 uStack_13;
  undefined4 uStack_12;
  undefined4 uStack_e;
  undefined2 uStack_a;
  int local_8;
  
  piVar5 = param_2;
  piVar4 = param_1;
  local_8 = DAT_10041558;
  local_20 = 0;
  local_14 = 0;
  uStack_13 = 0;
  uStack_12._0_2_ = 0;
  uStack_12._2_2_ = 0;
  uStack_e._0_2_ = 0;
  uStack_e._2_2_ = 0;
  uStack_a._0_1_ = 0;
  uStack_a._1_1_ = 0;
  uVar10 = *(ushort *)((int)param_2 + 10) & 0x7fff;
  uVar7 = *(ushort *)((int)param_1 + 10) & 0x7fff;
  uVar11 = (*(ushort *)((int)param_2 + 10) ^ *(ushort *)((int)param_1 + 10)) & 0x8000;
  uVar6 = (ushort)uVar7;
  piVar1 = (int *)(uVar10 + uVar7);
  iVar8 = 0;
  iVar3 = 0;
  sVar2 = 0;
  if (((uVar6 < 0x7fff) && (uVar9 = (ushort)uVar10, iVar8 = 0, iVar3 = 0, sVar2 = 0, uVar9 < 0x7fff)
      ) && (iVar8 = 0, iVar3 = 0, sVar2 = 0, (ushort)piVar1 < 0xbffe)) {
    if ((ushort)piVar1 < 0x3fc0) {
LAB_10037ce3:
      piVar4[2] = 0;
      piVar4[1] = 0;
      *piVar4 = 0;
      iVar8 = 0;
      iVar3 = 0;
      sVar2 = 0;
      goto LAB_10037e5b;
    }
    if (uVar6 == 0) {
      piVar1 = (int *)((int)piVar1 + 1);
      uVar6 = 0;
      if ((((param_1[2] & 0x7fffffffU) != 0) || (param_1[1] != 0)) ||
         (iVar8 = 0, iVar3 = 0, sVar2 = 0, *param_1 != 0)) goto LAB_10037ccd;
    }
    else {
LAB_10037ccd:
      param_1 = piVar1;
      if (((uVar9 == 0) && (param_1 = (int *)((int)param_1 + 1), (param_2[2] & 0x7fffffffU) == 0))
         && ((param_2[1] == 0 && (*param_2 == 0)))) goto LAB_10037ce3;
      local_1c = 0;
      local_18 = (short *)((int)&uStack_12 + 2);
      param_2 = (int *)0x5;
      do {
        if (0 < (int)param_2) {
          local_28 = (ushort *)(local_1c * 2 + (int)piVar4);
          local_24 = (ushort *)(piVar5 + 2);
          local_2c = param_2;
          do {
            iVar8 = ___addl(*(uint *)(local_18 + -2),(uint)*local_24 * (uint)*local_28,
                            (uint *)(local_18 + -2));
            if (iVar8 != 0) {
              *local_18 = *local_18 + 1;
            }
            local_28 = local_28 + 1;
            local_24 = local_24 + -1;
            local_2c = (int *)((int)local_2c + -1);
          } while (local_2c != (int *)0x0);
        }
        local_18 = local_18 + 1;
        local_1c = local_1c + 1;
        param_2 = (int *)((int)param_2 + -1);
      } while (0 < (int)param_2);
      param_1 = (int *)((int)param_1 + 0xc002);
      if ((short)(ushort)param_1 < 1) {
LAB_10037d97:
        iVar8 = (int)param_1 + 0xffff;
        param_1._0_2_ = (ushort)iVar8;
        if ((short)(ushort)param_1 < 0) {
          uVar7 = -iVar8;
          uVar10 = uVar7 & 0xffff;
          param_1._0_2_ = (ushort)param_1 + (short)uVar7;
          do {
            if ((local_14 & 1) != 0) {
              local_20 = local_20 + 1;
            }
            ___shr_12((uint *)&local_14);
            uVar10 = uVar10 - 1;
          } while (uVar10 != 0);
          if (local_20 != 0) {
            local_14 = local_14 | 1;
          }
        }
      }
      else {
        do {
          if ((uStack_a._1_1_ & 0x80) != 0) break;
          ___shl_12((uint *)&local_14);
          param_1 = (int *)((int)param_1 + 0xffff);
        } while (0 < (short)(ushort)param_1);
        if ((short)(ushort)param_1 < 1) goto LAB_10037d97;
      }
      if ((0x8000 < CONCAT11(uStack_13,local_14)) ||
         (sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a),
         iVar3 = CONCAT22(uStack_e._2_2_,(undefined2)uStack_e),
         iVar8 = CONCAT22(uStack_12._2_2_,(undefined2)uStack_12),
         (CONCAT22((undefined2)uStack_12,CONCAT11(uStack_13,local_14)) & 0x1ffff) == 0x18000)) {
        if (CONCAT22(uStack_12._2_2_,(undefined2)uStack_12) == -1) {
          iVar8 = 0;
          if (CONCAT22(uStack_e._2_2_,(undefined2)uStack_e) == -1) {
            if (CONCAT11(uStack_a._1_1_,(undefined1)uStack_a) == -1) {
              param_1._0_2_ = (ushort)param_1 + 1;
              sVar2 = -0x8000;
              iVar3 = 0;
              iVar8 = 0;
            }
            else {
              sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a) + 1;
              iVar3 = 0;
              iVar8 = 0;
            }
          }
          else {
            sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a);
            iVar3 = CONCAT22(uStack_e._2_2_,(undefined2)uStack_e) + 1;
          }
        }
        else {
          iVar8 = CONCAT22(uStack_12._2_2_,(undefined2)uStack_12) + 1;
          sVar2 = CONCAT11(uStack_a._1_1_,(undefined1)uStack_a);
          iVar3 = CONCAT22(uStack_e._2_2_,(undefined2)uStack_e);
        }
      }
      uStack_12._2_2_ = (undefined2)((uint)iVar8 >> 0x10);
      uStack_12._0_2_ = (undefined2)iVar8;
      uStack_e._2_2_ = (undefined2)((uint)iVar3 >> 0x10);
      uStack_e._0_2_ = (undefined2)iVar3;
      uStack_a._1_1_ = (byte)((ushort)sVar2 >> 8);
      uStack_a._0_1_ = (undefined1)sVar2;
      if (0x7ffe < (ushort)param_1) goto LAB_10037e40;
      *(undefined2 *)piVar4 = (undefined2)uStack_12;
      *(uint *)((int)piVar4 + 2) = CONCAT22((undefined2)uStack_e,uStack_12._2_2_);
      *(uint *)((int)piVar4 + 6) =
           CONCAT13(uStack_a._1_1_,CONCAT12((undefined1)uStack_a,uStack_e._2_2_));
      uVar6 = (ushort)param_1 | uVar11;
    }
    *(ushort *)((int)piVar4 + 10) = uVar6;
  }
  else {
LAB_10037e40:
    piVar4[1] = 0;
    *piVar4 = 0;
    piVar4[2] = (-(uint)(uVar11 != 0) & 0x80000000) + 0x7fff8000;
  }
LAB_10037e5b:
  uStack_12 = iVar8;
  uStack_e = iVar3;
  uStack_a = sVar2;
  FUN_1002d447(local_8);
  return;
}



// Library Function - Single Match
//  ___multtenpow12
// 
// Library: Visual Studio 2003 Release

void __cdecl ___multtenpow12(int *param_1,uint param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  undefined **ppuVar3;
  undefined **ppuVar4;
  undefined2 local_14;
  undefined4 local_12;
  undefined2 uStack_e;
  undefined *puStack_c;
  int local_8;
  
  local_8 = DAT_10041558;
  ppuVar3 = &PTR_s_November_10042090;
  if (param_2 != 0) {
    if ((int)param_2 < 0) {
      param_2 = -param_2;
      ppuVar3 = (undefined **)0x100421f0;
    }
    if (param_3 == 0) {
      *(undefined2 *)param_1 = 0;
    }
    while (param_2 != 0) {
      uVar1 = (int)param_2 >> 3;
      uVar2 = param_2 & 7;
      ppuVar3 = ppuVar3 + 0x15;
      param_2 = uVar1;
      if (uVar2 != 0) {
        ppuVar4 = ppuVar3 + uVar2 * 3;
        if (0x7fff < *(ushort *)ppuVar4) {
          local_14 = SUB42(*ppuVar4,0);
          local_12._0_2_ = (undefined2)((uint)*ppuVar4 >> 0x10);
          local_12._2_2_ = SUB42(ppuVar4[1],0);
          uStack_e = (undefined2)((uint)ppuVar4[1] >> 0x10);
          puStack_c = ppuVar4[2];
          local_12 = CONCAT22(local_12._2_2_,(undefined2)local_12) + -1;
          ppuVar4 = (undefined **)&local_14;
        }
        ___ld12mul(param_1,(int *)ppuVar4);
      }
    }
  }
  FUN_1002d447(local_8);
  return;
}



// Library Function - Single Match
//  _strncnt
// 
// Library: Visual Studio 2003 Release

size_t __cdecl _strncnt(char *_String,size_t _Cnt)

{
  char *in_EAX;
  char *pcVar1;
  
  pcVar1 = _String;
  if (_String != (char *)0x0) {
    do {
      pcVar1 = pcVar1 + -1;
      if (*in_EAX == '\0') goto LAB_10037f02;
      in_EAX = in_EAX + 1;
    } while (pcVar1 != (char *)0x0);
  }
  pcVar1 = pcVar1 + -1;
LAB_10037f02:
  return (size_t)(_String + (-1 - (int)pcVar1));
}



// WARNING: Function: __SEH_prolog replaced with injection: SEH_prolog
// WARNING: Function: __SEH_epilog replaced with injection: EH_epilog3
// WARNING: Function: __chkstk replaced with injection: alloca_probe
// WARNING: Unable to track spacebase fully for stack
// WARNING: This function may have set the stack pointer
// Library Function - Single Match
//  ___crtCompareStringA
// 
// Library: Visual Studio 2003 Release

int __cdecl
___crtCompareStringA
          (_locale_t _Plocinfo,LPCWSTR _LocaleName,DWORD _DwCmpFlags,LPCSTR _LpString1,
          int _CchCount1,LPCSTR _LpString2,int _CchCount2,int _Code_page)

{
  bool bVar1;
  bool bVar2;
  void *pvVar3;
  int iVar4;
  DWORD DVar5;
  BOOL BVar6;
  BYTE *pBVar7;
  undefined1 *puVar8;
  undefined1 *puVar9;
  int iVar10;
  undefined1 *puVar11;
  undefined1 *puVar12;
  int iVar13;
  UINT UVar14;
  UINT UVar15;
  undefined1 *puVar16;
  undefined1 *puVar17;
  undefined1 *puVar18;
  size_t unaff_EDI;
  void *_Memory;
  undefined4 uStackY_7c;
  void *local_3c;
  _cpinfo local_34;
  int local_20;
  undefined1 *local_1c;
  undefined4 uStack_c;
  undefined *local_8;
  
  local_8 = &DAT_100401e8;
  uStack_c = 0x10037f16;
  local_20 = DAT_10041558;
  _Memory = (void *)0x0;
  if (DAT_10053348 == 0) {
    uStackY_7c = 0x10037f3c;
    iVar4 = CompareStringW(0,0,L"",1,L"",1);
    if (iVar4 == 0) {
      DVar5 = GetLastError();
      if (DVar5 == 0x78) {
        DAT_10053348 = 2;
      }
    }
    else {
      DAT_10053348 = 1;
    }
  }
  if (0 < (int)_LpString1) {
    _LpString1 = (LPCSTR)_strncnt(_LpString1,unaff_EDI);
  }
  if (0 < (int)_LpString2) {
    _LpString2 = (LPCSTR)_strncnt(_LpString2,unaff_EDI);
  }
  if ((DAT_10053348 == 2) || (DAT_10053348 == 0)) {
    local_3c = (void *)0x0;
    if (_Plocinfo == (_locale_t)0x0) {
      _Plocinfo = DAT_100532b4;
    }
    UVar15 = _CchCount2;
    if (_CchCount2 == 0) {
      UVar15 = DAT_100532c4;
    }
    UVar14 = ___ansicp((LCID)_Plocinfo);
    if (UVar14 == 0xffffffff) goto LAB_1003827d;
    pvVar3 = (void *)_CchCount1;
    if (UVar14 != UVar15) {
      uStackY_7c = 0x10038216;
      _Memory = (void *)___convertcp(UVar15,UVar14,(char *)_DwCmpFlags,(size_t *)&_LpString1,
                                     (LPSTR)0x0,0);
      if (_Memory == (void *)0x0) goto LAB_1003827d;
      uStackY_7c = 0x10038231;
      local_3c = (void *)___convertcp(UVar15,UVar14,(char *)_CchCount1,(size_t *)&_LpString2,
                                      (LPSTR)0x0,0);
      _DwCmpFlags = (DWORD)_Memory;
      pvVar3 = local_3c;
      if (local_3c == (void *)0x0) {
        _free(_Memory);
        goto LAB_1003827d;
      }
    }
    _CchCount1 = (int)pvVar3;
    uStackY_7c = 0x10038265;
    CompareStringA((LCID)_Plocinfo,(DWORD)_LocaleName,(PCNZCH)_DwCmpFlags,(int)_LpString1,
                   (PCNZCH)_CchCount1,(int)_LpString2);
    if (_Memory != (void *)0x0) {
      _free(_Memory);
      _free(local_3c);
    }
    goto LAB_1003827d;
  }
  if (DAT_10053348 != 1) goto LAB_1003827d;
  bVar2 = false;
  bVar1 = false;
  if (_CchCount2 == 0) {
    _CchCount2 = DAT_100532c4;
  }
  if ((_LpString1 == (LPCSTR)0x0) || (_LpString2 == (LPCSTR)0x0)) {
    if ((_LpString1 == _LpString2) ||
       (((1 < (int)_LpString2 || (1 < (int)_LpString1)) ||
        (BVar6 = GetCPInfo(_CchCount2,&local_34), BVar6 == 0)))) goto LAB_1003827d;
    if (0 < (int)_LpString1) {
      if (1 < local_34.MaxCharSize) {
        pBVar7 = local_34.LeadByte;
        while (((local_34.LeadByte[0] != 0 && (pBVar7[1] != 0)) &&
               ((*(byte *)_DwCmpFlags < *pBVar7 || (pBVar7[1] < *(byte *)_DwCmpFlags))))) {
          pBVar7 = pBVar7 + 2;
          local_34.LeadByte[0] = *pBVar7;
        }
      }
      goto LAB_1003827d;
    }
    if (0 < (int)_LpString2) {
      if (1 < local_34.MaxCharSize) {
        pBVar7 = local_34.LeadByte;
        while (((local_34.LeadByte[0] != 0 && (pBVar7[1] != 0)) &&
               ((*(byte *)_CchCount1 < *pBVar7 || (pBVar7[1] < *(byte *)_CchCount1))))) {
          pBVar7 = pBVar7 + 2;
          local_34.LeadByte[0] = *pBVar7;
        }
      }
      goto LAB_1003827d;
    }
  }
  uStackY_7c = 0x10038086;
  iVar4 = MultiByteToWideChar(_CchCount2,9,(LPCSTR)_DwCmpFlags,(int)_LpString1,(LPWSTR)0x0,0);
  if (iVar4 == 0) goto LAB_1003827d;
  puVar8 = (undefined1 *)(iVar4 * 2 + 3U & 0xfffffffc);
  iVar10 = -(int)puVar8;
  puVar9 = &stack0xffffffa0 + iVar10;
  local_1c = &stack0xffffffa0 + iVar10;
  local_8 = (undefined *)0xffffffff;
  if (&stack0xffffffa0 == puVar8) {
    *(int *)(&stack0xffffff9c + iVar10) = iVar4 * 2;
    *(undefined4 *)(&stack0xffffff98 + iVar10) = 0x100380de;
    puVar9 = (undefined1 *)_malloc(*(size_t *)(&stack0xffffff9c + iVar10));
    if (puVar9 == (undefined1 *)0x0) goto LAB_1003827d;
    bVar2 = true;
  }
  *(int *)(&stack0xffffff9c + iVar10) = iVar4;
  *(undefined1 **)(&stack0xffffff98 + iVar10) = puVar9;
  *(LPCSTR *)(&stack0xffffff94 + iVar10) = _LpString1;
  *(DWORD *)(&stack0xffffff90 + iVar10) = _DwCmpFlags;
  *(undefined4 *)(&stack0xffffff8c + iVar10) = 1;
  *(int *)(&stack0xffffff88 + iVar10) = _CchCount2;
  puVar16 = (undefined1 *)((int)&uStackY_7c + iVar10);
  *(undefined4 *)((int)&uStackY_7c + iVar10) = 0x100380ff;
  iVar10 = MultiByteToWideChar(*(UINT *)(&stack0xffffff88 + iVar10),
                               *(DWORD *)(&stack0xffffff8c + iVar10),
                               *(LPCSTR *)(&stack0xffffff90 + iVar10),
                               *(int *)(&stack0xffffff94 + iVar10),
                               *(LPWSTR *)(&stack0xffffff98 + iVar10),
                               *(int *)(&stack0xffffff9c + iVar10));
  puVar8 = puVar16;
  if (iVar10 != 0) {
    *(undefined4 *)(puVar16 + -4) = 0;
    *(undefined4 *)(puVar16 + -8) = 0;
    *(LPCSTR *)(puVar16 + -0xc) = _LpString2;
    *(int *)(puVar16 + -0x10) = _CchCount1;
    *(undefined4 *)(puVar16 + -0x14) = 9;
    *(int *)(puVar16 + -0x18) = _CchCount2;
    puVar17 = puVar16 + -0x1c;
    *(undefined4 *)(puVar16 + -0x1c) = 0x1003811c;
    iVar10 = MultiByteToWideChar(*(UINT *)(puVar16 + -0x18),*(DWORD *)(puVar16 + -0x14),
                                 *(LPCSTR *)(puVar16 + -0x10),*(int *)(puVar16 + -0xc),
                                 *(LPWSTR *)(puVar16 + -8),*(int *)(puVar16 + -4));
    puVar8 = puVar17;
    if (iVar10 != 0) {
      puVar11 = (undefined1 *)(iVar10 * 2 + 3U & 0xfffffffc);
      *(undefined4 *)(puVar17 + -4) = 0x1003813e;
      iVar13 = -(int)puVar11;
      puVar12 = puVar17 + iVar13;
      puVar8 = puVar17 + iVar13;
      local_1c = puVar17 + iVar13;
      local_8 = (undefined *)0xffffffff;
      if (puVar17 == puVar11) {
        sRamfffffffc = iVar10 * 2;
        uRamfffffff8 = 0x10038171;
        puVar12 = (undefined1 *)_malloc(sRamfffffffc);
        if (puVar12 == (undefined1 *)0x0) goto LAB_100381b8;
        bVar1 = true;
      }
      *(int *)(puVar17 + iVar13 + -4) = iVar10;
      *(undefined1 **)(puVar17 + iVar13 + -8) = puVar12;
      *(LPCSTR *)(puVar17 + iVar13 + -0xc) = _LpString2;
      *(int *)(puVar17 + iVar13 + -0x10) = _CchCount1;
      *(undefined4 *)(puVar17 + iVar13 + -0x14) = 1;
      *(int *)(puVar17 + iVar13 + -0x18) = _CchCount2;
      puVar18 = puVar17 + iVar13 + -0x1c;
      *(undefined4 *)(puVar17 + iVar13 + -0x1c) = 0x10038192;
      iVar13 = MultiByteToWideChar(*(UINT *)(puVar17 + iVar13 + -0x18),
                                   *(DWORD *)(puVar17 + iVar13 + -0x14),
                                   *(LPCSTR *)(puVar17 + iVar13 + -0x10),
                                   *(int *)(puVar17 + iVar13 + -0xc),
                                   *(LPWSTR *)(puVar17 + iVar13 + -8),
                                   *(int *)(puVar17 + iVar13 + -4));
      puVar8 = puVar18;
      if (iVar13 != 0) {
        *(int *)(puVar18 + -4) = iVar10;
        *(undefined1 **)(puVar18 + -8) = puVar12;
        *(int *)(puVar18 + -0xc) = iVar4;
        *(undefined1 **)(puVar18 + -0x10) = puVar9;
        *(LPCWSTR *)(puVar18 + -0x14) = _LocaleName;
        *(_locale_t *)(puVar18 + -0x18) = _Plocinfo;
        puVar8 = puVar18 + -0x1c;
        *(undefined4 *)(puVar18 + -0x1c) = 0x100381a8;
        CompareStringW(*(LCID *)(puVar18 + -0x18),*(DWORD *)(puVar18 + -0x14),
                       *(PCNZWCH *)(puVar18 + -0x10),*(int *)(puVar18 + -0xc),
                       *(PCNZWCH *)(puVar18 + -8),*(int *)(puVar18 + -4));
      }
      if (bVar1) {
        *(undefined1 **)(puVar8 + -4) = puVar12;
        *(undefined4 *)(puVar8 + -8) = 0x100381b7;
        _free(*(void **)(puVar8 + -4));
      }
    }
  }
LAB_100381b8:
  if (bVar2) {
    *(undefined1 **)(puVar8 + -4) = puVar9;
    *(undefined4 *)(puVar8 + -8) = 0x100381c6;
    _free(*(void **)(puVar8 + -4));
  }
LAB_1003827d:
  iVar4 = FUN_1002d447(local_20);
  return iVar4;
}



// Library Function - Single Match
//  _findenv
// 
// Library: Visual Studio 2003 Release

int __cdecl findenv(uchar *param_1)

{
  int iVar1;
  int *piVar2;
  size_t unaff_EDI;
  
  piVar2 = DAT_10053034;
  while( true ) {
    if ((uchar *)*piVar2 == (uchar *)0x0) {
      return -((int)piVar2 - (int)DAT_10053034 >> 2);
    }
    iVar1 = __mbsnbicoll(param_1,(uchar *)*piVar2,unaff_EDI);
    if ((iVar1 == 0) &&
       ((*(char *)(unaff_EDI + *piVar2) == '=' || (*(char *)(unaff_EDI + *piVar2) == '\0')))) break;
    piVar2 = piVar2 + 1;
  }
  return (int)piVar2 - (int)DAT_10053034 >> 2;
}



// Library Function - Single Match
//  _copy_environ
// 
// Library: Visual Studio 2003 Release

int * __cdecl copy_environ(void)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  int iVar4;
  int *piVar5;
  int *unaff_EDI;
  
  iVar4 = 0;
  if (unaff_EDI != (int *)0x0) {
    iVar1 = *unaff_EDI;
    piVar2 = unaff_EDI;
    while (iVar1 != 0) {
      piVar2 = piVar2 + 1;
      iVar4 = iVar4 + 1;
      iVar1 = *piVar2;
    }
    piVar2 = (int *)_malloc(iVar4 * 4 + 4);
    if (piVar2 == (int *)0x0) {
      __amsg_exit(9);
    }
    pcVar3 = (char *)*unaff_EDI;
    piVar5 = piVar2;
    while (pcVar3 != (char *)0x0) {
      pcVar3 = __strdup(pcVar3);
      *piVar5 = (int)pcVar3;
      piVar5 = piVar5 + 1;
      unaff_EDI = unaff_EDI + 1;
      pcVar3 = (char *)*unaff_EDI;
    }
    *piVar5 = 0;
    return piVar2;
  }
  return unaff_EDI;
}



// Library Function - Single Match
//  ___crtsetenv
// 
// Library: Visual Studio 2003 Release

int __cdecl ___crtsetenv(char **_POption,int _Primary)

{
  uint *_Str;
  uint *puVar1;
  int iVar2;
  int *piVar3;
  size_t sVar4;
  uint *lpName;
  undefined1 *puVar5;
  BOOL BVar6;
  bool bVar7;
  int local_14;
  
  local_14 = 0;
  if (_POption == (char **)0x0) {
    return -1;
  }
  _Str = (uint *)*_POption;
  if (_Str == (uint *)0x0) {
    return -1;
  }
  puVar1 = (uint *)__mbschr((uchar *)_Str,0x3d);
  if (puVar1 == (uint *)0x0) {
    return -1;
  }
  if (_Str == puVar1) {
    return -1;
  }
  bVar7 = *(char *)((int)puVar1 + 1) == '\0';
  if (DAT_10053034 == DAT_10053038) {
    DAT_10053034 = copy_environ();
  }
  if (DAT_10053034 == (int *)0x0) {
    if ((_Primary != 0) && (DAT_1005303c != (undefined4 *)0x0)) {
      iVar2 = ___wtomb_environ();
      if (iVar2 != 0) {
        return -1;
      }
      goto LAB_100383f1;
    }
    if (!bVar7) {
      DAT_10053034 = (int *)_malloc(4);
      if (DAT_10053034 == (int *)0x0) {
        return -1;
      }
      *DAT_10053034 = 0;
      if (DAT_1005303c == (undefined4 *)0x0) {
        DAT_1005303c = (undefined4 *)_malloc(4);
        if (DAT_1005303c == (undefined4 *)0x0) {
          return -1;
        }
        *DAT_1005303c = 0;
      }
      goto LAB_100383f1;
    }
LAB_100383bf:
    local_14 = 0;
  }
  else {
LAB_100383f1:
    piVar3 = DAT_10053034;
    iVar2 = findenv((uchar *)_Str);
    if ((iVar2 < 0) || (*piVar3 == 0)) {
      if (bVar7) {
        _free(_Str);
        *_POption = (char *)0x0;
        goto LAB_100383bf;
      }
      if (iVar2 < 0) {
        iVar2 = -iVar2;
      }
      piVar3 = (int *)_realloc(DAT_10053034,iVar2 * 4 + 8);
      if (piVar3 == (int *)0x0) {
        return -1;
      }
      piVar3[iVar2] = (int)_Str;
      (piVar3 + iVar2)[1] = 0;
      *_POption = (char *)0x0;
LAB_1003848e:
      DAT_10053034 = piVar3;
    }
    else {
      piVar3 = piVar3 + iVar2;
      _free((void *)*piVar3);
      if (bVar7) {
        for (; *piVar3 != 0; piVar3 = piVar3 + 1) {
          *piVar3 = piVar3[1];
          iVar2 = iVar2 + 1;
        }
        piVar3 = (int *)_realloc(DAT_10053034,iVar2 << 2);
        if (piVar3 != (int *)0x0) goto LAB_1003848e;
      }
      else {
        *piVar3 = (int)_Str;
        *_POption = (char *)0x0;
      }
    }
    if (_Primary != 0) {
      sVar4 = _strlen((char *)_Str);
      lpName = (uint *)_malloc(sVar4 + 2);
      if (lpName != (uint *)0x0) {
        FUN_10034d50(lpName,_Str);
        puVar5 = (undefined1 *)(((int)lpName - (int)_Str) + (int)puVar1);
        *puVar5 = 0;
        BVar6 = SetEnvironmentVariableA((LPCSTR)lpName,(LPCSTR)(~-(uint)bVar7 & (uint)(puVar5 + 1)))
        ;
        if (BVar6 == 0) {
          local_14 = -1;
        }
        _free(lpName);
      }
    }
    if (bVar7) {
      _free(_Str);
    }
  }
  return local_14;
}



// Library Function - Single Match
//  __setmode_lk
// 
// Library: Visual Studio 2003 Release

int __cdecl __setmode_lk(uint param_1,int param_2)

{
  byte *pbVar1;
  byte bVar2;
  int *piVar3;
  int iVar4;
  
  piVar3 = &DAT_100535e0 + ((int)param_1 >> 5);
  iVar4 = (param_1 & 0x1f) * 0x24;
  bVar2 = *(byte *)(*piVar3 + 4 + iVar4);
  if (param_2 == 0x8000) {
    pbVar1 = (byte *)(*piVar3 + 4 + iVar4);
    *pbVar1 = *pbVar1 & 0x7f;
  }
  else {
    if (param_2 != 0x4000) {
      piVar3 = FUN_1003366f();
      *piVar3 = 0x16;
      return -1;
    }
    pbVar1 = (byte *)(*piVar3 + 4 + iVar4);
    *pbVar1 = *pbVar1 | 0x80;
  }
  return (-(uint)((bVar2 & 0x80) != 0) & 0xffffc000) + 0x8000;
}



// Library Function - Single Match
//  ___ascii_strnicmp
// 
// Library: Visual Studio 2003 Release

int __cdecl ___ascii_strnicmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  byte bVar2;
  ushort uVar3;
  uint uVar4;
  bool bVar5;
  
  if (_MaxCount != 0) {
    do {
      bVar2 = *_Str1;
      cVar1 = *_Str2;
      uVar3 = CONCAT11(bVar2,cVar1);
      if (bVar2 == 0) break;
      uVar3 = CONCAT11(bVar2,cVar1);
      uVar4 = (uint)uVar3;
      if (cVar1 == '\0') break;
      _Str1 = (char *)((byte *)_Str1 + 1);
      _Str2 = _Str2 + 1;
      if ((0x40 < bVar2) && (bVar2 < 0x5b)) {
        uVar4 = (uint)CONCAT11(bVar2 + 0x20,cVar1);
      }
      uVar3 = (ushort)uVar4;
      bVar2 = (byte)uVar4;
      if ((0x40 < bVar2) && (bVar2 < 0x5b)) {
        uVar3 = (ushort)CONCAT31((int3)(uVar4 >> 8),bVar2 + 0x20);
      }
      bVar2 = (byte)(uVar3 >> 8);
      bVar5 = bVar2 < (byte)uVar3;
      if (bVar2 != (byte)uVar3) goto LAB_100385d1;
      _MaxCount = _MaxCount - 1;
    } while (_MaxCount != 0);
    _MaxCount = 0;
    bVar2 = (byte)(uVar3 >> 8);
    bVar5 = bVar2 < (byte)uVar3;
    if (bVar2 != (byte)uVar3) {
LAB_100385d1:
      _MaxCount = 0xffffffff;
      if (!bVar5) {
        _MaxCount = 1;
      }
    }
  }
  return _MaxCount;
}



// Library Function - Single Match
//  __strdup
// 
// Library: Visual Studio 2003 Release

char * __cdecl __strdup(char *_Src)

{
  size_t sVar1;
  uint *puVar2;
  
  if (_Src != (char *)0x0) {
    sVar1 = _strlen(_Src);
    puVar2 = (uint *)_malloc(sVar1 + 1);
    if (puVar2 != (uint *)0x0) {
      puVar2 = FUN_10034d50(puVar2,(uint *)_Src);
      return (char *)puVar2;
    }
  }
  return (char *)0x0;
}



// Library Function - Single Match
//  __mbschr
// 
// Library: Visual Studio 2003 Release

uchar * __cdecl __mbschr(uchar *_Str,uint _Ch)

{
  byte bVar1;
  byte bVar2;
  _ptiddata p_Var3;
  pthreadmbcinfo ptVar4;
  uchar *puVar5;
  byte *pbVar6;
  uint uVar7;
  
  p_Var3 = __getptd();
  ptVar4 = (pthreadmbcinfo)p_Var3->_tpxcptinfoptrs;
  if (ptVar4 != DAT_10053364) {
    ptVar4 = ___updatetmbcinfo();
  }
  if (ptVar4->ismbcodepage == 0) {
    puVar5 = (uchar *)_strchr((char *)_Str,_Ch);
    return puVar5;
  }
  while( true ) {
    bVar2 = *_Str;
    uVar7 = (uint)bVar2;
    if (bVar2 == 0) break;
    if ((ptVar4->mbctype[uVar7 + 5] & 4) == 0) {
      pbVar6 = _Str;
      if (_Ch == uVar7) break;
    }
    else {
      bVar1 = _Str[1];
      if (bVar1 == 0) {
        return (uchar *)0x0;
      }
      pbVar6 = _Str + 1;
      if (_Ch == CONCAT11(bVar2,bVar1)) {
        return _Str;
      }
    }
    _Str = pbVar6 + 1;
  }
  return (uchar *)(~-(uint)(_Ch != uVar7) & (uint)_Str);
}



UCHAR Netbios(PNCB pncb)

{
  UCHAR UVar1;
  
                    // WARNING: Could not recover jumptable at 0x10038688. Too many branches
                    // WARNING: Treating indirect jump as call
  UVar1 = Netbios(pncb);
  return UVar1;
}



void RtlUnwind(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue)

{
                    // WARNING: Could not recover jumptable at 0x1003868e. Too many branches
                    // WARNING: Treating indirect jump as call
  RtlUnwind(TargetFrame,TargetIp,ExceptionRecord,ReturnValue);
  return;
}


